===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Sat Mar 23 11:21:58 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-03-23 11:22:10.982094: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-23 11:22:11.631454: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-23 11:22:11.632526: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-23 11:22:11.635549: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-23 11:22:11.989122: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94

Attempting combination 0/1:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 75
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: -1
push_start: 60
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 60
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 16: 0.9361702127659575
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 25: 0.8936170212765957
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 37: 0.8936170212765957
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 38: 0.9148936170212766
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 39: 0.8617021276595744
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 41: 0.9148936170212766
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 43: 0.9042553191489362
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 45: 0.8936170212765957
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 48: 0.9148936170212766
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 50: 0.9042553191489362
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 51: 0.9042553191489362
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 52: 0.8936170212765957
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 53: 0.9148936170212766
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 54: 0.9148936170212766
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 55: 0.8936170212765957
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 57: 0.9148936170212766
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 58: 0.8936170212765957
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 59: 0.8936170212765957
Warm optimizer lr: 0.00016000000000000007
Val acc before epoch 60: 0.8936170212765957
Stopping after epoch 61.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
Retraining last layer
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5595238095238094
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.5004232804232804
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6142003238201141
	Separation: 0.5445633232593536
Final test:
	Cluster: 0.5996911525726318
	Separation: 0.5436017513275146
Saved Results
Finished search.
