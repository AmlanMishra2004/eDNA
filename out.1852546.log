===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Mon Apr  1 23:48:18 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-04-01 23:50:09.831669: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-04-01 23:50:12.430626: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-04-01 23:50:12.623159: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-04-01 23:50:13.052953: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-04-01 23:50:15.848016: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94
Hyperparameters: {'prototype_shape': [(468, 520, 29)], 'latent_weight': [0.9], 'num_warm_epochs': [1000000], 'push_gap': [0], 'num_pushes': [1], 'last_layer_epochs': [0], 'crs_ent_weight': [1], 'clst_weight': [-9.600000000000001], 'sep_weight': [2.4], 'l1_weight': [0.001], 'push_start': [100], 'p0_warm_ptype_lr': [0.5], 'p0_warm_ptype_gamma': [0.95, 0.9, 0.85, 0.8, 0.75, 0.7, 0.65, 0.6, 0.55, 0.5, 0.45, 0.4, 0.35, 0.3, 0.25, 0.2, 0.15, 0.1], 'p0_warm_ptype_step_size': [40], 'p1_last_layer_lr': [0.001], 'p1_warm_ptype_lr': [0.28], 'p1_warm_ptype_gamma': [0.8], 'p1_warm_ptype_step_size': [100], 'p2_last_layer_lr': [0.0007], 'p2_warm_ptype_lr': [0.1], 'p2_warm_ptype_gamma': [-1], 'p2_warm_ptype_step_size': [100], 'p3_last_layer_lr': [7.5e-05], 'p3_warm_ptype_lr': [0.05], 'p3_warm_ptype_gamma': [-1], 'p3_warm_ptype_step_size': [100], 'p4_last_layer_lr': [7.5e-06], 'p4_warm_ptype_lr': [0.05], 'p4_warm_ptype_gamma': [-1], 'p4_warm_ptype_step_size': [100], 'joint_weight_decay': [-1], 'joint_lr_step_size': [-1], 'joint_gamma': [-1], 'joint_optimizer_lrs': [{'features': -1, 'prototype_vectors': -1}]}


Checking hyperparameters: {'p0_warm_ptype_gamma': [0.95, 0.9, 0.85, 0.8, 0.75, 0.7, 0.65, 0.6, 0.55, 0.5, 0.45, 0.4, 0.35, 0.3, 0.25, 0.2, 0.15, 0.1]}




Exploring 18 hyperparameter combinations for grid search.


Attempting combination 1/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.95
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7872340425531915
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.7872340425531915
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8297872340425532
Warm optimizer lr: 0.475
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.475
Val acc before epoch 9: 0.8404255319148937
Warm optimizer lr: 0.475
Val acc before epoch 10: 0.8297872340425532
Warm optimizer lr: 0.475
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.475
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.475
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.475
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.475
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.45125
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.45125
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.45125
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.45125
Val acc before epoch 19: 0.9574468085106383
Warm optimizer lr: 0.45125
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.45125
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.45125
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.45125
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.42868749999999994
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.42868749999999994
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.42868749999999994
Val acc before epoch 26: 0.9574468085106383
Warm optimizer lr: 0.42868749999999994
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.42868749999999994
Val acc before epoch 28: 0.9574468085106383
Warm optimizer lr: 0.42868749999999994
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.42868749999999994
Val acc before epoch 30: 0.9680851063829787
Warm optimizer lr: 0.42868749999999994
Val acc before epoch 31: 0.9787234042553191
Warm optimizer lr: 0.40725312499999994
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.40725312499999994
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.40725312499999994
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.40725312499999994
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.40725312499999994
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.40725312499999994
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.40725312499999994
Val acc before epoch 38: 0.9680851063829787
Warm optimizer lr: 0.40725312499999994
Val acc before epoch 39: 0.9680851063829787
Warm optimizer lr: 0.38689046874999994
Val acc before epoch 40: 0.9574468085106383
Warm optimizer lr: 0.38689046874999994
Val acc before epoch 41: 0.9680851063829787
Warm optimizer lr: 0.38689046874999994
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.38689046874999994
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.38689046874999994
Val acc before epoch 44: 0.9148936170212766
Warm optimizer lr: 0.38689046874999994
Val acc before epoch 45: 0.9148936170212766
Warm optimizer lr: 0.38689046874999994
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.38689046874999994
Val acc before epoch 47: 0.9893617021276596
Warm optimizer lr: 0.3675459453124999
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.3675459453124999
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.3675459453124999
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.3675459453124999
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.3675459453124999
Val acc before epoch 52: 0.9680851063829787
Warm optimizer lr: 0.3675459453124999
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.3675459453124999
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.3675459453124999
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.34916864804687486
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.34916864804687486
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.34916864804687486
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.34916864804687486
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.34916864804687486
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.34916864804687486
Val acc before epoch 61: 0.9787234042553191
Warm optimizer lr: 0.34916864804687486
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.34916864804687486
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.3317102156445311
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.3317102156445311
Val acc before epoch 65: 0.9680851063829787
Warm optimizer lr: 0.3317102156445311
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.3317102156445311
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.3317102156445311
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.3317102156445311
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.3317102156445311
Val acc before epoch 70: 0.9680851063829787
Warm optimizer lr: 0.3317102156445311
Val acc before epoch 71: 0.9574468085106383
Warm optimizer lr: 0.31512470486230454
Val acc before epoch 72: 0.9361702127659575
Warm optimizer lr: 0.31512470486230454
Val acc before epoch 73: 0.925531914893617
Warm optimizer lr: 0.31512470486230454
Val acc before epoch 74: 0.9574468085106383
Warm optimizer lr: 0.31512470486230454
Val acc before epoch 75: 0.9574468085106383
Warm optimizer lr: 0.31512470486230454
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 0.31512470486230454
Val acc before epoch 77: 0.9468085106382979
Warm optimizer lr: 0.31512470486230454
Val acc before epoch 78: 0.9574468085106383
Warm optimizer lr: 0.31512470486230454
Val acc before epoch 79: 0.9468085106382979
Warm optimizer lr: 0.2993684696191893
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.2993684696191893
Val acc before epoch 81: 0.9468085106382979
Warm optimizer lr: 0.2993684696191893
Val acc before epoch 82: 0.9361702127659575
Warm optimizer lr: 0.2993684696191893
Val acc before epoch 83: 0.9574468085106383
Warm optimizer lr: 0.2993684696191893
Val acc before epoch 84: 0.9574468085106383
Warm optimizer lr: 0.2993684696191893
Val acc before epoch 85: 0.9680851063829787
Warm optimizer lr: 0.2993684696191893
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.2993684696191893
Val acc before epoch 87: 0.9574468085106383
Warm optimizer lr: 0.2844000461382298
Val acc before epoch 88: 0.9680851063829787
Warm optimizer lr: 0.2844000461382298
Val acc before epoch 89: 0.9574468085106383
Warm optimizer lr: 0.2844000461382298
Val acc before epoch 90: 0.9361702127659575
Warm optimizer lr: 0.2844000461382298
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.2844000461382298
Val acc before epoch 92: 0.9680851063829787
Warm optimizer lr: 0.2844000461382298
Val acc before epoch 93: 0.9893617021276596
Warm optimizer lr: 0.2844000461382298
Val acc before epoch 94: 0.925531914893617
Warm optimizer lr: 0.2844000461382298
Val acc before epoch 95: 0.9468085106382979
Warm optimizer lr: 0.2701800438313183
Val acc before epoch 96: 0.9680851063829787
Warm optimizer lr: 0.2701800438313183
Val acc before epoch 97: 0.9574468085106383
Warm optimizer lr: 0.2701800438313183
Val acc before epoch 98: 0.9680851063829787
Warm optimizer lr: 0.2701800438313183
Val acc before epoch 99: 0.9680851063829787
Stopping after epoch 100.
Final validation accuracy before push: 0.9680851063829787
Push number 1
After push, before retraining last layer:
	Train acc: 0.8076923076923077
	Train Cluster: 0.6368667006492614
	TrainSeparation: 0.5097006916999817
(Directly after push 2) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: 0.001

Attempting combination 2/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.9
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.45
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.45
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.45
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.45
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.45
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.45
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.45
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.45
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.405
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.405
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.405
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.405
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.405
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.405
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.405
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.405
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 31: 0.9787234042553191
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 34: 0.9680851063829787
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 40: 0.9468085106382979
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 41: 0.9680851063829787
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 44: 0.9574468085106383
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 45: 0.9574468085106383
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 48: 0.9680851063829787
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 59: 0.9042553191489362
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 64: 0.9148936170212766
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 70: 0.925531914893617
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 71: 0.9574468085106383
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 72: 0.9361702127659575
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 73: 0.9680851063829787
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 74: 0.9680851063829787
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 75: 0.9574468085106383
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 77: 0.9361702127659575
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 78: 0.9042553191489362
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 79: 0.9574468085106383
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 81: 0.9574468085106383
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 82: 0.9468085106382979
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 83: 0.9680851063829787
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 84: 0.9574468085106383
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 85: 0.925531914893617
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 86: 0.9787234042553191
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.15690529804500009
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 0.15690529804500009
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 0.15690529804500009
Val acc before epoch 90: 0.9680851063829787
Warm optimizer lr: 0.15690529804500009
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.15690529804500009
Val acc before epoch 92: 0.9680851063829787
Warm optimizer lr: 0.15690529804500009
Val acc before epoch 93: 0.9574468085106383
Warm optimizer lr: 0.15690529804500009
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 0.15690529804500009
Val acc before epoch 95: 0.9468085106382979
Warm optimizer lr: 0.14121476824050008
Val acc before epoch 96: 0.925531914893617
Warm optimizer lr: 0.14121476824050008
Val acc before epoch 97: 0.9574468085106383
Warm optimizer lr: 0.14121476824050008
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 0.14121476824050008
Val acc before epoch 99: 0.9574468085106383
Stopping after epoch 100.
Final validation accuracy before push: 0.9574468085106383
Push number 1
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Train Cluster: 0.6362120032310485
	TrainSeparation: 0.5057634949684143
(Directly after push 2) Val acc at iteration 0: 0.6382978723404256
Retraining last layer
Last layer lr: 0.001

Attempting combination 3/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.85
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5531914893617021
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.7978723404255319
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.425
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.425
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.425
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.425
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.425
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.425
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.425
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.425
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.36124999999999996
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.36124999999999996
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.36124999999999996
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.36124999999999996
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.36124999999999996
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.36124999999999996
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.36124999999999996
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.36124999999999996
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.30706249999999996
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.30706249999999996
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.30706249999999996
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.30706249999999996
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.30706249999999996
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.30706249999999996
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.30706249999999996
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.30706249999999996
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.26100312499999995
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.26100312499999995
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.26100312499999995
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.26100312499999995
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.26100312499999995
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.26100312499999995
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.26100312499999995
Val acc before epoch 38: 0.9361702127659575
Warm optimizer lr: 0.26100312499999995
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.22185265624999995
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.22185265624999995
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.22185265624999995
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.22185265624999995
Val acc before epoch 43: 0.9042553191489362
Warm optimizer lr: 0.22185265624999995
Val acc before epoch 44: 0.9680851063829787
Warm optimizer lr: 0.22185265624999995
Val acc before epoch 45: 0.9148936170212766
Warm optimizer lr: 0.22185265624999995
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.22185265624999995
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.18857475781249994
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.18857475781249994
Val acc before epoch 49: 0.9787234042553191
Warm optimizer lr: 0.18857475781249994
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.18857475781249994
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.18857475781249994
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.18857475781249994
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.18857475781249994
Val acc before epoch 54: 0.8936170212765957
Warm optimizer lr: 0.18857475781249994
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.16028854414062493
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.16028854414062493
Val acc before epoch 57: 0.9680851063829787
Warm optimizer lr: 0.16028854414062493
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.16028854414062493
Val acc before epoch 59: 0.9148936170212766
Warm optimizer lr: 0.16028854414062493
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.16028854414062493
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.16028854414062493
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 0.16028854414062493
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.1362452625195312
Val acc before epoch 64: 0.9787234042553191
Warm optimizer lr: 0.1362452625195312
Val acc before epoch 65: 0.9148936170212766
Warm optimizer lr: 0.1362452625195312
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.1362452625195312
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 0.1362452625195312
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.1362452625195312
Val acc before epoch 69: 0.9787234042553191
Warm optimizer lr: 0.1362452625195312
Val acc before epoch 70: 0.9574468085106383
Warm optimizer lr: 0.1362452625195312
Val acc before epoch 71: 0.925531914893617
Warm optimizer lr: 0.11580847314160152
Val acc before epoch 72: 0.9680851063829787
Warm optimizer lr: 0.11580847314160152
Val acc before epoch 73: 0.9574468085106383
Warm optimizer lr: 0.11580847314160152
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.11580847314160152
Val acc before epoch 75: 0.9361702127659575
Warm optimizer lr: 0.11580847314160152
Val acc before epoch 76: 0.9680851063829787
Warm optimizer lr: 0.11580847314160152
Val acc before epoch 77: 0.9468085106382979
Warm optimizer lr: 0.11580847314160152
Val acc before epoch 78: 0.9680851063829787
Warm optimizer lr: 0.11580847314160152
Val acc before epoch 79: 0.9468085106382979
Warm optimizer lr: 0.09843720217036128
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.09843720217036128
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.09843720217036128
Val acc before epoch 82: 0.9468085106382979
Warm optimizer lr: 0.09843720217036128
Val acc before epoch 83: 0.9361702127659575
Warm optimizer lr: 0.09843720217036128
Val acc before epoch 84: 0.9574468085106383
Warm optimizer lr: 0.09843720217036128
Val acc before epoch 85: 0.9787234042553191
Warm optimizer lr: 0.09843720217036128
Val acc before epoch 86: 0.9787234042553191
Warm optimizer lr: 0.09843720217036128
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.08367162184480709
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 0.08367162184480709
Val acc before epoch 89: 0.9468085106382979
Warm optimizer lr: 0.08367162184480709
Val acc before epoch 90: 0.925531914893617
Warm optimizer lr: 0.08367162184480709
Val acc before epoch 91: 0.9468085106382979
Warm optimizer lr: 0.08367162184480709
Val acc before epoch 92: 0.9574468085106383
Warm optimizer lr: 0.08367162184480709
Val acc before epoch 93: 0.9574468085106383
Warm optimizer lr: 0.08367162184480709
Val acc before epoch 94: 0.9468085106382979
Warm optimizer lr: 0.08367162184480709
Val acc before epoch 95: 0.9680851063829787
Warm optimizer lr: 0.07112087856808602
Val acc before epoch 96: 0.9574468085106383
Warm optimizer lr: 0.07112087856808602
Val acc before epoch 97: 0.9574468085106383
Warm optimizer lr: 0.07112087856808602
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 0.07112087856808602
Val acc before epoch 99: 0.9361702127659575
Stopping after epoch 100.
Final validation accuracy before push: 0.9361702127659575
Push number 1
After push, before retraining last layer:
	Train acc: 0.7836538461538461
	Train Cluster: 0.6362751364707947
	TrainSeparation: 0.5034087240695954
(Directly after push 2) Val acc at iteration 0: 0.648936170212766
Retraining last layer
Last layer lr: 0.001

Attempting combination 4/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.8
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6063829787234043
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 17: 0.9574468085106383
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 36: 0.9148936170212766
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 38: 0.9042553191489362
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 39: 0.9042553191489362
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 40: 0.9148936170212766
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 41: 0.925531914893617
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 49: 0.9148936170212766
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 50: 0.9148936170212766
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 52: 0.9787234042553191
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 53: 0.8936170212765957
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 54: 0.925531914893617
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 57: 0.9148936170212766
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 63: 0.9042553191489362
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 64: 0.9148936170212766
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 65: 0.925531914893617
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 66: 0.9042553191489362
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 70: 0.9361702127659575
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 71: 0.9574468085106383
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 72: 0.925531914893617
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 73: 0.925531914893617
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 75: 0.9148936170212766
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 76: 0.9361702127659575
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 77: 0.9574468085106383
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 78: 0.9468085106382979
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 79: 0.9042553191489362
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 80: 0.8936170212765957
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 81: 0.9361702127659575
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 82: 0.9361702127659575
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 83: 0.9361702127659575
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 84: 0.925531914893617
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 85: 0.925531914893617
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 87: 0.9148936170212766
Warm optimizer lr: 0.042949672960000025
Val acc before epoch 88: 0.9468085106382979
Warm optimizer lr: 0.042949672960000025
Val acc before epoch 89: 0.8936170212765957
Warm optimizer lr: 0.042949672960000025
Val acc before epoch 90: 0.9361702127659575
Warm optimizer lr: 0.042949672960000025
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.042949672960000025
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.042949672960000025
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 0.042949672960000025
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 0.042949672960000025
Val acc before epoch 95: 0.9361702127659575
Warm optimizer lr: 0.03435973836800002
Val acc before epoch 96: 0.9468085106382979
Warm optimizer lr: 0.03435973836800002
Val acc before epoch 97: 0.925531914893617
Warm optimizer lr: 0.03435973836800002
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 0.03435973836800002
Val acc before epoch 99: 0.925531914893617
Stopping after epoch 100.
Final validation accuracy before push: 0.925531914893617
Push number 1
After push, before retraining last layer:
	Train acc: 0.8108974358974359
	Train Cluster: 0.6462892651557922
	TrainSeparation: 0.5132039666175843
(Directly after push 2) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: 0.001

Attempting combination 5/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.75
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5425531914893617
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7978723404255319
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.375
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.375
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.375
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.375
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.375
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.375
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.375
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.375
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.28125
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.28125
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.28125
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.28125
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.28125
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.28125
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.28125
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.28125
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.2109375
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.2109375
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.2109375
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.2109375
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.2109375
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.2109375
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.2109375
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.2109375
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.158203125
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.158203125
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.158203125
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.158203125
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.158203125
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.158203125
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.158203125
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.158203125
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.11865234375
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.11865234375
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.11865234375
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.11865234375
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.11865234375
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.11865234375
Val acc before epoch 45: 0.8936170212765957
Warm optimizer lr: 0.11865234375
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.11865234375
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.0889892578125
Val acc before epoch 48: 0.925531914893617
Warm optimizer lr: 0.0889892578125
Val acc before epoch 49: 0.9042553191489362
Warm optimizer lr: 0.0889892578125
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.0889892578125
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.0889892578125
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.0889892578125
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.0889892578125
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.0889892578125
Val acc before epoch 55: 0.9148936170212766
Warm optimizer lr: 0.066741943359375
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.066741943359375
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.066741943359375
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.066741943359375
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.066741943359375
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.066741943359375
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.066741943359375
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.066741943359375
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.05005645751953125
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.05005645751953125
Val acc before epoch 65: 0.9680851063829787
Warm optimizer lr: 0.05005645751953125
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.05005645751953125
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.05005645751953125
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.05005645751953125
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.05005645751953125
Val acc before epoch 70: 0.9468085106382979
Warm optimizer lr: 0.05005645751953125
Val acc before epoch 71: 0.9468085106382979
Warm optimizer lr: 0.03754234313964844
Val acc before epoch 72: 0.9468085106382979
Warm optimizer lr: 0.03754234313964844
Val acc before epoch 73: 0.9574468085106383
Warm optimizer lr: 0.03754234313964844
Val acc before epoch 74: 0.9574468085106383
Warm optimizer lr: 0.03754234313964844
Val acc before epoch 75: 0.9574468085106383
Warm optimizer lr: 0.03754234313964844
Val acc before epoch 76: 0.9148936170212766
Warm optimizer lr: 0.03754234313964844
Val acc before epoch 77: 0.9361702127659575
Warm optimizer lr: 0.03754234313964844
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.03754234313964844
Val acc before epoch 79: 0.9468085106382979
Warm optimizer lr: 0.028156757354736328
Val acc before epoch 80: 0.9574468085106383
Warm optimizer lr: 0.028156757354736328
Val acc before epoch 81: 0.9468085106382979
Warm optimizer lr: 0.028156757354736328
Val acc before epoch 82: 0.9468085106382979
Warm optimizer lr: 0.028156757354736328
Val acc before epoch 83: 0.9361702127659575
Warm optimizer lr: 0.028156757354736328
Val acc before epoch 84: 0.9361702127659575
Warm optimizer lr: 0.028156757354736328
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.028156757354736328
Val acc before epoch 86: 0.9574468085106383
Warm optimizer lr: 0.028156757354736328
Val acc before epoch 87: 0.9468085106382979
Warm optimizer lr: 0.021117568016052246
Val acc before epoch 88: 0.9680851063829787
Warm optimizer lr: 0.021117568016052246
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 0.021117568016052246
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.021117568016052246
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.021117568016052246
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.021117568016052246
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 0.021117568016052246
Val acc before epoch 94: 0.9680851063829787
Warm optimizer lr: 0.021117568016052246
Val acc before epoch 95: 0.9148936170212766
Warm optimizer lr: 0.015838176012039185
Val acc before epoch 96: 0.9574468085106383
Warm optimizer lr: 0.015838176012039185
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.015838176012039185
Val acc before epoch 98: 0.9468085106382979
Warm optimizer lr: 0.015838176012039185
Val acc before epoch 99: 0.9361702127659575
Stopping after epoch 100.
Final validation accuracy before push: 0.9361702127659575
Push number 1
After push, before retraining last layer:
	Train acc: 0.7612179487179487
	Train Cluster: 0.6303081274032593
	TrainSeparation: 0.5094301402568817
(Directly after push 2) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: 0.001

Attempting combination 6/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.7
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6595744680851063
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.35
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.35
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.35
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.35
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.35
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.35
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.35
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.35
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 23: 0.9680851063829787
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 24: 0.9787234042553191
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 34: 0.9680851063829787
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 38: 0.9787234042553191
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 41: 0.9680851063829787
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 43: 0.9574468085106383
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 45: 0.9574468085106383
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 48: 0.925531914893617
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 49: 0.9148936170212766
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 55: 0.9680851063829787
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 56: 0.925531914893617
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 57: 0.9574468085106383
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 59: 0.9787234042553191
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 61: 0.9680851063829787
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 63: 0.9680851063829787
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 69: 0.9468085106382979
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 70: 0.9680851063829787
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 71: 0.9574468085106383
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 72: 0.9468085106382979
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 73: 0.9574468085106383
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 75: 0.9680851063829787
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 76: 0.9361702127659575
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 77: 0.9468085106382979
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 79: 0.9574468085106383
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 80: 0.9148936170212766
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 81: 0.9361702127659575
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 82: 0.9468085106382979
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 83: 0.9468085106382979
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 84: 0.9468085106382979
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 86: 0.9574468085106383
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.009886633714999994
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.009886633714999994
Val acc before epoch 89: 0.9574468085106383
Warm optimizer lr: 0.009886633714999994
Val acc before epoch 90: 0.9361702127659575
Warm optimizer lr: 0.009886633714999994
Val acc before epoch 91: 0.9468085106382979
Warm optimizer lr: 0.009886633714999994
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.009886633714999994
Val acc before epoch 93: 0.9361702127659575
Warm optimizer lr: 0.009886633714999994
Val acc before epoch 94: 0.9468085106382979
Warm optimizer lr: 0.009886633714999994
Val acc before epoch 95: 0.9574468085106383
Warm optimizer lr: 0.006920643600499995
Val acc before epoch 96: 0.9468085106382979
Warm optimizer lr: 0.006920643600499995
Val acc before epoch 97: 0.9680851063829787
Warm optimizer lr: 0.006920643600499995
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 0.006920643600499995
Val acc before epoch 99: 0.9468085106382979
Stopping after epoch 100.
Final validation accuracy before push: 0.9468085106382979
Push number 1
After push, before retraining last layer:
	Train acc: 0.8092948717948718
	Train Cluster: 0.6372251272201538
	TrainSeparation: 0.5066362261772156
(Directly after push 2) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.001

Attempting combination 7/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.65
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5531914893617021
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.325
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.325
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.325
Val acc before epoch 10: 0.9361702127659575
Warm optimizer lr: 0.325
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.325
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.325
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.325
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.325
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.21125000000000002
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.21125000000000002
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.21125000000000002
Val acc before epoch 18: 0.9574468085106383
Warm optimizer lr: 0.21125000000000002
Val acc before epoch 19: 0.9680851063829787
Warm optimizer lr: 0.21125000000000002
Val acc before epoch 20: 0.9680851063829787
Warm optimizer lr: 0.21125000000000002
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.21125000000000002
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.21125000000000002
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.13731250000000003
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.13731250000000003
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.13731250000000003
Val acc before epoch 26: 0.9680851063829787
Warm optimizer lr: 0.13731250000000003
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.13731250000000003
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.13731250000000003
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.13731250000000003
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.13731250000000003
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.08925312500000003
Val acc before epoch 32: 0.9680851063829787
Warm optimizer lr: 0.08925312500000003
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.08925312500000003
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.08925312500000003
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.08925312500000003
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.08925312500000003
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.08925312500000003
Val acc before epoch 38: 0.925531914893617
Warm optimizer lr: 0.08925312500000003
Val acc before epoch 39: 0.8936170212765957
Warm optimizer lr: 0.05801453125000002
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.05801453125000002
Val acc before epoch 41: 0.9574468085106383
Warm optimizer lr: 0.05801453125000002
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.05801453125000002
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 0.05801453125000002
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.05801453125000002
Val acc before epoch 45: 0.9574468085106383
Warm optimizer lr: 0.05801453125000002
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.05801453125000002
Val acc before epoch 47: 0.9680851063829787
Warm optimizer lr: 0.03770944531250001
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.03770944531250001
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.03770944531250001
Val acc before epoch 50: 0.9680851063829787
Warm optimizer lr: 0.03770944531250001
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 0.03770944531250001
Val acc before epoch 52: 0.9680851063829787
Warm optimizer lr: 0.03770944531250001
Val acc before epoch 53: 0.9680851063829787
Warm optimizer lr: 0.03770944531250001
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.03770944531250001
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.02451113945312501
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.02451113945312501
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.02451113945312501
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.02451113945312501
Val acc before epoch 59: 0.9680851063829787
Warm optimizer lr: 0.02451113945312501
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.02451113945312501
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.02451113945312501
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.02451113945312501
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.01593224064453126
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.01593224064453126
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.01593224064453126
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.01593224064453126
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.01593224064453126
Val acc before epoch 68: 0.9148936170212766
Warm optimizer lr: 0.01593224064453126
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.01593224064453126
Val acc before epoch 70: 0.9361702127659575
Warm optimizer lr: 0.01593224064453126
Val acc before epoch 71: 0.9787234042553191
Warm optimizer lr: 0.010355956418945319
Val acc before epoch 72: 0.9361702127659575
Warm optimizer lr: 0.010355956418945319
Val acc before epoch 73: 0.9787234042553191
Warm optimizer lr: 0.010355956418945319
Val acc before epoch 74: 0.9787234042553191
Warm optimizer lr: 0.010355956418945319
Val acc before epoch 75: 0.9574468085106383
Warm optimizer lr: 0.010355956418945319
Val acc before epoch 76: 0.9680851063829787
Warm optimizer lr: 0.010355956418945319
Val acc before epoch 77: 0.9574468085106383
Warm optimizer lr: 0.010355956418945319
Val acc before epoch 78: 0.9361702127659575
Warm optimizer lr: 0.010355956418945319
Val acc before epoch 79: 0.9893617021276596
Warm optimizer lr: 0.0067313716723144575
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.0067313716723144575
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.0067313716723144575
Val acc before epoch 82: 0.9361702127659575
Warm optimizer lr: 0.0067313716723144575
Val acc before epoch 83: 0.9361702127659575
Warm optimizer lr: 0.0067313716723144575
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 0.0067313716723144575
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.0067313716723144575
Val acc before epoch 86: 0.925531914893617
Warm optimizer lr: 0.0067313716723144575
Val acc before epoch 87: 0.9468085106382979
Warm optimizer lr: 0.0043753915870043975
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 0.0043753915870043975
Val acc before epoch 89: 0.9468085106382979
Warm optimizer lr: 0.0043753915870043975
Val acc before epoch 90: 0.9680851063829787
Warm optimizer lr: 0.0043753915870043975
Val acc before epoch 91: 0.9680851063829787
Warm optimizer lr: 0.0043753915870043975
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.0043753915870043975
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 0.0043753915870043975
Val acc before epoch 94: 0.9468085106382979
Warm optimizer lr: 0.0043753915870043975
Val acc before epoch 95: 0.9893617021276596
Warm optimizer lr: 0.0028440045315528584
Val acc before epoch 96: 0.9680851063829787
Warm optimizer lr: 0.0028440045315528584
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.0028440045315528584
Val acc before epoch 98: 0.9468085106382979
Warm optimizer lr: 0.0028440045315528584
Val acc before epoch 99: 0.9361702127659575
Stopping after epoch 100.
Final validation accuracy before push: 0.9361702127659575
Push number 1
After push, before retraining last layer:
	Train acc: 0.8125
	Train Cluster: 0.6480741620063781
	TrainSeparation: 0.5111919403076172
(Directly after push 2) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.001

Attempting combination 8/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.6
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.6595744680851063
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.3
Val acc before epoch 8: 0.851063829787234
Warm optimizer lr: 0.3
Val acc before epoch 9: 0.851063829787234
Warm optimizer lr: 0.3
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.3
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.3
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.3
Val acc before epoch 13: 0.8829787234042553
Warm optimizer lr: 0.3
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.3
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.18
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.18
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.18
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.18
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.18
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.18
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.18
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.18
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.108
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.108
Val acc before epoch 25: 0.9042553191489362
Warm optimizer lr: 0.108
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.108
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.108
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.108
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.108
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.108
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.0648
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.0648
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.0648
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.0648
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.0648
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.0648
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.0648
Val acc before epoch 38: 0.9148936170212766
Warm optimizer lr: 0.0648
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.03888
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.03888
Val acc before epoch 41: 0.8829787234042553
Warm optimizer lr: 0.03888
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.03888
Val acc before epoch 43: 0.9042553191489362
Warm optimizer lr: 0.03888
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.03888
Val acc before epoch 45: 0.9148936170212766
Warm optimizer lr: 0.03888
Val acc before epoch 46: 0.8723404255319149
Warm optimizer lr: 0.03888
Val acc before epoch 47: 0.8936170212765957
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 48: 0.9574468085106383
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 49: 0.9148936170212766
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 50: 0.8936170212765957
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 54: 0.9148936170212766
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 57: 0.9042553191489362
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 58: 0.9148936170212766
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 59: 0.9042553191489362
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 60: 0.8936170212765957
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 61: 0.9042553191489362
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 65: 0.925531914893617
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 67: 0.9042553191489362
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 68: 0.9148936170212766
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 70: 0.925531914893617
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 71: 0.9042553191489362
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 72: 0.925531914893617
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 73: 0.9148936170212766
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 75: 0.8936170212765957
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 76: 0.9148936170212766
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 77: 0.925531914893617
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 80: 0.925531914893617
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 81: 0.9361702127659575
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 82: 0.9361702127659575
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 83: 0.925531914893617
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 84: 0.9042553191489362
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 85: 0.9361702127659575
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 0.0018139852799999997
Val acc before epoch 88: 0.9148936170212766
Warm optimizer lr: 0.0018139852799999997
Val acc before epoch 89: 0.8723404255319149
Warm optimizer lr: 0.0018139852799999997
Val acc before epoch 90: 0.8936170212765957
Warm optimizer lr: 0.0018139852799999997
Val acc before epoch 91: 0.9148936170212766
Warm optimizer lr: 0.0018139852799999997
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.0018139852799999997
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 0.0018139852799999997
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 0.0018139852799999997
Val acc before epoch 95: 0.9361702127659575
Warm optimizer lr: 0.0010883911679999997
Val acc before epoch 96: 0.8936170212765957
Warm optimizer lr: 0.0010883911679999997
Val acc before epoch 97: 0.9468085106382979
Warm optimizer lr: 0.0010883911679999997
Val acc before epoch 98: 0.9148936170212766
Warm optimizer lr: 0.0010883911679999997
Val acc before epoch 99: 0.9042553191489362
Stopping after epoch 100.
Final validation accuracy before push: 0.9042553191489362
Push number 1
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Train Cluster: 0.6339767575263977
	TrainSeparation: 0.5082503199577332
(Directly after push 2) Val acc at iteration 0: 0.648936170212766
Retraining last layer
Last layer lr: 0.001

Attempting combination 9/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.55
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7872340425531915
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.275
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.275
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.275
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.275
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.275
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.275
Val acc before epoch 13: 0.8829787234042553
Warm optimizer lr: 0.275
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.275
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.15125000000000002
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.15125000000000002
Val acc before epoch 17: 0.9574468085106383
Warm optimizer lr: 0.15125000000000002
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.15125000000000002
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.15125000000000002
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.15125000000000002
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.15125000000000002
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.15125000000000002
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.08318750000000003
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.08318750000000003
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.08318750000000003
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.08318750000000003
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.08318750000000003
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.08318750000000003
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.08318750000000003
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.08318750000000003
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.04575312500000002
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.04575312500000002
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.04575312500000002
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.04575312500000002
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.04575312500000002
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.04575312500000002
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.04575312500000002
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.04575312500000002
Val acc before epoch 39: 0.9148936170212766
Warm optimizer lr: 0.025164218750000012
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.025164218750000012
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.025164218750000012
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.025164218750000012
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.025164218750000012
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.025164218750000012
Val acc before epoch 45: 0.9574468085106383
Warm optimizer lr: 0.025164218750000012
Val acc before epoch 46: 0.9680851063829787
Warm optimizer lr: 0.025164218750000012
Val acc before epoch 47: 0.9787234042553191
Warm optimizer lr: 0.013840320312500008
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.013840320312500008
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.013840320312500008
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.013840320312500008
Val acc before epoch 51: 0.9148936170212766
Warm optimizer lr: 0.013840320312500008
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.013840320312500008
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.013840320312500008
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.013840320312500008
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.0076121761718750056
Val acc before epoch 56: 0.9787234042553191
Warm optimizer lr: 0.0076121761718750056
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.0076121761718750056
Val acc before epoch 58: 0.9787234042553191
Warm optimizer lr: 0.0076121761718750056
Val acc before epoch 59: 0.9680851063829787
Warm optimizer lr: 0.0076121761718750056
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.0076121761718750056
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.0076121761718750056
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.0076121761718750056
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.004186696894531253
Val acc before epoch 64: 0.9680851063829787
Warm optimizer lr: 0.004186696894531253
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.004186696894531253
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.004186696894531253
Val acc before epoch 67: 0.9148936170212766
Warm optimizer lr: 0.004186696894531253
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.004186696894531253
Val acc before epoch 69: 0.9680851063829787
Warm optimizer lr: 0.004186696894531253
Val acc before epoch 70: 0.9468085106382979
Warm optimizer lr: 0.004186696894531253
Val acc before epoch 71: 0.9361702127659575
Warm optimizer lr: 0.0023026832919921894
Val acc before epoch 72: 0.9361702127659575
Warm optimizer lr: 0.0023026832919921894
Val acc before epoch 73: 0.9574468085106383
Warm optimizer lr: 0.0023026832919921894
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.0023026832919921894
Val acc before epoch 75: 0.9574468085106383
Warm optimizer lr: 0.0023026832919921894
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 0.0023026832919921894
Val acc before epoch 77: 0.9787234042553191
Warm optimizer lr: 0.0023026832919921894
Val acc before epoch 78: 0.9468085106382979
Warm optimizer lr: 0.0023026832919921894
Val acc before epoch 79: 0.9680851063829787
Warm optimizer lr: 0.0012664758105957043
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.0012664758105957043
Val acc before epoch 81: 0.9574468085106383
Warm optimizer lr: 0.0012664758105957043
Val acc before epoch 82: 0.9787234042553191
Warm optimizer lr: 0.0012664758105957043
Val acc before epoch 83: 0.9574468085106383
Warm optimizer lr: 0.0012664758105957043
Val acc before epoch 84: 0.9680851063829787
Warm optimizer lr: 0.0012664758105957043
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.0012664758105957043
Val acc before epoch 86: 0.9574468085106383
Warm optimizer lr: 0.0012664758105957043
Val acc before epoch 87: 0.9574468085106383
Warm optimizer lr: 0.0006965616958276374
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.0006965616958276374
Val acc before epoch 89: 0.9468085106382979
Warm optimizer lr: 0.0006965616958276374
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.0006965616958276374
Val acc before epoch 91: 0.9680851063829787
Warm optimizer lr: 0.0006965616958276374
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 0.0006965616958276374
Val acc before epoch 93: 0.9361702127659575
Warm optimizer lr: 0.0006965616958276374
Val acc before epoch 94: 0.9574468085106383
Warm optimizer lr: 0.0006965616958276374
Val acc before epoch 95: 0.9468085106382979
Warm optimizer lr: 0.0003831089327052006
Val acc before epoch 96: 0.925531914893617
Warm optimizer lr: 0.0003831089327052006
Val acc before epoch 97: 0.9574468085106383
Warm optimizer lr: 0.0003831089327052006
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 0.0003831089327052006
Val acc before epoch 99: 0.9361702127659575
Stopping after epoch 100.
Final validation accuracy before push: 0.9361702127659575
Push number 1
After push, before retraining last layer:
	Train acc: 0.7852564102564102
	Train Cluster: 0.645602822303772
	TrainSeparation: 0.5146752834320069
(Directly after push 2) Val acc at iteration 0: 0.6595744680851063
Retraining last layer
Last layer lr: 0.001

Attempting combination 10/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.5
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8297872340425532
Warm optimizer lr: 0.25
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.25
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.125
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.125
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.125
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.125
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.125
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.0625
Val acc before epoch 25: 0.9042553191489362
Warm optimizer lr: 0.0625
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.0625
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.0625
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.03125
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.03125
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.03125
Val acc before epoch 36: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.03125
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.015625
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.015625
Val acc before epoch 41: 0.925531914893617
Warm optimizer lr: 0.015625
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.015625
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.015625
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.015625
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.015625
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.015625
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 50: 0.9148936170212766
Warm optimizer lr: 0.0078125
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.0078125
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 55: 0.9148936170212766
Warm optimizer lr: 0.00390625
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.00390625
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.00390625
Val acc before epoch 58: 0.8829787234042553
Warm optimizer lr: 0.00390625
Val acc before epoch 59: 0.9148936170212766
Warm optimizer lr: 0.00390625
Val acc before epoch 60: 0.9042553191489362
Warm optimizer lr: 0.00390625
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.00390625
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.00390625
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.001953125
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.001953125
Val acc before epoch 65: 0.9148936170212766
Warm optimizer lr: 0.001953125
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.001953125
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.001953125
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.001953125
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.001953125
Val acc before epoch 70: 0.925531914893617
Warm optimizer lr: 0.001953125
Val acc before epoch 71: 0.9468085106382979
Warm optimizer lr: 0.0009765625
Val acc before epoch 72: 0.9361702127659575
Warm optimizer lr: 0.0009765625
Val acc before epoch 73: 0.9148936170212766
Warm optimizer lr: 0.0009765625
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.0009765625
Val acc before epoch 75: 0.9468085106382979
Warm optimizer lr: 0.0009765625
Val acc before epoch 76: 0.925531914893617
Warm optimizer lr: 0.0009765625
Val acc before epoch 77: 0.9361702127659575
Warm optimizer lr: 0.0009765625
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.0009765625
Val acc before epoch 79: 0.925531914893617
Warm optimizer lr: 0.00048828125
Val acc before epoch 80: 0.9468085106382979
Warm optimizer lr: 0.00048828125
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.00048828125
Val acc before epoch 82: 0.9361702127659575
Warm optimizer lr: 0.00048828125
Val acc before epoch 83: 0.9361702127659575
Warm optimizer lr: 0.00048828125
Val acc before epoch 84: 0.925531914893617
Warm optimizer lr: 0.00048828125
Val acc before epoch 85: 0.9680851063829787
Warm optimizer lr: 0.00048828125
Val acc before epoch 86: 0.9468085106382979
Warm optimizer lr: 0.00048828125
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.000244140625
Val acc before epoch 88: 0.9787234042553191
Warm optimizer lr: 0.000244140625
Val acc before epoch 89: 0.9680851063829787
Warm optimizer lr: 0.000244140625
Val acc before epoch 90: 0.9680851063829787
Warm optimizer lr: 0.000244140625
Val acc before epoch 91: 0.9787234042553191
Warm optimizer lr: 0.000244140625
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.000244140625
Val acc before epoch 93: 0.9148936170212766
Warm optimizer lr: 0.000244140625
Val acc before epoch 94: 0.9468085106382979
Warm optimizer lr: 0.000244140625
Val acc before epoch 95: 0.9468085106382979
Warm optimizer lr: 0.0001220703125
Val acc before epoch 96: 0.8936170212765957
Warm optimizer lr: 0.0001220703125
Val acc before epoch 97: 0.9148936170212766
Warm optimizer lr: 0.0001220703125
Val acc before epoch 98: 0.9148936170212766
Warm optimizer lr: 0.0001220703125
Val acc before epoch 99: 0.925531914893617
Stopping after epoch 100.
Final validation accuracy before push: 0.925531914893617
Push number 1
After push, before retraining last layer:
	Train acc: 0.7916666666666666
	Train Cluster: 0.6321829915046692
	TrainSeparation: 0.5066549420356751
(Directly after push 2) Val acc at iteration 0: 0.6276595744680851
Retraining last layer
Last layer lr: 0.001

Attempting combination 11/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.45
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5638297872340425
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.225
Val acc before epoch 8: 0.9468085106382979
Warm optimizer lr: 0.225
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.225
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.225
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.225
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.225
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.225
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.225
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.10125
Val acc before epoch 16: 0.9361702127659575
Warm optimizer lr: 0.10125
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.10125
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.10125
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.10125
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.10125
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.10125
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.10125
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.045562500000000006
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.045562500000000006
Val acc before epoch 25: 0.9680851063829787
Warm optimizer lr: 0.045562500000000006
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.045562500000000006
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.045562500000000006
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.045562500000000006
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.045562500000000006
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.045562500000000006
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.020503125000000004
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.020503125000000004
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.020503125000000004
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.020503125000000004
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.020503125000000004
Val acc before epoch 36: 0.8617021276595744
Warm optimizer lr: 0.020503125000000004
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.020503125000000004
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.020503125000000004
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.009226406250000003
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.009226406250000003
Val acc before epoch 41: 0.9148936170212766
Warm optimizer lr: 0.009226406250000003
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.009226406250000003
Val acc before epoch 43: 0.9042553191489362
Warm optimizer lr: 0.009226406250000003
Val acc before epoch 44: 0.9042553191489362
Warm optimizer lr: 0.009226406250000003
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.009226406250000003
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.009226406250000003
Val acc before epoch 47: 0.9042553191489362
Warm optimizer lr: 0.004151882812500001
Val acc before epoch 48: 0.925531914893617
Warm optimizer lr: 0.004151882812500001
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.004151882812500001
Val acc before epoch 50: 0.9148936170212766
Warm optimizer lr: 0.004151882812500001
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.004151882812500001
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.004151882812500001
Val acc before epoch 53: 0.9042553191489362
Warm optimizer lr: 0.004151882812500001
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.004151882812500001
Val acc before epoch 55: 0.8936170212765957
Warm optimizer lr: 0.0018683472656250005
Val acc before epoch 56: 0.8936170212765957
Warm optimizer lr: 0.0018683472656250005
Val acc before epoch 57: 0.9148936170212766
Warm optimizer lr: 0.0018683472656250005
Val acc before epoch 58: 0.925531914893617
Warm optimizer lr: 0.0018683472656250005
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.0018683472656250005
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.0018683472656250005
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.0018683472656250005
Val acc before epoch 62: 0.9042553191489362
Warm optimizer lr: 0.0018683472656250005
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.0008407562695312503
Val acc before epoch 64: 0.9042553191489362
Warm optimizer lr: 0.0008407562695312503
Val acc before epoch 65: 0.9042553191489362
Warm optimizer lr: 0.0008407562695312503
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 0.0008407562695312503
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.0008407562695312503
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.0008407562695312503
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.0008407562695312503
Val acc before epoch 70: 0.9361702127659575
Warm optimizer lr: 0.0008407562695312503
Val acc before epoch 71: 0.9361702127659575
Warm optimizer lr: 0.00037834032128906264
Val acc before epoch 72: 0.9042553191489362
Warm optimizer lr: 0.00037834032128906264
Val acc before epoch 73: 0.8936170212765957
Warm optimizer lr: 0.00037834032128906264
Val acc before epoch 74: 0.925531914893617
Warm optimizer lr: 0.00037834032128906264
Val acc before epoch 75: 0.9361702127659575
Warm optimizer lr: 0.00037834032128906264
Val acc before epoch 76: 0.925531914893617
Warm optimizer lr: 0.00037834032128906264
Val acc before epoch 77: 0.9468085106382979
Warm optimizer lr: 0.00037834032128906264
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 0.00037834032128906264
Val acc before epoch 79: 0.9148936170212766
Warm optimizer lr: 0.0001702531445800782
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.0001702531445800782
Val acc before epoch 81: 0.9361702127659575
Warm optimizer lr: 0.0001702531445800782
Val acc before epoch 82: 0.9361702127659575
Warm optimizer lr: 0.0001702531445800782
Val acc before epoch 83: 0.925531914893617
Warm optimizer lr: 0.0001702531445800782
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 0.0001702531445800782
Val acc before epoch 85: 0.9680851063829787
Warm optimizer lr: 0.0001702531445800782
Val acc before epoch 86: 0.9574468085106383
Warm optimizer lr: 0.0001702531445800782
Val acc before epoch 87: 0.9148936170212766
Warm optimizer lr: 7.66139150610352e-05
Val acc before epoch 88: 0.9148936170212766
Warm optimizer lr: 7.66139150610352e-05
Val acc before epoch 89: 0.9148936170212766
Warm optimizer lr: 7.66139150610352e-05
Val acc before epoch 90: 0.9148936170212766
Warm optimizer lr: 7.66139150610352e-05
Val acc before epoch 91: 0.9042553191489362
Warm optimizer lr: 7.66139150610352e-05
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 7.66139150610352e-05
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 7.66139150610352e-05
Val acc before epoch 94: 0.925531914893617
Warm optimizer lr: 7.66139150610352e-05
Val acc before epoch 95: 0.9361702127659575
Warm optimizer lr: 3.447626177746584e-05
Val acc before epoch 96: 0.925531914893617
Warm optimizer lr: 3.447626177746584e-05
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 3.447626177746584e-05
Val acc before epoch 98: 0.9148936170212766
Warm optimizer lr: 3.447626177746584e-05
Val acc before epoch 99: 0.9148936170212766
Stopping after epoch 100.
Final validation accuracy before push: 0.9148936170212766
Push number 1
After push, before retraining last layer:
	Train acc: 0.7644230769230769
	Train Cluster: 0.6341492533683777
	TrainSeparation: 0.507437139749527
(Directly after push 2) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.001

Attempting combination 12/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.4
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.723404255319149
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8191489361702128
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.2
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.2
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.2
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.2
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.2
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 25: 0.8723404255319149
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 30: 0.8829787234042553
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 36: 0.9042553191489362
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 37: 0.9042553191489362
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 38: 0.8829787234042553
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.005120000000000002
Val acc before epoch 40: 0.8936170212765957
Warm optimizer lr: 0.005120000000000002
Val acc before epoch 41: 0.9042553191489362
Warm optimizer lr: 0.005120000000000002
Val acc before epoch 42: 0.9042553191489362
Warm optimizer lr: 0.005120000000000002
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 0.005120000000000002
Val acc before epoch 44: 0.8936170212765957
Warm optimizer lr: 0.005120000000000002
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.005120000000000002
Val acc before epoch 46: 0.8936170212765957
Warm optimizer lr: 0.005120000000000002
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.0020480000000000008
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.0020480000000000008
Val acc before epoch 49: 0.9042553191489362
Warm optimizer lr: 0.0020480000000000008
Val acc before epoch 50: 0.9042553191489362
Warm optimizer lr: 0.0020480000000000008
Val acc before epoch 51: 0.8829787234042553
Warm optimizer lr: 0.0020480000000000008
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.0020480000000000008
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.0020480000000000008
Val acc before epoch 54: 0.9042553191489362
Warm optimizer lr: 0.0020480000000000008
Val acc before epoch 55: 0.8829787234042553
Warm optimizer lr: 0.0008192000000000004
Val acc before epoch 56: 0.9042553191489362
Warm optimizer lr: 0.0008192000000000004
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.0008192000000000004
Val acc before epoch 58: 0.9042553191489362
Warm optimizer lr: 0.0008192000000000004
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.0008192000000000004
Val acc before epoch 60: 0.9148936170212766
Warm optimizer lr: 0.0008192000000000004
Val acc before epoch 61: 0.9148936170212766
Warm optimizer lr: 0.0008192000000000004
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.0008192000000000004
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.00032768000000000017
Val acc before epoch 64: 0.9042553191489362
Warm optimizer lr: 0.00032768000000000017
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.00032768000000000017
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.00032768000000000017
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.00032768000000000017
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.00032768000000000017
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.00032768000000000017
Val acc before epoch 70: 0.925531914893617
Warm optimizer lr: 0.00032768000000000017
Val acc before epoch 71: 0.925531914893617
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 72: 0.9042553191489362
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 73: 0.925531914893617
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 75: 0.9148936170212766
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 76: 0.8936170212765957
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 77: 0.9361702127659575
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 79: 0.8829787234042553
Warm optimizer lr: 5.242880000000003e-05
Val acc before epoch 80: 0.9468085106382979
Warm optimizer lr: 5.242880000000003e-05
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 5.242880000000003e-05
Val acc before epoch 82: 0.9042553191489362
Warm optimizer lr: 5.242880000000003e-05
Val acc before epoch 83: 0.9148936170212766
Warm optimizer lr: 5.242880000000003e-05
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 5.242880000000003e-05
Val acc before epoch 85: 0.8829787234042553
Warm optimizer lr: 5.242880000000003e-05
Val acc before epoch 86: 0.9042553191489362
Warm optimizer lr: 5.242880000000003e-05
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 90: 0.9361702127659575
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 91: 0.8936170212765957
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 92: 0.9680851063829787
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 93: 0.9148936170212766
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 94: 0.925531914893617
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 95: 0.9148936170212766
Warm optimizer lr: 8.388608000000005e-06
Val acc before epoch 96: 0.925531914893617
Warm optimizer lr: 8.388608000000005e-06
Val acc before epoch 97: 0.8829787234042553
Warm optimizer lr: 8.388608000000005e-06
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 8.388608000000005e-06
Val acc before epoch 99: 0.925531914893617
Stopping after epoch 100.
Final validation accuracy before push: 0.925531914893617
Push number 1
After push, before retraining last layer:
	Train acc: 0.7596153846153846
	Train Cluster: 0.629901933670044
	TrainSeparation: 0.507870888710022
(Directly after push 2) Val acc at iteration 0: 0.5851063829787234
Retraining last layer
Last layer lr: 0.001

Attempting combination 13/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.35
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.46808510638297873
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.7340425531914894
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.175
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.175
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.175
Val acc before epoch 10: 0.9468085106382979
Warm optimizer lr: 0.175
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.175
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.175
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.175
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.175
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.06124999999999999
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.06124999999999999
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.06124999999999999
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.06124999999999999
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.06124999999999999
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.06124999999999999
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.06124999999999999
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.06124999999999999
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.021437499999999995
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.021437499999999995
Val acc before epoch 25: 0.9042553191489362
Warm optimizer lr: 0.021437499999999995
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.021437499999999995
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.021437499999999995
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.021437499999999995
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.021437499999999995
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.021437499999999995
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.007503124999999998
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.007503124999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.007503124999999998
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.007503124999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.007503124999999998
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.007503124999999998
Val acc before epoch 37: 0.9148936170212766
Warm optimizer lr: 0.007503124999999998
Val acc before epoch 38: 0.925531914893617
Warm optimizer lr: 0.007503124999999998
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.002626093749999999
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.002626093749999999
Val acc before epoch 41: 0.9148936170212766
Warm optimizer lr: 0.002626093749999999
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.002626093749999999
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.002626093749999999
Val acc before epoch 44: 0.9148936170212766
Warm optimizer lr: 0.002626093749999999
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.002626093749999999
Val acc before epoch 46: 0.9042553191489362
Warm optimizer lr: 0.002626093749999999
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.0009191328124999996
Val acc before epoch 48: 0.9148936170212766
Warm optimizer lr: 0.0009191328124999996
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.0009191328124999996
Val acc before epoch 50: 0.925531914893617
Warm optimizer lr: 0.0009191328124999996
Val acc before epoch 51: 0.9042553191489362
Warm optimizer lr: 0.0009191328124999996
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.0009191328124999996
Val acc before epoch 53: 0.9148936170212766
Warm optimizer lr: 0.0009191328124999996
Val acc before epoch 54: 0.8936170212765957
Warm optimizer lr: 0.0009191328124999996
Val acc before epoch 55: 0.9148936170212766
Warm optimizer lr: 0.00032169648437499986
Val acc before epoch 56: 0.925531914893617
Warm optimizer lr: 0.00032169648437499986
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.00032169648437499986
Val acc before epoch 58: 0.925531914893617
Warm optimizer lr: 0.00032169648437499986
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.00032169648437499986
Val acc before epoch 60: 0.9042553191489362
Warm optimizer lr: 0.00032169648437499986
Val acc before epoch 61: 0.9148936170212766
Warm optimizer lr: 0.00032169648437499986
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.00032169648437499986
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.00011259376953124994
Val acc before epoch 64: 0.9042553191489362
Warm optimizer lr: 0.00011259376953124994
Val acc before epoch 65: 0.925531914893617
Warm optimizer lr: 0.00011259376953124994
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.00011259376953124994
Val acc before epoch 67: 0.9042553191489362
Warm optimizer lr: 0.00011259376953124994
Val acc before epoch 68: 0.9148936170212766
Warm optimizer lr: 0.00011259376953124994
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.00011259376953124994
Val acc before epoch 70: 0.8936170212765957
Warm optimizer lr: 0.00011259376953124994
Val acc before epoch 71: 0.9468085106382979
Warm optimizer lr: 3.940781933593748e-05
Val acc before epoch 72: 0.9148936170212766
Warm optimizer lr: 3.940781933593748e-05
Val acc before epoch 73: 0.9468085106382979
Warm optimizer lr: 3.940781933593748e-05
Val acc before epoch 74: 0.9148936170212766
Warm optimizer lr: 3.940781933593748e-05
Val acc before epoch 75: 0.9042553191489362
Warm optimizer lr: 3.940781933593748e-05
Val acc before epoch 76: 0.9148936170212766
Warm optimizer lr: 3.940781933593748e-05
Val acc before epoch 77: 0.925531914893617
Warm optimizer lr: 3.940781933593748e-05
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 3.940781933593748e-05
Val acc before epoch 79: 0.9574468085106383
Warm optimizer lr: 1.3792736767578117e-05
Val acc before epoch 80: 0.925531914893617
Warm optimizer lr: 1.3792736767578117e-05
Val acc before epoch 81: 0.9148936170212766
Warm optimizer lr: 1.3792736767578117e-05
Val acc before epoch 82: 0.925531914893617
Warm optimizer lr: 1.3792736767578117e-05
Val acc before epoch 83: 0.925531914893617
Warm optimizer lr: 1.3792736767578117e-05
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 1.3792736767578117e-05
Val acc before epoch 85: 0.9361702127659575
Warm optimizer lr: 1.3792736767578117e-05
Val acc before epoch 86: 0.8723404255319149
Warm optimizer lr: 1.3792736767578117e-05
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 4.827457868652341e-06
Val acc before epoch 88: 0.9148936170212766
Warm optimizer lr: 4.827457868652341e-06
Val acc before epoch 89: 0.8936170212765957
Warm optimizer lr: 4.827457868652341e-06
Val acc before epoch 90: 0.925531914893617
Warm optimizer lr: 4.827457868652341e-06
Val acc before epoch 91: 0.9148936170212766
Warm optimizer lr: 4.827457868652341e-06
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 4.827457868652341e-06
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 4.827457868652341e-06
Val acc before epoch 94: 0.8936170212765957
Warm optimizer lr: 4.827457868652341e-06
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 1.689610254028319e-06
Val acc before epoch 96: 0.9148936170212766
Warm optimizer lr: 1.689610254028319e-06
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 1.689610254028319e-06
Val acc before epoch 98: 0.925531914893617
Warm optimizer lr: 1.689610254028319e-06
Val acc before epoch 99: 0.925531914893617
Stopping after epoch 100.
Final validation accuracy before push: 0.925531914893617
Push number 1
After push, before retraining last layer:
	Train acc: 0.7483974358974359
	Train Cluster: 0.6350578427314758
	TrainSeparation: 0.5095818638801575
(Directly after push 2) Val acc at iteration 0: 0.6170212765957447
Retraining last layer
Last layer lr: 0.001

Attempting combination 14/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.3
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.7340425531914894
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.15
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.15
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.15
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.15
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.15
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.15
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.15
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.045
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.045
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.045
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.045
Val acc before epoch 19: 0.9574468085106383
Warm optimizer lr: 0.045
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.045
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.045
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.045
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.0135
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.0135
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.0135
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.0135
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.0135
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.0135
Val acc before epoch 29: 0.9680851063829787
Warm optimizer lr: 0.0135
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.0135
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.00405
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.00405
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.00405
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.00405
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.00405
Val acc before epoch 36: 0.9148936170212766
Warm optimizer lr: 0.00405
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.00405
Val acc before epoch 38: 0.9148936170212766
Warm optimizer lr: 0.00405
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.001215
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.001215
Val acc before epoch 41: 0.8936170212765957
Warm optimizer lr: 0.001215
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.001215
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.001215
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.001215
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.001215
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.001215
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.00036449999999999997
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 0.00036449999999999997
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.00036449999999999997
Val acc before epoch 50: 0.9042553191489362
Warm optimizer lr: 0.00036449999999999997
Val acc before epoch 51: 0.9148936170212766
Warm optimizer lr: 0.00036449999999999997
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.00036449999999999997
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.00036449999999999997
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.00036449999999999997
Val acc before epoch 55: 0.9680851063829787
Warm optimizer lr: 0.00010934999999999999
Val acc before epoch 56: 0.925531914893617
Warm optimizer lr: 0.00010934999999999999
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.00010934999999999999
Val acc before epoch 58: 0.925531914893617
Warm optimizer lr: 0.00010934999999999999
Val acc before epoch 59: 0.9148936170212766
Warm optimizer lr: 0.00010934999999999999
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.00010934999999999999
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.00010934999999999999
Val acc before epoch 62: 0.8936170212765957
Warm optimizer lr: 0.00010934999999999999
Val acc before epoch 63: 0.8936170212765957
Warm optimizer lr: 3.2804999999999995e-05
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 3.2804999999999995e-05
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 3.2804999999999995e-05
Val acc before epoch 66: 0.9148936170212766
Warm optimizer lr: 3.2804999999999995e-05
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 3.2804999999999995e-05
Val acc before epoch 68: 0.9148936170212766
Warm optimizer lr: 3.2804999999999995e-05
Val acc before epoch 69: 0.9148936170212766
Warm optimizer lr: 3.2804999999999995e-05
Val acc before epoch 70: 0.9361702127659575
Warm optimizer lr: 3.2804999999999995e-05
Val acc before epoch 71: 0.9574468085106383
Warm optimizer lr: 9.841499999999999e-06
Val acc before epoch 72: 0.9148936170212766
Warm optimizer lr: 9.841499999999999e-06
Val acc before epoch 73: 0.9361702127659575
Warm optimizer lr: 9.841499999999999e-06
Val acc before epoch 74: 0.9468085106382979
Warm optimizer lr: 9.841499999999999e-06
Val acc before epoch 75: 0.8936170212765957
Warm optimizer lr: 9.841499999999999e-06
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 9.841499999999999e-06
Val acc before epoch 77: 0.9042553191489362
Warm optimizer lr: 9.841499999999999e-06
Val acc before epoch 78: 0.9042553191489362
Warm optimizer lr: 9.841499999999999e-06
Val acc before epoch 79: 0.9042553191489362
Warm optimizer lr: 2.9524499999999996e-06
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 2.9524499999999996e-06
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 2.9524499999999996e-06
Val acc before epoch 82: 0.925531914893617
Warm optimizer lr: 2.9524499999999996e-06
Val acc before epoch 83: 0.9468085106382979
Warm optimizer lr: 2.9524499999999996e-06
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 2.9524499999999996e-06
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 2.9524499999999996e-06
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 2.9524499999999996e-06
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 8.857349999999999e-07
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 8.857349999999999e-07
Val acc before epoch 89: 0.8936170212765957
Warm optimizer lr: 8.857349999999999e-07
Val acc before epoch 90: 0.9148936170212766
Warm optimizer lr: 8.857349999999999e-07
Val acc before epoch 91: 0.9468085106382979
Warm optimizer lr: 8.857349999999999e-07
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 8.857349999999999e-07
Val acc before epoch 93: 0.9148936170212766
Warm optimizer lr: 8.857349999999999e-07
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 8.857349999999999e-07
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 2.6572049999999993e-07
Val acc before epoch 96: 0.925531914893617
Warm optimizer lr: 2.6572049999999993e-07
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 2.6572049999999993e-07
Val acc before epoch 98: 0.925531914893617
Warm optimizer lr: 2.6572049999999993e-07
Val acc before epoch 99: 0.9574468085106383
Stopping after epoch 100.
Final validation accuracy before push: 0.9574468085106383
Push number 1
After push, before retraining last layer:
	Train acc: 0.7740384615384616
	Train Cluster: 0.6355099320411682
	TrainSeparation: 0.5079585611820221
(Directly after push 2) Val acc at iteration 0: 0.6914893617021277
Retraining last layer
Last layer lr: 0.001

Attempting combination 15/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.25
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.125
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.125
Val acc before epoch 9: 0.8404255319148937
Warm optimizer lr: 0.125
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.125
Val acc before epoch 11: 0.8617021276595744
Warm optimizer lr: 0.125
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.125
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.125
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.125
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.03125
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.03125
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.03125
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.03125
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.03125
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.03125
Val acc before epoch 21: 0.8617021276595744
Warm optimizer lr: 0.03125
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.0078125
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.0078125
Val acc before epoch 25: 0.8829787234042553
Warm optimizer lr: 0.0078125
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.0078125
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.0078125
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.0078125
Val acc before epoch 29: 0.8723404255319149
Warm optimizer lr: 0.0078125
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.0078125
Val acc before epoch 31: 0.8723404255319149
Warm optimizer lr: 0.001953125
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.001953125
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.001953125
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.001953125
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.001953125
Val acc before epoch 36: 0.9042553191489362
Warm optimizer lr: 0.001953125
Val acc before epoch 37: 0.9042553191489362
Warm optimizer lr: 0.001953125
Val acc before epoch 38: 0.9361702127659575
Warm optimizer lr: 0.001953125
Val acc before epoch 39: 0.8936170212765957
Warm optimizer lr: 0.00048828125
Val acc before epoch 40: 0.8936170212765957
Warm optimizer lr: 0.00048828125
Val acc before epoch 41: 0.8723404255319149
Warm optimizer lr: 0.00048828125
Val acc before epoch 42: 0.8829787234042553
Warm optimizer lr: 0.00048828125
Val acc before epoch 43: 0.9042553191489362
Warm optimizer lr: 0.00048828125
Val acc before epoch 44: 0.8829787234042553
Warm optimizer lr: 0.00048828125
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.00048828125
Val acc before epoch 46: 0.8617021276595744
Warm optimizer lr: 0.00048828125
Val acc before epoch 47: 0.9042553191489362
Warm optimizer lr: 0.0001220703125
Val acc before epoch 48: 0.8723404255319149
Warm optimizer lr: 0.0001220703125
Val acc before epoch 49: 0.9148936170212766
Warm optimizer lr: 0.0001220703125
Val acc before epoch 50: 0.8723404255319149
Warm optimizer lr: 0.0001220703125
Val acc before epoch 51: 0.8617021276595744
Warm optimizer lr: 0.0001220703125
Val acc before epoch 52: 0.8617021276595744
Warm optimizer lr: 0.0001220703125
Val acc before epoch 53: 0.9042553191489362
Warm optimizer lr: 0.0001220703125
Val acc before epoch 54: 0.8723404255319149
Warm optimizer lr: 0.0001220703125
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 3.0517578125e-05
Val acc before epoch 56: 0.8723404255319149
Warm optimizer lr: 3.0517578125e-05
Val acc before epoch 57: 0.8617021276595744
Warm optimizer lr: 3.0517578125e-05
Val acc before epoch 58: 0.8829787234042553
Warm optimizer lr: 3.0517578125e-05
Val acc before epoch 59: 0.9042553191489362
Warm optimizer lr: 3.0517578125e-05
Val acc before epoch 60: 0.9148936170212766
Warm optimizer lr: 3.0517578125e-05
Val acc before epoch 61: 0.8723404255319149
Warm optimizer lr: 3.0517578125e-05
Val acc before epoch 62: 0.8829787234042553
Warm optimizer lr: 3.0517578125e-05
Val acc before epoch 63: 0.9148936170212766
Warm optimizer lr: 7.62939453125e-06
Val acc before epoch 64: 0.9148936170212766
Warm optimizer lr: 7.62939453125e-06
Val acc before epoch 65: 0.8936170212765957
Warm optimizer lr: 7.62939453125e-06
Val acc before epoch 66: 0.9042553191489362
Warm optimizer lr: 7.62939453125e-06
Val acc before epoch 67: 0.8723404255319149
Warm optimizer lr: 7.62939453125e-06
Val acc before epoch 68: 0.8936170212765957
Warm optimizer lr: 7.62939453125e-06
Val acc before epoch 69: 0.9042553191489362
Warm optimizer lr: 7.62939453125e-06
Val acc before epoch 70: 0.9361702127659575
Warm optimizer lr: 7.62939453125e-06
Val acc before epoch 71: 0.8723404255319149
Warm optimizer lr: 1.9073486328125e-06
Val acc before epoch 72: 0.9042553191489362
Warm optimizer lr: 1.9073486328125e-06
Val acc before epoch 73: 0.8723404255319149
Warm optimizer lr: 1.9073486328125e-06
Val acc before epoch 74: 0.9042553191489362
Warm optimizer lr: 1.9073486328125e-06
Val acc before epoch 75: 0.8723404255319149
Warm optimizer lr: 1.9073486328125e-06
Val acc before epoch 76: 0.9148936170212766
Warm optimizer lr: 1.9073486328125e-06
Val acc before epoch 77: 0.9042553191489362
Warm optimizer lr: 1.9073486328125e-06
Val acc before epoch 78: 0.8829787234042553
Warm optimizer lr: 1.9073486328125e-06
Val acc before epoch 79: 0.8723404255319149
Warm optimizer lr: 4.76837158203125e-07
Val acc before epoch 80: 0.8936170212765957
Warm optimizer lr: 4.76837158203125e-07
Val acc before epoch 81: 0.8617021276595744
Warm optimizer lr: 4.76837158203125e-07
Val acc before epoch 82: 0.8936170212765957
Warm optimizer lr: 4.76837158203125e-07
Val acc before epoch 83: 0.9042553191489362
Warm optimizer lr: 4.76837158203125e-07
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 4.76837158203125e-07
Val acc before epoch 85: 0.8936170212765957
Warm optimizer lr: 4.76837158203125e-07
Val acc before epoch 86: 0.9042553191489362
Warm optimizer lr: 4.76837158203125e-07
Val acc before epoch 87: 0.9042553191489362
Warm optimizer lr: 1.1920928955078125e-07
Val acc before epoch 88: 0.9042553191489362
Warm optimizer lr: 1.1920928955078125e-07
Val acc before epoch 89: 0.9148936170212766
Warm optimizer lr: 1.1920928955078125e-07
Val acc before epoch 90: 0.8829787234042553
Warm optimizer lr: 1.1920928955078125e-07
Val acc before epoch 91: 0.8829787234042553
Warm optimizer lr: 1.1920928955078125e-07
Val acc before epoch 92: 0.8723404255319149
Warm optimizer lr: 1.1920928955078125e-07
Val acc before epoch 93: 0.9148936170212766
Warm optimizer lr: 1.1920928955078125e-07
Val acc before epoch 94: 0.8829787234042553
Warm optimizer lr: 1.1920928955078125e-07
Val acc before epoch 95: 0.851063829787234
Warm optimizer lr: 2.9802322387695312e-08
Val acc before epoch 96: 0.9042553191489362
Warm optimizer lr: 2.9802322387695312e-08
Val acc before epoch 97: 0.9148936170212766
Warm optimizer lr: 2.9802322387695312e-08
Val acc before epoch 98: 0.851063829787234
Warm optimizer lr: 2.9802322387695312e-08
Val acc before epoch 99: 0.9042553191489362
Stopping after epoch 100.
Final validation accuracy before push: 0.9042553191489362
Push number 1
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Train Cluster: 0.6432820677757263
	TrainSeparation: 0.5166557669639588
(Directly after push 2) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.001

Attempting combination 16/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.2
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.4148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6063829787234043
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.6276595744680851
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.7659574468085106
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.7978723404255319
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 20: 0.851063829787234
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 22: 0.8936170212765957
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 24: 0.8723404255319149
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 25: 0.8723404255319149
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 29: 0.851063829787234
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 30: 0.8297872340425532
Warm optimizer lr: 0.004000000000000001
Val acc before epoch 31: 0.851063829787234
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 32: 0.8723404255319149
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 35: 0.8723404255319149
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 36: 0.8404255319148937
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 37: 0.8617021276595744
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 38: 0.8723404255319149
Warm optimizer lr: 0.0008000000000000003
Val acc before epoch 39: 0.8829787234042553
Warm optimizer lr: 0.00016000000000000007
Val acc before epoch 40: 0.8723404255319149
Warm optimizer lr: 0.00016000000000000007
Val acc before epoch 41: 0.8404255319148937
Warm optimizer lr: 0.00016000000000000007
Val acc before epoch 42: 0.8404255319148937
Warm optimizer lr: 0.00016000000000000007
Val acc before epoch 43: 0.851063829787234
Warm optimizer lr: 0.00016000000000000007
Val acc before epoch 44: 0.8617021276595744
Warm optimizer lr: 0.00016000000000000007
Val acc before epoch 45: 0.8723404255319149
Warm optimizer lr: 0.00016000000000000007
Val acc before epoch 46: 0.8297872340425532
Warm optimizer lr: 0.00016000000000000007
Val acc before epoch 47: 0.851063829787234
Warm optimizer lr: 3.200000000000001e-05
Val acc before epoch 48: 0.8723404255319149
Warm optimizer lr: 3.200000000000001e-05
Val acc before epoch 49: 0.8617021276595744
Warm optimizer lr: 3.200000000000001e-05
Val acc before epoch 50: 0.8404255319148937
Warm optimizer lr: 3.200000000000001e-05
Val acc before epoch 51: 0.8617021276595744
Warm optimizer lr: 3.200000000000001e-05
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 3.200000000000001e-05
Val acc before epoch 53: 0.8404255319148937
Warm optimizer lr: 3.200000000000001e-05
Val acc before epoch 54: 0.851063829787234
Warm optimizer lr: 3.200000000000001e-05
Val acc before epoch 55: 0.8617021276595744
Warm optimizer lr: 6.400000000000003e-06
Val acc before epoch 56: 0.8404255319148937
Warm optimizer lr: 6.400000000000003e-06
Val acc before epoch 57: 0.851063829787234
Warm optimizer lr: 6.400000000000003e-06
Val acc before epoch 58: 0.8617021276595744
Warm optimizer lr: 6.400000000000003e-06
Val acc before epoch 59: 0.8617021276595744
Warm optimizer lr: 6.400000000000003e-06
Val acc before epoch 60: 0.8723404255319149
Warm optimizer lr: 6.400000000000003e-06
Val acc before epoch 61: 0.8829787234042553
Warm optimizer lr: 6.400000000000003e-06
Val acc before epoch 62: 0.8936170212765957
Warm optimizer lr: 6.400000000000003e-06
Val acc before epoch 63: 0.8829787234042553
Warm optimizer lr: 1.2800000000000007e-06
Val acc before epoch 64: 0.8723404255319149
Warm optimizer lr: 1.2800000000000007e-06
Val acc before epoch 65: 0.851063829787234
Warm optimizer lr: 1.2800000000000007e-06
Val acc before epoch 66: 0.8617021276595744
Warm optimizer lr: 1.2800000000000007e-06
Val acc before epoch 67: 0.851063829787234
Warm optimizer lr: 1.2800000000000007e-06
Val acc before epoch 68: 0.8829787234042553
Warm optimizer lr: 1.2800000000000007e-06
Val acc before epoch 69: 0.851063829787234
Warm optimizer lr: 1.2800000000000007e-06
Val acc before epoch 70: 0.8404255319148937
Warm optimizer lr: 1.2800000000000007e-06
Val acc before epoch 71: 0.8936170212765957
Warm optimizer lr: 2.560000000000001e-07
Val acc before epoch 72: 0.8617021276595744
Warm optimizer lr: 2.560000000000001e-07
Val acc before epoch 73: 0.8723404255319149
Warm optimizer lr: 2.560000000000001e-07
Val acc before epoch 74: 0.8723404255319149
Warm optimizer lr: 2.560000000000001e-07
Val acc before epoch 75: 0.851063829787234
Warm optimizer lr: 2.560000000000001e-07
Val acc before epoch 76: 0.851063829787234
Warm optimizer lr: 2.560000000000001e-07
Val acc before epoch 77: 0.8723404255319149
Warm optimizer lr: 2.560000000000001e-07
Val acc before epoch 78: 0.8723404255319149
Warm optimizer lr: 2.560000000000001e-07
Val acc before epoch 79: 0.8829787234042553
Warm optimizer lr: 5.120000000000003e-08
Val acc before epoch 80: 0.851063829787234
Warm optimizer lr: 5.120000000000003e-08
Val acc before epoch 81: 0.8617021276595744
Warm optimizer lr: 5.120000000000003e-08
Val acc before epoch 82: 0.8617021276595744
Warm optimizer lr: 5.120000000000003e-08
Val acc before epoch 83: 0.851063829787234
Warm optimizer lr: 5.120000000000003e-08
Val acc before epoch 84: 0.8617021276595744
Warm optimizer lr: 5.120000000000003e-08
Val acc before epoch 85: 0.8936170212765957
Warm optimizer lr: 5.120000000000003e-08
Val acc before epoch 86: 0.8723404255319149
Warm optimizer lr: 5.120000000000003e-08
Val acc before epoch 87: 0.851063829787234
Warm optimizer lr: 1.0240000000000006e-08
Val acc before epoch 88: 0.8723404255319149
Warm optimizer lr: 1.0240000000000006e-08
Val acc before epoch 89: 0.8936170212765957
Warm optimizer lr: 1.0240000000000006e-08
Val acc before epoch 90: 0.8723404255319149
Warm optimizer lr: 1.0240000000000006e-08
Val acc before epoch 91: 0.8191489361702128
Warm optimizer lr: 1.0240000000000006e-08
Val acc before epoch 92: 0.8829787234042553
Warm optimizer lr: 1.0240000000000006e-08
Val acc before epoch 93: 0.8829787234042553
Warm optimizer lr: 1.0240000000000006e-08
Val acc before epoch 94: 0.851063829787234
Warm optimizer lr: 1.0240000000000006e-08
Val acc before epoch 95: 0.8936170212765957
Warm optimizer lr: 2.048000000000001e-09
Val acc before epoch 96: 0.9042553191489362
Warm optimizer lr: 2.048000000000001e-09
Val acc before epoch 97: 0.851063829787234
Warm optimizer lr: 2.048000000000001e-09
Val acc before epoch 98: 0.8617021276595744
Warm optimizer lr: 2.048000000000001e-09
Val acc before epoch 99: 0.8617021276595744
Stopping after epoch 100.
Final validation accuracy before push: 0.8617021276595744
Push number 1
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Train Cluster: 0.6417673468589783
	TrainSeparation: 0.5114467144012451
(Directly after push 2) Val acc at iteration 0: 0.5851063829787234
Retraining last layer
Last layer lr: 0.001

Attempting combination 17/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.15
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5531914893617021
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8085106382978723
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.075
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.075
Val acc before epoch 9: 0.851063829787234
Warm optimizer lr: 0.075
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.075
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.075
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.075
Val acc before epoch 13: 0.8723404255319149
Warm optimizer lr: 0.075
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.01125
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.01125
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.01125
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.01125
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.01125
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.01125
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.01125
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.01125
Val acc before epoch 23: 0.8723404255319149
Warm optimizer lr: 0.0016875
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.0016875
Val acc before epoch 25: 0.9574468085106383
Warm optimizer lr: 0.0016875
Val acc before epoch 26: 0.851063829787234
Warm optimizer lr: 0.0016875
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.0016875
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.0016875
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.0016875
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.0016875
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.000253125
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.000253125
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.000253125
Val acc before epoch 34: 0.8829787234042553
Warm optimizer lr: 0.000253125
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.000253125
Val acc before epoch 36: 0.8723404255319149
Warm optimizer lr: 0.000253125
Val acc before epoch 37: 0.8936170212765957
Warm optimizer lr: 0.000253125
Val acc before epoch 38: 0.9148936170212766
Warm optimizer lr: 0.000253125
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 3.796875e-05
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 3.796875e-05
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 3.796875e-05
Val acc before epoch 42: 0.8829787234042553
Warm optimizer lr: 3.796875e-05
Val acc before epoch 43: 0.9042553191489362
Warm optimizer lr: 3.796875e-05
Val acc before epoch 44: 0.8936170212765957
Warm optimizer lr: 3.796875e-05
Val acc before epoch 45: 0.8936170212765957
Warm optimizer lr: 3.796875e-05
Val acc before epoch 46: 0.9042553191489362
Warm optimizer lr: 3.796875e-05
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 5.6953124999999995e-06
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 5.6953124999999995e-06
Val acc before epoch 49: 0.8936170212765957
Warm optimizer lr: 5.6953124999999995e-06
Val acc before epoch 50: 0.9042553191489362
Warm optimizer lr: 5.6953124999999995e-06
Val acc before epoch 51: 0.9042553191489362
Warm optimizer lr: 5.6953124999999995e-06
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 5.6953124999999995e-06
Val acc before epoch 53: 0.9148936170212766
Warm optimizer lr: 5.6953124999999995e-06
Val acc before epoch 54: 0.8829787234042553
Warm optimizer lr: 5.6953124999999995e-06
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 8.542968749999999e-07
Val acc before epoch 56: 0.925531914893617
Warm optimizer lr: 8.542968749999999e-07
Val acc before epoch 57: 0.8829787234042553
Warm optimizer lr: 8.542968749999999e-07
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 8.542968749999999e-07
Val acc before epoch 59: 0.8936170212765957
Warm optimizer lr: 8.542968749999999e-07
Val acc before epoch 60: 0.8723404255319149
Warm optimizer lr: 8.542968749999999e-07
Val acc before epoch 61: 0.8829787234042553
Warm optimizer lr: 8.542968749999999e-07
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 8.542968749999999e-07
Val acc before epoch 63: 0.9148936170212766
Warm optimizer lr: 1.2814453124999998e-07
Val acc before epoch 64: 0.8829787234042553
Warm optimizer lr: 1.2814453124999998e-07
Val acc before epoch 65: 0.9148936170212766
Warm optimizer lr: 1.2814453124999998e-07
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 1.2814453124999998e-07
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 1.2814453124999998e-07
Val acc before epoch 68: 0.8829787234042553
Warm optimizer lr: 1.2814453124999998e-07
Val acc before epoch 69: 0.9148936170212766
Warm optimizer lr: 1.2814453124999998e-07
Val acc before epoch 70: 0.8936170212765957
Warm optimizer lr: 1.2814453124999998e-07
Val acc before epoch 71: 0.8936170212765957
Warm optimizer lr: 1.9221679687499998e-08
Val acc before epoch 72: 0.9148936170212766
Warm optimizer lr: 1.9221679687499998e-08
Val acc before epoch 73: 0.8723404255319149
Warm optimizer lr: 1.9221679687499998e-08
Val acc before epoch 74: 0.9042553191489362
Warm optimizer lr: 1.9221679687499998e-08
Val acc before epoch 75: 0.9361702127659575
Warm optimizer lr: 1.9221679687499998e-08
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 1.9221679687499998e-08
Val acc before epoch 77: 0.8936170212765957
Warm optimizer lr: 1.9221679687499998e-08
Val acc before epoch 78: 0.8936170212765957
Warm optimizer lr: 1.9221679687499998e-08
Val acc before epoch 79: 0.8936170212765957
Warm optimizer lr: 2.8832519531249996e-09
Val acc before epoch 80: 0.851063829787234
Warm optimizer lr: 2.8832519531249996e-09
Val acc before epoch 81: 0.9148936170212766
Warm optimizer lr: 2.8832519531249996e-09
Val acc before epoch 82: 0.925531914893617
Warm optimizer lr: 2.8832519531249996e-09
Val acc before epoch 83: 0.9361702127659575
Warm optimizer lr: 2.8832519531249996e-09
Val acc before epoch 84: 0.9042553191489362
Warm optimizer lr: 2.8832519531249996e-09
Val acc before epoch 85: 0.8936170212765957
Warm optimizer lr: 2.8832519531249996e-09
Val acc before epoch 86: 0.925531914893617
Warm optimizer lr: 2.8832519531249996e-09
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 4.3248779296874993e-10
Val acc before epoch 88: 0.8936170212765957
Warm optimizer lr: 4.3248779296874993e-10
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 4.3248779296874993e-10
Val acc before epoch 90: 0.9148936170212766
Warm optimizer lr: 4.3248779296874993e-10
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 4.3248779296874993e-10
Val acc before epoch 92: 0.851063829787234
Warm optimizer lr: 4.3248779296874993e-10
Val acc before epoch 93: 0.851063829787234
Warm optimizer lr: 4.3248779296874993e-10
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 4.3248779296874993e-10
Val acc before epoch 95: 0.8936170212765957
Warm optimizer lr: 6.487316894531248e-11
Val acc before epoch 96: 0.9042553191489362
Warm optimizer lr: 6.487316894531248e-11
Val acc before epoch 97: 0.8829787234042553
Warm optimizer lr: 6.487316894531248e-11
Val acc before epoch 98: 0.8829787234042553
Warm optimizer lr: 6.487316894531248e-11
Val acc before epoch 99: 0.8723404255319149
Stopping after epoch 100.
Final validation accuracy before push: 0.8723404255319149
Push number 1
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.6324190497398376
	TrainSeparation: 0.5077210903167725
(Directly after push 2) Val acc at iteration 0: 0.5638297872340425
Retraining last layer
Last layer lr: 0.001

Attempting combination 18/18:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 100
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.1
p0_warm_ptype_step_size: 40
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 99
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5531914893617021
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7978723404255319
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.8723404255319149
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.005000000000000001
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.005000000000000001
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.005000000000000001
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.005000000000000001
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.005000000000000001
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.005000000000000001
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.005000000000000001
Val acc before epoch 22: 0.8936170212765957
Warm optimizer lr: 0.005000000000000001
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.0005000000000000001
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.0005000000000000001
Val acc before epoch 25: 0.8829787234042553
Warm optimizer lr: 0.0005000000000000001
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.0005000000000000001
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.0005000000000000001
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.0005000000000000001
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.0005000000000000001
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.0005000000000000001
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 5.0000000000000016e-05
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 5.0000000000000016e-05
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 5.0000000000000016e-05
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 5.0000000000000016e-05
Val acc before epoch 35: 0.8829787234042553
Warm optimizer lr: 5.0000000000000016e-05
Val acc before epoch 36: 0.8723404255319149
Warm optimizer lr: 5.0000000000000016e-05
Val acc before epoch 37: 0.8723404255319149
Warm optimizer lr: 5.0000000000000016e-05
Val acc before epoch 38: 0.9148936170212766
Warm optimizer lr: 5.0000000000000016e-05
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 5.000000000000002e-06
Val acc before epoch 40: 0.8829787234042553
Warm optimizer lr: 5.000000000000002e-06
Val acc before epoch 41: 0.9148936170212766
Warm optimizer lr: 5.000000000000002e-06
Val acc before epoch 42: 0.9042553191489362
Warm optimizer lr: 5.000000000000002e-06
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 5.000000000000002e-06
Val acc before epoch 44: 0.851063829787234
Warm optimizer lr: 5.000000000000002e-06
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 5.000000000000002e-06
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 5.000000000000002e-06
Val acc before epoch 47: 0.8936170212765957
Warm optimizer lr: 5.000000000000002e-07
Val acc before epoch 48: 0.8936170212765957
Warm optimizer lr: 5.000000000000002e-07
Val acc before epoch 49: 0.8829787234042553
Warm optimizer lr: 5.000000000000002e-07
Val acc before epoch 50: 0.9042553191489362
Warm optimizer lr: 5.000000000000002e-07
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 5.000000000000002e-07
Val acc before epoch 52: 0.9042553191489362
Warm optimizer lr: 5.000000000000002e-07
Val acc before epoch 53: 0.8936170212765957
Warm optimizer lr: 5.000000000000002e-07
Val acc before epoch 54: 0.9042553191489362
Warm optimizer lr: 5.000000000000002e-07
Val acc before epoch 55: 0.8936170212765957
Warm optimizer lr: 5.0000000000000024e-08
Val acc before epoch 56: 0.925531914893617
Warm optimizer lr: 5.0000000000000024e-08
Val acc before epoch 57: 0.8936170212765957
Warm optimizer lr: 5.0000000000000024e-08
Val acc before epoch 58: 0.9042553191489362
Warm optimizer lr: 5.0000000000000024e-08
Val acc before epoch 59: 0.8829787234042553
Warm optimizer lr: 5.0000000000000024e-08
Val acc before epoch 60: 0.9042553191489362
Warm optimizer lr: 5.0000000000000024e-08
Val acc before epoch 61: 0.9148936170212766
Warm optimizer lr: 5.0000000000000024e-08
Val acc before epoch 62: 0.8829787234042553
Warm optimizer lr: 5.0000000000000024e-08
Val acc before epoch 63: 0.9148936170212766
Warm optimizer lr: 5.0000000000000026e-09
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 5.0000000000000026e-09
Val acc before epoch 65: 0.8723404255319149
Warm optimizer lr: 5.0000000000000026e-09
Val acc before epoch 66: 0.8936170212765957
Warm optimizer lr: 5.0000000000000026e-09
Val acc before epoch 67: 0.8297872340425532
Warm optimizer lr: 5.0000000000000026e-09
Val acc before epoch 68: 0.9148936170212766
Warm optimizer lr: 5.0000000000000026e-09
Val acc before epoch 69: 0.8723404255319149
Warm optimizer lr: 5.0000000000000026e-09
Val acc before epoch 70: 0.9148936170212766
Warm optimizer lr: 5.0000000000000026e-09
Val acc before epoch 71: 0.9042553191489362
Warm optimizer lr: 5.000000000000002e-10
Val acc before epoch 72: 0.925531914893617
Warm optimizer lr: 5.000000000000002e-10
Val acc before epoch 73: 0.9361702127659575
Warm optimizer lr: 5.000000000000002e-10
Val acc before epoch 74: 0.8936170212765957
Warm optimizer lr: 5.000000000000002e-10
Val acc before epoch 75: 0.9042553191489362
Warm optimizer lr: 5.000000000000002e-10
Val acc before epoch 76: 0.8829787234042553
Warm optimizer lr: 5.000000000000002e-10
Val acc before epoch 77: 0.9042553191489362
Warm optimizer lr: 5.000000000000002e-10
Val acc before epoch 78: 0.8829787234042553
Warm optimizer lr: 5.000000000000002e-10
Val acc before epoch 79: 0.8829787234042553
Warm optimizer lr: 5.000000000000003e-11
Val acc before epoch 80: 0.8936170212765957
Warm optimizer lr: 5.000000000000003e-11
Val acc before epoch 81: 0.8829787234042553
Warm optimizer lr: 5.000000000000003e-11
Val acc before epoch 82: 0.9148936170212766
Warm optimizer lr: 5.000000000000003e-11
Val acc before epoch 83: 0.8829787234042553
Warm optimizer lr: 5.000000000000003e-11
Val acc before epoch 84: 0.8829787234042553
Warm optimizer lr: 5.000000000000003e-11
Val acc before epoch 85: 0.9361702127659575
Warm optimizer lr: 5.000000000000003e-11
Val acc before epoch 86: 0.9468085106382979
Warm optimizer lr: 5.000000000000003e-11
Val acc before epoch 87: 0.9042553191489362
Warm optimizer lr: 5.000000000000003e-12
Val acc before epoch 88: 0.8829787234042553
Warm optimizer lr: 5.000000000000003e-12
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 5.000000000000003e-12
Val acc before epoch 90: 0.8723404255319149
Warm optimizer lr: 5.000000000000003e-12
Val acc before epoch 91: 0.8936170212765957
Warm optimizer lr: 5.000000000000003e-12
Val acc before epoch 92: 0.8829787234042553
Warm optimizer lr: 5.000000000000003e-12
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 5.000000000000003e-12
Val acc before epoch 94: 0.8829787234042553
Warm optimizer lr: 5.000000000000003e-12
Val acc before epoch 95: 0.8723404255319149
Warm optimizer lr: 5.000000000000003e-13
Val acc before epoch 96: 0.9042553191489362
Warm optimizer lr: 5.000000000000003e-13
Val acc before epoch 97: 0.925531914893617
Warm optimizer lr: 5.000000000000003e-13
Val acc before epoch 98: 0.9148936170212766
Warm optimizer lr: 5.000000000000003e-13
Val acc before epoch 99: 0.9148936170212766
Stopping after epoch 100.
Final validation accuracy before push: 0.9148936170212766
Push number 1
After push, before retraining last layer:
	Train acc: 0.7548076923076923
	Train Cluster: 0.6302646636962891
	TrainSeparation: 0.5065764546394348
(Directly after push 2) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: 0.001
Finished search.
