===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Mon Apr  1 02:40:52 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-04-01 02:42:38.057721: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-04-01 02:42:40.058745: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-04-01 02:42:40.081941: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-04-01 02:42:40.085880: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-04-01 02:42:40.945294: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94
Hyperparameters: {'prototype_shape': [(468, 520, 29)], 'latent_weight': [0.9], 'num_warm_epochs': [1000000], 'push_gap': [0], 'num_pushes': [1], 'last_layer_epochs': [0], 'crs_ent_weight': [1], 'clst_weight': [-9.600000000000001], 'sep_weight': [2.4], 'l1_weight': [0.001], 'push_start': [70], 'p0_warm_ptype_lr': [0.001, 0.005, 0.0075, 0.01, 0.025, 0.05, 0.075, 0.1, 0.25, 0.5], 'p0_warm_ptype_gamma': [-1], 'p0_warm_ptype_step_size': [360], 'p1_last_layer_lr': [0.001], 'p1_warm_ptype_lr': [0.28], 'p1_warm_ptype_gamma': [0.8], 'p1_warm_ptype_step_size': [100], 'p2_last_layer_lr': [0.0007], 'p2_warm_ptype_lr': [0.1], 'p2_warm_ptype_gamma': [-1], 'p2_warm_ptype_step_size': [100], 'p3_last_layer_lr': [7.5e-05], 'p3_warm_ptype_lr': [0.05], 'p3_warm_ptype_gamma': [-1], 'p3_warm_ptype_step_size': [100], 'p4_last_layer_lr': [7.5e-06], 'p4_warm_ptype_lr': [0.05], 'p4_warm_ptype_gamma': [-1], 'p4_warm_ptype_step_size': [100], 'joint_weight_decay': [-1], 'joint_lr_step_size': [-1], 'joint_gamma': [-1], 'joint_optimizer_lrs': [{'features': -1, 'prototype_vectors': -1}]}


Checking hyperparameters: {'p0_warm_ptype_lr': [0.001, 0.005, 0.0075, 0.01, 0.025, 0.05, 0.075, 0.1, 0.25, 0.5]}




Exploring 10 hyperparameter combinations for grid search.


Attempting combination 1/10:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.001
p0_warm_ptype_gamma: -1
p0_warm_ptype_step_size: 360
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 69
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.001
Val acc before epoch 1: 0.0
Warm optimizer lr: 0.001
Val acc before epoch 2: 0.0
Warm optimizer lr: 0.001
Val acc before epoch 3: 0.02127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 4: 0.02127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 5: 0.010638297872340425
Warm optimizer lr: 0.001
Val acc before epoch 6: 0.02127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 7: 0.0
Warm optimizer lr: 0.001
Val acc before epoch 8: 0.02127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 9: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 10: 0.010638297872340425
Warm optimizer lr: 0.001
Val acc before epoch 11: 0.010638297872340425
Warm optimizer lr: 0.001
Val acc before epoch 12: 0.02127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 13: 0.0425531914893617
Warm optimizer lr: 0.001
Val acc before epoch 14: 0.06382978723404255
Warm optimizer lr: 0.001
Val acc before epoch 15: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 16: 0.06382978723404255
Warm optimizer lr: 0.001
Val acc before epoch 17: 0.05319148936170213
Warm optimizer lr: 0.001
Val acc before epoch 18: 0.0425531914893617
Warm optimizer lr: 0.001
Val acc before epoch 19: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 20: 0.07446808510638298
Warm optimizer lr: 0.001
Val acc before epoch 21: 0.07446808510638298
Warm optimizer lr: 0.001
Val acc before epoch 22: 0.07446808510638298
Warm optimizer lr: 0.001
Val acc before epoch 23: 0.09574468085106383
Warm optimizer lr: 0.001
Val acc before epoch 24: 0.11702127659574468
Warm optimizer lr: 0.001
Val acc before epoch 25: 0.0851063829787234
Warm optimizer lr: 0.001
Val acc before epoch 26: 0.14893617021276595
Warm optimizer lr: 0.001
Val acc before epoch 27: 0.1276595744680851
Warm optimizer lr: 0.001
Val acc before epoch 28: 0.10638297872340426
Warm optimizer lr: 0.001
Val acc before epoch 29: 0.13829787234042554
Warm optimizer lr: 0.001
Val acc before epoch 30: 0.14893617021276595
Warm optimizer lr: 0.001
Val acc before epoch 31: 0.1702127659574468
Warm optimizer lr: 0.001
Val acc before epoch 32: 0.14893617021276595
Warm optimizer lr: 0.001
Val acc before epoch 33: 0.10638297872340426
Warm optimizer lr: 0.001
Val acc before epoch 34: 0.1595744680851064
Warm optimizer lr: 0.001
Val acc before epoch 35: 0.1276595744680851
Warm optimizer lr: 0.001
Val acc before epoch 36: 0.1702127659574468
Warm optimizer lr: 0.001
Val acc before epoch 37: 0.2127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 38: 0.2127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 39: 0.22340425531914893
Warm optimizer lr: 0.001
Val acc before epoch 40: 0.24468085106382978
Warm optimizer lr: 0.001
Val acc before epoch 41: 0.22340425531914893
Warm optimizer lr: 0.001
Val acc before epoch 42: 0.24468085106382978
Warm optimizer lr: 0.001
Val acc before epoch 43: 0.30851063829787234
Warm optimizer lr: 0.001
Val acc before epoch 44: 0.24468085106382978
Warm optimizer lr: 0.001
Val acc before epoch 45: 0.2553191489361702
Warm optimizer lr: 0.001
Val acc before epoch 46: 0.30851063829787234
Warm optimizer lr: 0.001
Val acc before epoch 47: 0.2553191489361702
Warm optimizer lr: 0.001
Val acc before epoch 48: 0.2765957446808511
Warm optimizer lr: 0.001
Val acc before epoch 49: 0.30851063829787234
Warm optimizer lr: 0.001
Val acc before epoch 50: 0.3404255319148936
Warm optimizer lr: 0.001
Val acc before epoch 51: 0.3191489361702128
Warm optimizer lr: 0.001
Val acc before epoch 52: 0.3191489361702128
Warm optimizer lr: 0.001
Val acc before epoch 53: 0.2872340425531915
Warm optimizer lr: 0.001
Val acc before epoch 54: 0.2978723404255319
Warm optimizer lr: 0.001
Val acc before epoch 55: 0.3191489361702128
Warm optimizer lr: 0.001
Val acc before epoch 56: 0.35106382978723405
Warm optimizer lr: 0.001
Val acc before epoch 57: 0.3191489361702128
Warm optimizer lr: 0.001
Val acc before epoch 58: 0.39361702127659576
Warm optimizer lr: 0.001
Val acc before epoch 59: 0.5
Warm optimizer lr: 0.001
Val acc before epoch 60: 0.44680851063829785
Warm optimizer lr: 0.001
Val acc before epoch 61: 0.3617021276595745
Warm optimizer lr: 0.001
Val acc before epoch 62: 0.5
Warm optimizer lr: 0.001
Val acc before epoch 63: 0.43617021276595747
Warm optimizer lr: 0.001
Val acc before epoch 64: 0.5
Warm optimizer lr: 0.001
Val acc before epoch 65: 0.5
Warm optimizer lr: 0.001
Val acc before epoch 66: 0.46808510638297873
Warm optimizer lr: 0.001
Val acc before epoch 67: 0.44680851063829785
Warm optimizer lr: 0.001
Val acc before epoch 68: 0.4787234042553192
Warm optimizer lr: 0.001
Val acc before epoch 69: 0.4787234042553192
Stopping after epoch 70.
Final validation accuracy before push: 0.4787234042553192
Push number 1
After push, before retraining last layer:
	Train acc: 0.8141025641025641
	Train Cluster: 0.6561073184013366
	TrainSeparation: 0.5167706251144409
(Directly after push 2) Val acc at iteration 0: 0.6382978723404256
Retraining last layer
Last layer lr: 0.001

Attempting combination 2/10:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.005
p0_warm_ptype_gamma: -1
p0_warm_ptype_step_size: 360
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 69
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.005
Val acc before epoch 1: 0.031914893617021274
Warm optimizer lr: 0.005
Val acc before epoch 2: 0.010638297872340425
Warm optimizer lr: 0.005
Val acc before epoch 3: 0.0851063829787234
Warm optimizer lr: 0.005
Val acc before epoch 4: 0.1276595744680851
Warm optimizer lr: 0.005
Val acc before epoch 5: 0.18085106382978725
Warm optimizer lr: 0.005
Val acc before epoch 6: 0.23404255319148937
Warm optimizer lr: 0.005
Val acc before epoch 7: 0.2872340425531915
Warm optimizer lr: 0.005
Val acc before epoch 8: 0.3191489361702128
Warm optimizer lr: 0.005
Val acc before epoch 9: 0.39361702127659576
Warm optimizer lr: 0.005
Val acc before epoch 10: 0.5212765957446809
Warm optimizer lr: 0.005
Val acc before epoch 11: 0.48936170212765956
Warm optimizer lr: 0.005
Val acc before epoch 12: 0.5957446808510638
Warm optimizer lr: 0.005
Val acc before epoch 13: 0.6382978723404256
Warm optimizer lr: 0.005
Val acc before epoch 14: 0.6382978723404256
Warm optimizer lr: 0.005
Val acc before epoch 15: 0.648936170212766
Warm optimizer lr: 0.005
Val acc before epoch 16: 0.6702127659574468
Warm optimizer lr: 0.005
Val acc before epoch 17: 0.7340425531914894
Warm optimizer lr: 0.005
Val acc before epoch 18: 0.8085106382978723
Warm optimizer lr: 0.005
Val acc before epoch 19: 0.7659574468085106
Warm optimizer lr: 0.005
Val acc before epoch 20: 0.7872340425531915
Warm optimizer lr: 0.005
Val acc before epoch 21: 0.776595744680851
Warm optimizer lr: 0.005
Val acc before epoch 22: 0.8297872340425532
Warm optimizer lr: 0.005
Val acc before epoch 23: 0.851063829787234
Warm optimizer lr: 0.005
Val acc before epoch 24: 0.7978723404255319
Warm optimizer lr: 0.005
Val acc before epoch 25: 0.8723404255319149
Warm optimizer lr: 0.005
Val acc before epoch 26: 0.8404255319148937
Warm optimizer lr: 0.005
Val acc before epoch 27: 0.8404255319148937
Warm optimizer lr: 0.005
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.005
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.005
Val acc before epoch 30: 0.8617021276595744
Warm optimizer lr: 0.005
Val acc before epoch 31: 0.8297872340425532
Warm optimizer lr: 0.005
Val acc before epoch 32: 0.851063829787234
Warm optimizer lr: 0.005
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.005
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.005
Val acc before epoch 35: 0.8617021276595744
Warm optimizer lr: 0.005
Val acc before epoch 36: 0.8936170212765957
Warm optimizer lr: 0.005
Val acc before epoch 37: 0.8829787234042553
Warm optimizer lr: 0.005
Val acc before epoch 38: 0.8723404255319149
Warm optimizer lr: 0.005
Val acc before epoch 39: 0.8723404255319149
Warm optimizer lr: 0.005
Val acc before epoch 40: 0.851063829787234
Warm optimizer lr: 0.005
Val acc before epoch 41: 0.8829787234042553
Warm optimizer lr: 0.005
Val acc before epoch 42: 0.8829787234042553
Warm optimizer lr: 0.005
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 0.005
Val acc before epoch 44: 0.9042553191489362
Warm optimizer lr: 0.005
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.005
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.005
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.005
Val acc before epoch 48: 0.8936170212765957
Warm optimizer lr: 0.005
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.005
Val acc before epoch 50: 0.9042553191489362
Warm optimizer lr: 0.005
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.005
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.005
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.005
Val acc before epoch 54: 0.9042553191489362
Warm optimizer lr: 0.005
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.005
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.005
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.005
Val acc before epoch 58: 0.9148936170212766
Warm optimizer lr: 0.005
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.005
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.005
Val acc before epoch 61: 0.9148936170212766
Warm optimizer lr: 0.005
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.005
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.005
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.005
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.005
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.005
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 0.005
Val acc before epoch 68: 0.9042553191489362
Warm optimizer lr: 0.005
Val acc before epoch 69: 0.9148936170212766
Stopping after epoch 70.
Final validation accuracy before push: 0.9148936170212766
Push number 1
After push, before retraining last layer:
	Train acc: 0.8365384615384616
	Train Cluster: 0.6505004167556763
	TrainSeparation: 0.5098677396774292
(Directly after push 2) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: 0.001

Attempting combination 3/10:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.0075
p0_warm_ptype_gamma: -1
p0_warm_ptype_step_size: 360
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 69
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.0075
Val acc before epoch 1: 0.02127659574468085
Warm optimizer lr: 0.0075
Val acc before epoch 2: 0.031914893617021274
Warm optimizer lr: 0.0075
Val acc before epoch 3: 0.1595744680851064
Warm optimizer lr: 0.0075
Val acc before epoch 4: 0.1702127659574468
Warm optimizer lr: 0.0075
Val acc before epoch 5: 0.2553191489361702
Warm optimizer lr: 0.0075
Val acc before epoch 6: 0.44680851063829785
Warm optimizer lr: 0.0075
Val acc before epoch 7: 0.5638297872340425
Warm optimizer lr: 0.0075
Val acc before epoch 8: 0.6170212765957447
Warm optimizer lr: 0.0075
Val acc before epoch 9: 0.6702127659574468
Warm optimizer lr: 0.0075
Val acc before epoch 10: 0.6808510638297872
Warm optimizer lr: 0.0075
Val acc before epoch 11: 0.8085106382978723
Warm optimizer lr: 0.0075
Val acc before epoch 12: 0.8191489361702128
Warm optimizer lr: 0.0075
Val acc before epoch 13: 0.8723404255319149
Warm optimizer lr: 0.0075
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.0075
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.0075
Val acc before epoch 16: 0.8297872340425532
Warm optimizer lr: 0.0075
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.0075
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.0075
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.0075
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.0075
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.0075
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.0075
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.0075
Val acc before epoch 24: 0.8723404255319149
Warm optimizer lr: 0.0075
Val acc before epoch 25: 0.851063829787234
Warm optimizer lr: 0.0075
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.0075
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.0075
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.0075
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.0075
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.0075
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.0075
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.0075
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.0075
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.0075
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.0075
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.0075
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.0075
Val acc before epoch 38: 0.9361702127659575
Warm optimizer lr: 0.0075
Val acc before epoch 39: 0.9148936170212766
Warm optimizer lr: 0.0075
Val acc before epoch 40: 0.9042553191489362
Warm optimizer lr: 0.0075
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.0075
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.0075
Val acc before epoch 43: 0.9042553191489362
Warm optimizer lr: 0.0075
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.0075
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.0075
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.0075
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.0075
Val acc before epoch 48: 0.9148936170212766
Warm optimizer lr: 0.0075
Val acc before epoch 49: 0.9680851063829787
Warm optimizer lr: 0.0075
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.0075
Val acc before epoch 51: 0.9042553191489362
Warm optimizer lr: 0.0075
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.0075
Val acc before epoch 53: 0.9680851063829787
Warm optimizer lr: 0.0075
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.0075
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.0075
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.0075
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.0075
Val acc before epoch 58: 0.9680851063829787
Warm optimizer lr: 0.0075
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.0075
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.0075
Val acc before epoch 61: 0.925531914893617
Warm optimizer lr: 0.0075
Val acc before epoch 62: 0.9680851063829787
Warm optimizer lr: 0.0075
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.0075
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.0075
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.0075
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.0075
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.0075
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.0075
Val acc before epoch 69: 0.9787234042553191
Stopping after epoch 70.
Final validation accuracy before push: 0.9787234042553191
Push number 1
After push, before retraining last layer:
	Train acc: 0.8605769230769231
	Train Cluster: 0.658762800693512
	TrainSeparation: 0.5095510005950927
(Directly after push 2) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.001

Attempting combination 4/10:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.01
p0_warm_ptype_gamma: -1
p0_warm_ptype_step_size: 360
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 69
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.01
Val acc before epoch 1: 0.02127659574468085
Warm optimizer lr: 0.01
Val acc before epoch 2: 0.0851063829787234
Warm optimizer lr: 0.01
Val acc before epoch 3: 0.19148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 4: 0.30851063829787234
Warm optimizer lr: 0.01
Val acc before epoch 5: 0.4787234042553192
Warm optimizer lr: 0.01
Val acc before epoch 6: 0.6382978723404256
Warm optimizer lr: 0.01
Val acc before epoch 7: 0.5638297872340425
Warm optimizer lr: 0.01
Val acc before epoch 8: 0.7127659574468085
Warm optimizer lr: 0.01
Val acc before epoch 9: 0.723404255319149
Warm optimizer lr: 0.01
Val acc before epoch 10: 0.7446808510638298
Warm optimizer lr: 0.01
Val acc before epoch 11: 0.7553191489361702
Warm optimizer lr: 0.01
Val acc before epoch 12: 0.7872340425531915
Warm optimizer lr: 0.01
Val acc before epoch 13: 0.8617021276595744
Warm optimizer lr: 0.01
Val acc before epoch 14: 0.8191489361702128
Warm optimizer lr: 0.01
Val acc before epoch 15: 0.8191489361702128
Warm optimizer lr: 0.01
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.01
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.01
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.01
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.01
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.01
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.01
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.01
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.01
Val acc before epoch 25: 0.851063829787234
Warm optimizer lr: 0.01
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.01
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.01
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.01
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.01
Val acc before epoch 36: 0.9042553191489362
Warm optimizer lr: 0.01
Val acc before epoch 37: 0.8723404255319149
Warm optimizer lr: 0.01
Val acc before epoch 38: 0.9148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.01
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.01
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.01
Val acc before epoch 42: 0.8936170212765957
Warm optimizer lr: 0.01
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.01
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.01
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.01
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.01
Val acc before epoch 47: 0.9574468085106383
Warm optimizer lr: 0.01
Val acc before epoch 48: 0.9680851063829787
Warm optimizer lr: 0.01
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.01
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.01
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 0.01
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.01
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.01
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.01
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.01
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.01
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.01
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.01
Val acc before epoch 59: 0.9680851063829787
Warm optimizer lr: 0.01
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.01
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.01
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.01
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.01
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.01
Val acc before epoch 65: 0.9680851063829787
Warm optimizer lr: 0.01
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.01
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 0.01
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.01
Val acc before epoch 69: 0.9574468085106383
Stopping after epoch 70.
Final validation accuracy before push: 0.9574468085106383
Push number 1
After push, before retraining last layer:
	Train acc: 0.8381410256410257
	Train Cluster: 0.6521464705467224
	TrainSeparation: 0.5111510157585144
(Directly after push 2) Val acc at iteration 0: 0.7978723404255319
Retraining last layer
Last layer lr: 0.001

Attempting combination 5/10:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.025
p0_warm_ptype_gamma: -1
p0_warm_ptype_step_size: 360
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 69
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.025
Val acc before epoch 1: 0.10638297872340426
Warm optimizer lr: 0.025
Val acc before epoch 2: 0.4148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 3: 0.648936170212766
Warm optimizer lr: 0.025
Val acc before epoch 4: 0.7127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 38: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 44: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 48: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 49: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 53: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 59: 0.9680851063829787
Warm optimizer lr: 0.025
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 63: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 67: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 69: 0.9468085106382979
Stopping after epoch 70.
Final validation accuracy before push: 0.9468085106382979
Push number 1
After push, before retraining last layer:
	Train acc: 0.8301282051282052
	Train Cluster: 0.6466912388801574
	TrainSeparation: 0.5075049281120301
(Directly after push 2) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.001

Attempting combination 6/10:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: -1
p0_warm_ptype_step_size: 360
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 69
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.23404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 40: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 41: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 44: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 48: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 49: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 54: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 59: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 60: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 62: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 66: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 68: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 69: 0.9468085106382979
Stopping after epoch 70.
Final validation accuracy before push: 0.9468085106382979
Push number 1
After push, before retraining last layer:
	Train acc: 0.8125
	Train Cluster: 0.6429083347320557
	TrainSeparation: 0.5064134657382965
(Directly after push 2) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.001

Attempting combination 7/10:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.075
p0_warm_ptype_gamma: -1
p0_warm_ptype_step_size: 360
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 69
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.075
Val acc before epoch 1: 0.3829787234042553
Warm optimizer lr: 0.075
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.075
Val acc before epoch 3: 0.8191489361702128
Warm optimizer lr: 0.075
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.075
Val acc before epoch 5: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 6: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 7: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 8: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.075
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.075
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.075
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.075
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 16: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.075
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 26: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 32: 0.9787234042553191
Warm optimizer lr: 0.075
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.075
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.075
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.075
Val acc before epoch 36: 0.9680851063829787
Warm optimizer lr: 0.075
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 40: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 41: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 44: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 45: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 47: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 48: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 54: 0.9680851063829787
Warm optimizer lr: 0.075
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.075
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 59: 0.9148936170212766
Warm optimizer lr: 0.075
Val acc before epoch 60: 0.9148936170212766
Warm optimizer lr: 0.075
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.075
Val acc before epoch 65: 0.9680851063829787
Warm optimizer lr: 0.075
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 69: 0.9468085106382979
Stopping after epoch 70.
Final validation accuracy before push: 0.9468085106382979
Push number 1
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Train Cluster: 0.6419883489608764
	TrainSeparation: 0.5059901952743531
(Directly after push 2) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.001

Attempting combination 8/10:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.1
p0_warm_ptype_gamma: -1
p0_warm_ptype_step_size: 360
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 69
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.425531914893617
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6063829787234043
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 25: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 36: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 39: 0.9787234042553191
Warm optimizer lr: 0.1
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 43: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 55: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 58: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 63: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 66: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 69: 0.925531914893617
Stopping after epoch 70.
Final validation accuracy before push: 0.925531914893617
Push number 1
After push, before retraining last layer:
	Train acc: 0.8285256410256411
	Train Cluster: 0.652223801612854
	TrainSeparation: 0.512547779083252
(Directly after push 2) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.001

Attempting combination 9/10:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.25
p0_warm_ptype_gamma: -1
p0_warm_ptype_step_size: 360
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 69
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.25
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.25
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.25
Val acc before epoch 3: 0.8297872340425532
Warm optimizer lr: 0.25
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.25
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.25
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 32: 0.9787234042553191
Warm optimizer lr: 0.25
Val acc before epoch 33: 0.9680851063829787
Warm optimizer lr: 0.25
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 39: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 40: 0.9680851063829787
Warm optimizer lr: 0.25
Val acc before epoch 41: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 42: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 47: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 48: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 49: 0.9680851063829787
Warm optimizer lr: 0.25
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 55: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 57: 0.9680851063829787
Warm optimizer lr: 0.25
Val acc before epoch 58: 0.9680851063829787
Warm optimizer lr: 0.25
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 60: 0.9680851063829787
Warm optimizer lr: 0.25
Val acc before epoch 61: 0.9787234042553191
Warm optimizer lr: 0.25
Val acc before epoch 62: 0.9893617021276596
Warm optimizer lr: 0.25
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 65: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 69: 0.9574468085106383
Stopping after epoch 70.
Final validation accuracy before push: 0.9574468085106383
Push number 1
After push, before retraining last layer:
	Train acc: 0.782051282051282
	Train Cluster: 0.6497878193855285
	TrainSeparation: 0.5131844282150269
(Directly after push 2) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.001

Attempting combination 10/10:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 0
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: -1
p0_warm_ptype_step_size: 360
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 69
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.6595744680851063
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.5
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.5
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.5
Val acc before epoch 11: 0.8617021276595744
Warm optimizer lr: 0.5
Val acc before epoch 12: 0.9574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.5
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 25: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.5
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.5
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 37: 0.9042553191489362
Warm optimizer lr: 0.5
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 41: 0.9574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 42: 0.9680851063829787
Warm optimizer lr: 0.5
Val acc before epoch 43: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.5
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 48: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 51: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 54: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 57: 0.9574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 58: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 69: 0.9680851063829787
Stopping after epoch 70.
Final validation accuracy before push: 0.9680851063829787
Push number 1
After push, before retraining last layer:
	Train acc: 0.7612179487179487
	Train Cluster: 0.6347035050392151
	TrainSeparation: 0.5128904581069946
(Directly after push 2) Val acc at iteration 0: 0.648936170212766
Retraining last layer
Last layer lr: 0.001
Finished search.
