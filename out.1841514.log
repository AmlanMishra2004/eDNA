===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Mon Mar 25 12:48:45 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-03-25 12:48:57.253714: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-25 12:48:57.850967: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-25 12:48:57.866090: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-25 12:48:57.874974: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-25 12:48:58.240357: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94

Attempting combination 0/1:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 1
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 25
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3617021276595745
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7516025641025641
	Cluster: 0.6478195428848267
	Separation: 0.519718861579895
Retraining last layer: 
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.6276595744680851
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.6170212765957447
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.6063829787234043
	Val acc at iteration 35: 0.6170212765957447
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.6170212765957447
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.776595744680851
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.5957446808510638
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.6170212765957447
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.776595744680851
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.6595744680851063
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.7446808510638298
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.648936170212766
	Val acc at iteration 86: 0.6595744680851063
	Val acc at iteration 87: 0.723404255319149
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.6808510638297872
	Val acc at iteration 90: 0.6702127659574468
	Val acc at iteration 91: 0.723404255319149
	Val acc at iteration 92: 0.6808510638297872
	Val acc at iteration 93: 0.6382978723404256
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.6382978723404256
	Val acc at iteration 96: 0.6170212765957447
	Val acc at iteration 97: 0.6702127659574468
	Val acc at iteration 98: 0.6276595744680851
	Val acc at iteration 99: 0.7127659574468085
Val acc before epoch 16: 0.6595744680851063
Warm optimizer lr: 0.1
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 25: 0.9361702127659575
Stopping after epoch 26.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Cluster: 0.6507220506668091
	Separation: 0.5218894720077515
(After push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
	Train acc at iteration 1: 0.7740384615384616
	Val acc at iteration 0: 0.7127659574468085
	Train acc at iteration 2: 0.7868589743589743
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.8221153846153846
	Val acc at iteration 2: 0.723404255319149
	Train acc at iteration 4: 0.7948717948717948
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.7932692307692307
	Val acc at iteration 4: 0.6276595744680851
	Train acc at iteration 6: 0.8012820512820513
	Val acc at iteration 5: 0.6914893617021277
	Train acc at iteration 7: 0.8141025641025641
	Val acc at iteration 6: 0.7340425531914894
	Train acc at iteration 8: 0.8108974358974359
	Val acc at iteration 7: 0.7127659574468085
	Train acc at iteration 9: 0.7900641025641025
	Val acc at iteration 8: 0.6808510638297872
	Train acc at iteration 10: 0.7868589743589743
	Val acc at iteration 9: 0.6808510638297872
	Train acc at iteration 11: 0.7900641025641025
	Val acc at iteration 10: 0.7446808510638298
	Train acc at iteration 12: 0.7772435897435898
	Val acc at iteration 11: 0.7659574468085106
	Train acc at iteration 13: 0.7884615384615384
	Val acc at iteration 12: 0.7340425531914894
	Train acc at iteration 14: 0.7980769230769231
	Val acc at iteration 13: 0.648936170212766
	Train acc at iteration 15: 0.7724358974358975
	Val acc at iteration 14: 0.6170212765957447
	Train acc at iteration 16: 0.7692307692307693
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.8060897435897436
	Val acc at iteration 16: 0.7446808510638298
	Train acc at iteration 18: 0.8076923076923077
	Val acc at iteration 17: 0.7021276595744681
	Train acc at iteration 19: 0.7948717948717948
	Val acc at iteration 18: 0.7340425531914894
	Train acc at iteration 20: 0.8060897435897436
	Val acc at iteration 19: 0.6808510638297872
	Train acc at iteration 21: 0.7884615384615384
	Val acc at iteration 20: 0.6914893617021277
	Train acc at iteration 22: 0.7724358974358975
	Val acc at iteration 21: 0.723404255319149
	Train acc at iteration 23: 0.7932692307692307
	Val acc at iteration 22: 0.6170212765957447
	Train acc at iteration 24: 0.7836538461538461
	Val acc at iteration 23: 0.7446808510638298
	Train acc at iteration 25: 0.7836538461538461
	Val acc at iteration 24: 0.723404255319149
	Train acc at iteration 26: 0.7996794871794872
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.8060897435897436
	Val acc at iteration 26: 0.5851063829787234
	Train acc at iteration 28: 0.8205128205128205
	Val acc at iteration 27: 0.648936170212766
	Train acc at iteration 29: 0.7980769230769231
	Val acc at iteration 28: 0.6808510638297872
	Train acc at iteration 30: 0.8157051282051282
	Val acc at iteration 29: 0.7340425531914894
	Train acc at iteration 31: 0.8044871794871795
	Val acc at iteration 30: 0.6276595744680851
	Train acc at iteration 32: 0.7660256410256411
	Val acc at iteration 31: 0.7127659574468085
	Train acc at iteration 33: 0.7996794871794872
	Val acc at iteration 32: 0.6595744680851063
	Train acc at iteration 34: 0.7884615384615384
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.8189102564102564
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.7916666666666666
	Val acc at iteration 35: 0.7021276595744681
	Train acc at iteration 37: 0.8060897435897436
	Val acc at iteration 36: 0.6914893617021277
	Train acc at iteration 38: 0.8028846153846154
	Val acc at iteration 37: 0.6170212765957447
	Train acc at iteration 39: 0.7996794871794872
	Val acc at iteration 38: 0.6276595744680851
	Train acc at iteration 40: 0.7964743589743589
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.7740384615384616
	Val acc at iteration 40: 0.7659574468085106
	Train acc at iteration 42: 0.7932692307692307
	Val acc at iteration 41: 0.6914893617021277
	Train acc at iteration 43: 0.7852564102564102
	Val acc at iteration 42: 0.7340425531914894
	Train acc at iteration 44: 0.7980769230769231
	Val acc at iteration 43: 0.6595744680851063
	Train acc at iteration 45: 0.7708333333333334
	Val acc at iteration 44: 0.723404255319149
	Train acc at iteration 46: 0.7772435897435898
	Val acc at iteration 45: 0.6914893617021277
	Train acc at iteration 47: 0.782051282051282
	Val acc at iteration 46: 0.648936170212766
	Train acc at iteration 48: 0.7964743589743589
	Val acc at iteration 47: 0.6808510638297872
	Train acc at iteration 49: 0.7884615384615384
	Val acc at iteration 48: 0.6914893617021277
	Train acc at iteration 50: 0.7644230769230769
	Val acc at iteration 49: 0.6063829787234043
	Train acc at iteration 51: 0.782051282051282
	Val acc at iteration 50: 0.6170212765957447
	Train acc at iteration 52: 0.7900641025641025
	Val acc at iteration 51: 0.723404255319149
	Train acc at iteration 53: 0.8028846153846154
	Val acc at iteration 52: 0.723404255319149
	Train acc at iteration 54: 0.8221153846153846
	Val acc at iteration 53: 0.7021276595744681
	Train acc at iteration 55: 0.7900641025641025
	Val acc at iteration 54: 0.6914893617021277
	Train acc at iteration 56: 0.7868589743589743
	Val acc at iteration 55: 0.6595744680851063
	Train acc at iteration 57: 0.7868589743589743
	Val acc at iteration 56: 0.723404255319149
	Train acc at iteration 58: 0.7948717948717948
	Val acc at iteration 57: 0.723404255319149
	Train acc at iteration 59: 0.7932692307692307
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.780448717948718
	Val acc at iteration 59: 0.7446808510638298
	Train acc at iteration 61: 0.8044871794871795
	Val acc at iteration 60: 0.7127659574468085
	Train acc at iteration 62: 0.7788461538461539
	Val acc at iteration 61: 0.7021276595744681
	Train acc at iteration 63: 0.7836538461538461
	Val acc at iteration 62: 0.6702127659574468
	Train acc at iteration 64: 0.7916666666666666
	Val acc at iteration 63: 0.723404255319149
	Train acc at iteration 65: 0.8125
	Val acc at iteration 64: 0.7659574468085106
	Train acc at iteration 66: 0.7980769230769231
	Val acc at iteration 65: 0.7340425531914894
	Train acc at iteration 67: 0.7900641025641025
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.782051282051282
	Val acc at iteration 67: 0.6914893617021277
	Train acc at iteration 69: 0.8012820512820513
	Val acc at iteration 68: 0.7021276595744681
	Train acc at iteration 70: 0.7708333333333334
	Val acc at iteration 69: 0.6382978723404256
	Train acc at iteration 71: 0.8044871794871795
	Val acc at iteration 70: 0.6595744680851063
	Train acc at iteration 72: 0.8044871794871795
	Val acc at iteration 71: 0.6595744680851063
	Train acc at iteration 73: 0.7932692307692307
	Val acc at iteration 72: 0.6914893617021277
	Train acc at iteration 74: 0.8028846153846154
	Val acc at iteration 73: 0.723404255319149
	Train acc at iteration 75: 0.7948717948717948
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.8092948717948718
	Val acc at iteration 75: 0.7340425531914894
	Train acc at iteration 77: 0.8092948717948718
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.8141025641025641
	Val acc at iteration 77: 0.6808510638297872
	Train acc at iteration 79: 0.7964743589743589
	Val acc at iteration 78: 0.6808510638297872
	Train acc at iteration 80: 0.7868589743589743
	Val acc at iteration 79: 0.6595744680851063
	Train acc at iteration 81: 0.7980769230769231
	Val acc at iteration 80: 0.7659574468085106
	Train acc at iteration 82: 0.8012820512820513
	Val acc at iteration 81: 0.6808510638297872
	Train acc at iteration 83: 0.7836538461538461
	Val acc at iteration 82: 0.6702127659574468
	Train acc at iteration 84: 0.8028846153846154
	Val acc at iteration 83: 0.6914893617021277
	Train acc at iteration 85: 0.8012820512820513
	Val acc at iteration 84: 0.7446808510638298
	Train acc at iteration 86: 0.8125
	Val acc at iteration 85: 0.6808510638297872
	Train acc at iteration 87: 0.7996794871794872
	Val acc at iteration 86: 0.7340425531914894
	Train acc at iteration 88: 0.780448717948718
	Val acc at iteration 87: 0.723404255319149
	Train acc at iteration 89: 0.8125
	Val acc at iteration 88: 0.6702127659574468
	Train acc at iteration 90: 0.7740384615384616
	Val acc at iteration 89: 0.8085106382978723
	Train acc at iteration 91: 0.8108974358974359
	Val acc at iteration 90: 0.6808510638297872
	Train acc at iteration 92: 0.7884615384615384
	Val acc at iteration 91: 0.7021276595744681
	Train acc at iteration 93: 0.7884615384615384
	Val acc at iteration 92: 0.7446808510638298
	Train acc at iteration 94: 0.7964743589743589
	Val acc at iteration 93: 0.776595744680851
	Train acc at iteration 95: 0.8125
	Val acc at iteration 94: 0.7127659574468085
	Train acc at iteration 96: 0.7964743589743589
	Val acc at iteration 95: 0.7659574468085106
	Train acc at iteration 97: 0.8108974358974359
	Val acc at iteration 96: 0.6914893617021277
	Train acc at iteration 98: 0.7980769230769231
	Val acc at iteration 97: 0.6702127659574468
	Train acc at iteration 99: 0.8060897435897436
	Val acc at iteration 98: 0.7021276595744681
	Train acc at iteration 100: 0.8141025641025641
	Val acc at iteration 99: 0.7021276595744681
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5816326530612245
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.46453900709219864
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6088365018367767
	Separation: 0.5402360558509827
Final test:
	Cluster: 0.6080406010150909
	Separation: 0.5516069829463959
Saved Results
Finished search.
