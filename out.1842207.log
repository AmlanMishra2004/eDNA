===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Mon Mar 25 23:34:35 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-03-25 23:34:49.212997: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-25 23:34:49.906452: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-25 23:34:49.943745: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-25 23:34:50.038773: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-25 23:34:50.843069: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94
Hyperparameters: {'prototype_shape': [(468, 520, 29)], 'latent_weight': [0.8], 'joint_weight_decay': [-1], 'gamma': [0.2], 'warm_lr_step_size': [5000000], 'crs_ent_weight': [1], 'clst_weight': [-9.600000000000001], 'sep_weight': [2.4], 'l1_weight': [0.001], 'warm_ptype_lr': [0.5, 0.45, 0.4, 0.35, 0.3, 0.25, 0.2, 0.15, 0.1, 0.95, 0.09, 0.85, 0.08, 0.75, 0.07, 0.65, 0.06, 0.55, 0.05], 'last_layer_lr': [-1], 'num_warm_epochs': [1000000], 'push_gap': [10], 'push_start': [30], 'num_pushes': [0], 'last_layer_epochs': [0], 'joint_lr_step_size': [-1], 'joint_optimizer_lrs': [{'features': -1, 'prototype_vectors': -1}]}




Exploring 19 hyperparameter combinations for grid search.


Attempting combination 1/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.5
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7872340425531915
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.5
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.5
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 26: 0.9680851063829787
Warm optimizer lr: 0.5
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 30: 0.9148936170212766
Stopping after epoch 31.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Train Cluster: 0.6503755688667298
	TrainSeparation: 0.5252080678939819
(Directly after push) Val acc at iteration 0: 0.5851063829787234
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5670103092783505
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.5105072463768116
Final test micro accuracy: 0.6808510638297872
Final validation:
	Cluster: 0.6183205544948578
	Separation: 0.5413460731506348
Final test:
	Cluster: 0.6206303834915161
	Separation: 0.536958783864975
Saved Results

Attempting combination 2/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.45
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.45
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.45
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.45
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.45
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.45
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.45
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.45
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.45
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.45
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.45
Val acc before epoch 10: 0.8297872340425532
Warm optimizer lr: 0.45
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.45
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.45
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.45
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.45
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.45
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.45
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.45
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.45
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.45
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.45
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.45
Val acc before epoch 22: 0.9680851063829787
Warm optimizer lr: 0.45
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.45
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.45
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.45
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.45
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.45
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.45
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.45
Val acc before epoch 30: 0.9042553191489362
Stopping after epoch 31.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Train Cluster: 0.6390313863754272
	TrainSeparation: 0.5196243047714233
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5549999999999999
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.41362007168458775
Final test micro accuracy: 0.5319148936170213
Final validation:
	Cluster: 0.614167332649231
	Separation: 0.5326006412506104
Final test:
	Cluster: 0.5796051323413849
	Separation: 0.5393684208393097
Saved Results

Attempting combination 3/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.46808510638297873
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 13: 0.9680851063829787
Warm optimizer lr: 0.4
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.4
Val acc before epoch 15: 0.9787234042553191
Warm optimizer lr: 0.4
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 18: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.4
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 25: 0.9680851063829787
Warm optimizer lr: 0.4
Val acc before epoch 26: 0.9787234042553191
Warm optimizer lr: 0.4
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 28: 0.9787234042553191
Warm optimizer lr: 0.4
Val acc before epoch 29: 0.9680851063829787
Warm optimizer lr: 0.4
Val acc before epoch 30: 0.9574468085106383
Stopping after epoch 31.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Train Cluster: 0.6480805516242981
	TrainSeparation: 0.5178351163864136
(Directly after push) Val acc at iteration 0: 0.574468085106383
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.511326860841424
Final val micro accuracy: 0.648936170212766
Final test macro f1-score: 0.4635416666666667
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.6233889758586884
	Separation: 0.5429148077964783
Final test:
	Cluster: 0.5879549086093903
	Separation: 0.5325713455677032
Saved Results

Attempting combination 4/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.35
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.35
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.35
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.35
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.35
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.35
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.35
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.35
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.35
Val acc before epoch 8: 0.8297872340425532
Warm optimizer lr: 0.35
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.35
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.35
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.35
Val acc before epoch 12: 0.8617021276595744
Warm optimizer lr: 0.35
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.35
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.35
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.35
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.35
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.35
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.35
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.35
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.35
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.35
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.35
Val acc before epoch 23: 0.9680851063829787
Warm optimizer lr: 0.35
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.35
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.35
Val acc before epoch 26: 0.9574468085106383
Warm optimizer lr: 0.35
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.35
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.35
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.35
Val acc before epoch 30: 0.9468085106382979
Stopping after epoch 31.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.6483081340789795
	TrainSeparation: 0.5179731369018554
(Directly after push) Val acc at iteration 0: 0.5957446808510638
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5202020202020202
Final val micro accuracy: 0.6170212765957447
Final test macro f1-score: 0.5730337078651685
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.6148211061954498
	Separation: 0.5446199774742126
Final test:
	Cluster: 0.5963911414146423
	Separation: 0.5333455502986908
Saved Results

Attempting combination 5/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.3
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.3
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.3
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.3
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.3
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.3
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.3
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.3
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.3
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.3
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.3
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.3
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.3
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.3
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.3
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.3
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.3
Val acc before epoch 16: 0.8723404255319149
Warm optimizer lr: 0.3
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.3
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.3
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.3
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.3
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.3
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.3
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.3
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.3
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.3
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.3
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.3
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.3
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.3
Val acc before epoch 30: 0.9148936170212766
Stopping after epoch 31.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Train Cluster: 0.6467012763023376
	TrainSeparation: 0.5241204619407653
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.619298245614035
Final val micro accuracy: 0.723404255319149
Final test macro f1-score: 0.44336917562724015
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6425217390060425
	Separation: 0.5549321174621582
Final test:
	Cluster: 0.5958284735679626
	Separation: 0.5379982590675354
Saved Results

Attempting combination 6/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.25
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.25
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.25
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.25
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.25
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.25
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.25
Val acc before epoch 6: 0.7872340425531915
Warm optimizer lr: 0.25
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.25
Val acc before epoch 8: 0.851063829787234
Warm optimizer lr: 0.25
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.25
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.25
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 25: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 30: 0.9148936170212766
Stopping after epoch 31.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7660256410256411
	Train Cluster: 0.6371659517288208
	TrainSeparation: 0.5182871103286744
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5099009900990099
Final val micro accuracy: 0.5957446808510638
Final test macro f1-score: 0.5419607843137254
Final test micro accuracy: 0.648936170212766
Final validation:
	Cluster: 0.6106857061386108
	Separation: 0.5401232242584229
Final test:
	Cluster: 0.6023261249065399
	Separation: 0.5365025401115417
Saved Results

Attempting combination 7/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.2
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.2
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.2
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.2
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.2
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.2
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.2
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.2
Val acc before epoch 7: 0.7872340425531915
Warm optimizer lr: 0.2
Val acc before epoch 8: 0.851063829787234
Warm optimizer lr: 0.2
Val acc before epoch 9: 0.8191489361702128
Warm optimizer lr: 0.2
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.2
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.2
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.2
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.2
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.2
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.2
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.2
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.2
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.2
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.2
Val acc before epoch 30: 0.9361702127659575
Stopping after epoch 31.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7932692307692307
	Train Cluster: 0.650402057170868
	TrainSeparation: 0.5229855298995971
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5757575757575758
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.5647940074906367
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.6181802153587341
	Separation: 0.5373485088348389
Final test:
	Cluster: 0.5927707254886627
	Separation: 0.541939914226532
Saved Results

Attempting combination 8/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.15
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.15
Val acc before epoch 1: 0.39361702127659576
Warm optimizer lr: 0.15
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.15
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.15
Val acc before epoch 4: 0.7872340425531915
Warm optimizer lr: 0.15
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.15
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.15
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.15
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.15
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.15
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.15
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.15
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.15
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.15
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.15
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.15
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.15
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.15
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.15
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.15
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.15
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.15
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.15
Val acc before epoch 30: 0.9148936170212766
Stopping after epoch 31.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7980769230769231
	Train Cluster: 0.6486082792282104
	TrainSeparation: 0.5220300912857055
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5627062706270627
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.4415770609318997
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6169542670249939
	Separation: 0.535741537809372
Final test:
	Cluster: 0.6074709594249725
	Separation: 0.5506349205970764
Saved Results

Attempting combination 9/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3404255319148936
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 17: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 27: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 30: 0.9042553191489362
Stopping after epoch 31.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Train Cluster: 0.6571012616157532
	TrainSeparation: 0.5208093643188476
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6127946127946128
Final val micro accuracy: 0.7127659574468085
Final test macro f1-score: 0.44855072463768114
Final test micro accuracy: 0.574468085106383
Final validation:
	Cluster: 0.6269224584102631
	Separation: 0.5374180972576141
Final test:
	Cluster: 0.5955624878406525
	Separation: 0.5337612926959991
Saved Results

Attempting combination 10/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.95
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.95
Val acc before epoch 1: 0.3723404255319149
Warm optimizer lr: 0.95
Val acc before epoch 2: 0.5319148936170213
Warm optimizer lr: 0.95
Val acc before epoch 3: 0.648936170212766
Warm optimizer lr: 0.95
Val acc before epoch 4: 0.723404255319149
Warm optimizer lr: 0.95
Val acc before epoch 5: 0.7127659574468085
Warm optimizer lr: 0.95
Val acc before epoch 6: 0.7340425531914894
Warm optimizer lr: 0.95
Val acc before epoch 7: 0.8085106382978723
Warm optimizer lr: 0.95
Val acc before epoch 8: 0.7978723404255319
Warm optimizer lr: 0.95
Val acc before epoch 9: 0.8297872340425532
Warm optimizer lr: 0.95
Val acc before epoch 10: 0.8191489361702128
Warm optimizer lr: 0.95
Val acc before epoch 11: 0.851063829787234
Warm optimizer lr: 0.95
Val acc before epoch 12: 0.8617021276595744
Warm optimizer lr: 0.95
Val acc before epoch 13: 0.8723404255319149
Warm optimizer lr: 0.95
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.95
Val acc before epoch 15: 0.8191489361702128
Warm optimizer lr: 0.95
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.95
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.95
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.95
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.95
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.95
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.95
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.95
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.95
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.95
Val acc before epoch 25: 0.8936170212765957
Warm optimizer lr: 0.95
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.95
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.95
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.95
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.95
Val acc before epoch 30: 0.9148936170212766
Stopping after epoch 31.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7580128205128205
	Train Cluster: 0.6335321545600892
	TrainSeparation: 0.5177350878715515
(Directly after push) Val acc at iteration 0: 0.6170212765957447
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5067340067340068
Final val micro accuracy: 0.5957446808510638
Final test macro f1-score: 0.48068181818181815
Final test micro accuracy: 0.6276595744680851
Final validation:
	Cluster: 0.5969329476356506
	Separation: 0.5450216829776764
Final test:
	Cluster: 0.5962270200252533
	Separation: 0.5338454246520996
Saved Results

Attempting combination 11/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.09
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.09
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.09
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.09
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.09
Val acc before epoch 4: 0.7872340425531915
Warm optimizer lr: 0.09
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.09
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.09
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.09
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.09
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.09
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.09
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.09
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.09
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.09
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.09
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.09
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.09
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.09
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.09
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.09
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.09
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.09
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.09
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.09
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.09
Val acc before epoch 25: 0.9680851063829787
Warm optimizer lr: 0.09
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.09
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.09
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.09
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.09
Val acc before epoch 30: 0.8936170212765957
Stopping after epoch 31.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Train Cluster: 0.6548302054405213
	TrainSeparation: 0.5200471401214599
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5499999999999999
Final val micro accuracy: 0.6595744680851063
Final test macro f1-score: 0.5306201550387596
Final test micro accuracy: 0.648936170212766
Final validation:
	Cluster: 0.6175914108753204
	Separation: 0.5404660999774933
Final test:
	Cluster: 0.6145963072776794
	Separation: 0.5441661775112152
Saved Results

Attempting combination 12/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.85
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.85
Val acc before epoch 1: 0.46808510638297873
Warm optimizer lr: 0.85
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.85
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.85
Val acc before epoch 4: 0.7446808510638298
Warm optimizer lr: 0.85
Val acc before epoch 5: 0.776595744680851
Warm optimizer lr: 0.85
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.85
Val acc before epoch 7: 0.7978723404255319
Warm optimizer lr: 0.85
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.85
Val acc before epoch 9: 0.8404255319148937
Warm optimizer lr: 0.85
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.85
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.85
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.85
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.85
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.85
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.85
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.85
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.85
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.85
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.85
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.85
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.85
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.85
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.85
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.85
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.85
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.85
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.85
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.85
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.85
Val acc before epoch 30: 0.9361702127659575
Stopping after epoch 31.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7612179487179487
	Train Cluster: 0.6455094933509826
	TrainSeparation: 0.5218001246452332
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5413333333333333
Final val micro accuracy: 0.648936170212766
Final test macro f1-score: 0.3701030927835051
Final test micro accuracy: 0.48936170212765956
Final validation:
	Cluster: 0.6148313879966736
	Separation: 0.5464144349098206
Final test:
	Cluster: 0.5908355116844177
	Separation: 0.5395882427692413
Saved Results

Attempting combination 13/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.08
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.08
Val acc before epoch 1: 0.40425531914893614
Warm optimizer lr: 0.08
Val acc before epoch 2: 0.5319148936170213
Warm optimizer lr: 0.08
Val acc before epoch 3: 0.7021276595744681
Warm optimizer lr: 0.08
Val acc before epoch 4: 0.7446808510638298
Warm optimizer lr: 0.08
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.08
Val acc before epoch 6: 0.7978723404255319
Warm optimizer lr: 0.08
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.08
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.08
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.08
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.08
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.08
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.08
Val acc before epoch 13: 0.8297872340425532
Warm optimizer lr: 0.08
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.08
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.08
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.08
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.08
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.08
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.08
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.08
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.08
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.08
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.08
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.08
Val acc before epoch 25: 0.9574468085106383
Warm optimizer lr: 0.08
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.08
Val acc before epoch 27: 0.9680851063829787
Warm optimizer lr: 0.08
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.08
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.08
Val acc before epoch 30: 0.9361702127659575
Stopping after epoch 31.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7676282051282052
	Train Cluster: 0.6409720063209534
	TrainSeparation: 0.5236313343048096
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5326460481099656
Final val micro accuracy: 0.6276595744680851
Final test macro f1-score: 0.42580645161290315
Final test micro accuracy: 0.5638297872340425
Final validation:
	Cluster: 0.6223109364509583
	Separation: 0.5422066152095795
Final test:
	Cluster: 0.5976123213768005
	Separation: 0.5407798588275909
Saved Results

Attempting combination 14/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.75
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.75
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.75
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.75
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.75
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.75
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.75
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.75
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.75
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.75
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.75
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.75
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.75
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.75
Val acc before epoch 13: 0.851063829787234
Warm optimizer lr: 0.75
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.75
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.75
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.75
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.75
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.75
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.75
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.75
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.75
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.75
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.75
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.75
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.75
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.75
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.75
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.75
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.75
Val acc before epoch 30: 0.9148936170212766
Stopping after epoch 31.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7596153846153846
	Train Cluster: 0.6420151114463806
	TrainSeparation: 0.5164132833480835
(Directly after push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5718954248366013
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.5112359550561797
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.601494550704956
	Separation: 0.5407398641109467
Final test:
	Cluster: 0.5785552561283112
	Separation: 0.5307568907737732
Saved Results

Attempting combination 15/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.07
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.07
Val acc before epoch 1: 0.3723404255319149
Warm optimizer lr: 0.07
Val acc before epoch 2: 0.6063829787234043
Warm optimizer lr: 0.07
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.07
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.07
Val acc before epoch 5: 0.7446808510638298
Warm optimizer lr: 0.07
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.07
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.07
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.07
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.07
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.07
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.07
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.07
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.07
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.07
Val acc before epoch 15: 0.9574468085106383
Warm optimizer lr: 0.07
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.07
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.07
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.07
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.07
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.07
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.07
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.07
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.07
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.07
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.07
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.07
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.07
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.07
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.07
Val acc before epoch 30: 0.9468085106382979
Stopping after epoch 31.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7772435897435898
	Train Cluster: 0.6496336817741394
	TrainSeparation: 0.5235671997070312
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5247524752475247
Final val micro accuracy: 0.648936170212766
Final test macro f1-score: 0.4745519713261649
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.605331152677536
	Separation: 0.5464200675487518
Final test:
	Cluster: 0.6025229394435883
	Separation: 0.5414573848247528
Saved Results

Attempting combination 16/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.65
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.65
Val acc before epoch 1: 0.46808510638297873
Warm optimizer lr: 0.65
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.65
Val acc before epoch 3: 0.6914893617021277
Warm optimizer lr: 0.65
Val acc before epoch 4: 0.7446808510638298
Warm optimizer lr: 0.65
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.65
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.65
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.65
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.65
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.65
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.65
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.65
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.65
Val acc before epoch 13: 0.8723404255319149
Warm optimizer lr: 0.65
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.65
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.65
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.65
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.65
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.65
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.65
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.65
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.65
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.65
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.65
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.65
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.65
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.65
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.65
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.65
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.65
Val acc before epoch 30: 0.9361702127659575
Stopping after epoch 31.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Train Cluster: 0.6412808179855347
	TrainSeparation: 0.5202955007553101
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5876288659793814
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.47234042553191485
Final test micro accuracy: 0.574468085106383
Final validation:
	Cluster: 0.6232127249240875
	Separation: 0.5388088822364807
Final test:
	Cluster: 0.5837596654891968
	Separation: 0.5398464798927307
Saved Results

Attempting combination 17/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.06
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.06
Val acc before epoch 1: 0.3191489361702128
Warm optimizer lr: 0.06
Val acc before epoch 2: 0.6063829787234043
Warm optimizer lr: 0.06
Val acc before epoch 3: 0.6702127659574468
Warm optimizer lr: 0.06
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.06
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.06
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.06
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.06
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.06
Val acc before epoch 11: 0.9468085106382979
Warm optimizer lr: 0.06
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.06
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.06
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.06
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.06
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.06
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.06
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.06
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.06
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.06
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.06
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.06
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.06
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.06
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.06
Val acc before epoch 30: 0.925531914893617
Stopping after epoch 31.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7948717948717948
	Train Cluster: 0.6454369068145752
	TrainSeparation: 0.5199352383613587
(Directly after push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5783333333333333
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.39591836734693875
Final test micro accuracy: 0.5425531914893617
Final validation:
	Cluster: 0.6137387752532959
	Separation: 0.5464089810848236
Final test:
	Cluster: 0.6120119094848633
	Separation: 0.5446466505527496
Saved Results

Attempting combination 18/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.55
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.55
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.55
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.55
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.55
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.55
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.55
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.55
Val acc before epoch 7: 0.7978723404255319
Warm optimizer lr: 0.55
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.55
Val acc before epoch 9: 0.851063829787234
Warm optimizer lr: 0.55
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.55
Val acc before epoch 11: 0.8404255319148937
Warm optimizer lr: 0.55
Val acc before epoch 12: 0.8723404255319149
Warm optimizer lr: 0.55
Val acc before epoch 13: 0.8617021276595744
Warm optimizer lr: 0.55
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.55
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.55
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.55
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.55
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.55
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.55
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.55
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.55
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.55
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.55
Val acc before epoch 24: 0.8404255319148937
Warm optimizer lr: 0.55
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.55
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.55
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.55
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.55
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.55
Val acc before epoch 30: 0.9468085106382979
Stopping after epoch 31.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7451923076923077
	Train Cluster: 0.6423094868659973
	TrainSeparation: 0.5218815922737121
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.520408163265306
Final val micro accuracy: 0.6063829787234043
Final test macro f1-score: 0.5247191011235954
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.5944461226463318
	Separation: 0.535266250371933
Final test:
	Cluster: 0.5820841789245605
	Separation: 0.53165203332901
Saved Results

Attempting combination 19/19:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.05
last_layer_lr: -1
num_warm_epochs: 1000000
push_gap: 10
push_start: 30
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 30
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.1702127659574468
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.5106382978723404
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.925531914893617
Stopping after epoch 31.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8349358974358975
	Train Cluster: 0.6519203186035156
	TrainSeparation: 0.521890652179718
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: -1
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5313531353135312
Final val micro accuracy: 0.6382978723404256
Final test macro f1-score: 0.5637362637362637
Final test micro accuracy: 0.6808510638297872
Final validation:
	Cluster: 0.6231859624385834
	Separation: 0.5508156716823578
Final test:
	Cluster: 0.6191402077674866
	Separation: 0.5410977900028229
Saved Results
Finished search.
