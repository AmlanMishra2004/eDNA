===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Fri Mar 29 13:16:43 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-03-29 13:16:59.245378: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-29 13:16:59.967005: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-29 13:16:59.967123: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-29 13:16:59.970980: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-29 13:17:00.403229: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94
Hyperparameters: {'prototype_shape': [(468, 520, 29)], 'latent_weight': [0.8], 'joint_weight_decay': [-1], 'gamma': [-1], 'warm_lr_step_size': [5000000], 'crs_ent_weight': [1], 'clst_weight': [-9.600000000000001], 'sep_weight': [2.4], 'l1_weight': [0.0001, 0.0005, 0.001, 0.005, 0.01, 0.1, 0.5, 1], 'warm_ptype_lr': [0.4], 'last_layer_lr': [0.001], 'last_layer_lr_after_second_push': [0.5, 0.1, 0.05, 0.01, 0.005, 0.001, 0.0005, 0.0001, 5e-05], 'num_warm_epochs': [1000000], 'push_gap': [12], 'push_start': [12], 'num_pushes': [2], 'last_layer_epochs': [85], 'joint_lr_step_size': [-1], 'joint_optimizer_lrs': [{'features': -1, 'prototype_vectors': -1}]}




Exploring 72 hyperparameter combinations for grid search.


Attempting combination 1/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.6401797413825989
	Train Separation: 0.5158310055732727
(Directly after push) Val acc at iteration 0: 0.5319148936170213
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.5851063829787234
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.6063829787234043
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.6063829787234043
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6063829787234043
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6170212765957447
	Val acc at iteration 18: 0.574468085106383
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.6063829787234043
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.5851063829787234
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6276595744680851
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.5531914893617021
	Val acc at iteration 29: 0.5957446808510638
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.6276595744680851
	Val acc at iteration 32: 0.5638297872340425
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.6382978723404256
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.8085106382978723
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.6170212765957447
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.6276595744680851
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.5957446808510638
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.6382978723404256
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.6595744680851063
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.6595744680851063
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.7127659574468085
Val acc before epoch 13: 0.7340425531914894
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8076923076923077
	Train Cluster: 0.6473729968070984
	Train Separation: 0.522236442565918
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.7978723404255319
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.7446808510638298
	Val acc at iteration 11: 0.6170212765957447
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7659574468085106
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.7659574468085106
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.7872340425531915
	Val acc at iteration 32: 0.7872340425531915
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7872340425531915
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.776595744680851
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.776595744680851
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7659574468085106
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.7659574468085106
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.776595744680851
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.7872340425531915
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.8191489361702128
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7978723404255319
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.7978723404255319
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7872340425531915
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.8085106382978723
	Val acc at iteration 82: 0.7978723404255319
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 25: 0.7021276595744681
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8541666666666666
	Train Cluster: 0.648058044910431
	TrainSeparation: 0.5186665058135986
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.20833333333333334
	Val acc at iteration 0: 0.10638297872340426
	Train acc at iteration 2: 0.03685897435897436
	Val acc at iteration 1: 0.05319148936170213
	Train acc at iteration 3: 0.020833333333333332
	Val acc at iteration 2: 0.0425531914893617
	Train acc at iteration 4: 0.03685897435897436
	Val acc at iteration 3: 0.010638297872340425
	Train acc at iteration 5: 0.01282051282051282
	Val acc at iteration 4: 0.031914893617021274
	Train acc at iteration 6: 0.008012820512820512
	Val acc at iteration 5: 0.02127659574468085
	Train acc at iteration 7: 0.035256410256410256
	Val acc at iteration 6: 0.05319148936170213
	Train acc at iteration 8: 0.01282051282051282
	Val acc at iteration 7: 0.02127659574468085
	Train acc at iteration 9: 0.022435897435897436
	Val acc at iteration 8: 0.010638297872340425
	Train acc at iteration 10: 0.01282051282051282
	Val acc at iteration 9: 0.02127659574468085
	Train acc at iteration 11: 0.017628205128205128
	Val acc at iteration 10: 0.010638297872340425
	Train acc at iteration 12: 0.019230769230769232
	Val acc at iteration 11: 0.02127659574468085
	Train acc at iteration 13: 0.00641025641025641
	Val acc at iteration 12: 0.0425531914893617
	Train acc at iteration 14: 0.020833333333333332
	Val acc at iteration 13: 0.031914893617021274
	Train acc at iteration 15: 0.009615384615384616
	Val acc at iteration 14: 0.010638297872340425
	Train acc at iteration 16: 0.027243589743589744
	Val acc at iteration 15: 0.031914893617021274
	Train acc at iteration 17: 0.019230769230769232
	Val acc at iteration 16: 0.0
	Train acc at iteration 18: 0.008012820512820512
	Val acc at iteration 17: 0.02127659574468085
	Train acc at iteration 19: 0.016025641025641024
	Val acc at iteration 18: 0.02127659574468085
	Train acc at iteration 20: 0.02403846153846154
	Val acc at iteration 19: 0.031914893617021274
	Train acc at iteration 21: 0.03685897435897436
	Val acc at iteration 20: 0.031914893617021274
	Train acc at iteration 22: 0.030448717948717948
	Val acc at iteration 21: 0.0425531914893617
	Train acc at iteration 23: 0.017628205128205128
	Val acc at iteration 22: 0.031914893617021274
	Train acc at iteration 24: 0.04006410256410257
	Val acc at iteration 23: 0.0425531914893617
	Train acc at iteration 25: 0.04487179487179487
	Val acc at iteration 24: 0.06382978723404255
	Train acc at iteration 26: 0.05929487179487179
	Val acc at iteration 25: 0.05319148936170213
	Train acc at iteration 27: 0.07371794871794872
	Val acc at iteration 26: 0.1702127659574468
	Train acc at iteration 28: 0.07532051282051282
	Val acc at iteration 27: 0.10638297872340426
	Train acc at iteration 29: 0.11378205128205128
	Val acc at iteration 28: 0.11702127659574468
	Train acc at iteration 30: 0.11858974358974358
	Val acc at iteration 29: 0.19148936170212766
	Train acc at iteration 31: 0.16826923076923078
	Val acc at iteration 30: 0.14893617021276595
	Train acc at iteration 32: 0.17307692307692307
	Val acc at iteration 31: 0.1595744680851064
	Train acc at iteration 33: 0.23076923076923078
	Val acc at iteration 32: 0.24468085106382978
	Train acc at iteration 34: 0.26121794871794873
	Val acc at iteration 33: 0.23404255319148937
	Train acc at iteration 35: 0.26282051282051283
	Val acc at iteration 34: 0.2872340425531915
	Train acc at iteration 36: 0.3349358974358974
	Val acc at iteration 35: 0.3191489361702128
	Train acc at iteration 37: 0.38301282051282054
	Val acc at iteration 36: 0.4148936170212766
	Train acc at iteration 38: 0.42467948717948717
	Val acc at iteration 37: 0.40425531914893614
	Train acc at iteration 39: 0.4358974358974359
	Val acc at iteration 38: 0.40425531914893614
	Train acc at iteration 40: 0.5
	Val acc at iteration 39: 0.5638297872340425
	Train acc at iteration 41: 0.5336538461538461
	Val acc at iteration 40: 0.4574468085106383
	Train acc at iteration 42: 0.5480769230769231
	Val acc at iteration 41: 0.6276595744680851
	Train acc at iteration 43: 0.6298076923076923
	Val acc at iteration 42: 0.6808510638297872
	Train acc at iteration 44: 0.6490384615384616
	Val acc at iteration 43: 0.5957446808510638
	Train acc at iteration 45: 0.6618589743589743
	Val acc at iteration 44: 0.723404255319149
	Train acc at iteration 46: 0.6666666666666666
	Val acc at iteration 45: 0.7127659574468085
	Train acc at iteration 47: 0.7403846153846154
	Val acc at iteration 46: 0.7021276595744681
	Train acc at iteration 48: 0.7403846153846154
	Val acc at iteration 47: 0.6808510638297872
	Train acc at iteration 49: 0.7147435897435898
	Val acc at iteration 48: 0.6914893617021277
	Train acc at iteration 50: 0.7403846153846154
	Val acc at iteration 49: 0.6808510638297872
	Train acc at iteration 51: 0.7419871794871795
	Val acc at iteration 50: 0.7127659574468085
	Train acc at iteration 52: 0.7243589743589743
	Val acc at iteration 51: 0.7553191489361702
	Train acc at iteration 53: 0.7387820512820513
	Val acc at iteration 52: 0.7446808510638298
	Train acc at iteration 54: 0.7483974358974359
	Val acc at iteration 53: 0.776595744680851
	Train acc at iteration 55: 0.7532051282051282
	Val acc at iteration 54: 0.7446808510638298
	Train acc at iteration 56: 0.7740384615384616
	Val acc at iteration 55: 0.7021276595744681
	Train acc at iteration 57: 0.7612179487179487
	Val acc at iteration 56: 0.6702127659574468
	Train acc at iteration 58: 0.7676282051282052
	Val acc at iteration 57: 0.7978723404255319
	Train acc at iteration 59: 0.8125
	Val acc at iteration 58: 0.8297872340425532
	Train acc at iteration 60: 0.7964743589743589
	Val acc at iteration 59: 0.8617021276595744
	Train acc at iteration 61: 0.7692307692307693
	Val acc at iteration 60: 0.7446808510638298
	Train acc at iteration 62: 0.8141025641025641
	Val acc at iteration 61: 0.8085106382978723
	Train acc at iteration 63: 0.7884615384615384
	Val acc at iteration 62: 0.7978723404255319
	Train acc at iteration 64: 0.7852564102564102
	Val acc at iteration 63: 0.7978723404255319
	Train acc at iteration 65: 0.7948717948717948
	Val acc at iteration 64: 0.7021276595744681
	Train acc at iteration 66: 0.7900641025641025
	Val acc at iteration 65: 0.7872340425531915
	Train acc at iteration 67: 0.7740384615384616
	Val acc at iteration 66: 0.8191489361702128
	Train acc at iteration 68: 0.780448717948718
	Val acc at iteration 67: 0.7978723404255319
	Train acc at iteration 69: 0.8237179487179487
	Val acc at iteration 68: 0.7978723404255319
	Train acc at iteration 70: 0.780448717948718
	Val acc at iteration 69: 0.776595744680851
	Train acc at iteration 71: 0.780448717948718
	Val acc at iteration 70: 0.7872340425531915
	Train acc at iteration 72: 0.8028846153846154
	Val acc at iteration 71: 0.8297872340425532
	Train acc at iteration 73: 0.8012820512820513
	Val acc at iteration 72: 0.776595744680851
	Train acc at iteration 74: 0.7932692307692307
	Val acc at iteration 73: 0.8297872340425532
	Train acc at iteration 75: 0.8253205128205128
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.8205128205128205
	Val acc at iteration 75: 0.7659574468085106
	Train acc at iteration 77: 0.8076923076923077
	Val acc at iteration 76: 0.8404255319148937
	Train acc at iteration 78: 0.8076923076923077
	Val acc at iteration 77: 0.776595744680851
	Train acc at iteration 79: 0.8012820512820513
	Val acc at iteration 78: 0.7978723404255319
	Train acc at iteration 80: 0.8012820512820513
	Val acc at iteration 79: 0.8617021276595744
	Train acc at iteration 81: 0.7996794871794872
	Val acc at iteration 80: 0.7872340425531915
	Train acc at iteration 82: 0.8173076923076923
	Val acc at iteration 81: 0.8404255319148937
	Train acc at iteration 83: 0.8173076923076923
	Val acc at iteration 82: 0.776595744680851
	Train acc at iteration 84: 0.8141025641025641
	Val acc at iteration 83: 0.851063829787234
	Train acc at iteration 85: 0.8493589743589743
	Val acc at iteration 84: 0.8404255319148937
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7688644688644689
Final val micro accuracy: 0.8404255319148937
Final test macro f1-score: 0.6579166666666667
Final test micro accuracy: 0.7340425531914894
Final validation:
	Cluster: 0.6307568848133087
	Separation: 0.5417357087135315
Final test:
	Cluster: 0.5908011794090271
	Separation: 0.5418990552425385
Saved Results

Attempting combination 2/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.6413216233253479
	Train Separation: 0.5207250714302063
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5425531914893617
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.5851063829787234
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.5957446808510638
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6063829787234043
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.7553191489361702
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.7553191489361702
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.776595744680851
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.723404255319149
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.6808510638297872
Val acc before epoch 13: 0.7340425531914894
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.6509013414382935
	Train Separation: 0.5239420771598816
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.7340425531914894
	Val acc at iteration 9: 0.7553191489361702
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.7659574468085106
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.7446808510638298
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.7872340425531915
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.7659574468085106
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.7553191489361702
	Val acc at iteration 23: 0.7553191489361702
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7553191489361702
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7872340425531915
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7553191489361702
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.8297872340425532
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.8191489361702128
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.8085106382978723
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.7978723404255319
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.776595744680851
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.7978723404255319
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.776595744680851
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7872340425531915
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.7978723404255319
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.8085106382978723
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.8085106382978723
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.7872340425531915
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8541666666666666
	Train Cluster: 0.6494570016860962
	TrainSeparation: 0.5216272234916687
(Directly after push) Val acc at iteration 0: 0.8404255319148937
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.3269230769230769
	Val acc at iteration 0: 0.18085106382978725
	Train acc at iteration 2: 0.15384615384615385
	Val acc at iteration 1: 0.0851063829787234
	Train acc at iteration 3: 0.10416666666666667
	Val acc at iteration 2: 0.1595744680851064
	Train acc at iteration 4: 0.125
	Val acc at iteration 3: 0.2127659574468085
	Train acc at iteration 5: 0.11698717948717949
	Val acc at iteration 4: 0.10638297872340426
	Train acc at iteration 6: 0.11378205128205128
	Val acc at iteration 5: 0.14893617021276595
	Train acc at iteration 7: 0.08173076923076923
	Val acc at iteration 6: 0.11702127659574468
	Train acc at iteration 8: 0.0673076923076923
	Val acc at iteration 7: 0.0851063829787234
	Train acc at iteration 9: 0.10737179487179487
	Val acc at iteration 8: 0.10638297872340426
	Train acc at iteration 10: 0.09615384615384616
	Val acc at iteration 9: 0.14893617021276595
	Train acc at iteration 11: 0.09455128205128205
	Val acc at iteration 10: 0.20212765957446807
	Train acc at iteration 12: 0.09294871794871795
	Val acc at iteration 11: 0.1276595744680851
	Train acc at iteration 13: 0.08493589743589744
	Val acc at iteration 12: 0.1595744680851064
	Train acc at iteration 14: 0.10576923076923077
	Val acc at iteration 13: 0.1276595744680851
	Train acc at iteration 15: 0.08012820512820513
	Val acc at iteration 14: 0.1702127659574468
	Train acc at iteration 16: 0.1201923076923077
	Val acc at iteration 15: 0.10638297872340426
	Train acc at iteration 17: 0.1346153846153846
	Val acc at iteration 16: 0.1276595744680851
	Train acc at iteration 18: 0.13141025641025642
	Val acc at iteration 17: 0.13829787234042554
	Train acc at iteration 19: 0.15224358974358973
	Val acc at iteration 18: 0.1702127659574468
	Train acc at iteration 20: 0.1794871794871795
	Val acc at iteration 19: 0.23404255319148937
	Train acc at iteration 21: 0.14423076923076922
	Val acc at iteration 20: 0.2127659574468085
	Train acc at iteration 22: 0.1875
	Val acc at iteration 21: 0.2127659574468085
	Train acc at iteration 23: 0.21153846153846154
	Val acc at iteration 22: 0.2127659574468085
	Train acc at iteration 24: 0.21634615384615385
	Val acc at iteration 23: 0.3404255319148936
	Train acc at iteration 25: 0.27403846153846156
	Val acc at iteration 24: 0.22340425531914893
	Train acc at iteration 26: 0.30128205128205127
	Val acc at iteration 25: 0.32978723404255317
	Train acc at iteration 27: 0.3317307692307692
	Val acc at iteration 26: 0.35106382978723405
	Train acc at iteration 28: 0.36698717948717946
	Val acc at iteration 27: 0.3617021276595745
	Train acc at iteration 29: 0.4391025641025641
	Val acc at iteration 28: 0.4787234042553192
	Train acc at iteration 30: 0.47115384615384615
	Val acc at iteration 29: 0.5638297872340425
	Train acc at iteration 31: 0.4967948717948718
	Val acc at iteration 30: 0.5212765957446809
	Train acc at iteration 32: 0.5801282051282052
	Val acc at iteration 31: 0.574468085106383
	Train acc at iteration 33: 0.5897435897435898
	Val acc at iteration 32: 0.6170212765957447
	Train acc at iteration 34: 0.6682692307692307
	Val acc at iteration 33: 0.6063829787234043
	Train acc at iteration 35: 0.5512820512820513
	Val acc at iteration 34: 0.6595744680851063
	Train acc at iteration 36: 0.6282051282051282
	Val acc at iteration 35: 0.7021276595744681
	Train acc at iteration 37: 0.6939102564102564
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.6746794871794872
	Val acc at iteration 37: 0.6382978723404256
	Train acc at iteration 39: 0.7099358974358975
	Val acc at iteration 38: 0.7340425531914894
	Train acc at iteration 40: 0.7099358974358975
	Val acc at iteration 39: 0.776595744680851
	Train acc at iteration 41: 0.7003205128205128
	Val acc at iteration 40: 0.6382978723404256
	Train acc at iteration 42: 0.7083333333333334
	Val acc at iteration 41: 0.7978723404255319
	Train acc at iteration 43: 0.7291666666666666
	Val acc at iteration 42: 0.648936170212766
	Train acc at iteration 44: 0.6778846153846154
	Val acc at iteration 43: 0.7127659574468085
	Train acc at iteration 45: 0.7259615384615384
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.7163461538461539
	Val acc at iteration 45: 0.723404255319149
	Train acc at iteration 47: 0.7099358974358975
	Val acc at iteration 46: 0.723404255319149
	Train acc at iteration 48: 0.7548076923076923
	Val acc at iteration 47: 0.776595744680851
	Train acc at iteration 49: 0.7163461538461539
	Val acc at iteration 48: 0.6702127659574468
	Train acc at iteration 50: 0.7516025641025641
	Val acc at iteration 49: 0.7978723404255319
	Train acc at iteration 51: 0.7131410256410257
	Val acc at iteration 50: 0.8191489361702128
	Train acc at iteration 52: 0.7211538461538461
	Val acc at iteration 51: 0.723404255319149
	Train acc at iteration 53: 0.7323717948717948
	Val acc at iteration 52: 0.7553191489361702
	Train acc at iteration 54: 0.7291666666666666
	Val acc at iteration 53: 0.7553191489361702
	Train acc at iteration 55: 0.719551282051282
	Val acc at iteration 54: 0.776595744680851
	Train acc at iteration 56: 0.7291666666666666
	Val acc at iteration 55: 0.7127659574468085
	Train acc at iteration 57: 0.7227564102564102
	Val acc at iteration 56: 0.7021276595744681
	Train acc at iteration 58: 0.7019230769230769
	Val acc at iteration 57: 0.7340425531914894
	Train acc at iteration 59: 0.7419871794871795
	Val acc at iteration 58: 0.7978723404255319
	Train acc at iteration 60: 0.7724358974358975
	Val acc at iteration 59: 0.776595744680851
	Train acc at iteration 61: 0.7516025641025641
	Val acc at iteration 60: 0.7021276595744681
	Train acc at iteration 62: 0.7131410256410257
	Val acc at iteration 61: 0.6702127659574468
	Train acc at iteration 63: 0.6939102564102564
	Val acc at iteration 62: 0.7978723404255319
	Train acc at iteration 64: 0.7371794871794872
	Val acc at iteration 63: 0.7659574468085106
	Train acc at iteration 65: 0.7644230769230769
	Val acc at iteration 64: 0.6914893617021277
	Train acc at iteration 66: 0.7355769230769231
	Val acc at iteration 65: 0.6808510638297872
	Train acc at iteration 67: 0.7131410256410257
	Val acc at iteration 66: 0.6914893617021277
	Train acc at iteration 68: 0.7467948717948718
	Val acc at iteration 67: 0.7127659574468085
	Train acc at iteration 69: 0.7115384615384616
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.7307692307692307
	Val acc at iteration 69: 0.6914893617021277
	Train acc at iteration 71: 0.719551282051282
	Val acc at iteration 70: 0.7553191489361702
	Train acc at iteration 72: 0.7339743589743589
	Val acc at iteration 71: 0.7340425531914894
	Train acc at iteration 73: 0.7227564102564102
	Val acc at iteration 72: 0.7446808510638298
	Train acc at iteration 74: 0.7387820512820513
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.7323717948717948
	Val acc at iteration 74: 0.7446808510638298
	Train acc at iteration 76: 0.7371794871794872
	Val acc at iteration 75: 0.7340425531914894
	Train acc at iteration 77: 0.7387820512820513
	Val acc at iteration 76: 0.7127659574468085
	Train acc at iteration 78: 0.7259615384615384
	Val acc at iteration 77: 0.7021276595744681
	Train acc at iteration 79: 0.7355769230769231
	Val acc at iteration 78: 0.7659574468085106
	Train acc at iteration 80: 0.7435897435897436
	Val acc at iteration 79: 0.6702127659574468
	Train acc at iteration 81: 0.7211538461538461
	Val acc at iteration 80: 0.723404255319149
	Train acc at iteration 82: 0.6987179487179487
	Val acc at iteration 81: 0.6914893617021277
	Train acc at iteration 83: 0.75
	Val acc at iteration 82: 0.7446808510638298
	Train acc at iteration 84: 0.7323717948717948
	Val acc at iteration 83: 0.7978723404255319
	Train acc at iteration 85: 0.7483974358974359
	Val acc at iteration 84: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6529209621993127
Final val micro accuracy: 0.7553191489361702
Final test macro f1-score: 0.5209302325581394
Final test micro accuracy: 0.6276595744680851
Final validation:
	Cluster: 0.6320962607860565
	Separation: 0.5518079102039337
Final test:
	Cluster: 0.6073203980922699
	Separation: 0.5399091839790344
Saved Results

Attempting combination 3/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7772435897435898
	Train Cluster: 0.6362207889556885
	Train Separation: 0.5186580419540405
(Directly after push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.6276595744680851
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.8191489361702128
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.7659574468085106
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.776595744680851
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.7872340425531915
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.7553191489361702
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7978723404255319
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9680851063829787
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Train Cluster: 0.648093295097351
	Train Separation: 0.5179021716117859
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7553191489361702
	Val acc at iteration 4: 0.7553191489361702
	Val acc at iteration 5: 0.7872340425531915
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.7659574468085106
	Val acc at iteration 12: 0.7872340425531915
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.8085106382978723
	Val acc at iteration 15: 0.776595744680851
	Val acc at iteration 16: 0.8085106382978723
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.7872340425531915
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.8191489361702128
	Val acc at iteration 26: 0.7659574468085106
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.7978723404255319
	Val acc at iteration 33: 0.8085106382978723
	Val acc at iteration 34: 0.8191489361702128
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.8404255319148937
	Val acc at iteration 37: 0.7872340425531915
	Val acc at iteration 38: 0.7553191489361702
	Val acc at iteration 39: 0.7553191489361702
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.7659574468085106
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.776595744680851
	Val acc at iteration 45: 0.8085106382978723
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.776595744680851
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.776595744680851
	Val acc at iteration 51: 0.8085106382978723
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.7872340425531915
	Val acc at iteration 54: 0.7978723404255319
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.8191489361702128
	Val acc at iteration 59: 0.776595744680851
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.8085106382978723
	Val acc at iteration 62: 0.8085106382978723
	Val acc at iteration 63: 0.7978723404255319
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.7872340425531915
	Val acc at iteration 68: 0.8297872340425532
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.8191489361702128
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.7978723404255319
	Val acc at iteration 74: 0.7978723404255319
	Val acc at iteration 75: 0.8085106382978723
	Val acc at iteration 76: 0.7978723404255319
	Val acc at iteration 77: 0.7978723404255319
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.8404255319148937
	Val acc at iteration 81: 0.7978723404255319
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.8404255319148937
	Val acc at iteration 84: 0.7446808510638298
Val acc before epoch 25: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9680851063829787
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9680851063829787
Stopping after epoch 37.
Final validation accuracy before push: 96.80851063829788%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8301282051282052
	Train Cluster: 0.6523729801177979
	TrainSeparation: 0.5237083435058594
(Directly after push) Val acc at iteration 0: 0.8297872340425532
Retraining last layer
Last layer lr: 0.05
	Train acc at iteration 1: 0.47435897435897434
	Val acc at iteration 0: 0.48936170212765956
	Train acc at iteration 2: 0.358974358974359
	Val acc at iteration 1: 0.3723404255319149
	Train acc at iteration 3: 0.3141025641025641
	Val acc at iteration 2: 0.4787234042553192
	Train acc at iteration 4: 0.27884615384615385
	Val acc at iteration 3: 0.3829787234042553
	Train acc at iteration 5: 0.34615384615384615
	Val acc at iteration 4: 0.3829787234042553
	Train acc at iteration 6: 0.3269230769230769
	Val acc at iteration 5: 0.4148936170212766
	Train acc at iteration 7: 0.375
	Val acc at iteration 6: 0.3723404255319149
	Train acc at iteration 8: 0.3301282051282051
	Val acc at iteration 7: 0.3723404255319149
	Train acc at iteration 9: 0.40064102564102566
	Val acc at iteration 8: 0.30851063829787234
	Train acc at iteration 10: 0.3926282051282051
	Val acc at iteration 9: 0.4148936170212766
	Train acc at iteration 11: 0.4358974358974359
	Val acc at iteration 10: 0.4574468085106383
	Train acc at iteration 12: 0.40705128205128205
	Val acc at iteration 11: 0.5
	Train acc at iteration 13: 0.5
	Val acc at iteration 12: 0.5106382978723404
	Train acc at iteration 14: 0.4775641025641026
	Val acc at iteration 13: 0.4148936170212766
	Train acc at iteration 15: 0.5048076923076923
	Val acc at iteration 14: 0.574468085106383
	Train acc at iteration 16: 0.4935897435897436
	Val acc at iteration 15: 0.5319148936170213
	Train acc at iteration 17: 0.5176282051282052
	Val acc at iteration 16: 0.5319148936170213
	Train acc at iteration 18: 0.4983974358974359
	Val acc at iteration 17: 0.574468085106383
	Train acc at iteration 19: 0.5416666666666666
	Val acc at iteration 18: 0.5851063829787234
	Train acc at iteration 20: 0.5512820512820513
	Val acc at iteration 19: 0.6702127659574468
	Train acc at iteration 21: 0.5753205128205128
	Val acc at iteration 20: 0.574468085106383
	Train acc at iteration 22: 0.5608974358974359
	Val acc at iteration 21: 0.6276595744680851
	Train acc at iteration 23: 0.5801282051282052
	Val acc at iteration 22: 0.5851063829787234
	Train acc at iteration 24: 0.5849358974358975
	Val acc at iteration 23: 0.6914893617021277
	Train acc at iteration 25: 0.5673076923076923
	Val acc at iteration 24: 0.648936170212766
	Train acc at iteration 26: 0.5657051282051282
	Val acc at iteration 25: 0.6702127659574468
	Train acc at iteration 27: 0.6041666666666666
	Val acc at iteration 26: 0.6276595744680851
	Train acc at iteration 28: 0.6057692307692307
	Val acc at iteration 27: 0.6914893617021277
	Train acc at iteration 29: 0.6330128205128205
	Val acc at iteration 28: 0.6702127659574468
	Train acc at iteration 30: 0.6057692307692307
	Val acc at iteration 29: 0.6808510638297872
	Train acc at iteration 31: 0.6105769230769231
	Val acc at iteration 30: 0.6063829787234043
	Train acc at iteration 32: 0.6330128205128205
	Val acc at iteration 31: 0.6808510638297872
	Train acc at iteration 33: 0.6618589743589743
	Val acc at iteration 32: 0.6702127659574468
	Train acc at iteration 34: 0.6955128205128205
	Val acc at iteration 33: 0.6808510638297872
	Train acc at iteration 35: 0.655448717948718
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.6762820512820513
	Val acc at iteration 35: 0.7446808510638298
	Train acc at iteration 37: 0.6618589743589743
	Val acc at iteration 36: 0.7659574468085106
	Train acc at iteration 38: 0.6410256410256411
	Val acc at iteration 37: 0.723404255319149
	Train acc at iteration 39: 0.6346153846153846
	Val acc at iteration 38: 0.6808510638297872
	Train acc at iteration 40: 0.625
	Val acc at iteration 39: 0.7446808510638298
	Train acc at iteration 41: 0.7019230769230769
	Val acc at iteration 40: 0.7553191489361702
	Train acc at iteration 42: 0.6666666666666666
	Val acc at iteration 41: 0.7340425531914894
	Train acc at iteration 43: 0.6586538461538461
	Val acc at iteration 42: 0.6702127659574468
	Train acc at iteration 44: 0.6762820512820513
	Val acc at iteration 43: 0.6914893617021277
	Train acc at iteration 45: 0.657051282051282
	Val acc at iteration 44: 0.6276595744680851
	Train acc at iteration 46: 0.6586538461538461
	Val acc at iteration 45: 0.7872340425531915
	Train acc at iteration 47: 0.6378205128205128
	Val acc at iteration 46: 0.6808510638297872
	Train acc at iteration 48: 0.6474358974358975
	Val acc at iteration 47: 0.7021276595744681
	Train acc at iteration 49: 0.6762820512820513
	Val acc at iteration 48: 0.7553191489361702
	Train acc at iteration 50: 0.6682692307692307
	Val acc at iteration 49: 0.7340425531914894
	Train acc at iteration 51: 0.6826923076923077
	Val acc at iteration 50: 0.723404255319149
	Train acc at iteration 52: 0.7003205128205128
	Val acc at iteration 51: 0.723404255319149
	Train acc at iteration 53: 0.6971153846153846
	Val acc at iteration 52: 0.7340425531914894
	Train acc at iteration 54: 0.7131410256410257
	Val acc at iteration 53: 0.7446808510638298
	Train acc at iteration 55: 0.7211538461538461
	Val acc at iteration 54: 0.7446808510638298
	Train acc at iteration 56: 0.6778846153846154
	Val acc at iteration 55: 0.7553191489361702
	Train acc at iteration 57: 0.6987179487179487
	Val acc at iteration 56: 0.7659574468085106
	Train acc at iteration 58: 0.7099358974358975
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.7115384615384616
	Val acc at iteration 58: 0.7978723404255319
	Train acc at iteration 60: 0.719551282051282
	Val acc at iteration 59: 0.6808510638297872
	Train acc at iteration 61: 0.7099358974358975
	Val acc at iteration 60: 0.7446808510638298
	Train acc at iteration 62: 0.7211538461538461
	Val acc at iteration 61: 0.7021276595744681
	Train acc at iteration 63: 0.6826923076923077
	Val acc at iteration 62: 0.7446808510638298
	Train acc at iteration 64: 0.6891025641025641
	Val acc at iteration 63: 0.7021276595744681
	Train acc at iteration 65: 0.7099358974358975
	Val acc at iteration 64: 0.6382978723404256
	Train acc at iteration 66: 0.6987179487179487
	Val acc at iteration 65: 0.6595744680851063
	Train acc at iteration 67: 0.6955128205128205
	Val acc at iteration 66: 0.6914893617021277
	Train acc at iteration 68: 0.6730769230769231
	Val acc at iteration 67: 0.7340425531914894
	Train acc at iteration 69: 0.6891025641025641
	Val acc at iteration 68: 0.6808510638297872
	Train acc at iteration 70: 0.7131410256410257
	Val acc at iteration 69: 0.776595744680851
	Train acc at iteration 71: 0.7083333333333334
	Val acc at iteration 70: 0.723404255319149
	Train acc at iteration 72: 0.7067307692307693
	Val acc at iteration 71: 0.7340425531914894
	Train acc at iteration 73: 0.6842948717948718
	Val acc at iteration 72: 0.7659574468085106
	Train acc at iteration 74: 0.6891025641025641
	Val acc at iteration 73: 0.6276595744680851
	Train acc at iteration 75: 0.7131410256410257
	Val acc at iteration 74: 0.7553191489361702
	Train acc at iteration 76: 0.7051282051282052
	Val acc at iteration 75: 0.723404255319149
	Train acc at iteration 77: 0.7083333333333334
	Val acc at iteration 76: 0.7553191489361702
	Train acc at iteration 78: 0.6875
	Val acc at iteration 77: 0.6702127659574468
	Train acc at iteration 79: 0.6682692307692307
	Val acc at iteration 78: 0.7127659574468085
	Train acc at iteration 80: 0.6971153846153846
	Val acc at iteration 79: 0.7978723404255319
	Train acc at iteration 81: 0.7580128205128205
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.7275641025641025
	Val acc at iteration 81: 0.6914893617021277
	Train acc at iteration 83: 0.6955128205128205
	Val acc at iteration 82: 0.7872340425531915
	Train acc at iteration 84: 0.6939102564102564
	Val acc at iteration 83: 0.7659574468085106
	Train acc at iteration 85: 0.7243589743589743
	Val acc at iteration 84: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6287719298245614
Final val micro accuracy: 0.723404255319149
Final test macro f1-score: 0.5167220376522702
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6237804293632507
	Separation: 0.5402925610542297
Final test:
	Cluster: 0.5817630290985107
	Separation: 0.5423632264137268
Saved Results

Attempting combination 4/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.01
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.425531914893617
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5531914893617021
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.7872340425531915
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7387820512820513
	Train Cluster: 0.631297516822815
	Train Separation: 0.5201545238494873
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5531914893617021
	Val acc at iteration 1: 0.5851063829787234
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.5638297872340425
	Val acc at iteration 15: 0.6382978723404256
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.6063829787234043
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.5425531914893617
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.6170212765957447
	Val acc at iteration 36: 0.6063829787234043
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.5957446808510638
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.7446808510638298
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6276595744680851
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7872340425531915
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.8085106382978723
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 13: 0.7340425531914894
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8108974358974359
	Train Cluster: 0.64163578748703
	Train Separation: 0.5211202144622803
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.7978723404255319
	Val acc at iteration 5: 0.7872340425531915
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.7659574468085106
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.776595744680851
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.7978723404255319
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.776595744680851
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.7872340425531915
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.8191489361702128
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.8085106382978723
	Val acc at iteration 44: 0.8297872340425532
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7659574468085106
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.7978723404255319
	Val acc at iteration 50: 0.8085106382978723
	Val acc at iteration 51: 0.776595744680851
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.8191489361702128
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.7872340425531915
	Val acc at iteration 61: 0.7978723404255319
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7978723404255319
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.8085106382978723
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.8085106382978723
	Val acc at iteration 70: 0.7872340425531915
	Val acc at iteration 71: 0.8085106382978723
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7978723404255319
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.7978723404255319
	Val acc at iteration 77: 0.7978723404255319
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.7872340425531915
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.7978723404255319
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.8085106382978723
	Val acc at iteration 84: 0.7659574468085106
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8221153846153846
	Train Cluster: 0.6369037508964539
	TrainSeparation: 0.5170758366584778
(Directly after push) Val acc at iteration 0: 0.7978723404255319
Retraining last layer
Last layer lr: 0.01
	Train acc at iteration 1: 0.7596153846153846
	Val acc at iteration 0: 0.7553191489361702
	Train acc at iteration 2: 0.7451923076923077
	Val acc at iteration 1: 0.7553191489361702
	Train acc at iteration 3: 0.6634615384615384
	Val acc at iteration 2: 0.6914893617021277
	Train acc at iteration 4: 0.6907051282051282
	Val acc at iteration 3: 0.6595744680851063
	Train acc at iteration 5: 0.6842948717948718
	Val acc at iteration 4: 0.6170212765957447
	Train acc at iteration 6: 0.6971153846153846
	Val acc at iteration 5: 0.6702127659574468
	Train acc at iteration 7: 0.7099358974358975
	Val acc at iteration 6: 0.7872340425531915
	Train acc at iteration 8: 0.7115384615384616
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.7099358974358975
	Val acc at iteration 8: 0.7127659574468085
	Train acc at iteration 10: 0.7067307692307693
	Val acc at iteration 9: 0.7127659574468085
	Train acc at iteration 11: 0.717948717948718
	Val acc at iteration 10: 0.7340425531914894
	Train acc at iteration 12: 0.717948717948718
	Val acc at iteration 11: 0.6595744680851063
	Train acc at iteration 13: 0.7163461538461539
	Val acc at iteration 12: 0.776595744680851
	Train acc at iteration 14: 0.7147435897435898
	Val acc at iteration 13: 0.7978723404255319
	Train acc at iteration 15: 0.7227564102564102
	Val acc at iteration 14: 0.7127659574468085
	Train acc at iteration 16: 0.7147435897435898
	Val acc at iteration 15: 0.776595744680851
	Train acc at iteration 17: 0.75
	Val acc at iteration 16: 0.7127659574468085
	Train acc at iteration 18: 0.7740384615384616
	Val acc at iteration 17: 0.7446808510638298
	Train acc at iteration 19: 0.7435897435897436
	Val acc at iteration 18: 0.7446808510638298
	Train acc at iteration 20: 0.7548076923076923
	Val acc at iteration 19: 0.776595744680851
	Train acc at iteration 21: 0.7612179487179487
	Val acc at iteration 20: 0.776595744680851
	Train acc at iteration 22: 0.7628205128205128
	Val acc at iteration 21: 0.8191489361702128
	Train acc at iteration 23: 0.7532051282051282
	Val acc at iteration 22: 0.8085106382978723
	Train acc at iteration 24: 0.7612179487179487
	Val acc at iteration 23: 0.7446808510638298
	Train acc at iteration 25: 0.782051282051282
	Val acc at iteration 24: 0.851063829787234
	Train acc at iteration 26: 0.7772435897435898
	Val acc at iteration 25: 0.7659574468085106
	Train acc at iteration 27: 0.7884615384615384
	Val acc at iteration 26: 0.8085106382978723
	Train acc at iteration 28: 0.7660256410256411
	Val acc at iteration 27: 0.8297872340425532
	Train acc at iteration 29: 0.7836538461538461
	Val acc at iteration 28: 0.776595744680851
	Train acc at iteration 30: 0.7868589743589743
	Val acc at iteration 29: 0.8085106382978723
	Train acc at iteration 31: 0.7868589743589743
	Val acc at iteration 30: 0.8297872340425532
	Train acc at iteration 32: 0.7948717948717948
	Val acc at iteration 31: 0.7659574468085106
	Train acc at iteration 33: 0.7964743589743589
	Val acc at iteration 32: 0.8297872340425532
	Train acc at iteration 34: 0.8092948717948718
	Val acc at iteration 33: 0.7872340425531915
	Train acc at iteration 35: 0.8365384615384616
	Val acc at iteration 34: 0.8191489361702128
	Train acc at iteration 36: 0.7884615384615384
	Val acc at iteration 35: 0.8617021276595744
	Train acc at iteration 37: 0.7868589743589743
	Val acc at iteration 36: 0.8085106382978723
	Train acc at iteration 38: 0.7996794871794872
	Val acc at iteration 37: 0.8404255319148937
	Train acc at iteration 39: 0.8381410256410257
	Val acc at iteration 38: 0.8297872340425532
	Train acc at iteration 40: 0.8173076923076923
	Val acc at iteration 39: 0.8191489361702128
	Train acc at iteration 41: 0.8044871794871795
	Val acc at iteration 40: 0.8617021276595744
	Train acc at iteration 42: 0.8189102564102564
	Val acc at iteration 41: 0.7978723404255319
	Train acc at iteration 43: 0.8365384615384616
	Val acc at iteration 42: 0.8191489361702128
	Train acc at iteration 44: 0.8028846153846154
	Val acc at iteration 43: 0.8297872340425532
	Train acc at iteration 45: 0.8317307692307693
	Val acc at iteration 44: 0.8617021276595744
	Train acc at iteration 46: 0.8157051282051282
	Val acc at iteration 45: 0.8404255319148937
	Train acc at iteration 47: 0.8173076923076923
	Val acc at iteration 46: 0.8191489361702128
	Train acc at iteration 48: 0.8221153846153846
	Val acc at iteration 47: 0.851063829787234
	Train acc at iteration 49: 0.8141025641025641
	Val acc at iteration 48: 0.7978723404255319
	Train acc at iteration 50: 0.8493589743589743
	Val acc at iteration 49: 0.851063829787234
	Train acc at iteration 51: 0.8397435897435898
	Val acc at iteration 50: 0.8723404255319149
	Train acc at iteration 52: 0.8317307692307693
	Val acc at iteration 51: 0.8297872340425532
	Train acc at iteration 53: 0.8413461538461539
	Val acc at iteration 52: 0.9042553191489362
	Train acc at iteration 54: 0.8285256410256411
	Val acc at iteration 53: 0.8617021276595744
	Train acc at iteration 55: 0.8525641025641025
	Val acc at iteration 54: 0.8936170212765957
	Train acc at iteration 56: 0.8108974358974359
	Val acc at iteration 55: 0.8191489361702128
	Train acc at iteration 57: 0.842948717948718
	Val acc at iteration 56: 0.8829787234042553
	Train acc at iteration 58: 0.8557692307692307
	Val acc at iteration 57: 0.8085106382978723
	Train acc at iteration 59: 0.8253205128205128
	Val acc at iteration 58: 0.851063829787234
	Train acc at iteration 60: 0.8189102564102564
	Val acc at iteration 59: 0.8723404255319149
	Train acc at iteration 61: 0.8557692307692307
	Val acc at iteration 60: 0.851063829787234
	Train acc at iteration 62: 0.8237179487179487
	Val acc at iteration 61: 0.8936170212765957
	Train acc at iteration 63: 0.8541666666666666
	Val acc at iteration 62: 0.8617021276595744
	Train acc at iteration 64: 0.8605769230769231
	Val acc at iteration 63: 0.8404255319148937
	Train acc at iteration 65: 0.8397435897435898
	Val acc at iteration 64: 0.8936170212765957
	Train acc at iteration 66: 0.8525641025641025
	Val acc at iteration 65: 0.9042553191489362
	Train acc at iteration 67: 0.8573717948717948
	Val acc at iteration 66: 0.8829787234042553
	Train acc at iteration 68: 0.8509615384615384
	Val acc at iteration 67: 0.8617021276595744
	Train acc at iteration 69: 0.8349358974358975
	Val acc at iteration 68: 0.9042553191489362
	Train acc at iteration 70: 0.8589743589743589
	Val acc at iteration 69: 0.9042553191489362
	Train acc at iteration 71: 0.8397435897435898
	Val acc at iteration 70: 0.8723404255319149
	Train acc at iteration 72: 0.8525641025641025
	Val acc at iteration 71: 0.9042553191489362
	Train acc at iteration 73: 0.8637820512820513
	Val acc at iteration 72: 0.7978723404255319
	Train acc at iteration 74: 0.8493589743589743
	Val acc at iteration 73: 0.9148936170212766
	Train acc at iteration 75: 0.8701923076923077
	Val acc at iteration 74: 0.8617021276595744
	Train acc at iteration 76: 0.8637820512820513
	Val acc at iteration 75: 0.8297872340425532
	Train acc at iteration 77: 0.842948717948718
	Val acc at iteration 76: 0.8829787234042553
	Train acc at iteration 78: 0.844551282051282
	Val acc at iteration 77: 0.851063829787234
	Train acc at iteration 79: 0.8621794871794872
	Val acc at iteration 78: 0.8404255319148937
	Train acc at iteration 80: 0.8525641025641025
	Val acc at iteration 79: 0.8936170212765957
	Train acc at iteration 81: 0.8782051282051282
	Val acc at iteration 80: 0.8617021276595744
	Train acc at iteration 82: 0.8573717948717948
	Val acc at iteration 81: 0.8617021276595744
	Train acc at iteration 83: 0.8605769230769231
	Val acc at iteration 82: 0.8723404255319149
	Train acc at iteration 84: 0.8653846153846154
	Val acc at iteration 83: 0.8829787234042553
	Train acc at iteration 85: 0.8637820512820513
	Val acc at iteration 84: 0.9468085106382979
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.8170289855072462
Final val micro accuracy: 0.8829787234042553
Final test macro f1-score: 0.7987341772151899
Final test micro accuracy: 0.8617021276595744
Final validation:
	Cluster: 0.6373409628868103
	Separation: 0.5446042716503143
Final test:
	Cluster: 0.597111850976944
	Separation: 0.5403808951377869
Saved Results

Attempting combination 5/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7660256410256411
	Train Cluster: 0.635781216621399
	Train Separation: 0.518172538280487
(Directly after push) Val acc at iteration 0: 0.5106382978723404
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.574468085106383
	Val acc at iteration 1: 0.5638297872340425
	Val acc at iteration 2: 0.5425531914893617
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.5957446808510638
	Val acc at iteration 5: 0.5851063829787234
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.5851063829787234
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6063829787234043
	Val acc at iteration 10: 0.5957446808510638
	Val acc at iteration 11: 0.6170212765957447
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.5957446808510638
	Val acc at iteration 14: 0.5957446808510638
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.6063829787234043
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.6382978723404256
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.6382978723404256
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.6170212765957447
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6063829787234043
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.6276595744680851
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.723404255319149
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 13: 0.6702127659574468
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.8141025641025641
	Train Cluster: 0.6489614248275757
	Train Separation: 0.5185856103897095
(Directly after push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.7659574468085106
	Val acc at iteration 2: 0.8085106382978723
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.7446808510638298
	Val acc at iteration 5: 0.7659574468085106
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.8085106382978723
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.7553191489361702
	Val acc at iteration 14: 0.776595744680851
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.776595744680851
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.7872340425531915
	Val acc at iteration 24: 0.7553191489361702
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7978723404255319
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.776595744680851
	Val acc at iteration 29: 0.7978723404255319
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.8085106382978723
	Val acc at iteration 35: 0.776595744680851
	Val acc at iteration 36: 0.7446808510638298
	Val acc at iteration 37: 0.7446808510638298
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.7872340425531915
	Val acc at iteration 41: 0.8085106382978723
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.7978723404255319
	Val acc at iteration 53: 0.7872340425531915
	Val acc at iteration 54: 0.7872340425531915
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.7659574468085106
	Val acc at iteration 58: 0.776595744680851
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.8191489361702128
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7872340425531915
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.8085106382978723
	Val acc at iteration 68: 0.8085106382978723
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7978723404255319
	Val acc at iteration 76: 0.8191489361702128
	Val acc at iteration 77: 0.7978723404255319
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.8085106382978723
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.7978723404255319
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 25: 0.7340425531914894
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.842948717948718
	Train Cluster: 0.6541540503501893
	TrainSeparation: 0.5223595023155212
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.005
	Train acc at iteration 1: 0.7692307692307693
	Val acc at iteration 0: 0.7127659574468085
	Train acc at iteration 2: 0.7612179487179487
	Val acc at iteration 1: 0.7553191489361702
	Train acc at iteration 3: 0.7676282051282052
	Val acc at iteration 2: 0.723404255319149
	Train acc at iteration 4: 0.8076923076923077
	Val acc at iteration 3: 0.7978723404255319
	Train acc at iteration 5: 0.7692307692307693
	Val acc at iteration 4: 0.723404255319149
	Train acc at iteration 6: 0.7644230769230769
	Val acc at iteration 5: 0.7127659574468085
	Train acc at iteration 7: 0.7548076923076923
	Val acc at iteration 6: 0.6702127659574468
	Train acc at iteration 8: 0.7692307692307693
	Val acc at iteration 7: 0.7659574468085106
	Train acc at iteration 9: 0.7948717948717948
	Val acc at iteration 8: 0.7872340425531915
	Train acc at iteration 10: 0.7660256410256411
	Val acc at iteration 9: 0.7553191489361702
	Train acc at iteration 11: 0.7660256410256411
	Val acc at iteration 10: 0.776595744680851
	Train acc at iteration 12: 0.8108974358974359
	Val acc at iteration 11: 0.776595744680851
	Train acc at iteration 13: 0.7980769230769231
	Val acc at iteration 12: 0.7340425531914894
	Train acc at iteration 14: 0.8173076923076923
	Val acc at iteration 13: 0.7872340425531915
	Train acc at iteration 15: 0.7852564102564102
	Val acc at iteration 14: 0.723404255319149
	Train acc at iteration 16: 0.7980769230769231
	Val acc at iteration 15: 0.6808510638297872
	Train acc at iteration 17: 0.7900641025641025
	Val acc at iteration 16: 0.7446808510638298
	Train acc at iteration 18: 0.8205128205128205
	Val acc at iteration 17: 0.7127659574468085
	Train acc at iteration 19: 0.7980769230769231
	Val acc at iteration 18: 0.7553191489361702
	Train acc at iteration 20: 0.7980769230769231
	Val acc at iteration 19: 0.7872340425531915
	Train acc at iteration 21: 0.7964743589743589
	Val acc at iteration 20: 0.776595744680851
	Train acc at iteration 22: 0.7788461538461539
	Val acc at iteration 21: 0.723404255319149
	Train acc at iteration 23: 0.8044871794871795
	Val acc at iteration 22: 0.7872340425531915
	Train acc at iteration 24: 0.8044871794871795
	Val acc at iteration 23: 0.8191489361702128
	Train acc at iteration 25: 0.8157051282051282
	Val acc at iteration 24: 0.723404255319149
	Train acc at iteration 26: 0.8221153846153846
	Val acc at iteration 25: 0.8085106382978723
	Train acc at iteration 27: 0.8205128205128205
	Val acc at iteration 26: 0.851063829787234
	Train acc at iteration 28: 0.8125
	Val acc at iteration 27: 0.8085106382978723
	Train acc at iteration 29: 0.8125
	Val acc at iteration 28: 0.7978723404255319
	Train acc at iteration 30: 0.7964743589743589
	Val acc at iteration 29: 0.776595744680851
	Train acc at iteration 31: 0.7996794871794872
	Val acc at iteration 30: 0.8191489361702128
	Train acc at iteration 32: 0.8060897435897436
	Val acc at iteration 31: 0.8297872340425532
	Train acc at iteration 33: 0.8173076923076923
	Val acc at iteration 32: 0.7978723404255319
	Train acc at iteration 34: 0.8237179487179487
	Val acc at iteration 33: 0.776595744680851
	Train acc at iteration 35: 0.8125
	Val acc at iteration 34: 0.776595744680851
	Train acc at iteration 36: 0.8237179487179487
	Val acc at iteration 35: 0.8404255319148937
	Train acc at iteration 37: 0.8301282051282052
	Val acc at iteration 36: 0.8191489361702128
	Train acc at iteration 38: 0.8173076923076923
	Val acc at iteration 37: 0.8085106382978723
	Train acc at iteration 39: 0.8253205128205128
	Val acc at iteration 38: 0.851063829787234
	Train acc at iteration 40: 0.8413461538461539
	Val acc at iteration 39: 0.8297872340425532
	Train acc at iteration 41: 0.8028846153846154
	Val acc at iteration 40: 0.776595744680851
	Train acc at iteration 42: 0.844551282051282
	Val acc at iteration 41: 0.8191489361702128
	Train acc at iteration 43: 0.8541666666666666
	Val acc at iteration 42: 0.8297872340425532
	Train acc at iteration 44: 0.8397435897435898
	Val acc at iteration 43: 0.8829787234042553
	Train acc at iteration 45: 0.8060897435897436
	Val acc at iteration 44: 0.851063829787234
	Train acc at iteration 46: 0.8349358974358975
	Val acc at iteration 45: 0.8297872340425532
	Train acc at iteration 47: 0.8285256410256411
	Val acc at iteration 46: 0.8297872340425532
	Train acc at iteration 48: 0.8285256410256411
	Val acc at iteration 47: 0.776595744680851
	Train acc at iteration 49: 0.8605769230769231
	Val acc at iteration 48: 0.8297872340425532
	Train acc at iteration 50: 0.8493589743589743
	Val acc at iteration 49: 0.8191489361702128
	Train acc at iteration 51: 0.8621794871794872
	Val acc at iteration 50: 0.8297872340425532
	Train acc at iteration 52: 0.8509615384615384
	Val acc at iteration 51: 0.8617021276595744
	Train acc at iteration 53: 0.8397435897435898
	Val acc at iteration 52: 0.8085106382978723
	Train acc at iteration 54: 0.8365384615384616
	Val acc at iteration 53: 0.7978723404255319
	Train acc at iteration 55: 0.8461538461538461
	Val acc at iteration 54: 0.7872340425531915
	Train acc at iteration 56: 0.8461538461538461
	Val acc at iteration 55: 0.8191489361702128
	Train acc at iteration 57: 0.8685897435897436
	Val acc at iteration 56: 0.8297872340425532
	Train acc at iteration 58: 0.8621794871794872
	Val acc at iteration 57: 0.7978723404255319
	Train acc at iteration 59: 0.8557692307692307
	Val acc at iteration 58: 0.8297872340425532
	Train acc at iteration 60: 0.8477564102564102
	Val acc at iteration 59: 0.7872340425531915
	Train acc at iteration 61: 0.8557692307692307
	Val acc at iteration 60: 0.8297872340425532
	Train acc at iteration 62: 0.8605769230769231
	Val acc at iteration 61: 0.8617021276595744
	Train acc at iteration 63: 0.8317307692307693
	Val acc at iteration 62: 0.8617021276595744
	Train acc at iteration 64: 0.8637820512820513
	Val acc at iteration 63: 0.8191489361702128
	Train acc at iteration 65: 0.8685897435897436
	Val acc at iteration 64: 0.776595744680851
	Train acc at iteration 66: 0.8541666666666666
	Val acc at iteration 65: 0.8404255319148937
	Train acc at iteration 67: 0.8413461538461539
	Val acc at iteration 66: 0.8085106382978723
	Train acc at iteration 68: 0.8685897435897436
	Val acc at iteration 67: 0.8617021276595744
	Train acc at iteration 69: 0.8493589743589743
	Val acc at iteration 68: 0.8404255319148937
	Train acc at iteration 70: 0.8701923076923077
	Val acc at iteration 69: 0.8404255319148937
	Train acc at iteration 71: 0.8301282051282052
	Val acc at iteration 70: 0.8085106382978723
	Train acc at iteration 72: 0.8285256410256411
	Val acc at iteration 71: 0.7978723404255319
	Train acc at iteration 73: 0.8605769230769231
	Val acc at iteration 72: 0.8617021276595744
	Train acc at iteration 74: 0.8653846153846154
	Val acc at iteration 73: 0.851063829787234
	Train acc at iteration 75: 0.8621794871794872
	Val acc at iteration 74: 0.8404255319148937
	Train acc at iteration 76: 0.8830128205128205
	Val acc at iteration 75: 0.8297872340425532
	Train acc at iteration 77: 0.8477564102564102
	Val acc at iteration 76: 0.8297872340425532
	Train acc at iteration 78: 0.8653846153846154
	Val acc at iteration 77: 0.851063829787234
	Train acc at iteration 79: 0.8894230769230769
	Val acc at iteration 78: 0.8723404255319149
	Train acc at iteration 80: 0.8621794871794872
	Val acc at iteration 79: 0.8723404255319149
	Train acc at iteration 81: 0.8637820512820513
	Val acc at iteration 80: 0.8191489361702128
	Train acc at iteration 82: 0.8525641025641025
	Val acc at iteration 81: 0.8085106382978723
	Train acc at iteration 83: 0.8862179487179487
	Val acc at iteration 82: 0.8297872340425532
	Train acc at iteration 84: 0.8733974358974359
	Val acc at iteration 83: 0.851063829787234
	Train acc at iteration 85: 0.8830128205128205
	Val acc at iteration 84: 0.8829787234042553
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7971014492753623
Final val micro accuracy: 0.8617021276595744
Final test macro f1-score: 0.6951807228915663
Final test micro accuracy: 0.7872340425531915
Final validation:
	Cluster: 0.6084775328636169
	Separation: 0.5415982604026794
Final test:
	Cluster: 0.5927823185920715
	Separation: 0.5366776883602142
Saved Results

Attempting combination 6/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6595744680851063
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Train Cluster: 0.6477896809577942
	Train Separation: 0.5238955736160278
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.7340425531914894
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.776595744680851
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7978723404255319
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.7872340425531915
	Val acc at iteration 35: 0.574468085106383
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7978723404255319
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.7872340425531915
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.8085106382978723
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 13: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7980769230769231
	Train Cluster: 0.6502786636352539
	Train Separation: 0.5248035788536072
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.7553191489361702
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.8085106382978723
	Val acc at iteration 5: 0.7872340425531915
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.8191489361702128
	Val acc at iteration 8: 0.8297872340425532
	Val acc at iteration 9: 0.7553191489361702
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.8404255319148937
	Val acc at iteration 12: 0.7659574468085106
	Val acc at iteration 13: 0.8617021276595744
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.8191489361702128
	Val acc at iteration 16: 0.8191489361702128
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.8085106382978723
	Val acc at iteration 19: 0.7872340425531915
	Val acc at iteration 20: 0.8085106382978723
	Val acc at iteration 21: 0.8191489361702128
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.7978723404255319
	Val acc at iteration 24: 0.8404255319148937
	Val acc at iteration 25: 0.8085106382978723
	Val acc at iteration 26: 0.776595744680851
	Val acc at iteration 27: 0.8191489361702128
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.8085106382978723
	Val acc at iteration 31: 0.8191489361702128
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.7659574468085106
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.7978723404255319
	Val acc at iteration 36: 0.8085106382978723
	Val acc at iteration 37: 0.776595744680851
	Val acc at iteration 38: 0.7872340425531915
	Val acc at iteration 39: 0.8191489361702128
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.7872340425531915
	Val acc at iteration 42: 0.8085106382978723
	Val acc at iteration 43: 0.8297872340425532
	Val acc at iteration 44: 0.8297872340425532
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.7872340425531915
	Val acc at iteration 47: 0.776595744680851
	Val acc at iteration 48: 0.7978723404255319
	Val acc at iteration 49: 0.8085106382978723
	Val acc at iteration 50: 0.8085106382978723
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.8297872340425532
	Val acc at iteration 55: 0.7872340425531915
	Val acc at iteration 56: 0.8085106382978723
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.8297872340425532
	Val acc at iteration 63: 0.8297872340425532
	Val acc at iteration 64: 0.7872340425531915
	Val acc at iteration 65: 0.7978723404255319
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.7978723404255319
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.7978723404255319
	Val acc at iteration 73: 0.8085106382978723
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.7553191489361702
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7446808510638298
	Val acc at iteration 78: 0.7978723404255319
	Val acc at iteration 79: 0.8191489361702128
	Val acc at iteration 80: 0.7978723404255319
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7978723404255319
Val acc before epoch 25: 0.8191489361702128
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.6458701729774475
	TrainSeparation: 0.5198349118232727
(Directly after push) Val acc at iteration 0: 0.8085106382978723
Retraining last layer
Last layer lr: 0.001
	Train acc at iteration 1: 0.8333333333333334
	Val acc at iteration 0: 0.7872340425531915
	Train acc at iteration 2: 0.7996794871794872
	Val acc at iteration 1: 0.8191489361702128
	Train acc at iteration 3: 0.8237179487179487
	Val acc at iteration 2: 0.8404255319148937
	Train acc at iteration 4: 0.842948717948718
	Val acc at iteration 3: 0.7978723404255319
	Train acc at iteration 5: 0.8060897435897436
	Val acc at iteration 4: 0.7978723404255319
	Train acc at iteration 6: 0.8108974358974359
	Val acc at iteration 5: 0.776595744680851
	Train acc at iteration 7: 0.8381410256410257
	Val acc at iteration 6: 0.7340425531914894
	Train acc at iteration 8: 0.8205128205128205
	Val acc at iteration 7: 0.776595744680851
	Train acc at iteration 9: 0.8253205128205128
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8541666666666666
	Val acc at iteration 9: 0.7978723404255319
	Train acc at iteration 11: 0.8525641025641025
	Val acc at iteration 10: 0.8191489361702128
	Train acc at iteration 12: 0.8189102564102564
	Val acc at iteration 11: 0.8191489361702128
	Train acc at iteration 13: 0.8205128205128205
	Val acc at iteration 12: 0.7872340425531915
	Train acc at iteration 14: 0.8253205128205128
	Val acc at iteration 13: 0.7340425531914894
	Train acc at iteration 15: 0.8253205128205128
	Val acc at iteration 14: 0.776595744680851
	Train acc at iteration 16: 0.8413461538461539
	Val acc at iteration 15: 0.8404255319148937
	Train acc at iteration 17: 0.8605769230769231
	Val acc at iteration 16: 0.851063829787234
	Train acc at iteration 18: 0.8173076923076923
	Val acc at iteration 17: 0.851063829787234
	Train acc at iteration 19: 0.8477564102564102
	Val acc at iteration 18: 0.7978723404255319
	Train acc at iteration 20: 0.8557692307692307
	Val acc at iteration 19: 0.8297872340425532
	Train acc at iteration 21: 0.8525641025641025
	Val acc at iteration 20: 0.7127659574468085
	Train acc at iteration 22: 0.8285256410256411
	Val acc at iteration 21: 0.8085106382978723
	Train acc at iteration 23: 0.8461538461538461
	Val acc at iteration 22: 0.8191489361702128
	Train acc at iteration 24: 0.8285256410256411
	Val acc at iteration 23: 0.8297872340425532
	Train acc at iteration 25: 0.8365384615384616
	Val acc at iteration 24: 0.8191489361702128
	Train acc at iteration 26: 0.8189102564102564
	Val acc at iteration 25: 0.776595744680851
	Train acc at iteration 27: 0.8301282051282052
	Val acc at iteration 26: 0.9042553191489362
	Train acc at iteration 28: 0.8317307692307693
	Val acc at iteration 27: 0.7978723404255319
	Train acc at iteration 29: 0.8173076923076923
	Val acc at iteration 28: 0.7872340425531915
	Train acc at iteration 30: 0.8509615384615384
	Val acc at iteration 29: 0.7659574468085106
	Train acc at iteration 31: 0.8205128205128205
	Val acc at iteration 30: 0.7659574468085106
	Train acc at iteration 32: 0.8333333333333334
	Val acc at iteration 31: 0.776595744680851
	Train acc at iteration 33: 0.8285256410256411
	Val acc at iteration 32: 0.7978723404255319
	Train acc at iteration 34: 0.8125
	Val acc at iteration 33: 0.8404255319148937
	Train acc at iteration 35: 0.8525641025641025
	Val acc at iteration 34: 0.7872340425531915
	Train acc at iteration 36: 0.844551282051282
	Val acc at iteration 35: 0.8085106382978723
	Train acc at iteration 37: 0.8621794871794872
	Val acc at iteration 36: 0.7872340425531915
	Train acc at iteration 38: 0.8349358974358975
	Val acc at iteration 37: 0.7446808510638298
	Train acc at iteration 39: 0.8397435897435898
	Val acc at iteration 38: 0.7978723404255319
	Train acc at iteration 40: 0.8189102564102564
	Val acc at iteration 39: 0.8191489361702128
	Train acc at iteration 41: 0.8525641025641025
	Val acc at iteration 40: 0.8085106382978723
	Train acc at iteration 42: 0.8333333333333334
	Val acc at iteration 41: 0.7659574468085106
	Train acc at iteration 43: 0.8573717948717948
	Val acc at iteration 42: 0.7553191489361702
	Train acc at iteration 44: 0.8605769230769231
	Val acc at iteration 43: 0.7553191489361702
	Train acc at iteration 45: 0.8269230769230769
	Val acc at iteration 44: 0.8404255319148937
	Train acc at iteration 46: 0.8189102564102564
	Val acc at iteration 45: 0.7021276595744681
	Train acc at iteration 47: 0.8333333333333334
	Val acc at iteration 46: 0.7872340425531915
	Train acc at iteration 48: 0.8317307692307693
	Val acc at iteration 47: 0.7978723404255319
	Train acc at iteration 49: 0.8493589743589743
	Val acc at iteration 48: 0.8191489361702128
	Train acc at iteration 50: 0.8365384615384616
	Val acc at iteration 49: 0.8297872340425532
	Train acc at iteration 51: 0.8493589743589743
	Val acc at iteration 50: 0.7446808510638298
	Train acc at iteration 52: 0.8125
	Val acc at iteration 51: 0.8191489361702128
	Train acc at iteration 53: 0.8253205128205128
	Val acc at iteration 52: 0.7659574468085106
	Train acc at iteration 54: 0.8669871794871795
	Val acc at iteration 53: 0.8085106382978723
	Train acc at iteration 55: 0.8413461538461539
	Val acc at iteration 54: 0.7659574468085106
	Train acc at iteration 56: 0.8108974358974359
	Val acc at iteration 55: 0.7978723404255319
	Train acc at iteration 57: 0.8157051282051282
	Val acc at iteration 56: 0.7978723404255319
	Train acc at iteration 58: 0.8461538461538461
	Val acc at iteration 57: 0.8297872340425532
	Train acc at iteration 59: 0.8349358974358975
	Val acc at iteration 58: 0.8085106382978723
	Train acc at iteration 60: 0.8477564102564102
	Val acc at iteration 59: 0.7978723404255319
	Train acc at iteration 61: 0.842948717948718
	Val acc at iteration 60: 0.7872340425531915
	Train acc at iteration 62: 0.8397435897435898
	Val acc at iteration 61: 0.8191489361702128
	Train acc at iteration 63: 0.8397435897435898
	Val acc at iteration 62: 0.7446808510638298
	Train acc at iteration 64: 0.8349358974358975
	Val acc at iteration 63: 0.7978723404255319
	Train acc at iteration 65: 0.8621794871794872
	Val acc at iteration 64: 0.7446808510638298
	Train acc at iteration 66: 0.8365384615384616
	Val acc at iteration 65: 0.7553191489361702
	Train acc at iteration 67: 0.8525641025641025
	Val acc at iteration 66: 0.7446808510638298
	Train acc at iteration 68: 0.8477564102564102
	Val acc at iteration 67: 0.8191489361702128
	Train acc at iteration 69: 0.8573717948717948
	Val acc at iteration 68: 0.7553191489361702
	Train acc at iteration 70: 0.8589743589743589
	Val acc at iteration 69: 0.8085106382978723
	Train acc at iteration 71: 0.8509615384615384
	Val acc at iteration 70: 0.8191489361702128
	Train acc at iteration 72: 0.8493589743589743
	Val acc at iteration 71: 0.8297872340425532
	Train acc at iteration 73: 0.8525641025641025
	Val acc at iteration 72: 0.8085106382978723
	Train acc at iteration 74: 0.8349358974358975
	Val acc at iteration 73: 0.776595744680851
	Train acc at iteration 75: 0.8365384615384616
	Val acc at iteration 74: 0.8404255319148937
	Train acc at iteration 76: 0.8349358974358975
	Val acc at iteration 75: 0.7553191489361702
	Train acc at iteration 77: 0.8365384615384616
	Val acc at iteration 76: 0.7872340425531915
	Train acc at iteration 78: 0.8397435897435898
	Val acc at iteration 77: 0.7978723404255319
	Train acc at iteration 79: 0.8573717948717948
	Val acc at iteration 78: 0.7872340425531915
	Train acc at iteration 80: 0.8413461538461539
	Val acc at iteration 79: 0.7978723404255319
	Train acc at iteration 81: 0.8365384615384616
	Val acc at iteration 80: 0.8191489361702128
	Train acc at iteration 82: 0.8509615384615384
	Val acc at iteration 81: 0.8085106382978723
	Train acc at iteration 83: 0.8669871794871795
	Val acc at iteration 82: 0.8085106382978723
	Train acc at iteration 84: 0.842948717948718
	Val acc at iteration 83: 0.776595744680851
	Train acc at iteration 85: 0.8525641025641025
	Val acc at iteration 84: 0.8297872340425532
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7152777777777777
Final val micro accuracy: 0.7978723404255319
Final test macro f1-score: 0.5945736434108527
Final test micro accuracy: 0.7021276595744681
Final validation:
	Cluster: 0.6111981868743896
	Separation: 0.5386103093624115
Final test:
	Cluster: 0.6039089858531952
	Separation: 0.5388185977935791
Saved Results

Attempting combination 7/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.031914893617021274
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5212765957446809
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6702127659574468
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.7446808510638298
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Train Cluster: 0.6379976391792297
	Train Separation: 0.5214609622955322
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5851063829787234
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.5638297872340425
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.5851063829787234
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.6276595744680851
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.5851063829787234
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.6063829787234043
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.6276595744680851
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.6382978723404256
	Val acc at iteration 34: 0.5957446808510638
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.6382978723404256
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7872340425531915
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.6595744680851063
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 13: 0.6702127659574468
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Train Cluster: 0.6438762307167053
	Train Separation: 0.5190176844596863
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.7659574468085106
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7978723404255319
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.776595744680851
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.776595744680851
	Val acc at iteration 14: 0.7872340425531915
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.7872340425531915
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.7978723404255319
	Val acc at iteration 22: 0.7872340425531915
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.7978723404255319
	Val acc at iteration 25: 0.776595744680851
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.7978723404255319
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.8191489361702128
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.8191489361702128
	Val acc at iteration 39: 0.7872340425531915
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.8617021276595744
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.8404255319148937
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7872340425531915
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.8191489361702128
	Val acc at iteration 58: 0.8085106382978723
	Val acc at iteration 59: 0.8191489361702128
	Val acc at iteration 60: 0.7446808510638298
	Val acc at iteration 61: 0.7978723404255319
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.776595744680851
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7978723404255319
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.8085106382978723
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.776595744680851
	Val acc at iteration 76: 0.8085106382978723
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.8297872340425532
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.8085106382978723
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.8085106382978723
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8381410256410257
	Train Cluster: 0.6497520923614502
	TrainSeparation: 0.5216704249382019
(Directly after push) Val acc at iteration 0: 0.7978723404255319
Retraining last layer
Last layer lr: 0.0005
	Train acc at iteration 1: 0.8028846153846154
	Val acc at iteration 0: 0.7340425531914894
	Train acc at iteration 2: 0.8397435897435898
	Val acc at iteration 1: 0.7659574468085106
	Train acc at iteration 3: 0.8605769230769231
	Val acc at iteration 2: 0.7446808510638298
	Train acc at iteration 4: 0.8301282051282052
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.8493589743589743
	Val acc at iteration 4: 0.6702127659574468
	Train acc at iteration 6: 0.8541666666666666
	Val acc at iteration 5: 0.851063829787234
	Train acc at iteration 7: 0.8028846153846154
	Val acc at iteration 6: 0.7553191489361702
	Train acc at iteration 8: 0.8269230769230769
	Val acc at iteration 7: 0.7872340425531915
	Train acc at iteration 9: 0.8237179487179487
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8413461538461539
	Val acc at iteration 9: 0.7872340425531915
	Train acc at iteration 11: 0.8461538461538461
	Val acc at iteration 10: 0.7978723404255319
	Train acc at iteration 12: 0.8525641025641025
	Val acc at iteration 11: 0.776595744680851
	Train acc at iteration 13: 0.8237179487179487
	Val acc at iteration 12: 0.7659574468085106
	Train acc at iteration 14: 0.8541666666666666
	Val acc at iteration 13: 0.776595744680851
	Train acc at iteration 15: 0.8557692307692307
	Val acc at iteration 14: 0.7340425531914894
	Train acc at iteration 16: 0.8285256410256411
	Val acc at iteration 15: 0.776595744680851
	Train acc at iteration 17: 0.8589743589743589
	Val acc at iteration 16: 0.723404255319149
	Train acc at iteration 18: 0.8125
	Val acc at iteration 17: 0.7446808510638298
	Train acc at iteration 19: 0.8381410256410257
	Val acc at iteration 18: 0.7659574468085106
	Train acc at iteration 20: 0.8349358974358975
	Val acc at iteration 19: 0.7659574468085106
	Train acc at iteration 21: 0.842948717948718
	Val acc at iteration 20: 0.8085106382978723
	Train acc at iteration 22: 0.844551282051282
	Val acc at iteration 21: 0.7872340425531915
	Train acc at iteration 23: 0.8285256410256411
	Val acc at iteration 22: 0.776595744680851
	Train acc at iteration 24: 0.8221153846153846
	Val acc at iteration 23: 0.7553191489361702
	Train acc at iteration 25: 0.8253205128205128
	Val acc at iteration 24: 0.7872340425531915
	Train acc at iteration 26: 0.8525641025641025
	Val acc at iteration 25: 0.776595744680851
	Train acc at iteration 27: 0.8509615384615384
	Val acc at iteration 26: 0.7659574468085106
	Train acc at iteration 28: 0.8108974358974359
	Val acc at iteration 27: 0.7446808510638298
	Train acc at iteration 29: 0.8141025641025641
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.8365384615384616
	Val acc at iteration 29: 0.7446808510638298
	Train acc at iteration 31: 0.8493589743589743
	Val acc at iteration 30: 0.8085106382978723
	Train acc at iteration 32: 0.8493589743589743
	Val acc at iteration 31: 0.8085106382978723
	Train acc at iteration 33: 0.8285256410256411
	Val acc at iteration 32: 0.776595744680851
	Train acc at iteration 34: 0.8237179487179487
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.842948717948718
	Val acc at iteration 34: 0.7872340425531915
	Train acc at iteration 36: 0.844551282051282
	Val acc at iteration 35: 0.7872340425531915
	Train acc at iteration 37: 0.842948717948718
	Val acc at iteration 36: 0.7659574468085106
	Train acc at iteration 38: 0.842948717948718
	Val acc at iteration 37: 0.7553191489361702
	Train acc at iteration 39: 0.8477564102564102
	Val acc at iteration 38: 0.776595744680851
	Train acc at iteration 40: 0.8605769230769231
	Val acc at iteration 39: 0.7978723404255319
	Train acc at iteration 41: 0.8733974358974359
	Val acc at iteration 40: 0.7872340425531915
	Train acc at iteration 42: 0.8493589743589743
	Val acc at iteration 41: 0.7340425531914894
	Train acc at iteration 43: 0.8301282051282052
	Val acc at iteration 42: 0.7021276595744681
	Train acc at iteration 44: 0.8317307692307693
	Val acc at iteration 43: 0.776595744680851
	Train acc at iteration 45: 0.8269230769230769
	Val acc at iteration 44: 0.7553191489361702
	Train acc at iteration 46: 0.8237179487179487
	Val acc at iteration 45: 0.776595744680851
	Train acc at iteration 47: 0.8189102564102564
	Val acc at iteration 46: 0.7978723404255319
	Train acc at iteration 48: 0.8349358974358975
	Val acc at iteration 47: 0.776595744680851
	Train acc at iteration 49: 0.8493589743589743
	Val acc at iteration 48: 0.6808510638297872
	Train acc at iteration 50: 0.8461538461538461
	Val acc at iteration 49: 0.8404255319148937
	Train acc at iteration 51: 0.8381410256410257
	Val acc at iteration 50: 0.8085106382978723
	Train acc at iteration 52: 0.8365384615384616
	Val acc at iteration 51: 0.7872340425531915
	Train acc at iteration 53: 0.8621794871794872
	Val acc at iteration 52: 0.7978723404255319
	Train acc at iteration 54: 0.8365384615384616
	Val acc at iteration 53: 0.7659574468085106
	Train acc at iteration 55: 0.8381410256410257
	Val acc at iteration 54: 0.7446808510638298
	Train acc at iteration 56: 0.8141025641025641
	Val acc at iteration 55: 0.7872340425531915
	Train acc at iteration 57: 0.842948717948718
	Val acc at iteration 56: 0.7553191489361702
	Train acc at iteration 58: 0.8397435897435898
	Val acc at iteration 57: 0.7446808510638298
	Train acc at iteration 59: 0.8541666666666666
	Val acc at iteration 58: 0.7978723404255319
	Train acc at iteration 60: 0.8365384615384616
	Val acc at iteration 59: 0.7872340425531915
	Train acc at iteration 61: 0.8413461538461539
	Val acc at iteration 60: 0.8191489361702128
	Train acc at iteration 62: 0.8525641025641025
	Val acc at iteration 61: 0.8297872340425532
	Train acc at iteration 63: 0.8365384615384616
	Val acc at iteration 62: 0.6702127659574468
	Train acc at iteration 64: 0.8317307692307693
	Val acc at iteration 63: 0.776595744680851
	Train acc at iteration 65: 0.8381410256410257
	Val acc at iteration 64: 0.776595744680851
	Train acc at iteration 66: 0.8525641025641025
	Val acc at iteration 65: 0.7872340425531915
	Train acc at iteration 67: 0.8413461538461539
	Val acc at iteration 66: 0.8085106382978723
	Train acc at iteration 68: 0.8317307692307693
	Val acc at iteration 67: 0.7340425531914894
	Train acc at iteration 69: 0.8269230769230769
	Val acc at iteration 68: 0.7978723404255319
	Train acc at iteration 70: 0.8285256410256411
	Val acc at iteration 69: 0.8191489361702128
	Train acc at iteration 71: 0.842948717948718
	Val acc at iteration 70: 0.7872340425531915
	Train acc at iteration 72: 0.8525641025641025
	Val acc at iteration 71: 0.7446808510638298
	Train acc at iteration 73: 0.844551282051282
	Val acc at iteration 72: 0.7978723404255319
	Train acc at iteration 74: 0.844551282051282
	Val acc at iteration 73: 0.723404255319149
	Train acc at iteration 75: 0.8509615384615384
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.8301282051282052
	Val acc at iteration 75: 0.776595744680851
	Train acc at iteration 77: 0.8557692307692307
	Val acc at iteration 76: 0.7659574468085106
	Train acc at iteration 78: 0.842948717948718
	Val acc at iteration 77: 0.8085106382978723
	Train acc at iteration 79: 0.8589743589743589
	Val acc at iteration 78: 0.7446808510638298
	Train acc at iteration 80: 0.8493589743589743
	Val acc at iteration 79: 0.7978723404255319
	Train acc at iteration 81: 0.8381410256410257
	Val acc at iteration 80: 0.7553191489361702
	Train acc at iteration 82: 0.8509615384615384
	Val acc at iteration 81: 0.8191489361702128
	Train acc at iteration 83: 0.8317307692307693
	Val acc at iteration 82: 0.8297872340425532
	Train acc at iteration 84: 0.8349358974358975
	Val acc at iteration 83: 0.7978723404255319
	Train acc at iteration 85: 0.8189102564102564
	Val acc at iteration 84: 0.8191489361702128
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7347670250896057
Final val micro accuracy: 0.8085106382978723
Final test macro f1-score: 0.6488372093023256
Final test micro accuracy: 0.7659574468085106
Final validation:
	Cluster: 0.6120419502258301
	Separation: 0.5399340093135834
Final test:
	Cluster: 0.6046931743621826
	Separation: 0.5403065383434296
Saved Results

Attempting combination 8/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6914893617021277
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.75
	Train Cluster: 0.6434418678283691
	Train Separation: 0.5234464526176452
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7021276595744681
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6063829787234043
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.7659574468085106
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.7978723404255319
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7553191489361702
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.7659574468085106
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.7659574468085106
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Train Cluster: 0.6402235388755798
	Train Separation: 0.5208648204803467
(Directly after push) Val acc at iteration 0: 0.8404255319148937
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7978723404255319
	Val acc at iteration 1: 0.7659574468085106
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.7978723404255319
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7872340425531915
	Val acc at iteration 8: 0.7553191489361702
	Val acc at iteration 9: 0.7553191489361702
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.7872340425531915
	Val acc at iteration 15: 0.6382978723404256
	Val acc at iteration 16: 0.8085106382978723
	Val acc at iteration 17: 0.7659574468085106
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7659574468085106
	Val acc at iteration 20: 0.7659574468085106
	Val acc at iteration 21: 0.7446808510638298
	Val acc at iteration 22: 0.776595744680851
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7553191489361702
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.7978723404255319
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.7659574468085106
	Val acc at iteration 32: 0.8085106382978723
	Val acc at iteration 33: 0.7978723404255319
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.7872340425531915
	Val acc at iteration 36: 0.7659574468085106
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.7872340425531915
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.8191489361702128
	Val acc at iteration 42: 0.8085106382978723
	Val acc at iteration 43: 0.7978723404255319
	Val acc at iteration 44: 0.8191489361702128
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.7978723404255319
	Val acc at iteration 47: 0.7978723404255319
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.7659574468085106
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.8191489361702128
	Val acc at iteration 55: 0.8085106382978723
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7872340425531915
	Val acc at iteration 60: 0.776595744680851
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.8085106382978723
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7978723404255319
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.8191489361702128
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.8085106382978723
	Val acc at iteration 77: 0.8297872340425532
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.8191489361702128
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.851063829787234
	Val acc at iteration 84: 0.7872340425531915
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.6466741561889648
	TrainSeparation: 0.521973168849945
(Directly after push) Val acc at iteration 0: 0.8085106382978723
Retraining last layer
Last layer lr: 0.0001
	Train acc at iteration 1: 0.8333333333333334
	Val acc at iteration 0: 0.7553191489361702
	Train acc at iteration 2: 0.8397435897435898
	Val acc at iteration 1: 0.7446808510638298
	Train acc at iteration 3: 0.8285256410256411
	Val acc at iteration 2: 0.776595744680851
	Train acc at iteration 4: 0.8525641025641025
	Val acc at iteration 3: 0.7872340425531915
	Train acc at iteration 5: 0.8237179487179487
	Val acc at iteration 4: 0.7978723404255319
	Train acc at iteration 6: 0.8285256410256411
	Val acc at iteration 5: 0.8297872340425532
	Train acc at iteration 7: 0.8413461538461539
	Val acc at iteration 6: 0.8191489361702128
	Train acc at iteration 8: 0.8269230769230769
	Val acc at iteration 7: 0.7872340425531915
	Train acc at iteration 9: 0.8301282051282052
	Val acc at iteration 8: 0.7553191489361702
	Train acc at iteration 10: 0.8493589743589743
	Val acc at iteration 9: 0.723404255319149
	Train acc at iteration 11: 0.8525641025641025
	Val acc at iteration 10: 0.7978723404255319
	Train acc at iteration 12: 0.8253205128205128
	Val acc at iteration 11: 0.851063829787234
	Train acc at iteration 13: 0.8397435897435898
	Val acc at iteration 12: 0.8297872340425532
	Train acc at iteration 14: 0.8189102564102564
	Val acc at iteration 13: 0.8404255319148937
	Train acc at iteration 15: 0.8413461538461539
	Val acc at iteration 14: 0.7978723404255319
	Train acc at iteration 16: 0.8125
	Val acc at iteration 15: 0.7872340425531915
	Train acc at iteration 17: 0.8269230769230769
	Val acc at iteration 16: 0.7553191489361702
	Train acc at iteration 18: 0.8557692307692307
	Val acc at iteration 17: 0.7659574468085106
	Train acc at iteration 19: 0.8365384615384616
	Val acc at iteration 18: 0.8404255319148937
	Train acc at iteration 20: 0.8108974358974359
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.8141025641025641
	Val acc at iteration 20: 0.776595744680851
	Train acc at iteration 22: 0.8509615384615384
	Val acc at iteration 21: 0.7127659574468085
	Train acc at iteration 23: 0.842948717948718
	Val acc at iteration 22: 0.7340425531914894
	Train acc at iteration 24: 0.8285256410256411
	Val acc at iteration 23: 0.776595744680851
	Train acc at iteration 25: 0.8125
	Val acc at iteration 24: 0.7659574468085106
	Train acc at iteration 26: 0.8173076923076923
	Val acc at iteration 25: 0.8085106382978723
	Train acc at iteration 27: 0.8301282051282052
	Val acc at iteration 26: 0.776595744680851
	Train acc at iteration 28: 0.8317307692307693
	Val acc at iteration 27: 0.8085106382978723
	Train acc at iteration 29: 0.8349358974358975
	Val acc at iteration 28: 0.7553191489361702
	Train acc at iteration 30: 0.8397435897435898
	Val acc at iteration 29: 0.7978723404255319
	Train acc at iteration 31: 0.8317307692307693
	Val acc at iteration 30: 0.8085106382978723
	Train acc at iteration 32: 0.8253205128205128
	Val acc at iteration 31: 0.776595744680851
	Train acc at iteration 33: 0.8333333333333334
	Val acc at iteration 32: 0.7553191489361702
	Train acc at iteration 34: 0.8317307692307693
	Val acc at iteration 33: 0.8085106382978723
	Train acc at iteration 35: 0.8509615384615384
	Val acc at iteration 34: 0.7659574468085106
	Train acc at iteration 36: 0.8349358974358975
	Val acc at iteration 35: 0.7340425531914894
	Train acc at iteration 37: 0.8413461538461539
	Val acc at iteration 36: 0.8404255319148937
	Train acc at iteration 38: 0.8108974358974359
	Val acc at iteration 37: 0.776595744680851
	Train acc at iteration 39: 0.8413461538461539
	Val acc at iteration 38: 0.8191489361702128
	Train acc at iteration 40: 0.8413461538461539
	Val acc at iteration 39: 0.7659574468085106
	Train acc at iteration 41: 0.8413461538461539
	Val acc at iteration 40: 0.776595744680851
	Train acc at iteration 42: 0.8557692307692307
	Val acc at iteration 41: 0.7872340425531915
	Train acc at iteration 43: 0.8493589743589743
	Val acc at iteration 42: 0.7446808510638298
	Train acc at iteration 44: 0.842948717948718
	Val acc at iteration 43: 0.776595744680851
	Train acc at iteration 45: 0.8317307692307693
	Val acc at iteration 44: 0.7872340425531915
	Train acc at iteration 46: 0.8573717948717948
	Val acc at iteration 45: 0.776595744680851
	Train acc at iteration 47: 0.8365384615384616
	Val acc at iteration 46: 0.776595744680851
	Train acc at iteration 48: 0.8413461538461539
	Val acc at iteration 47: 0.7872340425531915
	Train acc at iteration 49: 0.8301282051282052
	Val acc at iteration 48: 0.8085106382978723
	Train acc at iteration 50: 0.842948717948718
	Val acc at iteration 49: 0.723404255319149
	Train acc at iteration 51: 0.8237179487179487
	Val acc at iteration 50: 0.776595744680851
	Train acc at iteration 52: 0.8333333333333334
	Val acc at iteration 51: 0.7872340425531915
	Train acc at iteration 53: 0.8141025641025641
	Val acc at iteration 52: 0.7978723404255319
	Train acc at iteration 54: 0.8509615384615384
	Val acc at iteration 53: 0.776595744680851
	Train acc at iteration 55: 0.8477564102564102
	Val acc at iteration 54: 0.7553191489361702
	Train acc at iteration 56: 0.8573717948717948
	Val acc at iteration 55: 0.8085106382978723
	Train acc at iteration 57: 0.8189102564102564
	Val acc at iteration 56: 0.8085106382978723
	Train acc at iteration 58: 0.8525641025641025
	Val acc at iteration 57: 0.7659574468085106
	Train acc at iteration 59: 0.8413461538461539
	Val acc at iteration 58: 0.723404255319149
	Train acc at iteration 60: 0.8381410256410257
	Val acc at iteration 59: 0.8085106382978723
	Train acc at iteration 61: 0.8589743589743589
	Val acc at iteration 60: 0.7872340425531915
	Train acc at iteration 62: 0.8365384615384616
	Val acc at iteration 61: 0.851063829787234
	Train acc at iteration 63: 0.8381410256410257
	Val acc at iteration 62: 0.7659574468085106
	Train acc at iteration 64: 0.8173076923076923
	Val acc at iteration 63: 0.776595744680851
	Train acc at iteration 65: 0.8349358974358975
	Val acc at iteration 64: 0.7553191489361702
	Train acc at iteration 66: 0.8381410256410257
	Val acc at iteration 65: 0.7872340425531915
	Train acc at iteration 67: 0.8317307692307693
	Val acc at iteration 66: 0.8404255319148937
	Train acc at iteration 68: 0.8028846153846154
	Val acc at iteration 67: 0.7127659574468085
	Train acc at iteration 69: 0.8621794871794872
	Val acc at iteration 68: 0.8085106382978723
	Train acc at iteration 70: 0.8269230769230769
	Val acc at iteration 69: 0.7446808510638298
	Train acc at iteration 71: 0.8685897435897436
	Val acc at iteration 70: 0.7446808510638298
	Train acc at iteration 72: 0.8573717948717948
	Val acc at iteration 71: 0.8191489361702128
	Train acc at iteration 73: 0.8365384615384616
	Val acc at iteration 72: 0.7553191489361702
	Train acc at iteration 74: 0.8108974358974359
	Val acc at iteration 73: 0.8191489361702128
	Train acc at iteration 75: 0.8621794871794872
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.8157051282051282
	Val acc at iteration 75: 0.723404255319149
	Train acc at iteration 77: 0.8301282051282052
	Val acc at iteration 76: 0.7553191489361702
	Train acc at iteration 78: 0.8381410256410257
	Val acc at iteration 77: 0.8085106382978723
	Train acc at iteration 79: 0.8413461538461539
	Val acc at iteration 78: 0.7659574468085106
	Train acc at iteration 80: 0.8349358974358975
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.8205128205128205
	Val acc at iteration 80: 0.7659574468085106
	Train acc at iteration 82: 0.8301282051282052
	Val acc at iteration 81: 0.7446808510638298
	Train acc at iteration 83: 0.8365384615384616
	Val acc at iteration 82: 0.7872340425531915
	Train acc at iteration 84: 0.8477564102564102
	Val acc at iteration 83: 0.776595744680851
	Train acc at iteration 85: 0.8221153846153846
	Val acc at iteration 84: 0.7553191489361702
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7263157894736842
Final val micro accuracy: 0.8085106382978723
Final test macro f1-score: 0.5926356589147286
Final test micro accuracy: 0.7021276595744681
Final validation:
	Cluster: 0.6097496151924133
	Separation: 0.5454265773296356
Final test:
	Cluster: 0.5991144180297852
	Separation: 0.5336309969425201
Saved Results

Attempting combination 9/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 5e-05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7660256410256411
	Train Cluster: 0.6551660180091858
	Train Separation: 0.5231541395187378
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.5851063829787234
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.5957446808510638
	Val acc at iteration 18: 0.7021276595744681
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6382978723404256
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.7659574468085106
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.7872340425531915
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.776595744680851
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.851063829787234
	Val acc at iteration 73: 0.723404255319149
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.851063829787234
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.6914893617021277
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8221153846153846
	Train Cluster: 0.652846097946167
	Train Separation: 0.5229439973831177
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7659574468085106
	Val acc at iteration 1: 0.7553191489361702
	Val acc at iteration 2: 0.8297872340425532
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.7553191489361702
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.776595744680851
	Val acc at iteration 12: 0.7872340425531915
	Val acc at iteration 13: 0.7659574468085106
	Val acc at iteration 14: 0.8191489361702128
	Val acc at iteration 15: 0.8191489361702128
	Val acc at iteration 16: 0.776595744680851
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.851063829787234
	Val acc at iteration 20: 0.8191489361702128
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.776595744680851
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.7553191489361702
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.8297872340425532
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.7872340425531915
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.776595744680851
	Val acc at iteration 42: 0.8085106382978723
	Val acc at iteration 43: 0.8191489361702128
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7659574468085106
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.7978723404255319
	Val acc at iteration 51: 0.7978723404255319
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.8085106382978723
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.8404255319148937
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.8085106382978723
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.7872340425531915
	Val acc at iteration 62: 0.8404255319148937
	Val acc at iteration 63: 0.8191489361702128
	Val acc at iteration 64: 0.7659574468085106
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.776595744680851
	Val acc at iteration 68: 0.8191489361702128
	Val acc at iteration 69: 0.8191489361702128
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.8191489361702128
	Val acc at iteration 72: 0.7978723404255319
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.8085106382978723
	Val acc at iteration 75: 0.7978723404255319
	Val acc at iteration 76: 0.776595744680851
	Val acc at iteration 77: 0.7978723404255319
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.776595744680851
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.7872340425531915
Val acc before epoch 25: 0.7553191489361702
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8541666666666666
	Train Cluster: 0.6551191806793213
	TrainSeparation: 0.5220739364624023
(Directly after push) Val acc at iteration 0: 0.8085106382978723
Retraining last layer
Last layer lr: 5e-05
	Train acc at iteration 1: 0.8541666666666666
	Val acc at iteration 0: 0.776595744680851
	Train acc at iteration 2: 0.842948717948718
	Val acc at iteration 1: 0.8297872340425532
	Train acc at iteration 3: 0.8285256410256411
	Val acc at iteration 2: 0.8723404255319149
	Train acc at iteration 4: 0.8349358974358975
	Val acc at iteration 3: 0.7127659574468085
	Train acc at iteration 5: 0.8253205128205128
	Val acc at iteration 4: 0.8297872340425532
	Train acc at iteration 6: 0.8477564102564102
	Val acc at iteration 5: 0.8297872340425532
	Train acc at iteration 7: 0.844551282051282
	Val acc at iteration 6: 0.8297872340425532
	Train acc at iteration 8: 0.8381410256410257
	Val acc at iteration 7: 0.8085106382978723
	Train acc at iteration 9: 0.8125
	Val acc at iteration 8: 0.7659574468085106
	Train acc at iteration 10: 0.8493589743589743
	Val acc at iteration 9: 0.7659574468085106
	Train acc at iteration 11: 0.8413461538461539
	Val acc at iteration 10: 0.851063829787234
	Train acc at iteration 12: 0.8573717948717948
	Val acc at iteration 11: 0.7659574468085106
	Train acc at iteration 13: 0.8365384615384616
	Val acc at iteration 12: 0.8085106382978723
	Train acc at iteration 14: 0.8397435897435898
	Val acc at iteration 13: 0.8404255319148937
	Train acc at iteration 15: 0.8461538461538461
	Val acc at iteration 14: 0.723404255319149
	Train acc at iteration 16: 0.8349358974358975
	Val acc at iteration 15: 0.7659574468085106
	Train acc at iteration 17: 0.8285256410256411
	Val acc at iteration 16: 0.7446808510638298
	Train acc at iteration 18: 0.8461538461538461
	Val acc at iteration 17: 0.8617021276595744
	Train acc at iteration 19: 0.8381410256410257
	Val acc at iteration 18: 0.7659574468085106
	Train acc at iteration 20: 0.8333333333333334
	Val acc at iteration 19: 0.776595744680851
	Train acc at iteration 21: 0.8349358974358975
	Val acc at iteration 20: 0.8297872340425532
	Train acc at iteration 22: 0.8253205128205128
	Val acc at iteration 21: 0.7446808510638298
	Train acc at iteration 23: 0.8285256410256411
	Val acc at iteration 22: 0.8829787234042553
	Train acc at iteration 24: 0.8365384615384616
	Val acc at iteration 23: 0.8297872340425532
	Train acc at iteration 25: 0.8381410256410257
	Val acc at iteration 24: 0.7021276595744681
	Train acc at iteration 26: 0.8365384615384616
	Val acc at iteration 25: 0.776595744680851
	Train acc at iteration 27: 0.8477564102564102
	Val acc at iteration 26: 0.7340425531914894
	Train acc at iteration 28: 0.842948717948718
	Val acc at iteration 27: 0.8085106382978723
	Train acc at iteration 29: 0.8285256410256411
	Val acc at iteration 28: 0.7659574468085106
	Train acc at iteration 30: 0.8493589743589743
	Val acc at iteration 29: 0.7872340425531915
	Train acc at iteration 31: 0.842948717948718
	Val acc at iteration 30: 0.7872340425531915
	Train acc at iteration 32: 0.8525641025641025
	Val acc at iteration 31: 0.7340425531914894
	Train acc at iteration 33: 0.8317307692307693
	Val acc at iteration 32: 0.7340425531914894
	Train acc at iteration 34: 0.8525641025641025
	Val acc at iteration 33: 0.7978723404255319
	Train acc at iteration 35: 0.8301282051282052
	Val acc at iteration 34: 0.8191489361702128
	Train acc at iteration 36: 0.8477564102564102
	Val acc at iteration 35: 0.7659574468085106
	Train acc at iteration 37: 0.8493589743589743
	Val acc at iteration 36: 0.7872340425531915
	Train acc at iteration 38: 0.8269230769230769
	Val acc at iteration 37: 0.8297872340425532
	Train acc at iteration 39: 0.8205128205128205
	Val acc at iteration 38: 0.8085106382978723
	Train acc at iteration 40: 0.8701923076923077
	Val acc at iteration 39: 0.8191489361702128
	Train acc at iteration 41: 0.8461538461538461
	Val acc at iteration 40: 0.7872340425531915
	Train acc at iteration 42: 0.8189102564102564
	Val acc at iteration 41: 0.8297872340425532
	Train acc at iteration 43: 0.844551282051282
	Val acc at iteration 42: 0.776595744680851
	Train acc at iteration 44: 0.8365384615384616
	Val acc at iteration 43: 0.8085106382978723
	Train acc at iteration 45: 0.8189102564102564
	Val acc at iteration 44: 0.8404255319148937
	Train acc at iteration 46: 0.8269230769230769
	Val acc at iteration 45: 0.7978723404255319
	Train acc at iteration 47: 0.8205128205128205
	Val acc at iteration 46: 0.7978723404255319
	Train acc at iteration 48: 0.8060897435897436
	Val acc at iteration 47: 0.8191489361702128
	Train acc at iteration 49: 0.8509615384615384
	Val acc at iteration 48: 0.7978723404255319
	Train acc at iteration 50: 0.8381410256410257
	Val acc at iteration 49: 0.776595744680851
	Train acc at iteration 51: 0.8525641025641025
	Val acc at iteration 50: 0.8297872340425532
	Train acc at iteration 52: 0.8525641025641025
	Val acc at iteration 51: 0.7872340425531915
	Train acc at iteration 53: 0.8349358974358975
	Val acc at iteration 52: 0.8404255319148937
	Train acc at iteration 54: 0.8221153846153846
	Val acc at iteration 53: 0.7659574468085106
	Train acc at iteration 55: 0.8413461538461539
	Val acc at iteration 54: 0.7659574468085106
	Train acc at iteration 56: 0.844551282051282
	Val acc at iteration 55: 0.851063829787234
	Train acc at iteration 57: 0.8525641025641025
	Val acc at iteration 56: 0.8404255319148937
	Train acc at iteration 58: 0.8253205128205128
	Val acc at iteration 57: 0.8085106382978723
	Train acc at iteration 59: 0.8573717948717948
	Val acc at iteration 58: 0.7659574468085106
	Train acc at iteration 60: 0.875
	Val acc at iteration 59: 0.776595744680851
	Train acc at iteration 61: 0.8557692307692307
	Val acc at iteration 60: 0.8085106382978723
	Train acc at iteration 62: 0.8509615384615384
	Val acc at iteration 61: 0.8085106382978723
	Train acc at iteration 63: 0.8509615384615384
	Val acc at iteration 62: 0.8191489361702128
	Train acc at iteration 64: 0.8397435897435898
	Val acc at iteration 63: 0.7659574468085106
	Train acc at iteration 65: 0.8285256410256411
	Val acc at iteration 64: 0.8297872340425532
	Train acc at iteration 66: 0.8477564102564102
	Val acc at iteration 65: 0.7553191489361702
	Train acc at iteration 67: 0.8477564102564102
	Val acc at iteration 66: 0.7659574468085106
	Train acc at iteration 68: 0.8253205128205128
	Val acc at iteration 67: 0.7553191489361702
	Train acc at iteration 69: 0.8157051282051282
	Val acc at iteration 68: 0.7872340425531915
	Train acc at iteration 70: 0.8301282051282052
	Val acc at iteration 69: 0.7872340425531915
	Train acc at iteration 71: 0.8461538461538461
	Val acc at iteration 70: 0.7659574468085106
	Train acc at iteration 72: 0.8477564102564102
	Val acc at iteration 71: 0.7872340425531915
	Train acc at iteration 73: 0.8253205128205128
	Val acc at iteration 72: 0.7978723404255319
	Train acc at iteration 74: 0.844551282051282
	Val acc at iteration 73: 0.8829787234042553
	Train acc at iteration 75: 0.8461538461538461
	Val acc at iteration 74: 0.8191489361702128
	Train acc at iteration 76: 0.8237179487179487
	Val acc at iteration 75: 0.7553191489361702
	Train acc at iteration 77: 0.8365384615384616
	Val acc at iteration 76: 0.8297872340425532
	Train acc at iteration 78: 0.8493589743589743
	Val acc at iteration 77: 0.776595744680851
	Train acc at iteration 79: 0.8237179487179487
	Val acc at iteration 78: 0.8085106382978723
	Train acc at iteration 80: 0.8477564102564102
	Val acc at iteration 79: 0.8297872340425532
	Train acc at iteration 81: 0.8285256410256411
	Val acc at iteration 80: 0.8191489361702128
	Train acc at iteration 82: 0.8653846153846154
	Val acc at iteration 81: 0.776595744680851
	Train acc at iteration 83: 0.8365384615384616
	Val acc at iteration 82: 0.8191489361702128
	Train acc at iteration 84: 0.8477564102564102
	Val acc at iteration 83: 0.8191489361702128
	Train acc at iteration 85: 0.8381410256410257
	Val acc at iteration 84: 0.776595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6927083333333334
Final val micro accuracy: 0.7978723404255319
Final test macro f1-score: 0.564367816091954
Final test micro accuracy: 0.6808510638297872
Final validation:
	Cluster: 0.6281639337539673
	Separation: 0.539754718542099
Final test:
	Cluster: 0.5907307267189026
	Separation: 0.5361514389514923
Saved Results

Attempting combination 10/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6595744680851063
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7355769230769231
	Train Cluster: 0.6422313809394836
	Train Separation: 0.5235817670822144
(Directly after push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5957446808510638
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.5957446808510638
	Val acc at iteration 8: 0.5851063829787234
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.6170212765957447
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.6170212765957447
	Val acc at iteration 16: 0.6276595744680851
	Val acc at iteration 17: 0.574468085106383
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6170212765957447
	Val acc at iteration 25: 0.6382978723404256
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.5851063829787234
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.6063829787234043
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.648936170212766
	Val acc at iteration 35: 0.6276595744680851
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.6595744680851063
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.574468085106383
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6170212765957447
	Val acc at iteration 50: 0.5957446808510638
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.5638297872340425
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.6170212765957447
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.648936170212766
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.7659574468085106
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.6276595744680851
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.6276595744680851
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.6595744680851063
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.6382978723404256
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 13: 0.6702127659574468
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Train Cluster: 0.6556347489356995
	Train Separation: 0.5209006071090698
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.7659574468085106
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.776595744680851
	Val acc at iteration 17: 0.776595744680851
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.7978723404255319
	Val acc at iteration 25: 0.776595744680851
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.776595744680851
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.7872340425531915
	Val acc at iteration 33: 0.7659574468085106
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.8085106382978723
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.7553191489361702
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.776595744680851
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.7978723404255319
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.776595744680851
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.7872340425531915
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.8085106382978723
	Val acc at iteration 77: 0.7659574468085106
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.7872340425531915
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.7659574468085106
Val acc before epoch 25: 0.7553191489361702
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.8617021276595744
Stopping after epoch 37.
Final validation accuracy before push: 86.17021276595744%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8477564102564102
	Train Cluster: 0.642963993549347
	TrainSeparation: 0.5183682441711426
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.22275641025641027
	Val acc at iteration 0: 0.0
	Train acc at iteration 2: 0.004807692307692308
	Val acc at iteration 1: 0.031914893617021274
	Train acc at iteration 3: 0.017628205128205128
	Val acc at iteration 2: 0.031914893617021274
	Train acc at iteration 4: 0.014423076923076924
	Val acc at iteration 3: 0.02127659574468085
	Train acc at iteration 5: 0.017628205128205128
	Val acc at iteration 4: 0.05319148936170213
	Train acc at iteration 6: 0.016025641025641024
	Val acc at iteration 5: 0.031914893617021274
	Train acc at iteration 7: 0.02403846153846154
	Val acc at iteration 6: 0.031914893617021274
	Train acc at iteration 8: 0.009615384615384616
	Val acc at iteration 7: 0.05319148936170213
	Train acc at iteration 9: 0.038461538461538464
	Val acc at iteration 8: 0.02127659574468085
	Train acc at iteration 10: 0.01282051282051282
	Val acc at iteration 9: 0.05319148936170213
	Train acc at iteration 11: 0.020833333333333332
	Val acc at iteration 10: 0.0425531914893617
	Train acc at iteration 12: 0.028846153846153848
	Val acc at iteration 11: 0.010638297872340425
	Train acc at iteration 13: 0.027243589743589744
	Val acc at iteration 12: 0.07446808510638298
	Train acc at iteration 14: 0.041666666666666664
	Val acc at iteration 13: 0.0851063829787234
	Train acc at iteration 15: 0.060897435897435896
	Val acc at iteration 14: 0.06382978723404255
	Train acc at iteration 16: 0.04487179487179487
	Val acc at iteration 15: 0.05319148936170213
	Train acc at iteration 17: 0.05929487179487179
	Val acc at iteration 16: 0.07446808510638298
	Train acc at iteration 18: 0.07051282051282051
	Val acc at iteration 17: 0.10638297872340426
	Train acc at iteration 19: 0.07852564102564102
	Val acc at iteration 18: 0.07446808510638298
	Train acc at iteration 20: 0.07051282051282051
	Val acc at iteration 19: 0.07446808510638298
	Train acc at iteration 21: 0.07051282051282051
	Val acc at iteration 20: 0.10638297872340426
	Train acc at iteration 22: 0.09935897435897435
	Val acc at iteration 21: 0.1702127659574468
	Train acc at iteration 23: 0.1330128205128205
	Val acc at iteration 22: 0.1276595744680851
	Train acc at iteration 24: 0.13141025641025642
	Val acc at iteration 23: 0.11702127659574468
	Train acc at iteration 25: 0.1266025641025641
	Val acc at iteration 24: 0.2127659574468085
	Train acc at iteration 26: 0.14423076923076922
	Val acc at iteration 25: 0.3191489361702128
	Train acc at iteration 27: 0.20032051282051283
	Val acc at iteration 26: 0.19148936170212766
	Train acc at iteration 28: 0.17147435897435898
	Val acc at iteration 27: 0.22340425531914893
	Train acc at iteration 29: 0.2548076923076923
	Val acc at iteration 28: 0.3404255319148936
	Train acc at iteration 30: 0.296474358974359
	Val acc at iteration 29: 0.32978723404255317
	Train acc at iteration 31: 0.296474358974359
	Val acc at iteration 30: 0.35106382978723405
	Train acc at iteration 32: 0.34935897435897434
	Val acc at iteration 31: 0.3723404255319149
	Train acc at iteration 33: 0.358974358974359
	Val acc at iteration 32: 0.3617021276595745
	Train acc at iteration 34: 0.42628205128205127
	Val acc at iteration 33: 0.40425531914893614
	Train acc at iteration 35: 0.4182692307692308
	Val acc at iteration 34: 0.3829787234042553
	Train acc at iteration 36: 0.42948717948717946
	Val acc at iteration 35: 0.4574468085106383
	Train acc at iteration 37: 0.5016025641025641
	Val acc at iteration 36: 0.46808510638297873
	Train acc at iteration 38: 0.46634615384615385
	Val acc at iteration 37: 0.425531914893617
	Train acc at iteration 39: 0.5592948717948718
	Val acc at iteration 38: 0.46808510638297873
	Train acc at iteration 40: 0.5737179487179487
	Val acc at iteration 39: 0.5106382978723404
	Train acc at iteration 41: 0.5673076923076923
	Val acc at iteration 40: 0.5212765957446809
	Train acc at iteration 42: 0.5448717948717948
	Val acc at iteration 41: 0.44680851063829785
	Train acc at iteration 43: 0.5657051282051282
	Val acc at iteration 42: 0.5212765957446809
	Train acc at iteration 44: 0.6217948717948718
	Val acc at iteration 43: 0.48936170212765956
	Train acc at iteration 45: 0.6185897435897436
	Val acc at iteration 44: 0.5531914893617021
	Train acc at iteration 46: 0.6137820512820513
	Val acc at iteration 45: 0.5
	Train acc at iteration 47: 0.6025641025641025
	Val acc at iteration 46: 0.5531914893617021
	Train acc at iteration 48: 0.6073717948717948
	Val acc at iteration 47: 0.6063829787234043
	Train acc at iteration 49: 0.5769230769230769
	Val acc at iteration 48: 0.43617021276595747
	Train acc at iteration 50: 0.5737179487179487
	Val acc at iteration 49: 0.5106382978723404
	Train acc at iteration 51: 0.5849358974358975
	Val acc at iteration 50: 0.5212765957446809
	Train acc at iteration 52: 0.5817307692307693
	Val acc at iteration 51: 0.40425531914893614
	Train acc at iteration 53: 0.5769230769230769
	Val acc at iteration 52: 0.5106382978723404
	Train acc at iteration 54: 0.5464743589743589
	Val acc at iteration 53: 0.23404255319148937
	Train acc at iteration 55: 0.46153846153846156
	Val acc at iteration 54: 0.44680851063829785
	Train acc at iteration 56: 0.5384615384615384
	Val acc at iteration 55: 0.4787234042553192
	Train acc at iteration 57: 0.5480769230769231
	Val acc at iteration 56: 0.40425531914893614
	Train acc at iteration 58: 0.5048076923076923
	Val acc at iteration 57: 0.46808510638297873
	Train acc at iteration 59: 0.5753205128205128
	Val acc at iteration 58: 0.5425531914893617
	Train acc at iteration 60: 0.4807692307692308
	Val acc at iteration 59: 0.39361702127659576
	Train acc at iteration 61: 0.5240384615384616
	Val acc at iteration 60: 0.574468085106383
	Train acc at iteration 62: 0.5256410256410257
	Val acc at iteration 61: 0.46808510638297873
	Train acc at iteration 63: 0.5608974358974359
	Val acc at iteration 62: 0.5425531914893617
	Train acc at iteration 64: 0.5368589743589743
	Val acc at iteration 63: 0.5957446808510638
	Train acc at iteration 65: 0.5448717948717948
	Val acc at iteration 64: 0.46808510638297873
	Train acc at iteration 66: 0.4935897435897436
	Val acc at iteration 65: 0.5106382978723404
	Train acc at iteration 67: 0.4951923076923077
	Val acc at iteration 66: 0.46808510638297873
	Train acc at iteration 68: 0.5240384615384616
	Val acc at iteration 67: 0.4574468085106383
	Train acc at iteration 69: 0.5384615384615384
	Val acc at iteration 68: 0.2127659574468085
	Train acc at iteration 70: 0.36698717948717946
	Val acc at iteration 69: 0.4574468085106383
	Train acc at iteration 71: 0.5256410256410257
	Val acc at iteration 70: 0.3723404255319149
	Train acc at iteration 72: 0.47275641025641024
	Val acc at iteration 71: 0.26595744680851063
	Train acc at iteration 73: 0.45032051282051283
	Val acc at iteration 72: 0.5319148936170213
	Train acc at iteration 74: 0.5144230769230769
	Val acc at iteration 73: 0.3723404255319149
	Train acc at iteration 75: 0.483974358974359
	Val acc at iteration 74: 0.5957446808510638
	Train acc at iteration 76: 0.5240384615384616
	Val acc at iteration 75: 0.40425531914893614
	Train acc at iteration 77: 0.4935897435897436
	Val acc at iteration 76: 0.4574468085106383
	Train acc at iteration 78: 0.5208333333333334
	Val acc at iteration 77: 0.40425531914893614
	Train acc at iteration 79: 0.483974358974359
	Val acc at iteration 78: 0.43617021276595747
	Train acc at iteration 80: 0.48717948717948717
	Val acc at iteration 79: 0.48936170212765956
	Train acc at iteration 81: 0.46794871794871795
	Val acc at iteration 80: 0.4787234042553192
	Train acc at iteration 82: 0.5336538461538461
	Val acc at iteration 81: 0.43617021276595747
	Train acc at iteration 83: 0.47435897435897434
	Val acc at iteration 82: 0.46808510638297873
	Train acc at iteration 84: 0.5608974358974359
	Val acc at iteration 83: 0.4148936170212766
	Train acc at iteration 85: 0.46153846153846156
	Val acc at iteration 84: 0.3191489361702128
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.3601343101343102
Final val micro accuracy: 0.4148936170212766
Final test macro f1-score: 0.24200120554550936
Final test micro accuracy: 0.30851063829787234
Final validation:
	Cluster: 0.6399147212505341
	Separation: 0.5435234606266022
Final test:
	Cluster: 0.5932461321353912
	Separation: 0.5299021601676941
Saved Results

Attempting combination 11/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7451923076923077
	Train Cluster: 0.6391166687011719
	Train Separation: 0.5202579259872436
(Directly after push) Val acc at iteration 0: 0.5957446808510638
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5425531914893617
	Val acc at iteration 1: 0.5638297872340425
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.648936170212766
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.6170212765957447
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.5851063829787234
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.776595744680851
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.8085106382978723
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6382978723404256
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.7127659574468085
Val acc before epoch 13: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7978723404255319
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8085106382978723
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Train Cluster: 0.6481362223625183
	Train Separation: 0.5214266538619995
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.7553191489361702
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.7127659574468085
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.7872340425531915
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.7978723404255319
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.7553191489361702
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.7553191489361702
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.7978723404255319
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7872340425531915
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.7659574468085106
	Val acc at iteration 37: 0.7446808510638298
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.7872340425531915
	Val acc at iteration 41: 0.8191489361702128
	Val acc at iteration 42: 0.851063829787234
	Val acc at iteration 43: 0.8085106382978723
	Val acc at iteration 44: 0.8085106382978723
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.7872340425531915
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.776595744680851
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.8085106382978723
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.8085106382978723
	Val acc at iteration 55: 0.8085106382978723
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.776595744680851
	Val acc at iteration 58: 0.8297872340425532
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.8297872340425532
	Val acc at iteration 71: 0.8085106382978723
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.7872340425531915
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.8191489361702128
	Val acc at iteration 84: 0.8191489361702128
Val acc before epoch 25: 0.7021276595744681
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9680851063829787
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8141025641025641
	Train Cluster: 0.6486015319824219
	TrainSeparation: 0.5237710118293762
(Directly after push) Val acc at iteration 0: 0.8085106382978723
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.30128205128205127
	Val acc at iteration 0: 0.20212765957446807
	Train acc at iteration 2: 0.09134615384615384
	Val acc at iteration 1: 0.13829787234042554
	Train acc at iteration 3: 0.057692307692307696
	Val acc at iteration 2: 0.06382978723404255
	Train acc at iteration 4: 0.05929487179487179
	Val acc at iteration 3: 0.1276595744680851
	Train acc at iteration 5: 0.05608974358974359
	Val acc at iteration 4: 0.1276595744680851
	Train acc at iteration 6: 0.08173076923076923
	Val acc at iteration 5: 0.1595744680851064
	Train acc at iteration 7: 0.08173076923076923
	Val acc at iteration 6: 0.1276595744680851
	Train acc at iteration 8: 0.10737179487179487
	Val acc at iteration 7: 0.0851063829787234
	Train acc at iteration 9: 0.07532051282051282
	Val acc at iteration 8: 0.22340425531914893
	Train acc at iteration 10: 0.12980769230769232
	Val acc at iteration 9: 0.11702127659574468
	Train acc at iteration 11: 0.10256410256410256
	Val acc at iteration 10: 0.18085106382978725
	Train acc at iteration 12: 0.10416666666666667
	Val acc at iteration 11: 0.1595744680851064
	Train acc at iteration 13: 0.10096153846153846
	Val acc at iteration 12: 0.14893617021276595
	Train acc at iteration 14: 0.1282051282051282
	Val acc at iteration 13: 0.22340425531914893
	Train acc at iteration 15: 0.13782051282051283
	Val acc at iteration 14: 0.18085106382978725
	Train acc at iteration 16: 0.125
	Val acc at iteration 15: 0.1595744680851064
	Train acc at iteration 17: 0.125
	Val acc at iteration 16: 0.2127659574468085
	Train acc at iteration 18: 0.1794871794871795
	Val acc at iteration 17: 0.22340425531914893
	Train acc at iteration 19: 0.12980769230769232
	Val acc at iteration 18: 0.1702127659574468
	Train acc at iteration 20: 0.15865384615384615
	Val acc at iteration 19: 0.10638297872340426
	Train acc at iteration 21: 0.15865384615384615
	Val acc at iteration 20: 0.3191489361702128
	Train acc at iteration 22: 0.20833333333333334
	Val acc at iteration 21: 0.23404255319148937
	Train acc at iteration 23: 0.20032051282051283
	Val acc at iteration 22: 0.2553191489361702
	Train acc at iteration 24: 0.21153846153846154
	Val acc at iteration 23: 0.2553191489361702
	Train acc at iteration 25: 0.2564102564102564
	Val acc at iteration 24: 0.24468085106382978
	Train acc at iteration 26: 0.2516025641025641
	Val acc at iteration 25: 0.3404255319148936
	Train acc at iteration 27: 0.23557692307692307
	Val acc at iteration 26: 0.2553191489361702
	Train acc at iteration 28: 0.27724358974358976
	Val acc at iteration 27: 0.3404255319148936
	Train acc at iteration 29: 0.28685897435897434
	Val acc at iteration 28: 0.3191489361702128
	Train acc at iteration 30: 0.27884615384615385
	Val acc at iteration 29: 0.24468085106382978
	Train acc at iteration 31: 0.30128205128205127
	Val acc at iteration 30: 0.2978723404255319
	Train acc at iteration 32: 0.3125
	Val acc at iteration 31: 0.30851063829787234
	Train acc at iteration 33: 0.34455128205128205
	Val acc at iteration 32: 0.40425531914893614
	Train acc at iteration 34: 0.42467948717948717
	Val acc at iteration 33: 0.32978723404255317
	Train acc at iteration 35: 0.3782051282051282
	Val acc at iteration 34: 0.5319148936170213
	Train acc at iteration 36: 0.40544871794871795
	Val acc at iteration 35: 0.43617021276595747
	Train acc at iteration 37: 0.421474358974359
	Val acc at iteration 36: 0.5212765957446809
	Train acc at iteration 38: 0.49198717948717946
	Val acc at iteration 37: 0.39361702127659576
	Train acc at iteration 39: 0.41185897435897434
	Val acc at iteration 38: 0.3404255319148936
	Train acc at iteration 40: 0.44871794871794873
	Val acc at iteration 39: 0.44680851063829785
	Train acc at iteration 41: 0.49038461538461536
	Val acc at iteration 40: 0.43617021276595747
	Train acc at iteration 42: 0.4855769230769231
	Val acc at iteration 41: 0.39361702127659576
	Train acc at iteration 43: 0.4391025641025641
	Val acc at iteration 42: 0.48936170212765956
	Train acc at iteration 44: 0.47115384615384615
	Val acc at iteration 43: 0.5106382978723404
	Train acc at iteration 45: 0.5496794871794872
	Val acc at iteration 44: 0.43617021276595747
	Train acc at iteration 46: 0.4951923076923077
	Val acc at iteration 45: 0.46808510638297873
	Train acc at iteration 47: 0.5432692307692307
	Val acc at iteration 46: 0.5319148936170213
	Train acc at iteration 48: 0.5673076923076923
	Val acc at iteration 47: 0.39361702127659576
	Train acc at iteration 49: 0.5528846153846154
	Val acc at iteration 48: 0.5425531914893617
	Train acc at iteration 50: 0.5560897435897436
	Val acc at iteration 49: 0.4787234042553192
	Train acc at iteration 51: 0.5801282051282052
	Val acc at iteration 50: 0.5425531914893617
	Train acc at iteration 52: 0.5560897435897436
	Val acc at iteration 51: 0.5851063829787234
	Train acc at iteration 53: 0.5961538461538461
	Val acc at iteration 52: 0.5638297872340425
	Train acc at iteration 54: 0.6282051282051282
	Val acc at iteration 53: 0.648936170212766
	Train acc at iteration 55: 0.6618589743589743
	Val acc at iteration 54: 0.574468085106383
	Train acc at iteration 56: 0.6121794871794872
	Val acc at iteration 55: 0.5425531914893617
	Train acc at iteration 57: 0.5913461538461539
	Val acc at iteration 56: 0.5638297872340425
	Train acc at iteration 58: 0.5881410256410257
	Val acc at iteration 57: 0.6914893617021277
	Train acc at iteration 59: 0.6298076923076923
	Val acc at iteration 58: 0.5531914893617021
	Train acc at iteration 60: 0.6201923076923077
	Val acc at iteration 59: 0.5425531914893617
	Train acc at iteration 61: 0.625
	Val acc at iteration 60: 0.5425531914893617
	Train acc at iteration 62: 0.594551282051282
	Val acc at iteration 61: 0.5531914893617021
	Train acc at iteration 63: 0.6041666666666666
	Val acc at iteration 62: 0.5531914893617021
	Train acc at iteration 64: 0.6185897435897436
	Val acc at iteration 63: 0.5425531914893617
	Train acc at iteration 65: 0.6089743589743589
	Val acc at iteration 64: 0.6702127659574468
	Train acc at iteration 66: 0.6506410256410257
	Val acc at iteration 65: 0.5319148936170213
	Train acc at iteration 67: 0.6474358974358975
	Val acc at iteration 66: 0.5851063829787234
	Train acc at iteration 68: 0.6233974358974359
	Val acc at iteration 67: 0.6702127659574468
	Train acc at iteration 69: 0.6378205128205128
	Val acc at iteration 68: 0.6382978723404256
	Train acc at iteration 70: 0.6987179487179487
	Val acc at iteration 69: 0.574468085106383
	Train acc at iteration 71: 0.6634615384615384
	Val acc at iteration 70: 0.6382978723404256
	Train acc at iteration 72: 0.6682692307692307
	Val acc at iteration 71: 0.6702127659574468
	Train acc at iteration 73: 0.6842948717948718
	Val acc at iteration 72: 0.574468085106383
	Train acc at iteration 74: 0.6698717948717948
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.7083333333333334
	Val acc at iteration 74: 0.6063829787234043
	Train acc at iteration 76: 0.6698717948717948
	Val acc at iteration 75: 0.6063829787234043
	Train acc at iteration 77: 0.6794871794871795
	Val acc at iteration 76: 0.5212765957446809
	Train acc at iteration 78: 0.6762820512820513
	Val acc at iteration 77: 0.6276595744680851
	Train acc at iteration 79: 0.655448717948718
	Val acc at iteration 78: 0.5638297872340425
	Train acc at iteration 80: 0.6522435897435898
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.7035256410256411
	Val acc at iteration 80: 0.6276595744680851
	Train acc at iteration 82: 0.6810897435897436
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.6602564102564102
	Val acc at iteration 82: 0.6914893617021277
	Train acc at iteration 84: 0.6730769230769231
	Val acc at iteration 83: 0.6276595744680851
	Train acc at iteration 85: 0.6907051282051282
	Val acc at iteration 84: 0.6276595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.55578231292517
Final val micro accuracy: 0.6595744680851063
Final test macro f1-score: 0.5471264367816091
Final test micro accuracy: 0.6808510638297872
Final validation:
	Cluster: 0.6159740686416626
	Separation: 0.5423257350921631
Final test:
	Cluster: 0.6207930147647858
	Separation: 0.5479620099067688
Saved Results

Attempting combination 12/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6063829787234043
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7852564102564102
	Train Cluster: 0.651089096069336
	Train Separation: 0.5267086386680603
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.648936170212766
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.6170212765957447
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.6170212765957447
	Val acc at iteration 18: 0.7021276595744681
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.6170212765957447
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6063829787234043
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7446808510638298
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.7127659574468085
Val acc before epoch 13: 0.6702127659574468
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8381410256410257
	Train Cluster: 0.6469209313392639
	Train Separation: 0.5163932561874389
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7553191489361702
	Val acc at iteration 5: 0.776595744680851
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.776595744680851
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.8191489361702128
	Val acc at iteration 13: 0.7553191489361702
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.7446808510638298
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.7872340425531915
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.7978723404255319
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.776595744680851
	Val acc at iteration 24: 0.7978723404255319
	Val acc at iteration 25: 0.7872340425531915
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.7872340425531915
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.7978723404255319
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.7446808510638298
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.7872340425531915
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.7872340425531915
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.776595744680851
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.7659574468085106
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.8085106382978723
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.7659574468085106
	Val acc at iteration 62: 0.7659574468085106
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.7872340425531915
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.8085106382978723
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.7872340425531915
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8621794871794872
	Train Cluster: 0.6500586271286011
	TrainSeparation: 0.5202322602272034
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.05
	Train acc at iteration 1: 0.4182692307692308
	Val acc at iteration 0: 0.2765957446808511
	Train acc at iteration 2: 0.2932692307692308
	Val acc at iteration 1: 0.30851063829787234
	Train acc at iteration 3: 0.1987179487179487
	Val acc at iteration 2: 0.3191489361702128
	Train acc at iteration 4: 0.1971153846153846
	Val acc at iteration 3: 0.3723404255319149
	Train acc at iteration 5: 0.20833333333333334
	Val acc at iteration 4: 0.2872340425531915
	Train acc at iteration 6: 0.16185897435897437
	Val acc at iteration 5: 0.1702127659574468
	Train acc at iteration 7: 0.20192307692307693
	Val acc at iteration 6: 0.23404255319148937
	Train acc at iteration 8: 0.17307692307692307
	Val acc at iteration 7: 0.2978723404255319
	Train acc at iteration 9: 0.1891025641025641
	Val acc at iteration 8: 0.2553191489361702
	Train acc at iteration 10: 0.2467948717948718
	Val acc at iteration 9: 0.2765957446808511
	Train acc at iteration 11: 0.2916666666666667
	Val acc at iteration 10: 0.22340425531914893
	Train acc at iteration 12: 0.21794871794871795
	Val acc at iteration 11: 0.1595744680851064
	Train acc at iteration 13: 0.2692307692307692
	Val acc at iteration 12: 0.2553191489361702
	Train acc at iteration 14: 0.28044871794871795
	Val acc at iteration 13: 0.13829787234042554
	Train acc at iteration 15: 0.25961538461538464
	Val acc at iteration 14: 0.20212765957446807
	Train acc at iteration 16: 0.26282051282051283
	Val acc at iteration 15: 0.30851063829787234
	Train acc at iteration 17: 0.358974358974359
	Val acc at iteration 16: 0.35106382978723405
	Train acc at iteration 18: 0.3125
	Val acc at iteration 17: 0.3723404255319149
	Train acc at iteration 19: 0.35096153846153844
	Val acc at iteration 18: 0.2765957446808511
	Train acc at iteration 20: 0.30288461538461536
	Val acc at iteration 19: 0.23404255319148937
	Train acc at iteration 21: 0.36217948717948717
	Val acc at iteration 20: 0.35106382978723405
	Train acc at iteration 22: 0.36378205128205127
	Val acc at iteration 21: 0.39361702127659576
	Train acc at iteration 23: 0.375
	Val acc at iteration 22: 0.4574468085106383
	Train acc at iteration 24: 0.47115384615384615
	Val acc at iteration 23: 0.3829787234042553
	Train acc at iteration 25: 0.4375
	Val acc at iteration 24: 0.5
	Train acc at iteration 26: 0.4150641025641026
	Val acc at iteration 25: 0.48936170212765956
	Train acc at iteration 27: 0.40224358974358976
	Val acc at iteration 26: 0.4787234042553192
	Train acc at iteration 28: 0.4439102564102564
	Val acc at iteration 27: 0.44680851063829785
	Train acc at iteration 29: 0.4375
	Val acc at iteration 28: 0.425531914893617
	Train acc at iteration 30: 0.4583333333333333
	Val acc at iteration 29: 0.44680851063829785
	Train acc at iteration 31: 0.483974358974359
	Val acc at iteration 30: 0.2765957446808511
	Train acc at iteration 32: 0.44711538461538464
	Val acc at iteration 31: 0.43617021276595747
	Train acc at iteration 33: 0.4439102564102564
	Val acc at iteration 32: 0.5638297872340425
	Train acc at iteration 34: 0.5144230769230769
	Val acc at iteration 33: 0.48936170212765956
	Train acc at iteration 35: 0.49198717948717946
	Val acc at iteration 34: 0.5106382978723404
	Train acc at iteration 36: 0.5112179487179487
	Val acc at iteration 35: 0.5
	Train acc at iteration 37: 0.5272435897435898
	Val acc at iteration 36: 0.46808510638297873
	Train acc at iteration 38: 0.5432692307692307
	Val acc at iteration 37: 0.4787234042553192
	Train acc at iteration 39: 0.532051282051282
	Val acc at iteration 38: 0.5638297872340425
	Train acc at iteration 40: 0.5288461538461539
	Val acc at iteration 39: 0.4574468085106383
	Train acc at iteration 41: 0.5496794871794872
	Val acc at iteration 40: 0.6063829787234043
	Train acc at iteration 42: 0.5160256410256411
	Val acc at iteration 41: 0.5425531914893617
	Train acc at iteration 43: 0.5048076923076923
	Val acc at iteration 42: 0.5
	Train acc at iteration 44: 0.5352564102564102
	Val acc at iteration 43: 0.5
	Train acc at iteration 45: 0.5512820512820513
	Val acc at iteration 44: 0.5531914893617021
	Train acc at iteration 46: 0.5480769230769231
	Val acc at iteration 45: 0.5212765957446809
	Train acc at iteration 47: 0.5625
	Val acc at iteration 46: 0.5319148936170213
	Train acc at iteration 48: 0.5416666666666666
	Val acc at iteration 47: 0.5319148936170213
	Train acc at iteration 49: 0.5801282051282052
	Val acc at iteration 48: 0.6063829787234043
	Train acc at iteration 50: 0.5833333333333334
	Val acc at iteration 49: 0.5851063829787234
	Train acc at iteration 51: 0.5961538461538461
	Val acc at iteration 50: 0.6276595744680851
	Train acc at iteration 52: 0.6298076923076923
	Val acc at iteration 51: 0.5212765957446809
	Train acc at iteration 53: 0.6378205128205128
	Val acc at iteration 52: 0.5851063829787234
	Train acc at iteration 54: 0.6185897435897436
	Val acc at iteration 53: 0.6276595744680851
	Train acc at iteration 55: 0.5961538461538461
	Val acc at iteration 54: 0.5851063829787234
	Train acc at iteration 56: 0.6474358974358975
	Val acc at iteration 55: 0.574468085106383
	Train acc at iteration 57: 0.6266025641025641
	Val acc at iteration 56: 0.5851063829787234
	Train acc at iteration 58: 0.6185897435897436
	Val acc at iteration 57: 0.6276595744680851
	Train acc at iteration 59: 0.6346153846153846
	Val acc at iteration 58: 0.6276595744680851
	Train acc at iteration 60: 0.657051282051282
	Val acc at iteration 59: 0.5425531914893617
	Train acc at iteration 61: 0.6266025641025641
	Val acc at iteration 60: 0.5531914893617021
	Train acc at iteration 62: 0.655448717948718
	Val acc at iteration 61: 0.6702127659574468
	Train acc at iteration 63: 0.6586538461538461
	Val acc at iteration 62: 0.5212765957446809
	Train acc at iteration 64: 0.6634615384615384
	Val acc at iteration 63: 0.6170212765957447
	Train acc at iteration 65: 0.6009615384615384
	Val acc at iteration 64: 0.6063829787234043
	Train acc at iteration 66: 0.6233974358974359
	Val acc at iteration 65: 0.5638297872340425
	Train acc at iteration 67: 0.6426282051282052
	Val acc at iteration 66: 0.6382978723404256
	Train acc at iteration 68: 0.6858974358974359
	Val acc at iteration 67: 0.5851063829787234
	Train acc at iteration 69: 0.6875
	Val acc at iteration 68: 0.6382978723404256
	Train acc at iteration 70: 0.6842948717948718
	Val acc at iteration 69: 0.723404255319149
	Train acc at iteration 71: 0.6618589743589743
	Val acc at iteration 70: 0.6382978723404256
	Train acc at iteration 72: 0.6891025641025641
	Val acc at iteration 71: 0.6382978723404256
	Train acc at iteration 73: 0.6650641025641025
	Val acc at iteration 72: 0.6063829787234043
	Train acc at iteration 74: 0.655448717948718
	Val acc at iteration 73: 0.6170212765957447
	Train acc at iteration 75: 0.7147435897435898
	Val acc at iteration 74: 0.6595744680851063
	Train acc at iteration 76: 0.6522435897435898
	Val acc at iteration 75: 0.6914893617021277
	Train acc at iteration 77: 0.6971153846153846
	Val acc at iteration 76: 0.6276595744680851
	Train acc at iteration 78: 0.6826923076923077
	Val acc at iteration 77: 0.6702127659574468
	Train acc at iteration 79: 0.6762820512820513
	Val acc at iteration 78: 0.6382978723404256
	Train acc at iteration 80: 0.6682692307692307
	Val acc at iteration 79: 0.6595744680851063
	Train acc at iteration 81: 0.6778846153846154
	Val acc at iteration 80: 0.5531914893617021
	Train acc at iteration 82: 0.6778846153846154
	Val acc at iteration 81: 0.574468085106383
	Train acc at iteration 83: 0.6955128205128205
	Val acc at iteration 82: 0.6702127659574468
	Train acc at iteration 84: 0.6458333333333334
	Val acc at iteration 83: 0.7659574468085106
	Train acc at iteration 85: 0.6875
	Val acc at iteration 84: 0.5851063829787234
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.49965986394557815
Final val micro accuracy: 0.6063829787234043
Final test macro f1-score: 0.5040249433106576
Final test micro accuracy: 0.6170212765957447
Final validation:
	Cluster: 0.6262628734111786
	Separation: 0.543133944272995
Final test:
	Cluster: 0.6022355854511261
	Separation: 0.5423060357570648
Saved Results

Attempting combination 13/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.01
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.031914893617021274
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Train Cluster: 0.6478928089141845
	Train Separation: 0.5201785087585449
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5212765957446809
	Val acc at iteration 1: 0.574468085106383
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6276595744680851
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.5638297872340425
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.574468085106383
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.6276595744680851
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.6063829787234043
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.648936170212766
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.574468085106383
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.6808510638297872
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.6382978723404256
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.6382978723404256
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.6808510638297872
Val acc before epoch 13: 0.6914893617021277
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Train Cluster: 0.6478537678718567
	Train Separation: 0.5211447358131409
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7659574468085106
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.6276595744680851
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7872340425531915
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.776595744680851
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.7872340425531915
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.8297872340425532
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.7872340425531915
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.7872340425531915
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.7872340425531915
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.8191489361702128
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.7978723404255319
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 25: 0.7872340425531915
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8085106382978723
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.8723404255319149
Stopping after epoch 37.
Final validation accuracy before push: 87.2340425531915%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8317307692307693
	Train Cluster: 0.6596945405006409
	TrainSeparation: 0.5224218130111694
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.01
	Train acc at iteration 1: 0.7403846153846154
	Val acc at iteration 0: 0.648936170212766
	Train acc at iteration 2: 0.6602564102564102
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.655448717948718
	Val acc at iteration 2: 0.6276595744680851
	Train acc at iteration 4: 0.6602564102564102
	Val acc at iteration 3: 0.5851063829787234
	Train acc at iteration 5: 0.6442307692307693
	Val acc at iteration 4: 0.6063829787234043
	Train acc at iteration 6: 0.6490384615384616
	Val acc at iteration 5: 0.5851063829787234
	Train acc at iteration 7: 0.6506410256410257
	Val acc at iteration 6: 0.6276595744680851
	Train acc at iteration 8: 0.6298076923076923
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.6266025641025641
	Val acc at iteration 8: 0.7127659574468085
	Train acc at iteration 10: 0.6201923076923077
	Val acc at iteration 9: 0.5957446808510638
	Train acc at iteration 11: 0.6025641025641025
	Val acc at iteration 10: 0.6170212765957447
	Train acc at iteration 12: 0.6266025641025641
	Val acc at iteration 11: 0.6595744680851063
	Train acc at iteration 13: 0.657051282051282
	Val acc at iteration 12: 0.5425531914893617
	Train acc at iteration 14: 0.6618589743589743
	Val acc at iteration 13: 0.5425531914893617
	Train acc at iteration 15: 0.6105769230769231
	Val acc at iteration 14: 0.5851063829787234
	Train acc at iteration 16: 0.6698717948717948
	Val acc at iteration 15: 0.648936170212766
	Train acc at iteration 17: 0.6105769230769231
	Val acc at iteration 16: 0.4787234042553192
	Train acc at iteration 18: 0.6634615384615384
	Val acc at iteration 17: 0.574468085106383
	Train acc at iteration 19: 0.5977564102564102
	Val acc at iteration 18: 0.5212765957446809
	Train acc at iteration 20: 0.5849358974358975
	Val acc at iteration 19: 0.5851063829787234
	Train acc at iteration 21: 0.6490384615384616
	Val acc at iteration 20: 0.6595744680851063
	Train acc at iteration 22: 0.6378205128205128
	Val acc at iteration 21: 0.48936170212765956
	Train acc at iteration 23: 0.6458333333333334
	Val acc at iteration 22: 0.6276595744680851
	Train acc at iteration 24: 0.6201923076923077
	Val acc at iteration 23: 0.5851063829787234
	Train acc at iteration 25: 0.6298076923076923
	Val acc at iteration 24: 0.6276595744680851
	Train acc at iteration 26: 0.6025641025641025
	Val acc at iteration 25: 0.5851063829787234
	Train acc at iteration 27: 0.6025641025641025
	Val acc at iteration 26: 0.5425531914893617
	Train acc at iteration 28: 0.6506410256410257
	Val acc at iteration 27: 0.6382978723404256
	Train acc at iteration 29: 0.6426282051282052
	Val acc at iteration 28: 0.574468085106383
	Train acc at iteration 30: 0.6586538461538461
	Val acc at iteration 29: 0.4574468085106383
	Train acc at iteration 31: 0.5993589743589743
	Val acc at iteration 30: 0.5425531914893617
	Train acc at iteration 32: 0.6282051282051282
	Val acc at iteration 31: 0.5851063829787234
	Train acc at iteration 33: 0.5881410256410257
	Val acc at iteration 32: 0.5638297872340425
	Train acc at iteration 34: 0.6458333333333334
	Val acc at iteration 33: 0.6170212765957447
	Train acc at iteration 35: 0.6233974358974359
	Val acc at iteration 34: 0.5319148936170213
	Train acc at iteration 36: 0.6634615384615384
	Val acc at iteration 35: 0.574468085106383
	Train acc at iteration 37: 0.6378205128205128
	Val acc at iteration 36: 0.5957446808510638
	Train acc at iteration 38: 0.6650641025641025
	Val acc at iteration 37: 0.6170212765957447
	Train acc at iteration 39: 0.6201923076923077
	Val acc at iteration 38: 0.574468085106383
	Train acc at iteration 40: 0.6394230769230769
	Val acc at iteration 39: 0.48936170212765956
	Train acc at iteration 41: 0.6939102564102564
	Val acc at iteration 40: 0.6914893617021277
	Train acc at iteration 42: 0.6634615384615384
	Val acc at iteration 41: 0.574468085106383
	Train acc at iteration 43: 0.6041666666666666
	Val acc at iteration 42: 0.5851063829787234
	Train acc at iteration 44: 0.6842948717948718
	Val acc at iteration 43: 0.6170212765957447
	Train acc at iteration 45: 0.6730769230769231
	Val acc at iteration 44: 0.6702127659574468
	Train acc at iteration 46: 0.6522435897435898
	Val acc at iteration 45: 0.5638297872340425
	Train acc at iteration 47: 0.7003205128205128
	Val acc at iteration 46: 0.5851063829787234
	Train acc at iteration 48: 0.6778846153846154
	Val acc at iteration 47: 0.5425531914893617
	Train acc at iteration 49: 0.6474358974358975
	Val acc at iteration 48: 0.6595744680851063
	Train acc at iteration 50: 0.6362179487179487
	Val acc at iteration 49: 0.6063829787234043
	Train acc at iteration 51: 0.6875
	Val acc at iteration 50: 0.5638297872340425
	Train acc at iteration 52: 0.6858974358974359
	Val acc at iteration 51: 0.5957446808510638
	Train acc at iteration 53: 0.6586538461538461
	Val acc at iteration 52: 0.5957446808510638
	Train acc at iteration 54: 0.6810897435897436
	Val acc at iteration 53: 0.6914893617021277
	Train acc at iteration 55: 0.7019230769230769
	Val acc at iteration 54: 0.5531914893617021
	Train acc at iteration 56: 0.6810897435897436
	Val acc at iteration 55: 0.6170212765957447
	Train acc at iteration 57: 0.7067307692307693
	Val acc at iteration 56: 0.5957446808510638
	Train acc at iteration 58: 0.7083333333333334
	Val acc at iteration 57: 0.6914893617021277
	Train acc at iteration 59: 0.6762820512820513
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.6858974358974359
	Val acc at iteration 59: 0.5957446808510638
	Train acc at iteration 61: 0.6858974358974359
	Val acc at iteration 60: 0.5319148936170213
	Train acc at iteration 62: 0.7211538461538461
	Val acc at iteration 61: 0.6276595744680851
	Train acc at iteration 63: 0.7019230769230769
	Val acc at iteration 62: 0.5638297872340425
	Train acc at iteration 64: 0.7147435897435898
	Val acc at iteration 63: 0.5957446808510638
	Train acc at iteration 65: 0.7051282051282052
	Val acc at iteration 64: 0.6170212765957447
	Train acc at iteration 66: 0.7243589743589743
	Val acc at iteration 65: 0.6170212765957447
	Train acc at iteration 67: 0.6907051282051282
	Val acc at iteration 66: 0.5638297872340425
	Train acc at iteration 68: 0.7275641025641025
	Val acc at iteration 67: 0.6595744680851063
	Train acc at iteration 69: 0.7051282051282052
	Val acc at iteration 68: 0.5319148936170213
	Train acc at iteration 70: 0.6714743589743589
	Val acc at iteration 69: 0.648936170212766
	Train acc at iteration 71: 0.7099358974358975
	Val acc at iteration 70: 0.574468085106383
	Train acc at iteration 72: 0.7147435897435898
	Val acc at iteration 71: 0.574468085106383
	Train acc at iteration 73: 0.7115384615384616
	Val acc at iteration 72: 0.6170212765957447
	Train acc at iteration 74: 0.6666666666666666
	Val acc at iteration 73: 0.5851063829787234
	Train acc at iteration 75: 0.7387820512820513
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.6891025641025641
	Val acc at iteration 75: 0.5851063829787234
	Train acc at iteration 77: 0.7115384615384616
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.7371794871794872
	Val acc at iteration 77: 0.6063829787234043
	Train acc at iteration 79: 0.7115384615384616
	Val acc at iteration 78: 0.6808510638297872
	Train acc at iteration 80: 0.7211538461538461
	Val acc at iteration 79: 0.5638297872340425
	Train acc at iteration 81: 0.6971153846153846
	Val acc at iteration 80: 0.5851063829787234
	Train acc at iteration 82: 0.6955128205128205
	Val acc at iteration 81: 0.7446808510638298
	Train acc at iteration 83: 0.717948717948718
	Val acc at iteration 82: 0.6063829787234043
	Train acc at iteration 84: 0.7275641025641025
	Val acc at iteration 83: 0.5957446808510638
	Train acc at iteration 85: 0.7067307692307693
	Val acc at iteration 84: 0.6595744680851063
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.4920962199312714
Final val micro accuracy: 0.5957446808510638
Final test macro f1-score: 0.4300366300366301
Final test micro accuracy: 0.5638297872340425
Final validation:
	Cluster: 0.6028580665588379
	Separation: 0.5401951968669891
Final test:
	Cluster: 0.5940582454204559
	Separation: 0.5394907593727112
Saved Results

Attempting combination 14/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5319148936170213
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8617021276595744
Push epoch
After push, before retraining last layer:
	Train acc: 0.7740384615384616
	Train Cluster: 0.6410310983657836
	Train Separation: 0.5146589159965516
(Directly after push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.574468085106383
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6063829787234043
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.7553191489361702
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.6063829787234043
	Val acc at iteration 30: 0.6170212765957447
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.574468085106383
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.574468085106383
	Val acc at iteration 42: 0.6595744680851063
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6382978723404256
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.6595744680851063
	Val acc at iteration 67: 0.7872340425531915
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.7446808510638298
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7932692307692307
	Train Cluster: 0.6476741194725036
	Train Separation: 0.5199295043945312
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7659574468085106
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.7978723404255319
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.7553191489361702
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.7446808510638298
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.7553191489361702
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.776595744680851
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.776595744680851
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.7340425531914894
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.7553191489361702
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.7978723404255319
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.7659574468085106
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.6808510638297872
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.723404255319149
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 25: 0.8085106382978723
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.6568050622940064
	TrainSeparation: 0.5187753558158874
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: 0.005
	Train acc at iteration 1: 0.780448717948718
	Val acc at iteration 0: 0.7446808510638298
	Train acc at iteration 2: 0.7788461538461539
	Val acc at iteration 1: 0.6382978723404256
	Train acc at iteration 3: 0.7516025641025641
	Val acc at iteration 2: 0.7127659574468085
	Train acc at iteration 4: 0.7612179487179487
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.7628205128205128
	Val acc at iteration 4: 0.6808510638297872
	Train acc at iteration 6: 0.7596153846153846
	Val acc at iteration 5: 0.6382978723404256
	Train acc at iteration 7: 0.7419871794871795
	Val acc at iteration 6: 0.7127659574468085
	Train acc at iteration 8: 0.7788461538461539
	Val acc at iteration 7: 0.723404255319149
	Train acc at iteration 9: 0.7964743589743589
	Val acc at iteration 8: 0.6595744680851063
	Train acc at iteration 10: 0.7387820512820513
	Val acc at iteration 9: 0.7340425531914894
	Train acc at iteration 11: 0.7548076923076923
	Val acc at iteration 10: 0.5851063829787234
	Train acc at iteration 12: 0.7788461538461539
	Val acc at iteration 11: 0.723404255319149
	Train acc at iteration 13: 0.7708333333333334
	Val acc at iteration 12: 0.7340425531914894
	Train acc at iteration 14: 0.7644230769230769
	Val acc at iteration 13: 0.648936170212766
	Train acc at iteration 15: 0.782051282051282
	Val acc at iteration 14: 0.6595744680851063
	Train acc at iteration 16: 0.7916666666666666
	Val acc at iteration 15: 0.6595744680851063
	Train acc at iteration 17: 0.7596153846153846
	Val acc at iteration 16: 0.776595744680851
	Train acc at iteration 18: 0.782051282051282
	Val acc at iteration 17: 0.7021276595744681
	Train acc at iteration 19: 0.7644230769230769
	Val acc at iteration 18: 0.7127659574468085
	Train acc at iteration 20: 0.7708333333333334
	Val acc at iteration 19: 0.6595744680851063
	Train acc at iteration 21: 0.7772435897435898
	Val acc at iteration 20: 0.6382978723404256
	Train acc at iteration 22: 0.7740384615384616
	Val acc at iteration 21: 0.7127659574468085
	Train acc at iteration 23: 0.7532051282051282
	Val acc at iteration 22: 0.7127659574468085
	Train acc at iteration 24: 0.7868589743589743
	Val acc at iteration 23: 0.7127659574468085
	Train acc at iteration 25: 0.7788461538461539
	Val acc at iteration 24: 0.648936170212766
	Train acc at iteration 26: 0.8044871794871795
	Val acc at iteration 25: 0.6595744680851063
	Train acc at iteration 27: 0.7548076923076923
	Val acc at iteration 26: 0.7446808510638298
	Train acc at iteration 28: 0.7628205128205128
	Val acc at iteration 27: 0.648936170212766
	Train acc at iteration 29: 0.7660256410256411
	Val acc at iteration 28: 0.6702127659574468
	Train acc at iteration 30: 0.7916666666666666
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.7900641025641025
	Val acc at iteration 30: 0.6808510638297872
	Train acc at iteration 32: 0.7612179487179487
	Val acc at iteration 31: 0.7340425531914894
	Train acc at iteration 33: 0.7628205128205128
	Val acc at iteration 32: 0.723404255319149
	Train acc at iteration 34: 0.7483974358974359
	Val acc at iteration 33: 0.5851063829787234
	Train acc at iteration 35: 0.7612179487179487
	Val acc at iteration 34: 0.7021276595744681
	Train acc at iteration 36: 0.7451923076923077
	Val acc at iteration 35: 0.574468085106383
	Train acc at iteration 37: 0.7323717948717948
	Val acc at iteration 36: 0.6170212765957447
	Train acc at iteration 38: 0.782051282051282
	Val acc at iteration 37: 0.6914893617021277
	Train acc at iteration 39: 0.7435897435897436
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.7724358974358975
	Val acc at iteration 39: 0.6382978723404256
	Train acc at iteration 41: 0.7596153846153846
	Val acc at iteration 40: 0.648936170212766
	Train acc at iteration 42: 0.7275641025641025
	Val acc at iteration 41: 0.6595744680851063
	Train acc at iteration 43: 0.7708333333333334
	Val acc at iteration 42: 0.7340425531914894
	Train acc at iteration 44: 0.7419871794871795
	Val acc at iteration 43: 0.648936170212766
	Train acc at iteration 45: 0.7387820512820513
	Val acc at iteration 44: 0.5957446808510638
	Train acc at iteration 46: 0.7371794871794872
	Val acc at iteration 45: 0.648936170212766
	Train acc at iteration 47: 0.6891025641025641
	Val acc at iteration 46: 0.5851063829787234
	Train acc at iteration 48: 0.719551282051282
	Val acc at iteration 47: 0.5531914893617021
	Train acc at iteration 49: 0.7211538461538461
	Val acc at iteration 48: 0.6914893617021277
	Train acc at iteration 50: 0.7131410256410257
	Val acc at iteration 49: 0.5957446808510638
	Train acc at iteration 51: 0.7259615384615384
	Val acc at iteration 50: 0.6276595744680851
	Train acc at iteration 52: 0.7243589743589743
	Val acc at iteration 51: 0.6063829787234043
	Train acc at iteration 53: 0.7051282051282052
	Val acc at iteration 52: 0.5212765957446809
	Train acc at iteration 54: 0.7644230769230769
	Val acc at iteration 53: 0.6595744680851063
	Train acc at iteration 55: 0.7339743589743589
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.7115384615384616
	Val acc at iteration 55: 0.6914893617021277
	Train acc at iteration 57: 0.7307692307692307
	Val acc at iteration 56: 0.5851063829787234
	Train acc at iteration 58: 0.7099358974358975
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.7019230769230769
	Val acc at iteration 58: 0.5851063829787234
	Train acc at iteration 60: 0.7019230769230769
	Val acc at iteration 59: 0.5531914893617021
	Train acc at iteration 61: 0.7403846153846154
	Val acc at iteration 60: 0.6808510638297872
	Train acc at iteration 62: 0.7259615384615384
	Val acc at iteration 61: 0.6914893617021277
	Train acc at iteration 63: 0.7596153846153846
	Val acc at iteration 62: 0.6063829787234043
	Train acc at iteration 64: 0.7035256410256411
	Val acc at iteration 63: 0.6702127659574468
	Train acc at iteration 65: 0.6939102564102564
	Val acc at iteration 64: 0.6063829787234043
	Train acc at iteration 66: 0.7227564102564102
	Val acc at iteration 65: 0.5638297872340425
	Train acc at iteration 67: 0.7243589743589743
	Val acc at iteration 66: 0.6276595744680851
	Train acc at iteration 68: 0.7259615384615384
	Val acc at iteration 67: 0.6063829787234043
	Train acc at iteration 69: 0.7211538461538461
	Val acc at iteration 68: 0.6382978723404256
	Train acc at iteration 70: 0.7339743589743589
	Val acc at iteration 69: 0.574468085106383
	Train acc at iteration 71: 0.717948717948718
	Val acc at iteration 70: 0.6170212765957447
	Train acc at iteration 72: 0.6778846153846154
	Val acc at iteration 71: 0.6170212765957447
	Train acc at iteration 73: 0.7211538461538461
	Val acc at iteration 72: 0.6170212765957447
	Train acc at iteration 74: 0.7275641025641025
	Val acc at iteration 73: 0.6170212765957447
	Train acc at iteration 75: 0.7532051282051282
	Val acc at iteration 74: 0.5851063829787234
	Train acc at iteration 76: 0.7099358974358975
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.7051282051282052
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.7339743589743589
	Val acc at iteration 77: 0.648936170212766
	Train acc at iteration 79: 0.6858974358974359
	Val acc at iteration 78: 0.7127659574468085
	Train acc at iteration 80: 0.717948717948718
	Val acc at iteration 79: 0.6808510638297872
	Train acc at iteration 81: 0.7243589743589743
	Val acc at iteration 80: 0.5638297872340425
	Train acc at iteration 82: 0.719551282051282
	Val acc at iteration 81: 0.574468085106383
	Train acc at iteration 83: 0.7051282051282052
	Val acc at iteration 82: 0.6276595744680851
	Train acc at iteration 84: 0.7307692307692307
	Val acc at iteration 83: 0.6276595744680851
	Train acc at iteration 85: 0.7387820512820513
	Val acc at iteration 84: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.535
Final val micro accuracy: 0.6595744680851063
Final test macro f1-score: 0.5136363636363637
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6246966123580933
	Separation: 0.5334743559360504
Final test:
	Cluster: 0.585650235414505
	Separation: 0.539511114358902
Saved Results

Attempting combination 15/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.46808510638297873
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Train Cluster: 0.6457848906517029
	Train Separation: 0.519512677192688
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5531914893617021
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.5957446808510638
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.5957446808510638
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.5851063829787234
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.5851063829787234
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.6170212765957447
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.5957446808510638
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.6063829787234043
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.7553191489361702
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.7872340425531915
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.8191489361702128
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.7978723404255319
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.7553191489361702
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9680851063829787
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8092948717948718
	Train Cluster: 0.6405133724212646
	Train Separation: 0.5178738951683044
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.7553191489361702
	Val acc at iteration 9: 0.7553191489361702
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.7872340425531915
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.7021276595744681
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.8085106382978723
	Val acc at iteration 22: 0.7872340425531915
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.8085106382978723
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7872340425531915
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.7659574468085106
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.7978723404255319
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.7872340425531915
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.7872340425531915
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.776595744680851
	Val acc at iteration 51: 0.8085106382978723
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.776595744680851
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.7978723404255319
	Val acc at iteration 56: 0.851063829787234
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.8191489361702128
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.7872340425531915
	Val acc at iteration 64: 0.7872340425531915
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.8085106382978723
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.8297872340425532
	Val acc at iteration 78: 0.8191489361702128
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.7659574468085106
Val acc before epoch 25: 0.7021276595744681
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8541666666666666
	Train Cluster: 0.6450447678565979
	TrainSeparation: 0.5149606227874756
(Directly after push) Val acc at iteration 0: 0.8085106382978723
Retraining last layer
Last layer lr: 0.001
	Train acc at iteration 1: 0.8108974358974359
	Val acc at iteration 0: 0.7659574468085106
	Train acc at iteration 2: 0.8397435897435898
	Val acc at iteration 1: 0.7659574468085106
	Train acc at iteration 3: 0.8237179487179487
	Val acc at iteration 2: 0.7340425531914894
	Train acc at iteration 4: 0.8173076923076923
	Val acc at iteration 3: 0.7978723404255319
	Train acc at iteration 5: 0.8269230769230769
	Val acc at iteration 4: 0.7340425531914894
	Train acc at iteration 6: 0.8141025641025641
	Val acc at iteration 5: 0.7340425531914894
	Train acc at iteration 7: 0.8253205128205128
	Val acc at iteration 6: 0.723404255319149
	Train acc at iteration 8: 0.8493589743589743
	Val acc at iteration 7: 0.7872340425531915
	Train acc at iteration 9: 0.8333333333333334
	Val acc at iteration 8: 0.723404255319149
	Train acc at iteration 10: 0.8189102564102564
	Val acc at iteration 9: 0.7872340425531915
	Train acc at iteration 11: 0.8205128205128205
	Val acc at iteration 10: 0.723404255319149
	Train acc at iteration 12: 0.8092948717948718
	Val acc at iteration 11: 0.776595744680851
	Train acc at iteration 13: 0.842948717948718
	Val acc at iteration 12: 0.8617021276595744
	Train acc at iteration 14: 0.8349358974358975
	Val acc at iteration 13: 0.7978723404255319
	Train acc at iteration 15: 0.8157051282051282
	Val acc at iteration 14: 0.8085106382978723
	Train acc at iteration 16: 0.8173076923076923
	Val acc at iteration 15: 0.8617021276595744
	Train acc at iteration 17: 0.8285256410256411
	Val acc at iteration 16: 0.7659574468085106
	Train acc at iteration 18: 0.8044871794871795
	Val acc at iteration 17: 0.8404255319148937
	Train acc at iteration 19: 0.8253205128205128
	Val acc at iteration 18: 0.7659574468085106
	Train acc at iteration 20: 0.8301282051282052
	Val acc at iteration 19: 0.7872340425531915
	Train acc at iteration 21: 0.8269230769230769
	Val acc at iteration 20: 0.7127659574468085
	Train acc at iteration 22: 0.8076923076923077
	Val acc at iteration 21: 0.7446808510638298
	Train acc at iteration 23: 0.7948717948717948
	Val acc at iteration 22: 0.7340425531914894
	Train acc at iteration 24: 0.8493589743589743
	Val acc at iteration 23: 0.776595744680851
	Train acc at iteration 25: 0.8205128205128205
	Val acc at iteration 24: 0.7127659574468085
	Train acc at iteration 26: 0.8125
	Val acc at iteration 25: 0.7340425531914894
	Train acc at iteration 27: 0.7964743589743589
	Val acc at iteration 26: 0.8085106382978723
	Train acc at iteration 28: 0.8028846153846154
	Val acc at iteration 27: 0.776595744680851
	Train acc at iteration 29: 0.8157051282051282
	Val acc at iteration 28: 0.8723404255319149
	Train acc at iteration 30: 0.8221153846153846
	Val acc at iteration 29: 0.776595744680851
	Train acc at iteration 31: 0.8205128205128205
	Val acc at iteration 30: 0.7127659574468085
	Train acc at iteration 32: 0.8157051282051282
	Val acc at iteration 31: 0.776595744680851
	Train acc at iteration 33: 0.8461538461538461
	Val acc at iteration 32: 0.7659574468085106
	Train acc at iteration 34: 0.8157051282051282
	Val acc at iteration 33: 0.7446808510638298
	Train acc at iteration 35: 0.8301282051282052
	Val acc at iteration 34: 0.8297872340425532
	Train acc at iteration 36: 0.8221153846153846
	Val acc at iteration 35: 0.7446808510638298
	Train acc at iteration 37: 0.8157051282051282
	Val acc at iteration 36: 0.7446808510638298
	Train acc at iteration 38: 0.8205128205128205
	Val acc at iteration 37: 0.7127659574468085
	Train acc at iteration 39: 0.8189102564102564
	Val acc at iteration 38: 0.723404255319149
	Train acc at iteration 40: 0.8012820512820513
	Val acc at iteration 39: 0.776595744680851
	Train acc at iteration 41: 0.8413461538461539
	Val acc at iteration 40: 0.723404255319149
	Train acc at iteration 42: 0.8060897435897436
	Val acc at iteration 41: 0.8297872340425532
	Train acc at iteration 43: 0.8269230769230769
	Val acc at iteration 42: 0.7340425531914894
	Train acc at iteration 44: 0.8173076923076923
	Val acc at iteration 43: 0.7659574468085106
	Train acc at iteration 45: 0.8141025641025641
	Val acc at iteration 44: 0.776595744680851
	Train acc at iteration 46: 0.8397435897435898
	Val acc at iteration 45: 0.8191489361702128
	Train acc at iteration 47: 0.8125
	Val acc at iteration 46: 0.7446808510638298
	Train acc at iteration 48: 0.8365384615384616
	Val acc at iteration 47: 0.7021276595744681
	Train acc at iteration 49: 0.8301282051282052
	Val acc at iteration 48: 0.776595744680851
	Train acc at iteration 50: 0.7916666666666666
	Val acc at iteration 49: 0.7872340425531915
	Train acc at iteration 51: 0.8349358974358975
	Val acc at iteration 50: 0.7872340425531915
	Train acc at iteration 52: 0.8092948717948718
	Val acc at iteration 51: 0.7553191489361702
	Train acc at iteration 53: 0.8381410256410257
	Val acc at iteration 52: 0.7872340425531915
	Train acc at iteration 54: 0.8173076923076923
	Val acc at iteration 53: 0.7978723404255319
	Train acc at iteration 55: 0.8349358974358975
	Val acc at iteration 54: 0.776595744680851
	Train acc at iteration 56: 0.8157051282051282
	Val acc at iteration 55: 0.8297872340425532
	Train acc at iteration 57: 0.7996794871794872
	Val acc at iteration 56: 0.7659574468085106
	Train acc at iteration 58: 0.8205128205128205
	Val acc at iteration 57: 0.7978723404255319
	Train acc at iteration 59: 0.8141025641025641
	Val acc at iteration 58: 0.8085106382978723
	Train acc at iteration 60: 0.8092948717948718
	Val acc at iteration 59: 0.776595744680851
	Train acc at iteration 61: 0.8349358974358975
	Val acc at iteration 60: 0.8191489361702128
	Train acc at iteration 62: 0.844551282051282
	Val acc at iteration 61: 0.8085106382978723
	Train acc at iteration 63: 0.8092948717948718
	Val acc at iteration 62: 0.8404255319148937
	Train acc at iteration 64: 0.8461538461538461
	Val acc at iteration 63: 0.723404255319149
	Train acc at iteration 65: 0.8157051282051282
	Val acc at iteration 64: 0.776595744680851
	Train acc at iteration 66: 0.8173076923076923
	Val acc at iteration 65: 0.7659574468085106
	Train acc at iteration 67: 0.8237179487179487
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.8301282051282052
	Val acc at iteration 67: 0.8191489361702128
	Train acc at iteration 69: 0.842948717948718
	Val acc at iteration 68: 0.7872340425531915
	Train acc at iteration 70: 0.8285256410256411
	Val acc at iteration 69: 0.8297872340425532
	Train acc at iteration 71: 0.8333333333333334
	Val acc at iteration 70: 0.7978723404255319
	Train acc at iteration 72: 0.8108974358974359
	Val acc at iteration 71: 0.776595744680851
	Train acc at iteration 73: 0.8141025641025641
	Val acc at iteration 72: 0.851063829787234
	Train acc at iteration 74: 0.8621794871794872
	Val acc at iteration 73: 0.7978723404255319
	Train acc at iteration 75: 0.8125
	Val acc at iteration 74: 0.8297872340425532
	Train acc at iteration 76: 0.8509615384615384
	Val acc at iteration 75: 0.7659574468085106
	Train acc at iteration 77: 0.8285256410256411
	Val acc at iteration 76: 0.851063829787234
	Train acc at iteration 78: 0.8253205128205128
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.842948717948718
	Val acc at iteration 78: 0.8085106382978723
	Train acc at iteration 80: 0.8477564102564102
	Val acc at iteration 79: 0.8085106382978723
	Train acc at iteration 81: 0.8573717948717948
	Val acc at iteration 80: 0.7553191489361702
	Train acc at iteration 82: 0.8092948717948718
	Val acc at iteration 81: 0.8404255319148937
	Train acc at iteration 83: 0.8317307692307693
	Val acc at iteration 82: 0.776595744680851
	Train acc at iteration 84: 0.8509615384615384
	Val acc at iteration 83: 0.7659574468085106
	Train acc at iteration 85: 0.8349358974358975
	Val acc at iteration 84: 0.8085106382978723
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7535460992907801
Final val micro accuracy: 0.8297872340425532
Final test macro f1-score: 0.5596899224806201
Final test micro accuracy: 0.6808510638297872
Final validation:
	Cluster: 0.6212410926818848
	Separation: 0.5401611030101776
Final test:
	Cluster: 0.5938414633274078
	Separation: 0.5459294021129608
Saved Results

Attempting combination 16/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5957446808510638
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7612179487179487
	Train Cluster: 0.6397374272346497
	Train Separation: 0.5187106013298035
(Directly after push) Val acc at iteration 0: 0.5425531914893617
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.6170212765957447
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.6063829787234043
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.5957446808510638
	Val acc at iteration 13: 0.7659574468085106
	Val acc at iteration 14: 0.6170212765957447
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.5425531914893617
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.6170212765957447
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6063829787234043
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.6063829787234043
	Val acc at iteration 26: 0.6595744680851063
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6382978723404256
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.6808510638297872
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6170212765957447
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.6063829787234043
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7978723404255319
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.6382978723404256
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.6170212765957447
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.7127659574468085
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Train Cluster: 0.6434356570243835
	Train Separation: 0.5238319039344788
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.776595744680851
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.7446808510638298
	Val acc at iteration 5: 0.7127659574468085
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.7553191489361702
	Val acc at iteration 8: 0.7659574468085106
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6063829787234043
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.7659574468085106
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.7978723404255319
	Val acc at iteration 19: 0.776595744680851
	Val acc at iteration 20: 0.7872340425531915
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.7872340425531915
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.776595744680851
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.7978723404255319
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.7659574468085106
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.8297872340425532
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.8297872340425532
	Val acc at iteration 78: 0.7872340425531915
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.8191489361702128
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 25: 0.7340425531914894
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9042553191489362
Stopping after epoch 37.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Train Cluster: 0.6482674241065979
	TrainSeparation: 0.5230336785316467
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.0005
	Train acc at iteration 1: 0.8205128205128205
	Val acc at iteration 0: 0.7553191489361702
	Train acc at iteration 2: 0.8157051282051282
	Val acc at iteration 1: 0.723404255319149
	Train acc at iteration 3: 0.8060897435897436
	Val acc at iteration 2: 0.776595744680851
	Train acc at iteration 4: 0.8253205128205128
	Val acc at iteration 3: 0.7340425531914894
	Train acc at iteration 5: 0.8301282051282052
	Val acc at iteration 4: 0.7553191489361702
	Train acc at iteration 6: 0.8189102564102564
	Val acc at iteration 5: 0.7553191489361702
	Train acc at iteration 7: 0.7980769230769231
	Val acc at iteration 6: 0.7446808510638298
	Train acc at iteration 8: 0.8060897435897436
	Val acc at iteration 7: 0.8191489361702128
	Train acc at iteration 9: 0.8253205128205128
	Val acc at iteration 8: 0.8297872340425532
	Train acc at iteration 10: 0.8076923076923077
	Val acc at iteration 9: 0.7659574468085106
	Train acc at iteration 11: 0.8381410256410257
	Val acc at iteration 10: 0.7446808510638298
	Train acc at iteration 12: 0.8173076923076923
	Val acc at iteration 11: 0.723404255319149
	Train acc at iteration 13: 0.8108974358974359
	Val acc at iteration 12: 0.7553191489361702
	Train acc at iteration 14: 0.8157051282051282
	Val acc at iteration 13: 0.8191489361702128
	Train acc at iteration 15: 0.8157051282051282
	Val acc at iteration 14: 0.7553191489361702
	Train acc at iteration 16: 0.8108974358974359
	Val acc at iteration 15: 0.7872340425531915
	Train acc at iteration 17: 0.8108974358974359
	Val acc at iteration 16: 0.7872340425531915
	Train acc at iteration 18: 0.8028846153846154
	Val acc at iteration 17: 0.8085106382978723
	Train acc at iteration 19: 0.7964743589743589
	Val acc at iteration 18: 0.7446808510638298
	Train acc at iteration 20: 0.8060897435897436
	Val acc at iteration 19: 0.7659574468085106
	Train acc at iteration 21: 0.8237179487179487
	Val acc at iteration 20: 0.7659574468085106
	Train acc at iteration 22: 0.8076923076923077
	Val acc at iteration 21: 0.776595744680851
	Train acc at iteration 23: 0.8189102564102564
	Val acc at iteration 22: 0.7553191489361702
	Train acc at iteration 24: 0.8141025641025641
	Val acc at iteration 23: 0.776595744680851
	Train acc at iteration 25: 0.8108974358974359
	Val acc at iteration 24: 0.7340425531914894
	Train acc at iteration 26: 0.8125
	Val acc at iteration 25: 0.7553191489361702
	Train acc at iteration 27: 0.8092948717948718
	Val acc at iteration 26: 0.776595744680851
	Train acc at iteration 28: 0.8141025641025641
	Val acc at iteration 27: 0.7872340425531915
	Train acc at iteration 29: 0.8621794871794872
	Val acc at iteration 28: 0.7872340425531915
	Train acc at iteration 30: 0.8092948717948718
	Val acc at iteration 29: 0.7553191489361702
	Train acc at iteration 31: 0.8173076923076923
	Val acc at iteration 30: 0.723404255319149
	Train acc at iteration 32: 0.7980769230769231
	Val acc at iteration 31: 0.7872340425531915
	Train acc at iteration 33: 0.8012820512820513
	Val acc at iteration 32: 0.7127659574468085
	Train acc at iteration 34: 0.8285256410256411
	Val acc at iteration 33: 0.776595744680851
	Train acc at iteration 35: 0.8012820512820513
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.8108974358974359
	Val acc at iteration 35: 0.7659574468085106
	Train acc at iteration 37: 0.8237179487179487
	Val acc at iteration 36: 0.7978723404255319
	Train acc at iteration 38: 0.8237179487179487
	Val acc at iteration 37: 0.7021276595744681
	Train acc at iteration 39: 0.8125
	Val acc at iteration 38: 0.7872340425531915
	Train acc at iteration 40: 0.8125
	Val acc at iteration 39: 0.8191489361702128
	Train acc at iteration 41: 0.8173076923076923
	Val acc at iteration 40: 0.7872340425531915
	Train acc at iteration 42: 0.8141025641025641
	Val acc at iteration 41: 0.8404255319148937
	Train acc at iteration 43: 0.8285256410256411
	Val acc at iteration 42: 0.723404255319149
	Train acc at iteration 44: 0.7980769230769231
	Val acc at iteration 43: 0.7978723404255319
	Train acc at iteration 45: 0.8397435897435898
	Val acc at iteration 44: 0.7659574468085106
	Train acc at iteration 46: 0.8285256410256411
	Val acc at iteration 45: 0.7978723404255319
	Train acc at iteration 47: 0.7868589743589743
	Val acc at iteration 46: 0.8404255319148937
	Train acc at iteration 48: 0.8205128205128205
	Val acc at iteration 47: 0.8297872340425532
	Train acc at iteration 49: 0.8397435897435898
	Val acc at iteration 48: 0.723404255319149
	Train acc at iteration 50: 0.8028846153846154
	Val acc at iteration 49: 0.8085106382978723
	Train acc at iteration 51: 0.8205128205128205
	Val acc at iteration 50: 0.776595744680851
	Train acc at iteration 52: 0.8365384615384616
	Val acc at iteration 51: 0.7659574468085106
	Train acc at iteration 53: 0.7980769230769231
	Val acc at iteration 52: 0.8404255319148937
	Train acc at iteration 54: 0.8269230769230769
	Val acc at iteration 53: 0.7446808510638298
	Train acc at iteration 55: 0.8012820512820513
	Val acc at iteration 54: 0.7659574468085106
	Train acc at iteration 56: 0.8333333333333334
	Val acc at iteration 55: 0.723404255319149
	Train acc at iteration 57: 0.8253205128205128
	Val acc at iteration 56: 0.8191489361702128
	Train acc at iteration 58: 0.8092948717948718
	Val acc at iteration 57: 0.7659574468085106
	Train acc at iteration 59: 0.8189102564102564
	Val acc at iteration 58: 0.7872340425531915
	Train acc at iteration 60: 0.8125
	Val acc at iteration 59: 0.723404255319149
	Train acc at iteration 61: 0.8253205128205128
	Val acc at iteration 60: 0.7872340425531915
	Train acc at iteration 62: 0.8092948717948718
	Val acc at iteration 61: 0.7553191489361702
	Train acc at iteration 63: 0.8060897435897436
	Val acc at iteration 62: 0.7872340425531915
	Train acc at iteration 64: 0.8285256410256411
	Val acc at iteration 63: 0.8085106382978723
	Train acc at iteration 65: 0.8605769230769231
	Val acc at iteration 64: 0.7659574468085106
	Train acc at iteration 66: 0.8253205128205128
	Val acc at iteration 65: 0.7446808510638298
	Train acc at iteration 67: 0.8141025641025641
	Val acc at iteration 66: 0.8191489361702128
	Train acc at iteration 68: 0.8173076923076923
	Val acc at iteration 67: 0.8191489361702128
	Train acc at iteration 69: 0.8493589743589743
	Val acc at iteration 68: 0.8297872340425532
	Train acc at iteration 70: 0.8125
	Val acc at iteration 69: 0.7872340425531915
	Train acc at iteration 71: 0.8044871794871795
	Val acc at iteration 70: 0.5957446808510638
	Train acc at iteration 72: 0.7932692307692307
	Val acc at iteration 71: 0.723404255319149
	Train acc at iteration 73: 0.8157051282051282
	Val acc at iteration 72: 0.7446808510638298
	Train acc at iteration 74: 0.8317307692307693
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.8269230769230769
	Val acc at iteration 74: 0.7659574468085106
	Train acc at iteration 76: 0.8060897435897436
	Val acc at iteration 75: 0.8297872340425532
	Train acc at iteration 77: 0.8189102564102564
	Val acc at iteration 76: 0.7978723404255319
	Train acc at iteration 78: 0.8285256410256411
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.8125
	Val acc at iteration 78: 0.776595744680851
	Train acc at iteration 80: 0.8317307692307693
	Val acc at iteration 79: 0.7659574468085106
	Train acc at iteration 81: 0.8060897435897436
	Val acc at iteration 80: 0.723404255319149
	Train acc at iteration 82: 0.8125
	Val acc at iteration 81: 0.7553191489361702
	Train acc at iteration 83: 0.8108974358974359
	Val acc at iteration 82: 0.7659574468085106
	Train acc at iteration 84: 0.8269230769230769
	Val acc at iteration 83: 0.7553191489361702
	Train acc at iteration 85: 0.8253205128205128
	Val acc at iteration 84: 0.7446808510638298
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7245614035087721
Final val micro accuracy: 0.8085106382978723
Final test macro f1-score: 0.5307407407407407
Final test micro accuracy: 0.6808510638297872
Final validation:
	Cluster: 0.6174269914627075
	Separation: 0.5491116046905518
Final test:
	Cluster: 0.6024906039237976
	Separation: 0.5386401116847992
Saved Results

Attempting combination 17/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7772435897435898
	Train Cluster: 0.6429859399795532
	Train Separation: 0.5185294270515441
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5425531914893617
	Val acc at iteration 1: 0.6914893617021277
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.5851063829787234
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.7553191489361702
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.6063829787234043
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6382978723404256
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.6170212765957447
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.7553191489361702
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.7553191489361702
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.776595744680851
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.6808510638297872
Val acc before epoch 13: 0.7659574468085106
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7446808510638298
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.8108974358974359
	Train Cluster: 0.6572766065597534
	Train Separation: 0.5250877857208252
(Directly after push) Val acc at iteration 0: 0.8085106382978723
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.7872340425531915
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7446808510638298
	Val acc at iteration 5: 0.776595744680851
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.776595744680851
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.7659574468085106
	Val acc at iteration 15: 0.7446808510638298
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.7021276595744681
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.776595744680851
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.776595744680851
	Val acc at iteration 30: 0.7872340425531915
	Val acc at iteration 31: 0.7978723404255319
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.851063829787234
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.8085106382978723
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.7553191489361702
	Val acc at iteration 40: 0.7553191489361702
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.8191489361702128
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.8085106382978723
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.8297872340425532
	Val acc at iteration 51: 0.7872340425531915
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7872340425531915
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.776595744680851
	Val acc at iteration 58: 0.8191489361702128
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.8297872340425532
	Val acc at iteration 63: 0.776595744680851
	Val acc at iteration 64: 0.7872340425531915
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.8191489361702128
	Val acc at iteration 71: 0.8085106382978723
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.7872340425531915
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.8191489361702128
	Val acc at iteration 84: 0.7978723404255319
Val acc before epoch 25: 0.7127659574468085
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8397435897435898
	Train Cluster: 0.6445641279220581
	TrainSeparation: 0.5169715046882629
(Directly after push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer
Last layer lr: 0.0001
	Train acc at iteration 1: 0.8092948717948718
	Val acc at iteration 0: 0.7872340425531915
	Train acc at iteration 2: 0.8349358974358975
	Val acc at iteration 1: 0.7872340425531915
	Train acc at iteration 3: 0.8173076923076923
	Val acc at iteration 2: 0.8404255319148937
	Train acc at iteration 4: 0.8076923076923077
	Val acc at iteration 3: 0.7659574468085106
	Train acc at iteration 5: 0.8125
	Val acc at iteration 4: 0.723404255319149
	Train acc at iteration 6: 0.8221153846153846
	Val acc at iteration 5: 0.7553191489361702
	Train acc at iteration 7: 0.842948717948718
	Val acc at iteration 6: 0.8191489361702128
	Train acc at iteration 8: 0.8189102564102564
	Val acc at iteration 7: 0.8297872340425532
	Train acc at iteration 9: 0.8092948717948718
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8541666666666666
	Val acc at iteration 9: 0.7340425531914894
	Train acc at iteration 11: 0.8349358974358975
	Val acc at iteration 10: 0.7446808510638298
	Train acc at iteration 12: 0.8076923076923077
	Val acc at iteration 11: 0.7553191489361702
	Train acc at iteration 13: 0.8221153846153846
	Val acc at iteration 12: 0.7872340425531915
	Train acc at iteration 14: 0.8173076923076923
	Val acc at iteration 13: 0.7659574468085106
	Train acc at iteration 15: 0.8557692307692307
	Val acc at iteration 14: 0.7872340425531915
	Train acc at iteration 16: 0.8108974358974359
	Val acc at iteration 15: 0.8404255319148937
	Train acc at iteration 17: 0.8205128205128205
	Val acc at iteration 16: 0.7659574468085106
	Train acc at iteration 18: 0.8108974358974359
	Val acc at iteration 17: 0.7446808510638298
	Train acc at iteration 19: 0.8221153846153846
	Val acc at iteration 18: 0.7553191489361702
	Train acc at iteration 20: 0.8237179487179487
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.8253205128205128
	Val acc at iteration 20: 0.7978723404255319
	Train acc at iteration 22: 0.8237179487179487
	Val acc at iteration 21: 0.8191489361702128
	Train acc at iteration 23: 0.8205128205128205
	Val acc at iteration 22: 0.8191489361702128
	Train acc at iteration 24: 0.8397435897435898
	Val acc at iteration 23: 0.8085106382978723
	Train acc at iteration 25: 0.8317307692307693
	Val acc at iteration 24: 0.8085106382978723
	Train acc at iteration 26: 0.8108974358974359
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.8477564102564102
	Val acc at iteration 26: 0.723404255319149
	Train acc at iteration 28: 0.8365384615384616
	Val acc at iteration 27: 0.7553191489361702
	Train acc at iteration 29: 0.8365384615384616
	Val acc at iteration 28: 0.7659574468085106
	Train acc at iteration 30: 0.7996794871794872
	Val acc at iteration 29: 0.8191489361702128
	Train acc at iteration 31: 0.8333333333333334
	Val acc at iteration 30: 0.776595744680851
	Train acc at iteration 32: 0.8381410256410257
	Val acc at iteration 31: 0.8297872340425532
	Train acc at iteration 33: 0.8461538461538461
	Val acc at iteration 32: 0.7872340425531915
	Train acc at iteration 34: 0.8221153846153846
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.8060897435897436
	Val acc at iteration 34: 0.7659574468085106
	Train acc at iteration 36: 0.8237179487179487
	Val acc at iteration 35: 0.776595744680851
	Train acc at iteration 37: 0.8012820512820513
	Val acc at iteration 36: 0.776595744680851
	Train acc at iteration 38: 0.8397435897435898
	Val acc at iteration 37: 0.7872340425531915
	Train acc at iteration 39: 0.8285256410256411
	Val acc at iteration 38: 0.7446808510638298
	Train acc at iteration 40: 0.8269230769230769
	Val acc at iteration 39: 0.7659574468085106
	Train acc at iteration 41: 0.8237179487179487
	Val acc at iteration 40: 0.776595744680851
	Train acc at iteration 42: 0.8525641025641025
	Val acc at iteration 41: 0.7659574468085106
	Train acc at iteration 43: 0.8269230769230769
	Val acc at iteration 42: 0.7659574468085106
	Train acc at iteration 44: 0.8141025641025641
	Val acc at iteration 43: 0.7446808510638298
	Train acc at iteration 45: 0.8525641025641025
	Val acc at iteration 44: 0.723404255319149
	Train acc at iteration 46: 0.844551282051282
	Val acc at iteration 45: 0.7872340425531915
	Train acc at iteration 47: 0.8397435897435898
	Val acc at iteration 46: 0.8191489361702128
	Train acc at iteration 48: 0.842948717948718
	Val acc at iteration 47: 0.8297872340425532
	Train acc at iteration 49: 0.8317307692307693
	Val acc at iteration 48: 0.7553191489361702
	Train acc at iteration 50: 0.8349358974358975
	Val acc at iteration 49: 0.7872340425531915
	Train acc at iteration 51: 0.8397435897435898
	Val acc at iteration 50: 0.7659574468085106
	Train acc at iteration 52: 0.8125
	Val acc at iteration 51: 0.7340425531914894
	Train acc at iteration 53: 0.8413461538461539
	Val acc at iteration 52: 0.776595744680851
	Train acc at iteration 54: 0.8477564102564102
	Val acc at iteration 53: 0.7446808510638298
	Train acc at iteration 55: 0.842948717948718
	Val acc at iteration 54: 0.8085106382978723
	Train acc at iteration 56: 0.8413461538461539
	Val acc at iteration 55: 0.8297872340425532
	Train acc at iteration 57: 0.7964743589743589
	Val acc at iteration 56: 0.7553191489361702
	Train acc at iteration 58: 0.8285256410256411
	Val acc at iteration 57: 0.7978723404255319
	Train acc at iteration 59: 0.8269230769230769
	Val acc at iteration 58: 0.8297872340425532
	Train acc at iteration 60: 0.8461538461538461
	Val acc at iteration 59: 0.7659574468085106
	Train acc at iteration 61: 0.8461538461538461
	Val acc at iteration 60: 0.776595744680851
	Train acc at iteration 62: 0.8253205128205128
	Val acc at iteration 61: 0.8191489361702128
	Train acc at iteration 63: 0.8413461538461539
	Val acc at iteration 62: 0.8297872340425532
	Train acc at iteration 64: 0.8253205128205128
	Val acc at iteration 63: 0.7446808510638298
	Train acc at iteration 65: 0.8333333333333334
	Val acc at iteration 64: 0.7446808510638298
	Train acc at iteration 66: 0.8141025641025641
	Val acc at iteration 65: 0.7872340425531915
	Train acc at iteration 67: 0.8477564102564102
	Val acc at iteration 66: 0.7446808510638298
	Train acc at iteration 68: 0.8413461538461539
	Val acc at iteration 67: 0.7659574468085106
	Train acc at iteration 69: 0.844551282051282
	Val acc at iteration 68: 0.7553191489361702
	Train acc at iteration 70: 0.8237179487179487
	Val acc at iteration 69: 0.7978723404255319
	Train acc at iteration 71: 0.8189102564102564
	Val acc at iteration 70: 0.7553191489361702
	Train acc at iteration 72: 0.8173076923076923
	Val acc at iteration 71: 0.7872340425531915
	Train acc at iteration 73: 0.8285256410256411
	Val acc at iteration 72: 0.7978723404255319
	Train acc at iteration 74: 0.8509615384615384
	Val acc at iteration 73: 0.8085106382978723
	Train acc at iteration 75: 0.8349358974358975
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.8333333333333334
	Val acc at iteration 75: 0.8085106382978723
	Train acc at iteration 77: 0.8157051282051282
	Val acc at iteration 76: 0.7872340425531915
	Train acc at iteration 78: 0.8397435897435898
	Val acc at iteration 77: 0.8297872340425532
	Train acc at iteration 79: 0.8157051282051282
	Val acc at iteration 78: 0.7978723404255319
	Train acc at iteration 80: 0.844551282051282
	Val acc at iteration 79: 0.7872340425531915
	Train acc at iteration 81: 0.8381410256410257
	Val acc at iteration 80: 0.8404255319148937
	Train acc at iteration 82: 0.8108974358974359
	Val acc at iteration 81: 0.7659574468085106
	Train acc at iteration 83: 0.8285256410256411
	Val acc at iteration 82: 0.7659574468085106
	Train acc at iteration 84: 0.8285256410256411
	Val acc at iteration 83: 0.7446808510638298
	Train acc at iteration 85: 0.8028846153846154
	Val acc at iteration 84: 0.776595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7677902621722846
Final val micro accuracy: 0.8191489361702128
Final test macro f1-score: 0.6164658634538153
Final test micro accuracy: 0.723404255319149
Final validation:
	Cluster: 0.6146495938301086
	Separation: 0.5414900183677673
Final test:
	Cluster: 0.6108032464981079
	Separation: 0.5329471528530121
Saved Results

Attempting combination 18/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 5e-05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.46808510638297873
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5957446808510638
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7580128205128205
	Train Cluster: 0.644586718082428
	Train Separation: 0.5224831342697144
(Directly after push) Val acc at iteration 0: 0.5638297872340425
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.425531914893617
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.5957446808510638
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.5957446808510638
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6276595744680851
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.6595744680851063
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.6276595744680851
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.7340425531914894
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.8191489361702128
	Val acc at iteration 84: 0.6702127659574468
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9680851063829787
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8269230769230769
	Train Cluster: 0.6547782778739929
	Train Separation: 0.5233565926551819
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7872340425531915
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.776595744680851
	Val acc at iteration 7: 0.7553191489361702
	Val acc at iteration 8: 0.7340425531914894
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.8085106382978723
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7659574468085106
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.776595744680851
	Val acc at iteration 23: 0.8085106382978723
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.7872340425531915
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.8085106382978723
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7659574468085106
	Val acc at iteration 34: 0.7978723404255319
	Val acc at iteration 35: 0.7978723404255319
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.7872340425531915
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.8085106382978723
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7978723404255319
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.7659574468085106
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.8297872340425532
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.7659574468085106
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.7659574468085106
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.8191489361702128
	Val acc at iteration 62: 0.7659574468085106
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.5957446808510638
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.7872340425531915
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.7872340425531915
	Val acc at iteration 75: 0.776595744680851
	Val acc at iteration 76: 0.7872340425531915
	Val acc at iteration 77: 0.7659574468085106
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.776595744680851
	Val acc at iteration 81: 0.7978723404255319
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.7872340425531915
Val acc before epoch 25: 0.7872340425531915
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8365384615384616
	Train Cluster: 0.6528113484382629
	TrainSeparation: 0.5214633464813232
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 5e-05
	Train acc at iteration 1: 0.8285256410256411
	Val acc at iteration 0: 0.7340425531914894
	Train acc at iteration 2: 0.8173076923076923
	Val acc at iteration 1: 0.7872340425531915
	Train acc at iteration 3: 0.844551282051282
	Val acc at iteration 2: 0.7659574468085106
	Train acc at iteration 4: 0.8205128205128205
	Val acc at iteration 3: 0.6914893617021277
	Train acc at iteration 5: 0.8541666666666666
	Val acc at iteration 4: 0.7446808510638298
	Train acc at iteration 6: 0.8060897435897436
	Val acc at iteration 5: 0.7446808510638298
	Train acc at iteration 7: 0.8365384615384616
	Val acc at iteration 6: 0.7553191489361702
	Train acc at iteration 8: 0.8317307692307693
	Val acc at iteration 7: 0.7340425531914894
	Train acc at iteration 9: 0.8189102564102564
	Val acc at iteration 8: 0.7978723404255319
	Train acc at iteration 10: 0.8413461538461539
	Val acc at iteration 9: 0.6914893617021277
	Train acc at iteration 11: 0.8269230769230769
	Val acc at iteration 10: 0.7659574468085106
	Train acc at iteration 12: 0.8381410256410257
	Val acc at iteration 11: 0.7872340425531915
	Train acc at iteration 13: 0.842948717948718
	Val acc at iteration 12: 0.723404255319149
	Train acc at iteration 14: 0.8269230769230769
	Val acc at iteration 13: 0.723404255319149
	Train acc at iteration 15: 0.8397435897435898
	Val acc at iteration 14: 0.7553191489361702
	Train acc at iteration 16: 0.8253205128205128
	Val acc at iteration 15: 0.7659574468085106
	Train acc at iteration 17: 0.8269230769230769
	Val acc at iteration 16: 0.723404255319149
	Train acc at iteration 18: 0.8333333333333334
	Val acc at iteration 17: 0.7872340425531915
	Train acc at iteration 19: 0.842948717948718
	Val acc at iteration 18: 0.7340425531914894
	Train acc at iteration 20: 0.8509615384615384
	Val acc at iteration 19: 0.7978723404255319
	Train acc at iteration 21: 0.8092948717948718
	Val acc at iteration 20: 0.7978723404255319
	Train acc at iteration 22: 0.8381410256410257
	Val acc at iteration 21: 0.776595744680851
	Train acc at iteration 23: 0.8317307692307693
	Val acc at iteration 22: 0.8191489361702128
	Train acc at iteration 24: 0.8365384615384616
	Val acc at iteration 23: 0.8085106382978723
	Train acc at iteration 25: 0.8205128205128205
	Val acc at iteration 24: 0.6702127659574468
	Train acc at iteration 26: 0.8253205128205128
	Val acc at iteration 25: 0.723404255319149
	Train acc at iteration 27: 0.8301282051282052
	Val acc at iteration 26: 0.723404255319149
	Train acc at iteration 28: 0.8092948717948718
	Val acc at iteration 27: 0.776595744680851
	Train acc at iteration 29: 0.8317307692307693
	Val acc at iteration 28: 0.7659574468085106
	Train acc at iteration 30: 0.8285256410256411
	Val acc at iteration 29: 0.7446808510638298
	Train acc at iteration 31: 0.8221153846153846
	Val acc at iteration 30: 0.723404255319149
	Train acc at iteration 32: 0.8028846153846154
	Val acc at iteration 31: 0.7446808510638298
	Train acc at iteration 33: 0.842948717948718
	Val acc at iteration 32: 0.7340425531914894
	Train acc at iteration 34: 0.8237179487179487
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.8028846153846154
	Val acc at iteration 34: 0.7659574468085106
	Train acc at iteration 36: 0.844551282051282
	Val acc at iteration 35: 0.7978723404255319
	Train acc at iteration 37: 0.8461538461538461
	Val acc at iteration 36: 0.7872340425531915
	Train acc at iteration 38: 0.8317307692307693
	Val acc at iteration 37: 0.7553191489361702
	Train acc at iteration 39: 0.8477564102564102
	Val acc at iteration 38: 0.6914893617021277
	Train acc at iteration 40: 0.8028846153846154
	Val acc at iteration 39: 0.7446808510638298
	Train acc at iteration 41: 0.8221153846153846
	Val acc at iteration 40: 0.723404255319149
	Train acc at iteration 42: 0.8189102564102564
	Val acc at iteration 41: 0.7340425531914894
	Train acc at iteration 43: 0.8365384615384616
	Val acc at iteration 42: 0.7659574468085106
	Train acc at iteration 44: 0.8269230769230769
	Val acc at iteration 43: 0.7872340425531915
	Train acc at iteration 45: 0.8461538461538461
	Val acc at iteration 44: 0.7127659574468085
	Train acc at iteration 46: 0.8365384615384616
	Val acc at iteration 45: 0.7659574468085106
	Train acc at iteration 47: 0.8397435897435898
	Val acc at iteration 46: 0.7978723404255319
	Train acc at iteration 48: 0.842948717948718
	Val acc at iteration 47: 0.7872340425531915
	Train acc at iteration 49: 0.8333333333333334
	Val acc at iteration 48: 0.7340425531914894
	Train acc at iteration 50: 0.8573717948717948
	Val acc at iteration 49: 0.7872340425531915
	Train acc at iteration 51: 0.8333333333333334
	Val acc at iteration 50: 0.7978723404255319
	Train acc at iteration 52: 0.8397435897435898
	Val acc at iteration 51: 0.723404255319149
	Train acc at iteration 53: 0.8189102564102564
	Val acc at iteration 52: 0.7872340425531915
	Train acc at iteration 54: 0.8285256410256411
	Val acc at iteration 53: 0.7127659574468085
	Train acc at iteration 55: 0.8461538461538461
	Val acc at iteration 54: 0.7446808510638298
	Train acc at iteration 56: 0.8317307692307693
	Val acc at iteration 55: 0.7553191489361702
	Train acc at iteration 57: 0.8076923076923077
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.8397435897435898
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.8461538461538461
	Val acc at iteration 58: 0.7340425531914894
	Train acc at iteration 60: 0.8285256410256411
	Val acc at iteration 59: 0.6595744680851063
	Train acc at iteration 61: 0.8381410256410257
	Val acc at iteration 60: 0.7659574468085106
	Train acc at iteration 62: 0.8557692307692307
	Val acc at iteration 61: 0.7021276595744681
	Train acc at iteration 63: 0.8044871794871795
	Val acc at iteration 62: 0.7021276595744681
	Train acc at iteration 64: 0.8269230769230769
	Val acc at iteration 63: 0.8085106382978723
	Train acc at iteration 65: 0.8253205128205128
	Val acc at iteration 64: 0.7553191489361702
	Train acc at iteration 66: 0.8221153846153846
	Val acc at iteration 65: 0.7659574468085106
	Train acc at iteration 67: 0.8285256410256411
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.8269230769230769
	Val acc at iteration 67: 0.776595744680851
	Train acc at iteration 69: 0.844551282051282
	Val acc at iteration 68: 0.7021276595744681
	Train acc at iteration 70: 0.8477564102564102
	Val acc at iteration 69: 0.7872340425531915
	Train acc at iteration 71: 0.8092948717948718
	Val acc at iteration 70: 0.723404255319149
	Train acc at iteration 72: 0.8653846153846154
	Val acc at iteration 71: 0.7659574468085106
	Train acc at iteration 73: 0.8365384615384616
	Val acc at iteration 72: 0.7659574468085106
	Train acc at iteration 74: 0.8125
	Val acc at iteration 73: 0.7978723404255319
	Train acc at iteration 75: 0.8381410256410257
	Val acc at iteration 74: 0.776595744680851
	Train acc at iteration 76: 0.8108974358974359
	Val acc at iteration 75: 0.6914893617021277
	Train acc at iteration 77: 0.8157051282051282
	Val acc at iteration 76: 0.7553191489361702
	Train acc at iteration 78: 0.8221153846153846
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.8221153846153846
	Val acc at iteration 78: 0.7553191489361702
	Train acc at iteration 80: 0.8285256410256411
	Val acc at iteration 79: 0.8085106382978723
	Train acc at iteration 81: 0.8076923076923077
	Val acc at iteration 80: 0.723404255319149
	Train acc at iteration 82: 0.8477564102564102
	Val acc at iteration 81: 0.7978723404255319
	Train acc at iteration 83: 0.8076923076923077
	Val acc at iteration 82: 0.7446808510638298
	Train acc at iteration 84: 0.8397435897435898
	Val acc at iteration 83: 0.7978723404255319
	Train acc at iteration 85: 0.8076923076923077
	Val acc at iteration 84: 0.7127659574468085
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6040404040404039
Final val micro accuracy: 0.7127659574468085
Final test macro f1-score: 0.5123595505617977
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6219699084758759
	Separation: 0.5369934439659119
Final test:
	Cluster: 0.6027786731719971
	Separation: 0.5397053956985474
Saved Results

Attempting combination 19/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7676282051282052
	Train Cluster: 0.6471740007400513
	Train Separation: 0.521546733379364
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.5957446808510638
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.5957446808510638
	Val acc at iteration 7: 0.574468085106383
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.7446808510638298
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6170212765957447
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6063829787234043
	Val acc at iteration 46: 0.6808510638297872
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.776595744680851
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.7659574468085106
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.5957446808510638
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.6382978723404256
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.7446808510638298
Val acc before epoch 13: 0.6702127659574468
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7978723404255319
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Train Cluster: 0.6429860472679139
	Train Separation: 0.5207259178161621
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7446808510638298
	Val acc at iteration 12: 0.776595744680851
	Val acc at iteration 13: 0.7553191489361702
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.7553191489361702
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7978723404255319
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.8085106382978723
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.776595744680851
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7872340425531915
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.776595744680851
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.7978723404255319
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 25: 0.7446808510638298
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Train Cluster: 0.6470086693763732
	TrainSeparation: 0.5159581661224365
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.17307692307692307
	Val acc at iteration 0: 0.010638297872340425
	Train acc at iteration 2: 0.004807692307692308
	Val acc at iteration 1: 0.010638297872340425
	Train acc at iteration 3: 0.00641025641025641
	Val acc at iteration 2: 0.02127659574468085
	Train acc at iteration 4: 0.028846153846153848
	Val acc at iteration 3: 0.031914893617021274
	Train acc at iteration 5: 0.052884615384615384
	Val acc at iteration 4: 0.07446808510638298
	Train acc at iteration 6: 0.04807692307692308
	Val acc at iteration 5: 0.05319148936170213
	Train acc at iteration 7: 0.04006410256410257
	Val acc at iteration 6: 0.0
	Train acc at iteration 8: 0.028846153846153848
	Val acc at iteration 7: 0.05319148936170213
	Train acc at iteration 9: 0.04487179487179487
	Val acc at iteration 8: 0.0425531914893617
	Train acc at iteration 10: 0.03205128205128205
	Val acc at iteration 9: 0.0
	Train acc at iteration 11: 0.0673076923076923
	Val acc at iteration 10: 0.07446808510638298
	Train acc at iteration 12: 0.038461538461538464
	Val acc at iteration 11: 0.0851063829787234
	Train acc at iteration 13: 0.06891025641025642
	Val acc at iteration 12: 0.0851063829787234
	Train acc at iteration 14: 0.08974358974358974
	Val acc at iteration 13: 0.031914893617021274
	Train acc at iteration 15: 0.05128205128205128
	Val acc at iteration 14: 0.10638297872340426
	Train acc at iteration 16: 0.09294871794871795
	Val acc at iteration 15: 0.06382978723404255
	Train acc at iteration 17: 0.08012820512820513
	Val acc at iteration 16: 0.07446808510638298
	Train acc at iteration 18: 0.10096153846153846
	Val acc at iteration 17: 0.11702127659574468
	Train acc at iteration 19: 0.1282051282051282
	Val acc at iteration 18: 0.1702127659574468
	Train acc at iteration 20: 0.13141025641025642
	Val acc at iteration 19: 0.1595744680851064
	Train acc at iteration 21: 0.14423076923076922
	Val acc at iteration 20: 0.22340425531914893
	Train acc at iteration 22: 0.1778846153846154
	Val acc at iteration 21: 0.1702127659574468
	Train acc at iteration 23: 0.16346153846153846
	Val acc at iteration 22: 0.2127659574468085
	Train acc at iteration 24: 0.1778846153846154
	Val acc at iteration 23: 0.14893617021276595
	Train acc at iteration 25: 0.1842948717948718
	Val acc at iteration 24: 0.13829787234042554
	Train acc at iteration 26: 0.16987179487179488
	Val acc at iteration 25: 0.14893617021276595
	Train acc at iteration 27: 0.1971153846153846
	Val acc at iteration 26: 0.1702127659574468
	Train acc at iteration 28: 0.11378205128205128
	Val acc at iteration 27: 0.1595744680851064
	Train acc at iteration 29: 0.1987179487179487
	Val acc at iteration 28: 0.2127659574468085
	Train acc at iteration 30: 0.1778846153846154
	Val acc at iteration 29: 0.30851063829787234
	Train acc at iteration 31: 0.22275641025641027
	Val acc at iteration 30: 0.14893617021276595
	Train acc at iteration 32: 0.18108974358974358
	Val acc at iteration 31: 0.2553191489361702
	Train acc at iteration 33: 0.2532051282051282
	Val acc at iteration 32: 0.24468085106382978
	Train acc at iteration 34: 0.21474358974358973
	Val acc at iteration 33: 0.26595744680851063
	Train acc at iteration 35: 0.28846153846153844
	Val acc at iteration 34: 0.23404255319148937
	Train acc at iteration 36: 0.25961538461538464
	Val acc at iteration 35: 0.24468085106382978
	Train acc at iteration 37: 0.23557692307692307
	Val acc at iteration 36: 0.2872340425531915
	Train acc at iteration 38: 0.28525641025641024
	Val acc at iteration 37: 0.23404255319148937
	Train acc at iteration 39: 0.21474358974358973
	Val acc at iteration 38: 0.13829787234042554
	Train acc at iteration 40: 0.1201923076923077
	Val acc at iteration 39: 0.20212765957446807
	Train acc at iteration 41: 0.21955128205128205
	Val acc at iteration 40: 0.2553191489361702
	Train acc at iteration 42: 0.20032051282051283
	Val acc at iteration 41: 0.2872340425531915
	Train acc at iteration 43: 0.2724358974358974
	Val acc at iteration 42: 0.23404255319148937
	Train acc at iteration 44: 0.2708333333333333
	Val acc at iteration 43: 0.26595744680851063
	Train acc at iteration 45: 0.3125
	Val acc at iteration 44: 0.2765957446808511
	Train acc at iteration 46: 0.34935897435897434
	Val acc at iteration 45: 0.24468085106382978
	Train acc at iteration 47: 0.2980769230769231
	Val acc at iteration 46: 0.2978723404255319
	Train acc at iteration 48: 0.3317307692307692
	Val acc at iteration 47: 0.35106382978723405
	Train acc at iteration 49: 0.2916666666666667
	Val acc at iteration 48: 0.425531914893617
	Train acc at iteration 50: 0.38461538461538464
	Val acc at iteration 49: 0.35106382978723405
	Train acc at iteration 51: 0.296474358974359
	Val acc at iteration 50: 0.32978723404255317
	Train acc at iteration 52: 0.34294871794871795
	Val acc at iteration 51: 0.40425531914893614
	Train acc at iteration 53: 0.34935897435897434
	Val acc at iteration 52: 0.30851063829787234
	Train acc at iteration 54: 0.28525641025641024
	Val acc at iteration 53: 0.2765957446808511
	Train acc at iteration 55: 0.3573717948717949
	Val acc at iteration 54: 0.425531914893617
	Train acc at iteration 56: 0.4342948717948718
	Val acc at iteration 55: 0.40425531914893614
	Train acc at iteration 57: 0.3733974358974359
	Val acc at iteration 56: 0.35106382978723405
	Train acc at iteration 58: 0.33814102564102566
	Val acc at iteration 57: 0.40425531914893614
	Train acc at iteration 59: 0.45032051282051283
	Val acc at iteration 58: 0.40425531914893614
	Train acc at iteration 60: 0.4567307692307692
	Val acc at iteration 59: 0.3723404255319149
	Train acc at iteration 61: 0.45032051282051283
	Val acc at iteration 60: 0.3723404255319149
	Train acc at iteration 62: 0.45032051282051283
	Val acc at iteration 61: 0.44680851063829785
	Train acc at iteration 63: 0.4358974358974359
	Val acc at iteration 62: 0.40425531914893614
	Train acc at iteration 64: 0.46955128205128205
	Val acc at iteration 63: 0.4148936170212766
	Train acc at iteration 65: 0.42948717948717946
	Val acc at iteration 64: 0.35106382978723405
	Train acc at iteration 66: 0.4375
	Val acc at iteration 65: 0.40425531914893614
	Train acc at iteration 67: 0.5352564102564102
	Val acc at iteration 66: 0.5
	Train acc at iteration 68: 0.5544871794871795
	Val acc at iteration 67: 0.5212765957446809
	Train acc at iteration 69: 0.5496794871794872
	Val acc at iteration 68: 0.44680851063829785
	Train acc at iteration 70: 0.4935897435897436
	Val acc at iteration 69: 0.39361702127659576
	Train acc at iteration 71: 0.5240384615384616
	Val acc at iteration 70: 0.5106382978723404
	Train acc at iteration 72: 0.5657051282051282
	Val acc at iteration 71: 0.5106382978723404
	Train acc at iteration 73: 0.4807692307692308
	Val acc at iteration 72: 0.5212765957446809
	Train acc at iteration 74: 0.5881410256410257
	Val acc at iteration 73: 0.5425531914893617
	Train acc at iteration 75: 0.5769230769230769
	Val acc at iteration 74: 0.5
	Train acc at iteration 76: 0.5625
	Val acc at iteration 75: 0.39361702127659576
	Train acc at iteration 77: 0.5256410256410257
	Val acc at iteration 76: 0.48936170212765956
	Train acc at iteration 78: 0.5961538461538461
	Val acc at iteration 77: 0.5212765957446809
	Train acc at iteration 79: 0.5608974358974359
	Val acc at iteration 78: 0.5531914893617021
	Train acc at iteration 80: 0.6362179487179487
	Val acc at iteration 79: 0.5638297872340425
	Train acc at iteration 81: 0.6121794871794872
	Val acc at iteration 80: 0.5531914893617021
	Train acc at iteration 82: 0.6153846153846154
	Val acc at iteration 81: 0.5
	Train acc at iteration 83: 0.5801282051282052
	Val acc at iteration 82: 0.5319148936170213
	Train acc at iteration 84: 0.5865384615384616
	Val acc at iteration 83: 0.5638297872340425
	Train acc at iteration 85: 0.6009615384615384
	Val acc at iteration 84: 0.5425531914893617
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.4888888888888889
Final val micro accuracy: 0.574468085106383
Final test macro f1-score: 0.42083333333333334
Final test micro accuracy: 0.5212765957446809
Final validation:
	Cluster: 0.6224235892295837
	Separation: 0.546707034111023
Final test:
	Cluster: 0.5982109606266022
	Separation: 0.5341841578483582
Saved Results

Attempting combination 20/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.6525946140289307
	Train Separation: 0.5266127586364746
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.5851063829787234
	Val acc at iteration 3: 0.5851063829787234
	Val acc at iteration 4: 0.5851063829787234
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.5851063829787234
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.6170212765957447
	Val acc at iteration 11: 0.5957446808510638
	Val acc at iteration 12: 0.5319148936170213
	Val acc at iteration 13: 0.6276595744680851
	Val acc at iteration 14: 0.5851063829787234
	Val acc at iteration 15: 0.5851063829787234
	Val acc at iteration 16: 0.5531914893617021
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.6276595744680851
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.6063829787234043
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.5957446808510638
	Val acc at iteration 23: 0.6063829787234043
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.5957446808510638
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.6063829787234043
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.5957446808510638
	Val acc at iteration 30: 0.6170212765957447
	Val acc at iteration 31: 0.776595744680851
	Val acc at iteration 32: 0.6276595744680851
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.5425531914893617
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6170212765957447
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.5851063829787234
	Val acc at iteration 45: 0.5319148936170213
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.5212765957446809
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.6276595744680851
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.6382978723404256
	Val acc at iteration 52: 0.6170212765957447
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.6276595744680851
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.6382978723404256
	Val acc at iteration 62: 0.6276595744680851
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.5531914893617021
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6170212765957447
	Val acc at iteration 75: 0.574468085106383
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.6170212765957447
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.6063829787234043
Val acc before epoch 13: 0.6914893617021277
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7340425531914894
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.7978723404255319
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7836538461538461
	Train Cluster: 0.6409166932106019
	Train Separation: 0.5170082211494446
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.776595744680851
	Val acc at iteration 2: 0.776595744680851
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.776595744680851
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.776595744680851
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.7872340425531915
	Val acc at iteration 36: 0.7872340425531915
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.5851063829787234
	Val acc at iteration 43: 0.6382978723404256
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6595744680851063
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7446808510638298
Val acc before epoch 25: 0.6382978723404256
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8191489361702128
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8285256410256411
	Train Cluster: 0.6447805881500244
	TrainSeparation: 0.5229053139686585
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.2564102564102564
	Val acc at iteration 0: 0.1276595744680851
	Train acc at iteration 2: 0.06891025641025642
	Val acc at iteration 1: 0.1276595744680851
	Train acc at iteration 3: 0.09615384615384616
	Val acc at iteration 2: 0.0425531914893617
	Train acc at iteration 4: 0.07051282051282051
	Val acc at iteration 3: 0.10638297872340426
	Train acc at iteration 5: 0.08173076923076923
	Val acc at iteration 4: 0.07446808510638298
	Train acc at iteration 6: 0.05929487179487179
	Val acc at iteration 5: 0.02127659574468085
	Train acc at iteration 7: 0.019230769230769232
	Val acc at iteration 6: 0.0425531914893617
	Train acc at iteration 8: 0.038461538461538464
	Val acc at iteration 7: 0.11702127659574468
	Train acc at iteration 9: 0.052884615384615384
	Val acc at iteration 8: 0.06382978723404255
	Train acc at iteration 10: 0.07692307692307693
	Val acc at iteration 9: 0.0425531914893617
	Train acc at iteration 11: 0.07532051282051282
	Val acc at iteration 10: 0.14893617021276595
	Train acc at iteration 12: 0.10737179487179487
	Val acc at iteration 11: 0.0851063829787234
	Train acc at iteration 13: 0.13942307692307693
	Val acc at iteration 12: 0.19148936170212766
	Train acc at iteration 14: 0.17307692307692307
	Val acc at iteration 13: 0.09574468085106383
	Train acc at iteration 15: 0.16826923076923078
	Val acc at iteration 14: 0.19148936170212766
	Train acc at iteration 16: 0.14583333333333334
	Val acc at iteration 15: 0.06382978723404255
	Train acc at iteration 17: 0.14743589743589744
	Val acc at iteration 16: 0.11702127659574468
	Train acc at iteration 18: 0.11057692307692307
	Val acc at iteration 17: 0.11702127659574468
	Train acc at iteration 19: 0.17467948717948717
	Val acc at iteration 18: 0.19148936170212766
	Train acc at iteration 20: 0.1858974358974359
	Val acc at iteration 19: 0.24468085106382978
	Train acc at iteration 21: 0.24358974358974358
	Val acc at iteration 20: 0.20212765957446807
	Train acc at iteration 22: 0.1778846153846154
	Val acc at iteration 21: 0.39361702127659576
	Train acc at iteration 23: 0.22275641025641027
	Val acc at iteration 22: 0.20212765957446807
	Train acc at iteration 24: 0.23397435897435898
	Val acc at iteration 23: 0.22340425531914893
	Train acc at iteration 25: 0.22435897435897437
	Val acc at iteration 24: 0.14893617021276595
	Train acc at iteration 26: 0.1891025641025641
	Val acc at iteration 25: 0.2765957446808511
	Train acc at iteration 27: 0.25801282051282054
	Val acc at iteration 26: 0.30851063829787234
	Train acc at iteration 28: 0.23076923076923078
	Val acc at iteration 27: 0.1702127659574468
	Train acc at iteration 29: 0.3076923076923077
	Val acc at iteration 28: 0.24468085106382978
	Train acc at iteration 30: 0.2483974358974359
	Val acc at iteration 29: 0.3191489361702128
	Train acc at iteration 31: 0.3060897435897436
	Val acc at iteration 30: 0.30851063829787234
	Train acc at iteration 32: 0.34775641025641024
	Val acc at iteration 31: 0.1702127659574468
	Train acc at iteration 33: 0.27724358974358976
	Val acc at iteration 32: 0.3829787234042553
	Train acc at iteration 34: 0.4407051282051282
	Val acc at iteration 33: 0.3404255319148936
	Train acc at iteration 35: 0.34455128205128205
	Val acc at iteration 34: 0.3723404255319149
	Train acc at iteration 36: 0.3301282051282051
	Val acc at iteration 35: 0.32978723404255317
	Train acc at iteration 37: 0.3573717948717949
	Val acc at iteration 36: 0.44680851063829785
	Train acc at iteration 38: 0.42948717948717946
	Val acc at iteration 37: 0.46808510638297873
	Train acc at iteration 39: 0.46153846153846156
	Val acc at iteration 38: 0.4148936170212766
	Train acc at iteration 40: 0.4150641025641026
	Val acc at iteration 39: 0.43617021276595747
	Train acc at iteration 41: 0.34935897435897434
	Val acc at iteration 40: 0.3829787234042553
	Train acc at iteration 42: 0.48717948717948717
	Val acc at iteration 41: 0.5
	Train acc at iteration 43: 0.5080128205128205
	Val acc at iteration 42: 0.5106382978723404
	Train acc at iteration 44: 0.4775641025641026
	Val acc at iteration 43: 0.3404255319148936
	Train acc at iteration 45: 0.5032051282051282
	Val acc at iteration 44: 0.5106382978723404
	Train acc at iteration 46: 0.5432692307692307
	Val acc at iteration 45: 0.4787234042553192
	Train acc at iteration 47: 0.5272435897435898
	Val acc at iteration 46: 0.5106382978723404
	Train acc at iteration 48: 0.5576923076923077
	Val acc at iteration 47: 0.5
	Train acc at iteration 49: 0.5544871794871795
	Val acc at iteration 48: 0.2872340425531915
	Train acc at iteration 50: 0.4983974358974359
	Val acc at iteration 49: 0.5
	Train acc at iteration 51: 0.5576923076923077
	Val acc at iteration 50: 0.48936170212765956
	Train acc at iteration 52: 0.5961538461538461
	Val acc at iteration 51: 0.5212765957446809
	Train acc at iteration 53: 0.6378205128205128
	Val acc at iteration 52: 0.5851063829787234
	Train acc at iteration 54: 0.5576923076923077
	Val acc at iteration 53: 0.574468085106383
	Train acc at iteration 55: 0.5977564102564102
	Val acc at iteration 54: 0.6170212765957447
	Train acc at iteration 56: 0.6586538461538461
	Val acc at iteration 55: 0.6276595744680851
	Train acc at iteration 57: 0.6410256410256411
	Val acc at iteration 56: 0.39361702127659576
	Train acc at iteration 58: 0.6233974358974359
	Val acc at iteration 57: 0.5531914893617021
	Train acc at iteration 59: 0.6746794871794872
	Val acc at iteration 58: 0.3723404255319149
	Train acc at iteration 60: 0.6314102564102564
	Val acc at iteration 59: 0.6382978723404256
	Train acc at iteration 61: 0.5993589743589743
	Val acc at iteration 60: 0.5638297872340425
	Train acc at iteration 62: 0.6362179487179487
	Val acc at iteration 61: 0.5531914893617021
	Train acc at iteration 63: 0.6586538461538461
	Val acc at iteration 62: 0.6170212765957447
	Train acc at iteration 64: 0.6586538461538461
	Val acc at iteration 63: 0.6170212765957447
	Train acc at iteration 65: 0.6538461538461539
	Val acc at iteration 64: 0.5212765957446809
	Train acc at iteration 66: 0.6618589743589743
	Val acc at iteration 65: 0.5957446808510638
	Train acc at iteration 67: 0.6602564102564102
	Val acc at iteration 66: 0.5851063829787234
	Train acc at iteration 68: 0.6810897435897436
	Val acc at iteration 67: 0.6702127659574468
	Train acc at iteration 69: 0.6939102564102564
	Val acc at iteration 68: 0.5957446808510638
	Train acc at iteration 70: 0.6458333333333334
	Val acc at iteration 69: 0.6063829787234043
	Train acc at iteration 71: 0.719551282051282
	Val acc at iteration 70: 0.4787234042553192
	Train acc at iteration 72: 0.6426282051282052
	Val acc at iteration 71: 0.6808510638297872
	Train acc at iteration 73: 0.6842948717948718
	Val acc at iteration 72: 0.5851063829787234
	Train acc at iteration 74: 0.6794871794871795
	Val acc at iteration 73: 0.6276595744680851
	Train acc at iteration 75: 0.6826923076923077
	Val acc at iteration 74: 0.6382978723404256
	Train acc at iteration 76: 0.6955128205128205
	Val acc at iteration 75: 0.5851063829787234
	Train acc at iteration 77: 0.6650641025641025
	Val acc at iteration 76: 0.6382978723404256
	Train acc at iteration 78: 0.7147435897435898
	Val acc at iteration 77: 0.6170212765957447
	Train acc at iteration 79: 0.6939102564102564
	Val acc at iteration 78: 0.6170212765957447
	Train acc at iteration 80: 0.6891025641025641
	Val acc at iteration 79: 0.6382978723404256
	Train acc at iteration 81: 0.7083333333333334
	Val acc at iteration 80: 0.6808510638297872
	Train acc at iteration 82: 0.7323717948717948
	Val acc at iteration 81: 0.6170212765957447
	Train acc at iteration 83: 0.7163461538461539
	Val acc at iteration 82: 0.5957446808510638
	Train acc at iteration 84: 0.7227564102564102
	Val acc at iteration 83: 0.6276595744680851
	Train acc at iteration 85: 0.7227564102564102
	Val acc at iteration 84: 0.6808510638297872
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.45185185185185184
Final val micro accuracy: 0.5531914893617021
Final test macro f1-score: 0.44649758454106275
Final test micro accuracy: 0.574468085106383
Final validation:
	Cluster: 0.6167527437210083
	Separation: 0.5429205894470215
Final test:
	Cluster: 0.5971485674381256
	Separation: 0.5367760360240936
Saved Results

Attempting combination 21/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7756410256410257
	Train Cluster: 0.6430026650428772
	Train Separation: 0.5207413077354431
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5638297872340425
	Val acc at iteration 1: 0.5212765957446809
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.6808510638297872
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.7872340425531915
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.6382978723404256
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.5957446808510638
	Val acc at iteration 73: 0.723404255319149
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.7340425531914894
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.6170212765957447
Val acc before epoch 13: 0.7021276595744681
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7916666666666666
	Train Cluster: 0.6529089331626892
	Train Separation: 0.52119882106781
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7127659574468085
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.7446808510638298
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.7553191489361702
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.776595744680851
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.7978723404255319
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.6702127659574468
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.5957446808510638
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.776595744680851
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.7872340425531915
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.7872340425531915
	Val acc at iteration 75: 0.7872340425531915
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.6702127659574468
Val acc before epoch 25: 0.7659574468085106
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8191489361702128
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Train Cluster: 0.645944356918335
	TrainSeparation: 0.5172074198722839
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer
Last layer lr: 0.05
	Train acc at iteration 1: 0.3573717948717949
	Val acc at iteration 0: 0.39361702127659576
	Train acc at iteration 2: 0.16506410256410256
	Val acc at iteration 1: 0.2765957446808511
	Train acc at iteration 3: 0.1858974358974359
	Val acc at iteration 2: 0.2553191489361702
	Train acc at iteration 4: 0.1842948717948718
	Val acc at iteration 3: 0.35106382978723405
	Train acc at iteration 5: 0.27884615384615385
	Val acc at iteration 4: 0.2872340425531915
	Train acc at iteration 6: 0.21955128205128205
	Val acc at iteration 5: 0.2978723404255319
	Train acc at iteration 7: 0.20192307692307693
	Val acc at iteration 6: 0.2553191489361702
	Train acc at iteration 8: 0.19391025641025642
	Val acc at iteration 7: 0.32978723404255317
	Train acc at iteration 9: 0.27724358974358976
	Val acc at iteration 8: 0.3723404255319149
	Train acc at iteration 10: 0.2387820512820513
	Val acc at iteration 9: 0.20212765957446807
	Train acc at iteration 11: 0.2708333333333333
	Val acc at iteration 10: 0.0851063829787234
	Train acc at iteration 12: 0.20993589743589744
	Val acc at iteration 11: 0.425531914893617
	Train acc at iteration 13: 0.28846153846153844
	Val acc at iteration 12: 0.2553191489361702
	Train acc at iteration 14: 0.27403846153846156
	Val acc at iteration 13: 0.3617021276595745
	Train acc at iteration 15: 0.27884615384615385
	Val acc at iteration 14: 0.40425531914893614
	Train acc at iteration 16: 0.38301282051282054
	Val acc at iteration 15: 0.3617021276595745
	Train acc at iteration 17: 0.3333333333333333
	Val acc at iteration 16: 0.425531914893617
	Train acc at iteration 18: 0.36538461538461536
	Val acc at iteration 17: 0.425531914893617
	Train acc at iteration 19: 0.4150641025641026
	Val acc at iteration 18: 0.44680851063829785
