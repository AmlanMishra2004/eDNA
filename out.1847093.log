===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Fri Mar 29 22:28:33 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-03-29 22:28:47.202887: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-29 22:28:47.809270: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-29 22:28:47.809359: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-29 22:28:47.812638: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-29 22:28:48.199635: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94
Hyperparameters: {'prototype_shape': [(468, 520, 29)], 'latent_weight': [0.8], 'joint_weight_decay': [-1], 'gamma': [-1], 'warm_lr_step_size': [5000000], 'crs_ent_weight': [1], 'clst_weight': [-9.600000000000001], 'sep_weight': [2.4], 'l1_weight': [0.0001, 0.0005, 0.001, 0.005, 0.01, 0.1, 0.5, 1], 'warm_ptype_lr': [0.4], 'last_layer_lr': [0.001], 'last_layer_lr_after_second_push': [0.5, 0.1, 0.05, 0.01, 0.005, 0.001, 0.0005, 0.0001, 5e-05], 'num_warm_epochs': [1000000], 'push_gap': [12], 'push_start': [12], 'num_pushes': [2], 'last_layer_epochs': [85], 'joint_lr_step_size': [-1], 'joint_optimizer_lrs': [{'features': -1, 'prototype_vectors': -1}]}




Exploring 72 hyperparameter combinations for grid search.


Attempting combination 1/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6914893617021277
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.63514643907547
	Train Separation: 0.5188608169555664
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6382978723404256
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.6276595744680851
	Val acc at iteration 3: 0.5851063829787234
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.5957446808510638
	Val acc at iteration 7: 0.5957446808510638
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.6063829787234043
	Val acc at iteration 17: 0.5957446808510638
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.7553191489361702
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6382978723404256
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7553191489361702
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.6276595744680851
	Val acc at iteration 48: 0.7659574468085106
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.6170212765957447
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.7872340425531915
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.8191489361702128
	Val acc at iteration 73: 0.6382978723404256
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.776595744680851
	Val acc at iteration 77: 0.7978723404255319
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.7021276595744681
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8044871794871795
	Train Cluster: 0.6403360605239868
	Train Separation: 0.5168047666549682
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.7659574468085106
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.8085106382978723
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.7872340425531915
	Val acc at iteration 8: 0.7872340425531915
	Val acc at iteration 9: 0.776595744680851
	Val acc at iteration 10: 0.7978723404255319
	Val acc at iteration 11: 0.7872340425531915
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.8085106382978723
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.7446808510638298
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.776595744680851
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.8085106382978723
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.7659574468085106
	Val acc at iteration 43: 0.8297872340425532
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.776595744680851
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.7978723404255319
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.7872340425531915
	Val acc at iteration 52: 0.8085106382978723
	Val acc at iteration 53: 0.8085106382978723
	Val acc at iteration 54: 0.8085106382978723
	Val acc at iteration 55: 0.7978723404255319
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.776595744680851
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.8085106382978723
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.7872340425531915
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.7872340425531915
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.8191489361702128
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.7872340425531915
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.8191489361702128
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.7978723404255319
	Val acc at iteration 74: 0.8191489361702128
	Val acc at iteration 75: 0.7553191489361702
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.8085106382978723
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.8085106382978723
Val acc before epoch 25: 0.8297872340425532
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8461538461538461
	Train Cluster: 0.6489353060722352
	TrainSeparation: 0.520066213607788
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.20833333333333334
	Val acc at iteration 0: 0.0425531914893617
	Train acc at iteration 2: 0.004807692307692308
	Val acc at iteration 1: 0.031914893617021274
	Train acc at iteration 3: 0.014423076923076924
	Val acc at iteration 2: 0.031914893617021274
	Train acc at iteration 4: 0.02564102564102564
	Val acc at iteration 3: 0.010638297872340425
	Train acc at iteration 5: 0.02403846153846154
	Val acc at iteration 4: 0.031914893617021274
	Train acc at iteration 6: 0.017628205128205128
	Val acc at iteration 5: 0.0425531914893617
	Train acc at iteration 7: 0.008012820512820512
	Val acc at iteration 6: 0.02127659574468085
	Train acc at iteration 8: 0.019230769230769232
	Val acc at iteration 7: 0.010638297872340425
	Train acc at iteration 9: 0.011217948717948718
	Val acc at iteration 8: 0.0
	Train acc at iteration 10: 0.019230769230769232
	Val acc at iteration 9: 0.02127659574468085
	Train acc at iteration 11: 0.017628205128205128
	Val acc at iteration 10: 0.02127659574468085
	Train acc at iteration 12: 0.011217948717948718
	Val acc at iteration 11: 0.02127659574468085
	Train acc at iteration 13: 0.03205128205128205
	Val acc at iteration 12: 0.031914893617021274
	Train acc at iteration 14: 0.01282051282051282
	Val acc at iteration 13: 0.0425531914893617
	Train acc at iteration 15: 0.017628205128205128
	Val acc at iteration 14: 0.010638297872340425
	Train acc at iteration 16: 0.020833333333333332
	Val acc at iteration 15: 0.02127659574468085
	Train acc at iteration 17: 0.011217948717948718
	Val acc at iteration 16: 0.010638297872340425
	Train acc at iteration 18: 0.02564102564102564
	Val acc at iteration 17: 0.02127659574468085
	Train acc at iteration 19: 0.017628205128205128
	Val acc at iteration 18: 0.0425531914893617
	Train acc at iteration 20: 0.046474358974358976
	Val acc at iteration 19: 0.031914893617021274
	Train acc at iteration 21: 0.04326923076923077
	Val acc at iteration 20: 0.0425531914893617
	Train acc at iteration 22: 0.052884615384615384
	Val acc at iteration 21: 0.02127659574468085
	Train acc at iteration 23: 0.02403846153846154
	Val acc at iteration 22: 0.05319148936170213
	Train acc at iteration 24: 0.060897435897435896
	Val acc at iteration 23: 0.07446808510638298
	Train acc at iteration 25: 0.08012820512820513
	Val acc at iteration 24: 0.0851063829787234
	Train acc at iteration 26: 0.09134615384615384
	Val acc at iteration 25: 0.1595744680851064
	Train acc at iteration 27: 0.13782051282051283
	Val acc at iteration 26: 0.1276595744680851
	Train acc at iteration 28: 0.09615384615384616
	Val acc at iteration 27: 0.13829787234042554
	Train acc at iteration 29: 0.1282051282051282
	Val acc at iteration 28: 0.1276595744680851
	Train acc at iteration 30: 0.1842948717948718
	Val acc at iteration 29: 0.20212765957446807
	Train acc at iteration 31: 0.1971153846153846
	Val acc at iteration 30: 0.22340425531914893
	Train acc at iteration 32: 0.26121794871794873
	Val acc at iteration 31: 0.23404255319148937
	Train acc at iteration 33: 0.27564102564102566
	Val acc at iteration 32: 0.2978723404255319
	Train acc at iteration 34: 0.3108974358974359
	Val acc at iteration 33: 0.4148936170212766
	Train acc at iteration 35: 0.38301282051282054
	Val acc at iteration 34: 0.3617021276595745
	Train acc at iteration 36: 0.3814102564102564
	Val acc at iteration 35: 0.40425531914893614
	Train acc at iteration 37: 0.4407051282051282
	Val acc at iteration 36: 0.40425531914893614
	Train acc at iteration 38: 0.4519230769230769
	Val acc at iteration 37: 0.4148936170212766
	Train acc at iteration 39: 0.5112179487179487
	Val acc at iteration 38: 0.574468085106383
	Train acc at iteration 40: 0.5721153846153846
	Val acc at iteration 39: 0.5
	Train acc at iteration 41: 0.5721153846153846
	Val acc at iteration 40: 0.5851063829787234
	Train acc at iteration 42: 0.5881410256410257
	Val acc at iteration 41: 0.574468085106383
	Train acc at iteration 43: 0.592948717948718
	Val acc at iteration 42: 0.6276595744680851
	Train acc at iteration 44: 0.6426282051282052
	Val acc at iteration 43: 0.7127659574468085
	Train acc at iteration 45: 0.6746794871794872
	Val acc at iteration 44: 0.6063829787234043
	Train acc at iteration 46: 0.6891025641025641
	Val acc at iteration 45: 0.6276595744680851
	Train acc at iteration 47: 0.6939102564102564
	Val acc at iteration 46: 0.7340425531914894
	Train acc at iteration 48: 0.6891025641025641
	Val acc at iteration 47: 0.723404255319149
	Train acc at iteration 49: 0.7323717948717948
	Val acc at iteration 48: 0.7553191489361702
	Train acc at iteration 50: 0.7259615384615384
	Val acc at iteration 49: 0.7872340425531915
	Train acc at iteration 51: 0.7788461538461539
	Val acc at iteration 50: 0.7446808510638298
	Train acc at iteration 52: 0.6794871794871795
	Val acc at iteration 51: 0.648936170212766
	Train acc at iteration 53: 0.7115384615384616
	Val acc at iteration 52: 0.7872340425531915
	Train acc at iteration 54: 0.7564102564102564
	Val acc at iteration 53: 0.7021276595744681
	Train acc at iteration 55: 0.7612179487179487
	Val acc at iteration 54: 0.7446808510638298
	Train acc at iteration 56: 0.7275641025641025
	Val acc at iteration 55: 0.7978723404255319
	Train acc at iteration 57: 0.7564102564102564
	Val acc at iteration 56: 0.8297872340425532
	Train acc at iteration 58: 0.7419871794871795
	Val acc at iteration 57: 0.7553191489361702
	Train acc at iteration 59: 0.7564102564102564
	Val acc at iteration 58: 0.7340425531914894
	Train acc at iteration 60: 0.7788461538461539
	Val acc at iteration 59: 0.7659574468085106
	Train acc at iteration 61: 0.8092948717948718
	Val acc at iteration 60: 0.8191489361702128
	Train acc at iteration 62: 0.8108974358974359
	Val acc at iteration 61: 0.7978723404255319
	Train acc at iteration 63: 0.8301282051282052
	Val acc at iteration 62: 0.8191489361702128
	Train acc at iteration 64: 0.8076923076923077
	Val acc at iteration 63: 0.8085106382978723
	Train acc at iteration 65: 0.780448717948718
	Val acc at iteration 64: 0.8191489361702128
	Train acc at iteration 66: 0.7852564102564102
	Val acc at iteration 65: 0.8617021276595744
	Train acc at iteration 67: 0.8301282051282052
	Val acc at iteration 66: 0.776595744680851
	Train acc at iteration 68: 0.7852564102564102
	Val acc at iteration 67: 0.8404255319148937
	Train acc at iteration 69: 0.7932692307692307
	Val acc at iteration 68: 0.8404255319148937
	Train acc at iteration 70: 0.8269230769230769
	Val acc at iteration 69: 0.8723404255319149
	Train acc at iteration 71: 0.8221153846153846
	Val acc at iteration 70: 0.7872340425531915
	Train acc at iteration 72: 0.7916666666666666
	Val acc at iteration 71: 0.7659574468085106
	Train acc at iteration 73: 0.8317307692307693
	Val acc at iteration 72: 0.851063829787234
	Train acc at iteration 74: 0.7932692307692307
	Val acc at iteration 73: 0.7978723404255319
	Train acc at iteration 75: 0.7996794871794872
	Val acc at iteration 74: 0.7978723404255319
	Train acc at iteration 76: 0.7964743589743589
	Val acc at iteration 75: 0.776595744680851
	Train acc at iteration 77: 0.8060897435897436
	Val acc at iteration 76: 0.8191489361702128
	Train acc at iteration 78: 0.8205128205128205
	Val acc at iteration 77: 0.8829787234042553
	Train acc at iteration 79: 0.8317307692307693
	Val acc at iteration 78: 0.8085106382978723
	Train acc at iteration 80: 0.8012820512820513
	Val acc at iteration 79: 0.8617021276595744
	Train acc at iteration 81: 0.8173076923076923
	Val acc at iteration 80: 0.7978723404255319
	Train acc at iteration 82: 0.8044871794871795
	Val acc at iteration 81: 0.8404255319148937
	Train acc at iteration 83: 0.8125
	Val acc at iteration 82: 0.8404255319148937
	Train acc at iteration 84: 0.7996794871794872
	Val acc at iteration 83: 0.776595744680851
	Train acc at iteration 85: 0.8044871794871795
	Val acc at iteration 84: 0.776595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7195035460992907
Final val micro accuracy: 0.7978723404255319
Final test macro f1-score: 0.644313725490196
Final test micro accuracy: 0.7553191489361702
Final validation:
	Cluster: 0.6164097487926483
	Separation: 0.5326111018657684
Final test:
	Cluster: 0.5979632139205933
	Separation: 0.5378649234771729
Saved Results

Attempting combination 2/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5957446808510638
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6702127659574468
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7516025641025641
	Train Cluster: 0.6396625757217407
	Train Separation: 0.5169807076454163
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.6063829787234043
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.7446808510638298
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.7872340425531915
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.6170212765957447
	Val acc at iteration 39: 0.8085106382978723
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.8191489361702128
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.648936170212766
	Val acc at iteration 61: 0.7659574468085106
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.7872340425531915
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.7872340425531915
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.7872340425531915
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.8301282051282052
	Train Cluster: 0.6487024903297425
	Train Separation: 0.5198180794715881
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.8085106382978723
	Val acc at iteration 11: 0.776595744680851
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.776595744680851
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.7553191489361702
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.7978723404255319
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7872340425531915
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.8085106382978723
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7978723404255319
	Val acc at iteration 35: 0.7978723404255319
	Val acc at iteration 36: 0.7872340425531915
	Val acc at iteration 37: 0.8191489361702128
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.776595744680851
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.7872340425531915
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.776595744680851
	Val acc at iteration 48: 0.6702127659574468
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.8297872340425532
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.8191489361702128
	Val acc at iteration 64: 0.7872340425531915
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.851063829787234
	Val acc at iteration 68: 0.7978723404255319
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.8085106382978723
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.7978723404255319
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.8191489361702128
	Val acc at iteration 76: 0.8085106382978723
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.776595744680851
	Val acc at iteration 81: 0.8191489361702128
	Val acc at iteration 82: 0.7978723404255319
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.7446808510638298
Val acc before epoch 25: 0.8297872340425532
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9787234042553191
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8285256410256411
	Train Cluster: 0.6516015291213989
	TrainSeparation: 0.5246188282966614
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.30448717948717946
	Val acc at iteration 0: 0.3191489361702128
	Train acc at iteration 2: 0.15544871794871795
	Val acc at iteration 1: 0.19148936170212766
	Train acc at iteration 3: 0.09935897435897435
	Val acc at iteration 2: 0.2127659574468085
	Train acc at iteration 4: 0.11217948717948718
	Val acc at iteration 3: 0.13829787234042554
	Train acc at iteration 5: 0.09455128205128205
	Val acc at iteration 4: 0.20212765957446807
	Train acc at iteration 6: 0.08653846153846154
	Val acc at iteration 5: 0.2127659574468085
	Train acc at iteration 7: 0.07371794871794872
	Val acc at iteration 6: 0.13829787234042554
	Train acc at iteration 8: 0.12179487179487179
	Val acc at iteration 7: 0.0425531914893617
	Train acc at iteration 9: 0.07371794871794872
	Val acc at iteration 8: 0.07446808510638298
	Train acc at iteration 10: 0.11698717948717949
	Val acc at iteration 9: 0.13829787234042554
	Train acc at iteration 11: 0.09294871794871795
	Val acc at iteration 10: 0.05319148936170213
	Train acc at iteration 12: 0.08173076923076923
	Val acc at iteration 11: 0.1702127659574468
	Train acc at iteration 13: 0.08173076923076923
	Val acc at iteration 12: 0.07446808510638298
	Train acc at iteration 14: 0.07692307692307693
	Val acc at iteration 13: 0.18085106382978725
	Train acc at iteration 15: 0.11217948717948718
	Val acc at iteration 14: 0.1702127659574468
	Train acc at iteration 16: 0.1266025641025641
	Val acc at iteration 15: 0.1595744680851064
	Train acc at iteration 17: 0.1201923076923077
	Val acc at iteration 16: 0.11702127659574468
	Train acc at iteration 18: 0.10416666666666667
	Val acc at iteration 17: 0.13829787234042554
	Train acc at iteration 19: 0.15224358974358973
	Val acc at iteration 18: 0.1595744680851064
	Train acc at iteration 20: 0.13942307692307693
	Val acc at iteration 19: 0.19148936170212766
	Train acc at iteration 21: 0.20512820512820512
	Val acc at iteration 20: 0.2127659574468085
	Train acc at iteration 22: 0.21153846153846154
	Val acc at iteration 21: 0.3191489361702128
	Train acc at iteration 23: 0.2532051282051282
	Val acc at iteration 22: 0.2872340425531915
	Train acc at iteration 24: 0.2467948717948718
	Val acc at iteration 23: 0.26595744680851063
	Train acc at iteration 25: 0.25
	Val acc at iteration 24: 0.2765957446808511
	Train acc at iteration 26: 0.3317307692307692
	Val acc at iteration 25: 0.35106382978723405
	Train acc at iteration 27: 0.32211538461538464
	Val acc at iteration 26: 0.44680851063829785
	Train acc at iteration 28: 0.38461538461538464
	Val acc at iteration 27: 0.35106382978723405
	Train acc at iteration 29: 0.42788461538461536
	Val acc at iteration 28: 0.5106382978723404
	Train acc at iteration 30: 0.4855769230769231
	Val acc at iteration 29: 0.43617021276595747
	Train acc at iteration 31: 0.5064102564102564
	Val acc at iteration 30: 0.5638297872340425
	Train acc at iteration 32: 0.5432692307692307
	Val acc at iteration 31: 0.5957446808510638
	Train acc at iteration 33: 0.5769230769230769
	Val acc at iteration 32: 0.5957446808510638
	Train acc at iteration 34: 0.6410256410256411
	Val acc at iteration 33: 0.6595744680851063
	Train acc at iteration 35: 0.6538461538461539
	Val acc at iteration 34: 0.6914893617021277
	Train acc at iteration 36: 0.6266025641025641
	Val acc at iteration 35: 0.6808510638297872
	Train acc at iteration 37: 0.6842948717948718
	Val acc at iteration 36: 0.6382978723404256
	Train acc at iteration 38: 0.6730769230769231
	Val acc at iteration 37: 0.6914893617021277
	Train acc at iteration 39: 0.6987179487179487
	Val acc at iteration 38: 0.648936170212766
	Train acc at iteration 40: 0.7051282051282052
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.6794871794871795
	Val acc at iteration 40: 0.7127659574468085
	Train acc at iteration 42: 0.7115384615384616
	Val acc at iteration 41: 0.7127659574468085
	Train acc at iteration 43: 0.6939102564102564
	Val acc at iteration 42: 0.7872340425531915
	Train acc at iteration 44: 0.7371794871794872
	Val acc at iteration 43: 0.723404255319149
	Train acc at iteration 45: 0.7051282051282052
	Val acc at iteration 44: 0.7446808510638298
	Train acc at iteration 46: 0.6955128205128205
	Val acc at iteration 45: 0.6914893617021277
	Train acc at iteration 47: 0.7067307692307693
	Val acc at iteration 46: 0.7340425531914894
	Train acc at iteration 48: 0.7387820512820513
	Val acc at iteration 47: 0.7446808510638298
	Train acc at iteration 49: 0.7419871794871795
	Val acc at iteration 48: 0.7446808510638298
	Train acc at iteration 50: 0.7131410256410257
	Val acc at iteration 49: 0.723404255319149
	Train acc at iteration 51: 0.7644230769230769
	Val acc at iteration 50: 0.7340425531914894
	Train acc at iteration 52: 0.7403846153846154
	Val acc at iteration 51: 0.6808510638297872
	Train acc at iteration 53: 0.7451923076923077
	Val acc at iteration 52: 0.6808510638297872
	Train acc at iteration 54: 0.7227564102564102
	Val acc at iteration 53: 0.7021276595744681
	Train acc at iteration 55: 0.7275641025641025
	Val acc at iteration 54: 0.648936170212766
	Train acc at iteration 56: 0.7067307692307693
	Val acc at iteration 55: 0.7659574468085106
	Train acc at iteration 57: 0.7211538461538461
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.7548076923076923
	Val acc at iteration 57: 0.7553191489361702
	Train acc at iteration 59: 0.7019230769230769
	Val acc at iteration 58: 0.7340425531914894
	Train acc at iteration 60: 0.7243589743589743
	Val acc at iteration 59: 0.7978723404255319
	Train acc at iteration 61: 0.7516025641025641
	Val acc at iteration 60: 0.7553191489361702
	Train acc at iteration 62: 0.7259615384615384
	Val acc at iteration 61: 0.7978723404255319
	Train acc at iteration 63: 0.7467948717948718
	Val acc at iteration 62: 0.7127659574468085
	Train acc at iteration 64: 0.7147435897435898
	Val acc at iteration 63: 0.7553191489361702
	Train acc at iteration 65: 0.7580128205128205
	Val acc at iteration 64: 0.7340425531914894
	Train acc at iteration 66: 0.7339743589743589
	Val acc at iteration 65: 0.7021276595744681
	Train acc at iteration 67: 0.6971153846153846
	Val acc at iteration 66: 0.8404255319148937
	Train acc at iteration 68: 0.7532051282051282
	Val acc at iteration 67: 0.6914893617021277
	Train acc at iteration 69: 0.7291666666666666
	Val acc at iteration 68: 0.7553191489361702
	Train acc at iteration 70: 0.7307692307692307
	Val acc at iteration 69: 0.7021276595744681
	Train acc at iteration 71: 0.7147435897435898
	Val acc at iteration 70: 0.6276595744680851
	Train acc at iteration 72: 0.719551282051282
	Val acc at iteration 71: 0.7021276595744681
	Train acc at iteration 73: 0.7259615384615384
	Val acc at iteration 72: 0.7446808510638298
	Train acc at iteration 74: 0.7131410256410257
	Val acc at iteration 73: 0.7872340425531915
	Train acc at iteration 75: 0.6923076923076923
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.717948717948718
	Val acc at iteration 75: 0.7127659574468085
	Train acc at iteration 77: 0.6891025641025641
	Val acc at iteration 76: 0.7127659574468085
	Train acc at iteration 78: 0.7259615384615384
	Val acc at iteration 77: 0.723404255319149
	Train acc at iteration 79: 0.719551282051282
	Val acc at iteration 78: 0.6276595744680851
	Train acc at iteration 80: 0.7419871794871795
	Val acc at iteration 79: 0.7553191489361702
	Train acc at iteration 81: 0.7564102564102564
	Val acc at iteration 80: 0.7127659574468085
	Train acc at iteration 82: 0.7435897435897436
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7227564102564102
	Val acc at iteration 82: 0.7446808510638298
	Train acc at iteration 84: 0.717948717948718
	Val acc at iteration 83: 0.723404255319149
	Train acc at iteration 85: 0.7243589743589743
	Val acc at iteration 84: 0.7446808510638298
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6123188405797102
Final val micro accuracy: 0.7021276595744681
Final test macro f1-score: 0.43464419475655436
Final test micro accuracy: 0.5531914893617021
Final validation:
	Cluster: 0.6391096115112305
	Separation: 0.5493442118167877
Final test:
	Cluster: 0.5973038077354431
	Separation: 0.541741132736206
Saved Results

Attempting combination 3/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9468085106382979
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7403846153846154
	Train Cluster: 0.6286394238471985
	Train Separation: 0.5147728443145752
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5957446808510638
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.776595744680851
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.776595744680851
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.8191489361702128
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.7659574468085106
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.7553191489361702
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.8085106382978723
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.7978723404255319
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.776595744680851
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.7978723404255319
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7446808510638298
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7127659574468085
Val acc before epoch 13: 0.7659574468085106
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.6473309397697449
	Train Separation: 0.5212741494178772
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.7872340425531915
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.8085106382978723
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.776595744680851
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.7872340425531915
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.7978723404255319
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.7978723404255319
	Val acc at iteration 34: 0.7978723404255319
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.8191489361702128
	Val acc at iteration 37: 0.776595744680851
	Val acc at iteration 38: 0.8191489361702128
	Val acc at iteration 39: 0.7978723404255319
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.7872340425531915
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7978723404255319
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.8085106382978723
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.8297872340425532
	Val acc at iteration 54: 0.8404255319148937
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.776595744680851
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7978723404255319
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.8191489361702128
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.8085106382978723
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.8191489361702128
	Val acc at iteration 73: 0.8085106382978723
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.8085106382978723
	Val acc at iteration 76: 0.8191489361702128
	Val acc at iteration 77: 0.7978723404255319
	Val acc at iteration 78: 0.8085106382978723
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.7978723404255319
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7872340425531915
Val acc before epoch 25: 0.7978723404255319
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Train Cluster: 0.6507783532142639
	TrainSeparation: 0.5229120850563049
(Directly after push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer
Last layer lr: 0.05
	Train acc at iteration 1: 0.453525641025641
	Val acc at iteration 0: 0.4148936170212766
	Train acc at iteration 2: 0.3605769230769231
	Val acc at iteration 1: 0.4787234042553192
	Train acc at iteration 3: 0.32532051282051283
	Val acc at iteration 2: 0.40425531914893614
	Train acc at iteration 4: 0.2564102564102564
	Val acc at iteration 3: 0.3829787234042553
	Train acc at iteration 5: 0.3573717948717949
	Val acc at iteration 4: 0.46808510638297873
	Train acc at iteration 6: 0.3733974358974359
	Val acc at iteration 5: 0.3404255319148936
	Train acc at iteration 7: 0.34294871794871795
	Val acc at iteration 6: 0.46808510638297873
	Train acc at iteration 8: 0.3557692307692308
	Val acc at iteration 7: 0.3829787234042553
	Train acc at iteration 9: 0.36538461538461536
	Val acc at iteration 8: 0.39361702127659576
	Train acc at iteration 10: 0.44551282051282054
	Val acc at iteration 9: 0.5319148936170213
	Train acc at iteration 11: 0.4423076923076923
	Val acc at iteration 10: 0.44680851063829785
	Train acc at iteration 12: 0.46153846153846156
	Val acc at iteration 11: 0.574468085106383
	Train acc at iteration 13: 0.4583333333333333
	Val acc at iteration 12: 0.48936170212765956
	Train acc at iteration 14: 0.4983974358974359
	Val acc at iteration 13: 0.5638297872340425
	Train acc at iteration 15: 0.5016025641025641
	Val acc at iteration 14: 0.5425531914893617
	Train acc at iteration 16: 0.5641025641025641
	Val acc at iteration 15: 0.6595744680851063
	Train acc at iteration 17: 0.5512820512820513
	Val acc at iteration 16: 0.5851063829787234
	Train acc at iteration 18: 0.5080128205128205
	Val acc at iteration 17: 0.5425531914893617
	Train acc at iteration 19: 0.5288461538461539
	Val acc at iteration 18: 0.5531914893617021
	Train acc at iteration 20: 0.5496794871794872
	Val acc at iteration 19: 0.6170212765957447
	Train acc at iteration 21: 0.5625
	Val acc at iteration 20: 0.5957446808510638
	Train acc at iteration 22: 0.5496794871794872
	Val acc at iteration 21: 0.6595744680851063
	Train acc at iteration 23: 0.5737179487179487
	Val acc at iteration 22: 0.5638297872340425
	Train acc at iteration 24: 0.5352564102564102
	Val acc at iteration 23: 0.6382978723404256
	Train acc at iteration 25: 0.5705128205128205
	Val acc at iteration 24: 0.6595744680851063
	Train acc at iteration 26: 0.5753205128205128
	Val acc at iteration 25: 0.6808510638297872
	Train acc at iteration 27: 0.5961538461538461
	Val acc at iteration 26: 0.6276595744680851
	Train acc at iteration 28: 0.5737179487179487
	Val acc at iteration 27: 0.648936170212766
	Train acc at iteration 29: 0.625
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.6266025641025641
	Val acc at iteration 29: 0.6382978723404256
	Train acc at iteration 31: 0.5977564102564102
	Val acc at iteration 30: 0.723404255319149
	Train acc at iteration 32: 0.6282051282051282
	Val acc at iteration 31: 0.7021276595744681
	Train acc at iteration 33: 0.6073717948717948
	Val acc at iteration 32: 0.7127659574468085
	Train acc at iteration 34: 0.6169871794871795
	Val acc at iteration 33: 0.6702127659574468
	Train acc at iteration 35: 0.6266025641025641
	Val acc at iteration 34: 0.7340425531914894
	Train acc at iteration 36: 0.6009615384615384
	Val acc at iteration 35: 0.7659574468085106
	Train acc at iteration 37: 0.6169871794871795
	Val acc at iteration 36: 0.6702127659574468
	Train acc at iteration 38: 0.6217948717948718
	Val acc at iteration 37: 0.6914893617021277
	Train acc at iteration 39: 0.5993589743589743
	Val acc at iteration 38: 0.6595744680851063
	Train acc at iteration 40: 0.6105769230769231
	Val acc at iteration 39: 0.7872340425531915
	Train acc at iteration 41: 0.655448717948718
	Val acc at iteration 40: 0.7127659574468085
	Train acc at iteration 42: 0.6762820512820513
	Val acc at iteration 41: 0.648936170212766
	Train acc at iteration 43: 0.6586538461538461
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.6458333333333334
	Val acc at iteration 43: 0.7127659574468085
	Train acc at iteration 45: 0.6490384615384616
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.6939102564102564
	Val acc at iteration 45: 0.7446808510638298
	Train acc at iteration 47: 0.6714743589743589
	Val acc at iteration 46: 0.723404255319149
	Train acc at iteration 48: 0.7083333333333334
	Val acc at iteration 47: 0.7659574468085106
	Train acc at iteration 49: 0.6955128205128205
	Val acc at iteration 48: 0.7021276595744681
	Train acc at iteration 50: 0.6762820512820513
	Val acc at iteration 49: 0.648936170212766
	Train acc at iteration 51: 0.6362179487179487
	Val acc at iteration 50: 0.7340425531914894
	Train acc at iteration 52: 0.6698717948717948
	Val acc at iteration 51: 0.6595744680851063
	Train acc at iteration 53: 0.6602564102564102
	Val acc at iteration 52: 0.7446808510638298
	Train acc at iteration 54: 0.6746794871794872
	Val acc at iteration 53: 0.6808510638297872
	Train acc at iteration 55: 0.6474358974358975
	Val acc at iteration 54: 0.7446808510638298
	Train acc at iteration 56: 0.6923076923076923
	Val acc at iteration 55: 0.8085106382978723
	Train acc at iteration 57: 0.6891025641025641
	Val acc at iteration 56: 0.6702127659574468
	Train acc at iteration 58: 0.6746794871794872
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.6842948717948718
	Val acc at iteration 58: 0.7659574468085106
	Train acc at iteration 60: 0.6586538461538461
	Val acc at iteration 59: 0.7021276595744681
	Train acc at iteration 61: 0.6746794871794872
	Val acc at iteration 60: 0.7021276595744681
	Train acc at iteration 62: 0.6650641025641025
	Val acc at iteration 61: 0.8297872340425532
	Train acc at iteration 63: 0.6778846153846154
	Val acc at iteration 62: 0.7446808510638298
	Train acc at iteration 64: 0.6522435897435898
	Val acc at iteration 63: 0.6702127659574468
	Train acc at iteration 65: 0.6746794871794872
	Val acc at iteration 64: 0.7446808510638298
	Train acc at iteration 66: 0.6875
	Val acc at iteration 65: 0.7659574468085106
	Train acc at iteration 67: 0.6826923076923077
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.6923076923076923
	Val acc at iteration 67: 0.7340425531914894
	Train acc at iteration 69: 0.6875
	Val acc at iteration 68: 0.8085106382978723
	Train acc at iteration 70: 0.719551282051282
	Val acc at iteration 69: 0.6914893617021277
	Train acc at iteration 71: 0.6778846153846154
	Val acc at iteration 70: 0.8085106382978723
	Train acc at iteration 72: 0.6794871794871795
	Val acc at iteration 71: 0.7021276595744681
	Train acc at iteration 73: 0.7035256410256411
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.6858974358974359
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.719551282051282
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.7259615384615384
	Val acc at iteration 75: 0.7127659574468085
	Train acc at iteration 77: 0.717948717948718
	Val acc at iteration 76: 0.7978723404255319
	Train acc at iteration 78: 0.7083333333333334
	Val acc at iteration 77: 0.7127659574468085
	Train acc at iteration 79: 0.6858974358974359
	Val acc at iteration 78: 0.6702127659574468
	Train acc at iteration 80: 0.7083333333333334
	Val acc at iteration 79: 0.7127659574468085
	Train acc at iteration 81: 0.7163461538461539
	Val acc at iteration 80: 0.6914893617021277
	Train acc at iteration 82: 0.7243589743589743
	Val acc at iteration 81: 0.7553191489361702
	Train acc at iteration 83: 0.7291666666666666
	Val acc at iteration 82: 0.7127659574468085
	Train acc at iteration 84: 0.7275641025641025
	Val acc at iteration 83: 0.6276595744680851
	Train acc at iteration 85: 0.7227564102564102
	Val acc at iteration 84: 0.6170212765957447
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.620274914089347
Final val micro accuracy: 0.7340425531914894
Final test macro f1-score: 0.5797619047619048
Final test micro accuracy: 0.7021276595744681
Final validation:
	Cluster: 0.6287712752819061
	Separation: 0.5454054772853851
Final test:
	Cluster: 0.5863932967185974
	Separation: 0.5399252772331238
Saved Results

Attempting combination 4/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.01
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6063829787234043
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9574468085106383
Push epoch
After push, before retraining last layer:
	Train acc: 0.7644230769230769
	Train Cluster: 0.6458889245986938
	Train Separation: 0.5183865785598755
(Directly after push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6382978723404256
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.7659574468085106
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.5957446808510638
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.6276595744680851
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.7872340425531915
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.6702127659574468
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.8297872340425532
	Val acc at iteration 52: 0.7553191489361702
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.776595744680851
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.8085106382978723
	Val acc at iteration 64: 0.7659574468085106
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.776595744680851
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7872340425531915
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9680851063829787
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Train Cluster: 0.6552655458450317
	Train Separation: 0.5237626791000366
(Directly after push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7872340425531915
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.8085106382978723
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.7872340425531915
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.7872340425531915
	Val acc at iteration 14: 0.7446808510638298
	Val acc at iteration 15: 0.776595744680851
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7978723404255319
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7553191489361702
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.7978723404255319
	Val acc at iteration 30: 0.776595744680851
	Val acc at iteration 31: 0.851063829787234
	Val acc at iteration 32: 0.7872340425531915
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7659574468085106
	Val acc at iteration 36: 0.8191489361702128
	Val acc at iteration 37: 0.776595744680851
	Val acc at iteration 38: 0.7872340425531915
	Val acc at iteration 39: 0.776595744680851
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.8404255319148937
	Val acc at iteration 44: 0.7978723404255319
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.7872340425531915
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.7978723404255319
	Val acc at iteration 50: 0.7978723404255319
	Val acc at iteration 51: 0.8085106382978723
	Val acc at iteration 52: 0.8085106382978723
	Val acc at iteration 53: 0.776595744680851
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7659574468085106
	Val acc at iteration 60: 0.776595744680851
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.776595744680851
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.8085106382978723
	Val acc at iteration 71: 0.7872340425531915
	Val acc at iteration 72: 0.8191489361702128
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.776595744680851
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7340425531914894
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.8085106382978723
	Val acc at iteration 82: 0.7978723404255319
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7872340425531915
Val acc before epoch 25: 0.7553191489361702
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8573717948717948
	Train Cluster: 0.6496945023536682
	TrainSeparation: 0.519294023513794
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.01
	Train acc at iteration 1: 0.7740384615384616
	Val acc at iteration 0: 0.6914893617021277
	Train acc at iteration 2: 0.7291666666666666
	Val acc at iteration 1: 0.6595744680851063
	Train acc at iteration 3: 0.6939102564102564
	Val acc at iteration 2: 0.7127659574468085
	Train acc at iteration 4: 0.7067307692307693
	Val acc at iteration 3: 0.723404255319149
	Train acc at iteration 5: 0.6490384615384616
	Val acc at iteration 4: 0.6276595744680851
	Train acc at iteration 6: 0.7003205128205128
	Val acc at iteration 5: 0.6702127659574468
	Train acc at iteration 7: 0.6458333333333334
	Val acc at iteration 6: 0.6382978723404256
	Train acc at iteration 8: 0.6682692307692307
	Val acc at iteration 7: 0.7021276595744681
	Train acc at iteration 9: 0.7227564102564102
	Val acc at iteration 8: 0.648936170212766
	Train acc at iteration 10: 0.7131410256410257
	Val acc at iteration 9: 0.7021276595744681
	Train acc at iteration 11: 0.7019230769230769
	Val acc at iteration 10: 0.7021276595744681
	Train acc at iteration 12: 0.7291666666666666
	Val acc at iteration 11: 0.6382978723404256
	Train acc at iteration 13: 0.6987179487179487
	Val acc at iteration 12: 0.7340425531914894
	Train acc at iteration 14: 0.7291666666666666
	Val acc at iteration 13: 0.7340425531914894
	Train acc at iteration 15: 0.7692307692307693
	Val acc at iteration 14: 0.7553191489361702
	Train acc at iteration 16: 0.7596153846153846
	Val acc at iteration 15: 0.6595744680851063
	Train acc at iteration 17: 0.7435897435897436
	Val acc at iteration 16: 0.6914893617021277
	Train acc at iteration 18: 0.7451923076923077
	Val acc at iteration 17: 0.723404255319149
	Train acc at iteration 19: 0.7660256410256411
	Val acc at iteration 18: 0.776595744680851
	Train acc at iteration 20: 0.7644230769230769
	Val acc at iteration 19: 0.8085106382978723
	Train acc at iteration 21: 0.7692307692307693
	Val acc at iteration 20: 0.7340425531914894
	Train acc at iteration 22: 0.7612179487179487
	Val acc at iteration 21: 0.7978723404255319
	Train acc at iteration 23: 0.7708333333333334
	Val acc at iteration 22: 0.8617021276595744
	Train acc at iteration 24: 0.8141025641025641
	Val acc at iteration 23: 0.7553191489361702
	Train acc at iteration 25: 0.7724358974358975
	Val acc at iteration 24: 0.7659574468085106
	Train acc at iteration 26: 0.782051282051282
	Val acc at iteration 25: 0.7553191489361702
	Train acc at iteration 27: 0.782051282051282
	Val acc at iteration 26: 0.723404255319149
	Train acc at iteration 28: 0.7660256410256411
	Val acc at iteration 27: 0.7446808510638298
	Train acc at iteration 29: 0.780448717948718
	Val acc at iteration 28: 0.7978723404255319
	Train acc at iteration 30: 0.8060897435897436
	Val acc at iteration 29: 0.8085106382978723
	Train acc at iteration 31: 0.7483974358974359
	Val acc at iteration 30: 0.7978723404255319
	Train acc at iteration 32: 0.7852564102564102
	Val acc at iteration 31: 0.851063829787234
	Train acc at iteration 33: 0.7964743589743589
	Val acc at iteration 32: 0.7872340425531915
	Train acc at iteration 34: 0.8205128205128205
	Val acc at iteration 33: 0.723404255319149
	Train acc at iteration 35: 0.8333333333333334
	Val acc at iteration 34: 0.7872340425531915
	Train acc at iteration 36: 0.8012820512820513
	Val acc at iteration 35: 0.8191489361702128
	Train acc at iteration 37: 0.8157051282051282
	Val acc at iteration 36: 0.7553191489361702
	Train acc at iteration 38: 0.8092948717948718
	Val acc at iteration 37: 0.8191489361702128
	Train acc at iteration 39: 0.8413461538461539
	Val acc at iteration 38: 0.7659574468085106
	Train acc at iteration 40: 0.7916666666666666
	Val acc at iteration 39: 0.776595744680851
	Train acc at iteration 41: 0.8221153846153846
	Val acc at iteration 40: 0.8191489361702128
	Train acc at iteration 42: 0.8221153846153846
	Val acc at iteration 41: 0.8297872340425532
	Train acc at iteration 43: 0.8413461538461539
	Val acc at iteration 42: 0.8191489361702128
	Train acc at iteration 44: 0.8301282051282052
	Val acc at iteration 43: 0.7978723404255319
	Train acc at iteration 45: 0.8317307692307693
	Val acc at iteration 44: 0.8297872340425532
	Train acc at iteration 46: 0.8317307692307693
	Val acc at iteration 45: 0.7978723404255319
	Train acc at iteration 47: 0.8028846153846154
	Val acc at iteration 46: 0.7872340425531915
	Train acc at iteration 48: 0.8365384615384616
	Val acc at iteration 47: 0.7872340425531915
	Train acc at iteration 49: 0.8076923076923077
	Val acc at iteration 48: 0.8085106382978723
	Train acc at iteration 50: 0.8285256410256411
	Val acc at iteration 49: 0.8617021276595744
	Train acc at iteration 51: 0.8317307692307693
	Val acc at iteration 50: 0.8617021276595744
	Train acc at iteration 52: 0.8605769230769231
	Val acc at iteration 51: 0.8404255319148937
	Train acc at iteration 53: 0.8461538461538461
	Val acc at iteration 52: 0.8936170212765957
	Train acc at iteration 54: 0.8461538461538461
	Val acc at iteration 53: 0.776595744680851
	Train acc at iteration 55: 0.844551282051282
	Val acc at iteration 54: 0.8617021276595744
	Train acc at iteration 56: 0.8365384615384616
	Val acc at iteration 55: 0.9042553191489362
	Train acc at iteration 57: 0.8173076923076923
	Val acc at iteration 56: 0.851063829787234
	Train acc at iteration 58: 0.8573717948717948
	Val acc at iteration 57: 0.8085106382978723
	Train acc at iteration 59: 0.8413461538461539
	Val acc at iteration 58: 0.8617021276595744
	Train acc at iteration 60: 0.8365384615384616
	Val acc at iteration 59: 0.851063829787234
	Train acc at iteration 61: 0.8317307692307693
	Val acc at iteration 60: 0.851063829787234
	Train acc at iteration 62: 0.8349358974358975
	Val acc at iteration 61: 0.8617021276595744
	Train acc at iteration 63: 0.8541666666666666
	Val acc at iteration 62: 0.8829787234042553
	Train acc at iteration 64: 0.8605769230769231
	Val acc at iteration 63: 0.8936170212765957
	Train acc at iteration 65: 0.8621794871794872
	Val acc at iteration 64: 0.8617021276595744
	Train acc at iteration 66: 0.8782051282051282
	Val acc at iteration 65: 0.8723404255319149
	Train acc at iteration 67: 0.8733974358974359
	Val acc at iteration 66: 0.8297872340425532
	Train acc at iteration 68: 0.8669871794871795
	Val acc at iteration 67: 0.8617021276595744
	Train acc at iteration 69: 0.8509615384615384
	Val acc at iteration 68: 0.8297872340425532
	Train acc at iteration 70: 0.8493589743589743
	Val acc at iteration 69: 0.7978723404255319
	Train acc at iteration 71: 0.8237179487179487
	Val acc at iteration 70: 0.851063829787234
	Train acc at iteration 72: 0.8637820512820513
	Val acc at iteration 71: 0.8404255319148937
	Train acc at iteration 73: 0.8525641025641025
	Val acc at iteration 72: 0.8723404255319149
	Train acc at iteration 74: 0.844551282051282
	Val acc at iteration 73: 0.8404255319148937
	Train acc at iteration 75: 0.8573717948717948
	Val acc at iteration 74: 0.8297872340425532
	Train acc at iteration 76: 0.8621794871794872
	Val acc at iteration 75: 0.8617021276595744
	Train acc at iteration 77: 0.8493589743589743
	Val acc at iteration 76: 0.925531914893617
	Train acc at iteration 78: 0.8557692307692307
	Val acc at iteration 77: 0.8829787234042553
	Train acc at iteration 79: 0.8605769230769231
	Val acc at iteration 78: 0.8936170212765957
	Train acc at iteration 80: 0.8637820512820513
	Val acc at iteration 79: 0.8723404255319149
	Train acc at iteration 81: 0.8573717948717948
	Val acc at iteration 80: 0.851063829787234
	Train acc at iteration 82: 0.8573717948717948
	Val acc at iteration 81: 0.8191489361702128
	Train acc at iteration 83: 0.8397435897435898
	Val acc at iteration 82: 0.9148936170212766
	Train acc at iteration 84: 0.8413461538461539
	Val acc at iteration 83: 0.9148936170212766
	Train acc at iteration 85: 0.8637820512820513
	Val acc at iteration 84: 0.9042553191489362
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7956989247311828
Final val micro accuracy: 0.8617021276595744
Final test macro f1-score: 0.7218253968253968
Final test micro accuracy: 0.8191489361702128
Final validation:
	Cluster: 0.6435681879520416
	Separation: 0.5510723292827606
Final test:
	Cluster: 0.6072081923484802
	Separation: 0.5428502559661865
Saved Results

Attempting combination 5/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.425531914893617
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7275641025641025
	Train Cluster: 0.6440942287445068
	Train Separation: 0.5234737396240234
(Directly after push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.5531914893617021
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.574468085106383
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.5957446808510638
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.6063829787234043
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6063829787234043
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.6382978723404256
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.6063829787234043
	Val acc at iteration 48: 0.6702127659574468
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.6382978723404256
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 13: 0.7127659574468085
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Train Cluster: 0.6443224668502807
	Train Separation: 0.5179298639297485
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.7872340425531915
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7553191489361702
	Val acc at iteration 5: 0.776595744680851
	Val acc at iteration 6: 0.7978723404255319
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.7978723404255319
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.7978723404255319
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.7553191489361702
	Val acc at iteration 14: 0.8191489361702128
	Val acc at iteration 15: 0.8085106382978723
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.7872340425531915
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.7978723404255319
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7872340425531915
	Val acc at iteration 28: 0.7978723404255319
	Val acc at iteration 29: 0.7872340425531915
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.7659574468085106
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.776595744680851
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.7978723404255319
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.7553191489361702
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.7872340425531915
	Val acc at iteration 51: 0.8191489361702128
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.8617021276595744
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.7872340425531915
	Val acc at iteration 62: 0.776595744680851
	Val acc at iteration 63: 0.8297872340425532
	Val acc at iteration 64: 0.8085106382978723
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.7978723404255319
	Val acc at iteration 70: 0.7978723404255319
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.8404255319148937
	Val acc at iteration 77: 0.7659574468085106
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.8297872340425532
	Val acc at iteration 81: 0.7978723404255319
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.7978723404255319
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8461538461538461
	Train Cluster: 0.6543897747993469
	TrainSeparation: 0.5210840106010437
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.005
	Train acc at iteration 1: 0.8141025641025641
	Val acc at iteration 0: 0.7127659574468085
	Train acc at iteration 2: 0.8028846153846154
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.7708333333333334
	Val acc at iteration 2: 0.723404255319149
	Train acc at iteration 4: 0.7532051282051282
	Val acc at iteration 3: 0.6914893617021277
	Train acc at iteration 5: 0.7692307692307693
	Val acc at iteration 4: 0.723404255319149
	Train acc at iteration 6: 0.7836538461538461
	Val acc at iteration 5: 0.7446808510638298
	Train acc at iteration 7: 0.7724358974358975
	Val acc at iteration 6: 0.6914893617021277
	Train acc at iteration 8: 0.782051282051282
	Val acc at iteration 7: 0.7340425531914894
	Train acc at iteration 9: 0.7788461538461539
	Val acc at iteration 8: 0.723404255319149
	Train acc at iteration 10: 0.7612179487179487
	Val acc at iteration 9: 0.7978723404255319
	Train acc at iteration 11: 0.780448717948718
	Val acc at iteration 10: 0.7127659574468085
	Train acc at iteration 12: 0.7740384615384616
	Val acc at iteration 11: 0.7553191489361702
	Train acc at iteration 13: 0.8012820512820513
	Val acc at iteration 12: 0.7446808510638298
	Train acc at iteration 14: 0.8076923076923077
	Val acc at iteration 13: 0.7978723404255319
	Train acc at iteration 15: 0.7916666666666666
	Val acc at iteration 14: 0.776595744680851
	Train acc at iteration 16: 0.8060897435897436
	Val acc at iteration 15: 0.7872340425531915
	Train acc at iteration 17: 0.7980769230769231
	Val acc at iteration 16: 0.8085106382978723
	Train acc at iteration 18: 0.8173076923076923
	Val acc at iteration 17: 0.7659574468085106
	Train acc at iteration 19: 0.8044871794871795
	Val acc at iteration 18: 0.7340425531914894
	Train acc at iteration 20: 0.7644230769230769
	Val acc at iteration 19: 0.723404255319149
	Train acc at iteration 21: 0.7836538461538461
	Val acc at iteration 20: 0.7872340425531915
	Train acc at iteration 22: 0.8205128205128205
	Val acc at iteration 21: 0.7872340425531915
	Train acc at iteration 23: 0.8189102564102564
	Val acc at iteration 22: 0.7978723404255319
	Train acc at iteration 24: 0.8092948717948718
	Val acc at iteration 23: 0.723404255319149
	Train acc at iteration 25: 0.7916666666666666
	Val acc at iteration 24: 0.8085106382978723
	Train acc at iteration 26: 0.8012820512820513
	Val acc at iteration 25: 0.8297872340425532
	Train acc at iteration 27: 0.7868589743589743
	Val acc at iteration 26: 0.8085106382978723
	Train acc at iteration 28: 0.8285256410256411
	Val acc at iteration 27: 0.8085106382978723
	Train acc at iteration 29: 0.8092948717948718
	Val acc at iteration 28: 0.723404255319149
	Train acc at iteration 30: 0.8397435897435898
	Val acc at iteration 29: 0.776595744680851
	Train acc at iteration 31: 0.8253205128205128
	Val acc at iteration 30: 0.7446808510638298
	Train acc at iteration 32: 0.8173076923076923
	Val acc at iteration 31: 0.723404255319149
	Train acc at iteration 33: 0.8076923076923077
	Val acc at iteration 32: 0.7659574468085106
	Train acc at iteration 34: 0.8285256410256411
	Val acc at iteration 33: 0.8297872340425532
	Train acc at iteration 35: 0.8141025641025641
	Val acc at iteration 34: 0.776595744680851
	Train acc at iteration 36: 0.8157051282051282
	Val acc at iteration 35: 0.8085106382978723
	Train acc at iteration 37: 0.842948717948718
	Val acc at iteration 36: 0.7872340425531915
	Train acc at iteration 38: 0.8349358974358975
	Val acc at iteration 37: 0.8191489361702128
	Train acc at iteration 39: 0.8301282051282052
	Val acc at iteration 38: 0.8936170212765957
	Train acc at iteration 40: 0.8237179487179487
	Val acc at iteration 39: 0.7978723404255319
	Train acc at iteration 41: 0.8157051282051282
	Val acc at iteration 40: 0.8085106382978723
	Train acc at iteration 42: 0.8349358974358975
	Val acc at iteration 41: 0.776595744680851
	Train acc at iteration 43: 0.8669871794871795
	Val acc at iteration 42: 0.8191489361702128
	Train acc at iteration 44: 0.844551282051282
	Val acc at iteration 43: 0.7978723404255319
	Train acc at iteration 45: 0.8237179487179487
	Val acc at iteration 44: 0.7978723404255319
	Train acc at iteration 46: 0.8637820512820513
	Val acc at iteration 45: 0.8404255319148937
	Train acc at iteration 47: 0.8381410256410257
	Val acc at iteration 46: 0.8297872340425532
	Train acc at iteration 48: 0.8044871794871795
	Val acc at iteration 47: 0.776595744680851
	Train acc at iteration 49: 0.8381410256410257
	Val acc at iteration 48: 0.851063829787234
	Train acc at iteration 50: 0.8349358974358975
	Val acc at iteration 49: 0.7978723404255319
	Train acc at iteration 51: 0.8766025641025641
	Val acc at iteration 50: 0.7872340425531915
	Train acc at iteration 52: 0.8397435897435898
	Val acc at iteration 51: 0.8085106382978723
	Train acc at iteration 53: 0.8349358974358975
	Val acc at iteration 52: 0.8191489361702128
	Train acc at iteration 54: 0.8365384615384616
	Val acc at iteration 53: 0.8191489361702128
	Train acc at iteration 55: 0.8125
	Val acc at iteration 54: 0.8404255319148937
	Train acc at iteration 56: 0.8605769230769231
	Val acc at iteration 55: 0.851063829787234
	Train acc at iteration 57: 0.8461538461538461
	Val acc at iteration 56: 0.8297872340425532
	Train acc at iteration 58: 0.8557692307692307
	Val acc at iteration 57: 0.8085106382978723
	Train acc at iteration 59: 0.8637820512820513
	Val acc at iteration 58: 0.8297872340425532
	Train acc at iteration 60: 0.8525641025641025
	Val acc at iteration 59: 0.8297872340425532
	Train acc at iteration 61: 0.8669871794871795
	Val acc at iteration 60: 0.8297872340425532
	Train acc at iteration 62: 0.8846153846153846
	Val acc at iteration 61: 0.8297872340425532
	Train acc at iteration 63: 0.8285256410256411
	Val acc at iteration 62: 0.8297872340425532
	Train acc at iteration 64: 0.8637820512820513
	Val acc at iteration 63: 0.851063829787234
	Train acc at iteration 65: 0.8493589743589743
	Val acc at iteration 64: 0.8723404255319149
	Train acc at iteration 66: 0.8541666666666666
	Val acc at iteration 65: 0.8404255319148937
	Train acc at iteration 67: 0.842948717948718
	Val acc at iteration 66: 0.8829787234042553
	Train acc at iteration 68: 0.8509615384615384
	Val acc at iteration 67: 0.8829787234042553
	Train acc at iteration 69: 0.8717948717948718
	Val acc at iteration 68: 0.8404255319148937
	Train acc at iteration 70: 0.8637820512820513
	Val acc at iteration 69: 0.8297872340425532
	Train acc at iteration 71: 0.8365384615384616
	Val acc at iteration 70: 0.8829787234042553
	Train acc at iteration 72: 0.8221153846153846
	Val acc at iteration 71: 0.8617021276595744
	Train acc at iteration 73: 0.8894230769230769
	Val acc at iteration 72: 0.8404255319148937
	Train acc at iteration 74: 0.8685897435897436
	Val acc at iteration 73: 0.8936170212765957
	Train acc at iteration 75: 0.8798076923076923
	Val acc at iteration 74: 0.851063829787234
	Train acc at iteration 76: 0.8477564102564102
	Val acc at iteration 75: 0.8829787234042553
	Train acc at iteration 77: 0.8493589743589743
	Val acc at iteration 76: 0.8404255319148937
	Train acc at iteration 78: 0.8637820512820513
	Val acc at iteration 77: 0.8085106382978723
	Train acc at iteration 79: 0.8846153846153846
	Val acc at iteration 78: 0.8404255319148937
	Train acc at iteration 80: 0.8557692307692307
	Val acc at iteration 79: 0.8617021276595744
	Train acc at iteration 81: 0.8814102564102564
	Val acc at iteration 80: 0.8617021276595744
	Train acc at iteration 82: 0.8493589743589743
	Val acc at iteration 81: 0.8404255319148937
	Train acc at iteration 83: 0.8733974358974359
	Val acc at iteration 82: 0.8829787234042553
	Train acc at iteration 84: 0.8701923076923077
	Val acc at iteration 83: 0.8936170212765957
	Train acc at iteration 85: 0.8653846153846154
	Val acc at iteration 84: 0.8404255319148937
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7383512544802866
Final val micro accuracy: 0.8297872340425532
Final test macro f1-score: 0.6945833333333333
Final test micro accuracy: 0.7872340425531915
Final validation:
	Cluster: 0.6332067549228668
	Separation: 0.5446729362010956
Final test:
	Cluster: 0.6026935577392578
	Separation: 0.538418173789978
Saved Results

Attempting combination 6/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7872340425531915
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7948717948717948
	Train Cluster: 0.6549403429031372
	Train Separation: 0.5203514099121094
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.6170212765957447
	Val acc at iteration 15: 0.6063829787234043
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.5957446808510638
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.7872340425531915
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7659574468085106
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.776595744680851
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.6276595744680851
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.6170212765957447
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7659574468085106
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.7872340425531915
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6595744680851063
Val acc before epoch 13: 0.7021276595744681
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8085106382978723
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.8125
	Train Cluster: 0.6461367845535279
	Train Separation: 0.5190231204032898
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.776595744680851
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.7659574468085106
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.776595744680851
	Val acc at iteration 16: 0.7659574468085106
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.776595744680851
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.7872340425531915
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.7659574468085106
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.7978723404255319
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.7978723404255319
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7978723404255319
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.7978723404255319
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.8085106382978723
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.8085106382978723
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7978723404255319
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.8404255319148937
	Val acc at iteration 63: 0.776595744680851
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.7978723404255319
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.7659574468085106
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7872340425531915
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.7446808510638298
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.8191489361702128
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9787234042553191
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.6495331406593323
	TrainSeparation: 0.5210198044776917
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.001
	Train acc at iteration 1: 0.8125
	Val acc at iteration 0: 0.7446808510638298
	Train acc at iteration 2: 0.8493589743589743
	Val acc at iteration 1: 0.6702127659574468
	Train acc at iteration 3: 0.8237179487179487
	Val acc at iteration 2: 0.6914893617021277
	Train acc at iteration 4: 0.8301282051282052
	Val acc at iteration 3: 0.8085106382978723
	Train acc at iteration 5: 0.8189102564102564
	Val acc at iteration 4: 0.7978723404255319
	Train acc at iteration 6: 0.8253205128205128
	Val acc at iteration 5: 0.7659574468085106
	Train acc at iteration 7: 0.8125
	Val acc at iteration 6: 0.7978723404255319
	Train acc at iteration 8: 0.8237179487179487
	Val acc at iteration 7: 0.776595744680851
	Train acc at iteration 9: 0.8285256410256411
	Val acc at iteration 8: 0.7978723404255319
	Train acc at iteration 10: 0.8397435897435898
	Val acc at iteration 9: 0.8085106382978723
	Train acc at iteration 11: 0.8461538461538461
	Val acc at iteration 10: 0.7978723404255319
	Train acc at iteration 12: 0.8413461538461539
	Val acc at iteration 11: 0.7553191489361702
	Train acc at iteration 13: 0.8349358974358975
	Val acc at iteration 12: 0.7021276595744681
	Train acc at iteration 14: 0.8141025641025641
	Val acc at iteration 13: 0.7872340425531915
	Train acc at iteration 15: 0.8237179487179487
	Val acc at iteration 14: 0.723404255319149
	Train acc at iteration 16: 0.8413461538461539
	Val acc at iteration 15: 0.8297872340425532
	Train acc at iteration 17: 0.8461538461538461
	Val acc at iteration 16: 0.7659574468085106
	Train acc at iteration 18: 0.8189102564102564
	Val acc at iteration 17: 0.7872340425531915
	Train acc at iteration 19: 0.8221153846153846
	Val acc at iteration 18: 0.7659574468085106
	Train acc at iteration 20: 0.842948717948718
	Val acc at iteration 19: 0.7978723404255319
	Train acc at iteration 21: 0.8461538461538461
	Val acc at iteration 20: 0.7659574468085106
	Train acc at iteration 22: 0.8285256410256411
	Val acc at iteration 21: 0.7127659574468085
	Train acc at iteration 23: 0.8141025641025641
	Val acc at iteration 22: 0.7872340425531915
	Train acc at iteration 24: 0.8717948717948718
	Val acc at iteration 23: 0.7659574468085106
	Train acc at iteration 25: 0.8461538461538461
	Val acc at iteration 24: 0.7872340425531915
	Train acc at iteration 26: 0.8413461538461539
	Val acc at iteration 25: 0.7446808510638298
	Train acc at iteration 27: 0.8253205128205128
	Val acc at iteration 26: 0.7446808510638298
	Train acc at iteration 28: 0.8397435897435898
	Val acc at iteration 27: 0.776595744680851
	Train acc at iteration 29: 0.8461538461538461
	Val acc at iteration 28: 0.7446808510638298
	Train acc at iteration 30: 0.8589743589743589
	Val acc at iteration 29: 0.7659574468085106
	Train acc at iteration 31: 0.8333333333333334
	Val acc at iteration 30: 0.7978723404255319
	Train acc at iteration 32: 0.8621794871794872
	Val acc at iteration 31: 0.776595744680851
	Train acc at iteration 33: 0.8381410256410257
	Val acc at iteration 32: 0.7446808510638298
	Train acc at iteration 34: 0.8413461538461539
	Val acc at iteration 33: 0.7553191489361702
	Train acc at iteration 35: 0.8685897435897436
	Val acc at iteration 34: 0.7659574468085106
	Train acc at iteration 36: 0.8301282051282052
	Val acc at iteration 35: 0.7978723404255319
	Train acc at iteration 37: 0.8317307692307693
	Val acc at iteration 36: 0.8617021276595744
	Train acc at iteration 38: 0.8317307692307693
	Val acc at iteration 37: 0.7340425531914894
	Train acc at iteration 39: 0.8205128205128205
	Val acc at iteration 38: 0.776595744680851
	Train acc at iteration 40: 0.8285256410256411
	Val acc at iteration 39: 0.7340425531914894
	Train acc at iteration 41: 0.8397435897435898
	Val acc at iteration 40: 0.7978723404255319
	Train acc at iteration 42: 0.8573717948717948
	Val acc at iteration 41: 0.7659574468085106
	Train acc at iteration 43: 0.8493589743589743
	Val acc at iteration 42: 0.723404255319149
	Train acc at iteration 44: 0.8381410256410257
	Val acc at iteration 43: 0.8297872340425532
	Train acc at iteration 45: 0.8365384615384616
	Val acc at iteration 44: 0.8191489361702128
	Train acc at iteration 46: 0.8397435897435898
	Val acc at iteration 45: 0.8085106382978723
	Train acc at iteration 47: 0.8397435897435898
	Val acc at iteration 46: 0.7553191489361702
	Train acc at iteration 48: 0.8509615384615384
	Val acc at iteration 47: 0.7127659574468085
	Train acc at iteration 49: 0.8509615384615384
	Val acc at iteration 48: 0.7553191489361702
	Train acc at iteration 50: 0.8669871794871795
	Val acc at iteration 49: 0.7127659574468085
	Train acc at iteration 51: 0.8413461538461539
	Val acc at iteration 50: 0.723404255319149
	Train acc at iteration 52: 0.8397435897435898
	Val acc at iteration 51: 0.7659574468085106
	Train acc at iteration 53: 0.8349358974358975
	Val acc at iteration 52: 0.8404255319148937
	Train acc at iteration 54: 0.8685897435897436
	Val acc at iteration 53: 0.7553191489361702
	Train acc at iteration 55: 0.8237179487179487
	Val acc at iteration 54: 0.8404255319148937
	Train acc at iteration 56: 0.8269230769230769
	Val acc at iteration 55: 0.8936170212765957
	Train acc at iteration 57: 0.8365384615384616
	Val acc at iteration 56: 0.776595744680851
	Train acc at iteration 58: 0.8413461538461539
	Val acc at iteration 57: 0.8191489361702128
	Train acc at iteration 59: 0.844551282051282
	Val acc at iteration 58: 0.8297872340425532
	Train acc at iteration 60: 0.844551282051282
	Val acc at iteration 59: 0.723404255319149
	Train acc at iteration 61: 0.8413461538461539
	Val acc at iteration 60: 0.8297872340425532
	Train acc at iteration 62: 0.8333333333333334
	Val acc at iteration 61: 0.8191489361702128
	Train acc at iteration 63: 0.8397435897435898
	Val acc at iteration 62: 0.7872340425531915
	Train acc at iteration 64: 0.8477564102564102
	Val acc at iteration 63: 0.8617021276595744
	Train acc at iteration 65: 0.8349358974358975
	Val acc at iteration 64: 0.7553191489361702
	Train acc at iteration 66: 0.8397435897435898
	Val acc at iteration 65: 0.7340425531914894
	Train acc at iteration 67: 0.8509615384615384
	Val acc at iteration 66: 0.7978723404255319
	Train acc at iteration 68: 0.8573717948717948
	Val acc at iteration 67: 0.7978723404255319
	Train acc at iteration 69: 0.8525641025641025
	Val acc at iteration 68: 0.8297872340425532
	Train acc at iteration 70: 0.8461538461538461
	Val acc at iteration 69: 0.7872340425531915
	Train acc at iteration 71: 0.8461538461538461
	Val acc at iteration 70: 0.7978723404255319
	Train acc at iteration 72: 0.8108974358974359
	Val acc at iteration 71: 0.7978723404255319
	Train acc at iteration 73: 0.8653846153846154
	Val acc at iteration 72: 0.8085106382978723
	Train acc at iteration 74: 0.8637820512820513
	Val acc at iteration 73: 0.776595744680851
	Train acc at iteration 75: 0.8509615384615384
	Val acc at iteration 74: 0.7446808510638298
	Train acc at iteration 76: 0.8397435897435898
	Val acc at iteration 75: 0.7446808510638298
	Train acc at iteration 77: 0.8253205128205128
	Val acc at iteration 76: 0.851063829787234
	Train acc at iteration 78: 0.8477564102564102
	Val acc at iteration 77: 0.7659574468085106
	Train acc at iteration 79: 0.842948717948718
	Val acc at iteration 78: 0.723404255319149
	Train acc at iteration 80: 0.8589743589743589
	Val acc at iteration 79: 0.8617021276595744
	Train acc at iteration 81: 0.8269230769230769
	Val acc at iteration 80: 0.8085106382978723
	Train acc at iteration 82: 0.8669871794871795
	Val acc at iteration 81: 0.7659574468085106
	Train acc at iteration 83: 0.8605769230769231
	Val acc at iteration 82: 0.7659574468085106
	Train acc at iteration 84: 0.8541666666666666
	Val acc at iteration 83: 0.7446808510638298
	Train acc at iteration 85: 0.8573717948717948
	Val acc at iteration 84: 0.7978723404255319
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7074468085106383
Final val micro accuracy: 0.7978723404255319
Final test macro f1-score: 0.6473251028806584
Final test micro accuracy: 0.7340425531914894
Final validation:
	Cluster: 0.6324391961097717
	Separation: 0.5427873730659485
Final test:
	Cluster: 0.6075896918773651
	Separation: 0.535002589225769
Saved Results

Attempting combination 7/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5212765957446809
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.6467320084571838
	Train Separation: 0.5249469637870788
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5638297872340425
	Val acc at iteration 1: 0.5638297872340425
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.7446808510638298
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.7659574468085106
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.7659574468085106
	Val acc at iteration 14: 0.7446808510638298
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.7659574468085106
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.7659574468085106
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.7553191489361702
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.776595744680851
	Val acc at iteration 40: 0.7553191489361702
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7872340425531915
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.7978723404255319
	Val acc at iteration 54: 0.776595744680851
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.7978723404255319
	Val acc at iteration 58: 0.648936170212766
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.7978723404255319
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7872340425531915
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.7872340425531915
	Val acc at iteration 70: 0.8085106382978723
	Val acc at iteration 71: 0.776595744680851
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.7659574468085106
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.7978723404255319
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.7659574468085106
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 13: 0.7872340425531915
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8085106382978723
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8349358974358975
	Train Cluster: 0.643438458442688
	Train Separation: 0.5201616406440734
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.8404255319148937
	Val acc at iteration 1: 0.7659574468085106
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.7872340425531915
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.7872340425531915
	Val acc at iteration 7: 0.7872340425531915
	Val acc at iteration 8: 0.7553191489361702
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.7978723404255319
	Val acc at iteration 11: 0.851063829787234
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.7659574468085106
	Val acc at iteration 15: 0.8085106382978723
	Val acc at iteration 16: 0.8297872340425532
	Val acc at iteration 17: 0.8297872340425532
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.776595744680851
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.8085106382978723
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.8617021276595744
	Val acc at iteration 25: 0.8085106382978723
	Val acc at iteration 26: 0.7553191489361702
	Val acc at iteration 27: 0.7978723404255319
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.8191489361702128
	Val acc at iteration 32: 0.7872340425531915
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.8191489361702128
	Val acc at iteration 35: 0.7978723404255319
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.7659574468085106
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.7978723404255319
	Val acc at iteration 43: 0.7872340425531915
	Val acc at iteration 44: 0.7978723404255319
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.776595744680851
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.8297872340425532
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.8297872340425532
	Val acc at iteration 53: 0.7978723404255319
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.8297872340425532
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.851063829787234
	Val acc at iteration 60: 0.7978723404255319
	Val acc at iteration 61: 0.8191489361702128
	Val acc at iteration 62: 0.7978723404255319
	Val acc at iteration 63: 0.7978723404255319
	Val acc at iteration 64: 0.8191489361702128
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.7978723404255319
	Val acc at iteration 67: 0.8085106382978723
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.8723404255319149
	Val acc at iteration 73: 0.8085106382978723
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.776595744680851
	Val acc at iteration 76: 0.8617021276595744
	Val acc at iteration 77: 0.8191489361702128
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.8191489361702128
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.8297872340425532
Val acc before epoch 25: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9680851063829787
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8381410256410257
	Train Cluster: 0.6451519012451172
	TrainSeparation: 0.521524167060852
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.0005
	Train acc at iteration 1: 0.8493589743589743
	Val acc at iteration 0: 0.8085106382978723
	Train acc at iteration 2: 0.8461538461538461
	Val acc at iteration 1: 0.8085106382978723
	Train acc at iteration 3: 0.8557692307692307
	Val acc at iteration 2: 0.776595744680851
	Train acc at iteration 4: 0.8237179487179487
	Val acc at iteration 3: 0.7978723404255319
	Train acc at iteration 5: 0.8669871794871795
	Val acc at iteration 4: 0.8723404255319149
	Train acc at iteration 6: 0.8637820512820513
	Val acc at iteration 5: 0.7659574468085106
	Train acc at iteration 7: 0.8237179487179487
	Val acc at iteration 6: 0.8191489361702128
	Train acc at iteration 8: 0.8589743589743589
	Val acc at iteration 7: 0.8191489361702128
	Train acc at iteration 9: 0.8237179487179487
	Val acc at iteration 8: 0.7978723404255319
	Train acc at iteration 10: 0.8269230769230769
	Val acc at iteration 9: 0.7978723404255319
	Train acc at iteration 11: 0.8397435897435898
	Val acc at iteration 10: 0.7978723404255319
	Train acc at iteration 12: 0.8317307692307693
	Val acc at iteration 11: 0.8085106382978723
	Train acc at iteration 13: 0.8365384615384616
	Val acc at iteration 12: 0.7446808510638298
	Train acc at iteration 14: 0.8365384615384616
	Val acc at iteration 13: 0.7659574468085106
	Train acc at iteration 15: 0.8477564102564102
	Val acc at iteration 14: 0.7872340425531915
	Train acc at iteration 16: 0.8509615384615384
	Val acc at iteration 15: 0.776595744680851
	Train acc at iteration 17: 0.8557692307692307
	Val acc at iteration 16: 0.7659574468085106
	Train acc at iteration 18: 0.8573717948717948
	Val acc at iteration 17: 0.7872340425531915
	Train acc at iteration 19: 0.8605769230769231
	Val acc at iteration 18: 0.8404255319148937
	Train acc at iteration 20: 0.8365384615384616
	Val acc at iteration 19: 0.8085106382978723
	Train acc at iteration 21: 0.8509615384615384
	Val acc at iteration 20: 0.8191489361702128
	Train acc at iteration 22: 0.8317307692307693
	Val acc at iteration 21: 0.851063829787234
	Train acc at iteration 23: 0.8477564102564102
	Val acc at iteration 22: 0.7978723404255319
	Train acc at iteration 24: 0.8301282051282052
	Val acc at iteration 23: 0.7872340425531915
	Train acc at iteration 25: 0.8589743589743589
	Val acc at iteration 24: 0.8085106382978723
	Train acc at iteration 26: 0.842948717948718
	Val acc at iteration 25: 0.7872340425531915
	Train acc at iteration 27: 0.8605769230769231
	Val acc at iteration 26: 0.8297872340425532
	Train acc at iteration 28: 0.8589743589743589
	Val acc at iteration 27: 0.7872340425531915
	Train acc at iteration 29: 0.8333333333333334
	Val acc at iteration 28: 0.776595744680851
	Train acc at iteration 30: 0.842948717948718
	Val acc at iteration 29: 0.776595744680851
	Train acc at iteration 31: 0.8349358974358975
	Val acc at iteration 30: 0.7978723404255319
	Train acc at iteration 32: 0.8205128205128205
	Val acc at iteration 31: 0.7446808510638298
	Train acc at iteration 33: 0.8365384615384616
	Val acc at iteration 32: 0.8085106382978723
	Train acc at iteration 34: 0.8301282051282052
	Val acc at iteration 33: 0.8085106382978723
	Train acc at iteration 35: 0.844551282051282
	Val acc at iteration 34: 0.8191489361702128
	Train acc at iteration 36: 0.8221153846153846
	Val acc at iteration 35: 0.7446808510638298
	Train acc at iteration 37: 0.8365384615384616
	Val acc at iteration 36: 0.8191489361702128
	Train acc at iteration 38: 0.842948717948718
	Val acc at iteration 37: 0.8085106382978723
	Train acc at iteration 39: 0.8461538461538461
	Val acc at iteration 38: 0.8085106382978723
	Train acc at iteration 40: 0.8397435897435898
	Val acc at iteration 39: 0.7446808510638298
	Train acc at iteration 41: 0.8525641025641025
	Val acc at iteration 40: 0.7872340425531915
	Train acc at iteration 42: 0.8060897435897436
	Val acc at iteration 41: 0.7978723404255319
	Train acc at iteration 43: 0.8557692307692307
	Val acc at iteration 42: 0.8617021276595744
	Train acc at iteration 44: 0.8733974358974359
	Val acc at iteration 43: 0.8404255319148937
	Train acc at iteration 45: 0.8509615384615384
	Val acc at iteration 44: 0.723404255319149
	Train acc at iteration 46: 0.8461538461538461
	Val acc at iteration 45: 0.7553191489361702
	Train acc at iteration 47: 0.8365384615384616
	Val acc at iteration 46: 0.7978723404255319
	Train acc at iteration 48: 0.8461538461538461
	Val acc at iteration 47: 0.8297872340425532
	Train acc at iteration 49: 0.8397435897435898
	Val acc at iteration 48: 0.776595744680851
	Train acc at iteration 50: 0.8557692307692307
	Val acc at iteration 49: 0.7553191489361702
	Train acc at iteration 51: 0.8285256410256411
	Val acc at iteration 50: 0.8191489361702128
	Train acc at iteration 52: 0.8493589743589743
	Val acc at iteration 51: 0.7978723404255319
	Train acc at iteration 53: 0.8381410256410257
	Val acc at iteration 52: 0.7659574468085106
	Train acc at iteration 54: 0.8333333333333334
	Val acc at iteration 53: 0.7553191489361702
	Train acc at iteration 55: 0.8477564102564102
	Val acc at iteration 54: 0.776595744680851
	Train acc at iteration 56: 0.8605769230769231
	Val acc at iteration 55: 0.8829787234042553
	Train acc at iteration 57: 0.8108974358974359
	Val acc at iteration 56: 0.7872340425531915
	Train acc at iteration 58: 0.8461538461538461
	Val acc at iteration 57: 0.8297872340425532
	Train acc at iteration 59: 0.8397435897435898
	Val acc at iteration 58: 0.8723404255319149
	Train acc at iteration 60: 0.8477564102564102
	Val acc at iteration 59: 0.7978723404255319
	Train acc at iteration 61: 0.8317307692307693
	Val acc at iteration 60: 0.7872340425531915
	Train acc at iteration 62: 0.8477564102564102
	Val acc at iteration 61: 0.776595744680851
	Train acc at iteration 63: 0.8685897435897436
	Val acc at iteration 62: 0.8297872340425532
	Train acc at iteration 64: 0.844551282051282
	Val acc at iteration 63: 0.8297872340425532
	Train acc at iteration 65: 0.8365384615384616
	Val acc at iteration 64: 0.7553191489361702
	Train acc at iteration 66: 0.8253205128205128
	Val acc at iteration 65: 0.7872340425531915
	Train acc at iteration 67: 0.8349358974358975
	Val acc at iteration 66: 0.776595744680851
	Train acc at iteration 68: 0.8509615384615384
	Val acc at iteration 67: 0.8297872340425532
	Train acc at iteration 69: 0.8637820512820513
	Val acc at iteration 68: 0.7872340425531915
	Train acc at iteration 70: 0.8717948717948718
	Val acc at iteration 69: 0.8191489361702128
	Train acc at iteration 71: 0.8766025641025641
	Val acc at iteration 70: 0.8191489361702128
	Train acc at iteration 72: 0.844551282051282
	Val acc at iteration 71: 0.7553191489361702
	Train acc at iteration 73: 0.8317307692307693
	Val acc at iteration 72: 0.7659574468085106
	Train acc at iteration 74: 0.844551282051282
	Val acc at iteration 73: 0.8297872340425532
	Train acc at iteration 75: 0.842948717948718
	Val acc at iteration 74: 0.7659574468085106
	Train acc at iteration 76: 0.8477564102564102
	Val acc at iteration 75: 0.8297872340425532
	Train acc at iteration 77: 0.8717948717948718
	Val acc at iteration 76: 0.7659574468085106
	Train acc at iteration 78: 0.8589743589743589
	Val acc at iteration 77: 0.8297872340425532
	Train acc at iteration 79: 0.8637820512820513
	Val acc at iteration 78: 0.8404255319148937
	Train acc at iteration 80: 0.8253205128205128
	Val acc at iteration 79: 0.8191489361702128
	Train acc at iteration 81: 0.8557692307692307
	Val acc at iteration 80: 0.8085106382978723
	Train acc at iteration 82: 0.8557692307692307
	Val acc at iteration 81: 0.8404255319148937
	Train acc at iteration 83: 0.8477564102564102
	Val acc at iteration 82: 0.7553191489361702
	Train acc at iteration 84: 0.8269230769230769
	Val acc at iteration 83: 0.8297872340425532
	Train acc at iteration 85: 0.8477564102564102
	Val acc at iteration 84: 0.7872340425531915
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6932624113475176
Final val micro accuracy: 0.7872340425531915
Final test macro f1-score: 0.5553113553113553
Final test micro accuracy: 0.6914893617021277
Final validation:
	Cluster: 0.6160301268100739
	Separation: 0.5433984994888306
Final test:
	Cluster: 0.6061215996742249
	Separation: 0.5392406582832336
Saved Results

Attempting combination 8/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6914893617021277
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Train Cluster: 0.6444753408432007
	Train Separation: 0.515969979763031
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6382978723404256
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.5851063829787234
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.6276595744680851
	Val acc at iteration 13: 0.6170212765957447
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.5957446808510638
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.5957446808510638
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6276595744680851
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.776595744680851
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.6063829787234043
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6170212765957447
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.6702127659574468
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.6170212765957447
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.6170212765957447
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.5957446808510638
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.6808510638297872
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7659574468085106
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6702127659574468
Val acc before epoch 13: 0.6702127659574468
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8092948717948718
	Train Cluster: 0.6512363672256469
	Train Separation: 0.5236670970916748
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.776595744680851
	Val acc at iteration 4: 0.776595744680851
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.7872340425531915
	Val acc at iteration 7: 0.776595744680851
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.7659574468085106
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.8085106382978723
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.7872340425531915
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.7872340425531915
	Val acc at iteration 32: 0.7659574468085106
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.7446808510638298
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.7872340425531915
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.8297872340425532
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.7872340425531915
	Val acc at iteration 46: 0.8085106382978723
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.7872340425531915
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.776595744680851
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7872340425531915
	Val acc at iteration 60: 0.7872340425531915
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.6382978723404256
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.8085106382978723
	Val acc at iteration 69: 0.7872340425531915
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.8191489361702128
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.8191489361702128
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8573717948717948
	Train Cluster: 0.6484035730361939
	TrainSeparation: 0.5230041384696961
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: 0.0001
	Train acc at iteration 1: 0.8173076923076923
	Val acc at iteration 0: 0.7659574468085106
	Train acc at iteration 2: 0.844551282051282
	Val acc at iteration 1: 0.7340425531914894
	Train acc at iteration 3: 0.8253205128205128
	Val acc at iteration 2: 0.7340425531914894
	Train acc at iteration 4: 0.8125
	Val acc at iteration 3: 0.7446808510638298
	Train acc at iteration 5: 0.8333333333333334
	Val acc at iteration 4: 0.7340425531914894
	Train acc at iteration 6: 0.8413461538461539
	Val acc at iteration 5: 0.7446808510638298
	Train acc at iteration 7: 0.8269230769230769
	Val acc at iteration 6: 0.776595744680851
	Train acc at iteration 8: 0.8397435897435898
	Val acc at iteration 7: 0.776595744680851
	Train acc at iteration 9: 0.842948717948718
	Val acc at iteration 8: 0.7340425531914894
	Train acc at iteration 10: 0.8269230769230769
	Val acc at iteration 9: 0.7021276595744681
	Train acc at iteration 11: 0.8125
	Val acc at iteration 10: 0.7553191489361702
	Train acc at iteration 12: 0.8397435897435898
	Val acc at iteration 11: 0.8085106382978723
	Train acc at iteration 13: 0.8189102564102564
	Val acc at iteration 12: 0.723404255319149
	Train acc at iteration 14: 0.8125
	Val acc at iteration 13: 0.7659574468085106
	Train acc at iteration 15: 0.8285256410256411
	Val acc at iteration 14: 0.776595744680851
	Train acc at iteration 16: 0.8269230769230769
	Val acc at iteration 15: 0.7553191489361702
	Train acc at iteration 17: 0.8269230769230769
	Val acc at iteration 16: 0.7446808510638298
	Train acc at iteration 18: 0.8141025641025641
	Val acc at iteration 17: 0.7872340425531915
	Train acc at iteration 19: 0.8461538461538461
	Val acc at iteration 18: 0.7127659574468085
	Train acc at iteration 20: 0.8044871794871795
	Val acc at iteration 19: 0.723404255319149
	Train acc at iteration 21: 0.8413461538461539
	Val acc at iteration 20: 0.7659574468085106
	Train acc at iteration 22: 0.8477564102564102
	Val acc at iteration 21: 0.776595744680851
	Train acc at iteration 23: 0.8108974358974359
	Val acc at iteration 22: 0.7553191489361702
	Train acc at iteration 24: 0.8541666666666666
	Val acc at iteration 23: 0.7659574468085106
	Train acc at iteration 25: 0.8461538461538461
	Val acc at iteration 24: 0.7978723404255319
	Train acc at iteration 26: 0.8365384615384616
	Val acc at iteration 25: 0.776595744680851
	Train acc at iteration 27: 0.8076923076923077
	Val acc at iteration 26: 0.7127659574468085
	Train acc at iteration 28: 0.8333333333333334
	Val acc at iteration 27: 0.7553191489361702
	Train acc at iteration 29: 0.8381410256410257
	Val acc at iteration 28: 0.8297872340425532
	Train acc at iteration 30: 0.8397435897435898
	Val acc at iteration 29: 0.8191489361702128
	Train acc at iteration 31: 0.8317307692307693
	Val acc at iteration 30: 0.6914893617021277
	Train acc at iteration 32: 0.8253205128205128
	Val acc at iteration 31: 0.7340425531914894
	Train acc at iteration 33: 0.8637820512820513
	Val acc at iteration 32: 0.851063829787234
	Train acc at iteration 34: 0.8493589743589743
	Val acc at iteration 33: 0.776595744680851
	Train acc at iteration 35: 0.8301282051282052
	Val acc at iteration 34: 0.7340425531914894
	Train acc at iteration 36: 0.8477564102564102
	Val acc at iteration 35: 0.7978723404255319
	Train acc at iteration 37: 0.8541666666666666
	Val acc at iteration 36: 0.8297872340425532
	Train acc at iteration 38: 0.8157051282051282
	Val acc at iteration 37: 0.7553191489361702
	Train acc at iteration 39: 0.8349358974358975
	Val acc at iteration 38: 0.7446808510638298
	Train acc at iteration 40: 0.842948717948718
	Val acc at iteration 39: 0.7872340425531915
	Train acc at iteration 41: 0.8108974358974359
	Val acc at iteration 40: 0.7553191489361702
	Train acc at iteration 42: 0.8509615384615384
	Val acc at iteration 41: 0.7872340425531915
	Train acc at iteration 43: 0.8413461538461539
	Val acc at iteration 42: 0.776595744680851
	Train acc at iteration 44: 0.8461538461538461
	Val acc at iteration 43: 0.7872340425531915
	Train acc at iteration 45: 0.8397435897435898
	Val acc at iteration 44: 0.723404255319149
	Train acc at iteration 46: 0.8317307692307693
	Val acc at iteration 45: 0.7553191489361702
	Train acc at iteration 47: 0.842948717948718
	Val acc at iteration 46: 0.776595744680851
	Train acc at iteration 48: 0.8573717948717948
	Val acc at iteration 47: 0.8085106382978723
	Train acc at iteration 49: 0.8493589743589743
	Val acc at iteration 48: 0.7446808510638298
	Train acc at iteration 50: 0.8173076923076923
	Val acc at iteration 49: 0.8085106382978723
	Train acc at iteration 51: 0.8317307692307693
	Val acc at iteration 50: 0.776595744680851
	Train acc at iteration 52: 0.8381410256410257
	Val acc at iteration 51: 0.7978723404255319
	Train acc at iteration 53: 0.8189102564102564
	Val acc at iteration 52: 0.7021276595744681
	Train acc at iteration 54: 0.8493589743589743
	Val acc at iteration 53: 0.776595744680851
	Train acc at iteration 55: 0.8076923076923077
	Val acc at iteration 54: 0.7659574468085106
	Train acc at iteration 56: 0.8525641025641025
	Val acc at iteration 55: 0.776595744680851
	Train acc at iteration 57: 0.7964743589743589
	Val acc at iteration 56: 0.7872340425531915
	Train acc at iteration 58: 0.8317307692307693
	Val acc at iteration 57: 0.7659574468085106
	Train acc at iteration 59: 0.8221153846153846
	Val acc at iteration 58: 0.7659574468085106
	Train acc at iteration 60: 0.8157051282051282
	Val acc at iteration 59: 0.7021276595744681
	Train acc at iteration 61: 0.8477564102564102
	Val acc at iteration 60: 0.8297872340425532
	Train acc at iteration 62: 0.8349358974358975
	Val acc at iteration 61: 0.7659574468085106
	Train acc at iteration 63: 0.8237179487179487
	Val acc at iteration 62: 0.7553191489361702
	Train acc at iteration 64: 0.8461538461538461
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.8221153846153846
	Val acc at iteration 64: 0.7446808510638298
	Train acc at iteration 66: 0.8413461538461539
	Val acc at iteration 65: 0.7659574468085106
	Train acc at iteration 67: 0.8381410256410257
	Val acc at iteration 66: 0.776595744680851
	Train acc at iteration 68: 0.8253205128205128
	Val acc at iteration 67: 0.7340425531914894
	Train acc at iteration 69: 0.8477564102564102
	Val acc at iteration 68: 0.7340425531914894
	Train acc at iteration 70: 0.8413461538461539
	Val acc at iteration 69: 0.776595744680851
	Train acc at iteration 71: 0.8108974358974359
	Val acc at iteration 70: 0.7340425531914894
	Train acc at iteration 72: 0.8349358974358975
	Val acc at iteration 71: 0.723404255319149
	Train acc at iteration 73: 0.8365384615384616
	Val acc at iteration 72: 0.7659574468085106
	Train acc at iteration 74: 0.8365384615384616
	Val acc at iteration 73: 0.776595744680851
	Train acc at iteration 75: 0.8413461538461539
	Val acc at iteration 74: 0.8297872340425532
	Train acc at iteration 76: 0.8493589743589743
	Val acc at iteration 75: 0.7446808510638298
	Train acc at iteration 77: 0.8141025641025641
	Val acc at iteration 76: 0.8085106382978723
	Train acc at iteration 78: 0.8365384615384616
	Val acc at iteration 77: 0.8191489361702128
	Train acc at iteration 79: 0.8477564102564102
	Val acc at iteration 78: 0.7872340425531915
	Train acc at iteration 80: 0.8349358974358975
	Val acc at iteration 79: 0.7553191489361702
	Train acc at iteration 81: 0.8685897435897436
	Val acc at iteration 80: 0.7340425531914894
	Train acc at iteration 82: 0.8461538461538461
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.8333333333333334
	Val acc at iteration 82: 0.776595744680851
	Train acc at iteration 84: 0.8285256410256411
	Val acc at iteration 83: 0.723404255319149
	Train acc at iteration 85: 0.8173076923076923
	Val acc at iteration 84: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6879432624113474
Final val micro accuracy: 0.776595744680851
Final test macro f1-score: 0.6156862745098038
Final test micro accuracy: 0.7021276595744681
Final validation:
	Cluster: 0.6167879700660706
	Separation: 0.5341298282146454
Final test:
	Cluster: 0.5907630026340485
	Separation: 0.5349363684654236
Saved Results

Attempting combination 9/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 5e-05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7596153846153846
	Train Cluster: 0.6460660815238952
	Train Separation: 0.520400094985962
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6170212765957447
	Val acc at iteration 5: 0.5957446808510638
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6276595744680851
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.7553191489361702
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.8085106382978723
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.8085106382978723
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.7659574468085106
	Val acc at iteration 68: 0.7872340425531915
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.776595744680851
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7553191489361702
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.8085106382978723
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.8191489361702128
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.8301282051282052
	Train Cluster: 0.653435742855072
	Train Separation: 0.5238470792770386
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7978723404255319
	Val acc at iteration 1: 0.7978723404255319
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.7553191489361702
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.851063829787234
	Val acc at iteration 11: 0.7978723404255319
	Val acc at iteration 12: 0.776595744680851
	Val acc at iteration 13: 0.776595744680851
	Val acc at iteration 14: 0.7659574468085106
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.7872340425531915
	Val acc at iteration 17: 0.776595744680851
	Val acc at iteration 18: 0.8297872340425532
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.776595744680851
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.7872340425531915
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.8085106382978723
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.7659574468085106
	Val acc at iteration 31: 0.7553191489361702
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.8297872340425532
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.776595744680851
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.7978723404255319
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.8085106382978723
	Val acc at iteration 49: 0.8191489361702128
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.776595744680851
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7872340425531915
	Val acc at iteration 58: 0.7978723404255319
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.8085106382978723
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.8085106382978723
	Val acc at iteration 63: 0.7978723404255319
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.7978723404255319
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.8085106382978723
	Val acc at iteration 68: 0.7872340425531915
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.8191489361702128
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.8085106382978723
	Val acc at iteration 76: 0.776595744680851
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.7872340425531915
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.8085106382978723
Val acc before epoch 25: 0.7446808510638298
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8589743589743589
	Train Cluster: 0.6547576665878296
	TrainSeparation: 0.5192115426063537
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 5e-05
	Train acc at iteration 1: 0.8621794871794872
	Val acc at iteration 0: 0.776595744680851
	Train acc at iteration 2: 0.8189102564102564
	Val acc at iteration 1: 0.7446808510638298
	Train acc at iteration 3: 0.8413461538461539
	Val acc at iteration 2: 0.7553191489361702
	Train acc at iteration 4: 0.8221153846153846
	Val acc at iteration 3: 0.8085106382978723
	Train acc at iteration 5: 0.8189102564102564
	Val acc at iteration 4: 0.7978723404255319
	Train acc at iteration 6: 0.8349358974358975
	Val acc at iteration 5: 0.7659574468085106
	Train acc at iteration 7: 0.8317307692307693
	Val acc at iteration 6: 0.7872340425531915
	Train acc at iteration 8: 0.8573717948717948
	Val acc at iteration 7: 0.7553191489361702
	Train acc at iteration 9: 0.8269230769230769
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8381410256410257
	Val acc at iteration 9: 0.7659574468085106
	Train acc at iteration 11: 0.8685897435897436
	Val acc at iteration 10: 0.7659574468085106
	Train acc at iteration 12: 0.8397435897435898
	Val acc at iteration 11: 0.776595744680851
	Train acc at iteration 13: 0.8285256410256411
	Val acc at iteration 12: 0.8191489361702128
	Train acc at iteration 14: 0.8253205128205128
	Val acc at iteration 13: 0.7872340425531915
	Train acc at iteration 15: 0.8557692307692307
	Val acc at iteration 14: 0.8085106382978723
	Train acc at iteration 16: 0.8397435897435898
	Val acc at iteration 15: 0.7446808510638298
	Train acc at iteration 17: 0.8381410256410257
	Val acc at iteration 16: 0.7340425531914894
	Train acc at iteration 18: 0.8349358974358975
	Val acc at iteration 17: 0.7340425531914894
	Train acc at iteration 19: 0.8060897435897436
	Val acc at iteration 18: 0.7127659574468085
	Train acc at iteration 20: 0.842948717948718
	Val acc at iteration 19: 0.7021276595744681
	Train acc at iteration 21: 0.8317307692307693
	Val acc at iteration 20: 0.7872340425531915
	Train acc at iteration 22: 0.8413461538461539
	Val acc at iteration 21: 0.7978723404255319
	Train acc at iteration 23: 0.842948717948718
	Val acc at iteration 22: 0.776595744680851
	Train acc at iteration 24: 0.8413461538461539
	Val acc at iteration 23: 0.7127659574468085
	Train acc at iteration 25: 0.8365384615384616
	Val acc at iteration 24: 0.7553191489361702
	Train acc at iteration 26: 0.842948717948718
	Val acc at iteration 25: 0.7659574468085106
	Train acc at iteration 27: 0.8541666666666666
	Val acc at iteration 26: 0.776595744680851
	Train acc at iteration 28: 0.8413461538461539
	Val acc at iteration 27: 0.7659574468085106
	Train acc at iteration 29: 0.8317307692307693
	Val acc at iteration 28: 0.7659574468085106
	Train acc at iteration 30: 0.8076923076923077
	Val acc at iteration 29: 0.7659574468085106
	Train acc at iteration 31: 0.8333333333333334
	Val acc at iteration 30: 0.7978723404255319
	Train acc at iteration 32: 0.8317307692307693
	Val acc at iteration 31: 0.7872340425531915
	Train acc at iteration 33: 0.8221153846153846
	Val acc at iteration 32: 0.8085106382978723
	Train acc at iteration 34: 0.8269230769230769
	Val acc at iteration 33: 0.7872340425531915
	Train acc at iteration 35: 0.8333333333333334
	Val acc at iteration 34: 0.8191489361702128
	Train acc at iteration 36: 0.842948717948718
	Val acc at iteration 35: 0.7872340425531915
	Train acc at iteration 37: 0.8461538461538461
	Val acc at iteration 36: 0.8191489361702128
	Train acc at iteration 38: 0.8125
	Val acc at iteration 37: 0.8085106382978723
	Train acc at iteration 39: 0.8205128205128205
	Val acc at iteration 38: 0.8191489361702128
	Train acc at iteration 40: 0.8525641025641025
	Val acc at iteration 39: 0.776595744680851
	Train acc at iteration 41: 0.8173076923076923
	Val acc at iteration 40: 0.8404255319148937
	Train acc at iteration 42: 0.8637820512820513
	Val acc at iteration 41: 0.8191489361702128
	Train acc at iteration 43: 0.8381410256410257
	Val acc at iteration 42: 0.8085106382978723
	Train acc at iteration 44: 0.844551282051282
	Val acc at iteration 43: 0.7340425531914894
	Train acc at iteration 45: 0.8381410256410257
	Val acc at iteration 44: 0.7872340425531915
	Train acc at iteration 46: 0.8173076923076923
	Val acc at iteration 45: 0.8085106382978723
	Train acc at iteration 47: 0.8397435897435898
	Val acc at iteration 46: 0.8085106382978723
	Train acc at iteration 48: 0.8397435897435898
	Val acc at iteration 47: 0.7553191489361702
	Train acc at iteration 49: 0.8189102564102564
	Val acc at iteration 48: 0.8085106382978723
	Train acc at iteration 50: 0.8237179487179487
	Val acc at iteration 49: 0.7872340425531915
	Train acc at iteration 51: 0.8605769230769231
	Val acc at iteration 50: 0.723404255319149
	Train acc at iteration 52: 0.8301282051282052
	Val acc at iteration 51: 0.8297872340425532
	Train acc at iteration 53: 0.8413461538461539
	Val acc at iteration 52: 0.7659574468085106
	Train acc at iteration 54: 0.8285256410256411
	Val acc at iteration 53: 0.776595744680851
	Train acc at iteration 55: 0.8381410256410257
	Val acc at iteration 54: 0.7978723404255319
	Train acc at iteration 56: 0.842948717948718
	Val acc at iteration 55: 0.7446808510638298
	Train acc at iteration 57: 0.842948717948718
	Val acc at iteration 56: 0.7446808510638298
	Train acc at iteration 58: 0.8413461538461539
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.8205128205128205
	Val acc at iteration 58: 0.7446808510638298
	Train acc at iteration 60: 0.8541666666666666
	Val acc at iteration 59: 0.776595744680851
	Train acc at iteration 61: 0.8285256410256411
	Val acc at iteration 60: 0.8404255319148937
	Train acc at iteration 62: 0.8413461538461539
	Val acc at iteration 61: 0.7659574468085106
	Train acc at iteration 63: 0.8397435897435898
	Val acc at iteration 62: 0.8191489361702128
	Train acc at iteration 64: 0.842948717948718
	Val acc at iteration 63: 0.8297872340425532
	Train acc at iteration 65: 0.8493589743589743
	Val acc at iteration 64: 0.6914893617021277
	Train acc at iteration 66: 0.8413461538461539
	Val acc at iteration 65: 0.7446808510638298
	Train acc at iteration 67: 0.8349358974358975
	Val acc at iteration 66: 0.7978723404255319
	Train acc at iteration 68: 0.8493589743589743
	Val acc at iteration 67: 0.8085106382978723
	Train acc at iteration 69: 0.8333333333333334
	Val acc at iteration 68: 0.8617021276595744
	Train acc at iteration 70: 0.8365384615384616
	Val acc at iteration 69: 0.776595744680851
	Train acc at iteration 71: 0.8301282051282052
	Val acc at iteration 70: 0.7978723404255319
	Train acc at iteration 72: 0.8301282051282052
	Val acc at iteration 71: 0.7553191489361702
	Train acc at iteration 73: 0.8269230769230769
	Val acc at iteration 72: 0.7659574468085106
	Train acc at iteration 74: 0.8301282051282052
	Val acc at iteration 73: 0.8191489361702128
	Train acc at iteration 75: 0.8461538461538461
	Val acc at iteration 74: 0.776595744680851
	Train acc at iteration 76: 0.8221153846153846
	Val acc at iteration 75: 0.7340425531914894
	Train acc at iteration 77: 0.8397435897435898
	Val acc at iteration 76: 0.8404255319148937
	Train acc at iteration 78: 0.8397435897435898
	Val acc at iteration 77: 0.7978723404255319
	Train acc at iteration 79: 0.8285256410256411
	Val acc at iteration 78: 0.7446808510638298
	Train acc at iteration 80: 0.8397435897435898
	Val acc at iteration 79: 0.7978723404255319
	Train acc at iteration 81: 0.8397435897435898
	Val acc at iteration 80: 0.7659574468085106
	Train acc at iteration 82: 0.8333333333333334
	Val acc at iteration 81: 0.7978723404255319
	Train acc at iteration 83: 0.8477564102564102
	Val acc at iteration 82: 0.7446808510638298
	Train acc at iteration 84: 0.8044871794871795
	Val acc at iteration 83: 0.7872340425531915
	Train acc at iteration 85: 0.8253205128205128
	Val acc at iteration 84: 0.7446808510638298
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6475694444444444
Final val micro accuracy: 0.7446808510638298
Final test macro f1-score: 0.6048185941043084
Final test micro accuracy: 0.7127659574468085
Final validation:
	Cluster: 0.6358272433280945
	Separation: 0.5423992872238159
Final test:
	Cluster: 0.6101756691932678
	Separation: 0.5410360991954803
Saved Results

Attempting combination 10/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.425531914893617
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.7872340425531915
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8617021276595744
Push epoch
After push, before retraining last layer:
	Train acc: 0.7884615384615384
	Train Cluster: 0.6396681547164917
	Train Separation: 0.5174572825431824
(Directly after push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5851063829787234
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.574468085106383
	Val acc at iteration 3: 0.574468085106383
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.6170212765957447
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.6063829787234043
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6276595744680851
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6063829787234043
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6063829787234043
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.5957446808510638
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.6170212765957447
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.5957446808510638
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.6170212765957447
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.574468085106383
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6170212765957447
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.6276595744680851
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.5957446808510638
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.6595744680851063
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.648936170212766
	Val acc at iteration 84: 0.6595744680851063
Val acc before epoch 13: 0.6808510638297872
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Train Cluster: 0.6521613717079162
	Train Separation: 0.5191296696662903
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.7446808510638298
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.6382978723404256
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.8085106382978723
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.6382978723404256
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.776595744680851
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.7127659574468085
Val acc before epoch 25: 0.8085106382978723
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.8936170212765957
Stopping after epoch 37.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.875
	Train Cluster: 0.6468596458435059
	TrainSeparation: 0.5144868135452271
(Directly after push) Val acc at iteration 0: 0.8085106382978723
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.1971153846153846
	Val acc at iteration 0: 0.06382978723404255
	Train acc at iteration 2: 0.008012820512820512
	Val acc at iteration 1: 0.010638297872340425
	Train acc at iteration 3: 0.014423076923076924
	Val acc at iteration 2: 0.0425531914893617
	Train acc at iteration 4: 0.009615384615384616
	Val acc at iteration 3: 0.02127659574468085
	Train acc at iteration 5: 0.017628205128205128
	Val acc at iteration 4: 0.0425531914893617
	Train acc at iteration 6: 0.02564102564102564
	Val acc at iteration 5: 0.0
	Train acc at iteration 7: 0.022435897435897436
	Val acc at iteration 6: 0.0425531914893617
	Train acc at iteration 8: 0.03365384615384615
	Val acc at iteration 7: 0.02127659574468085
	Train acc at iteration 9: 0.02403846153846154
	Val acc at iteration 8: 0.0425531914893617
	Train acc at iteration 10: 0.03205128205128205
	Val acc at iteration 9: 0.06382978723404255
	Train acc at iteration 11: 0.027243589743589744
	Val acc at iteration 10: 0.02127659574468085
	Train acc at iteration 12: 0.03365384615384615
	Val acc at iteration 11: 0.05319148936170213
	Train acc at iteration 13: 0.057692307692307696
	Val acc at iteration 12: 0.07446808510638298
	Train acc at iteration 14: 0.05929487179487179
	Val acc at iteration 13: 0.05319148936170213
	Train acc at iteration 15: 0.04487179487179487
	Val acc at iteration 14: 0.05319148936170213
	Train acc at iteration 16: 0.04487179487179487
	Val acc at iteration 15: 0.07446808510638298
	Train acc at iteration 17: 0.04487179487179487
	Val acc at iteration 16: 0.06382978723404255
	Train acc at iteration 18: 0.038461538461538464
	Val acc at iteration 17: 0.09574468085106383
	Train acc at iteration 19: 0.060897435897435896
	Val acc at iteration 18: 0.06382978723404255
	Train acc at iteration 20: 0.07211538461538461
	Val acc at iteration 19: 0.13829787234042554
	Train acc at iteration 21: 0.05929487179487179
	Val acc at iteration 20: 0.06382978723404255
	Train acc at iteration 22: 0.057692307692307696
	Val acc at iteration 21: 0.10638297872340426
	Train acc at iteration 23: 0.10737179487179487
	Val acc at iteration 22: 0.1276595744680851
	Train acc at iteration 24: 0.11217948717948718
	Val acc at iteration 23: 0.18085106382978725
	Train acc at iteration 25: 0.14262820512820512
	Val acc at iteration 24: 0.26595744680851063
	Train acc at iteration 26: 0.15064102564102563
	Val acc at iteration 25: 0.24468085106382978
	Train acc at iteration 27: 0.20993589743589744
	Val acc at iteration 26: 0.2127659574468085
	Train acc at iteration 28: 0.1858974358974359
	Val acc at iteration 27: 0.2765957446808511
	Train acc at iteration 29: 0.25801282051282054
	Val acc at iteration 28: 0.26595744680851063
	Train acc at iteration 30: 0.266025641025641
	Val acc at iteration 29: 0.30851063829787234
	Train acc at iteration 31: 0.2916666666666667
	Val acc at iteration 30: 0.32978723404255317
	Train acc at iteration 32: 0.3092948717948718
	Val acc at iteration 31: 0.32978723404255317
	Train acc at iteration 33: 0.36217948717948717
	Val acc at iteration 32: 0.3723404255319149
	Train acc at iteration 34: 0.42628205128205127
	Val acc at iteration 33: 0.48936170212765956
	Train acc at iteration 35: 0.40705128205128205
	Val acc at iteration 34: 0.48936170212765956
	Train acc at iteration 36: 0.5064102564102564
	Val acc at iteration 35: 0.425531914893617
	Train acc at iteration 37: 0.4791666666666667
	Val acc at iteration 36: 0.5212765957446809
	Train acc at iteration 38: 0.5032051282051282
	Val acc at iteration 37: 0.44680851063829785
	Train acc at iteration 39: 0.4775641025641026
	Val acc at iteration 38: 0.5531914893617021
	Train acc at iteration 40: 0.6025641025641025
	Val acc at iteration 39: 0.48936170212765956
	Train acc at iteration 41: 0.6105769230769231
	Val acc at iteration 40: 0.5425531914893617
	Train acc at iteration 42: 0.5721153846153846
	Val acc at iteration 41: 0.6170212765957447
	Train acc at iteration 43: 0.594551282051282
	Val acc at iteration 42: 0.5638297872340425
	Train acc at iteration 44: 0.6217948717948718
	Val acc at iteration 43: 0.6595744680851063
	Train acc at iteration 45: 0.6282051282051282
	Val acc at iteration 44: 0.48936170212765956
	Train acc at iteration 46: 0.5673076923076923
	Val acc at iteration 45: 0.5106382978723404
	Train acc at iteration 47: 0.6201923076923077
	Val acc at iteration 46: 0.5531914893617021
	Train acc at iteration 48: 0.5897435897435898
	Val acc at iteration 47: 0.6063829787234043
	Train acc at iteration 49: 0.6282051282051282
	Val acc at iteration 48: 0.5851063829787234
	Train acc at iteration 50: 0.6105769230769231
	Val acc at iteration 49: 0.6276595744680851
	Train acc at iteration 51: 0.6330128205128205
	Val acc at iteration 50: 0.4787234042553192
	Train acc at iteration 52: 0.5625
	Val acc at iteration 51: 0.46808510638297873
	Train acc at iteration 53: 0.594551282051282
	Val acc at iteration 52: 0.43617021276595747
	Train acc at iteration 54: 0.5833333333333334
	Val acc at iteration 53: 0.5425531914893617
	Train acc at iteration 55: 0.5400641025641025
	Val acc at iteration 54: 0.574468085106383
	Train acc at iteration 56: 0.5897435897435898
	Val acc at iteration 55: 0.43617021276595747
	Train acc at iteration 57: 0.5096153846153846
	Val acc at iteration 56: 0.5106382978723404
	Train acc at iteration 58: 0.5464743589743589
	Val acc at iteration 57: 0.48936170212765956
	Train acc at iteration 59: 0.5576923076923077
	Val acc at iteration 58: 0.44680851063829785
	Train acc at iteration 60: 0.5689102564102564
	Val acc at iteration 59: 0.3829787234042553
	Train acc at iteration 61: 0.5112179487179487
	Val acc at iteration 60: 0.5531914893617021
	Train acc at iteration 62: 0.5673076923076923
	Val acc at iteration 61: 0.46808510638297873
	Train acc at iteration 63: 0.5192307692307693
	Val acc at iteration 62: 0.5851063829787234
	Train acc at iteration 64: 0.5288461538461539
	Val acc at iteration 63: 0.4787234042553192
	Train acc at iteration 65: 0.530448717948718
	Val acc at iteration 64: 0.3829787234042553
	Train acc at iteration 66: 0.5368589743589743
	Val acc at iteration 65: 0.46808510638297873
	Train acc at iteration 67: 0.5368589743589743
	Val acc at iteration 66: 0.5319148936170213
	Train acc at iteration 68: 0.5336538461538461
	Val acc at iteration 67: 0.48936170212765956
	Train acc at iteration 69: 0.5705128205128205
	Val acc at iteration 68: 0.44680851063829785
	Train acc at iteration 70: 0.46634615384615385
	Val acc at iteration 69: 0.2872340425531915
	Train acc at iteration 71: 0.44711538461538464
	Val acc at iteration 70: 0.32978723404255317
	Train acc at iteration 72: 0.44871794871794873
	Val acc at iteration 71: 0.43617021276595747
	Train acc at iteration 73: 0.5
	Val acc at iteration 72: 0.5106382978723404
	Train acc at iteration 74: 0.46634615384615385
	Val acc at iteration 73: 0.44680851063829785
	Train acc at iteration 75: 0.5016025641025641
	Val acc at iteration 74: 0.48936170212765956
	Train acc at iteration 76: 0.5240384615384616
	Val acc at iteration 75: 0.425531914893617
	Train acc at iteration 77: 0.4935897435897436
	Val acc at iteration 76: 0.48936170212765956
	Train acc at iteration 78: 0.4823717948717949
	Val acc at iteration 77: 0.5
	Train acc at iteration 79: 0.5544871794871795
	Val acc at iteration 78: 0.43617021276595747
	Train acc at iteration 80: 0.5192307692307693
	Val acc at iteration 79: 0.4787234042553192
	Train acc at iteration 81: 0.4855769230769231
	Val acc at iteration 80: 0.5319148936170213
	Train acc at iteration 82: 0.5416666666666666
	Val acc at iteration 81: 0.32978723404255317
	Train acc at iteration 83: 0.483974358974359
	Val acc at iteration 82: 0.44680851063829785
	Train acc at iteration 84: 0.47115384615384615
	Val acc at iteration 83: 0.32978723404255317
	Train acc at iteration 85: 0.453525641025641
	Val acc at iteration 84: 0.5425531914893617
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.42823129251700676
Final val micro accuracy: 0.5425531914893617
Final test macro f1-score: 0.3193686463349385
Final test micro accuracy: 0.425531914893617
Final validation:
	Cluster: 0.617878794670105
	Separation: 0.5318033695220947
Final test:
	Cluster: 0.5883712768554688
	Separation: 0.5362544357776642
Saved Results

Attempting combination 11/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Train Cluster: 0.6554032444953919
	Train Separation: 0.5228679180145264
(Directly after push) Val acc at iteration 0: 0.5638297872340425
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.5851063829787234
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.7659574468085106
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6170212765957447
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.7553191489361702
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.6702127659574468
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.5957446808510638
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.7872340425531915
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.6170212765957447
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.648936170212766
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7021276595744681
Val acc before epoch 13: 0.7446808510638298
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7872340425531915
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.776595744680851
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Train Cluster: 0.6406781077384949
	Train Separation: 0.5201878786087036
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7659574468085106
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.776595744680851
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.7659574468085106
	Val acc at iteration 14: 0.7659574468085106
	Val acc at iteration 15: 0.7872340425531915
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.7659574468085106
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.7872340425531915
	Val acc at iteration 23: 0.7553191489361702
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.7659574468085106
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.7659574468085106
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.8297872340425532
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.776595744680851
	Val acc at iteration 44: 0.776595744680851
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7872340425531915
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.7553191489361702
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.8085106382978723
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.776595744680851
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.776595744680851
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7978723404255319
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.8191489361702128
	Val acc at iteration 74: 0.8404255319148937
	Val acc at iteration 75: 0.7553191489361702
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.8085106382978723
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.7872340425531915
	Val acc at iteration 80: 0.7446808510638298
	Val acc at iteration 81: 0.8191489361702128
	Val acc at iteration 82: 0.8297872340425532
	Val acc at iteration 83: 0.7872340425531915
	Val acc at iteration 84: 0.7872340425531915
Val acc before epoch 25: 0.7659574468085106
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8333333333333334
	Train Cluster: 0.6450911283493042
	TrainSeparation: 0.5171577572822571
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.2644230769230769
	Val acc at iteration 0: 0.11702127659574468
	Train acc at iteration 2: 0.0625
	Val acc at iteration 1: 0.0851063829787234
	Train acc at iteration 3: 0.08173076923076923
	Val acc at iteration 2: 0.06382978723404255
	Train acc at iteration 4: 0.05448717948717949
	Val acc at iteration 3: 0.11702127659574468
	Train acc at iteration 5: 0.0641025641025641
	Val acc at iteration 4: 0.09574468085106383
	Train acc at iteration 6: 0.028846153846153848
	Val acc at iteration 5: 0.0851063829787234
	Train acc at iteration 7: 0.08173076923076923
	Val acc at iteration 6: 0.07446808510638298
	Train acc at iteration 8: 0.08012820512820513
	Val acc at iteration 7: 0.11702127659574468
	Train acc at iteration 9: 0.11538461538461539
	Val acc at iteration 8: 0.0425531914893617
	Train acc at iteration 10: 0.08974358974358974
	Val acc at iteration 9: 0.1702127659574468
	Train acc at iteration 11: 0.14743589743589744
	Val acc at iteration 10: 0.18085106382978725
	Train acc at iteration 12: 0.14423076923076922
	Val acc at iteration 11: 0.1595744680851064
	Train acc at iteration 13: 0.11858974358974358
	Val acc at iteration 12: 0.23404255319148937
	Train acc at iteration 14: 0.1282051282051282
	Val acc at iteration 13: 0.13829787234042554
	Train acc at iteration 15: 0.16987179487179488
	Val acc at iteration 14: 0.2553191489361702
	Train acc at iteration 16: 0.12980769230769232
	Val acc at iteration 15: 0.1276595744680851
	Train acc at iteration 17: 0.1330128205128205
	Val acc at iteration 16: 0.14893617021276595
	Train acc at iteration 18: 0.1282051282051282
	Val acc at iteration 17: 0.23404255319148937
	Train acc at iteration 19: 0.14743589743589744
	Val acc at iteration 18: 0.1595744680851064
	Train acc at iteration 20: 0.1201923076923077
	Val acc at iteration 19: 0.20212765957446807
	Train acc at iteration 21: 0.20993589743589744
	Val acc at iteration 20: 0.09574468085106383
	Train acc at iteration 22: 0.14262820512820512
	Val acc at iteration 21: 0.1595744680851064
	Train acc at iteration 23: 0.20673076923076922
	Val acc at iteration 22: 0.2553191489361702
	Train acc at iteration 24: 0.17147435897435898
	Val acc at iteration 23: 0.1276595744680851
	Train acc at iteration 25: 0.20833333333333334
	Val acc at iteration 24: 0.11702127659574468
	Train acc at iteration 26: 0.23717948717948717
	Val acc at iteration 25: 0.3723404255319149
	Train acc at iteration 27: 0.22596153846153846
	Val acc at iteration 26: 0.2765957446808511
	Train acc at iteration 28: 0.26121794871794873
	Val acc at iteration 27: 0.3829787234042553
	Train acc at iteration 29: 0.3173076923076923
	Val acc at iteration 28: 0.3723404255319149
	Train acc at iteration 30: 0.3974358974358974
	Val acc at iteration 29: 0.2978723404255319
	Train acc at iteration 31: 0.34935897435897434
	Val acc at iteration 30: 0.3829787234042553
	Train acc at iteration 32: 0.34134615384615385
	Val acc at iteration 31: 0.40425531914893614
	Train acc at iteration 33: 0.36698717948717946
	Val acc at iteration 32: 0.3191489361702128
	Train acc at iteration 34: 0.34134615384615385
	Val acc at iteration 33: 0.35106382978723405
	Train acc at iteration 35: 0.4391025641025641
	Val acc at iteration 34: 0.35106382978723405
	Train acc at iteration 36: 0.35096153846153844
	Val acc at iteration 35: 0.2978723404255319
	Train acc at iteration 37: 0.40384615384615385
	Val acc at iteration 36: 0.3617021276595745
	Train acc at iteration 38: 0.358974358974359
	Val acc at iteration 37: 0.3191489361702128
	Train acc at iteration 39: 0.3974358974358974
	Val acc at iteration 38: 0.3404255319148936
	Train acc at iteration 40: 0.483974358974359
	Val acc at iteration 39: 0.3829787234042553
	Train acc at iteration 41: 0.45032051282051283
	Val acc at iteration 40: 0.4148936170212766
	Train acc at iteration 42: 0.46794871794871795
	Val acc at iteration 41: 0.4787234042553192
	Train acc at iteration 43: 0.592948717948718
	Val acc at iteration 42: 0.4574468085106383
	Train acc at iteration 44: 0.5384615384615384
	Val acc at iteration 43: 0.44680851063829785
	Train acc at iteration 45: 0.5480769230769231
	Val acc at iteration 44: 0.425531914893617
	Train acc at iteration 46: 0.5176282051282052
	Val acc at iteration 45: 0.6382978723404256
	Train acc at iteration 47: 0.5224358974358975
	Val acc at iteration 46: 0.5638297872340425
	Train acc at iteration 48: 0.6073717948717948
	Val acc at iteration 47: 0.5957446808510638
	Train acc at iteration 49: 0.6282051282051282
	Val acc at iteration 48: 0.5106382978723404
	Train acc at iteration 50: 0.5881410256410257
	Val acc at iteration 49: 0.5851063829787234
	Train acc at iteration 51: 0.5993589743589743
	Val acc at iteration 50: 0.648936170212766
	Train acc at iteration 52: 0.6169871794871795
	Val acc at iteration 51: 0.6170212765957447
	Train acc at iteration 53: 0.5913461538461539
	Val acc at iteration 52: 0.6170212765957447
	Train acc at iteration 54: 0.6538461538461539
	Val acc at iteration 53: 0.5425531914893617
	Train acc at iteration 55: 0.6201923076923077
	Val acc at iteration 54: 0.6382978723404256
	Train acc at iteration 56: 0.6105769230769231
	Val acc at iteration 55: 0.6170212765957447
	Train acc at iteration 57: 0.6730769230769231
	Val acc at iteration 56: 0.6382978723404256
	Train acc at iteration 58: 0.657051282051282
	Val acc at iteration 57: 0.6170212765957447
	Train acc at iteration 59: 0.6778846153846154
	Val acc at iteration 58: 0.6063829787234043
	Train acc at iteration 60: 0.6794871794871795
	Val acc at iteration 59: 0.5638297872340425
	Train acc at iteration 61: 0.6858974358974359
	Val acc at iteration 60: 0.5638297872340425
	Train acc at iteration 62: 0.6714743589743589
	Val acc at iteration 61: 0.6170212765957447
	Train acc at iteration 63: 0.625
	Val acc at iteration 62: 0.5957446808510638
	Train acc at iteration 64: 0.7051282051282052
	Val acc at iteration 63: 0.6702127659574468
	Train acc at iteration 65: 0.657051282051282
	Val acc at iteration 64: 0.648936170212766
	Train acc at iteration 66: 0.6939102564102564
	Val acc at iteration 65: 0.6808510638297872
	Train acc at iteration 67: 0.6410256410256411
	Val acc at iteration 66: 0.5851063829787234
	Train acc at iteration 68: 0.6891025641025641
	Val acc at iteration 67: 0.6063829787234043
	Train acc at iteration 69: 0.6506410256410257
	Val acc at iteration 68: 0.6276595744680851
	Train acc at iteration 70: 0.6858974358974359
	Val acc at iteration 69: 0.7340425531914894
	Train acc at iteration 71: 0.6746794871794872
	Val acc at iteration 70: 0.6276595744680851
	Train acc at iteration 72: 0.6538461538461539
	Val acc at iteration 71: 0.5531914893617021
	Train acc at iteration 73: 0.6682692307692307
	Val acc at iteration 72: 0.6382978723404256
	Train acc at iteration 74: 0.6891025641025641
	Val acc at iteration 73: 0.6276595744680851
	Train acc at iteration 75: 0.6923076923076923
	Val acc at iteration 74: 0.6702127659574468
	Train acc at iteration 76: 0.6794871794871795
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.6346153846153846
	Val acc at iteration 76: 0.6702127659574468
	Train acc at iteration 78: 0.6746794871794872
	Val acc at iteration 77: 0.5851063829787234
	Train acc at iteration 79: 0.6987179487179487
	Val acc at iteration 78: 0.6063829787234043
	Train acc at iteration 80: 0.6875
	Val acc at iteration 79: 0.6063829787234043
	Train acc at iteration 81: 0.6762820512820513
	Val acc at iteration 80: 0.5425531914893617
	Train acc at iteration 82: 0.6987179487179487
	Val acc at iteration 81: 0.5425531914893617
	Train acc at iteration 83: 0.6971153846153846
	Val acc at iteration 82: 0.6808510638297872
	Train acc at iteration 84: 0.6907051282051282
	Val acc at iteration 83: 0.5638297872340425
	Train acc at iteration 85: 0.6346153846153846
	Val acc at iteration 84: 0.6382978723404256
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5272727272727272
Final val micro accuracy: 0.648936170212766
Final test macro f1-score: 0.49015151515151517
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6349325776100159
	Separation: 0.5406643152236938
Final test:
	Cluster: 0.6091320216655731
	Separation: 0.543907880783081
Saved Results

Attempting combination 12/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7708333333333334
	Train Cluster: 0.6409441351890564
	Train Separation: 0.5195264697074891
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5425531914893617
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.5531914893617021
	Val acc at iteration 3: 0.6063829787234043
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.7127659574468085
	Val acc at iteration 6: 0.6170212765957447
	Val acc at iteration 7: 0.6170212765957447
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6170212765957447
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.6063829787234043
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.6276595744680851
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.6063829787234043
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6276595744680851
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.7872340425531915
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6170212765957447
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.6382978723404256
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.648936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Train Cluster: 0.6421124100685119
	Train Separation: 0.5194450855255127
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.6914893617021277
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.851063829787234
	Val acc at iteration 7: 0.7872340425531915
	Val acc at iteration 8: 0.7659574468085106
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.7659574468085106
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.776595744680851
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.776595744680851
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.6276595744680851
	Val acc at iteration 51: 0.7978723404255319
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.776595744680851
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.7659574468085106
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.6170212765957447
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.8085106382978723
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 25: 0.7127659574468085
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9042553191489362
Stopping after epoch 37.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8108974358974359
	Train Cluster: 0.6505057692527771
	TrainSeparation: 0.5229922771453858
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: 0.05
	Train acc at iteration 1: 0.41346153846153844
	Val acc at iteration 0: 0.32978723404255317
	Train acc at iteration 2: 0.26121794871794873
	Val acc at iteration 1: 0.39361702127659576
	Train acc at iteration 3: 0.1971153846153846
	Val acc at iteration 2: 0.30851063829787234
	Train acc at iteration 4: 0.20512820512820512
	Val acc at iteration 3: 0.1595744680851064
	Train acc at iteration 5: 0.1891025641025641
	Val acc at iteration 4: 0.11702127659574468
	Train acc at iteration 6: 0.10737179487179487
	Val acc at iteration 5: 0.26595744680851063
	Train acc at iteration 7: 0.20032051282051283
	Val acc at iteration 6: 0.2872340425531915
	Train acc at iteration 8: 0.21153846153846154
	Val acc at iteration 7: 0.13829787234042554
	Train acc at iteration 9: 0.19391025641025642
	Val acc at iteration 8: 0.1702127659574468
	Train acc at iteration 10: 0.20512820512820512
	Val acc at iteration 9: 0.22340425531914893
	Train acc at iteration 11: 0.16987179487179488
	Val acc at iteration 10: 0.32978723404255317
	Train acc at iteration 12: 0.1955128205128205
	Val acc at iteration 11: 0.3191489361702128
	Train acc at iteration 13: 0.23717948717948717
	Val acc at iteration 12: 0.26595744680851063
	Train acc at iteration 14: 0.2467948717948718
	Val acc at iteration 13: 0.3191489361702128
	Train acc at iteration 15: 0.1971153846153846
	Val acc at iteration 14: 0.35106382978723405
	Train acc at iteration 16: 0.28365384615384615
	Val acc at iteration 15: 0.2127659574468085
	Train acc at iteration 17: 0.2900641025641026
	Val acc at iteration 16: 0.3723404255319149
	Train acc at iteration 18: 0.36378205128205127
	Val acc at iteration 17: 0.43617021276595747
	Train acc at iteration 19: 0.2980769230769231
	Val acc at iteration 18: 0.40425531914893614
	Train acc at iteration 20: 0.3974358974358974
	Val acc at iteration 19: 0.26595744680851063
	Train acc at iteration 21: 0.35096153846153844
	Val acc at iteration 20: 0.35106382978723405
	Train acc at iteration 22: 0.3701923076923077
	Val acc at iteration 21: 0.35106382978723405
	Train acc at iteration 23: 0.40224358974358976
	Val acc at iteration 22: 0.40425531914893614
	Train acc at iteration 24: 0.4166666666666667
	Val acc at iteration 23: 0.2978723404255319
	Train acc at iteration 25: 0.3942307692307692
	Val acc at iteration 24: 0.30851063829787234
	Train acc at iteration 26: 0.3974358974358974
	Val acc at iteration 25: 0.4574468085106383
	Train acc at iteration 27: 0.47596153846153844
	Val acc at iteration 26: 0.43617021276595747
	Train acc at iteration 28: 0.42628205128205127
	Val acc at iteration 27: 0.4574468085106383
	Train acc at iteration 29: 0.36378205128205127
	Val acc at iteration 28: 0.44680851063829785
	Train acc at iteration 30: 0.4775641025641026
	Val acc at iteration 29: 0.4574468085106383
	Train acc at iteration 31: 0.46474358974358976
	Val acc at iteration 30: 0.5106382978723404
	Train acc at iteration 32: 0.4823717948717949
	Val acc at iteration 31: 0.46808510638297873
	Train acc at iteration 33: 0.4375
	Val acc at iteration 32: 0.5
	Train acc at iteration 34: 0.4983974358974359
	Val acc at iteration 33: 0.44680851063829785
	Train acc at iteration 35: 0.46314102564102566
	Val acc at iteration 34: 0.44680851063829785
	Train acc at iteration 36: 0.5144230769230769
	Val acc at iteration 35: 0.5106382978723404
	Train acc at iteration 37: 0.5352564102564102
	Val acc at iteration 36: 0.4787234042553192
	Train acc at iteration 38: 0.5112179487179487
	Val acc at iteration 37: 0.5851063829787234
	Train acc at iteration 39: 0.530448717948718
	Val acc at iteration 38: 0.5106382978723404
	Train acc at iteration 40: 0.5240384615384616
	Val acc at iteration 39: 0.5425531914893617
	Train acc at iteration 41: 0.5448717948717948
	Val acc at iteration 40: 0.5957446808510638
	Train acc at iteration 42: 0.5400641025641025
	Val acc at iteration 41: 0.5638297872340425
	Train acc at iteration 43: 0.5785256410256411
	Val acc at iteration 42: 0.5106382978723404
	Train acc at iteration 44: 0.5416666666666666
	Val acc at iteration 43: 0.5319148936170213
	Train acc at iteration 45: 0.5737179487179487
	Val acc at iteration 44: 0.5531914893617021
	Train acc at iteration 46: 0.5352564102564102
	Val acc at iteration 45: 0.5531914893617021
	Train acc at iteration 47: 0.5448717948717948
	Val acc at iteration 46: 0.574468085106383
	Train acc at iteration 48: 0.6169871794871795
	Val acc at iteration 47: 0.4787234042553192
	Train acc at iteration 49: 0.5865384615384616
	Val acc at iteration 48: 0.5425531914893617
	Train acc at iteration 50: 0.592948717948718
	Val acc at iteration 49: 0.5425531914893617
	Train acc at iteration 51: 0.5833333333333334
	Val acc at iteration 50: 0.5531914893617021
	Train acc at iteration 52: 0.6121794871794872
	Val acc at iteration 51: 0.5425531914893617
	Train acc at iteration 53: 0.6057692307692307
	Val acc at iteration 52: 0.48936170212765956
	Train acc at iteration 54: 0.5705128205128205
	Val acc at iteration 53: 0.574468085106383
	Train acc at iteration 55: 0.6266025641025641
	Val acc at iteration 54: 0.5319148936170213
	Train acc at iteration 56: 0.5785256410256411
	Val acc at iteration 55: 0.5
	Train acc at iteration 57: 0.592948717948718
	Val acc at iteration 56: 0.6382978723404256
	Train acc at iteration 58: 0.6025641025641025
	Val acc at iteration 57: 0.48936170212765956
	Train acc at iteration 59: 0.625
	Val acc at iteration 58: 0.5425531914893617
	Train acc at iteration 60: 0.5673076923076923
	Val acc at iteration 59: 0.5319148936170213
	Train acc at iteration 61: 0.6201923076923077
	Val acc at iteration 60: 0.574468085106383
	Train acc at iteration 62: 0.5961538461538461
	Val acc at iteration 61: 0.5
	Train acc at iteration 63: 0.5865384615384616
	Val acc at iteration 62: 0.5425531914893617
	Train acc at iteration 64: 0.6041666666666666
	Val acc at iteration 63: 0.6063829787234043
	Train acc at iteration 65: 0.6282051282051282
	Val acc at iteration 64: 0.574468085106383
	Train acc at iteration 66: 0.6266025641025641
	Val acc at iteration 65: 0.48936170212765956
	Train acc at iteration 67: 0.6442307692307693
	Val acc at iteration 66: 0.5212765957446809
	Train acc at iteration 68: 0.6137820512820513
	Val acc at iteration 67: 0.6063829787234043
	Train acc at iteration 69: 0.6137820512820513
	Val acc at iteration 68: 0.5851063829787234
	Train acc at iteration 70: 0.6266025641025641
	Val acc at iteration 69: 0.6276595744680851
	Train acc at iteration 71: 0.6378205128205128
	Val acc at iteration 70: 0.5212765957446809
	Train acc at iteration 72: 0.6298076923076923
	Val acc at iteration 71: 0.5851063829787234
	Train acc at iteration 73: 0.6794871794871795
	Val acc at iteration 72: 0.5851063829787234
	Train acc at iteration 74: 0.6314102564102564
	Val acc at iteration 73: 0.5106382978723404
	Train acc at iteration 75: 0.657051282051282
	Val acc at iteration 74: 0.6382978723404256
	Train acc at iteration 76: 0.6618589743589743
	Val acc at iteration 75: 0.5638297872340425
	Train acc at iteration 77: 0.6618589743589743
	Val acc at iteration 76: 0.6382978723404256
	Train acc at iteration 78: 0.6650641025641025
	Val acc at iteration 77: 0.5425531914893617
	Train acc at iteration 79: 0.6330128205128205
	Val acc at iteration 78: 0.5638297872340425
	Train acc at iteration 80: 0.6490384615384616
	Val acc at iteration 79: 0.5531914893617021
	Train acc at iteration 81: 0.6762820512820513
	Val acc at iteration 80: 0.5851063829787234
	Train acc at iteration 82: 0.6522435897435898
	Val acc at iteration 81: 0.6063829787234043
	Train acc at iteration 83: 0.6314102564102564
	Val acc at iteration 82: 0.6063829787234043
	Train acc at iteration 84: 0.6282051282051282
	Val acc at iteration 83: 0.5531914893617021
	Train acc at iteration 85: 0.6442307692307693
	Val acc at iteration 84: 0.5319148936170213
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.38114478114478106
Final val micro accuracy: 0.48936170212765956
Final test macro f1-score: 0.40486891385767787
Final test micro accuracy: 0.5212765957446809
Final validation:
	Cluster: 0.6087367832660675
	Separation: 0.5357135832309723
Final test:
	Cluster: 0.6126206815242767
	Separation: 0.5382549464702606
Saved Results

Attempting combination 13/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.01
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6914893617021277
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Train Cluster: 0.6439042568206788
	Train Separation: 0.5159272313117981
(Directly after push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5851063829787234
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.6170212765957447
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6276595744680851
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7659574468085106
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.776595744680851
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.7659574468085106
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.776595744680851
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.7446808510638298
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.7872340425531915
	Val acc at iteration 71: 0.6382978723404256
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6595744680851063
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9680851063829787
Push epoch
After push, before retraining last layer:
	Train acc: 0.8381410256410257
	Train Cluster: 0.6487885355949402
	Train Separation: 0.521262013912201
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7659574468085106
	Val acc at iteration 1: 0.7872340425531915
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.7872340425531915
	Val acc at iteration 4: 0.7659574468085106
	Val acc at iteration 5: 0.8191489361702128
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.8191489361702128
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.8297872340425532
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.7446808510638298
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.776595744680851
	Val acc at iteration 18: 0.7872340425531915
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7872340425531915
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.7872340425531915
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.7872340425531915
	Val acc at iteration 26: 0.7872340425531915
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.7978723404255319
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7659574468085106
	Val acc at iteration 32: 0.7978723404255319
	Val acc at iteration 33: 0.7872340425531915
	Val acc at iteration 34: 0.7872340425531915
	Val acc at iteration 35: 0.7659574468085106
	Val acc at iteration 36: 0.7978723404255319
	Val acc at iteration 37: 0.8191489361702128
	Val acc at iteration 38: 0.7659574468085106
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.7872340425531915
	Val acc at iteration 42: 0.776595744680851
	Val acc at iteration 43: 0.776595744680851
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.776595744680851
	Val acc at iteration 48: 0.8297872340425532
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.8085106382978723
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.7872340425531915
	Val acc at iteration 57: 0.8191489361702128
	Val acc at iteration 58: 0.776595744680851
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7872340425531915
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.8191489361702128
	Val acc at iteration 63: 0.7872340425531915
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.7978723404255319
	Val acc at iteration 67: 0.776595744680851
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.776595744680851
	Val acc at iteration 72: 0.7978723404255319
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7978723404255319
	Val acc at iteration 76: 0.8085106382978723
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.8085106382978723
	Val acc at iteration 80: 0.776595744680851
	Val acc at iteration 81: 0.8297872340425532
	Val acc at iteration 82: 0.8191489361702128
	Val acc at iteration 83: 0.8191489361702128
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9680851063829787
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8477564102564102
	Train Cluster: 0.6552650094032287
	TrainSeparation: 0.5228292107582092
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.01
	Train acc at iteration 1: 0.7548076923076923
	Val acc at iteration 0: 0.6808510638297872
	Train acc at iteration 2: 0.7163461538461539
	Val acc at iteration 1: 0.5531914893617021
	Train acc at iteration 3: 0.6987179487179487
	Val acc at iteration 2: 0.6914893617021277
	Train acc at iteration 4: 0.657051282051282
	Val acc at iteration 3: 0.6170212765957447
	Train acc at iteration 5: 0.6330128205128205
	Val acc at iteration 4: 0.6595744680851063
	Train acc at iteration 6: 0.6314102564102564
	Val acc at iteration 5: 0.6595744680851063
	Train acc at iteration 7: 0.6506410256410257
	Val acc at iteration 6: 0.6276595744680851
	Train acc at iteration 8: 0.6394230769230769
	Val acc at iteration 7: 0.6702127659574468
	Train acc at iteration 9: 0.6730769230769231
	Val acc at iteration 8: 0.6702127659574468
	Train acc at iteration 10: 0.6410256410256411
	Val acc at iteration 9: 0.6595744680851063
	Train acc at iteration 11: 0.6875
	Val acc at iteration 10: 0.5851063829787234
	Train acc at iteration 12: 0.6538461538461539
	Val acc at iteration 11: 0.6595744680851063
	Train acc at iteration 13: 0.657051282051282
	Val acc at iteration 12: 0.7553191489361702
	Train acc at iteration 14: 0.6394230769230769
	Val acc at iteration 13: 0.5425531914893617
	Train acc at iteration 15: 0.6618589743589743
	Val acc at iteration 14: 0.5638297872340425
	Train acc at iteration 16: 0.6730769230769231
	Val acc at iteration 15: 0.6595744680851063
	Train acc at iteration 17: 0.6778846153846154
	Val acc at iteration 16: 0.6382978723404256
	Train acc at iteration 18: 0.6233974358974359
	Val acc at iteration 17: 0.6382978723404256
	Train acc at iteration 19: 0.6410256410256411
	Val acc at iteration 18: 0.6170212765957447
	Train acc at iteration 20: 0.6266025641025641
	Val acc at iteration 19: 0.5638297872340425
	Train acc at iteration 21: 0.6057692307692307
	Val acc at iteration 20: 0.5425531914893617
	Train acc at iteration 22: 0.5817307692307693
	Val acc at iteration 21: 0.5531914893617021
	Train acc at iteration 23: 0.6378205128205128
	Val acc at iteration 22: 0.5851063829787234
	Train acc at iteration 24: 0.6362179487179487
	Val acc at iteration 23: 0.6914893617021277
	Train acc at iteration 25: 0.5705128205128205
	Val acc at iteration 24: 0.574468085106383
	Train acc at iteration 26: 0.6298076923076923
	Val acc at iteration 25: 0.5957446808510638
	Train acc at iteration 27: 0.6009615384615384
	Val acc at iteration 26: 0.5319148936170213
	Train acc at iteration 28: 0.6153846153846154
	Val acc at iteration 27: 0.5957446808510638
	Train acc at iteration 29: 0.6201923076923077
	Val acc at iteration 28: 0.5957446808510638
	Train acc at iteration 30: 0.6490384615384616
	Val acc at iteration 29: 0.5425531914893617
	Train acc at iteration 31: 0.6041666666666666
	Val acc at iteration 30: 0.6063829787234043
	Train acc at iteration 32: 0.6298076923076923
	Val acc at iteration 31: 0.5851063829787234
	Train acc at iteration 33: 0.6394230769230769
	Val acc at iteration 32: 0.6276595744680851
	Train acc at iteration 34: 0.6442307692307693
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.655448717948718
	Val acc at iteration 34: 0.5
	Train acc at iteration 36: 0.6474358974358975
	Val acc at iteration 35: 0.6170212765957447
	Train acc at iteration 37: 0.6522435897435898
	Val acc at iteration 36: 0.574468085106383
	Train acc at iteration 38: 0.6650641025641025
	Val acc at iteration 37: 0.5638297872340425
	Train acc at iteration 39: 0.6490384615384616
	Val acc at iteration 38: 0.6382978723404256
	Train acc at iteration 40: 0.6971153846153846
	Val acc at iteration 39: 0.5531914893617021
	Train acc at iteration 41: 0.6522435897435898
	Val acc at iteration 40: 0.5957446808510638
	Train acc at iteration 42: 0.6442307692307693
	Val acc at iteration 41: 0.5638297872340425
	Train acc at iteration 43: 0.6506410256410257
	Val acc at iteration 42: 0.5638297872340425
	Train acc at iteration 44: 0.7051282051282052
	Val acc at iteration 43: 0.574468085106383
	Train acc at iteration 45: 0.6314102564102564
	Val acc at iteration 44: 0.574468085106383
	Train acc at iteration 46: 0.6971153846153846
	Val acc at iteration 45: 0.5957446808510638
	Train acc at iteration 47: 0.6330128205128205
	Val acc at iteration 46: 0.648936170212766
	Train acc at iteration 48: 0.7051282051282052
	Val acc at iteration 47: 0.6170212765957447
	Train acc at iteration 49: 0.6939102564102564
	Val acc at iteration 48: 0.648936170212766
	Train acc at iteration 50: 0.6682692307692307
	Val acc at iteration 49: 0.6914893617021277
	Train acc at iteration 51: 0.655448717948718
	Val acc at iteration 50: 0.5638297872340425
	Train acc at iteration 52: 0.7163461538461539
	Val acc at iteration 51: 0.5106382978723404
	Train acc at iteration 53: 0.655448717948718
	Val acc at iteration 52: 0.6276595744680851
	Train acc at iteration 54: 0.7163461538461539
	Val acc at iteration 53: 0.6595744680851063
	Train acc at iteration 55: 0.7003205128205128
	Val acc at iteration 54: 0.648936170212766
	Train acc at iteration 56: 0.6826923076923077
	Val acc at iteration 55: 0.6063829787234043
	Train acc at iteration 57: 0.7003205128205128
	Val acc at iteration 56: 0.6276595744680851
	Train acc at iteration 58: 0.6586538461538461
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.6907051282051282
	Val acc at iteration 58: 0.6382978723404256
	Train acc at iteration 60: 0.6762820512820513
	Val acc at iteration 59: 0.6702127659574468
	Train acc at iteration 61: 0.6907051282051282
	Val acc at iteration 60: 0.5638297872340425
	Train acc at iteration 62: 0.6971153846153846
	Val acc at iteration 61: 0.648936170212766
	Train acc at iteration 63: 0.7019230769230769
	Val acc at iteration 62: 0.6063829787234043
	Train acc at iteration 64: 0.6506410256410257
	Val acc at iteration 63: 0.6914893617021277
	Train acc at iteration 65: 0.7035256410256411
	Val acc at iteration 64: 0.7021276595744681
	Train acc at iteration 66: 0.7003205128205128
	Val acc at iteration 65: 0.574468085106383
	Train acc at iteration 67: 0.6778846153846154
	Val acc at iteration 66: 0.6808510638297872
	Train acc at iteration 68: 0.7243589743589743
	Val acc at iteration 67: 0.648936170212766
	Train acc at iteration 69: 0.7147435897435898
	Val acc at iteration 68: 0.6702127659574468
	Train acc at iteration 70: 0.7291666666666666
	Val acc at iteration 69: 0.6595744680851063
	Train acc at iteration 71: 0.6858974358974359
	Val acc at iteration 70: 0.776595744680851
	Train acc at iteration 72: 0.719551282051282
	Val acc at iteration 71: 0.648936170212766
	Train acc at iteration 73: 0.6971153846153846
	Val acc at iteration 72: 0.6914893617021277
	Train acc at iteration 74: 0.7019230769230769
	Val acc at iteration 73: 0.7446808510638298
	Train acc at iteration 75: 0.7115384615384616
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.7019230769230769
	Val acc at iteration 75: 0.6702127659574468
	Train acc at iteration 77: 0.7147435897435898
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.6955128205128205
	Val acc at iteration 77: 0.648936170212766
	Train acc at iteration 79: 0.7275641025641025
	Val acc at iteration 78: 0.6276595744680851
	Train acc at iteration 80: 0.7371794871794872
	Val acc at iteration 79: 0.6382978723404256
	Train acc at iteration 81: 0.7307692307692307
	Val acc at iteration 80: 0.7021276595744681
	Train acc at iteration 82: 0.719551282051282
	Val acc at iteration 81: 0.6170212765957447
	Train acc at iteration 83: 0.7259615384615384
	Val acc at iteration 82: 0.6702127659574468
	Train acc at iteration 84: 0.7115384615384616
	Val acc at iteration 83: 0.6808510638297872
	Train acc at iteration 85: 0.7243589743589743
	Val acc at iteration 84: 0.7127659574468085
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5840136054421768
Final val micro accuracy: 0.6914893617021277
Final test macro f1-score: 0.4340659340659341
Final test micro accuracy: 0.5638297872340425
Final validation:
	Cluster: 0.6328175067901611
	Separation: 0.5393672585487366
Final test:
	Cluster: 0.6124237775802612
	Separation: 0.5306023061275482
Saved Results

Attempting combination 14/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5319148936170213
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Train Cluster: 0.6392160177230835
	Train Separation: 0.5165158271789551
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5851063829787234
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.7021276595744681
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.8297872340425532
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6063829787234043
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.6063829787234043
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.6063829787234043
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.776595744680851
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.7872340425531915
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7553191489361702
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.7021276595744681
Val acc before epoch 13: 0.7340425531914894
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7978723404255319
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Train Cluster: 0.6427583217620849
	Train Separation: 0.5197985768318176
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7978723404255319
	Val acc at iteration 1: 0.8191489361702128
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7021276595744681
	Val acc at iteration 5: 0.776595744680851
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.7978723404255319
	Val acc at iteration 9: 0.7978723404255319
	Val acc at iteration 10: 0.7978723404255319
	Val acc at iteration 11: 0.776595744680851
	Val acc at iteration 12: 0.8297872340425532
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.7446808510638298
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.7446808510638298
	Val acc at iteration 17: 0.8297872340425532
	Val acc at iteration 18: 0.776595744680851
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.8085106382978723
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.7872340425531915
	Val acc at iteration 24: 0.7978723404255319
	Val acc at iteration 25: 0.8085106382978723
	Val acc at iteration 26: 0.7659574468085106
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.7978723404255319
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.7553191489361702
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.776595744680851
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.8085106382978723
	Val acc at iteration 37: 0.7978723404255319
	Val acc at iteration 38: 0.776595744680851
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.7659574468085106
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.8085106382978723
	Val acc at iteration 47: 0.7659574468085106
	Val acc at iteration 48: 0.7978723404255319
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.776595744680851
	Val acc at iteration 52: 0.7553191489361702
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7872340425531915
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.851063829787234
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.7872340425531915
	Val acc at iteration 64: 0.7659574468085106
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.8085106382978723
	Val acc at iteration 67: 0.8297872340425532
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.8617021276595744
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.8085106382978723
	Val acc at iteration 74: 0.8404255319148937
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7340425531914894
	Val acc at iteration 78: 0.8191489361702128
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.7872340425531915
	Val acc at iteration 84: 0.7978723404255319
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9680851063829787
Stopping after epoch 37.
Final validation accuracy before push: 96.80851063829788%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8317307692307693
	Train Cluster: 0.6571659922599793
	TrainSeparation: 0.5231537818908691
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.005
	Train acc at iteration 1: 0.7900641025641025
	Val acc at iteration 0: 0.6914893617021277
	Train acc at iteration 2: 0.782051282051282
	Val acc at iteration 1: 0.776595744680851
	Train acc at iteration 3: 0.7323717948717948
	Val acc at iteration 2: 0.7127659574468085
	Train acc at iteration 4: 0.7660256410256411
	Val acc at iteration 3: 0.7659574468085106
	Train acc at iteration 5: 0.7692307692307693
	Val acc at iteration 4: 0.723404255319149
	Train acc at iteration 6: 0.7147435897435898
	Val acc at iteration 5: 0.7446808510638298
	Train acc at iteration 7: 0.7596153846153846
	Val acc at iteration 6: 0.7446808510638298
	Train acc at iteration 8: 0.7676282051282052
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.7355769230769231
	Val acc at iteration 8: 0.6914893617021277
	Train acc at iteration 10: 0.7483974358974359
	Val acc at iteration 9: 0.7872340425531915
	Train acc at iteration 11: 0.7836538461538461
	Val acc at iteration 10: 0.723404255319149
	Train acc at iteration 12: 0.7900641025641025
	Val acc at iteration 11: 0.7127659574468085
	Train acc at iteration 13: 0.7868589743589743
	Val acc at iteration 12: 0.7021276595744681
	Train acc at iteration 14: 0.7724358974358975
	Val acc at iteration 13: 0.6808510638297872
	Train acc at iteration 15: 0.7644230769230769
	Val acc at iteration 14: 0.7127659574468085
	Train acc at iteration 16: 0.7403846153846154
	Val acc at iteration 15: 0.6808510638297872
	Train acc at iteration 17: 0.7836538461538461
	Val acc at iteration 16: 0.776595744680851
	Train acc at iteration 18: 0.7868589743589743
	Val acc at iteration 17: 0.8085106382978723
	Train acc at iteration 19: 0.7708333333333334
	Val acc at iteration 18: 0.723404255319149
	Train acc at iteration 20: 0.7916666666666666
	Val acc at iteration 19: 0.6914893617021277
	Train acc at iteration 21: 0.7868589743589743
	Val acc at iteration 20: 0.7659574468085106
	Train acc at iteration 22: 0.7788461538461539
	Val acc at iteration 21: 0.7446808510638298
	Train acc at iteration 23: 0.7708333333333334
	Val acc at iteration 22: 0.7446808510638298
	Train acc at iteration 24: 0.7996794871794872
	Val acc at iteration 23: 0.7872340425531915
	Train acc at iteration 25: 0.7644230769230769
	Val acc at iteration 24: 0.7446808510638298
	Train acc at iteration 26: 0.8012820512820513
	Val acc at iteration 25: 0.723404255319149
	Train acc at iteration 27: 0.7516025641025641
	Val acc at iteration 26: 0.7446808510638298
	Train acc at iteration 28: 0.7612179487179487
	Val acc at iteration 27: 0.7553191489361702
	Train acc at iteration 29: 0.7868589743589743
	Val acc at iteration 28: 0.7340425531914894
	Train acc at iteration 30: 0.7868589743589743
	Val acc at iteration 29: 0.7127659574468085
	Train acc at iteration 31: 0.7916666666666666
	Val acc at iteration 30: 0.723404255319149
	Train acc at iteration 32: 0.75
	Val acc at iteration 31: 0.7659574468085106
	Train acc at iteration 33: 0.7676282051282052
	Val acc at iteration 32: 0.723404255319149
	Train acc at iteration 34: 0.7548076923076923
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.7740384615384616
	Val acc at iteration 34: 0.723404255319149
	Train acc at iteration 36: 0.7564102564102564
	Val acc at iteration 35: 0.723404255319149
	Train acc at iteration 37: 0.7403846153846154
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.7275641025641025
	Val acc at iteration 37: 0.6702127659574468
	Train acc at iteration 39: 0.7628205128205128
	Val acc at iteration 38: 0.7127659574468085
	Train acc at iteration 40: 0.7532051282051282
	Val acc at iteration 39: 0.6914893617021277
	Train acc at iteration 41: 0.75
	Val acc at iteration 40: 0.6808510638297872
	Train acc at iteration 42: 0.7243589743589743
	Val acc at iteration 41: 0.6808510638297872
	Train acc at iteration 43: 0.7323717948717948
	Val acc at iteration 42: 0.6063829787234043
	Train acc at iteration 44: 0.7131410256410257
	Val acc at iteration 43: 0.7978723404255319
	Train acc at iteration 45: 0.7692307692307693
	Val acc at iteration 44: 0.723404255319149
	Train acc at iteration 46: 0.7307692307692307
	Val acc at iteration 45: 0.6276595744680851
	Train acc at iteration 47: 0.75
	Val acc at iteration 46: 0.6914893617021277
	Train acc at iteration 48: 0.7564102564102564
	Val acc at iteration 47: 0.6808510638297872
	Train acc at iteration 49: 0.7564102564102564
	Val acc at iteration 48: 0.6382978723404256
	Train acc at iteration 50: 0.7275641025641025
	Val acc at iteration 49: 0.6595744680851063
	Train acc at iteration 51: 0.7387820512820513
	Val acc at iteration 50: 0.7021276595744681
	Train acc at iteration 52: 0.7403846153846154
	Val acc at iteration 51: 0.648936170212766
	Train acc at iteration 53: 0.7243589743589743
	Val acc at iteration 52: 0.6914893617021277
	Train acc at iteration 54: 0.719551282051282
	Val acc at iteration 53: 0.6808510638297872
	Train acc at iteration 55: 0.7243589743589743
	Val acc at iteration 54: 0.6595744680851063
	Train acc at iteration 56: 0.7419871794871795
	Val acc at iteration 55: 0.6276595744680851
	Train acc at iteration 57: 0.717948717948718
	Val acc at iteration 56: 0.5851063829787234
	Train acc at iteration 58: 0.7259615384615384
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.7131410256410257
	Val acc at iteration 58: 0.7021276595744681
	Train acc at iteration 60: 0.7564102564102564
	Val acc at iteration 59: 0.5957446808510638
	Train acc at iteration 61: 0.7628205128205128
	Val acc at iteration 60: 0.648936170212766
	Train acc at iteration 62: 0.7227564102564102
	Val acc at iteration 61: 0.6595744680851063
	Train acc at iteration 63: 0.6939102564102564
	Val acc at iteration 62: 0.6914893617021277
	Train acc at iteration 64: 0.7548076923076923
	Val acc at iteration 63: 0.648936170212766
	Train acc at iteration 65: 0.7355769230769231
	Val acc at iteration 64: 0.6808510638297872
	Train acc at iteration 66: 0.7596153846153846
	Val acc at iteration 65: 0.6914893617021277
	Train acc at iteration 67: 0.7227564102564102
	Val acc at iteration 66: 0.6382978723404256
	Train acc at iteration 68: 0.7371794871794872
	Val acc at iteration 67: 0.6702127659574468
	Train acc at iteration 69: 0.7131410256410257
	Val acc at iteration 68: 0.7127659574468085
	Train acc at iteration 70: 0.7467948717948718
	Val acc at iteration 69: 0.6382978723404256
	Train acc at iteration 71: 0.7291666666666666
	Val acc at iteration 70: 0.5638297872340425
	Train acc at iteration 72: 0.7772435897435898
	Val acc at iteration 71: 0.6595744680851063
	Train acc at iteration 73: 0.7307692307692307
	Val acc at iteration 72: 0.6382978723404256
	Train acc at iteration 74: 0.7371794871794872
	Val acc at iteration 73: 0.6276595744680851
	Train acc at iteration 75: 0.7371794871794872
	Val acc at iteration 74: 0.6595744680851063
	Train acc at iteration 76: 0.7371794871794872
	Val acc at iteration 75: 0.7021276595744681
	Train acc at iteration 77: 0.7227564102564102
	Val acc at iteration 76: 0.6595744680851063
	Train acc at iteration 78: 0.7307692307692307
	Val acc at iteration 77: 0.6063829787234043
	Train acc at iteration 79: 0.7323717948717948
	Val acc at iteration 78: 0.648936170212766
	Train acc at iteration 80: 0.719551282051282
	Val acc at iteration 79: 0.6170212765957447
	Train acc at iteration 81: 0.7467948717948718
	Val acc at iteration 80: 0.7021276595744681
	Train acc at iteration 82: 0.7788461538461539
	Val acc at iteration 81: 0.6702127659574468
	Train acc at iteration 83: 0.7516025641025641
	Val acc at iteration 82: 0.7446808510638298
	Train acc at iteration 84: 0.7548076923076923
	Val acc at iteration 83: 0.6382978723404256
	Train acc at iteration 85: 0.7227564102564102
	Val acc at iteration 84: 0.6595744680851063
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5511551155115512
Final val micro accuracy: 0.6595744680851063
Final test macro f1-score: 0.41560283687943267
Final test micro accuracy: 0.5531914893617021
Final validation:
	Cluster: 0.6360297203063965
	Separation: 0.5411525368690491
Final test:
	Cluster: 0.5918331146240234
	Separation: 0.535216361284256
Saved Results

Attempting combination 15/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6276595744680851
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Train Cluster: 0.6475459933280945
	Train Separation: 0.5213046669960022
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5425531914893617
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.5957446808510638
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.5957446808510638
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.5851063829787234
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.6063829787234043
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.6276595744680851
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.6170212765957447
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.6276595744680851
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.6276595744680851
	Val acc at iteration 60: 0.648936170212766
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6382978723404256
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.6276595744680851
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.7659574468085106
Val acc before epoch 13: 0.6595744680851063
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7872340425531915
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7676282051282052
	Train Cluster: 0.6457807540893554
	Train Separation: 0.5212666630744934
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.7659574468085106
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.7978723404255319
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.7872340425531915
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.7659574468085106
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.776595744680851
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.7659574468085106
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.7553191489361702
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.776595744680851
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.776595744680851
	Val acc at iteration 60: 0.7446808510638298
	Val acc at iteration 61: 0.7978723404255319
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.7659574468085106
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7553191489361702
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7659574468085106
Val acc before epoch 25: 0.7446808510638298
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8108974358974359
	Train Cluster: 0.652864933013916
	TrainSeparation: 0.5264488697052002
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.001
	Train acc at iteration 1: 0.7916666666666666
	Val acc at iteration 0: 0.723404255319149
	Train acc at iteration 2: 0.8237179487179487
	Val acc at iteration 1: 0.7872340425531915
	Train acc at iteration 3: 0.8060897435897436
	Val acc at iteration 2: 0.723404255319149
	Train acc at iteration 4: 0.8108974358974359
	Val acc at iteration 3: 0.7553191489361702
	Train acc at iteration 5: 0.8044871794871795
	Val acc at iteration 4: 0.7553191489361702
	Train acc at iteration 6: 0.8125
	Val acc at iteration 5: 0.7446808510638298
	Train acc at iteration 7: 0.8141025641025641
	Val acc at iteration 6: 0.7021276595744681
	Train acc at iteration 8: 0.8108974358974359
	Val acc at iteration 7: 0.8191489361702128
	Train acc at iteration 9: 0.7980769230769231
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8269230769230769
	Val acc at iteration 9: 0.7872340425531915
	Train acc at iteration 11: 0.8381410256410257
	Val acc at iteration 10: 0.7446808510638298
	Train acc at iteration 12: 0.8237179487179487
	Val acc at iteration 11: 0.7659574468085106
	Train acc at iteration 13: 0.8301282051282052
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.8076923076923077
	Val acc at iteration 13: 0.7872340425531915
	Train acc at iteration 15: 0.7996794871794872
	Val acc at iteration 14: 0.7340425531914894
	Train acc at iteration 16: 0.7996794871794872
	Val acc at iteration 15: 0.7446808510638298
	Train acc at iteration 17: 0.8365384615384616
	Val acc at iteration 16: 0.7872340425531915
	Train acc at iteration 18: 0.7964743589743589
	Val acc at iteration 17: 0.723404255319149
	Train acc at iteration 19: 0.8125
	Val acc at iteration 18: 0.7340425531914894
	Train acc at iteration 20: 0.7964743589743589
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.7996794871794872
	Val acc at iteration 20: 0.723404255319149
	Train acc at iteration 22: 0.8173076923076923
	Val acc at iteration 21: 0.7340425531914894
	Train acc at iteration 23: 0.8028846153846154
	Val acc at iteration 22: 0.723404255319149
	Train acc at iteration 24: 0.8381410256410257
	Val acc at iteration 23: 0.7978723404255319
	Train acc at iteration 25: 0.7980769230769231
	Val acc at iteration 24: 0.7553191489361702
	Train acc at iteration 26: 0.8301282051282052
	Val acc at iteration 25: 0.6276595744680851
	Train acc at iteration 27: 0.8092948717948718
	Val acc at iteration 26: 0.6914893617021277
	Train acc at iteration 28: 0.8125
	Val acc at iteration 27: 0.7127659574468085
	Train acc at iteration 29: 0.8189102564102564
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.8189102564102564
	Val acc at iteration 29: 0.7872340425531915
	Train acc at iteration 31: 0.8349358974358975
	Val acc at iteration 30: 0.723404255319149
	Train acc at iteration 32: 0.8076923076923077
	Val acc at iteration 31: 0.7872340425531915
	Train acc at iteration 33: 0.8189102564102564
	Val acc at iteration 32: 0.7340425531914894
	Train acc at iteration 34: 0.8365384615384616
	Val acc at iteration 33: 0.7553191489361702
	Train acc at iteration 35: 0.8092948717948718
	Val acc at iteration 34: 0.7446808510638298
	Train acc at iteration 36: 0.7900641025641025
	Val acc at iteration 35: 0.7553191489361702
	Train acc at iteration 37: 0.8076923076923077
	Val acc at iteration 36: 0.7872340425531915
	Train acc at iteration 38: 0.8221153846153846
	Val acc at iteration 37: 0.7021276595744681
	Train acc at iteration 39: 0.8221153846153846
	Val acc at iteration 38: 0.7340425531914894
	Train acc at iteration 40: 0.8141025641025641
	Val acc at iteration 39: 0.7978723404255319
	Train acc at iteration 41: 0.8269230769230769
	Val acc at iteration 40: 0.8297872340425532
	Train acc at iteration 42: 0.8189102564102564
	Val acc at iteration 41: 0.723404255319149
	Train acc at iteration 43: 0.8205128205128205
	Val acc at iteration 42: 0.8191489361702128
	Train acc at iteration 44: 0.8269230769230769
	Val acc at iteration 43: 0.648936170212766
	Train acc at iteration 45: 0.8076923076923077
	Val acc at iteration 44: 0.7659574468085106
	Train acc at iteration 46: 0.8028846153846154
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.8237179487179487
	Val acc at iteration 46: 0.8191489361702128
	Train acc at iteration 48: 0.8349358974358975
	Val acc at iteration 47: 0.7872340425531915
	Train acc at iteration 49: 0.8141025641025641
	Val acc at iteration 48: 0.776595744680851
	Train acc at iteration 50: 0.8397435897435898
	Val acc at iteration 49: 0.776595744680851
	Train acc at iteration 51: 0.8381410256410257
	Val acc at iteration 50: 0.723404255319149
	Train acc at iteration 52: 0.8317307692307693
	Val acc at iteration 51: 0.776595744680851
	Train acc at iteration 53: 0.8157051282051282
	Val acc at iteration 52: 0.7340425531914894
	Train acc at iteration 54: 0.7900641025641025
	Val acc at iteration 53: 0.8085106382978723
	Train acc at iteration 55: 0.8157051282051282
	Val acc at iteration 54: 0.7340425531914894
	Train acc at iteration 56: 0.8189102564102564
	Val acc at iteration 55: 0.7446808510638298
	Train acc at iteration 57: 0.8317307692307693
	Val acc at iteration 56: 0.7659574468085106
	Train acc at iteration 58: 0.8060897435897436
	Val acc at iteration 57: 0.7446808510638298
	Train acc at iteration 59: 0.8221153846153846
	Val acc at iteration 58: 0.7659574468085106
	Train acc at iteration 60: 0.8060897435897436
	Val acc at iteration 59: 0.7340425531914894
	Train acc at iteration 61: 0.8221153846153846
	Val acc at iteration 60: 0.7340425531914894
	Train acc at iteration 62: 0.8301282051282052
	Val acc at iteration 61: 0.7872340425531915
	Train acc at iteration 63: 0.8221153846153846
	Val acc at iteration 62: 0.7978723404255319
	Train acc at iteration 64: 0.8301282051282052
	Val acc at iteration 63: 0.723404255319149
	Train acc at iteration 65: 0.7996794871794872
	Val acc at iteration 64: 0.7978723404255319
	Train acc at iteration 66: 0.8092948717948718
	Val acc at iteration 65: 0.6702127659574468
	Train acc at iteration 67: 0.8365384615384616
	Val acc at iteration 66: 0.776595744680851
	Train acc at iteration 68: 0.8333333333333334
	Val acc at iteration 67: 0.7659574468085106
	Train acc at iteration 69: 0.8189102564102564
	Val acc at iteration 68: 0.7872340425531915
	Train acc at iteration 70: 0.8205128205128205
	Val acc at iteration 69: 0.7659574468085106
	Train acc at iteration 71: 0.8525641025641025
	Val acc at iteration 70: 0.7659574468085106
	Train acc at iteration 72: 0.8044871794871795
	Val acc at iteration 71: 0.723404255319149
	Train acc at iteration 73: 0.8269230769230769
	Val acc at iteration 72: 0.776595744680851
	Train acc at iteration 74: 0.8317307692307693
	Val acc at iteration 73: 0.7553191489361702
	Train acc at iteration 75: 0.8493589743589743
	Val acc at iteration 74: 0.7978723404255319
	Train acc at iteration 76: 0.8028846153846154
	Val acc at iteration 75: 0.7127659574468085
	Train acc at iteration 77: 0.8157051282051282
	Val acc at iteration 76: 0.7127659574468085
	Train acc at iteration 78: 0.8381410256410257
	Val acc at iteration 77: 0.7340425531914894
	Train acc at iteration 79: 0.8413461538461539
	Val acc at iteration 78: 0.776595744680851
	Train acc at iteration 80: 0.8285256410256411
	Val acc at iteration 79: 0.7127659574468085
	Train acc at iteration 81: 0.8589743589743589
	Val acc at iteration 80: 0.776595744680851
	Train acc at iteration 82: 0.8349358974358975
	Val acc at iteration 81: 0.7872340425531915
	Train acc at iteration 83: 0.8060897435897436
	Val acc at iteration 82: 0.7553191489361702
	Train acc at iteration 84: 0.8477564102564102
	Val acc at iteration 83: 0.7446808510638298
	Train acc at iteration 85: 0.8269230769230769
	Val acc at iteration 84: 0.7978723404255319
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6947368421052633
Final val micro accuracy: 0.776595744680851
Final test macro f1-score: 0.6472222222222223
Final test micro accuracy: 0.7553191489361702
Final validation:
	Cluster: 0.6194727718830109
	Separation: 0.5500174462795258
Final test:
	Cluster: 0.6060267686843872
	Separation: 0.5334188938140869
Saved Results

Attempting combination 16/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6595744680851063
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7708333333333334
	Train Cluster: 0.6426174998283386
	Train Separation: 0.5207736968994141
(Directly after push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.574468085106383
	Val acc at iteration 2: 0.574468085106383
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.5
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.5957446808510638
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.5957446808510638
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6063829787234043
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.5957446808510638
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.6063829787234043
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6170212765957447
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.7978723404255319
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.6276595744680851
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.6382978723404256
	Val acc at iteration 66: 0.6063829787234043
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.6702127659574468
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9574468085106383
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Train Cluster: 0.6539052486419678
	Train Separation: 0.5224064469337464
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.7978723404255319
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.8085106382978723
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.7446808510638298
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.776595744680851
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.6063829787234043
	Val acc at iteration 18: 0.776595744680851
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.8085106382978723
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.8191489361702128
	Val acc at iteration 26: 0.776595744680851
	Val acc at iteration 27: 0.7872340425531915
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.776595744680851
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7872340425531915
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.8085106382978723
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.776595744680851
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.7659574468085106
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.7978723404255319
	Val acc at iteration 54: 0.7872340425531915
	Val acc at iteration 55: 0.7978723404255319
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.8085106382978723
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7446808510638298
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.8617021276595744
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.7872340425531915
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.776595744680851
	Val acc at iteration 68: 0.8085106382978723
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.776595744680851
	Val acc at iteration 77: 0.7446808510638298
	Val acc at iteration 78: 0.7872340425531915
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.7446808510638298
Val acc before epoch 25: 0.7978723404255319
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8237179487179487
	Train Cluster: 0.6577983498573303
	TrainSeparation: 0.5227380514144897
(Directly after push) Val acc at iteration 0: 0.7978723404255319
Retraining last layer
Last layer lr: 0.0005
	Train acc at iteration 1: 0.8221153846153846
	Val acc at iteration 0: 0.851063829787234
	Train acc at iteration 2: 0.8269230769230769
	Val acc at iteration 1: 0.776595744680851
	Train acc at iteration 3: 0.8333333333333334
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.8060897435897436
	Val acc at iteration 3: 0.8617021276595744
	Train acc at iteration 5: 0.8285256410256411
	Val acc at iteration 4: 0.8404255319148937
	Train acc at iteration 6: 0.8125
	Val acc at iteration 5: 0.8085106382978723
	Train acc at iteration 7: 0.8189102564102564
	Val acc at iteration 6: 0.7553191489361702
	Train acc at iteration 8: 0.8141025641025641
	Val acc at iteration 7: 0.776595744680851
	Train acc at iteration 9: 0.8237179487179487
	Val acc at iteration 8: 0.7021276595744681
	Train acc at iteration 10: 0.8205128205128205
	Val acc at iteration 9: 0.8085106382978723
	Train acc at iteration 11: 0.8285256410256411
	Val acc at iteration 10: 0.7659574468085106
	Train acc at iteration 12: 0.8108974358974359
	Val acc at iteration 11: 0.8191489361702128
	Train acc at iteration 13: 0.8125
	Val acc at iteration 12: 0.7659574468085106
	Train acc at iteration 14: 0.8157051282051282
	Val acc at iteration 13: 0.8404255319148937
	Train acc at iteration 15: 0.8333333333333334
	Val acc at iteration 14: 0.7446808510638298
	Train acc at iteration 16: 0.8221153846153846
	Val acc at iteration 15: 0.776595744680851
	Train acc at iteration 17: 0.8237179487179487
	Val acc at iteration 16: 0.776595744680851
	Train acc at iteration 18: 0.8221153846153846
	Val acc at iteration 17: 0.776595744680851
	Train acc at iteration 19: 0.8285256410256411
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.8141025641025641
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.8349358974358975
	Val acc at iteration 20: 0.7659574468085106
	Train acc at iteration 22: 0.8157051282051282
	Val acc at iteration 21: 0.7553191489361702
	Train acc at iteration 23: 0.8173076923076923
	Val acc at iteration 22: 0.7446808510638298
	Train acc at iteration 24: 0.8365384615384616
	Val acc at iteration 23: 0.7659574468085106
	Train acc at iteration 25: 0.8173076923076923
	Val acc at iteration 24: 0.8085106382978723
	Train acc at iteration 26: 0.8381410256410257
	Val acc at iteration 25: 0.8085106382978723
	Train acc at iteration 27: 0.7964743589743589
	Val acc at iteration 26: 0.8191489361702128
	Train acc at iteration 28: 0.8253205128205128
	Val acc at iteration 27: 0.8936170212765957
	Train acc at iteration 29: 0.8189102564102564
	Val acc at iteration 28: 0.8404255319148937
	Train acc at iteration 30: 0.8189102564102564
	Val acc at iteration 29: 0.7978723404255319
	Train acc at iteration 31: 0.8221153846153846
	Val acc at iteration 30: 0.7553191489361702
	Train acc at iteration 32: 0.8173076923076923
	Val acc at iteration 31: 0.7553191489361702
	Train acc at iteration 33: 0.8237179487179487
	Val acc at iteration 32: 0.776595744680851
	Train acc at iteration 34: 0.8221153846153846
	Val acc at iteration 33: 0.7659574468085106
	Train acc at iteration 35: 0.8301282051282052
	Val acc at iteration 34: 0.776595744680851
	Train acc at iteration 36: 0.8108974358974359
	Val acc at iteration 35: 0.776595744680851
	Train acc at iteration 37: 0.8253205128205128
	Val acc at iteration 36: 0.776595744680851
	Train acc at iteration 38: 0.8044871794871795
	Val acc at iteration 37: 0.7659574468085106
	Train acc at iteration 39: 0.8381410256410257
	Val acc at iteration 38: 0.7446808510638298
	Train acc at iteration 40: 0.8493589743589743
	Val acc at iteration 39: 0.8191489361702128
	Train acc at iteration 41: 0.8205128205128205
	Val acc at iteration 40: 0.7553191489361702
	Train acc at iteration 42: 0.8365384615384616
	Val acc at iteration 41: 0.8191489361702128
	Train acc at iteration 43: 0.8365384615384616
	Val acc at iteration 42: 0.776595744680851
	Train acc at iteration 44: 0.8141025641025641
	Val acc at iteration 43: 0.7978723404255319
	Train acc at iteration 45: 0.7932692307692307
	Val acc at iteration 44: 0.776595744680851
	Train acc at iteration 46: 0.8205128205128205
	Val acc at iteration 45: 0.7872340425531915
	Train acc at iteration 47: 0.8285256410256411
	Val acc at iteration 46: 0.7872340425531915
	Train acc at iteration 48: 0.8157051282051282
	Val acc at iteration 47: 0.7872340425531915
	Train acc at iteration 49: 0.8205128205128205
	Val acc at iteration 48: 0.8297872340425532
	Train acc at iteration 50: 0.8333333333333334
	Val acc at iteration 49: 0.7446808510638298
	Train acc at iteration 51: 0.8381410256410257
	Val acc at iteration 50: 0.776595744680851
	Train acc at iteration 52: 0.8060897435897436
	Val acc at iteration 51: 0.8191489361702128
	Train acc at iteration 53: 0.8285256410256411
	Val acc at iteration 52: 0.7659574468085106
	Train acc at iteration 54: 0.8301282051282052
	Val acc at iteration 53: 0.8404255319148937
	Train acc at iteration 55: 0.8028846153846154
	Val acc at iteration 54: 0.8297872340425532
	Train acc at iteration 56: 0.8108974358974359
	Val acc at iteration 55: 0.7340425531914894
	Train acc at iteration 57: 0.8205128205128205
	Val acc at iteration 56: 0.8085106382978723
	Train acc at iteration 58: 0.842948717948718
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.8461538461538461
	Val acc at iteration 58: 0.7446808510638298
	Train acc at iteration 60: 0.8253205128205128
	Val acc at iteration 59: 0.776595744680851
	Train acc at iteration 61: 0.8317307692307693
	Val acc at iteration 60: 0.8085106382978723
	Train acc at iteration 62: 0.8108974358974359
	Val acc at iteration 61: 0.7553191489361702
	Train acc at iteration 63: 0.8125
	Val acc at iteration 62: 0.7553191489361702
	Train acc at iteration 64: 0.8205128205128205
	Val acc at iteration 63: 0.8297872340425532
	Train acc at iteration 65: 0.8349358974358975
	Val acc at iteration 64: 0.776595744680851
	Train acc at iteration 66: 0.8253205128205128
	Val acc at iteration 65: 0.8085106382978723
	Train acc at iteration 67: 0.8237179487179487
	Val acc at iteration 66: 0.7978723404255319
	Train acc at iteration 68: 0.8461538461538461
	Val acc at iteration 67: 0.8297872340425532
	Train acc at iteration 69: 0.8141025641025641
	Val acc at iteration 68: 0.7659574468085106
	Train acc at iteration 70: 0.8173076923076923
	Val acc at iteration 69: 0.723404255319149
	Train acc at iteration 71: 0.8461538461538461
	Val acc at iteration 70: 0.7872340425531915
	Train acc at iteration 72: 0.8285256410256411
	Val acc at iteration 71: 0.8404255319148937
	Train acc at iteration 73: 0.8301282051282052
	Val acc at iteration 72: 0.7340425531914894
	Train acc at iteration 74: 0.8333333333333334
	Val acc at iteration 73: 0.7872340425531915
	Train acc at iteration 75: 0.8317307692307693
	Val acc at iteration 74: 0.7553191489361702
	Train acc at iteration 76: 0.8493589743589743
	Val acc at iteration 75: 0.7553191489361702
	Train acc at iteration 77: 0.8157051282051282
	Val acc at iteration 76: 0.8191489361702128
	Train acc at iteration 78: 0.8205128205128205
	Val acc at iteration 77: 0.8085106382978723
	Train acc at iteration 79: 0.8141025641025641
	Val acc at iteration 78: 0.7872340425531915
	Train acc at iteration 80: 0.8621794871794872
	Val acc at iteration 79: 0.7978723404255319
	Train acc at iteration 81: 0.8125
	Val acc at iteration 80: 0.6914893617021277
	Train acc at iteration 82: 0.8493589743589743
	Val acc at iteration 81: 0.7553191489361702
	Train acc at iteration 83: 0.8557692307692307
	Val acc at iteration 82: 0.7340425531914894
	Train acc at iteration 84: 0.8285256410256411
	Val acc at iteration 83: 0.8085106382978723
	Train acc at iteration 85: 0.8012820512820513
	Val acc at iteration 84: 0.7446808510638298
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6982456140350877
Final val micro accuracy: 0.7872340425531915
Final test macro f1-score: 0.7146341463414634
Final test micro accuracy: 0.8085106382978723
Final validation:
	Cluster: 0.6431182026863098
	Separation: 0.5504069328308105
Final test:
	Cluster: 0.6030405461788177
	Separation: 0.5373077690601349
Saved Results

Attempting combination 17/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.031914893617021274
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6808510638297872
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7772435897435898
	Train Cluster: 0.6499807000160217
	Train Separation: 0.5286781311035156
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.574468085106383
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.6276595744680851
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6170212765957447
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.5638297872340425
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.6276595744680851
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.5531914893617021
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.7446808510638298
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.7978723404255319
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.7553191489361702
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7978723404255319
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.776595744680851
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.6382978723404256
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.6276595744680851
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7980769230769231
	Train Cluster: 0.6425743222236633
	Train Separation: 0.521325659751892
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7127659574468085
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.7340425531914894
	Val acc at iteration 9: 0.776595744680851
	Val acc at iteration 10: 0.7872340425531915
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7659574468085106
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.7446808510638298
	Val acc at iteration 16: 0.8085106382978723
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.7978723404255319
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.7872340425531915
	Val acc at iteration 27: 0.7872340425531915
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.7659574468085106
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.8085106382978723
	Val acc at iteration 35: 0.7978723404255319
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7446808510638298
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7978723404255319
	Val acc at iteration 41: 0.8297872340425532
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.7659574468085106
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7978723404255319
	Val acc at iteration 47: 0.7659574468085106
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.8085106382978723
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.7872340425531915
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7978723404255319
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.8191489361702128
	Val acc at iteration 64: 0.7978723404255319
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7978723404255319
	Val acc at iteration 71: 0.7553191489361702
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.7978723404255319
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.7446808510638298
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7978723404255319
Val acc before epoch 25: 0.7978723404255319
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8285256410256411
	Train Cluster: 0.6456609487533569
	TrainSeparation: 0.5236638903617858
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.0001
	Train acc at iteration 1: 0.8237179487179487
	Val acc at iteration 0: 0.7553191489361702
	Train acc at iteration 2: 0.8605769230769231
	Val acc at iteration 1: 0.776595744680851
	Train acc at iteration 3: 0.8461538461538461
	Val acc at iteration 2: 0.776595744680851
	Train acc at iteration 4: 0.8237179487179487
	Val acc at iteration 3: 0.7872340425531915
	Train acc at iteration 5: 0.8301282051282052
	Val acc at iteration 4: 0.7340425531914894
	Train acc at iteration 6: 0.8221153846153846
	Val acc at iteration 5: 0.7553191489361702
	Train acc at iteration 7: 0.8349358974358975
	Val acc at iteration 6: 0.7446808510638298
	Train acc at iteration 8: 0.8333333333333334
	Val acc at iteration 7: 0.8191489361702128
	Train acc at iteration 9: 0.8461538461538461
	Val acc at iteration 8: 0.8191489361702128
	Train acc at iteration 10: 0.8349358974358975
	Val acc at iteration 9: 0.7446808510638298
	Train acc at iteration 11: 0.8333333333333334
	Val acc at iteration 10: 0.7340425531914894
	Train acc at iteration 12: 0.8333333333333334
	Val acc at iteration 11: 0.8191489361702128
	Train acc at iteration 13: 0.8253205128205128
	Val acc at iteration 12: 0.648936170212766
	Train acc at iteration 14: 0.8381410256410257
	Val acc at iteration 13: 0.776595744680851
	Train acc at iteration 15: 0.8381410256410257
	Val acc at iteration 14: 0.7340425531914894
	Train acc at iteration 16: 0.8493589743589743
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.842948717948718
	Val acc at iteration 16: 0.776595744680851
	Train acc at iteration 18: 0.8605769230769231
	Val acc at iteration 17: 0.7553191489361702
	Train acc at iteration 19: 0.8269230769230769
	Val acc at iteration 18: 0.7340425531914894
	Train acc at iteration 20: 0.8317307692307693
	Val acc at iteration 19: 0.6914893617021277
	Train acc at iteration 21: 0.8349358974358975
	Val acc at iteration 20: 0.7872340425531915
	Train acc at iteration 22: 0.8365384615384616
	Val acc at iteration 21: 0.6808510638297872
	Train acc at iteration 23: 0.8157051282051282
	Val acc at iteration 22: 0.8191489361702128
	Train acc at iteration 24: 0.8333333333333334
	Val acc at iteration 23: 0.8297872340425532
	Train acc at iteration 25: 0.8205128205128205
	Val acc at iteration 24: 0.776595744680851
	Train acc at iteration 26: 0.8301282051282052
	Val acc at iteration 25: 0.7340425531914894
	Train acc at iteration 27: 0.842948717948718
	Val acc at iteration 26: 0.7446808510638298
	Train acc at iteration 28: 0.8493589743589743
	Val acc at iteration 27: 0.7340425531914894
	Train acc at iteration 29: 0.844551282051282
	Val acc at iteration 28: 0.8404255319148937
	Train acc at iteration 30: 0.8157051282051282
	Val acc at iteration 29: 0.8191489361702128
	Train acc at iteration 31: 0.8397435897435898
	Val acc at iteration 30: 0.776595744680851
	Train acc at iteration 32: 0.8557692307692307
	Val acc at iteration 31: 0.776595744680851
	Train acc at iteration 33: 0.8589743589743589
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.8525641025641025
	Val acc at iteration 33: 0.8085106382978723
	Train acc at iteration 35: 0.8317307692307693
	Val acc at iteration 34: 0.7872340425531915
	Train acc at iteration 36: 0.8317307692307693
	Val acc at iteration 35: 0.7872340425531915
	Train acc at iteration 37: 0.875
	Val acc at iteration 36: 0.7659574468085106
	Train acc at iteration 38: 0.8301282051282052
	Val acc at iteration 37: 0.8191489361702128
	Train acc at iteration 39: 0.8285256410256411
	Val acc at iteration 38: 0.7340425531914894
	Train acc at iteration 40: 0.8413461538461539
	Val acc at iteration 39: 0.7872340425531915
	Train acc at iteration 41: 0.842948717948718
	Val acc at iteration 40: 0.776595744680851
	Train acc at iteration 42: 0.8349358974358975
	Val acc at iteration 41: 0.8297872340425532
	Train acc at iteration 43: 0.8589743589743589
	Val acc at iteration 42: 0.7553191489361702
	Train acc at iteration 44: 0.844551282051282
	Val acc at iteration 43: 0.7872340425531915
	Train acc at iteration 45: 0.8541666666666666
	Val acc at iteration 44: 0.7340425531914894
	Train acc at iteration 46: 0.8349358974358975
	Val acc at iteration 45: 0.8085106382978723
	Train acc at iteration 47: 0.8493589743589743
	Val acc at iteration 46: 0.776595744680851
	Train acc at iteration 48: 0.8381410256410257
	Val acc at iteration 47: 0.776595744680851
	Train acc at iteration 49: 0.8189102564102564
	Val acc at iteration 48: 0.8085106382978723
	Train acc at iteration 50: 0.8461538461538461
	Val acc at iteration 49: 0.776595744680851
	Train acc at iteration 51: 0.8397435897435898
	Val acc at iteration 50: 0.8085106382978723
	Train acc at iteration 52: 0.8012820512820513
	Val acc at iteration 51: 0.7978723404255319
	Train acc at iteration 53: 0.8397435897435898
	Val acc at iteration 52: 0.723404255319149
	Train acc at iteration 54: 0.8237179487179487
	Val acc at iteration 53: 0.776595744680851
	Train acc at iteration 55: 0.8205128205128205
	Val acc at iteration 54: 0.7659574468085106
	Train acc at iteration 56: 0.8493589743589743
	Val acc at iteration 55: 0.7446808510638298
	Train acc at iteration 57: 0.8589743589743589
	Val acc at iteration 56: 0.776595744680851
	Train acc at iteration 58: 0.8205128205128205
	Val acc at iteration 57: 0.8085106382978723
	Train acc at iteration 59: 0.8413461538461539
	Val acc at iteration 58: 0.7340425531914894
	Train acc at iteration 60: 0.8333333333333334
	Val acc at iteration 59: 0.7872340425531915
	Train acc at iteration 61: 0.844551282051282
	Val acc at iteration 60: 0.7872340425531915
	Train acc at iteration 62: 0.8477564102564102
	Val acc at iteration 61: 0.8191489361702128
	Train acc at iteration 63: 0.8317307692307693
	Val acc at iteration 62: 0.7872340425531915
	Train acc at iteration 64: 0.8141025641025641
	Val acc at iteration 63: 0.7978723404255319
	Train acc at iteration 65: 0.8653846153846154
	Val acc at iteration 64: 0.776595744680851
	Train acc at iteration 66: 0.8685897435897436
	Val acc at iteration 65: 0.7340425531914894
	Train acc at iteration 67: 0.8221153846153846
	Val acc at iteration 66: 0.7553191489361702
	Train acc at iteration 68: 0.8381410256410257
	Val acc at iteration 67: 0.8085106382978723
	Train acc at iteration 69: 0.8509615384615384
	Val acc at iteration 68: 0.7659574468085106
	Train acc at iteration 70: 0.8365384615384616
	Val acc at iteration 69: 0.7978723404255319
	Train acc at iteration 71: 0.8333333333333334
	Val acc at iteration 70: 0.7659574468085106
	Train acc at iteration 72: 0.8461538461538461
	Val acc at iteration 71: 0.723404255319149
	Train acc at iteration 73: 0.8333333333333334
	Val acc at iteration 72: 0.7553191489361702
	Train acc at iteration 74: 0.842948717948718
	Val acc at iteration 73: 0.8297872340425532
	Train acc at iteration 75: 0.8525641025641025
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.8493589743589743
	Val acc at iteration 75: 0.776595744680851
	Train acc at iteration 77: 0.844551282051282
	Val acc at iteration 76: 0.7872340425531915
	Train acc at iteration 78: 0.8557692307692307
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.8573717948717948
	Val acc at iteration 78: 0.7127659574468085
	Train acc at iteration 80: 0.8685897435897436
	Val acc at iteration 79: 0.8085106382978723
	Train acc at iteration 81: 0.8509615384615384
	Val acc at iteration 80: 0.7978723404255319
	Train acc at iteration 82: 0.8413461538461539
	Val acc at iteration 81: 0.7978723404255319
	Train acc at iteration 83: 0.8092948717948718
	Val acc at iteration 82: 0.7872340425531915
	Train acc at iteration 84: 0.8413461538461539
	Val acc at iteration 83: 0.7340425531914894
	Train acc at iteration 85: 0.8413461538461539
	Val acc at iteration 84: 0.8617021276595744
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6611111111111111
Final val micro accuracy: 0.7553191489361702
Final test macro f1-score: 0.6317460317460317
Final test micro accuracy: 0.7553191489361702
Final validation:
	Cluster: 0.6323307156562805
	Separation: 0.5377886295318604
Final test:
	Cluster: 0.6157374382019043
	Separation: 0.5315426588058472
Saved Results

Attempting combination 18/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 5e-05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8404255319148937
Push epoch
After push, before retraining last layer:
	Train acc: 0.7884615384615384
	Train Cluster: 0.6466764211654663
	Train Separation: 0.5237576246261597
(Directly after push) Val acc at iteration 0: 0.5957446808510638
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5212765957446809
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.6170212765957447
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.6170212765957447
	Val acc at iteration 7: 0.5851063829787234
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.6063829787234043
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.5851063829787234
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.6382978723404256
	Val acc at iteration 26: 0.6170212765957447
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.5851063829787234
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.6382978723404256
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.6063829787234043
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.776595744680851
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.648936170212766
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 13: 0.7021276595744681
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7948717948717948
	Train Cluster: 0.6431834936141968
	Train Separation: 0.5197579145431519
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.7978723404255319
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.7872340425531915
	Val acc at iteration 4: 0.7659574468085106
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.776595744680851
	Val acc at iteration 7: 0.7978723404255319
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.7446808510638298
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.7446808510638298
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.8191489361702128
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.7978723404255319
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.7659574468085106
	Val acc at iteration 39: 0.8191489361702128
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.7978723404255319
	Val acc at iteration 42: 0.7872340425531915
	Val acc at iteration 43: 0.7978723404255319
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7978723404255319
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.776595744680851
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.8297872340425532
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.8085106382978723
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.8191489361702128
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7553191489361702
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.8297872340425532
	Val acc at iteration 78: 0.7978723404255319
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 25: 0.7446808510638298
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8493589743589743
	Train Cluster: 0.6467239499092102
	TrainSeparation: 0.521642005443573
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 5e-05
	Train acc at iteration 1: 0.8333333333333334
	Val acc at iteration 0: 0.7659574468085106
	Train acc at iteration 2: 0.8301282051282052
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.8349358974358975
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.8477564102564102
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.8301282051282052
	Val acc at iteration 4: 0.776595744680851
	Train acc at iteration 6: 0.8157051282051282
	Val acc at iteration 5: 0.7127659574468085
	Train acc at iteration 7: 0.8509615384615384
	Val acc at iteration 6: 0.6914893617021277
	Train acc at iteration 8: 0.8253205128205128
	Val acc at iteration 7: 0.7340425531914894
	Train acc at iteration 9: 0.8365384615384616
	Val acc at iteration 8: 0.7446808510638298
	Train acc at iteration 10: 0.8461538461538461
	Val acc at iteration 9: 0.8191489361702128
	Train acc at iteration 11: 0.842948717948718
	Val acc at iteration 10: 0.6595744680851063
	Train acc at iteration 12: 0.8157051282051282
	Val acc at iteration 11: 0.6914893617021277
	Train acc at iteration 13: 0.8381410256410257
	Val acc at iteration 12: 0.7659574468085106
	Train acc at iteration 14: 0.8397435897435898
	Val acc at iteration 13: 0.7340425531914894
	Train acc at iteration 15: 0.8189102564102564
	Val acc at iteration 14: 0.6914893617021277
	Train acc at iteration 16: 0.8221153846153846
	Val acc at iteration 15: 0.7553191489361702
	Train acc at iteration 17: 0.8333333333333334
	Val acc at iteration 16: 0.8404255319148937
	Train acc at iteration 18: 0.8365384615384616
	Val acc at iteration 17: 0.7127659574468085
	Train acc at iteration 19: 0.8044871794871795
	Val acc at iteration 18: 0.776595744680851
	Train acc at iteration 20: 0.8253205128205128
	Val acc at iteration 19: 0.6808510638297872
	Train acc at iteration 21: 0.8669871794871795
	Val acc at iteration 20: 0.7872340425531915
	Train acc at iteration 22: 0.8525641025641025
	Val acc at iteration 21: 0.7872340425531915
	Train acc at iteration 23: 0.842948717948718
	Val acc at iteration 22: 0.723404255319149
	Train acc at iteration 24: 0.8237179487179487
	Val acc at iteration 23: 0.723404255319149
	Train acc at iteration 25: 0.8253205128205128
	Val acc at iteration 24: 0.7659574468085106
	Train acc at iteration 26: 0.8285256410256411
	Val acc at iteration 25: 0.7659574468085106
	Train acc at iteration 27: 0.8317307692307693
	Val acc at iteration 26: 0.6914893617021277
	Train acc at iteration 28: 0.7932692307692307
	Val acc at iteration 27: 0.8191489361702128
	Train acc at iteration 29: 0.8589743589743589
	Val acc at iteration 28: 0.7978723404255319
	Train acc at iteration 30: 0.8237179487179487
	Val acc at iteration 29: 0.7340425531914894
	Train acc at iteration 31: 0.8157051282051282
	Val acc at iteration 30: 0.7553191489361702
	Train acc at iteration 32: 0.8285256410256411
	Val acc at iteration 31: 0.7659574468085106
	Train acc at iteration 33: 0.8205128205128205
	Val acc at iteration 32: 0.776595744680851
	Train acc at iteration 34: 0.8637820512820513
	Val acc at iteration 33: 0.7872340425531915
	Train acc at iteration 35: 0.8333333333333334
	Val acc at iteration 34: 0.7659574468085106
	Train acc at iteration 36: 0.8205128205128205
	Val acc at iteration 35: 0.7659574468085106
	Train acc at iteration 37: 0.8221153846153846
	Val acc at iteration 36: 0.7446808510638298
	Train acc at iteration 38: 0.8413461538461539
	Val acc at iteration 37: 0.7340425531914894
	Train acc at iteration 39: 0.8269230769230769
	Val acc at iteration 38: 0.723404255319149
	Train acc at iteration 40: 0.8317307692307693
	Val acc at iteration 39: 0.7553191489361702
	Train acc at iteration 41: 0.8141025641025641
	Val acc at iteration 40: 0.8404255319148937
	Train acc at iteration 42: 0.8349358974358975
	Val acc at iteration 41: 0.7978723404255319
	Train acc at iteration 43: 0.8301282051282052
	Val acc at iteration 42: 0.7553191489361702
	Train acc at iteration 44: 0.8269230769230769
	Val acc at iteration 43: 0.7553191489361702
	Train acc at iteration 45: 0.8253205128205128
	Val acc at iteration 44: 0.7978723404255319
	Train acc at iteration 46: 0.8269230769230769
	Val acc at iteration 45: 0.7446808510638298
	Train acc at iteration 47: 0.8141025641025641
	Val acc at iteration 46: 0.7978723404255319
	Train acc at iteration 48: 0.8221153846153846
	Val acc at iteration 47: 0.7127659574468085
	Train acc at iteration 49: 0.8157051282051282
	Val acc at iteration 48: 0.7659574468085106
	Train acc at iteration 50: 0.8413461538461539
	Val acc at iteration 49: 0.7446808510638298
	Train acc at iteration 51: 0.8253205128205128
	Val acc at iteration 50: 0.7659574468085106
	Train acc at iteration 52: 0.8012820512820513
	Val acc at iteration 51: 0.8191489361702128
	Train acc at iteration 53: 0.8413461538461539
	Val acc at iteration 52: 0.7340425531914894
	Train acc at iteration 54: 0.8028846153846154
	Val acc at iteration 53: 0.7446808510638298
	Train acc at iteration 55: 0.8365384615384616
	Val acc at iteration 54: 0.7127659574468085
	Train acc at iteration 56: 0.8413461538461539
	Val acc at iteration 55: 0.8191489361702128
	Train acc at iteration 57: 0.8157051282051282
	Val acc at iteration 56: 0.776595744680851
	Train acc at iteration 58: 0.8301282051282052
	Val acc at iteration 57: 0.776595744680851
	Train acc at iteration 59: 0.8317307692307693
	Val acc at iteration 58: 0.7659574468085106
	Train acc at iteration 60: 0.8108974358974359
	Val acc at iteration 59: 0.7978723404255319
	Train acc at iteration 61: 0.8509615384615384
	Val acc at iteration 60: 0.7446808510638298
	Train acc at iteration 62: 0.8477564102564102
	Val acc at iteration 61: 0.723404255319149
	Train acc at iteration 63: 0.8205128205128205
	Val acc at iteration 62: 0.723404255319149
	Train acc at iteration 64: 0.8205128205128205
	Val acc at iteration 63: 0.723404255319149
	Train acc at iteration 65: 0.844551282051282
	Val acc at iteration 64: 0.8085106382978723
	Train acc at iteration 66: 0.8365384615384616
	Val acc at iteration 65: 0.8297872340425532
	Train acc at iteration 67: 0.8028846153846154
	Val acc at iteration 66: 0.7446808510638298
	Train acc at iteration 68: 0.7900641025641025
	Val acc at iteration 67: 0.776595744680851
	Train acc at iteration 69: 0.8221153846153846
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.8108974358974359
	Val acc at iteration 69: 0.7021276595744681
	Train acc at iteration 71: 0.8365384615384616
	Val acc at iteration 70: 0.7659574468085106
	Train acc at iteration 72: 0.8189102564102564
	Val acc at iteration 71: 0.6914893617021277
	Train acc at iteration 73: 0.8173076923076923
	Val acc at iteration 72: 0.723404255319149
	Train acc at iteration 74: 0.8157051282051282
	Val acc at iteration 73: 0.7553191489361702
	Train acc at iteration 75: 0.8060897435897436
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.8237179487179487
	Val acc at iteration 75: 0.7872340425531915
	Train acc at iteration 77: 0.8269230769230769
	Val acc at iteration 76: 0.6808510638297872
	Train acc at iteration 78: 0.8125
	Val acc at iteration 77: 0.7659574468085106
	Train acc at iteration 79: 0.8317307692307693
	Val acc at iteration 78: 0.7446808510638298
	Train acc at iteration 80: 0.8076923076923077
	Val acc at iteration 79: 0.776595744680851
	Train acc at iteration 81: 0.8092948717948718
	Val acc at iteration 80: 0.8191489361702128
	Train acc at iteration 82: 0.8285256410256411
	Val acc at iteration 81: 0.7021276595744681
	Train acc at iteration 83: 0.8333333333333334
	Val acc at iteration 82: 0.7021276595744681
	Train acc at iteration 84: 0.8108974358974359
	Val acc at iteration 83: 0.776595744680851
	Train acc at iteration 85: 0.8141025641025641
	Val acc at iteration 84: 0.7872340425531915
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6276595744680851
Final val micro accuracy: 0.723404255319149
Final test macro f1-score: 0.5285714285714286
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6286967098712921
	Separation: 0.5446187555789948
Final test:
	Cluster: 0.6066021621227264
	Separation: 0.5347819328308105
Saved Results

Attempting combination 19/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.35106382978723405
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6808510638297872
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7516025641025641
	Train Cluster: 0.641604220867157
	Train Separation: 0.5247570991516113
(Directly after push) Val acc at iteration 0: 0.5851063829787234
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.5638297872340425
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6170212765957447
	Val acc at iteration 4: 0.6063829787234043
	Val acc at iteration 5: 0.574468085106383
	Val acc at iteration 6: 0.5851063829787234
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.5531914893617021
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.5531914893617021
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.6170212765957447
	Val acc at iteration 16: 0.6276595744680851
	Val acc at iteration 17: 0.6063829787234043
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.5638297872340425
	Val acc at iteration 21: 0.5425531914893617
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.6170212765957447
	Val acc at iteration 28: 0.574468085106383
	Val acc at iteration 29: 0.5957446808510638
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.5851063829787234
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.6170212765957447
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.574468085106383
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.5957446808510638
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.574468085106383
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6170212765957447
	Val acc at iteration 53: 0.6702127659574468
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.6170212765957447
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.648936170212766
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6276595744680851
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.6382978723404256
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.6170212765957447
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.6170212765957447
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.648936170212766
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.6063829787234043
	Val acc at iteration 82: 0.6382978723404256
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.648936170212766
Val acc before epoch 13: 0.648936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8617021276595744
Push epoch
After push, before retraining last layer:
	Train acc: 0.7564102564102564
	Train Cluster: 0.6434592485427857
	Train Separation: 0.5220781445503235
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.5851063829787234
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7127659574468085
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.7978723404255319
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6170212765957447
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7872340425531915
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.648936170212766
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.7553191489361702
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7446808510638298
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.7659574468085106
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6170212765957447
	Val acc at iteration 68: 0.6382978723404256
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.6170212765957447
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.6276595744680851
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.6276595744680851
Val acc before epoch 25: 0.723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8125
	Train Cluster: 0.6458239078521728
	TrainSeparation: 0.5173972964286804
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.20673076923076922
	Val acc at iteration 0: 0.02127659574468085
	Train acc at iteration 2: 0.011217948717948718
	Val acc at iteration 1: 0.010638297872340425
	Train acc at iteration 3: 0.022435897435897436
	Val acc at iteration 2: 0.02127659574468085
	Train acc at iteration 4: 0.00641025641025641
	Val acc at iteration 3: 0.0425531914893617
	Train acc at iteration 5: 0.02564102564102564
	Val acc at iteration 4: 0.0425531914893617
	Train acc at iteration 6: 0.04807692307692308
	Val acc at iteration 5: 0.05319148936170213
	Train acc at iteration 7: 0.041666666666666664
	Val acc at iteration 6: 0.06382978723404255
	Train acc at iteration 8: 0.05128205128205128
	Val acc at iteration 7: 0.031914893617021274
	Train acc at iteration 9: 0.05608974358974359
	Val acc at iteration 8: 0.0851063829787234
	Train acc at iteration 10: 0.04487179487179487
	Val acc at iteration 9: 0.06382978723404255
	Train acc at iteration 11: 0.03685897435897436
	Val acc at iteration 10: 0.07446808510638298
	Train acc at iteration 12: 0.06570512820512821
	Val acc at iteration 11: 0.06382978723404255
	Train acc at iteration 13: 0.07211538461538461
	Val acc at iteration 12: 0.11702127659574468
	Train acc at iteration 14: 0.09294871794871795
	Val acc at iteration 13: 0.07446808510638298
	Train acc at iteration 15: 0.08173076923076923
	Val acc at iteration 14: 0.0851063829787234
	Train acc at iteration 16: 0.09775641025641026
	Val acc at iteration 15: 0.1276595744680851
	Train acc at iteration 17: 0.13141025641025642
	Val acc at iteration 16: 0.09574468085106383
	Train acc at iteration 18: 0.11858974358974358
	Val acc at iteration 17: 0.20212765957446807
	Train acc at iteration 19: 0.10416666666666667
	Val acc at iteration 18: 0.18085106382978725
	Train acc at iteration 20: 0.1778846153846154
	Val acc at iteration 19: 0.1702127659574468
	Train acc at iteration 21: 0.11057692307692307
	Val acc at iteration 20: 0.13829787234042554
	Train acc at iteration 22: 0.15544871794871795
	Val acc at iteration 21: 0.18085106382978725
	Train acc at iteration 23: 0.15705128205128205
	Val acc at iteration 22: 0.22340425531914893
	Train acc at iteration 24: 0.13942307692307693
	Val acc at iteration 23: 0.20212765957446807
	Train acc at iteration 25: 0.14262820512820512
	Val acc at iteration 24: 0.20212765957446807
	Train acc at iteration 26: 0.20192307692307693
	Val acc at iteration 25: 0.1595744680851064
	Train acc at iteration 27: 0.16185897435897437
	Val acc at iteration 26: 0.1595744680851064
	Train acc at iteration 28: 0.1858974358974359
	Val acc at iteration 27: 0.14893617021276595
	Train acc at iteration 29: 0.16346153846153846
	Val acc at iteration 28: 0.10638297872340426
	Train acc at iteration 30: 0.14583333333333334
	Val acc at iteration 29: 0.19148936170212766
	Train acc at iteration 31: 0.16025641025641027
	Val acc at iteration 30: 0.2127659574468085
	Train acc at iteration 32: 0.21634615384615385
	Val acc at iteration 31: 0.22340425531914893
	Train acc at iteration 33: 0.20673076923076922
	Val acc at iteration 32: 0.20212765957446807
	Train acc at iteration 34: 0.2516025641025641
	Val acc at iteration 33: 0.1702127659574468
	Train acc at iteration 35: 0.2483974358974359
	Val acc at iteration 34: 0.22340425531914893
	Train acc at iteration 36: 0.21314102564102563
	Val acc at iteration 35: 0.3191489361702128
	Train acc at iteration 37: 0.2916666666666667
	Val acc at iteration 36: 0.2872340425531915
	Train acc at iteration 38: 0.2483974358974359
	Val acc at iteration 37: 0.19148936170212766
	Train acc at iteration 39: 0.2676282051282051
	Val acc at iteration 38: 0.26595744680851063
	Train acc at iteration 40: 0.2532051282051282
	Val acc at iteration 39: 0.2127659574468085
	Train acc at iteration 41: 0.27403846153846156
	Val acc at iteration 40: 0.20212765957446807
	Train acc at iteration 42: 0.20032051282051283
	Val acc at iteration 41: 0.2127659574468085
	Train acc at iteration 43: 0.24358974358974358
	Val acc at iteration 42: 0.32978723404255317
	Train acc at iteration 44: 0.3173076923076923
	Val acc at iteration 43: 0.2978723404255319
	Train acc at iteration 45: 0.26121794871794873
	Val acc at iteration 44: 0.3191489361702128
	Train acc at iteration 46: 0.3141025641025641
	Val acc at iteration 45: 0.3404255319148936
	Train acc at iteration 47: 0.33653846153846156
	Val acc at iteration 46: 0.32978723404255317
	Train acc at iteration 48: 0.27564102564102566
	Val acc at iteration 47: 0.30851063829787234
	Train acc at iteration 49: 0.30448717948717946
	Val acc at iteration 48: 0.40425531914893614
	Train acc at iteration 50: 0.41185897435897434
	Val acc at iteration 49: 0.3617021276595745
	Train acc at iteration 51: 0.3301282051282051
	Val acc at iteration 50: 0.24468085106382978
	Train acc at iteration 52: 0.30288461538461536
	Val acc at iteration 51: 0.3404255319148936
	Train acc at iteration 53: 0.3685897435897436
	Val acc at iteration 52: 0.22340425531914893
	Train acc at iteration 54: 0.296474358974359
	Val acc at iteration 53: 0.2553191489361702
	Train acc at iteration 55: 0.3894230769230769
	Val acc at iteration 54: 0.44680851063829785
	Train acc at iteration 56: 0.4375
	Val acc at iteration 55: 0.30851063829787234
	Train acc at iteration 57: 0.296474358974359
	Val acc at iteration 56: 0.3191489361702128
	Train acc at iteration 58: 0.46634615384615385
	Val acc at iteration 57: 0.44680851063829785
	Train acc at iteration 59: 0.3926282051282051
	Val acc at iteration 58: 0.3404255319148936
	Train acc at iteration 60: 0.3541666666666667
	Val acc at iteration 59: 0.3191489361702128
	Train acc at iteration 61: 0.4198717948717949
	Val acc at iteration 60: 0.3723404255319149
	Train acc at iteration 62: 0.2916666666666667
	Val acc at iteration 61: 0.23404255319148937
	Train acc at iteration 63: 0.34615384615384615
	Val acc at iteration 62: 0.4148936170212766
	Train acc at iteration 64: 0.4519230769230769
	Val acc at iteration 63: 0.30851063829787234
	Train acc at iteration 65: 0.4310897435897436
	Val acc at iteration 64: 0.44680851063829785
	Train acc at iteration 66: 0.4951923076923077
	Val acc at iteration 65: 0.39361702127659576
	Train acc at iteration 67: 0.4407051282051282
	Val acc at iteration 66: 0.48936170212765956
	Train acc at iteration 68: 0.4519230769230769
	Val acc at iteration 67: 0.39361702127659576
	Train acc at iteration 69: 0.4407051282051282
	Val acc at iteration 68: 0.43617021276595747
	Train acc at iteration 70: 0.4807692307692308
	Val acc at iteration 69: 0.43617021276595747
	Train acc at iteration 71: 0.5368589743589743
	Val acc at iteration 70: 0.44680851063829785
	Train acc at iteration 72: 0.46474358974358976
	Val acc at iteration 71: 0.39361702127659576
	Train acc at iteration 73: 0.4439102564102564
	Val acc at iteration 72: 0.48936170212765956
	Train acc at iteration 74: 0.46955128205128205
	Val acc at iteration 73: 0.5106382978723404
	Train acc at iteration 75: 0.5432692307692307
	Val acc at iteration 74: 0.20212765957446807
	Train acc at iteration 76: 0.40064102564102566
	Val acc at iteration 75: 0.574468085106383
	Train acc at iteration 77: 0.5753205128205128
	Val acc at iteration 76: 0.574468085106383
	Train acc at iteration 78: 0.5560897435897436
	Val acc at iteration 77: 0.20212765957446807
	Train acc at iteration 79: 0.4775641025641026
	Val acc at iteration 78: 0.5319148936170213
	Train acc at iteration 80: 0.5432692307692307
	Val acc at iteration 79: 0.6063829787234043
	Train acc at iteration 81: 0.5608974358974359
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.5785256410256411
	Val acc at iteration 81: 0.6914893617021277
	Train acc at iteration 83: 0.6025641025641025
	Val acc at iteration 82: 0.5
	Train acc at iteration 84: 0.5881410256410257
	Val acc at iteration 83: 0.5
	Train acc at iteration 85: 0.5833333333333334
	Val acc at iteration 84: 0.648936170212766
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5034256559766763
Final val micro accuracy: 0.6170212765957447
Final test macro f1-score: 0.496031746031746
Final test micro accuracy: 0.5957446808510638
Final validation:
	Cluster: 0.6185251176357269
	Separation: 0.5410119593143463
Final test:
	Cluster: 0.5962915122509003
	Separation: 0.5336216986179352
Saved Results

Attempting combination 20/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.75
	Train Cluster: 0.6445664048194886
	Train Separation: 0.5227127432823181
(Directly after push) Val acc at iteration 0: 0.574468085106383
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5425531914893617
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.5638297872340425
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.5957446808510638
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.5957446808510638
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.6063829787234043
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6063829787234043
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.5638297872340425
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.5851063829787234
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6170212765957447
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6170212765957447
	Val acc at iteration 26: 0.6063829787234043
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.6063829787234043
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6170212765957447
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.6063829787234043
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.5957446808510638
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.6276595744680851
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.5957446808510638
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.5851063829787234
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.6276595744680851
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.5851063829787234
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.6382978723404256
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.6063829787234043
	Val acc at iteration 82: 0.5531914893617021
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.6595744680851063
Val acc before epoch 13: 0.6808510638297872
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7659574468085106
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8125
	Train Cluster: 0.6495160698890686
	Train Separation: 0.5190173864364624
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7127659574468085
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.7872340425531915
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.6808510638297872
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.648936170212766
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.6276595744680851
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.648936170212766
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.6595744680851063
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.7021276595744681
Val acc before epoch 25: 0.7340425531914894
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8173076923076923
	Train Cluster: 0.6464289784431457
	TrainSeparation: 0.5149365067481995
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.22435897435897437
	Val acc at iteration 0: 0.0425531914893617
	Train acc at iteration 2: 0.05128205128205128
	Val acc at iteration 1: 0.13829787234042554
	Train acc at iteration 3: 0.09775641025641026
	Val acc at iteration 2: 0.18085106382978725
	Train acc at iteration 4: 0.08333333333333333
	Val acc at iteration 3: 0.10638297872340426
	Train acc at iteration 5: 0.11378205128205128
	Val acc at iteration 4: 0.031914893617021274
	Train acc at iteration 6: 0.060897435897435896
	Val acc at iteration 5: 0.0425531914893617
	Train acc at iteration 7: 0.052884615384615384
	Val acc at iteration 6: 0.0425531914893617
	Train acc at iteration 8: 0.02403846153846154
	Val acc at iteration 7: 0.05319148936170213
	Train acc at iteration 9: 0.038461538461538464
	Val acc at iteration 8: 0.031914893617021274
	Train acc at iteration 10: 0.046474358974358976
	Val acc at iteration 9: 0.0851063829787234
	Train acc at iteration 11: 0.10576923076923077
	Val acc at iteration 10: 0.22340425531914893
	Train acc at iteration 12: 0.08974358974358974
	Val acc at iteration 11: 0.0851063829787234
	Train acc at iteration 13: 0.10576923076923077
	Val acc at iteration 12: 0.18085106382978725
	Train acc at iteration 14: 0.08012820512820513
	Val acc at iteration 13: 0.05319148936170213
	Train acc at iteration 15: 0.1233974358974359
	Val acc at iteration 14: 0.14893617021276595
	Train acc at iteration 16: 0.10576923076923077
	Val acc at iteration 15: 0.11702127659574468
	Train acc at iteration 17: 0.10416666666666667
	Val acc at iteration 16: 0.11702127659574468
	Train acc at iteration 18: 0.15384615384615385
	Val acc at iteration 17: 0.19148936170212766
	Train acc at iteration 19: 0.14903846153846154
	Val acc at iteration 18: 0.1276595744680851
	Train acc at iteration 20: 0.15384615384615385
	Val acc at iteration 19: 0.23404255319148937
	Train acc at iteration 21: 0.1891025641025641
	Val acc at iteration 20: 0.2127659574468085
	Train acc at iteration 22: 0.20512820512820512
	Val acc at iteration 21: 0.18085106382978725
	Train acc at iteration 23: 0.1858974358974359
	Val acc at iteration 22: 0.26595744680851063
	Train acc at iteration 24: 0.22756410256410256
	Val acc at iteration 23: 0.18085106382978725
	Train acc at iteration 25: 0.1842948717948718
	Val acc at iteration 24: 0.18085106382978725
	Train acc at iteration 26: 0.2564102564102564
	Val acc at iteration 25: 0.2553191489361702
	Train acc at iteration 27: 0.22916666666666666
	Val acc at iteration 26: 0.3404255319148936
	Train acc at iteration 28: 0.3317307692307692
	Val acc at iteration 27: 0.3617021276595745
	Train acc at iteration 29: 0.2532051282051282
	Val acc at iteration 28: 0.35106382978723405
	Train acc at iteration 30: 0.28365384615384615
	Val acc at iteration 29: 0.32978723404255317
	Train acc at iteration 31: 0.32051282051282054
	Val acc at iteration 30: 0.425531914893617
	Train acc at iteration 32: 0.34134615384615385
	Val acc at iteration 31: 0.2978723404255319
	Train acc at iteration 33: 0.3108974358974359
	Val acc at iteration 32: 0.4148936170212766
	Train acc at iteration 34: 0.2644230769230769
	Val acc at iteration 33: 0.3829787234042553
	Train acc at iteration 35: 0.3926282051282051
	Val acc at iteration 34: 0.46808510638297873
	Train acc at iteration 36: 0.38621794871794873
	Val acc at iteration 35: 0.425531914893617
	Train acc at iteration 37: 0.4775641025641026
	Val acc at iteration 36: 0.3829787234042553
	Train acc at iteration 38: 0.40384615384615385
	Val acc at iteration 37: 0.5319148936170213
	Train acc at iteration 39: 0.4391025641025641
	Val acc at iteration 38: 0.3617021276595745
	Train acc at iteration 40: 0.4791666666666667
	Val acc at iteration 39: 0.46808510638297873
	Train acc at iteration 41: 0.47596153846153844
	Val acc at iteration 40: 0.5212765957446809
	Train acc at iteration 42: 0.5064102564102564
	Val acc at iteration 41: 0.425531914893617
	Train acc at iteration 43: 0.4342948717948718
	Val acc at iteration 42: 0.4787234042553192
	Train acc at iteration 44: 0.5416666666666666
	Val acc at iteration 43: 0.5212765957446809
	Train acc at iteration 45: 0.5384615384615384
	Val acc at iteration 44: 0.39361702127659576
	Train acc at iteration 46: 0.5112179487179487
	Val acc at iteration 45: 0.5106382978723404
	Train acc at iteration 47: 0.5288461538461539
	Val acc at iteration 46: 0.5319148936170213
	Train acc at iteration 48: 0.5576923076923077
	Val acc at iteration 47: 0.5
	Train acc at iteration 49: 0.5641025641025641
	Val acc at iteration 48: 0.5212765957446809
	Train acc at iteration 50: 0.5560897435897436
	Val acc at iteration 49: 0.425531914893617
	Train acc at iteration 51: 0.5592948717948718
	Val acc at iteration 50: 0.574468085106383
	Train acc at iteration 52: 0.594551282051282
	Val acc at iteration 51: 0.5531914893617021
	Train acc at iteration 53: 0.6201923076923077
	Val acc at iteration 52: 0.5212765957446809
	Train acc at iteration 54: 0.6073717948717948
	Val acc at iteration 53: 0.4787234042553192
	Train acc at iteration 55: 0.6233974358974359
	Val acc at iteration 54: 0.6063829787234043
	Train acc at iteration 56: 0.5737179487179487
	Val acc at iteration 55: 0.5531914893617021
	Train acc at iteration 57: 0.6314102564102564
	Val acc at iteration 56: 0.5957446808510638
	Train acc at iteration 58: 0.6362179487179487
	Val acc at iteration 57: 0.6063829787234043
	Train acc at iteration 59: 0.5785256410256411
	Val acc at iteration 58: 0.574468085106383
	Train acc at iteration 60: 0.6057692307692307
	Val acc at iteration 59: 0.5106382978723404
	Train acc at iteration 61: 0.5961538461538461
	Val acc at iteration 60: 0.6170212765957447
	Train acc at iteration 62: 0.6426282051282052
	Val acc at iteration 61: 0.5531914893617021
	Train acc at iteration 63: 0.6698717948717948
	Val acc at iteration 62: 0.6808510638297872
	Train acc at iteration 64: 0.6746794871794872
	Val acc at iteration 63: 0.5531914893617021
	Train acc at iteration 65: 0.6153846153846154
	Val acc at iteration 64: 0.4574468085106383
	Train acc at iteration 66: 0.6073717948717948
	Val acc at iteration 65: 0.5957446808510638
	Train acc at iteration 67: 0.6875
	Val acc at iteration 66: 0.5638297872340425
	Train acc at iteration 68: 0.6298076923076923
	Val acc at iteration 67: 0.5425531914893617
	Train acc at iteration 69: 0.6650641025641025
	Val acc at iteration 68: 0.5957446808510638
	Train acc at iteration 70: 0.655448717948718
	Val acc at iteration 69: 0.574468085106383
	Train acc at iteration 71: 0.6923076923076923
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.6442307692307693
	Val acc at iteration 71: 0.6595744680851063
	Train acc at iteration 73: 0.6794871794871795
	Val acc at iteration 72: 0.5851063829787234
	Train acc at iteration 74: 0.7067307692307693
	Val acc at iteration 73: 0.5638297872340425
	Train acc at iteration 75: 0.6939102564102564
	Val acc at iteration 74: 0.6063829787234043
	Train acc at iteration 76: 0.6794871794871795
	Val acc at iteration 75: 0.6063829787234043
	Train acc at iteration 77: 0.6426282051282052
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.7083333333333334
	Val acc at iteration 77: 0.6170212765957447
	Train acc at iteration 79: 0.6971153846153846
	Val acc at iteration 78: 0.7127659574468085
	Train acc at iteration 80: 0.6714743589743589
	Val acc at iteration 79: 0.6808510638297872
	Train acc at iteration 81: 0.7243589743589743
	Val acc at iteration 80: 0.6382978723404256
	Train acc at iteration 82: 0.6858974358974359
	Val acc at iteration 81: 0.5851063829787234
	Train acc at iteration 83: 0.7131410256410257
	Val acc at iteration 82: 0.6595744680851063
	Train acc at iteration 84: 0.6858974358974359
	Val acc at iteration 83: 0.6808510638297872
	Train acc at iteration 85: 0.7131410256410257
	Val acc at iteration 84: 0.6276595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6268817204301075
Final val micro accuracy: 0.7021276595744681
Final test macro f1-score: 0.4350017024174328
Final test micro accuracy: 0.5531914893617021
Final validation:
	Cluster: 0.6299645006656647
	Separation: 0.543969601392746
Final test:
	Cluster: 0.6112560331821442
	Separation: 0.5320976674556732
Saved Results

Attempting combination 21/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7756410256410257
	Train Cluster: 0.6490728616714477
	Train Separation: 0.5280190944671631
(Directly after push) Val acc at iteration 0: 0.574468085106383
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.574468085106383
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6170212765957447
	Val acc at iteration 4: 0.5638297872340425
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.6276595744680851
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.5531914893617021
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.574468085106383
	Val acc at iteration 13: 0.6170212765957447
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.5851063829787234
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6276595744680851
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.574468085106383
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.6170212765957447
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6170212765957447
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.6063829787234043
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6276595744680851
	Val acc at iteration 45: 0.6276595744680851
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.6382978723404256
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.6170212765957447
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.6063829787234043
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.6382978723404256
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6170212765957447
	Val acc at iteration 73: 0.723404255319149
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.6382978723404256
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.7021276595744681
Val acc before epoch 13: 0.7127659574468085
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.7978723404255319
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Train Cluster: 0.6498275399208069
	Train Separation: 0.5240422368049622
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.7553191489361702
	Val acc at iteration 4: 0.776595744680851
	Val acc at iteration 5: 0.7127659574468085
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.8085106382978723
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.776595744680851
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6063829787234043
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.7872340425531915
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6276595744680851
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.7978723404255319
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.8191489361702128
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.8085106382978723
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7978723404255319
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.7872340425531915
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.7872340425531915
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.8297872340425532
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7340425531914894
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.6063829787234043
Val acc before epoch 25: 0.6914893617021277
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8237179487179487
	Train Cluster: 0.6524752736091614
	TrainSeparation: 0.5191650271415711
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: 0.05
	Train acc at iteration 1: 0.3269230769230769
	Val acc at iteration 0: 0.2872340425531915
	Train acc at iteration 2: 0.15224358974358973
	Val acc at iteration 1: 0.32978723404255317
	Train acc at iteration 3: 0.16185897435897437
	Val acc at iteration 2: 0.32978723404255317
	Train acc at iteration 4: 0.22275641025641027
	Val acc at iteration 3: 0.30851063829787234
	Train acc at iteration 5: 0.23557692307692307
	Val acc at iteration 4: 0.2553191489361702
	Train acc at iteration 6: 0.22916666666666666
	Val acc at iteration 5: 0.1595744680851064
	Train acc at iteration 7: 0.14102564102564102
	Val acc at iteration 6: 0.3723404255319149
	Train acc at iteration 8: 0.23717948717948717
	Val acc at iteration 7: 0.32978723404255317
	Train acc at iteration 9: 0.2724358974358974
	Val acc at iteration 8: 0.2127659574468085
	Train acc at iteration 10: 0.16346153846153846
	Val acc at iteration 9: 0.35106382978723405
	Train acc at iteration 11: 0.28205128205128205
	Val acc at iteration 10: 0.32978723404255317
	Train acc at iteration 12: 0.23557692307692307
	Val acc at iteration 11: 0.30851063829787234
	Train acc at iteration 13: 0.28044871794871795
	Val acc at iteration 12: 0.30851063829787234
	Train acc at iteration 14: 0.26282051282051283
	Val acc at iteration 13: 0.3829787234042553
	Train acc at iteration 15: 0.3141025641025641
	Val acc at iteration 14: 0.40425531914893614
	Train acc at iteration 16: 0.34935897435897434
	Val acc at iteration 15: 0.23404255319148937
	Train acc at iteration 17: 0.28205128205128205
	Val acc at iteration 16: 0.39361702127659576
	Train acc at iteration 18: 0.375
	Val acc at iteration 17: 0.39361702127659576
	Train acc at iteration 19: 0.3701923076923077
	Val acc at iteration 18: 0.40425531914893614
	Train acc at iteration 20: 0.3733974358974359
	Val acc at iteration 19: 0.425531914893617
	Train acc at iteration 21: 0.3958333333333333
	Val acc at iteration 20: 0.4148936170212766
	Train acc at iteration 22: 0.4198717948717949
	Val acc at iteration 21: 0.574468085106383
	Train acc at iteration 23: 0.483974358974359
	Val acc at iteration 22: 0.3404255319148936
	Train acc at iteration 24: 0.4823717948717949
	Val acc at iteration 23: 0.44680851063829785
	Train acc at iteration 25: 0.5176282051282052
	Val acc at iteration 24: 0.48936170212765956
	Train acc at iteration 26: 0.4423076923076923
	Val acc at iteration 25: 0.4148936170212766
	Train acc at iteration 27: 0.5096153846153846
	Val acc at iteration 26: 0.5106382978723404
	Train acc at iteration 28: 0.5192307692307693
	Val acc at iteration 27: 0.3404255319148936
	Train acc at iteration 29: 0.4807692307692308
	Val acc at iteration 28: 0.5
	Train acc at iteration 30: 0.49038461538461536
	Val acc at iteration 29: 0.46808510638297873
	Train acc at iteration 31: 0.4951923076923077
	Val acc at iteration 30: 0.43617021276595747
	Train acc at iteration 32: 0.5689102564102564
	Val acc at iteration 31: 0.5957446808510638
	Train acc at iteration 33: 0.532051282051282
	Val acc at iteration 32: 0.5212765957446809
	Train acc at iteration 34: 0.5112179487179487
	Val acc at iteration 33: 0.5
	Train acc at iteration 35: 0.5769230769230769
	Val acc at iteration 34: 0.5212765957446809
	Train acc at iteration 36: 0.594551282051282
	Val acc at iteration 35: 0.6382978723404256
	Train acc at iteration 37: 0.5528846153846154
	Val acc at iteration 36: 0.5851063829787234
	Train acc at iteration 38: 0.5785256410256411
	Val acc at iteration 37: 0.46808510638297873
	Train acc at iteration 39: 0.5432692307692307
	Val acc at iteration 38: 0.574468085106383
	Train acc at iteration 40: 0.5689102564102564
	Val acc at iteration 39: 0.5638297872340425
	Train acc at iteration 41: 0.5801282051282052
	Val acc at iteration 40: 0.48936170212765956
	Train acc at iteration 42: 0.5432692307692307
	Val acc at iteration 41: 0.5425531914893617
	Train acc at iteration 43: 0.594551282051282
	Val acc at iteration 42: 0.5319148936170213
	Train acc at iteration 44: 0.5560897435897436
	Val acc at iteration 43: 0.5638297872340425
	Train acc at iteration 45: 0.5673076923076923
	Val acc at iteration 44: 0.5425531914893617
	Train acc at iteration 46: 0.6057692307692307
	Val acc at iteration 45: 0.46808510638297873
	Train acc at iteration 47: 0.5512820512820513
	Val acc at iteration 46: 0.4787234042553192
	Train acc at iteration 48: 0.5897435897435898
	Val acc at iteration 47: 0.6063829787234043
	Train acc at iteration 49: 0.6282051282051282
	Val acc at iteration 48: 0.6276595744680851
	Train acc at iteration 50: 0.6009615384615384
	Val acc at iteration 49: 0.6063829787234043
	Train acc at iteration 51: 0.5993589743589743
	Val acc at iteration 50: 0.5319148936170213
	Train acc at iteration 52: 0.6314102564102564
	Val acc at iteration 51: 0.5425531914893617
	Train acc at iteration 53: 0.6362179487179487
	Val acc at iteration 52: 0.5851063829787234
	Train acc at iteration 54: 0.6923076923076923
	Val acc at iteration 53: 0.6063829787234043
	Train acc at iteration 55: 0.657051282051282
	Val acc at iteration 54: 0.6382978723404256
	Train acc at iteration 56: 0.6522435897435898
	Val acc at iteration 55: 0.6170212765957447
	Train acc at iteration 57: 0.5913461538461539
	Val acc at iteration 56: 0.6063829787234043
	Train acc at iteration 58: 0.655448717948718
	Val acc at iteration 57: 0.5531914893617021
	Train acc at iteration 59: 0.5753205128205128
	Val acc at iteration 58: 0.5638297872340425
	Train acc at iteration 60: 0.6442307692307693
	Val acc at iteration 59: 0.6914893617021277
	Train acc at iteration 61: 0.6490384615384616
	Val acc at iteration 60: 0.648936170212766
	Train acc at iteration 62: 0.6730769230769231
	Val acc at iteration 61: 0.5957446808510638
	Train acc at iteration 63: 0.6826923076923077
	Val acc at iteration 62: 0.6170212765957447
	Train acc at iteration 64: 0.655448717948718
	Val acc at iteration 63: 0.5531914893617021
	Train acc at iteration 65: 0.6698717948717948
	Val acc at iteration 64: 0.6382978723404256
	Train acc at iteration 66: 0.655448717948718
	Val acc at iteration 65: 0.6914893617021277
	Train acc at iteration 67: 0.6762820512820513
	Val acc at iteration 66: 0.5531914893617021
	Train acc at iteration 68: 0.6538461538461539
	Val acc at iteration 67: 0.6382978723404256
	Train acc at iteration 69: 0.6714743589743589
	Val acc at iteration 68: 0.6702127659574468
	Train acc at iteration 70: 0.6939102564102564
	Val acc at iteration 69: 0.6276595744680851
	Train acc at iteration 71: 0.6714743589743589
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.6891025641025641
	Val acc at iteration 71: 0.574468085106383
	Train acc at iteration 73: 0.6987179487179487
	Val acc at iteration 72: 0.5531914893617021
	Train acc at iteration 74: 0.6826923076923077
	Val acc at iteration 73: 0.6595744680851063
	Train acc at iteration 75: 0.6971153846153846
	Val acc at iteration 74: 0.6595744680851063
	Train acc at iteration 76: 0.7099358974358975
	Val acc at iteration 75: 0.6063829787234043
	Train acc at iteration 77: 0.6778846153846154
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.6875
	Val acc at iteration 77: 0.5851063829787234
	Train acc at iteration 79: 0.6907051282051282
	Val acc at iteration 78: 0.6063829787234043
	Train acc at iteration 80: 0.6730769230769231
	Val acc at iteration 79: 0.5638297872340425
	Train acc at iteration 81: 0.6650641025641025
	Val acc at iteration 80: 0.5957446808510638
	Train acc at iteration 82: 0.6682692307692307
	Val acc at iteration 81: 0.6063829787234043
	Train acc at iteration 83: 0.7099358974358975
	Val acc at iteration 82: 0.648936170212766
	Train acc at iteration 84: 0.7003205128205128
	Val acc at iteration 83: 0.7553191489361702
	Train acc at iteration 85: 0.7147435897435898
	Val acc at iteration 84: 0.6808510638297872
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5511551155115512
Final val micro accuracy: 0.6914893617021277
Final test macro f1-score: 0.47565543071161054
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.609096348285675
	Separation: 0.5348694324493408
Final test:
	Cluster: 0.6023920476436615
	Separation: 0.542785257101059
Saved Results

Attempting combination 22/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.01
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Train Cluster: 0.6418979525566101
	Train Separation: 0.5173193097114563
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.5957446808510638
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.6276595744680851
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.574468085106383
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.776595744680851
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.5957446808510638
	Val acc at iteration 27: 0.574468085106383
	Val acc at iteration 28: 0.6063829787234043
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.5957446808510638
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.6382978723404256
	Val acc at iteration 48: 0.6702127659574468
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.6063829787234043
	Val acc at iteration 56: 0.6276595744680851
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.6382978723404256
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.648936170212766
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.6276595744680851
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.7659574468085106
	Val acc at iteration 78: 0.6382978723404256
	Val acc at iteration 79: 0.6595744680851063
	Val acc at iteration 80: 0.6170212765957447
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 13: 0.6914893617021277
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8085106382978723
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Train Cluster: 0.6442100524902343
	Train Separation: 0.5175925493240356
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.7659574468085106
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.7872340425531915
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.6170212765957447
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.6382978723404256
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.6170212765957447
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.7978723404255319
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.7978723404255319
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.7872340425531915
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 25: 0.7872340425531915
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8301282051282052
	Train Cluster: 0.6517458438873291
	TrainSeparation: 0.5213324069976807
(Directly after push) Val acc at iteration 0: 0.8191489361702128
Retraining last layer
Last layer lr: 0.01
	Train acc at iteration 1: 0.7163461538461539
	Val acc at iteration 0: 0.6063829787234043
	Train acc at iteration 2: 0.6586538461538461
	Val acc at iteration 1: 0.5425531914893617
	Train acc at iteration 3: 0.657051282051282
	Val acc at iteration 2: 0.5106382978723404
	Train acc at iteration 4: 0.5753205128205128
	Val acc at iteration 3: 0.5425531914893617
	Train acc at iteration 5: 0.5641025641025641
	Val acc at iteration 4: 0.4787234042553192
	Train acc at iteration 6: 0.5673076923076923
	Val acc at iteration 5: 0.48936170212765956
	Train acc at iteration 7: 0.5977564102564102
	Val acc at iteration 6: 0.5531914893617021
	Train acc at iteration 8: 0.5689102564102564
	Val acc at iteration 7: 0.5531914893617021
	Train acc at iteration 9: 0.5993589743589743
	Val acc at iteration 8: 0.5212765957446809
	Train acc at iteration 10: 0.5769230769230769
	Val acc at iteration 9: 0.5851063829787234
	Train acc at iteration 11: 0.592948717948718
	Val acc at iteration 10: 0.5957446808510638
	Train acc at iteration 12: 0.6105769230769231
	Val acc at iteration 11: 0.5106382978723404
	Train acc at iteration 13: 0.5977564102564102
	Val acc at iteration 12: 0.5212765957446809
	Train acc at iteration 14: 0.6266025641025641
	Val acc at iteration 13: 0.48936170212765956
	Train acc at iteration 15: 0.6169871794871795
	Val acc at iteration 14: 0.5957446808510638
	Train acc at iteration 16: 0.5913461538461539
	Val acc at iteration 15: 0.5106382978723404
	Train acc at iteration 17: 0.5817307692307693
	Val acc at iteration 16: 0.6063829787234043
	Train acc at iteration 18: 0.6394230769230769
	Val acc at iteration 17: 0.5851063829787234
	Train acc at iteration 19: 0.6153846153846154
	Val acc at iteration 18: 0.5531914893617021
	Train acc at iteration 20: 0.6426282051282052
	Val acc at iteration 19: 0.5957446808510638
	Train acc at iteration 21: 0.6169871794871795
	Val acc at iteration 20: 0.5531914893617021
	Train acc at iteration 22: 0.6442307692307693
	Val acc at iteration 21: 0.6276595744680851
	Train acc at iteration 23: 0.6474358974358975
	Val acc at iteration 22: 0.5851063829787234
	Train acc at iteration 24: 0.6394230769230769
	Val acc at iteration 23: 0.6170212765957447
	Train acc at iteration 25: 0.6458333333333334
	Val acc at iteration 24: 0.6595744680851063
	Train acc at iteration 26: 0.6362179487179487
	Val acc at iteration 25: 0.5638297872340425
	Train acc at iteration 27: 0.6794871794871795
	Val acc at iteration 26: 0.6595744680851063
	Train acc at iteration 28: 0.6682692307692307
	Val acc at iteration 27: 0.6170212765957447
	Train acc at iteration 29: 0.6442307692307693
	Val acc at iteration 28: 0.5957446808510638
	Train acc at iteration 30: 0.6538461538461539
	Val acc at iteration 29: 0.6170212765957447
	Train acc at iteration 31: 0.6602564102564102
	Val acc at iteration 30: 0.574468085106383
	Train acc at iteration 32: 0.6618589743589743
	Val acc at iteration 31: 0.6382978723404256
	Train acc at iteration 33: 0.6858974358974359
	Val acc at iteration 32: 0.5851063829787234
	Train acc at iteration 34: 0.6858974358974359
	Val acc at iteration 33: 0.5638297872340425
	Train acc at iteration 35: 0.6586538461538461
	Val acc at iteration 34: 0.6170212765957447
	Train acc at iteration 36: 0.6538461538461539
	Val acc at iteration 35: 0.648936170212766
	Train acc at iteration 37: 0.6538461538461539
	Val acc at iteration 36: 0.6808510638297872
	Train acc at iteration 38: 0.6714743589743589
	Val acc at iteration 37: 0.6170212765957447
	Train acc at iteration 39: 0.6634615384615384
	Val acc at iteration 38: 0.6382978723404256
	Train acc at iteration 40: 0.6858974358974359
	Val acc at iteration 39: 0.6170212765957447
	Train acc at iteration 41: 0.6971153846153846
	Val acc at iteration 40: 0.6063829787234043
	Train acc at iteration 42: 0.6875
	Val acc at iteration 41: 0.6382978723404256
	Train acc at iteration 43: 0.7083333333333334
	Val acc at iteration 42: 0.648936170212766
	Train acc at iteration 44: 0.7419871794871795
	Val acc at iteration 43: 0.574468085106383
	Train acc at iteration 45: 0.6698717948717948
	Val acc at iteration 44: 0.6702127659574468
	Train acc at iteration 46: 0.719551282051282
	Val acc at iteration 45: 0.6276595744680851
	Train acc at iteration 47: 0.6987179487179487
	Val acc at iteration 46: 0.5851063829787234
	Train acc at iteration 48: 0.717948717948718
	Val acc at iteration 47: 0.7340425531914894
	Train acc at iteration 49: 0.7451923076923077
	Val acc at iteration 48: 0.574468085106383
	Train acc at iteration 50: 0.7227564102564102
	Val acc at iteration 49: 0.6382978723404256
	Train acc at iteration 51: 0.6682692307692307
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.6842948717948718
	Val acc at iteration 51: 0.6170212765957447
	Train acc at iteration 53: 0.6875
	Val acc at iteration 52: 0.6382978723404256
	Train acc at iteration 54: 0.7163461538461539
	Val acc at iteration 53: 0.5851063829787234
	Train acc at iteration 55: 0.6842948717948718
	Val acc at iteration 54: 0.6170212765957447
	Train acc at iteration 56: 0.7323717948717948
	Val acc at iteration 55: 0.6063829787234043
	Train acc at iteration 57: 0.7211538461538461
	Val acc at iteration 56: 0.6276595744680851
	Train acc at iteration 58: 0.7451923076923077
	Val acc at iteration 57: 0.5425531914893617
	Train acc at iteration 59: 0.7019230769230769
	Val acc at iteration 58: 0.5851063829787234
	Train acc at iteration 60: 0.7099358974358975
	Val acc at iteration 59: 0.6276595744680851
	Train acc at iteration 61: 0.719551282051282
	Val acc at iteration 60: 0.574468085106383
	Train acc at iteration 62: 0.7355769230769231
	Val acc at iteration 61: 0.6063829787234043
	Train acc at iteration 63: 0.7339743589743589
	Val acc at iteration 62: 0.6276595744680851
	Train acc at iteration 64: 0.7259615384615384
	Val acc at iteration 63: 0.6276595744680851
	Train acc at iteration 65: 0.7403846153846154
	Val acc at iteration 64: 0.648936170212766
	Train acc at iteration 66: 0.75
	Val acc at iteration 65: 0.6702127659574468
	Train acc at iteration 67: 0.75
	Val acc at iteration 66: 0.6808510638297872
	Train acc at iteration 68: 0.7323717948717948
	Val acc at iteration 67: 0.6382978723404256
	Train acc at iteration 69: 0.7355769230769231
	Val acc at iteration 68: 0.5957446808510638
	Train acc at iteration 70: 0.7243589743589743
	Val acc at iteration 69: 0.6276595744680851
	Train acc at iteration 71: 0.7307692307692307
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.6955128205128205
	Val acc at iteration 71: 0.6914893617021277
	Train acc at iteration 73: 0.7259615384615384
	Val acc at iteration 72: 0.6382978723404256
	Train acc at iteration 74: 0.75
	Val acc at iteration 73: 0.6382978723404256
	Train acc at iteration 75: 0.719551282051282
	Val acc at iteration 74: 0.6170212765957447
	Train acc at iteration 76: 0.7275641025641025
	Val acc at iteration 75: 0.6276595744680851
	Train acc at iteration 77: 0.7051282051282052
	Val acc at iteration 76: 0.7127659574468085
	Train acc at iteration 78: 0.7387820512820513
	Val acc at iteration 77: 0.7127659574468085
	Train acc at iteration 79: 0.7548076923076923
	Val acc at iteration 78: 0.648936170212766
	Train acc at iteration 80: 0.7419871794871795
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.7035256410256411
	Val acc at iteration 80: 0.6914893617021277
	Train acc at iteration 82: 0.7131410256410257
	Val acc at iteration 81: 0.7021276595744681
	Train acc at iteration 83: 0.7612179487179487
	Val acc at iteration 82: 0.7127659574468085
	Train acc at iteration 84: 0.7259615384615384
	Val acc at iteration 83: 0.648936170212766
	Train acc at iteration 85: 0.7516025641025641
	Val acc at iteration 84: 0.6382978723404256
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6229166666666667
Final val micro accuracy: 0.723404255319149
Final test macro f1-score: 0.4244680851063829
Final test micro accuracy: 0.5319148936170213
Final validation:
	Cluster: 0.6181645691394806
	Separation: 0.5424784123897552
Final test:
	Cluster: 0.5969752073287964
	Separation: 0.5286604464054108
Saved Results

Attempting combination 23/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7756410256410257
	Train Cluster: 0.6421393632888794
	Train Separation: 0.5164228081703186
(Directly after push) Val acc at iteration 0: 0.6170212765957447
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.5851063829787234
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.6276595744680851
	Val acc at iteration 5: 0.7127659574468085
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6170212765957447
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6063829787234043
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.6063829787234043
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.6170212765957447
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.6276595744680851
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.5851063829787234
	Val acc at iteration 48: 0.6702127659574468
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.5957446808510638
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.6170212765957447
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.6170212765957447
	Val acc at iteration 57: 0.6276595744680851
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6382978723404256
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.648936170212766
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.7659574468085106
Val acc before epoch 13: 0.6382978723404256
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8085106382978723
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Train Cluster: 0.6431228041648864
	Train Separation: 0.5220070719718933
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.7659574468085106
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.7553191489361702
	Val acc at iteration 40: 0.5638297872340425
	Val acc at iteration 41: 0.6382978723404256
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.6702127659574468
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6382978723404256
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.7872340425531915
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.6702127659574468
Val acc before epoch 25: 0.7446808510638298
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.8829787234042553
Stopping after epoch 37.
Final validation accuracy before push: 88.29787234042553%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Train Cluster: 0.6490366220474243
	TrainSeparation: 0.5195085287094117
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.005
	Train acc at iteration 1: 0.7644230769230769
	Val acc at iteration 0: 0.5851063829787234
	Train acc at iteration 2: 0.7516025641025641
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.7371794871794872
	Val acc at iteration 2: 0.6595744680851063
	Train acc at iteration 4: 0.7467948717948718
	Val acc at iteration 3: 0.6808510638297872
	Train acc at iteration 5: 0.7243589743589743
	Val acc at iteration 4: 0.7127659574468085
	Train acc at iteration 6: 0.6939102564102564
	Val acc at iteration 5: 0.6063829787234043
	Train acc at iteration 7: 0.7323717948717948
	Val acc at iteration 6: 0.648936170212766
	Train acc at iteration 8: 0.719551282051282
	Val acc at iteration 7: 0.6276595744680851
	Train acc at iteration 9: 0.7307692307692307
	Val acc at iteration 8: 0.648936170212766
	Train acc at iteration 10: 0.7083333333333334
	Val acc at iteration 9: 0.5638297872340425
	Train acc at iteration 11: 0.6923076923076923
	Val acc at iteration 10: 0.6063829787234043
	Train acc at iteration 12: 0.7467948717948718
	Val acc at iteration 11: 0.7021276595744681
	Train acc at iteration 13: 0.7211538461538461
	Val acc at iteration 12: 0.5957446808510638
	Train acc at iteration 14: 0.7131410256410257
	Val acc at iteration 13: 0.6702127659574468
	Train acc at iteration 15: 0.7291666666666666
	Val acc at iteration 14: 0.6382978723404256
	Train acc at iteration 16: 0.6746794871794872
	Val acc at iteration 15: 0.5851063829787234
	Train acc at iteration 17: 0.7355769230769231
	Val acc at iteration 16: 0.6063829787234043
	Train acc at iteration 18: 0.7243589743589743
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.7227564102564102
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.7259615384615384
	Val acc at iteration 19: 0.6808510638297872
	Train acc at iteration 21: 0.7275641025641025
	Val acc at iteration 20: 0.6276595744680851
	Train acc at iteration 22: 0.7147435897435898
	Val acc at iteration 21: 0.6276595744680851
	Train acc at iteration 23: 0.6939102564102564
	Val acc at iteration 22: 0.6702127659574468
	Train acc at iteration 24: 0.7676282051282052
	Val acc at iteration 23: 0.6276595744680851
	Train acc at iteration 25: 0.7147435897435898
	Val acc at iteration 24: 0.648936170212766
	Train acc at iteration 26: 0.7147435897435898
	Val acc at iteration 25: 0.5851063829787234
	Train acc at iteration 27: 0.717948717948718
	Val acc at iteration 26: 0.6914893617021277
	Train acc at iteration 28: 0.7564102564102564
	Val acc at iteration 27: 0.5851063829787234
	Train acc at iteration 29: 0.7211538461538461
	Val acc at iteration 28: 0.6702127659574468
	Train acc at iteration 30: 0.7131410256410257
	Val acc at iteration 29: 0.6063829787234043
	Train acc at iteration 31: 0.7147435897435898
	Val acc at iteration 30: 0.6702127659574468
	Train acc at iteration 32: 0.7451923076923077
	Val acc at iteration 31: 0.6063829787234043
	Train acc at iteration 33: 0.7403846153846154
	Val acc at iteration 32: 0.648936170212766
	Train acc at iteration 34: 0.7339743589743589
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.7371794871794872
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.7419871794871795
	Val acc at iteration 35: 0.5531914893617021
	Train acc at iteration 37: 0.7259615384615384
	Val acc at iteration 36: 0.6808510638297872
	Train acc at iteration 38: 0.7083333333333334
	Val acc at iteration 37: 0.6595744680851063
	Train acc at iteration 39: 0.7019230769230769
	Val acc at iteration 38: 0.648936170212766
	Train acc at iteration 40: 0.7211538461538461
	Val acc at iteration 39: 0.6808510638297872
	Train acc at iteration 41: 0.7403846153846154
	Val acc at iteration 40: 0.7021276595744681
	Train acc at iteration 42: 0.7548076923076923
	Val acc at iteration 41: 0.6063829787234043
	Train acc at iteration 43: 0.7051282051282052
	Val acc at iteration 42: 0.6595744680851063
	Train acc at iteration 44: 0.7371794871794872
	Val acc at iteration 43: 0.6382978723404256
	Train acc at iteration 45: 0.7227564102564102
	Val acc at iteration 44: 0.5957446808510638
	Train acc at iteration 46: 0.7307692307692307
	Val acc at iteration 45: 0.5531914893617021
	Train acc at iteration 47: 0.7339743589743589
	Val acc at iteration 46: 0.6595744680851063
	Train acc at iteration 48: 0.7371794871794872
	Val acc at iteration 47: 0.5851063829787234
	Train acc at iteration 49: 0.7483974358974359
	Val acc at iteration 48: 0.6170212765957447
	Train acc at iteration 50: 0.7467948717948718
	Val acc at iteration 49: 0.6595744680851063
	Train acc at iteration 51: 0.7483974358974359
	Val acc at iteration 50: 0.6914893617021277
	Train acc at iteration 52: 0.7756410256410257
	Val acc at iteration 51: 0.6063829787234043
	Train acc at iteration 53: 0.7740384615384616
	Val acc at iteration 52: 0.6382978723404256
	Train acc at iteration 54: 0.7435897435897436
	Val acc at iteration 53: 0.6808510638297872
	Train acc at iteration 55: 0.7307692307692307
	Val acc at iteration 54: 0.6808510638297872
	Train acc at iteration 56: 0.7339743589743589
	Val acc at iteration 55: 0.648936170212766
	Train acc at iteration 57: 0.7227564102564102
	Val acc at iteration 56: 0.6276595744680851
	Train acc at iteration 58: 0.7467948717948718
	Val acc at iteration 57: 0.6276595744680851
	Train acc at iteration 59: 0.7580128205128205
	Val acc at iteration 58: 0.6382978723404256
	Train acc at iteration 60: 0.7339743589743589
	Val acc at iteration 59: 0.6382978723404256
	Train acc at iteration 61: 0.7227564102564102
	Val acc at iteration 60: 0.6808510638297872
	Train acc at iteration 62: 0.7516025641025641
	Val acc at iteration 61: 0.6276595744680851
	Train acc at iteration 63: 0.7387820512820513
	Val acc at iteration 62: 0.7127659574468085
	Train acc at iteration 64: 0.7692307692307693
	Val acc at iteration 63: 0.6382978723404256
	Train acc at iteration 65: 0.7564102564102564
	Val acc at iteration 64: 0.6595744680851063
	Train acc at iteration 66: 0.7419871794871795
	Val acc at iteration 65: 0.6382978723404256
	Train acc at iteration 67: 0.717948717948718
	Val acc at iteration 66: 0.7021276595744681
	Train acc at iteration 68: 0.7243589743589743
	Val acc at iteration 67: 0.5851063829787234
	Train acc at iteration 69: 0.7419871794871795
	Val acc at iteration 68: 0.6595744680851063
	Train acc at iteration 70: 0.7884615384615384
	Val acc at iteration 69: 0.6170212765957447
	Train acc at iteration 71: 0.7435897435897436
	Val acc at iteration 70: 0.6702127659574468
	Train acc at iteration 72: 0.7548076923076923
	Val acc at iteration 71: 0.6382978723404256
	Train acc at iteration 73: 0.780448717948718
	Val acc at iteration 72: 0.6914893617021277
	Train acc at iteration 74: 0.7419871794871795
	Val acc at iteration 73: 0.6063829787234043
	Train acc at iteration 75: 0.7467948717948718
	Val acc at iteration 74: 0.648936170212766
	Train acc at iteration 76: 0.7467948717948718
	Val acc at iteration 75: 0.7446808510638298
	Train acc at iteration 77: 0.7467948717948718
	Val acc at iteration 76: 0.6276595744680851
	Train acc at iteration 78: 0.7291666666666666
	Val acc at iteration 77: 0.6170212765957447
	Train acc at iteration 79: 0.75
	Val acc at iteration 78: 0.7021276595744681
	Train acc at iteration 80: 0.7692307692307693
	Val acc at iteration 79: 0.6382978723404256
	Train acc at iteration 81: 0.7644230769230769
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.7291666666666666
	Val acc at iteration 81: 0.6170212765957447
	Train acc at iteration 83: 0.7419871794871795
	Val acc at iteration 82: 0.5851063829787234
	Train acc at iteration 84: 0.7451923076923077
	Val acc at iteration 83: 0.6382978723404256
	Train acc at iteration 85: 0.7644230769230769
	Val acc at iteration 84: 0.5638297872340425
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5815602836879432
Final val micro accuracy: 0.6914893617021277
Final test macro f1-score: 0.5041666666666665
Final test micro accuracy: 0.6170212765957447
Final validation:
	Cluster: 0.6334960758686066
	Separation: 0.5459967851638794
Final test:
	Cluster: 0.5976944863796234
	Separation: 0.5374239385128021
Saved Results

Attempting combination 24/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7548076923076923
	Train Cluster: 0.6440515875816345
	Train Separation: 0.5176434636116027
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5851063829787234
	Val acc at iteration 1: 0.574468085106383
	Val acc at iteration 2: 0.5957446808510638
	Val acc at iteration 3: 0.5531914893617021
	Val acc at iteration 4: 0.6276595744680851
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.5531914893617021
	Val acc at iteration 11: 0.5638297872340425
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.5851063829787234
	Val acc at iteration 14: 0.5957446808510638
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.5957446808510638
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.5638297872340425
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.6170212765957447
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.6063829787234043
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6170212765957447
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7872340425531915
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6276595744680851
	Val acc at iteration 51: 0.5957446808510638
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.5531914893617021
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.6276595744680851
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.6276595744680851
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.6063829787234043
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.8085106382978723
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.7127659574468085
Val acc before epoch 13: 0.7127659574468085
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9574468085106383
Push epoch
After push, before retraining last layer:
	Train acc: 0.8205128205128205
	Train Cluster: 0.6448661923408509
	Train Separation: 0.5170644044876098
(Directly after push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.6914893617021277
	Val acc at iteration 2: 0.776595744680851
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.5957446808510638
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.7659574468085106
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.6276595744680851
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.7659574468085106
	Val acc at iteration 63: 0.6063829787234043
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.6170212765957447
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.7446808510638298
Val acc before epoch 25: 0.7553191489361702
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8269230769230769
	Train Cluster: 0.6558840990066528
	TrainSeparation: 0.5215295910835266
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.001
	Train acc at iteration 1: 0.7964743589743589
	Val acc at iteration 0: 0.723404255319149
	Train acc at iteration 2: 0.8141025641025641
	Val acc at iteration 1: 0.723404255319149
	Train acc at iteration 3: 0.8076923076923077
	Val acc at iteration 2: 0.7340425531914894
	Train acc at iteration 4: 0.8173076923076923
	Val acc at iteration 3: 0.776595744680851
	Train acc at iteration 5: 0.8092948717948718
	Val acc at iteration 4: 0.7446808510638298
	Train acc at iteration 6: 0.8012820512820513
	Val acc at iteration 5: 0.6382978723404256
	Train acc at iteration 7: 0.8108974358974359
	Val acc at iteration 6: 0.7553191489361702
	Train acc at iteration 8: 0.8076923076923077
	Val acc at iteration 7: 0.7659574468085106
	Train acc at iteration 9: 0.7980769230769231
	Val acc at iteration 8: 0.7021276595744681
	Train acc at iteration 10: 0.8108974358974359
	Val acc at iteration 9: 0.7127659574468085
	Train acc at iteration 11: 0.8060897435897436
	Val acc at iteration 10: 0.7553191489361702
	Train acc at iteration 12: 0.8076923076923077
	Val acc at iteration 11: 0.7127659574468085
	Train acc at iteration 13: 0.7948717948717948
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.8125
	Val acc at iteration 13: 0.723404255319149
	Train acc at iteration 15: 0.7964743589743589
	Val acc at iteration 14: 0.776595744680851
	Train acc at iteration 16: 0.8141025641025641
	Val acc at iteration 15: 0.723404255319149
	Train acc at iteration 17: 0.8125
	Val acc at iteration 16: 0.776595744680851
	Train acc at iteration 18: 0.8060897435897436
	Val acc at iteration 17: 0.7659574468085106
	Train acc at iteration 19: 0.8157051282051282
	Val acc at iteration 18: 0.6382978723404256
	Train acc at iteration 20: 0.8012820512820513
	Val acc at iteration 19: 0.776595744680851
	Train acc at iteration 21: 0.8108974358974359
	Val acc at iteration 20: 0.7978723404255319
	Train acc at iteration 22: 0.7868589743589743
	Val acc at iteration 21: 0.7553191489361702
	Train acc at iteration 23: 0.8125
	Val acc at iteration 22: 0.7340425531914894
	Train acc at iteration 24: 0.7868589743589743
	Val acc at iteration 23: 0.6808510638297872
	Train acc at iteration 25: 0.7964743589743589
	Val acc at iteration 24: 0.723404255319149
	Train acc at iteration 26: 0.8108974358974359
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.7996794871794872
	Val acc at iteration 26: 0.7340425531914894
	Train acc at iteration 28: 0.7692307692307693
	Val acc at iteration 27: 0.6702127659574468
	Train acc at iteration 29: 0.7884615384615384
	Val acc at iteration 28: 0.7659574468085106
	Train acc at iteration 30: 0.7580128205128205
	Val acc at iteration 29: 0.648936170212766
	Train acc at iteration 31: 0.780448717948718
	Val acc at iteration 30: 0.6595744680851063
	Train acc at iteration 32: 0.7996794871794872
	Val acc at iteration 31: 0.7446808510638298
	Train acc at iteration 33: 0.7692307692307693
	Val acc at iteration 32: 0.7021276595744681
	Train acc at iteration 34: 0.7932692307692307
	Val acc at iteration 33: 0.6595744680851063
	Train acc at iteration 35: 0.7724358974358975
	Val acc at iteration 34: 0.648936170212766
	Train acc at iteration 36: 0.7708333333333334
	Val acc at iteration 35: 0.723404255319149
	Train acc at iteration 37: 0.7836538461538461
	Val acc at iteration 36: 0.6808510638297872
	Train acc at iteration 38: 0.7692307692307693
	Val acc at iteration 37: 0.6914893617021277
	Train acc at iteration 39: 0.7836538461538461
	Val acc at iteration 38: 0.6702127659574468
	Train acc at iteration 40: 0.7900641025641025
	Val acc at iteration 39: 0.648936170212766
	Train acc at iteration 41: 0.7708333333333334
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.7740384615384616
	Val acc at iteration 41: 0.648936170212766
	Train acc at iteration 43: 0.780448717948718
	Val acc at iteration 42: 0.6276595744680851
	Train acc at iteration 44: 0.7644230769230769
	Val acc at iteration 43: 0.6595744680851063
	Train acc at iteration 45: 0.7467948717948718
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.7788461538461539
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.7980769230769231
	Val acc at iteration 46: 0.6808510638297872
	Train acc at iteration 48: 0.7612179487179487
	Val acc at iteration 47: 0.6382978723404256
	Train acc at iteration 49: 0.7596153846153846
	Val acc at iteration 48: 0.6063829787234043
	Train acc at iteration 50: 0.7836538461538461
	Val acc at iteration 49: 0.648936170212766
	Train acc at iteration 51: 0.7435897435897436
	Val acc at iteration 50: 0.7021276595744681
	Train acc at iteration 52: 0.7532051282051282
	Val acc at iteration 51: 0.6063829787234043
	Train acc at iteration 53: 0.7772435897435898
	Val acc at iteration 52: 0.6276595744680851
	Train acc at iteration 54: 0.7852564102564102
	Val acc at iteration 53: 0.6170212765957447
	Train acc at iteration 55: 0.7964743589743589
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.7660256410256411
	Val acc at iteration 55: 0.7127659574468085
	Train acc at iteration 57: 0.7644230769230769
	Val acc at iteration 56: 0.6702127659574468
	Train acc at iteration 58: 0.7548076923076923
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.7724358974358975
	Val acc at iteration 58: 0.7021276595744681
	Train acc at iteration 60: 0.7564102564102564
	Val acc at iteration 59: 0.7021276595744681
	Train acc at iteration 61: 0.7596153846153846
	Val acc at iteration 60: 0.648936170212766
	Train acc at iteration 62: 0.7692307692307693
	Val acc at iteration 61: 0.6702127659574468
	Train acc at iteration 63: 0.7660256410256411
	Val acc at iteration 62: 0.6170212765957447
	Train acc at iteration 64: 0.7708333333333334
	Val acc at iteration 63: 0.7446808510638298
	Train acc at iteration 65: 0.7628205128205128
	Val acc at iteration 64: 0.7127659574468085
	Train acc at iteration 66: 0.7660256410256411
	Val acc at iteration 65: 0.5957446808510638
	Train acc at iteration 67: 0.7628205128205128
	Val acc at iteration 66: 0.7021276595744681
	Train acc at iteration 68: 0.7323717948717948
	Val acc at iteration 67: 0.5957446808510638
	Train acc at iteration 69: 0.7612179487179487
	Val acc at iteration 68: 0.6702127659574468
	Train acc at iteration 70: 0.7708333333333334
	Val acc at iteration 69: 0.6914893617021277
	Train acc at iteration 71: 0.7836538461538461
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.7868589743589743
	Val acc at iteration 71: 0.6595744680851063
	Train acc at iteration 73: 0.7451923076923077
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.7740384615384616
	Val acc at iteration 73: 0.7021276595744681
	Train acc at iteration 75: 0.7564102564102564
	Val acc at iteration 74: 0.6276595744680851
	Train acc at iteration 76: 0.782051282051282
	Val acc at iteration 75: 0.6595744680851063
	Train acc at iteration 77: 0.7756410256410257
	Val acc at iteration 76: 0.7021276595744681
	Train acc at iteration 78: 0.7628205128205128
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.7708333333333334
	Val acc at iteration 78: 0.6702127659574468
	Train acc at iteration 80: 0.7516025641025641
	Val acc at iteration 79: 0.6382978723404256
	Train acc at iteration 81: 0.7740384615384616
	Val acc at iteration 80: 0.6170212765957447
	Train acc at iteration 82: 0.7628205128205128
	Val acc at iteration 81: 0.6914893617021277
	Train acc at iteration 83: 0.7532051282051282
	Val acc at iteration 82: 0.6914893617021277
	Train acc at iteration 84: 0.7724358974358975
	Val acc at iteration 83: 0.6276595744680851
	Train acc at iteration 85: 0.7451923076923077
	Val acc at iteration 84: 0.7021276595744681
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.537037037037037
Final val micro accuracy: 0.6595744680851063
Final test macro f1-score: 0.44166666666666665
Final test micro accuracy: 0.5531914893617021
Final validation:
	Cluster: 0.615057647228241
	Separation: 0.5446078181266785
Final test:
	Cluster: 0.6057146489620209
	Separation: 0.5384974181652069
Saved Results

Attempting combination 25/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.46808510638297873
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6595744680851063
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7660256410256411
	Train Cluster: 0.6396507740020752
	Train Separation: 0.5181832075119018
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6170212765957447
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6063829787234043
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.6170212765957447
	Val acc at iteration 8: 0.6063829787234043
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.6276595744680851
	Val acc at iteration 14: 0.6063829787234043
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.5851063829787234
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6170212765957447
	Val acc at iteration 27: 0.6170212765957447
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.6170212765957447
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.5957446808510638
	Val acc at iteration 38: 0.6063829787234043
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.5957446808510638
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.6276595744680851
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.6382978723404256
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.6063829787234043
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.5957446808510638
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.5851063829787234
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.5957446808510638
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.6382978723404256
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.6170212765957447
	Val acc at iteration 67: 0.7659574468085106
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.6276595744680851
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.6063829787234043
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6702127659574468
Val acc before epoch 13: 0.6702127659574468
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8085106382978723
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Train Cluster: 0.6480458974838257
	Train Separation: 0.5234109878540039
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6276595744680851
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.7553191489361702
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.6170212765957447
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.6170212765957447
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.6063829787234043
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.6170212765957447
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.6382978723404256
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.7872340425531915
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.5851063829787234
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7340425531914894
slurmstepd: error: *** JOB 1847093 ON grtx-1 CANCELLED AT 2024-03-30T14:50:33 ***
