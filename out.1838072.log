Tests warm lr for prototypes
Conclusions:
	good ones: 0.5, 0.1 (best), 0.05.
	each definitely trained by 25 epochs
Future:
	[0.5, 0.45, 0.4, 0.35, 0.3, 0.25, 0.2, 0.15 0.1, 0.95, 0.09, 0.85, 0.08, 0.75, 0.07, 0.65, 0.06, 0.55, 0.05]


===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Fri Mar 22 23:47:35 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-03-22 23:48:33.233781: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-22 23:48:34.331835: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-22 23:48:34.333409: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-22 23:48:34.336486: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-22 23:48:35.031702: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94


Exploring 16 hyperparameter combinations for grid search.


Attempting combination 0/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.8
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.5
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.7340425531914894
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.5
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 10: 0.9574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 12: 0.9787234042553191
Warm optimizer lr: 0.5
Val acc before epoch 13: 0.9574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 15: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.5
Val acc before epoch 17: 0.9680851063829787
Warm optimizer lr: 0.5
Val acc before epoch 18: 0.9574468085106383
Warm optimizer lr: 0.5
Val acc before epoch 19: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 20: 0.9680851063829787
Warm optimizer lr: 0.4
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 22: 0.9680851063829787
Warm optimizer lr: 0.4
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.4
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 25: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 26: 0.9680851063829787
Warm optimizer lr: 0.4
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.4
Val acc before epoch 29: 0.9680851063829787
Warm optimizer lr: 0.4
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 32: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 33: 0.9680851063829787
Warm optimizer lr: 0.4
Val acc before epoch 34: 0.9893617021276596
Warm optimizer lr: 0.4
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 38: 0.9680851063829787
Warm optimizer lr: 0.4
Val acc before epoch 39: 0.9574468085106383
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 40: 0.9680851063829787
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 41: 0.9574468085106383
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 44: 0.9680851063829787
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 49: 0.9893617021276596
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 50: 0.9680851063829787
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 51: 0.9680851063829787
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 53: 0.9680851063829787
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 55: 0.9787234042553191
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 56: 0.925531914893617
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 61: 0.9680851063829787
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 70: 0.9468085106382979
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 71: 0.9574468085106383
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 72: 0.9680851063829787
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 73: 0.9787234042553191
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 74: 0.9893617021276596
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 75: 0.9468085106382979
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 76: 0.9574468085106383
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 77: 0.925531914893617
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 78: 0.9468085106382979
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 79: 0.9680851063829787
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 80: 0.9787234042553191
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 81: 0.9680851063829787
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 82: 0.9148936170212766
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 83: 0.9468085106382979
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 84: 0.9574468085106383
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 86: 0.9361702127659575
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 87: 0.9574468085106383
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 89: 0.9680851063829787
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 93: 0.9680851063829787
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 94: 0.9680851063829787
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 95: 0.9787234042553191
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 96: 0.9574468085106383
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 98: 0.9680851063829787
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 99: 0.9468085106382979
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 100: 0.9574468085106383
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 101: 0.9361702127659575
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 102: 0.9893617021276596
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 103: 0.9680851063829787
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 104: 0.9361702127659575
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 105: 0.9468085106382979
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 106: 0.9468085106382979
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 107: 0.9361702127659575
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 108: 0.9468085106382979
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 109: 0.9468085106382979
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 110: 0.9680851063829787
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 111: 0.9893617021276596
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 112: 0.9680851063829787
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 113: 0.9468085106382979
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 114: 0.9148936170212766
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 115: 0.9361702127659575
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 116: 0.9574468085106383
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 117: 0.9680851063829787
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 118: 0.9361702127659575
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 119: 0.925531914893617
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 120: 0.9148936170212766
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 121: 0.9574468085106383
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 122: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 123: 0.925531914893617
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 124: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 125: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 126: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 127: 0.9574468085106383
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 128: 0.925531914893617
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 129: 0.9680851063829787
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 130: 0.9680851063829787
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 131: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 132: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 133: 0.9361702127659575
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 134: 0.9680851063829787
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 135: 0.9148936170212766
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 136: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 137: 0.9574468085106383
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 138: 0.9574468085106383
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 139: 0.9468085106382979
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 140: 0.9574468085106383
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 141: 0.9574468085106383
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 142: 0.9574468085106383
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 143: 0.9468085106382979
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 144: 0.9680851063829787
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 145: 0.9468085106382979
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 146: 0.9787234042553191
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 147: 0.9468085106382979
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 148: 0.9574468085106383
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 149: 0.9361702127659575
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 150: 0.9468085106382979
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 151: 0.9787234042553191
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 152: 0.9361702127659575
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 153: 0.9468085106382979
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 154: 0.9361702127659575
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 155: 0.9680851063829787
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 156: 0.9574468085106383
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 157: 0.9787234042553191
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 158: 0.9680851063829787
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 159: 0.9893617021276596
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 160: 0.9468085106382979
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 161: 0.9680851063829787
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 162: 0.9787234042553191
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 163: 0.9361702127659575
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 164: 0.9680851063829787
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 165: 0.9468085106382979
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 166: 0.9574468085106383
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 167: 0.9787234042553191
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 168: 0.9680851063829787
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 169: 0.9148936170212766
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 170: 0.9361702127659575
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 171: 0.9680851063829787
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 172: 0.9680851063829787
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 173: 0.9574468085106383
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 174: 0.9574468085106383
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 175: 0.9574468085106383
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 176: 0.9574468085106383
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 177: 0.9787234042553191
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 178: 0.9361702127659575
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 179: 0.9468085106382979
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 180: 0.9574468085106383
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 181: 0.9680851063829787
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 182: 0.9574468085106383
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 183: 0.9680851063829787
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 184: 0.9787234042553191
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 185: 0.9574468085106383
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 186: 0.9468085106382979
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 187: 0.9680851063829787
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 188: 0.9574468085106383
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 189: 0.9893617021276596
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 190: 0.9574468085106383
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 191: 0.9468085106382979
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 192: 0.9468085106382979
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 193: 0.9680851063829787
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 194: 0.9468085106382979
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 195: 0.9361702127659575
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 196: 0.9574468085106383
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 197: 0.9787234042553191
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 198: 0.9680851063829787
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 199: 0.9468085106382979
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 200: 0.9787234042553191
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.9772727272727273
Final val micro accuracy: 0.9893617021276596
Final test macro f1-score: 0.8969298245614036
Final test micro accuracy: 0.925531914893617
Final validation:
	Cluster: 0.6882574260234833
	Separation: 0.4971388876438141
Final test:
	Cluster: 0.6584183573722839
	Separation: 0.5024899244308472
Saved Results

Attempting combination 1/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.8
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 31: 0.9680851063829787
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 40: 0.9680851063829787
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 41: 0.925531914893617
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 43: 0.9574468085106383
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 44: 0.9680851063829787
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 49: 0.9680851063829787
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 51: 0.9574468085106383
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 56: 0.9787234042553191
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 57: 0.9787234042553191
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 60: 0.9680851063829787
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 62: 0.9680851063829787
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 63: 0.9680851063829787
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 65: 0.9787234042553191
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 70: 0.9787234042553191
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 71: 0.9574468085106383
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 72: 0.9468085106382979
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 73: 0.9787234042553191
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 74: 0.9680851063829787
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 75: 0.9787234042553191
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 77: 0.9574468085106383
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 78: 0.9787234042553191
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 79: 0.9574468085106383
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 80: 0.9468085106382979
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 81: 0.9680851063829787
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 82: 0.9468085106382979
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 83: 0.9574468085106383
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 84: 0.9468085106382979
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 85: 0.9361702127659575
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 86: 0.9680851063829787
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 87: 0.9787234042553191
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 88: 0.9680851063829787
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 89: 0.9574468085106383
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 91: 0.9468085106382979
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 93: 0.9361702127659575
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 95: 0.9680851063829787
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 96: 0.9680851063829787
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 97: 0.9574468085106383
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 98: 0.9574468085106383
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 99: 0.9893617021276596
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 100: 0.9468085106382979
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 101: 0.9787234042553191
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 102: 0.9468085106382979
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 103: 0.9680851063829787
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 104: 0.9468085106382979
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 105: 0.9574468085106383
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 106: 0.9680851063829787
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 107: 0.9680851063829787
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 108: 0.9680851063829787
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 109: 0.9574468085106383
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 110: 0.9787234042553191
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 111: 0.9574468085106383
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 112: 0.9574468085106383
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 113: 0.9574468085106383
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 114: 0.9574468085106383
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 115: 0.9361702127659575
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 116: 0.9574468085106383
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 117: 0.9787234042553191
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 118: 0.9680851063829787
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 119: 0.9468085106382979
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 120: 0.9680851063829787
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 121: 0.9468085106382979
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 122: 0.9787234042553191
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 123: 0.9787234042553191
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 124: 0.9468085106382979
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 125: 0.9468085106382979
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 126: 0.9574468085106383
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 127: 0.9361702127659575
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 128: 0.9680851063829787
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 129: 0.9574468085106383
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 130: 0.9574468085106383
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 131: 0.9574468085106383
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 132: 0.9787234042553191
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 133: 0.9680851063829787
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 134: 0.9468085106382979
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 135: 0.9680851063829787
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 136: 0.9680851063829787
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 137: 0.9680851063829787
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 138: 0.9787234042553191
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 139: 0.9680851063829787
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 140: 0.925531914893617
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 141: 0.9468085106382979
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 142: 0.9680851063829787
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 143: 0.9361702127659575
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 144: 0.9574468085106383
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 145: 0.9574468085106383
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 146: 0.9468085106382979
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 147: 0.9468085106382979
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 148: 0.9574468085106383
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 149: 0.9680851063829787
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 150: 0.9574468085106383
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 151: 0.9468085106382979
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 152: 0.9468085106382979
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 153: 0.9893617021276596
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 154: 0.9468085106382979
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 155: 0.9893617021276596
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 156: 0.9574468085106383
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 157: 0.9680851063829787
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 158: 0.9468085106382979
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 159: 0.9787234042553191
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 160: 0.9787234042553191
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 161: 0.9468085106382979
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 162: 0.9468085106382979
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 163: 0.9680851063829787
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 164: 0.9468085106382979
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 165: 0.9574468085106383
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 166: 0.9680851063829787
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 167: 0.9468085106382979
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 168: 0.9680851063829787
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 169: 0.9680851063829787
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 170: 0.9468085106382979
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 171: 0.9680851063829787
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 172: 0.9361702127659575
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 173: 0.9680851063829787
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 174: 0.9680851063829787
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 175: 0.9574468085106383
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 176: 0.9468085106382979
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 177: 0.9680851063829787
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 178: 0.9574468085106383
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 179: 0.9574468085106383
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 180: 0.9680851063829787
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 181: 0.9787234042553191
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 182: 0.9468085106382979
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 183: 0.9787234042553191
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 184: 0.9574468085106383
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 185: 0.9787234042553191
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 186: 0.9787234042553191
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 187: 0.9680851063829787
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 188: 0.925531914893617
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 189: 0.9574468085106383
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 190: 0.9680851063829787
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 191: 0.9787234042553191
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 192: 0.9361702127659575
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 193: 0.9574468085106383
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 194: 0.9893617021276596
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 195: 0.9680851063829787
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 196: 0.9787234042553191
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 197: 0.9574468085106383
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 198: 0.9574468085106383
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 199: 0.9468085106382979
Warm optimizer lr: 0.010737418240000006
Val acc before epoch 200: 0.9468085106382979
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.9550561797752809
Final val micro accuracy: 0.9787234042553191
Final test macro f1-score: 0.835042735042735
Final test micro accuracy: 0.8936170212765957
Final validation:
	Cluster: 0.6942269504070282
	Separation: 0.4986402988433838
Final test:
	Cluster: 0.6604817807674408
	Separation: 0.5002233237028122
Saved Results

Attempting combination 2/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.8
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.05
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.23404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 20: 0.9680851063829787
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 26: 0.9893617021276596
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 30: 0.9680851063829787
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 31: 0.9680851063829787
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 36: 0.9680851063829787
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 38: 0.9680851063829787
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 40: 0.9574468085106383
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 41: 0.9680851063829787
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 43: 0.9574468085106383
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 48: 0.9893617021276596
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 50: 0.925531914893617
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 51: 0.9680851063829787
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 61: 0.9680851063829787
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 62: 0.9574468085106383
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 63: 0.9680851063829787
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 65: 0.9680851063829787
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 68: 0.9361702127659575
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 70: 0.9574468085106383
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 71: 0.9574468085106383
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 72: 0.9680851063829787
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 73: 0.9574468085106383
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 74: 0.9574468085106383
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 75: 0.925531914893617
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 76: 0.9361702127659575
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 77: 0.9574468085106383
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 78: 0.9787234042553191
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 79: 0.9574468085106383
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 80: 0.9893617021276596
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 81: 0.9680851063829787
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 82: 0.9787234042553191
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 83: 0.9787234042553191
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 84: 0.9361702127659575
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 85: 0.9893617021276596
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 86: 0.9787234042553191
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 87: 0.9574468085106383
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 88: 0.9680851063829787
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 89: 0.9468085106382979
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 90: 1.0
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 91: 0.9574468085106383
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 94: 0.9468085106382979
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 96: 0.9468085106382979
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 97: 0.9787234042553191
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 98: 0.925531914893617
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 99: 0.9361702127659575
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 100: 0.925531914893617
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 101: 0.9574468085106383
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 102: 0.925531914893617
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 103: 0.9893617021276596
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 104: 0.9042553191489362
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 105: 0.925531914893617
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 106: 0.9680851063829787
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 107: 0.9680851063829787
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 108: 0.925531914893617
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 109: 0.9468085106382979
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 110: 0.9680851063829787
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 111: 0.9574468085106383
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 112: 0.9574468085106383
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 113: 0.9574468085106383
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 114: 0.9787234042553191
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 115: 0.925531914893617
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 116: 0.9361702127659575
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 117: 0.9680851063829787
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 118: 0.9574468085106383
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 119: 0.9468085106382979
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 120: 0.9893617021276596
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 121: 0.9680851063829787
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 122: 0.925531914893617
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 123: 0.9574468085106383
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 124: 0.9468085106382979
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 125: 0.9574468085106383
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 126: 0.9574468085106383
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 127: 0.9468085106382979
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 128: 0.925531914893617
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 129: 0.9361702127659575
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 130: 0.9787234042553191
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 131: 0.9361702127659575
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 132: 0.925531914893617
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 133: 0.9680851063829787
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 134: 0.9468085106382979
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 135: 0.9361702127659575
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 136: 0.9468085106382979
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 137: 0.9787234042553191
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 138: 0.9468085106382979
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 139: 0.9574468085106383
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 140: 0.9361702127659575
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 141: 0.9680851063829787
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 142: 0.9361702127659575
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 143: 0.9468085106382979
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 144: 0.9468085106382979
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 145: 0.9680851063829787
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 146: 0.9468085106382979
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 147: 0.9680851063829787
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 148: 0.9361702127659575
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 149: 0.9361702127659575
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 150: 0.9468085106382979
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 151: 0.9574468085106383
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 152: 0.9468085106382979
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 153: 0.9468085106382979
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 154: 0.9574468085106383
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 155: 0.925531914893617
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 156: 0.9574468085106383
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 157: 0.9574468085106383
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 158: 0.9361702127659575
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 159: 0.9468085106382979
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 160: 0.9787234042553191
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 161: 0.9361702127659575
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 162: 0.9574468085106383
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 163: 0.9680851063829787
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 164: 0.9680851063829787
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 165: 0.9680851063829787
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 166: 0.9468085106382979
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 167: 0.9680851063829787
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 168: 0.9574468085106383
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 169: 0.9680851063829787
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 170: 0.9680851063829787
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 171: 0.9574468085106383
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 172: 0.9361702127659575
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 173: 0.9468085106382979
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 174: 0.9468085106382979
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 175: 0.9680851063829787
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 176: 0.9468085106382979
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 177: 0.9680851063829787
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 178: 0.9574468085106383
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 179: 0.9787234042553191
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 180: 0.925531914893617
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 181: 0.9148936170212766
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 182: 0.9680851063829787
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 183: 0.9574468085106383
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 184: 0.9787234042553191
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 185: 0.9574468085106383
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 186: 0.9148936170212766
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 187: 0.9468085106382979
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 188: 0.9361702127659575
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 189: 0.9893617021276596
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 190: 0.9787234042553191
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 191: 0.9574468085106383
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 192: 0.9680851063829787
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 193: 0.9574468085106383
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 194: 0.9468085106382979
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 195: 0.925531914893617
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 196: 0.9787234042553191
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 197: 0.9574468085106383
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 198: 0.9361702127659575
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 199: 0.9361702127659575
Warm optimizer lr: 0.005368709120000003
Val acc before epoch 200: 0.9361702127659575
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.9475655430711611
Final val micro accuracy: 0.9680851063829787
Final test macro f1-score: 0.8653679653679655
Final test micro accuracy: 0.9042553191489362
Final validation:
	Cluster: 0.6855312883853912
	Separation: 0.49710242450237274
Final test:
	Cluster: 0.6590058207511902
	Separation: 0.4968162775039673
Saved Results

Attempting combination 3/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.8
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.01
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.01
Val acc before epoch 1: 0.02127659574468085
Warm optimizer lr: 0.01
Val acc before epoch 2: 0.07446808510638298
Warm optimizer lr: 0.01
Val acc before epoch 3: 0.19148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 4: 0.2978723404255319
Warm optimizer lr: 0.01
Val acc before epoch 5: 0.44680851063829785
Warm optimizer lr: 0.01
Val acc before epoch 6: 0.6276595744680851
Warm optimizer lr: 0.01
Val acc before epoch 7: 0.6063829787234043
Warm optimizer lr: 0.01
Val acc before epoch 8: 0.7340425531914894
Warm optimizer lr: 0.01
Val acc before epoch 9: 0.7872340425531915
Warm optimizer lr: 0.01
Val acc before epoch 10: 0.7659574468085106
Warm optimizer lr: 0.01
Val acc before epoch 11: 0.8191489361702128
Warm optimizer lr: 0.01
Val acc before epoch 12: 0.8297872340425532
Warm optimizer lr: 0.01
Val acc before epoch 13: 0.8829787234042553
Warm optimizer lr: 0.01
Val acc before epoch 14: 0.8617021276595744
Warm optimizer lr: 0.01
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.01
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.01
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.01
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.008
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.008
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.008
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.008
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.008
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.008
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.008
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.008
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.008
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.008
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.008
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.008
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.008
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.008
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.008
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.008
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.008
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.008
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.008
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.008
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.0064
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.0064
Val acc before epoch 41: 0.9787234042553191
Warm optimizer lr: 0.0064
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.0064
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.0064
Val acc before epoch 44: 0.9680851063829787
Warm optimizer lr: 0.0064
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.0064
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.0064
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.0064
Val acc before epoch 48: 0.9574468085106383
Warm optimizer lr: 0.0064
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.0064
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.0064
Val acc before epoch 51: 0.9680851063829787
Warm optimizer lr: 0.0064
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.0064
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.0064
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.0064
Val acc before epoch 55: 0.9680851063829787
Warm optimizer lr: 0.0064
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.0064
Val acc before epoch 57: 0.9574468085106383
Warm optimizer lr: 0.0064
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.0064
Val acc before epoch 59: 0.9680851063829787
Warm optimizer lr: 0.00512
Val acc before epoch 60: 0.9680851063829787
Warm optimizer lr: 0.00512
Val acc before epoch 61: 0.9680851063829787
Warm optimizer lr: 0.00512
Val acc before epoch 62: 0.9574468085106383
Warm optimizer lr: 0.00512
Val acc before epoch 63: 1.0
Warm optimizer lr: 0.00512
Val acc before epoch 64: 0.9787234042553191
Warm optimizer lr: 0.00512
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.00512
Val acc before epoch 66: 0.9787234042553191
Warm optimizer lr: 0.00512
Val acc before epoch 67: 0.9680851063829787
Warm optimizer lr: 0.00512
Val acc before epoch 68: 0.9680851063829787
Warm optimizer lr: 0.00512
Val acc before epoch 69: 0.9680851063829787
Warm optimizer lr: 0.00512
Val acc before epoch 70: 0.9574468085106383
Warm optimizer lr: 0.00512
Val acc before epoch 71: 0.9361702127659575
Warm optimizer lr: 0.00512
Val acc before epoch 72: 0.9361702127659575
Warm optimizer lr: 0.00512
Val acc before epoch 73: 0.9680851063829787
Warm optimizer lr: 0.00512
Val acc before epoch 74: 0.9468085106382979
Warm optimizer lr: 0.00512
Val acc before epoch 75: 0.9468085106382979
Warm optimizer lr: 0.00512
Val acc before epoch 76: 0.9574468085106383
Warm optimizer lr: 0.00512
Val acc before epoch 77: 0.9468085106382979
Warm optimizer lr: 0.00512
Val acc before epoch 78: 0.9574468085106383
Warm optimizer lr: 0.00512
Val acc before epoch 79: 0.9574468085106383
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 80: 0.9680851063829787
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 81: 0.9468085106382979
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 82: 0.9680851063829787
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 83: 1.0
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 84: 0.9574468085106383
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 85: 0.9680851063829787
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 86: 0.9680851063829787
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 87: 0.9468085106382979
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 88: 0.9680851063829787
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 89: 0.9893617021276596
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 90: 0.9787234042553191
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 91: 0.9680851063829787
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 93: 0.9893617021276596
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 95: 0.9574468085106383
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 96: 0.9680851063829787
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 98: 0.9468085106382979
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 99: 0.9680851063829787
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 100: 0.9680851063829787
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 101: 0.9361702127659575
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 102: 0.9787234042553191
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 103: 0.9680851063829787
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 104: 0.9574468085106383
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 105: 0.9680851063829787
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 106: 0.9468085106382979
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 107: 0.9787234042553191
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 108: 0.9787234042553191
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 109: 0.9468085106382979
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 110: 0.9574468085106383
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 111: 0.9680851063829787
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 112: 0.9680851063829787
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 113: 0.9361702127659575
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 114: 0.9574468085106383
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 115: 0.9574468085106383
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 116: 0.9787234042553191
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 117: 0.9574468085106383
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 118: 0.9680851063829787
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 119: 0.9787234042553191
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 120: 0.9680851063829787
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 121: 0.9787234042553191
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 122: 0.9574468085106383
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 123: 0.9680851063829787
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 124: 0.9893617021276596
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 125: 0.9787234042553191
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 126: 0.9680851063829787
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 127: 0.9680851063829787
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 128: 0.9680851063829787
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 129: 0.9574468085106383
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 130: 0.9361702127659575
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 131: 0.9787234042553191
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 132: 0.9787234042553191
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 133: 0.9787234042553191
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 134: 0.9574468085106383
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 135: 0.9574468085106383
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 136: 0.9893617021276596
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 137: 0.9680851063829787
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 138: 0.9787234042553191
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 139: 0.9893617021276596
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 140: 0.9787234042553191
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 141: 0.9680851063829787
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 142: 0.9893617021276596
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 143: 0.9787234042553191
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 144: 0.9468085106382979
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 145: 0.9574468085106383
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 146: 0.9680851063829787
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 147: 0.9680851063829787
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 148: 0.9787234042553191
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 149: 0.9893617021276596
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 150: 0.9787234042553191
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 151: 0.9893617021276596
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 152: 0.9787234042553191
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 153: 0.9893617021276596
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 154: 0.9574468085106383
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 155: 0.9574468085106383
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 156: 0.9680851063829787
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 157: 0.9574468085106383
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 158: 0.9893617021276596
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 159: 0.9680851063829787
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 160: 0.9680851063829787
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 161: 0.9680851063829787
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 162: 0.9787234042553191
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 163: 0.9893617021276596
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 164: 0.9468085106382979
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 165: 0.9893617021276596
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 166: 0.9680851063829787
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 167: 0.9893617021276596
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 168: 0.9680851063829787
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 169: 0.9680851063829787
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 170: 0.9680851063829787
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 171: 0.9574468085106383
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 172: 0.9680851063829787
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 173: 0.9787234042553191
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 174: 0.9574468085106383
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 175: 0.9574468085106383
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 176: 0.9468085106382979
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 177: 0.9574468085106383
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 178: 0.9787234042553191
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 179: 0.9787234042553191
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 180: 0.9680851063829787
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 181: 0.9574468085106383
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 182: 0.9574468085106383
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 183: 0.9893617021276596
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 184: 0.9574468085106383
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 185: 0.9893617021276596
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 186: 0.9787234042553191
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 187: 0.9680851063829787
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 188: 0.9787234042553191
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 189: 0.9680851063829787
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 190: 0.9680851063829787
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 191: 0.9468085106382979
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 192: 0.9893617021276596
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 193: 0.9468085106382979
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 194: 0.9680851063829787
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 195: 0.9574468085106383
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 196: 0.9787234042553191
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 197: 0.9468085106382979
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 198: 0.9574468085106383
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 199: 0.9361702127659575
Warm optimizer lr: 0.0010737418240000006
Val acc before epoch 200: 0.9787234042553191
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.9545454545454546
Final val micro accuracy: 0.9680851063829787
Final test macro f1-score: 0.8881578947368421
Final test micro accuracy: 0.9148936170212766
Final validation:
	Cluster: 0.5699440836906433
	Separation: 0.4078092873096466
Final test:
	Cluster: 0.5448898077011108
	Separation: 0.4136306345462799
Saved Results

Attempting combination 4/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.8
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.005
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.005
Val acc before epoch 1: 0.0
Warm optimizer lr: 0.005
Val acc before epoch 2: 0.0425531914893617
Warm optimizer lr: 0.005
Val acc before epoch 3: 0.05319148936170213
Warm optimizer lr: 0.005
Val acc before epoch 4: 0.0851063829787234
Warm optimizer lr: 0.005
Val acc before epoch 5: 0.1702127659574468
Warm optimizer lr: 0.005
Val acc before epoch 6: 0.2553191489361702
Warm optimizer lr: 0.005
Val acc before epoch 7: 0.24468085106382978
Warm optimizer lr: 0.005
Val acc before epoch 8: 0.4148936170212766
Warm optimizer lr: 0.005
Val acc before epoch 9: 0.4574468085106383
Warm optimizer lr: 0.005
Val acc before epoch 10: 0.5
Warm optimizer lr: 0.005
Val acc before epoch 11: 0.5957446808510638
Warm optimizer lr: 0.005
Val acc before epoch 12: 0.6170212765957447
Warm optimizer lr: 0.005
Val acc before epoch 13: 0.6063829787234043
Warm optimizer lr: 0.005
Val acc before epoch 14: 0.6702127659574468
Warm optimizer lr: 0.005
Val acc before epoch 15: 0.7127659574468085
Warm optimizer lr: 0.005
Val acc before epoch 16: 0.6808510638297872
Warm optimizer lr: 0.005
Val acc before epoch 17: 0.7553191489361702
Warm optimizer lr: 0.005
Val acc before epoch 18: 0.776595744680851
Warm optimizer lr: 0.005
Val acc before epoch 19: 0.8297872340425532
Warm optimizer lr: 0.004
Val acc before epoch 20: 0.7553191489361702
Warm optimizer lr: 0.004
Val acc before epoch 21: 0.7659574468085106
Warm optimizer lr: 0.004
Val acc before epoch 22: 0.8085106382978723
Warm optimizer lr: 0.004
Val acc before epoch 23: 0.8723404255319149
Warm optimizer lr: 0.004
Val acc before epoch 24: 0.8085106382978723
Warm optimizer lr: 0.004
Val acc before epoch 25: 0.851063829787234
Warm optimizer lr: 0.004
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.004
Val acc before epoch 27: 0.851063829787234
Warm optimizer lr: 0.004
Val acc before epoch 28: 0.8617021276595744
Warm optimizer lr: 0.004
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.004
Val acc before epoch 30: 0.8297872340425532
Warm optimizer lr: 0.004
Val acc before epoch 31: 0.851063829787234
Warm optimizer lr: 0.004
Val acc before epoch 32: 0.8617021276595744
Warm optimizer lr: 0.004
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.004
Val acc before epoch 34: 0.8617021276595744
Warm optimizer lr: 0.004
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.004
Val acc before epoch 36: 0.8829787234042553
Warm optimizer lr: 0.004
Val acc before epoch 37: 0.8617021276595744
Warm optimizer lr: 0.004
Val acc before epoch 38: 0.9042553191489362
Warm optimizer lr: 0.004
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.0032
Val acc before epoch 40: 0.8723404255319149
Warm optimizer lr: 0.0032
Val acc before epoch 41: 0.851063829787234
Warm optimizer lr: 0.0032
Val acc before epoch 42: 0.8829787234042553
Warm optimizer lr: 0.0032
Val acc before epoch 43: 0.8723404255319149
Warm optimizer lr: 0.0032
Val acc before epoch 44: 0.9148936170212766
Warm optimizer lr: 0.0032
Val acc before epoch 45: 0.8829787234042553
Warm optimizer lr: 0.0032
Val acc before epoch 46: 0.8936170212765957
Warm optimizer lr: 0.0032
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.0032
Val acc before epoch 48: 0.9148936170212766
Warm optimizer lr: 0.0032
Val acc before epoch 49: 0.8936170212765957
Warm optimizer lr: 0.0032
Val acc before epoch 50: 0.9148936170212766
Warm optimizer lr: 0.0032
Val acc before epoch 51: 0.9148936170212766
Warm optimizer lr: 0.0032
Val acc before epoch 52: 0.9042553191489362
Warm optimizer lr: 0.0032
Val acc before epoch 53: 0.8829787234042553
Warm optimizer lr: 0.0032
Val acc before epoch 54: 0.8829787234042553
Warm optimizer lr: 0.0032
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.0032
Val acc before epoch 56: 0.9148936170212766
Warm optimizer lr: 0.0032
Val acc before epoch 57: 0.9042553191489362
Warm optimizer lr: 0.0032
Val acc before epoch 58: 0.9148936170212766
Warm optimizer lr: 0.0032
Val acc before epoch 59: 0.9148936170212766
Warm optimizer lr: 0.00256
Val acc before epoch 60: 0.9042553191489362
Warm optimizer lr: 0.00256
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.00256
Val acc before epoch 62: 0.8936170212765957
Warm optimizer lr: 0.00256
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.00256
Val acc before epoch 64: 0.8936170212765957
Warm optimizer lr: 0.00256
Val acc before epoch 65: 0.9042553191489362
Warm optimizer lr: 0.00256
Val acc before epoch 66: 0.9042553191489362
Warm optimizer lr: 0.00256
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.00256
Val acc before epoch 68: 0.9148936170212766
Warm optimizer lr: 0.00256
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.00256
Val acc before epoch 70: 0.925531914893617
Warm optimizer lr: 0.00256
Val acc before epoch 71: 0.9361702127659575
Warm optimizer lr: 0.00256
Val acc before epoch 72: 0.9361702127659575
Warm optimizer lr: 0.00256
Val acc before epoch 73: 0.9361702127659575
Warm optimizer lr: 0.00256
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.00256
Val acc before epoch 75: 0.9361702127659575
Warm optimizer lr: 0.00256
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 0.00256
Val acc before epoch 77: 0.925531914893617
Warm optimizer lr: 0.00256
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.00256
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 80: 0.9574468085106383
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 82: 0.9148936170212766
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 83: 0.9361702127659575
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 84: 0.8936170212765957
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 85: 0.8829787234042553
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 87: 0.9574468085106383
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 90: 0.9148936170212766
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 95: 0.9574468085106383
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 97: 0.9042553191489362
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 98: 0.9468085106382979
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 99: 0.9468085106382979
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 100: 0.925531914893617
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 101: 0.9574468085106383
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 102: 0.9468085106382979
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 103: 0.9361702127659575
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 104: 0.9680851063829787
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 105: 0.9468085106382979
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 106: 0.9361702127659575
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 107: 0.925531914893617
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 108: 0.9680851063829787
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 109: 0.9042553191489362
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 110: 0.9574468085106383
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 111: 0.9361702127659575
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 112: 0.9361702127659575
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 113: 0.9361702127659575
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 114: 0.9468085106382979
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 115: 0.9361702127659575
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 116: 0.9361702127659575
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 117: 0.925531914893617
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 118: 0.9574468085106383
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 119: 0.9574468085106383
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 120: 0.9361702127659575
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 121: 0.9468085106382979
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 122: 0.925531914893617
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 123: 0.9361702127659575
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 124: 0.925531914893617
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 125: 0.9042553191489362
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 126: 0.9468085106382979
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 127: 0.9361702127659575
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 128: 0.9042553191489362
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 129: 0.9361702127659575
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 130: 0.9574468085106383
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 131: 0.9468085106382979
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 132: 0.9574468085106383
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 133: 0.925531914893617
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 134: 0.925531914893617
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 135: 0.925531914893617
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 136: 0.9361702127659575
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 137: 0.925531914893617
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 138: 0.9468085106382979
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 139: 0.925531914893617
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 140: 0.9148936170212766
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 141: 0.9361702127659575
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 142: 0.9361702127659575
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 143: 0.9468085106382979
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 144: 0.9468085106382979
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 145: 0.9680851063829787
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 146: 0.9361702127659575
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 147: 0.9468085106382979
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 148: 0.925531914893617
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 149: 0.9680851063829787
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 150: 0.9574468085106383
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 151: 0.9574468085106383
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 152: 0.9787234042553191
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 153: 0.925531914893617
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 154: 0.925531914893617
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 155: 0.9361702127659575
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 156: 0.9574468085106383
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 157: 0.9361702127659575
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 158: 0.925531914893617
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 159: 0.9468085106382979
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 160: 0.9148936170212766
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 161: 0.9468085106382979
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 162: 0.9574468085106383
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 163: 0.9574468085106383
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 164: 0.925531914893617
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 165: 0.9361702127659575
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 166: 0.9680851063829787
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 167: 0.9574468085106383
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 168: 0.925531914893617
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 169: 0.9680851063829787
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 170: 0.9680851063829787
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 171: 0.925531914893617
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 172: 0.9468085106382979
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 173: 0.9468085106382979
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 174: 0.9468085106382979
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 175: 0.9574468085106383
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 176: 0.9361702127659575
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 177: 0.9468085106382979
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 178: 0.9680851063829787
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 179: 0.925531914893617
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 180: 0.9574468085106383
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 181: 0.9361702127659575
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 182: 0.9468085106382979
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 183: 0.9361702127659575
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 184: 0.9574468085106383
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 185: 0.9468085106382979
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 186: 0.9468085106382979
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 187: 0.925531914893617
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 188: 0.9468085106382979
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 189: 0.9574468085106383
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 190: 0.9468085106382979
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 191: 0.925531914893617
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 192: 0.9468085106382979
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 193: 0.9574468085106383
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 194: 0.925531914893617
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 195: 0.9468085106382979
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 196: 0.9468085106382979
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 197: 0.9361702127659575
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 198: 0.9574468085106383
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 199: 0.9680851063829787
Warm optimizer lr: 0.0005368709120000003
Val acc before epoch 200: 0.9468085106382979
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.9325842696629215
Final val micro accuracy: 0.9574468085106383
Final test macro f1-score: 0.81875
Final test micro accuracy: 0.8936170212765957
Final validation:
	Cluster: 0.3130172938108444
	Separation: 0.22518087178468704
Final test:
	Cluster: 0.30153509974479675
	Separation: 0.22730474174022675
Saved Results

Attempting combination 5/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.8
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.001
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 1: 0.02127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 2: 0.0
Warm optimizer lr: 0.001
Val acc before epoch 3: 0.0
Warm optimizer lr: 0.001
Val acc before epoch 4: 0.02127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 5: 0.0425531914893617
Warm optimizer lr: 0.001
Val acc before epoch 6: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 7: 0.0425531914893617
Warm optimizer lr: 0.001
Val acc before epoch 8: 0.02127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 9: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 10: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 11: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 12: 0.0425531914893617
Warm optimizer lr: 0.001
Val acc before epoch 13: 0.0425531914893617
Warm optimizer lr: 0.001
Val acc before epoch 14: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 15: 0.07446808510638298
Warm optimizer lr: 0.001
Val acc before epoch 16: 0.0851063829787234
Warm optimizer lr: 0.001
Val acc before epoch 17: 0.06382978723404255
Warm optimizer lr: 0.001
Val acc before epoch 18: 0.0425531914893617
Warm optimizer lr: 0.001
Val acc before epoch 19: 0.05319148936170213
Warm optimizer lr: 0.0008
Val acc before epoch 20: 0.10638297872340426
Warm optimizer lr: 0.0008
Val acc before epoch 21: 0.07446808510638298
Warm optimizer lr: 0.0008
Val acc before epoch 22: 0.11702127659574468
Warm optimizer lr: 0.0008
Val acc before epoch 23: 0.06382978723404255
Warm optimizer lr: 0.0008
Val acc before epoch 24: 0.1276595744680851
Warm optimizer lr: 0.0008
Val acc before epoch 25: 0.05319148936170213
Warm optimizer lr: 0.0008
Val acc before epoch 26: 0.09574468085106383
Warm optimizer lr: 0.0008
Val acc before epoch 27: 0.09574468085106383
Warm optimizer lr: 0.0008
Val acc before epoch 28: 0.14893617021276595
Warm optimizer lr: 0.0008
Val acc before epoch 29: 0.11702127659574468
Warm optimizer lr: 0.0008
Val acc before epoch 30: 0.18085106382978725
Warm optimizer lr: 0.0008
Val acc before epoch 31: 0.10638297872340426
Warm optimizer lr: 0.0008
Val acc before epoch 32: 0.1276595744680851
Warm optimizer lr: 0.0008
Val acc before epoch 33: 0.0851063829787234
Warm optimizer lr: 0.0008
Val acc before epoch 34: 0.11702127659574468
Warm optimizer lr: 0.0008
Val acc before epoch 35: 0.1595744680851064
Warm optimizer lr: 0.0008
Val acc before epoch 36: 0.14893617021276595
Warm optimizer lr: 0.0008
Val acc before epoch 37: 0.1595744680851064
Warm optimizer lr: 0.0008
Val acc before epoch 38: 0.1276595744680851
Warm optimizer lr: 0.0008
Val acc before epoch 39: 0.1595744680851064
Warm optimizer lr: 0.00064
Val acc before epoch 40: 0.1276595744680851
Warm optimizer lr: 0.00064
Val acc before epoch 41: 0.20212765957446807
Warm optimizer lr: 0.00064
Val acc before epoch 42: 0.19148936170212766
Warm optimizer lr: 0.00064
Val acc before epoch 43: 0.20212765957446807
Warm optimizer lr: 0.00064
Val acc before epoch 44: 0.20212765957446807
Warm optimizer lr: 0.00064
Val acc before epoch 45: 0.2872340425531915
Warm optimizer lr: 0.00064
Val acc before epoch 46: 0.2553191489361702
Warm optimizer lr: 0.00064
Val acc before epoch 47: 0.2127659574468085
Warm optimizer lr: 0.00064
Val acc before epoch 48: 0.2127659574468085
Warm optimizer lr: 0.00064
Val acc before epoch 49: 0.2872340425531915
Warm optimizer lr: 0.00064
Val acc before epoch 50: 0.2127659574468085
Warm optimizer lr: 0.00064
Val acc before epoch 51: 0.24468085106382978
Warm optimizer lr: 0.00064
Val acc before epoch 52: 0.2765957446808511
Warm optimizer lr: 0.00064
Val acc before epoch 53: 0.2553191489361702
Warm optimizer lr: 0.00064
Val acc before epoch 54: 0.24468085106382978
Warm optimizer lr: 0.00064
Val acc before epoch 55: 0.2553191489361702
Warm optimizer lr: 0.00064
Val acc before epoch 56: 0.2127659574468085
Warm optimizer lr: 0.00064
Val acc before epoch 57: 0.2553191489361702
Warm optimizer lr: 0.00064
Val acc before epoch 58: 0.2872340425531915
Warm optimizer lr: 0.00064
Val acc before epoch 59: 0.24468085106382978
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 60: 0.3191489361702128
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 61: 0.22340425531914893
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 62: 0.3723404255319149
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 63: 0.32978723404255317
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 64: 0.3617021276595745
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 65: 0.2872340425531915
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 66: 0.2978723404255319
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 67: 0.3191489361702128
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 68: 0.3191489361702128
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 69: 0.3829787234042553
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 70: 0.2978723404255319
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 71: 0.3191489361702128
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 72: 0.3723404255319149
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 73: 0.3191489361702128
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 74: 0.40425531914893614
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 75: 0.3404255319148936
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 76: 0.3617021276595745
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 77: 0.32978723404255317
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 78: 0.3829787234042553
Warm optimizer lr: 0.0005120000000000001
Val acc before epoch 79: 0.3723404255319149
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 80: 0.35106382978723405
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 81: 0.425531914893617
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 82: 0.40425531914893614
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 83: 0.43617021276595747
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 84: 0.32978723404255317
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 85: 0.40425531914893614
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 86: 0.43617021276595747
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 87: 0.3723404255319149
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 88: 0.40425531914893614
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 89: 0.39361702127659576
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 90: 0.40425531914893614
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 91: 0.3829787234042553
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 92: 0.4148936170212766
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 93: 0.4787234042553192
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 94: 0.43617021276595747
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 95: 0.46808510638297873
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 96: 0.43617021276595747
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 97: 0.46808510638297873
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 98: 0.39361702127659576
Warm optimizer lr: 0.0004096000000000001
Val acc before epoch 99: 0.5
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 100: 0.48936170212765956
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 101: 0.5212765957446809
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 102: 0.4148936170212766
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 103: 0.43617021276595747
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 104: 0.46808510638297873
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 105: 0.46808510638297873
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 106: 0.46808510638297873
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 107: 0.48936170212765956
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 108: 0.5212765957446809
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 109: 0.43617021276595747
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 110: 0.5531914893617021
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 111: 0.3404255319148936
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 112: 0.425531914893617
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 113: 0.4574468085106383
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 114: 0.5
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 115: 0.44680851063829785
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 116: 0.5212765957446809
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 117: 0.4787234042553192
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 118: 0.46808510638297873
Warm optimizer lr: 0.0003276800000000001
Val acc before epoch 119: 0.5319148936170213
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 120: 0.5212765957446809
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 121: 0.48936170212765956
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 122: 0.5425531914893617
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 123: 0.5531914893617021
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 124: 0.5531914893617021
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 125: 0.5851063829787234
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 126: 0.5
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 127: 0.5531914893617021
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 128: 0.6063829787234043
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 129: 0.5319148936170213
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 130: 0.5425531914893617
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 131: 0.5957446808510638
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 132: 0.6382978723404256
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 133: 0.5
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 134: 0.5425531914893617
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 135: 0.5106382978723404
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 136: 0.5319148936170213
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 137: 0.5425531914893617
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 138: 0.5106382978723404
Warm optimizer lr: 0.0002621440000000001
Val acc before epoch 139: 0.4787234042553192
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 140: 0.5851063829787234
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 141: 0.5638297872340425
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 142: 0.5957446808510638
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 143: 0.574468085106383
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 144: 0.5212765957446809
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 145: 0.5
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 146: 0.5531914893617021
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 147: 0.48936170212765956
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 148: 0.6170212765957447
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 149: 0.5212765957446809
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 150: 0.5851063829787234
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 151: 0.574468085106383
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 152: 0.5425531914893617
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 153: 0.574468085106383
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 154: 0.4787234042553192
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 155: 0.5531914893617021
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 156: 0.5957446808510638
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 157: 0.5531914893617021
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 158: 0.5638297872340425
Warm optimizer lr: 0.00020971520000000012
Val acc before epoch 159: 0.5531914893617021
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 160: 0.5425531914893617
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 161: 0.5212765957446809
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 162: 0.574468085106383
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 163: 0.5638297872340425
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 164: 0.648936170212766
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 165: 0.5425531914893617
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 166: 0.5319148936170213
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 167: 0.6063829787234043
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 168: 0.5425531914893617
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 169: 0.6276595744680851
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 170: 0.5638297872340425
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 171: 0.6063829787234043
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 172: 0.5319148936170213
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 173: 0.574468085106383
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 174: 0.574468085106383
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 175: 0.6063829787234043
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 176: 0.6170212765957447
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 177: 0.5531914893617021
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 178: 0.648936170212766
Warm optimizer lr: 0.0001677721600000001
Val acc before epoch 179: 0.6063829787234043
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 180: 0.574468085106383
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 181: 0.6276595744680851
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 182: 0.6702127659574468
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 183: 0.6063829787234043
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 184: 0.6702127659574468
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 185: 0.6276595744680851
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 186: 0.574468085106383
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 187: 0.5531914893617021
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 188: 0.5957446808510638
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 189: 0.6276595744680851
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 190: 0.5851063829787234
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 191: 0.6170212765957447
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 192: 0.6170212765957447
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 193: 0.5106382978723404
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 194: 0.5531914893617021
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 195: 0.5319148936170213
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 196: 0.6063829787234043
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 197: 0.5638297872340425
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 198: 0.6063829787234043
Warm optimizer lr: 0.00013421772800000008
Val acc before epoch 199: 0.6382978723404256
Warm optimizer lr: 0.00010737418240000007
Val acc before epoch 200: 0.6063829787234043
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5146666666666667
Final val micro accuracy: 0.6063829787234043
Final test macro f1-score: 0.5602409638554217
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.05384105630218983
	Separation: 0.05070437490940094
Final test:
	Cluster: 0.053149960935115814
	Separation: 0.051139919087290764
Saved Results

Attempting combination 6/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.8
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.0005
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 1: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 2: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 3: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 4: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 5: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 6: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 7: 0.02127659574468085
Warm optimizer lr: 0.0005
Val acc before epoch 8: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 9: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 10: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 11: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 12: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 13: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 14: 0.0425531914893617
Warm optimizer lr: 0.0005
Val acc before epoch 15: 0.02127659574468085
Warm optimizer lr: 0.0005
Val acc before epoch 16: 0.031914893617021274
Warm optimizer lr: 0.0005
Val acc before epoch 17: 0.02127659574468085
Warm optimizer lr: 0.0005
Val acc before epoch 18: 0.0425531914893617
Warm optimizer lr: 0.0005
Val acc before epoch 19: 0.02127659574468085
Warm optimizer lr: 0.0004
Val acc before epoch 20: 0.07446808510638298
Warm optimizer lr: 0.0004
Val acc before epoch 21: 0.0425531914893617
Warm optimizer lr: 0.0004
Val acc before epoch 22: 0.031914893617021274
Warm optimizer lr: 0.0004
Val acc before epoch 23: 0.0
Warm optimizer lr: 0.0004
Val acc before epoch 24: 0.0
Warm optimizer lr: 0.0004
Val acc before epoch 25: 0.031914893617021274
Warm optimizer lr: 0.0004
Val acc before epoch 26: 0.0
Warm optimizer lr: 0.0004
Val acc before epoch 27: 0.031914893617021274
Warm optimizer lr: 0.0004
Val acc before epoch 28: 0.010638297872340425
Warm optimizer lr: 0.0004
Val acc before epoch 29: 0.010638297872340425
Warm optimizer lr: 0.0004
Val acc before epoch 30: 0.031914893617021274
Warm optimizer lr: 0.0004
Val acc before epoch 31: 0.06382978723404255
Warm optimizer lr: 0.0004
Val acc before epoch 32: 0.0851063829787234
Warm optimizer lr: 0.0004
Val acc before epoch 33: 0.0425531914893617
Warm optimizer lr: 0.0004
Val acc before epoch 34: 0.06382978723404255
Warm optimizer lr: 0.0004
Val acc before epoch 35: 0.06382978723404255
Warm optimizer lr: 0.0004
Val acc before epoch 36: 0.05319148936170213
Warm optimizer lr: 0.0004
Val acc before epoch 37: 0.05319148936170213
Warm optimizer lr: 0.0004
Val acc before epoch 38: 0.031914893617021274
Warm optimizer lr: 0.0004
Val acc before epoch 39: 0.06382978723404255
Warm optimizer lr: 0.00032
Val acc before epoch 40: 0.02127659574468085
Warm optimizer lr: 0.00032
Val acc before epoch 41: 0.06382978723404255
Warm optimizer lr: 0.00032
Val acc before epoch 42: 0.06382978723404255
Warm optimizer lr: 0.00032
Val acc before epoch 43: 0.0851063829787234
Warm optimizer lr: 0.00032
Val acc before epoch 44: 0.0851063829787234
Warm optimizer lr: 0.00032
Val acc before epoch 45: 0.09574468085106383
Warm optimizer lr: 0.00032
Val acc before epoch 46: 0.05319148936170213
Warm optimizer lr: 0.00032
Val acc before epoch 47: 0.09574468085106383
Warm optimizer lr: 0.00032
Val acc before epoch 48: 0.0425531914893617
Warm optimizer lr: 0.00032
Val acc before epoch 49: 0.0851063829787234
Warm optimizer lr: 0.00032
Val acc before epoch 50: 0.07446808510638298
Warm optimizer lr: 0.00032
Val acc before epoch 51: 0.0851063829787234
Warm optimizer lr: 0.00032
Val acc before epoch 52: 0.05319148936170213
Warm optimizer lr: 0.00032
Val acc before epoch 53: 0.06382978723404255
Warm optimizer lr: 0.00032
Val acc before epoch 54: 0.07446808510638298
Warm optimizer lr: 0.00032
Val acc before epoch 55: 0.0425531914893617
Warm optimizer lr: 0.00032
Val acc before epoch 56: 0.09574468085106383
Warm optimizer lr: 0.00032
Val acc before epoch 57: 0.06382978723404255
Warm optimizer lr: 0.00032
Val acc before epoch 58: 0.0851063829787234
Warm optimizer lr: 0.00032
Val acc before epoch 59: 0.11702127659574468
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 60: 0.07446808510638298
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 61: 0.09574468085106383
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 62: 0.11702127659574468
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 63: 0.10638297872340426
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 64: 0.07446808510638298
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 65: 0.10638297872340426
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 66: 0.09574468085106383
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 67: 0.10638297872340426
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 68: 0.0851063829787234
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 69: 0.07446808510638298
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 70: 0.11702127659574468
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 71: 0.14893617021276595
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 72: 0.13829787234042554
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 73: 0.10638297872340426
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 74: 0.13829787234042554
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 75: 0.1276595744680851
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 76: 0.0851063829787234
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 77: 0.10638297872340426
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 78: 0.1276595744680851
Warm optimizer lr: 0.00025600000000000004
Val acc before epoch 79: 0.07446808510638298
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 80: 0.14893617021276595
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 81: 0.1276595744680851
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 82: 0.14893617021276595
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 83: 0.11702127659574468
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 84: 0.14893617021276595
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 85: 0.1276595744680851
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 86: 0.10638297872340426
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 87: 0.1276595744680851
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 88: 0.1702127659574468
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 89: 0.11702127659574468
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 90: 0.1595744680851064
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 91: 0.1276595744680851
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 92: 0.1595744680851064
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 93: 0.09574468085106383
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 94: 0.18085106382978725
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 95: 0.1276595744680851
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 96: 0.10638297872340426
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 97: 0.11702127659574468
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 98: 0.13829787234042554
Warm optimizer lr: 0.00020480000000000004
Val acc before epoch 99: 0.13829787234042554
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 100: 0.14893617021276595
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 101: 0.13829787234042554
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 102: 0.14893617021276595
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 103: 0.20212765957446807
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 104: 0.14893617021276595
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 105: 0.18085106382978725
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 106: 0.14893617021276595
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 107: 0.2553191489361702
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 108: 0.1702127659574468
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 109: 0.2127659574468085
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 110: 0.14893617021276595
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 111: 0.19148936170212766
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 112: 0.1276595744680851
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 113: 0.1702127659574468
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 114: 0.18085106382978725
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 115: 0.13829787234042554
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 116: 0.1276595744680851
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 117: 0.14893617021276595
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 118: 0.1702127659574468
Warm optimizer lr: 0.00016384000000000006
Val acc before epoch 119: 0.18085106382978725
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 120: 0.22340425531914893
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 121: 0.20212765957446807
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 122: 0.14893617021276595
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 123: 0.20212765957446807
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 124: 0.2127659574468085
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 125: 0.22340425531914893
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 126: 0.1702127659574468
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 127: 0.18085106382978725
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 128: 0.1595744680851064
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 129: 0.13829787234042554
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 130: 0.18085106382978725
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 131: 0.20212765957446807
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 132: 0.20212765957446807
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 133: 0.1702127659574468
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 134: 0.1595744680851064
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 135: 0.20212765957446807
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 136: 0.20212765957446807
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 137: 0.19148936170212766
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 138: 0.22340425531914893
Warm optimizer lr: 0.00013107200000000006
Val acc before epoch 139: 0.1702127659574468
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 140: 0.19148936170212766
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 141: 0.1595744680851064
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 142: 0.23404255319148937
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 143: 0.2553191489361702
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 144: 0.1702127659574468
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 145: 0.22340425531914893
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 146: 0.20212765957446807
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 147: 0.23404255319148937
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 148: 0.2127659574468085
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 149: 0.23404255319148937
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 150: 0.2978723404255319
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 151: 0.2127659574468085
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 152: 0.19148936170212766
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 153: 0.22340425531914893
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 154: 0.22340425531914893
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 155: 0.1595744680851064
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 156: 0.1702127659574468
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 157: 0.18085106382978725
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 158: 0.2127659574468085
Warm optimizer lr: 0.00010485760000000006
Val acc before epoch 159: 0.20212765957446807
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 160: 0.24468085106382978
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 161: 0.2127659574468085
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 162: 0.19148936170212766
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 163: 0.19148936170212766
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 164: 0.19148936170212766
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 165: 0.2872340425531915
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 166: 0.22340425531914893
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 167: 0.22340425531914893
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 168: 0.19148936170212766
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 169: 0.26595744680851063
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 170: 0.20212765957446807
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 171: 0.22340425531914893
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 172: 0.14893617021276595
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 173: 0.22340425531914893
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 174: 0.2765957446808511
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 175: 0.2553191489361702
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 176: 0.23404255319148937
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 177: 0.24468085106382978
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 178: 0.24468085106382978
Warm optimizer lr: 8.388608000000005e-05
Val acc before epoch 179: 0.23404255319148937
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 180: 0.2978723404255319
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 181: 0.2765957446808511
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 182: 0.24468085106382978
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 183: 0.1702127659574468
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 184: 0.23404255319148937
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 185: 0.24468085106382978
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 186: 0.1595744680851064
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 187: 0.2765957446808511
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 188: 0.26595744680851063
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 189: 0.23404255319148937
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 190: 0.20212765957446807
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 191: 0.35106382978723405
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 192: 0.2553191489361702
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 193: 0.22340425531914893
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 194: 0.20212765957446807
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 195: 0.2553191489361702
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 196: 0.22340425531914893
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 197: 0.22340425531914893
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 198: 0.23404255319148937
Warm optimizer lr: 6.710886400000004e-05
Val acc before epoch 199: 0.2127659574468085
Warm optimizer lr: 5.3687091200000036e-05
Val acc before epoch 200: 0.24468085106382978
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.17976939203354295
Final val micro accuracy: 0.2553191489361702
Final test macro f1-score: 0.17113402061855668
Final test micro accuracy: 0.2553191489361702
Final validation:
	Cluster: 0.03256148286163807
	Separation: 0.039156755432486534
Final test:
	Cluster: 0.03147844411432743
	Separation: 0.0391872264444828
Saved Results

Attempting combination 7/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.8
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.0001
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 1: 0.010638297872340425
Warm optimizer lr: 0.0001
Val acc before epoch 2: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 3: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 4: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 5: 0.02127659574468085
Warm optimizer lr: 0.0001
Val acc before epoch 6: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 7: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 8: 0.010638297872340425
Warm optimizer lr: 0.0001
Val acc before epoch 9: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 10: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 11: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 12: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 13: 0.010638297872340425
Warm optimizer lr: 0.0001
Val acc before epoch 14: 0.010638297872340425
Warm optimizer lr: 0.0001
Val acc before epoch 15: 0.010638297872340425
Warm optimizer lr: 0.0001
Val acc before epoch 16: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 17: 0.010638297872340425
Warm optimizer lr: 0.0001
Val acc before epoch 18: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 19: 0.010638297872340425
Warm optimizer lr: 8e-05
Val acc before epoch 20: 0.0
Warm optimizer lr: 8e-05
Val acc before epoch 21: 0.02127659574468085
Warm optimizer lr: 8e-05
Val acc before epoch 22: 0.010638297872340425
Warm optimizer lr: 8e-05
Val acc before epoch 23: 0.010638297872340425
Warm optimizer lr: 8e-05
Val acc before epoch 24: 0.0
Warm optimizer lr: 8e-05
Val acc before epoch 25: 0.02127659574468085
Warm optimizer lr: 8e-05
Val acc before epoch 26: 0.0
Warm optimizer lr: 8e-05
Val acc before epoch 27: 0.010638297872340425
Warm optimizer lr: 8e-05
Val acc before epoch 28: 0.0
Warm optimizer lr: 8e-05
Val acc before epoch 29: 0.02127659574468085
Warm optimizer lr: 8e-05
Val acc before epoch 30: 0.0
Warm optimizer lr: 8e-05
Val acc before epoch 31: 0.010638297872340425
Warm optimizer lr: 8e-05
Val acc before epoch 32: 0.0
Warm optimizer lr: 8e-05
Val acc before epoch 33: 0.010638297872340425
Warm optimizer lr: 8e-05
Val acc before epoch 34: 0.0
Warm optimizer lr: 8e-05
Val acc before epoch 35: 0.010638297872340425
Warm optimizer lr: 8e-05
Val acc before epoch 36: 0.010638297872340425
Warm optimizer lr: 8e-05
Val acc before epoch 37: 0.010638297872340425
Warm optimizer lr: 8e-05
Val acc before epoch 38: 0.010638297872340425
Warm optimizer lr: 8e-05
Val acc before epoch 39: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 40: 0.010638297872340425
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 41: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 42: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 43: 0.010638297872340425
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 44: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 45: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 46: 0.010638297872340425
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 47: 0.010638297872340425
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 48: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 49: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 50: 0.031914893617021274
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 51: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 52: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 53: 0.010638297872340425
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 54: 0.010638297872340425
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 55: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 56: 0.0
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 57: 0.010638297872340425
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 58: 0.010638297872340425
Warm optimizer lr: 6.400000000000001e-05
Val acc before epoch 59: 0.02127659574468085
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 60: 0.0
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 61: 0.0
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 62: 0.010638297872340425
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 63: 0.0
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 64: 0.0
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 65: 0.031914893617021274
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 66: 0.010638297872340425
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 67: 0.010638297872340425
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 68: 0.0
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 69: 0.0
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 70: 0.0
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 71: 0.0
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 72: 0.010638297872340425
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 73: 0.010638297872340425
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 74: 0.0
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 75: 0.031914893617021274
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 76: 0.010638297872340425
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 77: 0.0
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 78: 0.010638297872340425
Warm optimizer lr: 5.120000000000001e-05
Val acc before epoch 79: 0.0
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 80: 0.02127659574468085
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 81: 0.010638297872340425
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 82: 0.010638297872340425
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 83: 0.010638297872340425
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 84: 0.02127659574468085
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 85: 0.010638297872340425
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 86: 0.02127659574468085
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 87: 0.02127659574468085
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 88: 0.0
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 89: 0.031914893617021274
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 90: 0.010638297872340425
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 91: 0.0
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 92: 0.010638297872340425
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 93: 0.010638297872340425
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 94: 0.02127659574468085
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 95: 0.0
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 96: 0.0
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 97: 0.02127659574468085
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 98: 0.0
Warm optimizer lr: 4.0960000000000014e-05
Val acc before epoch 99: 0.02127659574468085
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 100: 0.010638297872340425
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 101: 0.010638297872340425
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 102: 0.010638297872340425
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 103: 0.010638297872340425
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 104: 0.0
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 105: 0.010638297872340425
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 106: 0.0425531914893617
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 107: 0.0
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 108: 0.02127659574468085
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 109: 0.0
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 110: 0.010638297872340425
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 111: 0.031914893617021274
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 112: 0.0
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 113: 0.0
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 114: 0.02127659574468085
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 115: 0.010638297872340425
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 116: 0.0
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 117: 0.010638297872340425
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 118: 0.02127659574468085
Warm optimizer lr: 3.2768000000000016e-05
Val acc before epoch 119: 0.010638297872340425
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 120: 0.0
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 121: 0.010638297872340425
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 122: 0.0
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 123: 0.010638297872340425
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 124: 0.031914893617021274
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 125: 0.0
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 126: 0.02127659574468085
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 127: 0.02127659574468085
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 128: 0.010638297872340425
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 129: 0.010638297872340425
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 130: 0.0
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 131: 0.010638297872340425
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 132: 0.031914893617021274
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 133: 0.031914893617021274
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 134: 0.010638297872340425
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 135: 0.010638297872340425
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 136: 0.010638297872340425
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 137: 0.0
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 138: 0.031914893617021274
Warm optimizer lr: 2.6214400000000015e-05
Val acc before epoch 139: 0.010638297872340425
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 140: 0.031914893617021274
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 141: 0.0425531914893617
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 142: 0.010638297872340425
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 143: 0.010638297872340425
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 144: 0.010638297872340425
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 145: 0.0425531914893617
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 146: 0.02127659574468085
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 147: 0.0
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 148: 0.0
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 149: 0.010638297872340425
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 150: 0.010638297872340425
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 151: 0.02127659574468085
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 152: 0.0
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 153: 0.0
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 154: 0.02127659574468085
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 155: 0.010638297872340425
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 156: 0.010638297872340425
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 157: 0.010638297872340425
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 158: 0.010638297872340425
Warm optimizer lr: 2.0971520000000012e-05
Val acc before epoch 159: 0.0
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 160: 0.0
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 161: 0.010638297872340425
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 162: 0.010638297872340425
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 163: 0.010638297872340425
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 164: 0.010638297872340425
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 165: 0.0
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 166: 0.0
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 167: 0.0
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 168: 0.02127659574468085
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 169: 0.02127659574468085
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 170: 0.02127659574468085
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 171: 0.0425531914893617
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 172: 0.02127659574468085
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 173: 0.02127659574468085
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 174: 0.02127659574468085
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 175: 0.031914893617021274
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 176: 0.0
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 177: 0.031914893617021274
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 178: 0.010638297872340425
Warm optimizer lr: 1.677721600000001e-05
Val acc before epoch 179: 0.010638297872340425
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 180: 0.02127659574468085
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 181: 0.02127659574468085
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 182: 0.010638297872340425
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 183: 0.0
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 184: 0.0
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 185: 0.0425531914893617
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 186: 0.02127659574468085
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 187: 0.02127659574468085
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 188: 0.02127659574468085
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 189: 0.0
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 190: 0.05319148936170213
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 191: 0.02127659574468085
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 192: 0.0425531914893617
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 193: 0.010638297872340425
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 194: 0.031914893617021274
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 195: 0.010638297872340425
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 196: 0.0
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 197: 0.010638297872340425
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 198: 0.02127659574468085
Warm optimizer lr: 1.3421772800000009e-05
Val acc before epoch 199: 0.010638297872340425
Warm optimizer lr: 1.0737418240000008e-05
Val acc before epoch 200: 0.0
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.013761467889908258
Final val micro accuracy: 0.02127659574468085
Final test macro f1-score: 0.0037735849056603774
Final test micro accuracy: 0.010638297872340425
Final validation:
	Cluster: 0.019943679682910442
	Separation: 0.03431050293147564
Final test:
	Cluster: 0.01927471812814474
	Separation: 0.034090178087353706
Saved Results

Attempting combination 8/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.5
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.5
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5212765957446809
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8191489361702128
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.5
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.5
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.5
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 16: 0.9361702127659575
Warm optimizer lr: 0.5
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.5
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.25
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 32: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 36: 0.9680851063829787
Warm optimizer lr: 0.25
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.25
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 40: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.125
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.125
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.125
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 58: 0.925531914893617
Warm optimizer lr: 0.125
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.0625
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.0625
Val acc before epoch 61: 0.925531914893617
Warm optimizer lr: 0.0625
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 0.0625
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.0625
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 65: 0.9680851063829787
Warm optimizer lr: 0.0625
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 67: 0.9680851063829787
Warm optimizer lr: 0.0625
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.0625
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 70: 0.925531914893617
Warm optimizer lr: 0.0625
Val acc before epoch 71: 0.9042553191489362
Warm optimizer lr: 0.0625
Val acc before epoch 72: 0.925531914893617
Warm optimizer lr: 0.0625
Val acc before epoch 73: 0.9893617021276596
Warm optimizer lr: 0.0625
Val acc before epoch 74: 0.9468085106382979
Warm optimizer lr: 0.0625
Val acc before epoch 75: 0.9468085106382979
Warm optimizer lr: 0.0625
Val acc before epoch 76: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 77: 0.9680851063829787
Warm optimizer lr: 0.0625
Val acc before epoch 78: 0.9574468085106383
Warm optimizer lr: 0.0625
Val acc before epoch 79: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 80: 0.925531914893617
Warm optimizer lr: 0.03125
Val acc before epoch 81: 0.9574468085106383
Warm optimizer lr: 0.03125
Val acc before epoch 82: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 83: 0.925531914893617
Warm optimizer lr: 0.03125
Val acc before epoch 84: 0.9361702127659575
Warm optimizer lr: 0.03125
Val acc before epoch 85: 0.9787234042553191
Warm optimizer lr: 0.03125
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.03125
Val acc before epoch 88: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 0.03125
Val acc before epoch 90: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.03125
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 93: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 0.03125
Val acc before epoch 95: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 96: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 97: 0.9680851063829787
Warm optimizer lr: 0.03125
Val acc before epoch 98: 0.925531914893617
Warm optimizer lr: 0.03125
Val acc before epoch 99: 0.925531914893617
Warm optimizer lr: 0.015625
Val acc before epoch 100: 0.925531914893617
Warm optimizer lr: 0.015625
Val acc before epoch 101: 0.9574468085106383
Warm optimizer lr: 0.015625
Val acc before epoch 102: 0.9574468085106383
Warm optimizer lr: 0.015625
Val acc before epoch 103: 0.9574468085106383
Warm optimizer lr: 0.015625
Val acc before epoch 104: 0.9468085106382979
Warm optimizer lr: 0.015625
Val acc before epoch 105: 0.9574468085106383
Warm optimizer lr: 0.015625
Val acc before epoch 106: 0.9468085106382979
Warm optimizer lr: 0.015625
Val acc before epoch 107: 0.9361702127659575
Warm optimizer lr: 0.015625
Val acc before epoch 108: 0.9361702127659575
Warm optimizer lr: 0.015625
Val acc before epoch 109: 0.9574468085106383
Warm optimizer lr: 0.015625
Val acc before epoch 110: 0.9468085106382979
Warm optimizer lr: 0.015625
Val acc before epoch 111: 0.9468085106382979
Warm optimizer lr: 0.015625
Val acc before epoch 112: 0.9680851063829787
Warm optimizer lr: 0.015625
Val acc before epoch 113: 0.9680851063829787
Warm optimizer lr: 0.015625
Val acc before epoch 114: 0.9680851063829787
Warm optimizer lr: 0.015625
Val acc before epoch 115: 0.9787234042553191
Warm optimizer lr: 0.015625
Val acc before epoch 116: 0.9468085106382979
Warm optimizer lr: 0.015625
Val acc before epoch 117: 0.9148936170212766
Warm optimizer lr: 0.015625
Val acc before epoch 118: 0.9574468085106383
Warm optimizer lr: 0.015625
Val acc before epoch 119: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 120: 0.9574468085106383
Warm optimizer lr: 0.0078125
Val acc before epoch 121: 0.9574468085106383
Warm optimizer lr: 0.0078125
Val acc before epoch 122: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 123: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 124: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 125: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 126: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 127: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 128: 0.9574468085106383
Warm optimizer lr: 0.0078125
Val acc before epoch 129: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 130: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 131: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 132: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 133: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 134: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 135: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 136: 0.9680851063829787
Warm optimizer lr: 0.0078125
Val acc before epoch 137: 0.8936170212765957
Warm optimizer lr: 0.0078125
Val acc before epoch 138: 0.925531914893617
Warm optimizer lr: 0.0078125
Val acc before epoch 139: 0.9574468085106383
Warm optimizer lr: 0.00390625
Val acc before epoch 140: 0.9787234042553191
Warm optimizer lr: 0.00390625
Val acc before epoch 141: 0.9361702127659575
Warm optimizer lr: 0.00390625
Val acc before epoch 142: 0.925531914893617
Warm optimizer lr: 0.00390625
Val acc before epoch 143: 0.925531914893617
Warm optimizer lr: 0.00390625
Val acc before epoch 144: 0.9468085106382979
Warm optimizer lr: 0.00390625
Val acc before epoch 145: 0.9680851063829787
Warm optimizer lr: 0.00390625
Val acc before epoch 146: 0.9042553191489362
Warm optimizer lr: 0.00390625
Val acc before epoch 147: 0.9680851063829787
Warm optimizer lr: 0.00390625
Val acc before epoch 148: 0.9468085106382979
Warm optimizer lr: 0.00390625
Val acc before epoch 149: 0.9787234042553191
Warm optimizer lr: 0.00390625
Val acc before epoch 150: 0.9148936170212766
Warm optimizer lr: 0.00390625
Val acc before epoch 151: 0.9680851063829787
Warm optimizer lr: 0.00390625
Val acc before epoch 152: 0.9148936170212766
Warm optimizer lr: 0.00390625
Val acc before epoch 153: 0.9361702127659575
Warm optimizer lr: 0.00390625
Val acc before epoch 154: 0.9361702127659575
Warm optimizer lr: 0.00390625
Val acc before epoch 155: 0.9680851063829787
Warm optimizer lr: 0.00390625
Val acc before epoch 156: 0.9468085106382979
Warm optimizer lr: 0.00390625
Val acc before epoch 157: 0.9468085106382979
Warm optimizer lr: 0.00390625
Val acc before epoch 158: 0.9574468085106383
Warm optimizer lr: 0.00390625
Val acc before epoch 159: 0.9574468085106383
Warm optimizer lr: 0.001953125
Val acc before epoch 160: 0.9680851063829787
Warm optimizer lr: 0.001953125
Val acc before epoch 161: 0.9680851063829787
Warm optimizer lr: 0.001953125
Val acc before epoch 162: 0.9148936170212766
Warm optimizer lr: 0.001953125
Val acc before epoch 163: 0.9468085106382979
Warm optimizer lr: 0.001953125
Val acc before epoch 164: 0.9468085106382979
Warm optimizer lr: 0.001953125
Val acc before epoch 165: 0.925531914893617
Warm optimizer lr: 0.001953125
Val acc before epoch 166: 0.9361702127659575
Warm optimizer lr: 0.001953125
Val acc before epoch 167: 0.9574468085106383
Warm optimizer lr: 0.001953125
Val acc before epoch 168: 0.9361702127659575
Warm optimizer lr: 0.001953125
Val acc before epoch 169: 0.9361702127659575
Warm optimizer lr: 0.001953125
Val acc before epoch 170: 0.9468085106382979
Warm optimizer lr: 0.001953125
Val acc before epoch 171: 0.9468085106382979
Warm optimizer lr: 0.001953125
Val acc before epoch 172: 0.9468085106382979
Warm optimizer lr: 0.001953125
Val acc before epoch 173: 0.9680851063829787
Warm optimizer lr: 0.001953125
Val acc before epoch 174: 0.925531914893617
Warm optimizer lr: 0.001953125
Val acc before epoch 175: 0.9574468085106383
Warm optimizer lr: 0.001953125
Val acc before epoch 176: 0.9361702127659575
Warm optimizer lr: 0.001953125
Val acc before epoch 177: 0.9680851063829787
Warm optimizer lr: 0.001953125
Val acc before epoch 178: 0.9468085106382979
Warm optimizer lr: 0.001953125
Val acc before epoch 179: 0.925531914893617
Warm optimizer lr: 0.0009765625
Val acc before epoch 180: 0.9361702127659575
Warm optimizer lr: 0.0009765625
Val acc before epoch 181: 0.9361702127659575
Warm optimizer lr: 0.0009765625
Val acc before epoch 182: 0.9468085106382979
Warm optimizer lr: 0.0009765625
Val acc before epoch 183: 0.9680851063829787
Warm optimizer lr: 0.0009765625
Val acc before epoch 184: 0.9468085106382979
Warm optimizer lr: 0.0009765625
Val acc before epoch 185: 0.9468085106382979
Warm optimizer lr: 0.0009765625
Val acc before epoch 186: 0.9361702127659575
Warm optimizer lr: 0.0009765625
Val acc before epoch 187: 0.9787234042553191
Warm optimizer lr: 0.0009765625
Val acc before epoch 188: 0.9680851063829787
Warm optimizer lr: 0.0009765625
Val acc before epoch 189: 0.9361702127659575
Warm optimizer lr: 0.0009765625
Val acc before epoch 190: 0.925531914893617
Warm optimizer lr: 0.0009765625
Val acc before epoch 191: 0.9468085106382979
Warm optimizer lr: 0.0009765625
Val acc before epoch 192: 0.9574468085106383
Warm optimizer lr: 0.0009765625
Val acc before epoch 193: 0.9574468085106383
Warm optimizer lr: 0.0009765625
Val acc before epoch 194: 0.9361702127659575
Warm optimizer lr: 0.0009765625
Val acc before epoch 195: 0.9468085106382979
Warm optimizer lr: 0.0009765625
Val acc before epoch 196: 0.9468085106382979
Warm optimizer lr: 0.0009765625
Val acc before epoch 197: 0.9361702127659575
Warm optimizer lr: 0.0009765625
Val acc before epoch 198: 0.9468085106382979
Warm optimizer lr: 0.0009765625
Val acc before epoch 199: 0.9468085106382979
Warm optimizer lr: 0.00048828125
Val acc before epoch 200: 0.9361702127659575
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.9250936329588016
Final val micro accuracy: 0.9574468085106383
Final test macro f1-score: 0.8270042194092826
Final test micro accuracy: 0.8936170212765957
Final validation:
	Cluster: 0.6725735366344452
	Separation: 0.4898253381252289
Final test:
	Cluster: 0.6481645107269287
	Separation: 0.49452029168605804
Saved Results

Attempting combination 9/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.5
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.5851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9787234042553191
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 16: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 40: 0.9680851063829787
Warm optimizer lr: 0.025
Val acc before epoch 41: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 43: 0.9680851063829787
Warm optimizer lr: 0.025
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 47: 0.9680851063829787
Warm optimizer lr: 0.025
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 50: 0.9787234042553191
Warm optimizer lr: 0.025
Val acc before epoch 51: 0.9680851063829787
Warm optimizer lr: 0.025
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.025
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 60: 0.9787234042553191
Warm optimizer lr: 0.0125
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 62: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 66: 0.9787234042553191
Warm optimizer lr: 0.0125
Val acc before epoch 67: 0.9680851063829787
Warm optimizer lr: 0.0125
Val acc before epoch 68: 0.9787234042553191
Warm optimizer lr: 0.0125
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.0125
Val acc before epoch 70: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 71: 0.925531914893617
Warm optimizer lr: 0.0125
Val acc before epoch 72: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 73: 0.9680851063829787
Warm optimizer lr: 0.0125
Val acc before epoch 74: 0.9787234042553191
Warm optimizer lr: 0.0125
Val acc before epoch 75: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 76: 0.9787234042553191
Warm optimizer lr: 0.0125
Val acc before epoch 77: 0.9680851063829787
Warm optimizer lr: 0.0125
Val acc before epoch 78: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 79: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 80: 0.9787234042553191
Warm optimizer lr: 0.00625
Val acc before epoch 81: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 82: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 83: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 84: 0.9787234042553191
Warm optimizer lr: 0.00625
Val acc before epoch 85: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 86: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 87: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 89: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 91: 0.9787234042553191
Warm optimizer lr: 0.00625
Val acc before epoch 92: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 93: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 94: 0.9787234042553191
Warm optimizer lr: 0.00625
Val acc before epoch 95: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 96: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 97: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 98: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 99: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 100: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 101: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 102: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 103: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 104: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 105: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 106: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 107: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 108: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 109: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 110: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 111: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 112: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 113: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 114: 0.9787234042553191
Warm optimizer lr: 0.003125
Val acc before epoch 115: 0.9787234042553191
Warm optimizer lr: 0.003125
Val acc before epoch 116: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 117: 0.9787234042553191
Warm optimizer lr: 0.003125
Val acc before epoch 118: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 119: 0.9787234042553191
Warm optimizer lr: 0.0015625
Val acc before epoch 120: 0.9680851063829787
Warm optimizer lr: 0.0015625
Val acc before epoch 121: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 122: 0.9680851063829787
Warm optimizer lr: 0.0015625
Val acc before epoch 123: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 124: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 125: 0.9893617021276596
Warm optimizer lr: 0.0015625
Val acc before epoch 126: 0.9680851063829787
Warm optimizer lr: 0.0015625
Val acc before epoch 127: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 128: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 129: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 130: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 131: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 132: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 133: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 134: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 135: 0.9680851063829787
Warm optimizer lr: 0.0015625
Val acc before epoch 136: 0.9680851063829787
Warm optimizer lr: 0.0015625
Val acc before epoch 137: 0.9787234042553191
Warm optimizer lr: 0.0015625
Val acc before epoch 138: 0.9680851063829787
Warm optimizer lr: 0.0015625
Val acc before epoch 139: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 140: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 141: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 142: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 143: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 144: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 145: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 146: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 147: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 148: 0.9787234042553191
Warm optimizer lr: 0.00078125
Val acc before epoch 149: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 150: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 151: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 152: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 153: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 154: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 155: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 156: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 157: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 158: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 159: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 160: 0.9787234042553191
Warm optimizer lr: 0.000390625
Val acc before epoch 161: 0.9680851063829787
Warm optimizer lr: 0.000390625
Val acc before epoch 162: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 163: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 164: 0.9787234042553191
Warm optimizer lr: 0.000390625
Val acc before epoch 165: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 166: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 167: 0.9680851063829787
Warm optimizer lr: 0.000390625
Val acc before epoch 168: 0.9787234042553191
Warm optimizer lr: 0.000390625
Val acc before epoch 169: 0.9680851063829787
Warm optimizer lr: 0.000390625
Val acc before epoch 170: 0.9361702127659575
Warm optimizer lr: 0.000390625
Val acc before epoch 171: 0.9787234042553191
Warm optimizer lr: 0.000390625
Val acc before epoch 172: 0.9680851063829787
Warm optimizer lr: 0.000390625
Val acc before epoch 173: 0.9361702127659575
Warm optimizer lr: 0.000390625
Val acc before epoch 174: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 175: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 176: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 177: 0.9680851063829787
Warm optimizer lr: 0.000390625
Val acc before epoch 178: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 179: 0.9787234042553191
Warm optimizer lr: 0.0001953125
Val acc before epoch 180: 0.9893617021276596
Warm optimizer lr: 0.0001953125
Val acc before epoch 181: 0.9574468085106383
Warm optimizer lr: 0.0001953125
Val acc before epoch 182: 0.9574468085106383
Warm optimizer lr: 0.0001953125
Val acc before epoch 183: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 184: 0.9574468085106383
Warm optimizer lr: 0.0001953125
Val acc before epoch 185: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 186: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 187: 0.9787234042553191
Warm optimizer lr: 0.0001953125
Val acc before epoch 188: 0.9574468085106383
Warm optimizer lr: 0.0001953125
Val acc before epoch 189: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 190: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 191: 0.9787234042553191
Warm optimizer lr: 0.0001953125
Val acc before epoch 192: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 193: 0.925531914893617
Warm optimizer lr: 0.0001953125
Val acc before epoch 194: 0.9468085106382979
Warm optimizer lr: 0.0001953125
Val acc before epoch 195: 0.9893617021276596
Warm optimizer lr: 0.0001953125
Val acc before epoch 196: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 197: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 198: 0.9787234042553191
Warm optimizer lr: 0.0001953125
Val acc before epoch 199: 0.9680851063829787
Warm optimizer lr: 9.765625e-05
Val acc before epoch 200: 0.9468085106382979
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.9176029962546816
Final val micro accuracy: 0.9468085106382979
Final test macro f1-score: 0.8683982683982683
Final test micro accuracy: 0.9042553191489362
Final validation:
	Cluster: 0.6717453002929688
	Separation: 0.49047084152698517
Final test:
	Cluster: 0.6476472318172455
	Separation: 0.48887406289577484
Saved Results

Attempting combination 10/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.5
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.05
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.3191489361702128
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 25: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 26: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 38: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 39: 0.9787234042553191
Warm optimizer lr: 0.0125
Val acc before epoch 40: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 41: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 43: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 44: 0.9787234042553191
Warm optimizer lr: 0.0125
Val acc before epoch 45: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 49: 0.9787234042553191
Warm optimizer lr: 0.0125
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 51: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 52: 0.9787234042553191
Warm optimizer lr: 0.0125
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.0125
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.0125
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.0125
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 57: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.00625
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.00625
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 69: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 70: 0.9361702127659575
Warm optimizer lr: 0.00625
Val acc before epoch 71: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 72: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 73: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 74: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 75: 0.9361702127659575
Warm optimizer lr: 0.00625
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 77: 0.925531914893617
Warm optimizer lr: 0.00625
Val acc before epoch 78: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 80: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.003125
Val acc before epoch 82: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 83: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 84: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 85: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 86: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 87: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 89: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 91: 0.9148936170212766
Warm optimizer lr: 0.003125
Val acc before epoch 92: 0.9893617021276596
Warm optimizer lr: 0.003125
Val acc before epoch 93: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 94: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 95: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 97: 0.9148936170212766
Warm optimizer lr: 0.003125
Val acc before epoch 98: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 99: 0.9787234042553191
Warm optimizer lr: 0.0015625
Val acc before epoch 100: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 101: 0.9680851063829787
Warm optimizer lr: 0.0015625
Val acc before epoch 102: 0.9787234042553191
Warm optimizer lr: 0.0015625
Val acc before epoch 103: 0.9680851063829787
Warm optimizer lr: 0.0015625
Val acc before epoch 104: 0.9787234042553191
Warm optimizer lr: 0.0015625
Val acc before epoch 105: 0.925531914893617
Warm optimizer lr: 0.0015625
Val acc before epoch 106: 0.9148936170212766
Warm optimizer lr: 0.0015625
Val acc before epoch 107: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 108: 0.9787234042553191
Warm optimizer lr: 0.0015625
Val acc before epoch 109: 0.9680851063829787
Warm optimizer lr: 0.0015625
Val acc before epoch 110: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 111: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 112: 0.9787234042553191
Warm optimizer lr: 0.0015625
Val acc before epoch 113: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 114: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 115: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 116: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 117: 0.925531914893617
Warm optimizer lr: 0.0015625
Val acc before epoch 118: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 119: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 120: 0.9148936170212766
Warm optimizer lr: 0.00078125
Val acc before epoch 121: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 122: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 123: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 124: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 125: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 126: 0.925531914893617
Warm optimizer lr: 0.00078125
Val acc before epoch 127: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 128: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 129: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 130: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 131: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 132: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 133: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 134: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 135: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 136: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 137: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 138: 0.9680851063829787
Warm optimizer lr: 0.00078125
Val acc before epoch 139: 0.9787234042553191
Warm optimizer lr: 0.000390625
Val acc before epoch 140: 0.9148936170212766
Warm optimizer lr: 0.000390625
Val acc before epoch 141: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 142: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 143: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 144: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 145: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 146: 0.9787234042553191
Warm optimizer lr: 0.000390625
Val acc before epoch 147: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 148: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 149: 0.9680851063829787
Warm optimizer lr: 0.000390625
Val acc before epoch 150: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 151: 0.9787234042553191
Warm optimizer lr: 0.000390625
Val acc before epoch 152: 0.9361702127659575
Warm optimizer lr: 0.000390625
Val acc before epoch 153: 0.925531914893617
Warm optimizer lr: 0.000390625
Val acc before epoch 154: 0.925531914893617
Warm optimizer lr: 0.000390625
Val acc before epoch 155: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 156: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 157: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 158: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 159: 0.9468085106382979
Warm optimizer lr: 0.0001953125
Val acc before epoch 160: 0.9574468085106383
Warm optimizer lr: 0.0001953125
Val acc before epoch 161: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 162: 0.9787234042553191
Warm optimizer lr: 0.0001953125
Val acc before epoch 163: 0.9468085106382979
Warm optimizer lr: 0.0001953125
Val acc before epoch 164: 0.9042553191489362
Warm optimizer lr: 0.0001953125
Val acc before epoch 165: 0.9468085106382979
Warm optimizer lr: 0.0001953125
Val acc before epoch 166: 0.9787234042553191
Warm optimizer lr: 0.0001953125
Val acc before epoch 167: 0.9893617021276596
Warm optimizer lr: 0.0001953125
Val acc before epoch 168: 0.9574468085106383
Warm optimizer lr: 0.0001953125
Val acc before epoch 169: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 170: 0.9574468085106383
Warm optimizer lr: 0.0001953125
Val acc before epoch 171: 0.9468085106382979
Warm optimizer lr: 0.0001953125
Val acc before epoch 172: 0.9680851063829787
Warm optimizer lr: 0.0001953125
Val acc before epoch 173: 0.9468085106382979
Warm optimizer lr: 0.0001953125
Val acc before epoch 174: 0.9468085106382979
Warm optimizer lr: 0.0001953125
Val acc before epoch 175: 0.9787234042553191
Warm optimizer lr: 0.0001953125
Val acc before epoch 176: 0.9574468085106383
Warm optimizer lr: 0.0001953125
Val acc before epoch 177: 0.9468085106382979
Warm optimizer lr: 0.0001953125
Val acc before epoch 178: 0.9787234042553191
Warm optimizer lr: 0.0001953125
Val acc before epoch 179: 0.9574468085106383
Warm optimizer lr: 9.765625e-05
Val acc before epoch 180: 0.9361702127659575
Warm optimizer lr: 9.765625e-05
Val acc before epoch 181: 0.9468085106382979
Warm optimizer lr: 9.765625e-05
Val acc before epoch 182: 0.9468085106382979
Warm optimizer lr: 9.765625e-05
Val acc before epoch 183: 0.9574468085106383
Warm optimizer lr: 9.765625e-05
Val acc before epoch 184: 0.9468085106382979
Warm optimizer lr: 9.765625e-05
Val acc before epoch 185: 0.9468085106382979
Warm optimizer lr: 9.765625e-05
Val acc before epoch 186: 0.9574468085106383
Warm optimizer lr: 9.765625e-05
Val acc before epoch 187: 0.9574468085106383
Warm optimizer lr: 9.765625e-05
Val acc before epoch 188: 0.9574468085106383
Warm optimizer lr: 9.765625e-05
Val acc before epoch 189: 0.9680851063829787
Warm optimizer lr: 9.765625e-05
Val acc before epoch 190: 0.9361702127659575
Warm optimizer lr: 9.765625e-05
Val acc before epoch 191: 0.9574468085106383
Warm optimizer lr: 9.765625e-05
Val acc before epoch 192: 0.9468085106382979
Warm optimizer lr: 9.765625e-05
Val acc before epoch 193: 0.9680851063829787
Warm optimizer lr: 9.765625e-05
Val acc before epoch 194: 0.9574468085106383
Warm optimizer lr: 9.765625e-05
Val acc before epoch 195: 0.925531914893617
Warm optimizer lr: 9.765625e-05
Val acc before epoch 196: 0.9574468085106383
Warm optimizer lr: 9.765625e-05
Val acc before epoch 197: 0.9361702127659575
Warm optimizer lr: 9.765625e-05
Val acc before epoch 198: 0.9680851063829787
Warm optimizer lr: 9.765625e-05
Val acc before epoch 199: 0.9361702127659575
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 200: 0.9468085106382979
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.9185185185185186
Final val micro accuracy: 0.9468085106382979
Final test macro f1-score: 0.8264957264957266
Final test micro accuracy: 0.8936170212765957
Final validation:
	Cluster: 0.664756715297699
	Separation: 0.4835034906864166
Final test:
	Cluster: 0.6301423013210297
	Separation: 0.4798120707273483
Saved Results

Attempting combination 11/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.5
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.01
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.01
Val acc before epoch 1: 0.031914893617021274
Warm optimizer lr: 0.01
Val acc before epoch 2: 0.05319148936170213
Warm optimizer lr: 0.01
Val acc before epoch 3: 0.2765957446808511
Warm optimizer lr: 0.01
Val acc before epoch 4: 0.35106382978723405
Warm optimizer lr: 0.01
Val acc before epoch 5: 0.5531914893617021
Warm optimizer lr: 0.01
Val acc before epoch 6: 0.6276595744680851
Warm optimizer lr: 0.01
Val acc before epoch 7: 0.7553191489361702
Warm optimizer lr: 0.01
Val acc before epoch 8: 0.8085106382978723
Warm optimizer lr: 0.01
Val acc before epoch 9: 0.7659574468085106
Warm optimizer lr: 0.01
Val acc before epoch 10: 0.8085106382978723
Warm optimizer lr: 0.01
Val acc before epoch 11: 0.8297872340425532
Warm optimizer lr: 0.01
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.01
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.01
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.01
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.01
Val acc before epoch 16: 0.8723404255319149
Warm optimizer lr: 0.01
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.01
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.01
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.005
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.005
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.005
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.005
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.005
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.005
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.005
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.005
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.005
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.005
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.005
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.005
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.005
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.005
Val acc before epoch 33: 0.9680851063829787
Warm optimizer lr: 0.005
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.005
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.005
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.005
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.005
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.005
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.0025
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.0025
Val acc before epoch 41: 0.925531914893617
Warm optimizer lr: 0.0025
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.0025
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.0025
Val acc before epoch 44: 0.9574468085106383
Warm optimizer lr: 0.0025
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.0025
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.0025
Val acc before epoch 47: 0.9574468085106383
Warm optimizer lr: 0.0025
Val acc before epoch 48: 0.9680851063829787
Warm optimizer lr: 0.0025
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.0025
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.0025
Val acc before epoch 51: 0.9574468085106383
Warm optimizer lr: 0.0025
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.0025
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.0025
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.0025
Val acc before epoch 55: 0.9680851063829787
Warm optimizer lr: 0.0025
Val acc before epoch 56: 0.9148936170212766
Warm optimizer lr: 0.0025
Val acc before epoch 57: 0.9680851063829787
Warm optimizer lr: 0.0025
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.0025
Val acc before epoch 59: 0.9787234042553191
Warm optimizer lr: 0.00125
Val acc before epoch 60: 0.9787234042553191
Warm optimizer lr: 0.00125
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.00125
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.00125
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.00125
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.00125
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.00125
Val acc before epoch 66: 0.9680851063829787
Warm optimizer lr: 0.00125
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.00125
Val acc before epoch 68: 0.9361702127659575
Warm optimizer lr: 0.00125
Val acc before epoch 69: 0.9680851063829787
Warm optimizer lr: 0.00125
Val acc before epoch 70: 0.9468085106382979
Warm optimizer lr: 0.00125
Val acc before epoch 71: 0.9468085106382979
Warm optimizer lr: 0.00125
Val acc before epoch 72: 0.9574468085106383
Warm optimizer lr: 0.00125
Val acc before epoch 73: 0.9574468085106383
Warm optimizer lr: 0.00125
Val acc before epoch 74: 0.9574468085106383
Warm optimizer lr: 0.00125
Val acc before epoch 75: 0.9680851063829787
Warm optimizer lr: 0.00125
Val acc before epoch 76: 0.9361702127659575
Warm optimizer lr: 0.00125
Val acc before epoch 77: 0.9574468085106383
Warm optimizer lr: 0.00125
Val acc before epoch 78: 0.9574468085106383
Warm optimizer lr: 0.00125
Val acc before epoch 79: 0.9680851063829787
Warm optimizer lr: 0.000625
Val acc before epoch 80: 0.9574468085106383
Warm optimizer lr: 0.000625
Val acc before epoch 81: 0.9468085106382979
Warm optimizer lr: 0.000625
Val acc before epoch 82: 0.9574468085106383
Warm optimizer lr: 0.000625
Val acc before epoch 83: 0.9787234042553191
Warm optimizer lr: 0.000625
Val acc before epoch 84: 0.9574468085106383
Warm optimizer lr: 0.000625
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.000625
Val acc before epoch 86: 0.9574468085106383
Warm optimizer lr: 0.000625
Val acc before epoch 87: 0.9680851063829787
Warm optimizer lr: 0.000625
Val acc before epoch 88: 0.9787234042553191
Warm optimizer lr: 0.000625
Val acc before epoch 89: 0.9680851063829787
Warm optimizer lr: 0.000625
Val acc before epoch 90: 0.9680851063829787
Warm optimizer lr: 0.000625
Val acc before epoch 91: 0.9574468085106383
Warm optimizer lr: 0.000625
Val acc before epoch 92: 0.9574468085106383
Warm optimizer lr: 0.000625
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 0.000625
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 0.000625
Val acc before epoch 95: 0.9680851063829787
Warm optimizer lr: 0.000625
Val acc before epoch 96: 0.9787234042553191
Warm optimizer lr: 0.000625
Val acc before epoch 97: 0.9468085106382979
Warm optimizer lr: 0.000625
Val acc before epoch 98: 0.9574468085106383
Warm optimizer lr: 0.000625
Val acc before epoch 99: 0.9574468085106383
Warm optimizer lr: 0.0003125
Val acc before epoch 100: 0.9680851063829787
Warm optimizer lr: 0.0003125
Val acc before epoch 101: 0.9574468085106383
Warm optimizer lr: 0.0003125
Val acc before epoch 102: 0.9574468085106383
Warm optimizer lr: 0.0003125
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.0003125
Val acc before epoch 104: 0.9680851063829787
Warm optimizer lr: 0.0003125
Val acc before epoch 105: 0.9680851063829787
Warm optimizer lr: 0.0003125
Val acc before epoch 106: 0.9893617021276596
Warm optimizer lr: 0.0003125
Val acc before epoch 107: 0.9574468085106383
Warm optimizer lr: 0.0003125
Val acc before epoch 108: 0.9680851063829787
Warm optimizer lr: 0.0003125
Val acc before epoch 109: 0.9574468085106383
Warm optimizer lr: 0.0003125
Val acc before epoch 110: 0.9893617021276596
Warm optimizer lr: 0.0003125
Val acc before epoch 111: 0.9574468085106383
Warm optimizer lr: 0.0003125
Val acc before epoch 112: 0.9787234042553191
Warm optimizer lr: 0.0003125
Val acc before epoch 113: 0.9361702127659575
Warm optimizer lr: 0.0003125
Val acc before epoch 114: 0.9468085106382979
Warm optimizer lr: 0.0003125
Val acc before epoch 115: 0.9361702127659575
Warm optimizer lr: 0.0003125
Val acc before epoch 116: 0.9787234042553191
Warm optimizer lr: 0.0003125
Val acc before epoch 117: 0.9468085106382979
Warm optimizer lr: 0.0003125
Val acc before epoch 118: 0.9468085106382979
Warm optimizer lr: 0.0003125
Val acc before epoch 119: 0.9787234042553191
Warm optimizer lr: 0.00015625
Val acc before epoch 120: 0.9574468085106383
Warm optimizer lr: 0.00015625
Val acc before epoch 121: 0.9574468085106383
Warm optimizer lr: 0.00015625
Val acc before epoch 122: 0.9680851063829787
Warm optimizer lr: 0.00015625
Val acc before epoch 123: 0.9148936170212766
Warm optimizer lr: 0.00015625
Val acc before epoch 124: 0.9361702127659575
Warm optimizer lr: 0.00015625
Val acc before epoch 125: 0.9468085106382979
Warm optimizer lr: 0.00015625
Val acc before epoch 126: 0.925531914893617
Warm optimizer lr: 0.00015625
Val acc before epoch 127: 0.9468085106382979
Warm optimizer lr: 0.00015625
Val acc before epoch 128: 0.9680851063829787
Warm optimizer lr: 0.00015625
Val acc before epoch 129: 0.9680851063829787
Warm optimizer lr: 0.00015625
Val acc before epoch 130: 0.9893617021276596
Warm optimizer lr: 0.00015625
Val acc before epoch 131: 0.9361702127659575
Warm optimizer lr: 0.00015625
Val acc before epoch 132: 0.9468085106382979
Warm optimizer lr: 0.00015625
Val acc before epoch 133: 0.9680851063829787
Warm optimizer lr: 0.00015625
Val acc before epoch 134: 0.9574468085106383
Warm optimizer lr: 0.00015625
Val acc before epoch 135: 0.9468085106382979
Warm optimizer lr: 0.00015625
Val acc before epoch 136: 0.9361702127659575
Warm optimizer lr: 0.00015625
Val acc before epoch 137: 0.9468085106382979
Warm optimizer lr: 0.00015625
Val acc before epoch 138: 0.9468085106382979
Warm optimizer lr: 0.00015625
Val acc before epoch 139: 0.9680851063829787
Warm optimizer lr: 7.8125e-05
Val acc before epoch 140: 0.9680851063829787
Warm optimizer lr: 7.8125e-05
Val acc before epoch 141: 0.9680851063829787
Warm optimizer lr: 7.8125e-05
Val acc before epoch 142: 0.925531914893617
Warm optimizer lr: 7.8125e-05
Val acc before epoch 143: 0.9574468085106383
Warm optimizer lr: 7.8125e-05
Val acc before epoch 144: 0.9680851063829787
Warm optimizer lr: 7.8125e-05
Val acc before epoch 145: 0.9680851063829787
Warm optimizer lr: 7.8125e-05
Val acc before epoch 146: 0.9574468085106383
Warm optimizer lr: 7.8125e-05
Val acc before epoch 147: 0.9574468085106383
Warm optimizer lr: 7.8125e-05
Val acc before epoch 148: 0.925531914893617
Warm optimizer lr: 7.8125e-05
Val acc before epoch 149: 0.925531914893617
Warm optimizer lr: 7.8125e-05
Val acc before epoch 150: 0.9574468085106383
Warm optimizer lr: 7.8125e-05
Val acc before epoch 151: 0.9468085106382979
Warm optimizer lr: 7.8125e-05
Val acc before epoch 152: 0.9468085106382979
Warm optimizer lr: 7.8125e-05
Val acc before epoch 153: 0.9787234042553191
Warm optimizer lr: 7.8125e-05
Val acc before epoch 154: 0.9680851063829787
Warm optimizer lr: 7.8125e-05
Val acc before epoch 155: 0.9574468085106383
Warm optimizer lr: 7.8125e-05
Val acc before epoch 156: 0.9680851063829787
Warm optimizer lr: 7.8125e-05
Val acc before epoch 157: 0.9574468085106383
Warm optimizer lr: 7.8125e-05
Val acc before epoch 158: 0.9468085106382979
Warm optimizer lr: 7.8125e-05
Val acc before epoch 159: 0.9574468085106383
Warm optimizer lr: 3.90625e-05
Val acc before epoch 160: 0.925531914893617
Warm optimizer lr: 3.90625e-05
Val acc before epoch 161: 0.9574468085106383
Warm optimizer lr: 3.90625e-05
Val acc before epoch 162: 0.9574468085106383
Warm optimizer lr: 3.90625e-05
Val acc before epoch 163: 0.9574468085106383
Warm optimizer lr: 3.90625e-05
Val acc before epoch 164: 0.9680851063829787
Warm optimizer lr: 3.90625e-05
Val acc before epoch 165: 0.925531914893617
Warm optimizer lr: 3.90625e-05
Val acc before epoch 166: 0.9893617021276596
Warm optimizer lr: 3.90625e-05
Val acc before epoch 167: 0.9361702127659575
Warm optimizer lr: 3.90625e-05
Val acc before epoch 168: 0.9361702127659575
Warm optimizer lr: 3.90625e-05
Val acc before epoch 169: 0.9787234042553191
Warm optimizer lr: 3.90625e-05
Val acc before epoch 170: 0.9574468085106383
Warm optimizer lr: 3.90625e-05
Val acc before epoch 171: 0.9680851063829787
Warm optimizer lr: 3.90625e-05
Val acc before epoch 172: 0.9468085106382979
Warm optimizer lr: 3.90625e-05
Val acc before epoch 173: 0.9468085106382979
Warm optimizer lr: 3.90625e-05
Val acc before epoch 174: 0.9574468085106383
Warm optimizer lr: 3.90625e-05
Val acc before epoch 175: 0.9680851063829787
Warm optimizer lr: 3.90625e-05
Val acc before epoch 176: 0.9787234042553191
Warm optimizer lr: 3.90625e-05
Val acc before epoch 177: 0.9468085106382979
Warm optimizer lr: 3.90625e-05
Val acc before epoch 178: 0.9468085106382979
Warm optimizer lr: 3.90625e-05
Val acc before epoch 179: 0.9680851063829787
Warm optimizer lr: 1.953125e-05
Val acc before epoch 180: 0.9787234042553191
Warm optimizer lr: 1.953125e-05
Val acc before epoch 181: 0.9787234042553191
Warm optimizer lr: 1.953125e-05
Val acc before epoch 182: 0.9574468085106383
Warm optimizer lr: 1.953125e-05
Val acc before epoch 183: 0.925531914893617
Warm optimizer lr: 1.953125e-05
Val acc before epoch 184: 0.9680851063829787
Warm optimizer lr: 1.953125e-05
Val acc before epoch 185: 0.9361702127659575
Warm optimizer lr: 1.953125e-05
Val acc before epoch 186: 0.9574468085106383
Warm optimizer lr: 1.953125e-05
Val acc before epoch 187: 0.9361702127659575
Warm optimizer lr: 1.953125e-05
Val acc before epoch 188: 0.9574468085106383
Warm optimizer lr: 1.953125e-05
Val acc before epoch 189: 0.9361702127659575
Warm optimizer lr: 1.953125e-05
Val acc before epoch 190: 0.9361702127659575
Warm optimizer lr: 1.953125e-05
Val acc before epoch 191: 0.9787234042553191
Warm optimizer lr: 1.953125e-05
Val acc before epoch 192: 0.9468085106382979
Warm optimizer lr: 1.953125e-05
Val acc before epoch 193: 0.9361702127659575
Warm optimizer lr: 1.953125e-05
Val acc before epoch 194: 0.9574468085106383
Warm optimizer lr: 1.953125e-05
Val acc before epoch 195: 0.9680851063829787
Warm optimizer lr: 1.953125e-05
Val acc before epoch 196: 0.9468085106382979
Warm optimizer lr: 1.953125e-05
Val acc before epoch 197: 0.9468085106382979
Warm optimizer lr: 1.953125e-05
Val acc before epoch 198: 0.9361702127659575
Warm optimizer lr: 1.953125e-05
Val acc before epoch 199: 0.925531914893617
Warm optimizer lr: 9.765625e-06
Val acc before epoch 200: 0.9680851063829787
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.9545454545454546
Final val micro accuracy: 0.9680851063829787
Final test macro f1-score: 0.8818181818181817
Final test micro accuracy: 0.9148936170212766
Final validation:
	Cluster: 0.2553365230560303
	Separation: 0.18056385219097137
Final test:
	Cluster: 0.2423090785741806
	Separation: 0.18258102238178253
Saved Results

Attempting combination 12/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.5
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.005
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.005
Val acc before epoch 1: 0.0
Warm optimizer lr: 0.005
Val acc before epoch 2: 0.02127659574468085
Warm optimizer lr: 0.005
Val acc before epoch 3: 0.02127659574468085
Warm optimizer lr: 0.005
Val acc before epoch 4: 0.06382978723404255
Warm optimizer lr: 0.005
Val acc before epoch 5: 0.1595744680851064
Warm optimizer lr: 0.005
Val acc before epoch 6: 0.20212765957446807
Warm optimizer lr: 0.005
Val acc before epoch 7: 0.2872340425531915
Warm optimizer lr: 0.005
Val acc before epoch 8: 0.3191489361702128
Warm optimizer lr: 0.005
Val acc before epoch 9: 0.4574468085106383
Warm optimizer lr: 0.005
Val acc before epoch 10: 0.40425531914893614
Warm optimizer lr: 0.005
Val acc before epoch 11: 0.4787234042553192
Warm optimizer lr: 0.005
Val acc before epoch 12: 0.5957446808510638
Warm optimizer lr: 0.005
Val acc before epoch 13: 0.6170212765957447
Warm optimizer lr: 0.005
Val acc before epoch 14: 0.6702127659574468
Warm optimizer lr: 0.005
Val acc before epoch 15: 0.6914893617021277
Warm optimizer lr: 0.005
Val acc before epoch 16: 0.7021276595744681
Warm optimizer lr: 0.005
Val acc before epoch 17: 0.7553191489361702
Warm optimizer lr: 0.005
Val acc before epoch 18: 0.7872340425531915
Warm optimizer lr: 0.005
Val acc before epoch 19: 0.7659574468085106
Warm optimizer lr: 0.0025
Val acc before epoch 20: 0.776595744680851
Warm optimizer lr: 0.0025
Val acc before epoch 21: 0.7978723404255319
Warm optimizer lr: 0.0025
Val acc before epoch 22: 0.7340425531914894
Warm optimizer lr: 0.0025
Val acc before epoch 23: 0.7978723404255319
Warm optimizer lr: 0.0025
Val acc before epoch 24: 0.8085106382978723
Warm optimizer lr: 0.0025
Val acc before epoch 25: 0.8617021276595744
Warm optimizer lr: 0.0025
Val acc before epoch 26: 0.851063829787234
Warm optimizer lr: 0.0025
Val acc before epoch 27: 0.776595744680851
Warm optimizer lr: 0.0025
Val acc before epoch 28: 0.8191489361702128
Warm optimizer lr: 0.0025
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.0025
Val acc before epoch 30: 0.851063829787234
Warm optimizer lr: 0.0025
Val acc before epoch 31: 0.8723404255319149
Warm optimizer lr: 0.0025
Val acc before epoch 32: 0.8297872340425532
Warm optimizer lr: 0.0025
Val acc before epoch 33: 0.851063829787234
Warm optimizer lr: 0.0025
Val acc before epoch 34: 0.851063829787234
Warm optimizer lr: 0.0025
Val acc before epoch 35: 0.8829787234042553
Warm optimizer lr: 0.0025
Val acc before epoch 36: 0.9042553191489362
Warm optimizer lr: 0.0025
Val acc before epoch 37: 0.8723404255319149
Warm optimizer lr: 0.0025
Val acc before epoch 38: 0.8829787234042553
Warm optimizer lr: 0.0025
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.00125
Val acc before epoch 40: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 41: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 42: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 43: 0.8829787234042553
Warm optimizer lr: 0.00125
Val acc before epoch 44: 0.8829787234042553
Warm optimizer lr: 0.00125
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.00125
Val acc before epoch 46: 0.8936170212765957
Warm optimizer lr: 0.00125
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.00125
Val acc before epoch 48: 0.8829787234042553
Warm optimizer lr: 0.00125
Val acc before epoch 49: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 50: 0.8723404255319149
Warm optimizer lr: 0.00125
Val acc before epoch 51: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 52: 0.8829787234042553
Warm optimizer lr: 0.00125
Val acc before epoch 53: 0.8723404255319149
Warm optimizer lr: 0.00125
Val acc before epoch 54: 0.925531914893617
Warm optimizer lr: 0.00125
Val acc before epoch 55: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 56: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 57: 0.8723404255319149
Warm optimizer lr: 0.00125
Val acc before epoch 58: 0.8617021276595744
Warm optimizer lr: 0.00125
Val acc before epoch 59: 0.8723404255319149
Warm optimizer lr: 0.000625
Val acc before epoch 60: 0.9148936170212766
Warm optimizer lr: 0.000625
Val acc before epoch 61: 0.851063829787234
Warm optimizer lr: 0.000625
Val acc before epoch 62: 0.8829787234042553
Warm optimizer lr: 0.000625
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.000625
Val acc before epoch 64: 0.9042553191489362
Warm optimizer lr: 0.000625
Val acc before epoch 65: 0.9042553191489362
Warm optimizer lr: 0.000625
Val acc before epoch 66: 0.8829787234042553
Warm optimizer lr: 0.000625
Val acc before epoch 67: 0.9042553191489362
Warm optimizer lr: 0.000625
Val acc before epoch 68: 0.8936170212765957
Warm optimizer lr: 0.000625
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.000625
Val acc before epoch 70: 0.9042553191489362
Warm optimizer lr: 0.000625
Val acc before epoch 71: 0.925531914893617
Warm optimizer lr: 0.000625
Val acc before epoch 72: 0.8936170212765957
Warm optimizer lr: 0.000625
Val acc before epoch 73: 0.8936170212765957
Warm optimizer lr: 0.000625
Val acc before epoch 74: 0.8936170212765957
Warm optimizer lr: 0.000625
Val acc before epoch 75: 0.9361702127659575
Warm optimizer lr: 0.000625
Val acc before epoch 76: 0.8723404255319149
Warm optimizer lr: 0.000625
Val acc before epoch 77: 0.9042553191489362
Warm optimizer lr: 0.000625
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 0.000625
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.0003125
Val acc before epoch 80: 0.9148936170212766
Warm optimizer lr: 0.0003125
Val acc before epoch 81: 0.9042553191489362
Warm optimizer lr: 0.0003125
Val acc before epoch 82: 0.9468085106382979
Warm optimizer lr: 0.0003125
Val acc before epoch 83: 0.9148936170212766
Warm optimizer lr: 0.0003125
Val acc before epoch 84: 0.9468085106382979
Warm optimizer lr: 0.0003125
Val acc before epoch 85: 0.9148936170212766
Warm optimizer lr: 0.0003125
Val acc before epoch 86: 0.925531914893617
Warm optimizer lr: 0.0003125
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 0.0003125
Val acc before epoch 88: 0.9468085106382979
Warm optimizer lr: 0.0003125
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 0.0003125
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.0003125
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.0003125
Val acc before epoch 92: 0.8723404255319149
Warm optimizer lr: 0.0003125
Val acc before epoch 93: 0.9042553191489362
Warm optimizer lr: 0.0003125
Val acc before epoch 94: 0.8829787234042553
Warm optimizer lr: 0.0003125
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 0.0003125
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.0003125
Val acc before epoch 97: 0.925531914893617
Warm optimizer lr: 0.0003125
Val acc before epoch 98: 0.9148936170212766
Warm optimizer lr: 0.0003125
Val acc before epoch 99: 0.9148936170212766
Warm optimizer lr: 0.00015625
Val acc before epoch 100: 0.9042553191489362
Warm optimizer lr: 0.00015625
Val acc before epoch 101: 0.8936170212765957
Warm optimizer lr: 0.00015625
Val acc before epoch 102: 0.925531914893617
Warm optimizer lr: 0.00015625
Val acc before epoch 103: 0.8936170212765957
Warm optimizer lr: 0.00015625
Val acc before epoch 104: 0.9148936170212766
Warm optimizer lr: 0.00015625
Val acc before epoch 105: 0.9148936170212766
Warm optimizer lr: 0.00015625
Val acc before epoch 106: 0.9042553191489362
Warm optimizer lr: 0.00015625
Val acc before epoch 107: 0.9680851063829787
Warm optimizer lr: 0.00015625
Val acc before epoch 108: 0.9361702127659575
Warm optimizer lr: 0.00015625
Val acc before epoch 109: 0.9361702127659575
Warm optimizer lr: 0.00015625
Val acc before epoch 110: 0.9468085106382979
Warm optimizer lr: 0.00015625
Val acc before epoch 111: 0.9574468085106383
Warm optimizer lr: 0.00015625
Val acc before epoch 112: 0.851063829787234
Warm optimizer lr: 0.00015625
Val acc before epoch 113: 0.9148936170212766
Warm optimizer lr: 0.00015625
Val acc before epoch 114: 0.8723404255319149
Warm optimizer lr: 0.00015625
Val acc before epoch 115: 0.9042553191489362
Warm optimizer lr: 0.00015625
Val acc before epoch 116: 0.8936170212765957
Warm optimizer lr: 0.00015625
Val acc before epoch 117: 0.9148936170212766
Warm optimizer lr: 0.00015625
Val acc before epoch 118: 0.9361702127659575
Warm optimizer lr: 0.00015625
Val acc before epoch 119: 0.9361702127659575
Warm optimizer lr: 7.8125e-05
Val acc before epoch 120: 0.9148936170212766
Warm optimizer lr: 7.8125e-05
Val acc before epoch 121: 0.9468085106382979
Warm optimizer lr: 7.8125e-05
Val acc before epoch 122: 0.925531914893617
Warm optimizer lr: 7.8125e-05
Val acc before epoch 123: 0.9680851063829787
Warm optimizer lr: 7.8125e-05
Val acc before epoch 124: 0.9361702127659575
Warm optimizer lr: 7.8125e-05
Val acc before epoch 125: 0.8936170212765957
Warm optimizer lr: 7.8125e-05
Val acc before epoch 126: 0.9361702127659575
Warm optimizer lr: 7.8125e-05
Val acc before epoch 127: 0.925531914893617
Warm optimizer lr: 7.8125e-05
Val acc before epoch 128: 0.9468085106382979
Warm optimizer lr: 7.8125e-05
Val acc before epoch 129: 0.9361702127659575
Warm optimizer lr: 7.8125e-05
Val acc before epoch 130: 0.9468085106382979
Warm optimizer lr: 7.8125e-05
Val acc before epoch 131: 0.9574468085106383
Warm optimizer lr: 7.8125e-05
Val acc before epoch 132: 0.9148936170212766
Warm optimizer lr: 7.8125e-05
Val acc before epoch 133: 0.9148936170212766
Warm optimizer lr: 7.8125e-05
Val acc before epoch 134: 0.9148936170212766
Warm optimizer lr: 7.8125e-05
Val acc before epoch 135: 0.8829787234042553
Warm optimizer lr: 7.8125e-05
Val acc before epoch 136: 0.9148936170212766
Warm optimizer lr: 7.8125e-05
Val acc before epoch 137: 0.9148936170212766
Warm optimizer lr: 7.8125e-05
Val acc before epoch 138: 0.9148936170212766
Warm optimizer lr: 7.8125e-05
Val acc before epoch 139: 0.8829787234042553
Warm optimizer lr: 3.90625e-05
Val acc before epoch 140: 0.8936170212765957
Warm optimizer lr: 3.90625e-05
Val acc before epoch 141: 0.8936170212765957
Warm optimizer lr: 3.90625e-05
Val acc before epoch 142: 0.9042553191489362
Warm optimizer lr: 3.90625e-05
Val acc before epoch 143: 0.9468085106382979
Warm optimizer lr: 3.90625e-05
Val acc before epoch 144: 0.9574468085106383
Warm optimizer lr: 3.90625e-05
Val acc before epoch 145: 0.9148936170212766
Warm optimizer lr: 3.90625e-05
Val acc before epoch 146: 0.9361702127659575
Warm optimizer lr: 3.90625e-05
Val acc before epoch 147: 0.9468085106382979
Warm optimizer lr: 3.90625e-05
Val acc before epoch 148: 0.925531914893617
Warm optimizer lr: 3.90625e-05
Val acc before epoch 149: 0.925531914893617
Warm optimizer lr: 3.90625e-05
Val acc before epoch 150: 0.9148936170212766
Warm optimizer lr: 3.90625e-05
Val acc before epoch 151: 0.9148936170212766
Warm optimizer lr: 3.90625e-05
Val acc before epoch 152: 0.9042553191489362
Warm optimizer lr: 3.90625e-05
Val acc before epoch 153: 0.9680851063829787
Warm optimizer lr: 3.90625e-05
Val acc before epoch 154: 0.925531914893617
Warm optimizer lr: 3.90625e-05
Val acc before epoch 155: 0.9361702127659575
Warm optimizer lr: 3.90625e-05
Val acc before epoch 156: 0.9361702127659575
Warm optimizer lr: 3.90625e-05
Val acc before epoch 157: 0.8723404255319149
Warm optimizer lr: 3.90625e-05
Val acc before epoch 158: 0.8936170212765957
Warm optimizer lr: 3.90625e-05
Val acc before epoch 159: 0.9361702127659575
Warm optimizer lr: 1.953125e-05
Val acc before epoch 160: 0.8936170212765957
Warm optimizer lr: 1.953125e-05
Val acc before epoch 161: 0.9042553191489362
Warm optimizer lr: 1.953125e-05
Val acc before epoch 162: 0.9361702127659575
Warm optimizer lr: 1.953125e-05
Val acc before epoch 163: 0.925531914893617
Warm optimizer lr: 1.953125e-05
Val acc before epoch 164: 0.9148936170212766
Warm optimizer lr: 1.953125e-05
Val acc before epoch 165: 0.9042553191489362
Warm optimizer lr: 1.953125e-05
Val acc before epoch 166: 0.9042553191489362
Warm optimizer lr: 1.953125e-05
Val acc before epoch 167: 0.9148936170212766
Warm optimizer lr: 1.953125e-05
Val acc before epoch 168: 0.9468085106382979
Warm optimizer lr: 1.953125e-05
Val acc before epoch 169: 0.9148936170212766
Warm optimizer lr: 1.953125e-05
Val acc before epoch 170: 0.9468085106382979
Warm optimizer lr: 1.953125e-05
Val acc before epoch 171: 0.9468085106382979
Warm optimizer lr: 1.953125e-05
Val acc before epoch 172: 0.9468085106382979
Warm optimizer lr: 1.953125e-05
Val acc before epoch 173: 0.925531914893617
Warm optimizer lr: 1.953125e-05
Val acc before epoch 174: 0.9148936170212766
Warm optimizer lr: 1.953125e-05
Val acc before epoch 175: 0.9042553191489362
Warm optimizer lr: 1.953125e-05
Val acc before epoch 176: 0.9361702127659575
Warm optimizer lr: 1.953125e-05
Val acc before epoch 177: 0.9042553191489362
Warm optimizer lr: 1.953125e-05
Val acc before epoch 178: 0.9361702127659575
Warm optimizer lr: 1.953125e-05
Val acc before epoch 179: 0.9148936170212766
Warm optimizer lr: 9.765625e-06
Val acc before epoch 180: 0.9468085106382979
Warm optimizer lr: 9.765625e-06
Val acc before epoch 181: 0.9361702127659575
Warm optimizer lr: 9.765625e-06
Val acc before epoch 182: 0.9574468085106383
Warm optimizer lr: 9.765625e-06
Val acc before epoch 183: 0.9361702127659575
Warm optimizer lr: 9.765625e-06
Val acc before epoch 184: 0.9042553191489362
Warm optimizer lr: 9.765625e-06
Val acc before epoch 185: 0.8829787234042553
Warm optimizer lr: 9.765625e-06
Val acc before epoch 186: 0.925531914893617
Warm optimizer lr: 9.765625e-06
Val acc before epoch 187: 0.9148936170212766
Warm optimizer lr: 9.765625e-06
Val acc before epoch 188: 0.9468085106382979
Warm optimizer lr: 9.765625e-06
Val acc before epoch 189: 0.9148936170212766
Warm optimizer lr: 9.765625e-06
Val acc before epoch 190: 0.925531914893617
Warm optimizer lr: 9.765625e-06
Val acc before epoch 191: 0.9468085106382979
Warm optimizer lr: 9.765625e-06
Val acc before epoch 192: 0.925531914893617
Warm optimizer lr: 9.765625e-06
Val acc before epoch 193: 0.9468085106382979
Warm optimizer lr: 9.765625e-06
Val acc before epoch 194: 0.9042553191489362
Warm optimizer lr: 9.765625e-06
Val acc before epoch 195: 0.9468085106382979
Warm optimizer lr: 9.765625e-06
Val acc before epoch 196: 0.8936170212765957
Warm optimizer lr: 9.765625e-06
Val acc before epoch 197: 0.9148936170212766
Warm optimizer lr: 9.765625e-06
Val acc before epoch 198: 0.9361702127659575
Warm optimizer lr: 9.765625e-06
Val acc before epoch 199: 0.9148936170212766
Warm optimizer lr: 4.8828125e-06
Val acc before epoch 200: 0.9148936170212766
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.8901098901098901
Final val micro accuracy: 0.9361702127659575
Final test macro f1-score: 0.780168776371308
Final test micro accuracy: 0.851063829787234
Final validation:
	Cluster: 0.11470907926559448
	Separation: 0.08665601909160614
Final test:
	Cluster: 0.10868135839700699
	Separation: 0.08617765456438065
Saved Results

Attempting combination 13/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.5
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.001
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.001
Val acc before epoch 1: 0.0
Warm optimizer lr: 0.001
Val acc before epoch 2: 0.0
Warm optimizer lr: 0.001
Val acc before epoch 3: 0.010638297872340425
Warm optimizer lr: 0.001
Val acc before epoch 4: 0.010638297872340425
Warm optimizer lr: 0.001
Val acc before epoch 5: 0.010638297872340425
Warm optimizer lr: 0.001
Val acc before epoch 6: 0.0
Warm optimizer lr: 0.001
Val acc before epoch 7: 0.010638297872340425
Warm optimizer lr: 0.001
Val acc before epoch 8: 0.010638297872340425
Warm optimizer lr: 0.001
Val acc before epoch 9: 0.010638297872340425
Warm optimizer lr: 0.001
Val acc before epoch 10: 0.06382978723404255
Warm optimizer lr: 0.001
Val acc before epoch 11: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 12: 0.0425531914893617
Warm optimizer lr: 0.001
Val acc before epoch 13: 0.02127659574468085
Warm optimizer lr: 0.001
Val acc before epoch 14: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 15: 0.0851063829787234
Warm optimizer lr: 0.001
Val acc before epoch 16: 0.031914893617021274
Warm optimizer lr: 0.001
Val acc before epoch 17: 0.07446808510638298
Warm optimizer lr: 0.001
Val acc before epoch 18: 0.0
Warm optimizer lr: 0.001
Val acc before epoch 19: 0.0425531914893617
Warm optimizer lr: 0.0005
Val acc before epoch 20: 0.06382978723404255
Warm optimizer lr: 0.0005
Val acc before epoch 21: 0.06382978723404255
Warm optimizer lr: 0.0005
Val acc before epoch 22: 0.11702127659574468
Warm optimizer lr: 0.0005
Val acc before epoch 23: 0.10638297872340426
Warm optimizer lr: 0.0005
Val acc before epoch 24: 0.06382978723404255
Warm optimizer lr: 0.0005
Val acc before epoch 25: 0.09574468085106383
Warm optimizer lr: 0.0005
Val acc before epoch 26: 0.10638297872340426
Warm optimizer lr: 0.0005
Val acc before epoch 27: 0.06382978723404255
Warm optimizer lr: 0.0005
Val acc before epoch 28: 0.07446808510638298
Warm optimizer lr: 0.0005
Val acc before epoch 29: 0.07446808510638298
Warm optimizer lr: 0.0005
Val acc before epoch 30: 0.0851063829787234
Warm optimizer lr: 0.0005
Val acc before epoch 31: 0.1276595744680851
Warm optimizer lr: 0.0005
Val acc before epoch 32: 0.11702127659574468
Warm optimizer lr: 0.0005
Val acc before epoch 33: 0.13829787234042554
Warm optimizer lr: 0.0005
Val acc before epoch 34: 0.23404255319148937
Warm optimizer lr: 0.0005
Val acc before epoch 35: 0.13829787234042554
Warm optimizer lr: 0.0005
Val acc before epoch 36: 0.1595744680851064
Warm optimizer lr: 0.0005
Val acc before epoch 37: 0.1276595744680851
Warm optimizer lr: 0.0005
Val acc before epoch 38: 0.19148936170212766
Warm optimizer lr: 0.0005
Val acc before epoch 39: 0.1702127659574468
Warm optimizer lr: 0.00025
Val acc before epoch 40: 0.1702127659574468
Warm optimizer lr: 0.00025
Val acc before epoch 41: 0.18085106382978725
Warm optimizer lr: 0.00025
Val acc before epoch 42: 0.09574468085106383
Warm optimizer lr: 0.00025
Val acc before epoch 43: 0.2127659574468085
Warm optimizer lr: 0.00025
Val acc before epoch 44: 0.2127659574468085
Warm optimizer lr: 0.00025
Val acc before epoch 45: 0.19148936170212766
Warm optimizer lr: 0.00025
Val acc before epoch 46: 0.19148936170212766
Warm optimizer lr: 0.00025
Val acc before epoch 47: 0.18085106382978725
Warm optimizer lr: 0.00025
Val acc before epoch 48: 0.18085106382978725
Warm optimizer lr: 0.00025
Val acc before epoch 49: 0.2127659574468085
Warm optimizer lr: 0.00025
Val acc before epoch 50: 0.14893617021276595
Warm optimizer lr: 0.00025
Val acc before epoch 51: 0.20212765957446807
Warm optimizer lr: 0.00025
Val acc before epoch 52: 0.24468085106382978
Warm optimizer lr: 0.00025
Val acc before epoch 53: 0.1276595744680851
Warm optimizer lr: 0.00025
Val acc before epoch 54: 0.11702127659574468
Warm optimizer lr: 0.00025
Val acc before epoch 55: 0.1702127659574468
Warm optimizer lr: 0.00025
Val acc before epoch 56: 0.20212765957446807
Warm optimizer lr: 0.00025
Val acc before epoch 57: 0.2127659574468085
Warm optimizer lr: 0.00025
Val acc before epoch 58: 0.2765957446808511
Warm optimizer lr: 0.00025
Val acc before epoch 59: 0.1702127659574468
Warm optimizer lr: 0.000125
Val acc before epoch 60: 0.23404255319148937
Warm optimizer lr: 0.000125
Val acc before epoch 61: 0.2127659574468085
Warm optimizer lr: 0.000125
Val acc before epoch 62: 0.2553191489361702
Warm optimizer lr: 0.000125
Val acc before epoch 63: 0.1702127659574468
Warm optimizer lr: 0.000125
Val acc before epoch 64: 0.22340425531914893
Warm optimizer lr: 0.000125
Val acc before epoch 65: 0.26595744680851063
Warm optimizer lr: 0.000125
Val acc before epoch 66: 0.26595744680851063
Warm optimizer lr: 0.000125
Val acc before epoch 67: 0.26595744680851063
Warm optimizer lr: 0.000125
Val acc before epoch 68: 0.2872340425531915
Warm optimizer lr: 0.000125
Val acc before epoch 69: 0.18085106382978725
Warm optimizer lr: 0.000125
Val acc before epoch 70: 0.22340425531914893
Warm optimizer lr: 0.000125
Val acc before epoch 71: 0.2872340425531915
Warm optimizer lr: 0.000125
Val acc before epoch 72: 0.2127659574468085
Warm optimizer lr: 0.000125
Val acc before epoch 73: 0.19148936170212766
Warm optimizer lr: 0.000125
Val acc before epoch 74: 0.23404255319148937
Warm optimizer lr: 0.000125
Val acc before epoch 75: 0.26595744680851063
Warm optimizer lr: 0.000125
Val acc before epoch 76: 0.2765957446808511
Warm optimizer lr: 0.000125
Val acc before epoch 77: 0.2872340425531915
Warm optimizer lr: 0.000125
Val acc before epoch 78: 0.2127659574468085
Warm optimizer lr: 0.000125
Val acc before epoch 79: 0.1702127659574468
Warm optimizer lr: 6.25e-05
Val acc before epoch 80: 0.18085106382978725
Warm optimizer lr: 6.25e-05
Val acc before epoch 81: 0.19148936170212766
Warm optimizer lr: 6.25e-05
Val acc before epoch 82: 0.24468085106382978
Warm optimizer lr: 6.25e-05
Val acc before epoch 83: 0.2127659574468085
Warm optimizer lr: 6.25e-05
Val acc before epoch 84: 0.2553191489361702
Warm optimizer lr: 6.25e-05
Val acc before epoch 85: 0.23404255319148937
Warm optimizer lr: 6.25e-05
Val acc before epoch 86: 0.2872340425531915
Warm optimizer lr: 6.25e-05
Val acc before epoch 87: 0.2872340425531915
Warm optimizer lr: 6.25e-05
Val acc before epoch 88: 0.2553191489361702
Warm optimizer lr: 6.25e-05
Val acc before epoch 89: 0.2765957446808511
Warm optimizer lr: 6.25e-05
Val acc before epoch 90: 0.2553191489361702
Warm optimizer lr: 6.25e-05
Val acc before epoch 91: 0.26595744680851063
Warm optimizer lr: 6.25e-05
Val acc before epoch 92: 0.3191489361702128
Warm optimizer lr: 6.25e-05
Val acc before epoch 93: 0.20212765957446807
Warm optimizer lr: 6.25e-05
Val acc before epoch 94: 0.20212765957446807
Warm optimizer lr: 6.25e-05
Val acc before epoch 95: 0.26595744680851063
Warm optimizer lr: 6.25e-05
Val acc before epoch 96: 0.30851063829787234
Warm optimizer lr: 6.25e-05
Val acc before epoch 97: 0.2872340425531915
Warm optimizer lr: 6.25e-05
Val acc before epoch 98: 0.2872340425531915
Warm optimizer lr: 6.25e-05
Val acc before epoch 99: 0.24468085106382978
Warm optimizer lr: 3.125e-05
Val acc before epoch 100: 0.26595744680851063
Warm optimizer lr: 3.125e-05
Val acc before epoch 101: 0.2978723404255319
Warm optimizer lr: 3.125e-05
Val acc before epoch 102: 0.26595744680851063
Warm optimizer lr: 3.125e-05
Val acc before epoch 103: 0.35106382978723405
Warm optimizer lr: 3.125e-05
Val acc before epoch 104: 0.26595744680851063
Warm optimizer lr: 3.125e-05
Val acc before epoch 105: 0.23404255319148937
Warm optimizer lr: 3.125e-05
Val acc before epoch 106: 0.2127659574468085
Warm optimizer lr: 3.125e-05
Val acc before epoch 107: 0.26595744680851063
Warm optimizer lr: 3.125e-05
Val acc before epoch 108: 0.24468085106382978
Warm optimizer lr: 3.125e-05
Val acc before epoch 109: 0.26595744680851063
Warm optimizer lr: 3.125e-05
Val acc before epoch 110: 0.23404255319148937
Warm optimizer lr: 3.125e-05
Val acc before epoch 111: 0.30851063829787234
Warm optimizer lr: 3.125e-05
Val acc before epoch 112: 0.26595744680851063
Warm optimizer lr: 3.125e-05
Val acc before epoch 113: 0.2765957446808511
Warm optimizer lr: 3.125e-05
Val acc before epoch 114: 0.1702127659574468
Warm optimizer lr: 3.125e-05
Val acc before epoch 115: 0.24468085106382978
Warm optimizer lr: 3.125e-05
Val acc before epoch 116: 0.2765957446808511
Warm optimizer lr: 3.125e-05
Val acc before epoch 117: 0.24468085106382978
Warm optimizer lr: 3.125e-05
Val acc before epoch 118: 0.24468085106382978
Warm optimizer lr: 3.125e-05
Val acc before epoch 119: 0.23404255319148937
Warm optimizer lr: 1.5625e-05
Val acc before epoch 120: 0.24468085106382978
Warm optimizer lr: 1.5625e-05
Val acc before epoch 121: 0.24468085106382978
Warm optimizer lr: 1.5625e-05
Val acc before epoch 122: 0.2765957446808511
Warm optimizer lr: 1.5625e-05
Val acc before epoch 123: 0.22340425531914893
Warm optimizer lr: 1.5625e-05
Val acc before epoch 124: 0.2765957446808511
Warm optimizer lr: 1.5625e-05
Val acc before epoch 125: 0.23404255319148937
Warm optimizer lr: 1.5625e-05
Val acc before epoch 126: 0.2553191489361702
Warm optimizer lr: 1.5625e-05
Val acc before epoch 127: 0.23404255319148937
Warm optimizer lr: 1.5625e-05
Val acc before epoch 128: 0.2872340425531915
Warm optimizer lr: 1.5625e-05
Val acc before epoch 129: 0.22340425531914893
Warm optimizer lr: 1.5625e-05
Val acc before epoch 130: 0.35106382978723405
Warm optimizer lr: 1.5625e-05
Val acc before epoch 131: 0.2127659574468085
Warm optimizer lr: 1.5625e-05
Val acc before epoch 132: 0.22340425531914893
Warm optimizer lr: 1.5625e-05
Val acc before epoch 133: 0.2765957446808511
Warm optimizer lr: 1.5625e-05
Val acc before epoch 134: 0.2978723404255319
Warm optimizer lr: 1.5625e-05
Val acc before epoch 135: 0.2127659574468085
Warm optimizer lr: 1.5625e-05
Val acc before epoch 136: 0.24468085106382978
Warm optimizer lr: 1.5625e-05
Val acc before epoch 137: 0.2553191489361702
Warm optimizer lr: 1.5625e-05
Val acc before epoch 138: 0.3617021276595745
Warm optimizer lr: 1.5625e-05
Val acc before epoch 139: 0.22340425531914893
Warm optimizer lr: 7.8125e-06
Val acc before epoch 140: 0.2765957446808511
Warm optimizer lr: 7.8125e-06
Val acc before epoch 141: 0.3191489361702128
Warm optimizer lr: 7.8125e-06
Val acc before epoch 142: 0.2765957446808511
Warm optimizer lr: 7.8125e-06
Val acc before epoch 143: 0.2553191489361702
Warm optimizer lr: 7.8125e-06
Val acc before epoch 144: 0.2127659574468085
Warm optimizer lr: 7.8125e-06
Val acc before epoch 145: 0.22340425531914893
Warm optimizer lr: 7.8125e-06
Val acc before epoch 146: 0.20212765957446807
Warm optimizer lr: 7.8125e-06
Val acc before epoch 147: 0.30851063829787234
Warm optimizer lr: 7.8125e-06
Val acc before epoch 148: 0.3404255319148936
Warm optimizer lr: 7.8125e-06
Val acc before epoch 149: 0.35106382978723405
Warm optimizer lr: 7.8125e-06
Val acc before epoch 150: 0.2872340425531915
Warm optimizer lr: 7.8125e-06
Val acc before epoch 151: 0.2978723404255319
Warm optimizer lr: 7.8125e-06
Val acc before epoch 152: 0.3191489361702128
Warm optimizer lr: 7.8125e-06
Val acc before epoch 153: 0.3191489361702128
Warm optimizer lr: 7.8125e-06
Val acc before epoch 154: 0.2978723404255319
Warm optimizer lr: 7.8125e-06
Val acc before epoch 155: 0.2553191489361702
Warm optimizer lr: 7.8125e-06
Val acc before epoch 156: 0.2765957446808511
Warm optimizer lr: 7.8125e-06
Val acc before epoch 157: 0.2978723404255319
Warm optimizer lr: 7.8125e-06
Val acc before epoch 158: 0.24468085106382978
Warm optimizer lr: 7.8125e-06
Val acc before epoch 159: 0.2127659574468085
Warm optimizer lr: 3.90625e-06
Val acc before epoch 160: 0.23404255319148937
Warm optimizer lr: 3.90625e-06
Val acc before epoch 161: 0.2765957446808511
Warm optimizer lr: 3.90625e-06
Val acc before epoch 162: 0.2765957446808511
Warm optimizer lr: 3.90625e-06
Val acc before epoch 163: 0.2978723404255319
Warm optimizer lr: 3.90625e-06
Val acc before epoch 164: 0.2978723404255319
Warm optimizer lr: 3.90625e-06
Val acc before epoch 165: 0.2978723404255319
Warm optimizer lr: 3.90625e-06
Val acc before epoch 166: 0.22340425531914893
Warm optimizer lr: 3.90625e-06
Val acc before epoch 167: 0.23404255319148937
Warm optimizer lr: 3.90625e-06
Val acc before epoch 168: 0.26595744680851063
Warm optimizer lr: 3.90625e-06
Val acc before epoch 169: 0.2553191489361702
Warm optimizer lr: 3.90625e-06
Val acc before epoch 170: 0.26595744680851063
Warm optimizer lr: 3.90625e-06
Val acc before epoch 171: 0.2553191489361702
Warm optimizer lr: 3.90625e-06
Val acc before epoch 172: 0.26595744680851063
Warm optimizer lr: 3.90625e-06
Val acc before epoch 173: 0.23404255319148937
Warm optimizer lr: 3.90625e-06
Val acc before epoch 174: 0.24468085106382978
Warm optimizer lr: 3.90625e-06
Val acc before epoch 175: 0.22340425531914893
Warm optimizer lr: 3.90625e-06
Val acc before epoch 176: 0.2553191489361702
Warm optimizer lr: 3.90625e-06
Val acc before epoch 177: 0.26595744680851063
Warm optimizer lr: 3.90625e-06
Val acc before epoch 178: 0.30851063829787234
Warm optimizer lr: 3.90625e-06
Val acc before epoch 179: 0.2872340425531915
Warm optimizer lr: 1.953125e-06
Val acc before epoch 180: 0.3404255319148936
Warm optimizer lr: 1.953125e-06
Val acc before epoch 181: 0.30851063829787234
Warm optimizer lr: 1.953125e-06
Val acc before epoch 182: 0.2553191489361702
Warm optimizer lr: 1.953125e-06
Val acc before epoch 183: 0.2872340425531915
Warm optimizer lr: 1.953125e-06
Val acc before epoch 184: 0.26595744680851063
Warm optimizer lr: 1.953125e-06
Val acc before epoch 185: 0.2978723404255319
Warm optimizer lr: 1.953125e-06
Val acc before epoch 186: 0.2765957446808511
Warm optimizer lr: 1.953125e-06
Val acc before epoch 187: 0.23404255319148937
Warm optimizer lr: 1.953125e-06
Val acc before epoch 188: 0.2872340425531915
Warm optimizer lr: 1.953125e-06
Val acc before epoch 189: 0.24468085106382978
Warm optimizer lr: 1.953125e-06
Val acc before epoch 190: 0.2872340425531915
Warm optimizer lr: 1.953125e-06
Val acc before epoch 191: 0.30851063829787234
Warm optimizer lr: 1.953125e-06
Val acc before epoch 192: 0.32978723404255317
Warm optimizer lr: 1.953125e-06
Val acc before epoch 193: 0.23404255319148937
Warm optimizer lr: 1.953125e-06
Val acc before epoch 194: 0.2127659574468085
Warm optimizer lr: 1.953125e-06
Val acc before epoch 195: 0.2553191489361702
Warm optimizer lr: 1.953125e-06
Val acc before epoch 196: 0.3191489361702128
Warm optimizer lr: 1.953125e-06
Val acc before epoch 197: 0.24468085106382978
Warm optimizer lr: 1.953125e-06
Val acc before epoch 198: 0.22340425531914893
Warm optimizer lr: 1.953125e-06
Val acc before epoch 199: 0.2978723404255319
Warm optimizer lr: 9.765625e-07
Val acc before epoch 200: 0.2553191489361702
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.15792181069958847
Final val micro accuracy: 0.24468085106382978
Final test macro f1-score: 0.1858695652173913
Final test micro accuracy: 0.2872340425531915
Final validation:
	Cluster: 0.030573413707315922
	Separation: 0.037525249645113945
Final test:
	Cluster: 0.02982036117464304
	Separation: 0.03727894648909569
Saved Results

Attempting combination 14/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.5
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.0005
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 1: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 2: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 3: 0.02127659574468085
Warm optimizer lr: 0.0005
Val acc before epoch 4: 0.0425531914893617
Warm optimizer lr: 0.0005
Val acc before epoch 5: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 6: 0.02127659574468085
Warm optimizer lr: 0.0005
Val acc before epoch 7: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 8: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 9: 0.031914893617021274
Warm optimizer lr: 0.0005
Val acc before epoch 10: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 11: 0.0425531914893617
Warm optimizer lr: 0.0005
Val acc before epoch 12: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 13: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 14: 0.02127659574468085
Warm optimizer lr: 0.0005
Val acc before epoch 15: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 16: 0.031914893617021274
Warm optimizer lr: 0.0005
Val acc before epoch 17: 0.010638297872340425
Warm optimizer lr: 0.0005
Val acc before epoch 18: 0.0
Warm optimizer lr: 0.0005
Val acc before epoch 19: 0.031914893617021274
Warm optimizer lr: 0.00025
Val acc before epoch 20: 0.031914893617021274
Warm optimizer lr: 0.00025
Val acc before epoch 21: 0.05319148936170213
Warm optimizer lr: 0.00025
Val acc before epoch 22: 0.02127659574468085
Warm optimizer lr: 0.00025
Val acc before epoch 23: 0.031914893617021274
Warm optimizer lr: 0.00025
Val acc before epoch 24: 0.02127659574468085
Warm optimizer lr: 0.00025
Val acc before epoch 25: 0.031914893617021274
Warm optimizer lr: 0.00025
Val acc before epoch 26: 0.06382978723404255
Warm optimizer lr: 0.00025
Val acc before epoch 27: 0.031914893617021274
Warm optimizer lr: 0.00025
Val acc before epoch 28: 0.031914893617021274
Warm optimizer lr: 0.00025
Val acc before epoch 29: 0.05319148936170213
Warm optimizer lr: 0.00025
Val acc before epoch 30: 0.02127659574468085
Warm optimizer lr: 0.00025
Val acc before epoch 31: 0.02127659574468085
Warm optimizer lr: 0.00025
Val acc before epoch 32: 0.02127659574468085
Warm optimizer lr: 0.00025
Val acc before epoch 33: 0.0425531914893617
Warm optimizer lr: 0.00025
Val acc before epoch 34: 0.031914893617021274
Warm optimizer lr: 0.00025
Val acc before epoch 35: 0.06382978723404255
Warm optimizer lr: 0.00025
Val acc before epoch 36: 0.06382978723404255
Warm optimizer lr: 0.00025
Val acc before epoch 37: 0.05319148936170213
Warm optimizer lr: 0.00025
Val acc before epoch 38: 0.0425531914893617
Warm optimizer lr: 0.00025
Val acc before epoch 39: 0.0425531914893617
Warm optimizer lr: 0.000125
Val acc before epoch 40: 0.06382978723404255
Warm optimizer lr: 0.000125
Val acc before epoch 41: 0.05319148936170213
Warm optimizer lr: 0.000125
Val acc before epoch 42: 0.05319148936170213
Warm optimizer lr: 0.000125
Val acc before epoch 43: 0.0425531914893617
Warm optimizer lr: 0.000125
Val acc before epoch 44: 0.05319148936170213
Warm optimizer lr: 0.000125
Val acc before epoch 45: 0.0425531914893617
Warm optimizer lr: 0.000125
Val acc before epoch 46: 0.02127659574468085
Warm optimizer lr: 0.000125
Val acc before epoch 47: 0.05319148936170213
Warm optimizer lr: 0.000125
Val acc before epoch 48: 0.0425531914893617
Warm optimizer lr: 0.000125
Val acc before epoch 49: 0.07446808510638298
Warm optimizer lr: 0.000125
Val acc before epoch 50: 0.06382978723404255
Warm optimizer lr: 0.000125
Val acc before epoch 51: 0.02127659574468085
Warm optimizer lr: 0.000125
Val acc before epoch 52: 0.0425531914893617
Warm optimizer lr: 0.000125
Val acc before epoch 53: 0.0851063829787234
Warm optimizer lr: 0.000125
Val acc before epoch 54: 0.07446808510638298
Warm optimizer lr: 0.000125
Val acc before epoch 55: 0.031914893617021274
Warm optimizer lr: 0.000125
Val acc before epoch 56: 0.07446808510638298
Warm optimizer lr: 0.000125
Val acc before epoch 57: 0.02127659574468085
Warm optimizer lr: 0.000125
Val acc before epoch 58: 0.02127659574468085
Warm optimizer lr: 0.000125
Val acc before epoch 59: 0.0425531914893617
Warm optimizer lr: 6.25e-05
Val acc before epoch 60: 0.0425531914893617
Warm optimizer lr: 6.25e-05
Val acc before epoch 61: 0.05319148936170213
Warm optimizer lr: 6.25e-05
Val acc before epoch 62: 0.0851063829787234
Warm optimizer lr: 6.25e-05
Val acc before epoch 63: 0.05319148936170213
Warm optimizer lr: 6.25e-05
Val acc before epoch 64: 0.05319148936170213
Warm optimizer lr: 6.25e-05
Val acc before epoch 65: 0.05319148936170213
Warm optimizer lr: 6.25e-05
Val acc before epoch 66: 0.06382978723404255
Warm optimizer lr: 6.25e-05
Val acc before epoch 67: 0.0425531914893617
Warm optimizer lr: 6.25e-05
Val acc before epoch 68: 0.05319148936170213
Warm optimizer lr: 6.25e-05
Val acc before epoch 69: 0.031914893617021274
Warm optimizer lr: 6.25e-05
Val acc before epoch 70: 0.0851063829787234
Warm optimizer lr: 6.25e-05
Val acc before epoch 71: 0.06382978723404255
Warm optimizer lr: 6.25e-05
Val acc before epoch 72: 0.031914893617021274
Warm optimizer lr: 6.25e-05
Val acc before epoch 73: 0.031914893617021274
Warm optimizer lr: 6.25e-05
Val acc before epoch 74: 0.0851063829787234
Warm optimizer lr: 6.25e-05
Val acc before epoch 75: 0.031914893617021274
Warm optimizer lr: 6.25e-05
Val acc before epoch 76: 0.0425531914893617
Warm optimizer lr: 6.25e-05
Val acc before epoch 77: 0.07446808510638298
Warm optimizer lr: 6.25e-05
Val acc before epoch 78: 0.07446808510638298
Warm optimizer lr: 6.25e-05
Val acc before epoch 79: 0.07446808510638298
Warm optimizer lr: 3.125e-05
Val acc before epoch 80: 0.06382978723404255
Warm optimizer lr: 3.125e-05
Val acc before epoch 81: 0.06382978723404255
Warm optimizer lr: 3.125e-05
Val acc before epoch 82: 0.06382978723404255
Warm optimizer lr: 3.125e-05
Val acc before epoch 83: 0.0425531914893617
Warm optimizer lr: 3.125e-05
Val acc before epoch 84: 0.06382978723404255
Warm optimizer lr: 3.125e-05
Val acc before epoch 85: 0.06382978723404255
Warm optimizer lr: 3.125e-05
Val acc before epoch 86: 0.05319148936170213
Warm optimizer lr: 3.125e-05
Val acc before epoch 87: 0.05319148936170213
Warm optimizer lr: 3.125e-05
Val acc before epoch 88: 0.05319148936170213
Warm optimizer lr: 3.125e-05
Val acc before epoch 89: 0.02127659574468085
Warm optimizer lr: 3.125e-05
Val acc before epoch 90: 0.05319148936170213
Warm optimizer lr: 3.125e-05
Val acc before epoch 91: 0.05319148936170213
Warm optimizer lr: 3.125e-05
Val acc before epoch 92: 0.09574468085106383
Warm optimizer lr: 3.125e-05
Val acc before epoch 93: 0.0425531914893617
Warm optimizer lr: 3.125e-05
Val acc before epoch 94: 0.06382978723404255
Warm optimizer lr: 3.125e-05
Val acc before epoch 95: 0.05319148936170213
Warm optimizer lr: 3.125e-05
Val acc before epoch 96: 0.05319148936170213
Warm optimizer lr: 3.125e-05
Val acc before epoch 97: 0.05319148936170213
Warm optimizer lr: 3.125e-05
Val acc before epoch 98: 0.07446808510638298
Warm optimizer lr: 3.125e-05
Val acc before epoch 99: 0.06382978723404255
Warm optimizer lr: 1.5625e-05
Val acc before epoch 100: 0.0851063829787234
Warm optimizer lr: 1.5625e-05
Val acc before epoch 101: 0.0425531914893617
Warm optimizer lr: 1.5625e-05
Val acc before epoch 102: 0.07446808510638298
Warm optimizer lr: 1.5625e-05
Val acc before epoch 103: 0.0425531914893617
Warm optimizer lr: 1.5625e-05
Val acc before epoch 104: 0.07446808510638298
Warm optimizer lr: 1.5625e-05
Val acc before epoch 105: 0.031914893617021274
Warm optimizer lr: 1.5625e-05
Val acc before epoch 106: 0.06382978723404255
Warm optimizer lr: 1.5625e-05
Val acc before epoch 107: 0.05319148936170213
Warm optimizer lr: 1.5625e-05
Val acc before epoch 108: 0.09574468085106383
Warm optimizer lr: 1.5625e-05
Val acc before epoch 109: 0.05319148936170213
Warm optimizer lr: 1.5625e-05
Val acc before epoch 110: 0.02127659574468085
Warm optimizer lr: 1.5625e-05
Val acc before epoch 111: 0.0851063829787234
Warm optimizer lr: 1.5625e-05
Val acc before epoch 112: 0.031914893617021274
Warm optimizer lr: 1.5625e-05
Val acc before epoch 113: 0.0425531914893617
Warm optimizer lr: 1.5625e-05
Val acc before epoch 114: 0.05319148936170213
Warm optimizer lr: 1.5625e-05
Val acc before epoch 115: 0.09574468085106383
Warm optimizer lr: 1.5625e-05
Val acc before epoch 116: 0.07446808510638298
Warm optimizer lr: 1.5625e-05
Val acc before epoch 117: 0.09574468085106383
Warm optimizer lr: 1.5625e-05
Val acc before epoch 118: 0.05319148936170213
Warm optimizer lr: 1.5625e-05
Val acc before epoch 119: 0.07446808510638298
Warm optimizer lr: 7.8125e-06
Val acc before epoch 120: 0.10638297872340426
Warm optimizer lr: 7.8125e-06
Val acc before epoch 121: 0.11702127659574468
Warm optimizer lr: 7.8125e-06
Val acc before epoch 122: 0.0851063829787234
Warm optimizer lr: 7.8125e-06
Val acc before epoch 123: 0.0425531914893617
Warm optimizer lr: 7.8125e-06
Val acc before epoch 124: 0.0425531914893617
Warm optimizer lr: 7.8125e-06
Val acc before epoch 125: 0.02127659574468085
Warm optimizer lr: 7.8125e-06
Val acc before epoch 126: 0.09574468085106383
Warm optimizer lr: 7.8125e-06
Val acc before epoch 127: 0.031914893617021274
Warm optimizer lr: 7.8125e-06
Val acc before epoch 128: 0.0851063829787234
Warm optimizer lr: 7.8125e-06
Val acc before epoch 129: 0.06382978723404255
Warm optimizer lr: 7.8125e-06
Val acc before epoch 130: 0.0851063829787234
Warm optimizer lr: 7.8125e-06
Val acc before epoch 131: 0.07446808510638298
Warm optimizer lr: 7.8125e-06
Val acc before epoch 132: 0.07446808510638298
Warm optimizer lr: 7.8125e-06
Val acc before epoch 133: 0.09574468085106383
Warm optimizer lr: 7.8125e-06
Val acc before epoch 134: 0.10638297872340426
Warm optimizer lr: 7.8125e-06
Val acc before epoch 135: 0.06382978723404255
Warm optimizer lr: 7.8125e-06
Val acc before epoch 136: 0.07446808510638298
Warm optimizer lr: 7.8125e-06
Val acc before epoch 137: 0.06382978723404255
Warm optimizer lr: 7.8125e-06
Val acc before epoch 138: 0.07446808510638298
Warm optimizer lr: 7.8125e-06
Val acc before epoch 139: 0.031914893617021274
Warm optimizer lr: 3.90625e-06
Val acc before epoch 140: 0.0425531914893617
Warm optimizer lr: 3.90625e-06
Val acc before epoch 141: 0.05319148936170213
Warm optimizer lr: 3.90625e-06
Val acc before epoch 142: 0.06382978723404255
Warm optimizer lr: 3.90625e-06
Val acc before epoch 143: 0.0425531914893617
Warm optimizer lr: 3.90625e-06
Val acc before epoch 144: 0.05319148936170213
Warm optimizer lr: 3.90625e-06
Val acc before epoch 145: 0.06382978723404255
Warm optimizer lr: 3.90625e-06
Val acc before epoch 146: 0.0425531914893617
Warm optimizer lr: 3.90625e-06
Val acc before epoch 147: 0.05319148936170213
Warm optimizer lr: 3.90625e-06
Val acc before epoch 148: 0.06382978723404255
Warm optimizer lr: 3.90625e-06
Val acc before epoch 149: 0.0425531914893617
Warm optimizer lr: 3.90625e-06
Val acc before epoch 150: 0.06382978723404255
Warm optimizer lr: 3.90625e-06
Val acc before epoch 151: 0.06382978723404255
Warm optimizer lr: 3.90625e-06
Val acc before epoch 152: 0.07446808510638298
Warm optimizer lr: 3.90625e-06
Val acc before epoch 153: 0.05319148936170213
Warm optimizer lr: 3.90625e-06
Val acc before epoch 154: 0.05319148936170213
Warm optimizer lr: 3.90625e-06
Val acc before epoch 155: 0.07446808510638298
Warm optimizer lr: 3.90625e-06
Val acc before epoch 156: 0.0851063829787234
Warm optimizer lr: 3.90625e-06
Val acc before epoch 157: 0.07446808510638298
Warm optimizer lr: 3.90625e-06
Val acc before epoch 158: 0.05319148936170213
Warm optimizer lr: 3.90625e-06
Val acc before epoch 159: 0.0851063829787234
Warm optimizer lr: 1.953125e-06
Val acc before epoch 160: 0.09574468085106383
Warm optimizer lr: 1.953125e-06
Val acc before epoch 161: 0.10638297872340426
Warm optimizer lr: 1.953125e-06
Val acc before epoch 162: 0.0851063829787234
Warm optimizer lr: 1.953125e-06
Val acc before epoch 163: 0.07446808510638298
Warm optimizer lr: 1.953125e-06
Val acc before epoch 164: 0.05319148936170213
Warm optimizer lr: 1.953125e-06
Val acc before epoch 165: 0.05319148936170213
Warm optimizer lr: 1.953125e-06
Val acc before epoch 166: 0.02127659574468085
Warm optimizer lr: 1.953125e-06
Val acc before epoch 167: 0.05319148936170213
Warm optimizer lr: 1.953125e-06
Val acc before epoch 168: 0.0851063829787234
Warm optimizer lr: 1.953125e-06
Val acc before epoch 169: 0.09574468085106383
Warm optimizer lr: 1.953125e-06
Val acc before epoch 170: 0.07446808510638298
Warm optimizer lr: 1.953125e-06
Val acc before epoch 171: 0.07446808510638298
Warm optimizer lr: 1.953125e-06
Val acc before epoch 172: 0.09574468085106383
Warm optimizer lr: 1.953125e-06
Val acc before epoch 173: 0.07446808510638298
Warm optimizer lr: 1.953125e-06
Val acc before epoch 174: 0.07446808510638298
Warm optimizer lr: 1.953125e-06
Val acc before epoch 175: 0.0425531914893617
Warm optimizer lr: 1.953125e-06
Val acc before epoch 176: 0.06382978723404255
Warm optimizer lr: 1.953125e-06
Val acc before epoch 177: 0.06382978723404255
Warm optimizer lr: 1.953125e-06
Val acc before epoch 178: 0.06382978723404255
Warm optimizer lr: 1.953125e-06
Val acc before epoch 179: 0.05319148936170213
Warm optimizer lr: 9.765625e-07
Val acc before epoch 180: 0.1276595744680851
Warm optimizer lr: 9.765625e-07
Val acc before epoch 181: 0.0425531914893617
Warm optimizer lr: 9.765625e-07
Val acc before epoch 182: 0.07446808510638298
Warm optimizer lr: 9.765625e-07
Val acc before epoch 183: 0.0425531914893617
Warm optimizer lr: 9.765625e-07
Val acc before epoch 184: 0.031914893617021274
Warm optimizer lr: 9.765625e-07
Val acc before epoch 185: 0.031914893617021274
Warm optimizer lr: 9.765625e-07
Val acc before epoch 186: 0.0851063829787234
Warm optimizer lr: 9.765625e-07
Val acc before epoch 187: 0.05319148936170213
Warm optimizer lr: 9.765625e-07
Val acc before epoch 188: 0.07446808510638298
Warm optimizer lr: 9.765625e-07
Val acc before epoch 189: 0.06382978723404255
Warm optimizer lr: 9.765625e-07
Val acc before epoch 190: 0.031914893617021274
Warm optimizer lr: 9.765625e-07
Val acc before epoch 191: 0.05319148936170213
Warm optimizer lr: 9.765625e-07
Val acc before epoch 192: 0.11702127659574468
Warm optimizer lr: 9.765625e-07
Val acc before epoch 193: 0.07446808510638298
Warm optimizer lr: 9.765625e-07
Val acc before epoch 194: 0.05319148936170213
Warm optimizer lr: 9.765625e-07
Val acc before epoch 195: 0.05319148936170213
Warm optimizer lr: 9.765625e-07
Val acc before epoch 196: 0.05319148936170213
Warm optimizer lr: 9.765625e-07
Val acc before epoch 197: 0.0425531914893617
Warm optimizer lr: 9.765625e-07
Val acc before epoch 198: 0.05319148936170213
Warm optimizer lr: 9.765625e-07
Val acc before epoch 199: 0.0851063829787234
Warm optimizer lr: 4.8828125e-07
Val acc before epoch 200: 0.06382978723404255
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.037756202804746494
Final val micro accuracy: 0.07446808510638298
Final test macro f1-score: 0.03365384615384615
Final test micro accuracy: 0.05319148936170213
Final validation:
	Cluster: 0.0238829692825675
	Separation: 0.0350797139108181
Final test:
	Cluster: 0.02333451434969902
	Separation: 0.035756390541791916
Saved Results

Attempting combination 15/16:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
joint_weight_decay: 0
gamma: 0.5
warm_lr_step_size: 100
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.0001
last_layer_lr: 0.05
num_warm_epochs: 1000000
push_gap: -1
push_start: 200
num_pushes: 0
last_layer_epochs: 0
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 200
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 1: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 2: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 3: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 4: 0.010638297872340425
Warm optimizer lr: 0.0001
Val acc before epoch 5: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 6: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 7: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 8: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 9: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 10: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 11: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 12: 0.010638297872340425
Warm optimizer lr: 0.0001
Val acc before epoch 13: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 14: 0.02127659574468085
Warm optimizer lr: 0.0001
Val acc before epoch 15: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 16: 0.010638297872340425
Warm optimizer lr: 0.0001
Val acc before epoch 17: 0.010638297872340425
Warm optimizer lr: 0.0001
Val acc before epoch 18: 0.0
Warm optimizer lr: 0.0001
Val acc before epoch 19: 0.02127659574468085
Warm optimizer lr: 5e-05
Val acc before epoch 20: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 21: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 22: 0.010638297872340425
Warm optimizer lr: 5e-05
Val acc before epoch 23: 0.010638297872340425
Warm optimizer lr: 5e-05
Val acc before epoch 24: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 25: 0.010638297872340425
Warm optimizer lr: 5e-05
Val acc before epoch 26: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 27: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 28: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 29: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 30: 0.010638297872340425
Warm optimizer lr: 5e-05
Val acc before epoch 31: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 32: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 33: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 34: 0.010638297872340425
Warm optimizer lr: 5e-05
Val acc before epoch 35: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 36: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 37: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 38: 0.0
Warm optimizer lr: 5e-05
Val acc before epoch 39: 0.010638297872340425
Warm optimizer lr: 2.5e-05
Val acc before epoch 40: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 41: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 42: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 43: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 44: 0.010638297872340425
Warm optimizer lr: 2.5e-05
Val acc before epoch 45: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 46: 0.02127659574468085
Warm optimizer lr: 2.5e-05
Val acc before epoch 47: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 48: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 49: 0.010638297872340425
Warm optimizer lr: 2.5e-05
Val acc before epoch 50: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 51: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 52: 0.010638297872340425
Warm optimizer lr: 2.5e-05
Val acc before epoch 53: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 54: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 55: 0.031914893617021274
Warm optimizer lr: 2.5e-05
Val acc before epoch 56: 0.010638297872340425
Warm optimizer lr: 2.5e-05
Val acc before epoch 57: 0.0
Warm optimizer lr: 2.5e-05
Val acc before epoch 58: 0.02127659574468085
Warm optimizer lr: 2.5e-05
Val acc before epoch 59: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 60: 0.010638297872340425
Warm optimizer lr: 1.25e-05
Val acc before epoch 61: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 62: 0.02127659574468085
Warm optimizer lr: 1.25e-05
Val acc before epoch 63: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 64: 0.010638297872340425
Warm optimizer lr: 1.25e-05
Val acc before epoch 65: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 66: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 67: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 68: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 69: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 70: 0.010638297872340425
Warm optimizer lr: 1.25e-05
Val acc before epoch 71: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 72: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 73: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 74: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 75: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 76: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 77: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 78: 0.0
Warm optimizer lr: 1.25e-05
Val acc before epoch 79: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 80: 0.02127659574468085
Warm optimizer lr: 6.25e-06
Val acc before epoch 81: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 82: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 83: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 84: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 85: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 86: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 87: 0.010638297872340425
Warm optimizer lr: 6.25e-06
Val acc before epoch 88: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 89: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 90: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 91: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 92: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 93: 0.010638297872340425
Warm optimizer lr: 6.25e-06
Val acc before epoch 94: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 95: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 96: 0.02127659574468085
Warm optimizer lr: 6.25e-06
Val acc before epoch 97: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 98: 0.0
Warm optimizer lr: 6.25e-06
Val acc before epoch 99: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 100: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 101: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 102: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 103: 0.031914893617021274
Warm optimizer lr: 3.125e-06
Val acc before epoch 104: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 105: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 106: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 107: 0.02127659574468085
Warm optimizer lr: 3.125e-06
Val acc before epoch 108: 0.010638297872340425
Warm optimizer lr: 3.125e-06
Val acc before epoch 109: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 110: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 111: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 112: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 113: 0.010638297872340425
Warm optimizer lr: 3.125e-06
Val acc before epoch 114: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 115: 0.031914893617021274
Warm optimizer lr: 3.125e-06
Val acc before epoch 116: 0.0
Warm optimizer lr: 3.125e-06
Val acc before epoch 117: 0.010638297872340425
Warm optimizer lr: 3.125e-06
Val acc before epoch 118: 0.010638297872340425
Warm optimizer lr: 3.125e-06
Val acc before epoch 119: 0.010638297872340425
Warm optimizer lr: 1.5625e-06
Val acc before epoch 120: 0.0
Warm optimizer lr: 1.5625e-06
Val acc before epoch 121: 0.02127659574468085
Warm optimizer lr: 1.5625e-06
Val acc before epoch 122: 0.02127659574468085
Warm optimizer lr: 1.5625e-06
Val acc before epoch 123: 0.0
Warm optimizer lr: 1.5625e-06
Val acc before epoch 124: 0.010638297872340425
Warm optimizer lr: 1.5625e-06
Val acc before epoch 125: 0.010638297872340425
Warm optimizer lr: 1.5625e-06
Val acc before epoch 126: 0.010638297872340425
Warm optimizer lr: 1.5625e-06
Val acc before epoch 127: 0.0
Warm optimizer lr: 1.5625e-06
Val acc before epoch 128: 0.0
Warm optimizer lr: 1.5625e-06
Val acc before epoch 129: 0.031914893617021274
Warm optimizer lr: 1.5625e-06
Val acc before epoch 130: 0.0
Warm optimizer lr: 1.5625e-06
Val acc before epoch 131: 0.02127659574468085
Warm optimizer lr: 1.5625e-06
Val acc before epoch 132: 0.010638297872340425
Warm optimizer lr: 1.5625e-06
Val acc before epoch 133: 0.0
Warm optimizer lr: 1.5625e-06
Val acc before epoch 134: 0.0
Warm optimizer lr: 1.5625e-06
Val acc before epoch 135: 0.0
Warm optimizer lr: 1.5625e-06
Val acc before epoch 136: 0.010638297872340425
Warm optimizer lr: 1.5625e-06
Val acc before epoch 137: 0.02127659574468085
Warm optimizer lr: 1.5625e-06
Val acc before epoch 138: 0.0
Warm optimizer lr: 1.5625e-06
Val acc before epoch 139: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 140: 0.010638297872340425
Warm optimizer lr: 7.8125e-07
Val acc before epoch 141: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 142: 0.02127659574468085
Warm optimizer lr: 7.8125e-07
Val acc before epoch 143: 0.010638297872340425
Warm optimizer lr: 7.8125e-07
Val acc before epoch 144: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 145: 0.010638297872340425
Warm optimizer lr: 7.8125e-07
Val acc before epoch 146: 0.02127659574468085
Warm optimizer lr: 7.8125e-07
Val acc before epoch 147: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 148: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 149: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 150: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 151: 0.010638297872340425
Warm optimizer lr: 7.8125e-07
Val acc before epoch 152: 0.010638297872340425
Warm optimizer lr: 7.8125e-07
Val acc before epoch 153: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 154: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 155: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 156: 0.010638297872340425
Warm optimizer lr: 7.8125e-07
Val acc before epoch 157: 0.010638297872340425
Warm optimizer lr: 7.8125e-07
Val acc before epoch 158: 0.0
Warm optimizer lr: 7.8125e-07
Val acc before epoch 159: 0.0
Warm optimizer lr: 3.90625e-07
Val acc before epoch 160: 0.02127659574468085
Warm optimizer lr: 3.90625e-07
Val acc before epoch 161: 0.02127659574468085
Warm optimizer lr: 3.90625e-07
Val acc before epoch 162: 0.010638297872340425
Warm optimizer lr: 3.90625e-07
Val acc before epoch 163: 0.010638297872340425
Warm optimizer lr: 3.90625e-07
Val acc before epoch 164: 0.010638297872340425
Warm optimizer lr: 3.90625e-07
Val acc before epoch 165: 0.0
Warm optimizer lr: 3.90625e-07
Val acc before epoch 166: 0.02127659574468085
Warm optimizer lr: 3.90625e-07
Val acc before epoch 167: 0.0
Warm optimizer lr: 3.90625e-07
Val acc before epoch 168: 0.010638297872340425
Warm optimizer lr: 3.90625e-07
Val acc before epoch 169: 0.0
Warm optimizer lr: 3.90625e-07
Val acc before epoch 170: 0.010638297872340425
Warm optimizer lr: 3.90625e-07
Val acc before epoch 171: 0.0
Warm optimizer lr: 3.90625e-07
Val acc before epoch 172: 0.0
Warm optimizer lr: 3.90625e-07
Val acc before epoch 173: 0.010638297872340425
Warm optimizer lr: 3.90625e-07
Val acc before epoch 174: 0.0
Warm optimizer lr: 3.90625e-07
Val acc before epoch 175: 0.010638297872340425
Warm optimizer lr: 3.90625e-07
Val acc before epoch 176: 0.0
Warm optimizer lr: 3.90625e-07
Val acc before epoch 177: 0.0
Warm optimizer lr: 3.90625e-07
Val acc before epoch 178: 0.0
Warm optimizer lr: 3.90625e-07
Val acc before epoch 179: 0.02127659574468085
Warm optimizer lr: 1.953125e-07
Val acc before epoch 180: 0.0
Warm optimizer lr: 1.953125e-07
Val acc before epoch 181: 0.02127659574468085
Warm optimizer lr: 1.953125e-07
Val acc before epoch 182: 0.0
Warm optimizer lr: 1.953125e-07
Val acc before epoch 183: 0.02127659574468085
Warm optimizer lr: 1.953125e-07
Val acc before epoch 184: 0.010638297872340425
Warm optimizer lr: 1.953125e-07
Val acc before epoch 185: 0.0
Warm optimizer lr: 1.953125e-07
Val acc before epoch 186: 0.010638297872340425
Warm optimizer lr: 1.953125e-07
Val acc before epoch 187: 0.02127659574468085
Warm optimizer lr: 1.953125e-07
Val acc before epoch 188: 0.010638297872340425
Warm optimizer lr: 1.953125e-07
Val acc before epoch 189: 0.0
Warm optimizer lr: 1.953125e-07
Val acc before epoch 190: 0.0
Warm optimizer lr: 1.953125e-07
Val acc before epoch 191: 0.0
Warm optimizer lr: 1.953125e-07
Val acc before epoch 192: 0.0
Warm optimizer lr: 1.953125e-07
Val acc before epoch 193: 0.0
Warm optimizer lr: 1.953125e-07
Val acc before epoch 194: 0.02127659574468085
Warm optimizer lr: 1.953125e-07
Val acc before epoch 195: 0.031914893617021274
Warm optimizer lr: 1.953125e-07
Val acc before epoch 196: 0.010638297872340425
Warm optimizer lr: 1.953125e-07
Val acc before epoch 197: 0.0
Warm optimizer lr: 1.953125e-07
Val acc before epoch 198: 0.0
Warm optimizer lr: 1.953125e-07
Val acc before epoch 199: 0.010638297872340425
Warm optimizer lr: 9.765625e-08
Val acc before epoch 200: 0.0
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.0
Final val micro accuracy: 0.0
Final test macro f1-score: 0.011347517730496453
Final test micro accuracy: 0.02127659574468085
Final validation:
	Cluster: 0.01906341128051281
	Separation: 0.034956447780132294
Final test:
	Cluster: 0.0186680955812335
	Separation: 0.03482457064092159
Saved Results
Finished search.
