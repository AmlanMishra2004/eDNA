===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Mon Mar 25 13:54:51 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-03-25 13:55:04.139029: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-25 13:55:04.760174: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-25 13:55:04.762903: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-25 13:55:04.765914: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-25 13:55:05.119261: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94
Hyperparameters: {'prototype_shape': [(468, 520, 29)], 'latent_weight': [0.8], 'joint_weight_decay': [-1], 'gamma': [0.2], 'warm_lr_step_size': [5000000], 'crs_ent_weight': [1], 'clst_weight': [-96.0, -9.600000000000001, -0.9600000000000002], 'sep_weight': [24.0, 2.4, 0.24], 'l1_weight': [10, 1, 0.1, 0.01, 0.001], 'warm_ptype_lr': [0.1], 'last_layer_lr': [0.0005], 'num_warm_epochs': [1000000], 'push_gap': [10], 'push_start': [15], 'num_pushes': [2], 'last_layer_epochs': [100], 'joint_lr_step_size': [-1], 'joint_optimizer_lrs': [{'features': -1, 'prototype_vectors': -1}]}




Exploring 45 hyperparameter combinations for grid search.


Attempting combination 0/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 24.0
l1_weight: 10
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3404255319148936
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6702127659574468
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8317307692307693
	Cluster: 0.6469961047172547
	Separation: 0.5167546272277832
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.776595744680851
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.7446808510638298
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.8297872340425532
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.7872340425531915
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.7872340425531915
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.7553191489361702
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.6276595744680851
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6382978723404256
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.6276595744680851
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.7446808510638298
	Val acc at iteration 85: 0.6808510638297872
	Val acc at iteration 86: 0.7340425531914894
	Val acc at iteration 87: 0.7127659574468085
	Val acc at iteration 88: 0.6914893617021277
	Val acc at iteration 89: 0.7127659574468085
	Val acc at iteration 90: 0.6702127659574468
	Val acc at iteration 91: 0.7021276595744681
	Val acc at iteration 92: 0.6382978723404256
	Val acc at iteration 93: 0.723404255319149
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.6914893617021277
	Val acc at iteration 96: 0.7021276595744681
	Val acc at iteration 97: 0.6276595744680851
	Val acc at iteration 98: 0.7553191489361702
	Val acc at iteration 99: 0.6808510638297872
Val acc before epoch 16: 0.6808510638297872
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8108974358974359
	Cluster: 0.6506591677665711
	Separation: 0.5234666228294372
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.7553191489361702
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.6170212765957447
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.776595744680851
	Val acc at iteration 21: 0.7659574468085106
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.5638297872340425
	Val acc at iteration 31: 0.6382978723404256
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.6170212765957447
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.7553191489361702
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6170212765957447
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.7872340425531915
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.5851063829787234
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.6276595744680851
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.7872340425531915
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.776595744680851
	Val acc at iteration 85: 0.723404255319149
	Val acc at iteration 86: 0.7659574468085106
	Val acc at iteration 87: 0.723404255319149
	Val acc at iteration 88: 0.7553191489361702
	Val acc at iteration 89: 0.7340425531914894
	Val acc at iteration 90: 0.7021276595744681
	Val acc at iteration 91: 0.7553191489361702
	Val acc at iteration 92: 0.7446808510638298
	Val acc at iteration 93: 0.6170212765957447
	Val acc at iteration 94: 0.6595744680851063
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.7340425531914894
	Val acc at iteration 97: 0.6063829787234043
	Val acc at iteration 98: 0.7127659574468085
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 26: 0.6914893617021277
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7872340425531915
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8191489361702128
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9148936170212766
Stopping after epoch 36.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8461538461538461
	Cluster: 0.654489004611969
	Separation: 0.5206204533576966
(After push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8076923076923077
	Val acc at iteration 0: 0.6382978723404256
	Train acc at iteration 2: 0.8301282051282052
	Val acc at iteration 1: 0.7659574468085106
	Train acc at iteration 3: 0.7900641025641025
	Val acc at iteration 2: 0.648936170212766
	Train acc at iteration 4: 0.7996794871794872
	Val acc at iteration 3: 0.6808510638297872
	Train acc at iteration 5: 0.7900641025641025
	Val acc at iteration 4: 0.7446808510638298
	Train acc at iteration 6: 0.8092948717948718
	Val acc at iteration 5: 0.6914893617021277
	Train acc at iteration 7: 0.8060897435897436
	Val acc at iteration 6: 0.6595744680851063
	Train acc at iteration 8: 0.7868589743589743
	Val acc at iteration 7: 0.7872340425531915
	Train acc at iteration 9: 0.7772435897435898
	Val acc at iteration 8: 0.723404255319149
	Train acc at iteration 10: 0.8157051282051282
	Val acc at iteration 9: 0.6595744680851063
	Train acc at iteration 11: 0.7900641025641025
	Val acc at iteration 10: 0.723404255319149
	Train acc at iteration 12: 0.7884615384615384
	Val acc at iteration 11: 0.7127659574468085
	Train acc at iteration 13: 0.7964743589743589
	Val acc at iteration 12: 0.7553191489361702
	Train acc at iteration 14: 0.8269230769230769
	Val acc at iteration 13: 0.6276595744680851
	Train acc at iteration 15: 0.8173076923076923
	Val acc at iteration 14: 0.6702127659574468
	Train acc at iteration 16: 0.7948717948717948
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.8076923076923077
	Val acc at iteration 16: 0.723404255319149
	Train acc at iteration 18: 0.8076923076923077
	Val acc at iteration 17: 0.7127659574468085
	Train acc at iteration 19: 0.8173076923076923
	Val acc at iteration 18: 0.6808510638297872
	Train acc at iteration 20: 0.8092948717948718
	Val acc at iteration 19: 0.6808510638297872
	Train acc at iteration 21: 0.8125
	Val acc at iteration 20: 0.6702127659574468
	Train acc at iteration 22: 0.8076923076923077
	Val acc at iteration 21: 0.6702127659574468
	Train acc at iteration 23: 0.7932692307692307
	Val acc at iteration 22: 0.7127659574468085
	Train acc at iteration 24: 0.7628205128205128
	Val acc at iteration 23: 0.7021276595744681
	Train acc at iteration 25: 0.8173076923076923
	Val acc at iteration 24: 0.7659574468085106
	Train acc at iteration 26: 0.7996794871794872
	Val acc at iteration 25: 0.6914893617021277
	Train acc at iteration 27: 0.8253205128205128
	Val acc at iteration 26: 0.6276595744680851
	Train acc at iteration 28: 0.782051282051282
	Val acc at iteration 27: 0.723404255319149
	Train acc at iteration 29: 0.7868589743589743
	Val acc at iteration 28: 0.6808510638297872
	Train acc at iteration 30: 0.7756410256410257
	Val acc at iteration 29: 0.6702127659574468
	Train acc at iteration 31: 0.8173076923076923
	Val acc at iteration 30: 0.648936170212766
	Train acc at iteration 32: 0.7900641025641025
	Val acc at iteration 31: 0.7446808510638298
	Train acc at iteration 33: 0.8108974358974359
	Val acc at iteration 32: 0.723404255319149
	Train acc at iteration 34: 0.7980769230769231
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.8189102564102564
	Val acc at iteration 34: 0.7340425531914894
	Train acc at iteration 36: 0.780448717948718
	Val acc at iteration 35: 0.723404255319149
	Train acc at iteration 37: 0.8076923076923077
	Val acc at iteration 36: 0.6808510638297872
	Train acc at iteration 38: 0.8028846153846154
	Val acc at iteration 37: 0.7553191489361702
	Train acc at iteration 39: 0.8028846153846154
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.8253205128205128
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.8060897435897436
	Val acc at iteration 40: 0.6808510638297872
	Train acc at iteration 42: 0.7516025641025641
	Val acc at iteration 41: 0.6702127659574468
	Train acc at iteration 43: 0.7564102564102564
	Val acc at iteration 42: 0.7127659574468085
	Train acc at iteration 44: 0.7932692307692307
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.8173076923076923
	Val acc at iteration 44: 0.5957446808510638
	Train acc at iteration 46: 0.7916666666666666
	Val acc at iteration 45: 0.7127659574468085
	Train acc at iteration 47: 0.7788461538461539
	Val acc at iteration 46: 0.6808510638297872
	Train acc at iteration 48: 0.782051282051282
	Val acc at iteration 47: 0.7021276595744681
	Train acc at iteration 49: 0.7868589743589743
	Val acc at iteration 48: 0.7553191489361702
	Train acc at iteration 50: 0.7852564102564102
	Val acc at iteration 49: 0.648936170212766
	Train acc at iteration 51: 0.8092948717948718
	Val acc at iteration 50: 0.7127659574468085
	Train acc at iteration 52: 0.8269230769230769
	Val acc at iteration 51: 0.6702127659574468
	Train acc at iteration 53: 0.8076923076923077
	Val acc at iteration 52: 0.7021276595744681
	Train acc at iteration 54: 0.7628205128205128
	Val acc at iteration 53: 0.6382978723404256
	Train acc at iteration 55: 0.7996794871794872
	Val acc at iteration 54: 0.6808510638297872
	Train acc at iteration 56: 0.8012820512820513
	Val acc at iteration 55: 0.7659574468085106
	Train acc at iteration 57: 0.7836538461538461
	Val acc at iteration 56: 0.6914893617021277
	Train acc at iteration 58: 0.7996794871794872
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.8221153846153846
	Val acc at iteration 58: 0.7127659574468085
	Train acc at iteration 60: 0.7916666666666666
	Val acc at iteration 59: 0.6382978723404256
	Train acc at iteration 61: 0.7916666666666666
	Val acc at iteration 60: 0.6063829787234043
	Train acc at iteration 62: 0.782051282051282
	Val acc at iteration 61: 0.7021276595744681
	Train acc at iteration 63: 0.8028846153846154
	Val acc at iteration 62: 0.7021276595744681
	Train acc at iteration 64: 0.8092948717948718
	Val acc at iteration 63: 0.7021276595744681
	Train acc at iteration 65: 0.8012820512820513
	Val acc at iteration 64: 0.6914893617021277
	Train acc at iteration 66: 0.8125
	Val acc at iteration 65: 0.6808510638297872
	Train acc at iteration 67: 0.7884615384615384
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.8028846153846154
	Val acc at iteration 67: 0.6702127659574468
	Train acc at iteration 69: 0.7996794871794872
	Val acc at iteration 68: 0.6276595744680851
	Train acc at iteration 70: 0.7884615384615384
	Val acc at iteration 69: 0.7021276595744681
	Train acc at iteration 71: 0.8157051282051282
	Val acc at iteration 70: 0.7021276595744681
	Train acc at iteration 72: 0.7868589743589743
	Val acc at iteration 71: 0.6914893617021277
	Train acc at iteration 73: 0.7788461538461539
	Val acc at iteration 72: 0.7127659574468085
	Train acc at iteration 74: 0.8060897435897436
	Val acc at iteration 73: 0.7021276595744681
	Train acc at iteration 75: 0.8028846153846154
	Val acc at iteration 74: 0.6702127659574468
	Train acc at iteration 76: 0.7788461538461539
	Val acc at iteration 75: 0.7127659574468085
	Train acc at iteration 77: 0.7884615384615384
	Val acc at iteration 76: 0.6914893617021277
	Train acc at iteration 78: 0.8028846153846154
	Val acc at iteration 77: 0.7127659574468085
	Train acc at iteration 79: 0.8125
	Val acc at iteration 78: 0.7127659574468085
	Train acc at iteration 80: 0.8108974358974359
	Val acc at iteration 79: 0.723404255319149
	Train acc at iteration 81: 0.8301282051282052
	Val acc at iteration 80: 0.7340425531914894
	Train acc at iteration 82: 0.8141025641025641
	Val acc at iteration 81: 0.7340425531914894
	Train acc at iteration 83: 0.8028846153846154
	Val acc at iteration 82: 0.7021276595744681
	Train acc at iteration 84: 0.8125
	Val acc at iteration 83: 0.7127659574468085
	Train acc at iteration 85: 0.8108974358974359
	Val acc at iteration 84: 0.7127659574468085
	Train acc at iteration 86: 0.7964743589743589
	Val acc at iteration 85: 0.6808510638297872
	Train acc at iteration 87: 0.8076923076923077
	Val acc at iteration 86: 0.6595744680851063
	Train acc at iteration 88: 0.8012820512820513
	Val acc at iteration 87: 0.7021276595744681
	Train acc at iteration 89: 0.8173076923076923
	Val acc at iteration 88: 0.6382978723404256
	Train acc at iteration 90: 0.8205128205128205
	Val acc at iteration 89: 0.6382978723404256
	Train acc at iteration 91: 0.8125
	Val acc at iteration 90: 0.776595744680851
	Train acc at iteration 92: 0.7932692307692307
	Val acc at iteration 91: 0.6914893617021277
	Train acc at iteration 93: 0.8028846153846154
	Val acc at iteration 92: 0.723404255319149
	Train acc at iteration 94: 0.7868589743589743
	Val acc at iteration 93: 0.7021276595744681
	Train acc at iteration 95: 0.7996794871794872
	Val acc at iteration 94: 0.7021276595744681
	Train acc at iteration 96: 0.8012820512820513
	Val acc at iteration 95: 0.6808510638297872
	Train acc at iteration 97: 0.8044871794871795
	Val acc at iteration 96: 0.7127659574468085
	Train acc at iteration 98: 0.8092948717948718
	Val acc at iteration 97: 0.6914893617021277
	Train acc at iteration 99: 0.7948717948717948
	Val acc at iteration 98: 0.7446808510638298
	Train acc at iteration 100: 0.8381410256410257
	Val acc at iteration 99: 0.6808510638297872
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5775577557755776
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.4918518518518518
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.6236428618431091
	Separation: 0.5366891920566559
Final test:
	Cluster: 0.6113977134227753
	Separation: 0.5393201112747192
Saved Results

Attempting combination 1/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 24.0
l1_weight: 1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.2765957446808511
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5319148936170213
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.5638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7127659574468085
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.7340425531914894
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Cluster: 0.6472265720367432
	Separation: 0.5224281430244446
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.5531914893617021
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.5425531914893617
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.6170212765957447
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.5531914893617021
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.5957446808510638
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.6276595744680851
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.5957446808510638
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6063829787234043
	Val acc at iteration 47: 0.6063829787234043
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6170212765957447
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.574468085106383
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.7659574468085106
	Val acc at iteration 62: 0.5638297872340425
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.6276595744680851
	Val acc at iteration 67: 0.6382978723404256
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.648936170212766
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6382978723404256
	Val acc at iteration 82: 0.6276595744680851
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.6808510638297872
	Val acc at iteration 85: 0.7021276595744681
	Val acc at iteration 86: 0.6702127659574468
	Val acc at iteration 87: 0.6170212765957447
	Val acc at iteration 88: 0.7127659574468085
	Val acc at iteration 89: 0.6382978723404256
	Val acc at iteration 90: 0.7021276595744681
	Val acc at iteration 91: 0.7659574468085106
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.6382978723404256
	Val acc at iteration 94: 0.7021276595744681
	Val acc at iteration 95: 0.6276595744680851
	Val acc at iteration 96: 0.6914893617021277
	Val acc at iteration 97: 0.6808510638297872
	Val acc at iteration 98: 0.6382978723404256
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 16: 0.5957446808510638
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7659574468085106
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7740384615384616
	Cluster: 0.6444743156433106
	Separation: 0.5214631915092468
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.5957446808510638
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.6063829787234043
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.6063829787234043
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6382978723404256
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.6595744680851063
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.6063829787234043
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.5531914893617021
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.6276595744680851
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.6276595744680851
	Val acc at iteration 59: 0.6276595744680851
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6276595744680851
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.6808510638297872
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.6382978723404256
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.5851063829787234
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.6276595744680851
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6276595744680851
	Val acc at iteration 81: 0.6276595744680851
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.6170212765957447
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.6382978723404256
	Val acc at iteration 86: 0.6808510638297872
	Val acc at iteration 87: 0.6382978723404256
	Val acc at iteration 88: 0.6382978723404256
	Val acc at iteration 89: 0.5957446808510638
	Val acc at iteration 90: 0.648936170212766
	Val acc at iteration 91: 0.6276595744680851
	Val acc at iteration 92: 0.6808510638297872
	Val acc at iteration 93: 0.7127659574468085
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.7553191489361702
	Val acc at iteration 96: 0.6170212765957447
	Val acc at iteration 97: 0.723404255319149
	Val acc at iteration 98: 0.723404255319149
	Val acc at iteration 99: 0.6914893617021277
Val acc before epoch 26: 0.6170212765957447
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9042553191489362
Stopping after epoch 36.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Cluster: 0.6502725481987
	Separation: 0.5188995838165283
(After push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7788461538461539
	Val acc at iteration 0: 0.6914893617021277
	Train acc at iteration 2: 0.7852564102564102
	Val acc at iteration 1: 0.648936170212766
	Train acc at iteration 3: 0.7980769230769231
	Val acc at iteration 2: 0.723404255319149
	Train acc at iteration 4: 0.7932692307692307
	Val acc at iteration 3: 0.6702127659574468
	Train acc at iteration 5: 0.75
	Val acc at iteration 4: 0.7553191489361702
	Train acc at iteration 6: 0.780448717948718
	Val acc at iteration 5: 0.7446808510638298
	Train acc at iteration 7: 0.7932692307692307
	Val acc at iteration 6: 0.6702127659574468
	Train acc at iteration 8: 0.7740384615384616
	Val acc at iteration 7: 0.574468085106383
	Train acc at iteration 9: 0.7852564102564102
	Val acc at iteration 8: 0.6382978723404256
	Train acc at iteration 10: 0.7596153846153846
	Val acc at iteration 9: 0.7127659574468085
	Train acc at iteration 11: 0.8060897435897436
	Val acc at iteration 10: 0.6170212765957447
	Train acc at iteration 12: 0.7676282051282052
	Val acc at iteration 11: 0.7021276595744681
	Train acc at iteration 13: 0.7692307692307693
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.780448717948718
	Val acc at iteration 13: 0.723404255319149
	Train acc at iteration 15: 0.8189102564102564
	Val acc at iteration 14: 0.648936170212766
	Train acc at iteration 16: 0.7548076923076923
	Val acc at iteration 15: 0.7127659574468085
	Train acc at iteration 17: 0.7836538461538461
	Val acc at iteration 16: 0.648936170212766
	Train acc at iteration 18: 0.8044871794871795
	Val acc at iteration 17: 0.6702127659574468
	Train acc at iteration 19: 0.8044871794871795
	Val acc at iteration 18: 0.723404255319149
	Train acc at iteration 20: 0.7644230769230769
	Val acc at iteration 19: 0.7021276595744681
	Train acc at iteration 21: 0.7916666666666666
	Val acc at iteration 20: 0.7127659574468085
	Train acc at iteration 22: 0.7868589743589743
	Val acc at iteration 21: 0.6914893617021277
	Train acc at iteration 23: 0.7708333333333334
	Val acc at iteration 22: 0.6914893617021277
	Train acc at iteration 24: 0.7740384615384616
	Val acc at iteration 23: 0.7021276595744681
	Train acc at iteration 25: 0.7275641025641025
	Val acc at iteration 24: 0.6595744680851063
	Train acc at iteration 26: 0.782051282051282
	Val acc at iteration 25: 0.6702127659574468
	Train acc at iteration 27: 0.7964743589743589
	Val acc at iteration 26: 0.6702127659574468
	Train acc at iteration 28: 0.7996794871794872
	Val acc at iteration 27: 0.6808510638297872
	Train acc at iteration 29: 0.7724358974358975
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.7740384615384616
	Val acc at iteration 29: 0.6914893617021277
	Train acc at iteration 31: 0.7692307692307693
	Val acc at iteration 30: 0.648936170212766
	Train acc at iteration 32: 0.7660256410256411
	Val acc at iteration 31: 0.6170212765957447
	Train acc at iteration 33: 0.7852564102564102
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.7612179487179487
	Val acc at iteration 33: 0.6914893617021277
	Train acc at iteration 35: 0.7788461538461539
	Val acc at iteration 34: 0.6595744680851063
	Train acc at iteration 36: 0.7836538461538461
	Val acc at iteration 35: 0.6808510638297872
	Train acc at iteration 37: 0.7788461538461539
	Val acc at iteration 36: 0.648936170212766
	Train acc at iteration 38: 0.7660256410256411
	Val acc at iteration 37: 0.6595744680851063
	Train acc at iteration 39: 0.7916666666666666
	Val acc at iteration 38: 0.7127659574468085
	Train acc at iteration 40: 0.7964743589743589
	Val acc at iteration 39: 0.7553191489361702
	Train acc at iteration 41: 0.7628205128205128
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.7772435897435898
	Val acc at iteration 41: 0.6808510638297872
	Train acc at iteration 43: 0.7403846153846154
	Val acc at iteration 42: 0.6170212765957447
	Train acc at iteration 44: 0.7692307692307693
	Val acc at iteration 43: 0.7340425531914894
	Train acc at iteration 45: 0.7740384615384616
	Val acc at iteration 44: 0.5957446808510638
	Train acc at iteration 46: 0.7660256410256411
	Val acc at iteration 45: 0.7659574468085106
	Train acc at iteration 47: 0.7996794871794872
	Val acc at iteration 46: 0.6595744680851063
	Train acc at iteration 48: 0.7756410256410257
	Val acc at iteration 47: 0.7553191489361702
	Train acc at iteration 49: 0.7708333333333334
	Val acc at iteration 48: 0.6170212765957447
	Train acc at iteration 50: 0.7772435897435898
	Val acc at iteration 49: 0.6702127659574468
	Train acc at iteration 51: 0.8028846153846154
	Val acc at iteration 50: 0.723404255319149
	Train acc at iteration 52: 0.7644230769230769
	Val acc at iteration 51: 0.7340425531914894
	Train acc at iteration 53: 0.7756410256410257
	Val acc at iteration 52: 0.6914893617021277
	Train acc at iteration 54: 0.7788461538461539
	Val acc at iteration 53: 0.6595744680851063
	Train acc at iteration 55: 0.7628205128205128
	Val acc at iteration 54: 0.7659574468085106
	Train acc at iteration 56: 0.780448717948718
	Val acc at iteration 55: 0.6276595744680851
	Train acc at iteration 57: 0.7948717948717948
	Val acc at iteration 56: 0.7021276595744681
	Train acc at iteration 58: 0.7692307692307693
	Val acc at iteration 57: 0.6702127659574468
	Train acc at iteration 59: 0.7628205128205128
	Val acc at iteration 58: 0.6914893617021277
	Train acc at iteration 60: 0.7708333333333334
	Val acc at iteration 59: 0.6702127659574468
	Train acc at iteration 61: 0.780448717948718
	Val acc at iteration 60: 0.6808510638297872
	Train acc at iteration 62: 0.7964743589743589
	Val acc at iteration 61: 0.7340425531914894
	Train acc at iteration 63: 0.7772435897435898
	Val acc at iteration 62: 0.6382978723404256
	Train acc at iteration 64: 0.7532051282051282
	Val acc at iteration 63: 0.7021276595744681
	Train acc at iteration 65: 0.780448717948718
	Val acc at iteration 64: 0.723404255319149
	Train acc at iteration 66: 0.7900641025641025
	Val acc at iteration 65: 0.6170212765957447
	Train acc at iteration 67: 0.7644230769230769
	Val acc at iteration 66: 0.5957446808510638
	Train acc at iteration 68: 0.7852564102564102
	Val acc at iteration 67: 0.723404255319149
	Train acc at iteration 69: 0.7932692307692307
	Val acc at iteration 68: 0.6276595744680851
	Train acc at iteration 70: 0.7852564102564102
	Val acc at iteration 69: 0.6914893617021277
	Train acc at iteration 71: 0.7676282051282052
	Val acc at iteration 70: 0.6595744680851063
	Train acc at iteration 72: 0.7964743589743589
	Val acc at iteration 71: 0.6382978723404256
	Train acc at iteration 73: 0.7660256410256411
	Val acc at iteration 72: 0.5957446808510638
	Train acc at iteration 74: 0.7916666666666666
	Val acc at iteration 73: 0.7127659574468085
	Train acc at iteration 75: 0.780448717948718
	Val acc at iteration 74: 0.7340425531914894
	Train acc at iteration 76: 0.7692307692307693
	Val acc at iteration 75: 0.6808510638297872
	Train acc at iteration 77: 0.7756410256410257
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.7852564102564102
	Val acc at iteration 77: 0.6702127659574468
	Train acc at iteration 79: 0.7964743589743589
	Val acc at iteration 78: 0.648936170212766
	Train acc at iteration 80: 0.7996794871794872
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.7612179487179487
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.7676282051282052
	Val acc at iteration 81: 0.6595744680851063
	Train acc at iteration 83: 0.7740384615384616
	Val acc at iteration 82: 0.648936170212766
	Train acc at iteration 84: 0.7948717948717948
	Val acc at iteration 83: 0.6914893617021277
	Train acc at iteration 85: 0.7932692307692307
	Val acc at iteration 84: 0.7340425531914894
	Train acc at iteration 86: 0.7948717948717948
	Val acc at iteration 85: 0.6170212765957447
	Train acc at iteration 87: 0.7868589743589743
	Val acc at iteration 86: 0.7340425531914894
	Train acc at iteration 88: 0.7948717948717948
	Val acc at iteration 87: 0.723404255319149
	Train acc at iteration 89: 0.7692307692307693
	Val acc at iteration 88: 0.6170212765957447
	Train acc at iteration 90: 0.7612179487179487
	Val acc at iteration 89: 0.6063829787234043
	Train acc at iteration 91: 0.7580128205128205
	Val acc at iteration 90: 0.7021276595744681
	Train acc at iteration 92: 0.7596153846153846
	Val acc at iteration 91: 0.648936170212766
	Train acc at iteration 93: 0.8060897435897436
	Val acc at iteration 92: 0.7127659574468085
	Train acc at iteration 94: 0.7724358974358975
	Val acc at iteration 93: 0.6595744680851063
	Train acc at iteration 95: 0.8044871794871795
	Val acc at iteration 94: 0.7127659574468085
	Train acc at iteration 96: 0.7756410256410257
	Val acc at iteration 95: 0.6702127659574468
	Train acc at iteration 97: 0.7868589743589743
	Val acc at iteration 96: 0.6914893617021277
	Train acc at iteration 98: 0.7692307692307693
	Val acc at iteration 97: 0.6595744680851063
	Train acc at iteration 99: 0.7740384615384616
	Val acc at iteration 98: 0.6063829787234043
	Train acc at iteration 100: 0.7788461538461539
	Val acc at iteration 99: 0.6702127659574468
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6116666666666666
Final val micro accuracy: 0.7127659574468085
Final test macro f1-score: 0.5176029962546816
Final test micro accuracy: 0.6276595744680851
Final validation:
	Cluster: 0.620802640914917
	Separation: 0.541469395160675
Final test:
	Cluster: 0.5909411609172821
	Separation: 0.5363186001777649
Saved Results

Attempting combination 2/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 24.0
l1_weight: 0.1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.2765957446808511
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5531914893617021
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6914893617021277
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.7978723404255319
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8125
	Cluster: 0.6541682958602906
	Separation: 0.5219217300415039
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.6063829787234043
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.7659574468085106
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.574468085106383
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.6382978723404256
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.5638297872340425
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.6170212765957447
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6063829787234043
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.6170212765957447
	Val acc at iteration 65: 0.6063829787234043
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.6382978723404256
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.5851063829787234
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.7021276595744681
	Val acc at iteration 85: 0.6914893617021277
	Val acc at iteration 86: 0.6595744680851063
	Val acc at iteration 87: 0.6914893617021277
	Val acc at iteration 88: 0.6170212765957447
	Val acc at iteration 89: 0.7340425531914894
	Val acc at iteration 90: 0.6276595744680851
	Val acc at iteration 91: 0.723404255319149
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.7127659574468085
	Val acc at iteration 95: 0.6063829787234043
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.7021276595744681
	Val acc at iteration 98: 0.6595744680851063
	Val acc at iteration 99: 0.6702127659574468
Val acc before epoch 16: 0.6276595744680851
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.7872340425531915
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.8617021276595744
Push epoch
After push, before retraining last layer:
	Train acc: 0.7980769230769231
	Cluster: 0.6643506288528442
	Separation: 0.523685884475708
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.6914893617021277
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.5851063829787234
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.6382978723404256
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.5851063829787234
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.776595744680851
	Val acc at iteration 43: 0.6276595744680851
	Val acc at iteration 44: 0.6170212765957447
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.7659574468085106
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.5957446808510638
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.6276595744680851
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.7978723404255319
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.5957446808510638
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.6276595744680851
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.7127659574468085
	Val acc at iteration 87: 0.6595744680851063
	Val acc at iteration 88: 0.648936170212766
	Val acc at iteration 89: 0.648936170212766
	Val acc at iteration 90: 0.6276595744680851
	Val acc at iteration 91: 0.7127659574468085
	Val acc at iteration 92: 0.7872340425531915
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.6702127659574468
	Val acc at iteration 95: 0.6595744680851063
	Val acc at iteration 96: 0.7340425531914894
	Val acc at iteration 97: 0.6914893617021277
	Val acc at iteration 98: 0.6595744680851063
	Val acc at iteration 99: 0.7021276595744681
Val acc before epoch 26: 0.6276595744680851
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8936170212765957
Stopping after epoch 36.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7916666666666666
	Cluster: 0.6516005754470825
	Separation: 0.5204438686370849
(After push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7628205128205128
	Val acc at iteration 0: 0.6382978723404256
	Train acc at iteration 2: 0.8092948717948718
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.7932692307692307
	Val acc at iteration 2: 0.723404255319149
	Train acc at iteration 4: 0.7788461538461539
	Val acc at iteration 3: 0.7340425531914894
	Train acc at iteration 5: 0.7788461538461539
	Val acc at iteration 4: 0.7021276595744681
	Train acc at iteration 6: 0.7868589743589743
	Val acc at iteration 5: 0.7872340425531915
	Train acc at iteration 7: 0.780448717948718
	Val acc at iteration 6: 0.648936170212766
	Train acc at iteration 8: 0.7900641025641025
	Val acc at iteration 7: 0.6808510638297872
	Train acc at iteration 9: 0.7964743589743589
	Val acc at iteration 8: 0.6702127659574468
	Train acc at iteration 10: 0.7772435897435898
	Val acc at iteration 9: 0.6382978723404256
	Train acc at iteration 11: 0.7772435897435898
	Val acc at iteration 10: 0.6914893617021277
	Train acc at iteration 12: 0.7772435897435898
	Val acc at iteration 11: 0.7021276595744681
	Train acc at iteration 13: 0.7772435897435898
	Val acc at iteration 12: 0.723404255319149
	Train acc at iteration 14: 0.7580128205128205
	Val acc at iteration 13: 0.6276595744680851
	Train acc at iteration 15: 0.7932692307692307
	Val acc at iteration 14: 0.6382978723404256
	Train acc at iteration 16: 0.7660256410256411
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.7692307692307693
	Val acc at iteration 16: 0.7021276595744681
	Train acc at iteration 18: 0.7884615384615384
	Val acc at iteration 17: 0.6276595744680851
	Train acc at iteration 19: 0.7772435897435898
	Val acc at iteration 18: 0.6914893617021277
	Train acc at iteration 20: 0.7788461538461539
	Val acc at iteration 19: 0.6702127659574468
	Train acc at iteration 21: 0.8012820512820513
	Val acc at iteration 20: 0.6702127659574468
	Train acc at iteration 22: 0.7692307692307693
	Val acc at iteration 21: 0.6914893617021277
	Train acc at iteration 23: 0.7900641025641025
	Val acc at iteration 22: 0.6276595744680851
	Train acc at iteration 24: 0.8253205128205128
	Val acc at iteration 23: 0.648936170212766
	Train acc at iteration 25: 0.8092948717948718
	Val acc at iteration 24: 0.7021276595744681
	Train acc at iteration 26: 0.7916666666666666
	Val acc at iteration 25: 0.7021276595744681
	Train acc at iteration 27: 0.7836538461538461
	Val acc at iteration 26: 0.648936170212766
	Train acc at iteration 28: 0.780448717948718
	Val acc at iteration 27: 0.6170212765957447
	Train acc at iteration 29: 0.7692307692307693
	Val acc at iteration 28: 0.6595744680851063
	Train acc at iteration 30: 0.7964743589743589
	Val acc at iteration 29: 0.5851063829787234
	Train acc at iteration 31: 0.7692307692307693
	Val acc at iteration 30: 0.723404255319149
	Train acc at iteration 32: 0.782051282051282
	Val acc at iteration 31: 0.7127659574468085
	Train acc at iteration 33: 0.8012820512820513
	Val acc at iteration 32: 0.6808510638297872
	Train acc at iteration 34: 0.7660256410256411
	Val acc at iteration 33: 0.6276595744680851
	Train acc at iteration 35: 0.7788461538461539
	Val acc at iteration 34: 0.6914893617021277
	Train acc at iteration 36: 0.7660256410256411
	Val acc at iteration 35: 0.6808510638297872
	Train acc at iteration 37: 0.7467948717948718
	Val acc at iteration 36: 0.6914893617021277
	Train acc at iteration 38: 0.8076923076923077
	Val acc at iteration 37: 0.648936170212766
	Train acc at iteration 39: 0.7932692307692307
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.7932692307692307
	Val acc at iteration 39: 0.6276595744680851
	Train acc at iteration 41: 0.7772435897435898
	Val acc at iteration 40: 0.6170212765957447
	Train acc at iteration 42: 0.7964743589743589
	Val acc at iteration 41: 0.6595744680851063
	Train acc at iteration 43: 0.780448717948718
	Val acc at iteration 42: 0.6276595744680851
	Train acc at iteration 44: 0.7996794871794872
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.7692307692307693
	Val acc at iteration 44: 0.7340425531914894
	Train acc at iteration 46: 0.7932692307692307
	Val acc at iteration 45: 0.6063829787234043
	Train acc at iteration 47: 0.7467948717948718
	Val acc at iteration 46: 0.723404255319149
	Train acc at iteration 48: 0.8108974358974359
	Val acc at iteration 47: 0.7127659574468085
	Train acc at iteration 49: 0.7996794871794872
	Val acc at iteration 48: 0.7127659574468085
	Train acc at iteration 50: 0.7692307692307693
	Val acc at iteration 49: 0.6808510638297872
	Train acc at iteration 51: 0.7596153846153846
	Val acc at iteration 50: 0.6808510638297872
	Train acc at iteration 52: 0.7836538461538461
	Val acc at iteration 51: 0.6702127659574468
	Train acc at iteration 53: 0.75
	Val acc at iteration 52: 0.7127659574468085
	Train acc at iteration 54: 0.7740384615384616
	Val acc at iteration 53: 0.6702127659574468
	Train acc at iteration 55: 0.780448717948718
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.7451923076923077
	Val acc at iteration 55: 0.7127659574468085
	Train acc at iteration 57: 0.7852564102564102
	Val acc at iteration 56: 0.6702127659574468
	Train acc at iteration 58: 0.7836538461538461
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.7644230769230769
	Val acc at iteration 58: 0.648936170212766
	Train acc at iteration 60: 0.7724358974358975
	Val acc at iteration 59: 0.6276595744680851
	Train acc at iteration 61: 0.7660256410256411
	Val acc at iteration 60: 0.7340425531914894
	Train acc at iteration 62: 0.7868589743589743
	Val acc at iteration 61: 0.6702127659574468
	Train acc at iteration 63: 0.7708333333333334
	Val acc at iteration 62: 0.6914893617021277
	Train acc at iteration 64: 0.780448717948718
	Val acc at iteration 63: 0.6595744680851063
	Train acc at iteration 65: 0.7403846153846154
	Val acc at iteration 64: 0.6382978723404256
	Train acc at iteration 66: 0.7852564102564102
	Val acc at iteration 65: 0.6595744680851063
	Train acc at iteration 67: 0.7483974358974359
	Val acc at iteration 66: 0.6382978723404256
	Train acc at iteration 68: 0.8012820512820513
	Val acc at iteration 67: 0.6595744680851063
	Train acc at iteration 69: 0.7948717948717948
	Val acc at iteration 68: 0.6808510638297872
	Train acc at iteration 70: 0.8173076923076923
	Val acc at iteration 69: 0.6276595744680851
	Train acc at iteration 71: 0.8028846153846154
	Val acc at iteration 70: 0.6170212765957447
	Train acc at iteration 72: 0.7580128205128205
	Val acc at iteration 71: 0.6808510638297872
	Train acc at iteration 73: 0.7964743589743589
	Val acc at iteration 72: 0.6382978723404256
	Train acc at iteration 74: 0.7660256410256411
	Val acc at iteration 73: 0.6808510638297872
	Train acc at iteration 75: 0.7740384615384616
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.8125
	Val acc at iteration 75: 0.7021276595744681
	Train acc at iteration 77: 0.8012820512820513
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.7628205128205128
	Val acc at iteration 77: 0.6595744680851063
	Train acc at iteration 79: 0.782051282051282
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.7660256410256411
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.7932692307692307
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.7980769230769231
	Val acc at iteration 81: 0.7340425531914894
	Train acc at iteration 83: 0.7788461538461539
	Val acc at iteration 82: 0.6702127659574468
	Train acc at iteration 84: 0.7852564102564102
	Val acc at iteration 83: 0.7127659574468085
	Train acc at iteration 85: 0.780448717948718
	Val acc at iteration 84: 0.7340425531914894
	Train acc at iteration 86: 0.8012820512820513
	Val acc at iteration 85: 0.6808510638297872
	Train acc at iteration 87: 0.7644230769230769
	Val acc at iteration 86: 0.6808510638297872
	Train acc at iteration 88: 0.7788461538461539
	Val acc at iteration 87: 0.6595744680851063
	Train acc at iteration 89: 0.7756410256410257
	Val acc at iteration 88: 0.6914893617021277
	Train acc at iteration 90: 0.8092948717948718
	Val acc at iteration 89: 0.776595744680851
	Train acc at iteration 91: 0.7916666666666666
	Val acc at iteration 90: 0.7127659574468085
	Train acc at iteration 92: 0.7980769230769231
	Val acc at iteration 91: 0.6276595744680851
	Train acc at iteration 93: 0.7948717948717948
	Val acc at iteration 92: 0.6808510638297872
	Train acc at iteration 94: 0.7724358974358975
	Val acc at iteration 93: 0.7340425531914894
	Train acc at iteration 95: 0.782051282051282
	Val acc at iteration 94: 0.6808510638297872
	Train acc at iteration 96: 0.7708333333333334
	Val acc at iteration 95: 0.6595744680851063
	Train acc at iteration 97: 0.782051282051282
	Val acc at iteration 96: 0.6595744680851063
	Train acc at iteration 98: 0.7916666666666666
	Val acc at iteration 97: 0.6382978723404256
	Train acc at iteration 99: 0.7676282051282052
	Val acc at iteration 98: 0.7340425531914894
	Train acc at iteration 100: 0.8060897435897436
	Val acc at iteration 99: 0.6702127659574468
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5295918367346939
Final val micro accuracy: 0.6382978723404256
Final test macro f1-score: 0.48709677419354835
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.6174956560134888
	Separation: 0.5446677207946777
Final test:
	Cluster: 0.5936547517776489
	Separation: 0.5474127531051636
Saved Results

Attempting combination 3/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 24.0
l1_weight: 0.01
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.23404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5425531914893617
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6170212765957447
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9574468085106383
Push epoch
After push, before retraining last layer:
	Train acc: 0.7884615384615384
	Cluster: 0.652830982208252
	Separation: 0.5209697723388672
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.5851063829787234
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.7659574468085106
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.5957446808510638
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6063829787234043
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.5957446808510638
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.5957446808510638
	Val acc at iteration 38: 0.6276595744680851
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.574468085106383
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.5851063829787234
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.7978723404255319
	Val acc at iteration 49: 0.648936170212766
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.6170212765957447
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.648936170212766
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.8191489361702128
	Val acc at iteration 64: 0.6063829787234043
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.574468085106383
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.648936170212766
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6170212765957447
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.6595744680851063
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.6808510638297872
	Val acc at iteration 87: 0.6382978723404256
	Val acc at iteration 88: 0.6170212765957447
	Val acc at iteration 89: 0.6702127659574468
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.7553191489361702
	Val acc at iteration 92: 0.6595744680851063
	Val acc at iteration 93: 0.648936170212766
	Val acc at iteration 94: 0.7021276595744681
	Val acc at iteration 95: 0.723404255319149
	Val acc at iteration 96: 0.7446808510638298
	Val acc at iteration 97: 0.5957446808510638
	Val acc at iteration 98: 0.6914893617021277
	Val acc at iteration 99: 0.7446808510638298
Val acc before epoch 16: 0.6276595744680851
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7659574468085106
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Cluster: 0.6493101239204406
	Separation: 0.5186562418937684
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6063829787234043
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.5851063829787234
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6063829787234043
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.6382978723404256
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.5851063829787234
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.6063829787234043
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.6276595744680851
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.6276595744680851
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.6595744680851063
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.6063829787234043
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.6382978723404256
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.7021276595744681
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.723404255319149
	Val acc at iteration 87: 0.6914893617021277
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.6702127659574468
	Val acc at iteration 90: 0.6276595744680851
	Val acc at iteration 91: 0.7127659574468085
	Val acc at iteration 92: 0.6808510638297872
	Val acc at iteration 93: 0.648936170212766
	Val acc at iteration 94: 0.648936170212766
	Val acc at iteration 95: 0.6914893617021277
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.6170212765957447
	Val acc at iteration 98: 0.6914893617021277
	Val acc at iteration 99: 0.7872340425531915
Val acc before epoch 26: 0.648936170212766
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7446808510638298
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9042553191489362
Stopping after epoch 36.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Cluster: 0.6431253790855408
	Separation: 0.5177149534225464
(After push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7660256410256411
	Val acc at iteration 0: 0.7553191489361702
	Train acc at iteration 2: 0.8060897435897436
	Val acc at iteration 1: 0.6382978723404256
	Train acc at iteration 3: 0.7884615384615384
	Val acc at iteration 2: 0.6702127659574468
	Train acc at iteration 4: 0.8044871794871795
	Val acc at iteration 3: 0.6808510638297872
	Train acc at iteration 5: 0.8012820512820513
	Val acc at iteration 4: 0.6914893617021277
	Train acc at iteration 6: 0.8076923076923077
	Val acc at iteration 5: 0.648936170212766
	Train acc at iteration 7: 0.7868589743589743
	Val acc at iteration 6: 0.723404255319149
	Train acc at iteration 8: 0.782051282051282
	Val acc at iteration 7: 0.7021276595744681
	Train acc at iteration 9: 0.7676282051282052
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8028846153846154
	Val acc at iteration 9: 0.7659574468085106
	Train acc at iteration 11: 0.7948717948717948
	Val acc at iteration 10: 0.6702127659574468
	Train acc at iteration 12: 0.8237179487179487
	Val acc at iteration 11: 0.7021276595744681
	Train acc at iteration 13: 0.7788461538461539
	Val acc at iteration 12: 0.7340425531914894
	Train acc at iteration 14: 0.7884615384615384
	Val acc at iteration 13: 0.5531914893617021
	Train acc at iteration 15: 0.8012820512820513
	Val acc at iteration 14: 0.6702127659574468
	Train acc at iteration 16: 0.7996794871794872
	Val acc at iteration 15: 0.7127659574468085
	Train acc at iteration 17: 0.7932692307692307
	Val acc at iteration 16: 0.6595744680851063
	Train acc at iteration 18: 0.7900641025641025
	Val acc at iteration 17: 0.6595744680851063
	Train acc at iteration 19: 0.7900641025641025
	Val acc at iteration 18: 0.7127659574468085
	Train acc at iteration 20: 0.8028846153846154
	Val acc at iteration 19: 0.6063829787234043
	Train acc at iteration 21: 0.7836538461538461
	Val acc at iteration 20: 0.6702127659574468
	Train acc at iteration 22: 0.7884615384615384
	Val acc at iteration 21: 0.6595744680851063
	Train acc at iteration 23: 0.7676282051282052
	Val acc at iteration 22: 0.5851063829787234
	Train acc at iteration 24: 0.7836538461538461
	Val acc at iteration 23: 0.7446808510638298
	Train acc at iteration 25: 0.7980769230769231
	Val acc at iteration 24: 0.6914893617021277
	Train acc at iteration 26: 0.7836538461538461
	Val acc at iteration 25: 0.6276595744680851
	Train acc at iteration 27: 0.8237179487179487
	Val acc at iteration 26: 0.7446808510638298
	Train acc at iteration 28: 0.8044871794871795
	Val acc at iteration 27: 0.6808510638297872
	Train acc at iteration 29: 0.780448717948718
	Val acc at iteration 28: 0.6170212765957447
	Train acc at iteration 30: 0.8044871794871795
	Val acc at iteration 29: 0.5957446808510638
	Train acc at iteration 31: 0.7724358974358975
	Val acc at iteration 30: 0.6382978723404256
	Train acc at iteration 32: 0.8028846153846154
	Val acc at iteration 31: 0.6595744680851063
	Train acc at iteration 33: 0.8028846153846154
	Val acc at iteration 32: 0.7446808510638298
	Train acc at iteration 34: 0.7772435897435898
	Val acc at iteration 33: 0.6382978723404256
	Train acc at iteration 35: 0.8237179487179487
	Val acc at iteration 34: 0.6702127659574468
	Train acc at iteration 36: 0.8125
	Val acc at iteration 35: 0.723404255319149
	Train acc at iteration 37: 0.8125
	Val acc at iteration 36: 0.6170212765957447
	Train acc at iteration 38: 0.8125
	Val acc at iteration 37: 0.6914893617021277
	Train acc at iteration 39: 0.8125
	Val acc at iteration 38: 0.7127659574468085
	Train acc at iteration 40: 0.7852564102564102
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.8028846153846154
	Val acc at iteration 40: 0.5957446808510638
	Train acc at iteration 42: 0.7788461538461539
	Val acc at iteration 41: 0.723404255319149
	Train acc at iteration 43: 0.8108974358974359
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.8141025641025641
	Val acc at iteration 43: 0.6595744680851063
	Train acc at iteration 45: 0.8076923076923077
	Val acc at iteration 44: 0.648936170212766
	Train acc at iteration 46: 0.7644230769230769
	Val acc at iteration 45: 0.6808510638297872
	Train acc at iteration 47: 0.8173076923076923
	Val acc at iteration 46: 0.648936170212766
	Train acc at iteration 48: 0.7724358974358975
	Val acc at iteration 47: 0.7021276595744681
	Train acc at iteration 49: 0.8012820512820513
	Val acc at iteration 48: 0.7659574468085106
	Train acc at iteration 50: 0.780448717948718
	Val acc at iteration 49: 0.8085106382978723
	Train acc at iteration 51: 0.7788461538461539
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.7964743589743589
	Val acc at iteration 51: 0.6914893617021277
	Train acc at iteration 53: 0.7916666666666666
	Val acc at iteration 52: 0.6382978723404256
	Train acc at iteration 54: 0.8108974358974359
	Val acc at iteration 53: 0.6276595744680851
	Train acc at iteration 55: 0.7980769230769231
	Val acc at iteration 54: 0.723404255319149
	Train acc at iteration 56: 0.7996794871794872
	Val acc at iteration 55: 0.6808510638297872
	Train acc at iteration 57: 0.8076923076923077
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.7756410256410257
	Val acc at iteration 57: 0.6276595744680851
	Train acc at iteration 59: 0.8012820512820513
	Val acc at iteration 58: 0.7872340425531915
	Train acc at iteration 60: 0.7980769230769231
	Val acc at iteration 59: 0.6914893617021277
	Train acc at iteration 61: 0.8012820512820513
	Val acc at iteration 60: 0.6702127659574468
	Train acc at iteration 62: 0.7916666666666666
	Val acc at iteration 61: 0.6595744680851063
	Train acc at iteration 63: 0.7980769230769231
	Val acc at iteration 62: 0.7553191489361702
	Train acc at iteration 64: 0.8060897435897436
	Val acc at iteration 63: 0.6702127659574468
	Train acc at iteration 65: 0.7916666666666666
	Val acc at iteration 64: 0.6595744680851063
	Train acc at iteration 66: 0.7964743589743589
	Val acc at iteration 65: 0.648936170212766
	Train acc at iteration 67: 0.782051282051282
	Val acc at iteration 66: 0.648936170212766
	Train acc at iteration 68: 0.7884615384615384
	Val acc at iteration 67: 0.6382978723404256
	Train acc at iteration 69: 0.8125
	Val acc at iteration 68: 0.7553191489361702
	Train acc at iteration 70: 0.8012820512820513
	Val acc at iteration 69: 0.6808510638297872
	Train acc at iteration 71: 0.8012820512820513
	Val acc at iteration 70: 0.6595744680851063
	Train acc at iteration 72: 0.7884615384615384
	Val acc at iteration 71: 0.6808510638297872
	Train acc at iteration 73: 0.7980769230769231
	Val acc at iteration 72: 0.7021276595744681
	Train acc at iteration 74: 0.7996794871794872
	Val acc at iteration 73: 0.7021276595744681
	Train acc at iteration 75: 0.7724358974358975
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.7884615384615384
	Val acc at iteration 75: 0.7659574468085106
	Train acc at iteration 77: 0.7788461538461539
	Val acc at iteration 76: 0.574468085106383
	Train acc at iteration 78: 0.7884615384615384
	Val acc at iteration 77: 0.648936170212766
	Train acc at iteration 79: 0.7948717948717948
	Val acc at iteration 78: 0.648936170212766
	Train acc at iteration 80: 0.7756410256410257
	Val acc at iteration 79: 0.6808510638297872
	Train acc at iteration 81: 0.7900641025641025
	Val acc at iteration 80: 0.7127659574468085
	Train acc at iteration 82: 0.7932692307692307
	Val acc at iteration 81: 0.6702127659574468
	Train acc at iteration 83: 0.7836538461538461
	Val acc at iteration 82: 0.6808510638297872
	Train acc at iteration 84: 0.7836538461538461
	Val acc at iteration 83: 0.6595744680851063
	Train acc at iteration 85: 0.7692307692307693
	Val acc at iteration 84: 0.6382978723404256
	Train acc at iteration 86: 0.7884615384615384
	Val acc at iteration 85: 0.7659574468085106
	Train acc at iteration 87: 0.7612179487179487
	Val acc at iteration 86: 0.6595744680851063
	Train acc at iteration 88: 0.7964743589743589
	Val acc at iteration 87: 0.6170212765957447
	Train acc at iteration 89: 0.8237179487179487
	Val acc at iteration 88: 0.6808510638297872
	Train acc at iteration 90: 0.7676282051282052
	Val acc at iteration 89: 0.6595744680851063
	Train acc at iteration 91: 0.7916666666666666
	Val acc at iteration 90: 0.6702127659574468
	Train acc at iteration 92: 0.7900641025641025
	Val acc at iteration 91: 0.6382978723404256
	Train acc at iteration 93: 0.7884615384615384
	Val acc at iteration 92: 0.648936170212766
	Train acc at iteration 94: 0.7836538461538461
	Val acc at iteration 93: 0.6808510638297872
	Train acc at iteration 95: 0.7964743589743589
	Val acc at iteration 94: 0.648936170212766
	Train acc at iteration 96: 0.7980769230769231
	Val acc at iteration 95: 0.6595744680851063
	Train acc at iteration 97: 0.782051282051282
	Val acc at iteration 96: 0.6276595744680851
	Train acc at iteration 98: 0.7772435897435898
	Val acc at iteration 97: 0.7021276595744681
	Train acc at iteration 99: 0.8012820512820513
	Val acc at iteration 98: 0.6595744680851063
	Train acc at iteration 100: 0.7916666666666666
	Val acc at iteration 99: 0.6914893617021277
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5281786941580756
Final val micro accuracy: 0.6382978723404256
Final test macro f1-score: 0.47
Final test micro accuracy: 0.574468085106383
Final validation:
	Cluster: 0.6328459978103638
	Separation: 0.5431037545204163
Final test:
	Cluster: 0.6021413505077362
	Separation: 0.5405698418617249
Saved Results

Attempting combination 4/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 24.0
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Cluster: 0.6449756145477294
	Separation: 0.5226052284240723
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.5638297872340425
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.648936170212766
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6063829787234043
	Val acc at iteration 11: 0.574468085106383
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6276595744680851
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.6170212765957447
	Val acc at iteration 16: 0.6063829787234043
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.5957446808510638
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.6276595744680851
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.6063829787234043
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.5957446808510638
	Val acc at iteration 34: 0.6276595744680851
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.5851063829787234
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.5851063829787234
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6276595744680851
	Val acc at iteration 47: 0.574468085106383
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.648936170212766
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.6382978723404256
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.6276595744680851
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.6276595744680851
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.6063829787234043
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.6595744680851063
	Val acc at iteration 85: 0.7127659574468085
	Val acc at iteration 86: 0.6702127659574468
	Val acc at iteration 87: 0.648936170212766
	Val acc at iteration 88: 0.7127659574468085
	Val acc at iteration 89: 0.5851063829787234
	Val acc at iteration 90: 0.7021276595744681
	Val acc at iteration 91: 0.6276595744680851
	Val acc at iteration 92: 0.6702127659574468
	Val acc at iteration 93: 0.6382978723404256
	Val acc at iteration 94: 0.6063829787234043
	Val acc at iteration 95: 0.648936170212766
	Val acc at iteration 96: 0.6914893617021277
	Val acc at iteration 97: 0.6382978723404256
	Val acc at iteration 98: 0.5957446808510638
	Val acc at iteration 99: 0.7340425531914894
Val acc before epoch 16: 0.6914893617021277
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8191489361702128
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Cluster: 0.6554206490516663
	Separation: 0.5199587941169739
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.7446808510638298
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.776595744680851
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.7872340425531915
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.6063829787234043
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.6170212765957447
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.776595744680851
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.6276595744680851
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.5957446808510638
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.574468085106383
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.6170212765957447
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.574468085106383
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.6382978723404256
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.6276595744680851
	Val acc at iteration 85: 0.6808510638297872
	Val acc at iteration 86: 0.6808510638297872
	Val acc at iteration 87: 0.6595744680851063
	Val acc at iteration 88: 0.648936170212766
	Val acc at iteration 89: 0.7021276595744681
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.7872340425531915
	Val acc at iteration 92: 0.6595744680851063
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.648936170212766
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.7978723404255319
	Val acc at iteration 97: 0.6595744680851063
	Val acc at iteration 98: 0.6702127659574468
	Val acc at iteration 99: 0.7446808510638298
Val acc before epoch 26: 0.5425531914893617
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7553191489361702
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8829787234042553
Stopping after epoch 36.
Final validation accuracy before push: 88.29787234042553%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8269230769230769
	Cluster: 0.6559588193893433
	Separation: 0.5225055694580079
(After push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8189102564102564
	Val acc at iteration 0: 0.723404255319149
	Train acc at iteration 2: 0.8141025641025641
	Val acc at iteration 1: 0.6382978723404256
	Train acc at iteration 3: 0.8028846153846154
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.8125
	Val acc at iteration 3: 0.6808510638297872
	Train acc at iteration 5: 0.8205128205128205
	Val acc at iteration 4: 0.6808510638297872
	Train acc at iteration 6: 0.8092948717948718
	Val acc at iteration 5: 0.648936170212766
	Train acc at iteration 7: 0.8092948717948718
	Val acc at iteration 6: 0.6702127659574468
	Train acc at iteration 8: 0.8253205128205128
	Val acc at iteration 7: 0.7127659574468085
	Train acc at iteration 9: 0.7964743589743589
	Val acc at iteration 8: 0.7127659574468085
	Train acc at iteration 10: 0.8317307692307693
	Val acc at iteration 9: 0.6595744680851063
	Train acc at iteration 11: 0.8028846153846154
	Val acc at iteration 10: 0.6808510638297872
	Train acc at iteration 12: 0.8253205128205128
	Val acc at iteration 11: 0.7446808510638298
	Train acc at iteration 13: 0.8333333333333334
	Val acc at iteration 12: 0.6914893617021277
	Train acc at iteration 14: 0.7900641025641025
	Val acc at iteration 13: 0.6808510638297872
	Train acc at iteration 15: 0.8028846153846154
	Val acc at iteration 14: 0.8085106382978723
	Train acc at iteration 16: 0.8173076923076923
	Val acc at iteration 15: 0.6914893617021277
	Train acc at iteration 17: 0.8092948717948718
	Val acc at iteration 16: 0.6595744680851063
	Train acc at iteration 18: 0.844551282051282
	Val acc at iteration 17: 0.723404255319149
	Train acc at iteration 19: 0.7980769230769231
	Val acc at iteration 18: 0.6914893617021277
	Train acc at iteration 20: 0.8173076923076923
	Val acc at iteration 19: 0.6702127659574468
	Train acc at iteration 21: 0.8269230769230769
	Val acc at iteration 20: 0.6914893617021277
	Train acc at iteration 22: 0.8028846153846154
	Val acc at iteration 21: 0.6914893617021277
	Train acc at iteration 23: 0.7916666666666666
	Val acc at iteration 22: 0.6808510638297872
	Train acc at iteration 24: 0.8108974358974359
	Val acc at iteration 23: 0.6595744680851063
	Train acc at iteration 25: 0.8173076923076923
	Val acc at iteration 24: 0.6595744680851063
	Train acc at iteration 26: 0.8253205128205128
	Val acc at iteration 25: 0.6276595744680851
	Train acc at iteration 27: 0.8141025641025641
	Val acc at iteration 26: 0.6276595744680851
	Train acc at iteration 28: 0.7916666666666666
	Val acc at iteration 27: 0.6595744680851063
	Train acc at iteration 29: 0.844551282051282
	Val acc at iteration 28: 0.6382978723404256
	Train acc at iteration 30: 0.8012820512820513
	Val acc at iteration 29: 0.7446808510638298
	Train acc at iteration 31: 0.8173076923076923
	Val acc at iteration 30: 0.7659574468085106
	Train acc at iteration 32: 0.8141025641025641
	Val acc at iteration 31: 0.6808510638297872
	Train acc at iteration 33: 0.8365384615384616
	Val acc at iteration 32: 0.6382978723404256
	Train acc at iteration 34: 0.8028846153846154
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.842948717948718
	Val acc at iteration 34: 0.7021276595744681
	Train acc at iteration 36: 0.8317307692307693
	Val acc at iteration 35: 0.6808510638297872
	Train acc at iteration 37: 0.8157051282051282
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.8141025641025641
	Val acc at iteration 37: 0.723404255319149
	Train acc at iteration 39: 0.8012820512820513
	Val acc at iteration 38: 0.6702127659574468
	Train acc at iteration 40: 0.8141025641025641
	Val acc at iteration 39: 0.6914893617021277
	Train acc at iteration 41: 0.8108974358974359
	Val acc at iteration 40: 0.7872340425531915
	Train acc at iteration 42: 0.8269230769230769
	Val acc at iteration 41: 0.7127659574468085
	Train acc at iteration 43: 0.8092948717948718
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.8205128205128205
	Val acc at iteration 43: 0.6808510638297872
	Train acc at iteration 45: 0.8221153846153846
	Val acc at iteration 44: 0.6914893617021277
	Train acc at iteration 46: 0.8141025641025641
	Val acc at iteration 45: 0.648936170212766
	Train acc at iteration 47: 0.8092948717948718
	Val acc at iteration 46: 0.7021276595744681
	Train acc at iteration 48: 0.8237179487179487
	Val acc at iteration 47: 0.6702127659574468
	Train acc at iteration 49: 0.7884615384615384
	Val acc at iteration 48: 0.7021276595744681
	Train acc at iteration 50: 0.7996794871794872
	Val acc at iteration 49: 0.6914893617021277
	Train acc at iteration 51: 0.7884615384615384
	Val acc at iteration 50: 0.6382978723404256
	Train acc at iteration 52: 0.8221153846153846
	Val acc at iteration 51: 0.6808510638297872
	Train acc at iteration 53: 0.8125
	Val acc at iteration 52: 0.6808510638297872
	Train acc at iteration 54: 0.7996794871794872
	Val acc at iteration 53: 0.6808510638297872
	Train acc at iteration 55: 0.7900641025641025
	Val acc at iteration 54: 0.648936170212766
	Train acc at iteration 56: 0.8253205128205128
	Val acc at iteration 55: 0.7553191489361702
	Train acc at iteration 57: 0.8237179487179487
	Val acc at iteration 56: 0.7340425531914894
	Train acc at iteration 58: 0.8028846153846154
	Val acc at iteration 57: 0.6595744680851063
	Train acc at iteration 59: 0.7900641025641025
	Val acc at iteration 58: 0.723404255319149
	Train acc at iteration 60: 0.8092948717948718
	Val acc at iteration 59: 0.6595744680851063
	Train acc at iteration 61: 0.782051282051282
	Val acc at iteration 60: 0.6276595744680851
	Train acc at iteration 62: 0.8349358974358975
	Val acc at iteration 61: 0.6063829787234043
	Train acc at iteration 63: 0.8365384615384616
	Val acc at iteration 62: 0.7446808510638298
	Train acc at iteration 64: 0.7900641025641025
	Val acc at iteration 63: 0.6276595744680851
	Train acc at iteration 65: 0.7996794871794872
	Val acc at iteration 64: 0.7021276595744681
	Train acc at iteration 66: 0.7980769230769231
	Val acc at iteration 65: 0.7340425531914894
	Train acc at iteration 67: 0.8108974358974359
	Val acc at iteration 66: 0.7553191489361702
	Train acc at iteration 68: 0.8076923076923077
	Val acc at iteration 67: 0.6808510638297872
	Train acc at iteration 69: 0.8189102564102564
	Val acc at iteration 68: 0.6382978723404256
	Train acc at iteration 70: 0.8125
	Val acc at iteration 69: 0.723404255319149
	Train acc at iteration 71: 0.7948717948717948
	Val acc at iteration 70: 0.6808510638297872
	Train acc at iteration 72: 0.7996794871794872
	Val acc at iteration 71: 0.723404255319149
	Train acc at iteration 73: 0.8285256410256411
	Val acc at iteration 72: 0.7127659574468085
	Train acc at iteration 74: 0.8269230769230769
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.8237179487179487
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.7852564102564102
	Val acc at iteration 75: 0.6808510638297872
	Train acc at iteration 77: 0.8076923076923077
	Val acc at iteration 76: 0.723404255319149
	Train acc at iteration 78: 0.782051282051282
	Val acc at iteration 77: 0.6702127659574468
	Train acc at iteration 79: 0.8285256410256411
	Val acc at iteration 78: 0.6808510638297872
	Train acc at iteration 80: 0.8141025641025641
	Val acc at iteration 79: 0.6702127659574468
	Train acc at iteration 81: 0.7964743589743589
	Val acc at iteration 80: 0.723404255319149
	Train acc at iteration 82: 0.8012820512820513
	Val acc at iteration 81: 0.6595744680851063
	Train acc at iteration 83: 0.8317307692307693
	Val acc at iteration 82: 0.6808510638297872
	Train acc at iteration 84: 0.8012820512820513
	Val acc at iteration 83: 0.6702127659574468
	Train acc at iteration 85: 0.8317307692307693
	Val acc at iteration 84: 0.648936170212766
	Train acc at iteration 86: 0.8349358974358975
	Val acc at iteration 85: 0.7021276595744681
	Train acc at iteration 87: 0.8044871794871795
	Val acc at iteration 86: 0.6382978723404256
	Train acc at iteration 88: 0.8301282051282052
	Val acc at iteration 87: 0.7127659574468085
	Train acc at iteration 89: 0.8269230769230769
	Val acc at iteration 88: 0.6808510638297872
	Train acc at iteration 90: 0.8044871794871795
	Val acc at iteration 89: 0.6914893617021277
	Train acc at iteration 91: 0.8108974358974359
	Val acc at iteration 90: 0.7446808510638298
	Train acc at iteration 92: 0.8205128205128205
	Val acc at iteration 91: 0.6702127659574468
	Train acc at iteration 93: 0.8333333333333334
	Val acc at iteration 92: 0.648936170212766
	Train acc at iteration 94: 0.8141025641025641
	Val acc at iteration 93: 0.7021276595744681
	Train acc at iteration 95: 0.842948717948718
	Val acc at iteration 94: 0.7340425531914894
	Train acc at iteration 96: 0.8221153846153846
	Val acc at iteration 95: 0.6595744680851063
	Train acc at iteration 97: 0.8125
	Val acc at iteration 96: 0.776595744680851
	Train acc at iteration 98: 0.7900641025641025
	Val acc at iteration 97: 0.5957446808510638
	Train acc at iteration 99: 0.8060897435897436
	Val acc at iteration 98: 0.6595744680851063
	Train acc at iteration 100: 0.8076923076923077
	Val acc at iteration 99: 0.648936170212766
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.661512027491409
Final val micro accuracy: 0.7446808510638298
Final test macro f1-score: 0.47575757575757566
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.6219795942306519
	Separation: 0.5473749339580536
Final test:
	Cluster: 0.6043593287467957
	Separation: 0.5361785292625427
Saved Results

Attempting combination 5/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 2.4
l1_weight: 10
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5957446808510638
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7446808510638298
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8237179487179487
	Cluster: 0.6503179192543029
	Separation: 0.5202365279197693
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.776595744680851
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.7553191489361702
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.776595744680851
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.7553191489361702
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.6276595744680851
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.776595744680851
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.7340425531914894
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.5957446808510638
	Val acc at iteration 50: 0.5957446808510638
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.7659574468085106
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.648936170212766
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.6170212765957447
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.7659574468085106
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.8191489361702128
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.6170212765957447
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.6382978723404256
	Val acc at iteration 79: 0.6170212765957447
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.723404255319149
	Val acc at iteration 85: 0.723404255319149
	Val acc at iteration 86: 0.723404255319149
	Val acc at iteration 87: 0.6382978723404256
	Val acc at iteration 88: 0.648936170212766
	Val acc at iteration 89: 0.6170212765957447
	Val acc at iteration 90: 0.6382978723404256
	Val acc at iteration 91: 0.6914893617021277
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.7127659574468085
	Val acc at iteration 94: 0.723404255319149
	Val acc at iteration 95: 0.6170212765957447
	Val acc at iteration 96: 0.6382978723404256
	Val acc at iteration 97: 0.723404255319149
	Val acc at iteration 98: 0.7021276595744681
	Val acc at iteration 99: 0.7340425531914894
Val acc before epoch 16: 0.723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Cluster: 0.6489697575569153
	Separation: 0.5202946186065673
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.7553191489361702
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.7446808510638298
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.7659574468085106
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.5851063829787234
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.6063829787234043
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.6276595744680851
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.723404255319149
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.723404255319149
	Val acc at iteration 87: 0.7021276595744681
	Val acc at iteration 88: 0.6063829787234043
	Val acc at iteration 89: 0.7340425531914894
	Val acc at iteration 90: 0.723404255319149
	Val acc at iteration 91: 0.723404255319149
	Val acc at iteration 92: 0.6276595744680851
	Val acc at iteration 93: 0.6808510638297872
	Val acc at iteration 94: 0.7021276595744681
	Val acc at iteration 95: 0.723404255319149
	Val acc at iteration 96: 0.6702127659574468
	Val acc at iteration 97: 0.7021276595744681
	Val acc at iteration 98: 0.6914893617021277
	Val acc at iteration 99: 0.7021276595744681
Val acc before epoch 26: 0.7553191489361702
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7340425531914894
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8404255319148937
Stopping after epoch 36.
Final validation accuracy before push: 84.04255319148936%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7756410256410257
	Cluster: 0.6460459470748902
	Separation: 0.5189318895339966
(After push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8237179487179487
	Val acc at iteration 0: 0.6702127659574468
	Train acc at iteration 2: 0.7884615384615384
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.8125
	Val acc at iteration 2: 0.5957446808510638
	Train acc at iteration 4: 0.8028846153846154
	Val acc at iteration 3: 0.6808510638297872
	Train acc at iteration 5: 0.8125
	Val acc at iteration 4: 0.6595744680851063
	Train acc at iteration 6: 0.7852564102564102
	Val acc at iteration 5: 0.6276595744680851
	Train acc at iteration 7: 0.7980769230769231
	Val acc at iteration 6: 0.723404255319149
	Train acc at iteration 8: 0.7740384615384616
	Val acc at iteration 7: 0.6702127659574468
	Train acc at iteration 9: 0.7964743589743589
	Val acc at iteration 8: 0.6808510638297872
	Train acc at iteration 10: 0.8221153846153846
	Val acc at iteration 9: 0.6914893617021277
	Train acc at iteration 11: 0.7788461538461539
	Val acc at iteration 10: 0.6382978723404256
	Train acc at iteration 12: 0.8157051282051282
	Val acc at iteration 11: 0.723404255319149
	Train acc at iteration 13: 0.7964743589743589
	Val acc at iteration 12: 0.723404255319149
	Train acc at iteration 14: 0.7996794871794872
	Val acc at iteration 13: 0.6702127659574468
	Train acc at iteration 15: 0.8092948717948718
	Val acc at iteration 14: 0.6808510638297872
	Train acc at iteration 16: 0.8012820512820513
	Val acc at iteration 15: 0.7446808510638298
	Train acc at iteration 17: 0.8076923076923077
	Val acc at iteration 16: 0.7446808510638298
	Train acc at iteration 18: 0.7996794871794872
	Val acc at iteration 17: 0.6808510638297872
	Train acc at iteration 19: 0.8269230769230769
	Val acc at iteration 18: 0.7127659574468085
	Train acc at iteration 20: 0.8028846153846154
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.8028846153846154
	Val acc at iteration 20: 0.723404255319149
	Train acc at iteration 22: 0.8060897435897436
	Val acc at iteration 21: 0.7659574468085106
	Train acc at iteration 23: 0.8108974358974359
	Val acc at iteration 22: 0.7127659574468085
	Train acc at iteration 24: 0.8108974358974359
	Val acc at iteration 23: 0.6808510638297872
	Train acc at iteration 25: 0.7996794871794872
	Val acc at iteration 24: 0.7127659574468085
	Train acc at iteration 26: 0.8365384615384616
	Val acc at iteration 25: 0.723404255319149
	Train acc at iteration 27: 0.782051282051282
	Val acc at iteration 26: 0.6808510638297872
	Train acc at iteration 28: 0.7852564102564102
	Val acc at iteration 27: 0.7021276595744681
	Train acc at iteration 29: 0.7996794871794872
	Val acc at iteration 28: 0.7127659574468085
	Train acc at iteration 30: 0.8141025641025641
	Val acc at iteration 29: 0.6702127659574468
	Train acc at iteration 31: 0.7788461538461539
	Val acc at iteration 30: 0.7021276595744681
	Train acc at iteration 32: 0.7948717948717948
	Val acc at iteration 31: 0.7127659574468085
	Train acc at iteration 33: 0.7900641025641025
	Val acc at iteration 32: 0.648936170212766
	Train acc at iteration 34: 0.7932692307692307
	Val acc at iteration 33: 0.6702127659574468
	Train acc at iteration 35: 0.7628205128205128
	Val acc at iteration 34: 0.6276595744680851
	Train acc at iteration 36: 0.7868589743589743
	Val acc at iteration 35: 0.6702127659574468
	Train acc at iteration 37: 0.8253205128205128
	Val acc at iteration 36: 0.7553191489361702
	Train acc at iteration 38: 0.8237179487179487
	Val acc at iteration 37: 0.7659574468085106
	Train acc at iteration 39: 0.8125
	Val acc at iteration 38: 0.6914893617021277
	Train acc at iteration 40: 0.8092948717948718
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.8125
	Val acc at iteration 40: 0.7446808510638298
	Train acc at iteration 42: 0.7900641025641025
	Val acc at iteration 41: 0.723404255319149
	Train acc at iteration 43: 0.8076923076923077
	Val acc at iteration 42: 0.7127659574468085
	Train acc at iteration 44: 0.7996794871794872
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.8092948717948718
	Val acc at iteration 44: 0.7553191489361702
	Train acc at iteration 46: 0.7708333333333334
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.7980769230769231
	Val acc at iteration 46: 0.648936170212766
	Train acc at iteration 48: 0.8028846153846154
	Val acc at iteration 47: 0.6914893617021277
	Train acc at iteration 49: 0.8076923076923077
	Val acc at iteration 48: 0.6595744680851063
	Train acc at iteration 50: 0.7708333333333334
	Val acc at iteration 49: 0.648936170212766
	Train acc at iteration 51: 0.7916666666666666
	Val acc at iteration 50: 0.7127659574468085
	Train acc at iteration 52: 0.7740384615384616
	Val acc at iteration 51: 0.723404255319149
	Train acc at iteration 53: 0.8141025641025641
	Val acc at iteration 52: 0.6914893617021277
	Train acc at iteration 54: 0.7916666666666666
	Val acc at iteration 53: 0.7340425531914894
	Train acc at iteration 55: 0.8141025641025641
	Val acc at iteration 54: 0.6808510638297872
	Train acc at iteration 56: 0.782051282051282
	Val acc at iteration 55: 0.6276595744680851
	Train acc at iteration 57: 0.8028846153846154
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.782051282051282
	Val acc at iteration 57: 0.7340425531914894
	Train acc at iteration 59: 0.8125
	Val acc at iteration 58: 0.7446808510638298
	Train acc at iteration 60: 0.780448717948718
	Val acc at iteration 59: 0.723404255319149
	Train acc at iteration 61: 0.7996794871794872
	Val acc at iteration 60: 0.7127659574468085
	Train acc at iteration 62: 0.7980769230769231
	Val acc at iteration 61: 0.776595744680851
	Train acc at iteration 63: 0.7740384615384616
	Val acc at iteration 62: 0.723404255319149
	Train acc at iteration 64: 0.7836538461538461
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.8108974358974359
	Val acc at iteration 64: 0.7127659574468085
	Train acc at iteration 66: 0.7740384615384616
	Val acc at iteration 65: 0.6595744680851063
	Train acc at iteration 67: 0.8141025641025641
	Val acc at iteration 66: 0.7021276595744681
	Train acc at iteration 68: 0.8173076923076923
	Val acc at iteration 67: 0.648936170212766
	Train acc at iteration 69: 0.7948717948717948
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.7996794871794872
	Val acc at iteration 69: 0.6914893617021277
	Train acc at iteration 71: 0.7756410256410257
	Val acc at iteration 70: 0.723404255319149
	Train acc at iteration 72: 0.7884615384615384
	Val acc at iteration 71: 0.7446808510638298
	Train acc at iteration 73: 0.7916666666666666
	Val acc at iteration 72: 0.7340425531914894
	Train acc at iteration 74: 0.7948717948717948
	Val acc at iteration 73: 0.7021276595744681
	Train acc at iteration 75: 0.7964743589743589
	Val acc at iteration 74: 0.776595744680851
	Train acc at iteration 76: 0.8012820512820513
	Val acc at iteration 75: 0.7659574468085106
	Train acc at iteration 77: 0.8076923076923077
	Val acc at iteration 76: 0.6808510638297872
	Train acc at iteration 78: 0.8141025641025641
	Val acc at iteration 77: 0.7127659574468085
	Train acc at iteration 79: 0.8044871794871795
	Val acc at iteration 78: 0.6276595744680851
	Train acc at iteration 80: 0.7932692307692307
	Val acc at iteration 79: 0.7553191489361702
	Train acc at iteration 81: 0.7676282051282052
	Val acc at iteration 80: 0.723404255319149
	Train acc at iteration 82: 0.7868589743589743
	Val acc at iteration 81: 0.7340425531914894
	Train acc at iteration 83: 0.8028846153846154
	Val acc at iteration 82: 0.7446808510638298
	Train acc at iteration 84: 0.8076923076923077
	Val acc at iteration 83: 0.6914893617021277
	Train acc at iteration 85: 0.8060897435897436
	Val acc at iteration 84: 0.6276595744680851
	Train acc at iteration 86: 0.7996794871794872
	Val acc at iteration 85: 0.7127659574468085
	Train acc at iteration 87: 0.8076923076923077
	Val acc at iteration 86: 0.6276595744680851
	Train acc at iteration 88: 0.8125
	Val acc at iteration 87: 0.7446808510638298
	Train acc at iteration 89: 0.7900641025641025
	Val acc at iteration 88: 0.7978723404255319
	Train acc at iteration 90: 0.7996794871794872
	Val acc at iteration 89: 0.6276595744680851
	Train acc at iteration 91: 0.7964743589743589
	Val acc at iteration 90: 0.7553191489361702
	Train acc at iteration 92: 0.8044871794871795
	Val acc at iteration 91: 0.7021276595744681
	Train acc at iteration 93: 0.7916666666666666
	Val acc at iteration 92: 0.723404255319149
	Train acc at iteration 94: 0.7948717948717948
	Val acc at iteration 93: 0.723404255319149
	Train acc at iteration 95: 0.7980769230769231
	Val acc at iteration 94: 0.7127659574468085
	Train acc at iteration 96: 0.8141025641025641
	Val acc at iteration 95: 0.648936170212766
	Train acc at iteration 97: 0.7900641025641025
	Val acc at iteration 96: 0.6808510638297872
	Train acc at iteration 98: 0.8028846153846154
	Val acc at iteration 97: 0.776595744680851
	Train acc at iteration 99: 0.7964743589743589
	Val acc at iteration 98: 0.7021276595744681
	Train acc at iteration 100: 0.8012820512820513
	Val acc at iteration 99: 0.7553191489361702
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5976430976430976
Final val micro accuracy: 0.7021276595744681
Final test macro f1-score: 0.5277777777777778
Final test micro accuracy: 0.6595744680851063
Final validation:
	Cluster: 0.6170582473278046
	Separation: 0.5358913540840149
Final test:
	Cluster: 0.6208031177520752
	Separation: 0.5454475581645966
Saved Results

Attempting combination 6/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 2.4
l1_weight: 1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.2872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.4787234042553192
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6808510638297872
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7021276595744681
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.7340425531914894
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.7340425531914894
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.7978723404255319
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Cluster: 0.6421201467514038
	Separation: 0.5176990747451782
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.5638297872340425
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.574468085106383
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6063829787234043
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.574468085106383
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.5851063829787234
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.6276595744680851
	Val acc at iteration 36: 0.6063829787234043
	Val acc at iteration 37: 0.574468085106383
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.6170212765957447
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.574468085106383
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.574468085106383
	Val acc at iteration 51: 0.6170212765957447
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.574468085106383
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.6276595744680851
	Val acc at iteration 65: 0.6382978723404256
	Val acc at iteration 66: 0.6063829787234043
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.5531914893617021
	Val acc at iteration 70: 0.5638297872340425
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.6276595744680851
	Val acc at iteration 73: 0.6276595744680851
	Val acc at iteration 74: 0.6063829787234043
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.6170212765957447
	Val acc at iteration 77: 0.6595744680851063
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.5425531914893617
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.723404255319149
	Val acc at iteration 85: 0.6808510638297872
	Val acc at iteration 86: 0.6382978723404256
	Val acc at iteration 87: 0.5638297872340425
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.7021276595744681
	Val acc at iteration 90: 0.5851063829787234
	Val acc at iteration 91: 0.6276595744680851
	Val acc at iteration 92: 0.6063829787234043
	Val acc at iteration 93: 0.6808510638297872
	Val acc at iteration 94: 0.6595744680851063
	Val acc at iteration 95: 0.6382978723404256
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.648936170212766
	Val acc at iteration 98: 0.648936170212766
	Val acc at iteration 99: 0.6276595744680851
Val acc before epoch 16: 0.6808510638297872
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7872340425531915
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Cluster: 0.645522141456604
	Separation: 0.5233722567558289
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.5957446808510638
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.6276595744680851
	Val acc at iteration 8: 0.6170212765957447
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6063829787234043
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.6382978723404256
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6063829787234043
	Val acc at iteration 24: 0.6063829787234043
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.5957446808510638
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6063829787234043
	Val acc at iteration 31: 0.6170212765957447
	Val acc at iteration 32: 0.6063829787234043
	Val acc at iteration 33: 0.6276595744680851
	Val acc at iteration 34: 0.6276595744680851
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.5531914893617021
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.5851063829787234
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.5425531914893617
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.648936170212766
	Val acc at iteration 54: 0.6276595744680851
	Val acc at iteration 55: 0.6276595744680851
	Val acc at iteration 56: 0.6063829787234043
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.6170212765957447
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.6170212765957447
	Val acc at iteration 64: 0.6170212765957447
	Val acc at iteration 65: 0.6063829787234043
	Val acc at iteration 66: 0.5957446808510638
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6276595744680851
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.574468085106383
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6063829787234043
	Val acc at iteration 78: 0.6276595744680851
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.648936170212766
	Val acc at iteration 82: 0.6063829787234043
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.6595744680851063
	Val acc at iteration 85: 0.7127659574468085
	Val acc at iteration 86: 0.6382978723404256
	Val acc at iteration 87: 0.648936170212766
	Val acc at iteration 88: 0.6170212765957447
	Val acc at iteration 89: 0.6382978723404256
	Val acc at iteration 90: 0.6702127659574468
	Val acc at iteration 91: 0.6382978723404256
	Val acc at iteration 92: 0.6382978723404256
	Val acc at iteration 93: 0.5851063829787234
	Val acc at iteration 94: 0.6914893617021277
	Val acc at iteration 95: 0.6914893617021277
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.6170212765957447
	Val acc at iteration 98: 0.7021276595744681
	Val acc at iteration 99: 0.6914893617021277
Val acc before epoch 26: 0.6276595744680851
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7446808510638298
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8191489361702128
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8936170212765957
Stopping after epoch 36.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Cluster: 0.657183575630188
	Separation: 0.5215788006782531
(After push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7980769230769231
	Val acc at iteration 0: 0.6595744680851063
	Train acc at iteration 2: 0.7772435897435898
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.7692307692307693
	Val acc at iteration 2: 0.6170212765957447
	Train acc at iteration 4: 0.780448717948718
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.7724358974358975
	Val acc at iteration 4: 0.6382978723404256
	Train acc at iteration 6: 0.7532051282051282
	Val acc at iteration 5: 0.6170212765957447
	Train acc at iteration 7: 0.7676282051282052
	Val acc at iteration 6: 0.5638297872340425
	Train acc at iteration 8: 0.7724358974358975
	Val acc at iteration 7: 0.6595744680851063
	Train acc at iteration 9: 0.7836538461538461
	Val acc at iteration 8: 0.7021276595744681
	Train acc at iteration 10: 0.7932692307692307
	Val acc at iteration 9: 0.6382978723404256
	Train acc at iteration 11: 0.780448717948718
	Val acc at iteration 10: 0.6170212765957447
	Train acc at iteration 12: 0.7900641025641025
	Val acc at iteration 11: 0.6382978723404256
	Train acc at iteration 13: 0.780448717948718
	Val acc at iteration 12: 0.6382978723404256
	Train acc at iteration 14: 0.7756410256410257
	Val acc at iteration 13: 0.648936170212766
	Train acc at iteration 15: 0.7564102564102564
	Val acc at iteration 14: 0.6702127659574468
	Train acc at iteration 16: 0.7852564102564102
	Val acc at iteration 15: 0.6595744680851063
	Train acc at iteration 17: 0.780448717948718
	Val acc at iteration 16: 0.5851063829787234
	Train acc at iteration 18: 0.7964743589743589
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.7788461538461539
	Val acc at iteration 18: 0.6382978723404256
	Train acc at iteration 20: 0.7884615384615384
	Val acc at iteration 19: 0.6702127659574468
	Train acc at iteration 21: 0.7932692307692307
	Val acc at iteration 20: 0.648936170212766
	Train acc at iteration 22: 0.7948717948717948
	Val acc at iteration 21: 0.6808510638297872
	Train acc at iteration 23: 0.7980769230769231
	Val acc at iteration 22: 0.648936170212766
	Train acc at iteration 24: 0.7884615384615384
	Val acc at iteration 23: 0.648936170212766
	Train acc at iteration 25: 0.7532051282051282
	Val acc at iteration 24: 0.5638297872340425
	Train acc at iteration 26: 0.7708333333333334
	Val acc at iteration 25: 0.6595744680851063
	Train acc at iteration 27: 0.780448717948718
	Val acc at iteration 26: 0.7340425531914894
	Train acc at iteration 28: 0.7467948717948718
	Val acc at iteration 27: 0.6382978723404256
	Train acc at iteration 29: 0.7628205128205128
	Val acc at iteration 28: 0.6382978723404256
	Train acc at iteration 30: 0.7532051282051282
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.8125
	Val acc at iteration 30: 0.648936170212766
	Train acc at iteration 32: 0.7788461538461539
	Val acc at iteration 31: 0.6063829787234043
	Train acc at iteration 33: 0.7740384615384616
	Val acc at iteration 32: 0.6170212765957447
	Train acc at iteration 34: 0.7916666666666666
	Val acc at iteration 33: 0.7021276595744681
	Train acc at iteration 35: 0.7740384615384616
	Val acc at iteration 34: 0.574468085106383
	Train acc at iteration 36: 0.7884615384615384
	Val acc at iteration 35: 0.6382978723404256
	Train acc at iteration 37: 0.7628205128205128
	Val acc at iteration 36: 0.648936170212766
	Train acc at iteration 38: 0.7564102564102564
	Val acc at iteration 37: 0.723404255319149
	Train acc at iteration 39: 0.7628205128205128
	Val acc at iteration 38: 0.6382978723404256
	Train acc at iteration 40: 0.7483974358974359
	Val acc at iteration 39: 0.648936170212766
	Train acc at iteration 41: 0.7868589743589743
	Val acc at iteration 40: 0.6170212765957447
	Train acc at iteration 42: 0.7644230769230769
	Val acc at iteration 41: 0.6382978723404256
	Train acc at iteration 43: 0.7900641025641025
	Val acc at iteration 42: 0.6382978723404256
	Train acc at iteration 44: 0.7451923076923077
	Val acc at iteration 43: 0.574468085106383
	Train acc at iteration 45: 0.7612179487179487
	Val acc at iteration 44: 0.6914893617021277
	Train acc at iteration 46: 0.7708333333333334
	Val acc at iteration 45: 0.5851063829787234
	Train acc at iteration 47: 0.7756410256410257
	Val acc at iteration 46: 0.6170212765957447
	Train acc at iteration 48: 0.7996794871794872
	Val acc at iteration 47: 0.6063829787234043
	Train acc at iteration 49: 0.7996794871794872
	Val acc at iteration 48: 0.6276595744680851
	Train acc at iteration 50: 0.780448717948718
	Val acc at iteration 49: 0.723404255319149
	Train acc at iteration 51: 0.7548076923076923
	Val acc at iteration 50: 0.7127659574468085
	Train acc at iteration 52: 0.7612179487179487
	Val acc at iteration 51: 0.6914893617021277
	Train acc at iteration 53: 0.7884615384615384
	Val acc at iteration 52: 0.6914893617021277
	Train acc at iteration 54: 0.7692307692307693
	Val acc at iteration 53: 0.6063829787234043
	Train acc at iteration 55: 0.7564102564102564
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.7355769230769231
	Val acc at iteration 55: 0.6914893617021277
	Train acc at iteration 57: 0.782051282051282
	Val acc at iteration 56: 0.6702127659574468
	Train acc at iteration 58: 0.7868589743589743
	Val acc at iteration 57: 0.6595744680851063
	Train acc at iteration 59: 0.780448717948718
	Val acc at iteration 58: 0.6808510638297872
	Train acc at iteration 60: 0.7644230769230769
	Val acc at iteration 59: 0.648936170212766
	Train acc at iteration 61: 0.7580128205128205
	Val acc at iteration 60: 0.5957446808510638
	Train acc at iteration 62: 0.7612179487179487
	Val acc at iteration 61: 0.6702127659574468
	Train acc at iteration 63: 0.7612179487179487
	Val acc at iteration 62: 0.6170212765957447
	Train acc at iteration 64: 0.7756410256410257
	Val acc at iteration 63: 0.6808510638297872
	Train acc at iteration 65: 0.7660256410256411
	Val acc at iteration 64: 0.5851063829787234
	Train acc at iteration 66: 0.7740384615384616
	Val acc at iteration 65: 0.6170212765957447
	Train acc at iteration 67: 0.7708333333333334
	Val acc at iteration 66: 0.6702127659574468
	Train acc at iteration 68: 0.7740384615384616
	Val acc at iteration 67: 0.6595744680851063
	Train acc at iteration 69: 0.7756410256410257
	Val acc at iteration 68: 0.7021276595744681
	Train acc at iteration 70: 0.7868589743589743
	Val acc at iteration 69: 0.7446808510638298
	Train acc at iteration 71: 0.7403846153846154
	Val acc at iteration 70: 0.6382978723404256
	Train acc at iteration 72: 0.7932692307692307
	Val acc at iteration 71: 0.6808510638297872
	Train acc at iteration 73: 0.7564102564102564
	Val acc at iteration 72: 0.6595744680851063
	Train acc at iteration 74: 0.7756410256410257
	Val acc at iteration 73: 0.648936170212766
	Train acc at iteration 75: 0.7403846153846154
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.780448717948718
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.7788461538461539
	Val acc at iteration 76: 0.5319148936170213
	Train acc at iteration 78: 0.7644230769230769
	Val acc at iteration 77: 0.7021276595744681
	Train acc at iteration 79: 0.7676282051282052
	Val acc at iteration 78: 0.648936170212766
	Train acc at iteration 80: 0.7564102564102564
	Val acc at iteration 79: 0.6170212765957447
	Train acc at iteration 81: 0.7836538461538461
	Val acc at iteration 80: 0.6595744680851063
	Train acc at iteration 82: 0.7580128205128205
	Val acc at iteration 81: 0.6382978723404256
	Train acc at iteration 83: 0.7435897435897436
	Val acc at iteration 82: 0.6382978723404256
	Train acc at iteration 84: 0.7788461538461539
	Val acc at iteration 83: 0.6170212765957447
	Train acc at iteration 85: 0.7980769230769231
	Val acc at iteration 84: 0.6702127659574468
	Train acc at iteration 86: 0.7756410256410257
	Val acc at iteration 85: 0.6382978723404256
	Train acc at iteration 87: 0.780448717948718
	Val acc at iteration 86: 0.6276595744680851
	Train acc at iteration 88: 0.7868589743589743
	Val acc at iteration 87: 0.6595744680851063
	Train acc at iteration 89: 0.7676282051282052
	Val acc at iteration 88: 0.6063829787234043
	Train acc at iteration 90: 0.7756410256410257
	Val acc at iteration 89: 0.6702127659574468
	Train acc at iteration 91: 0.7756410256410257
	Val acc at iteration 90: 0.7127659574468085
	Train acc at iteration 92: 0.7724358974358975
	Val acc at iteration 91: 0.6702127659574468
	Train acc at iteration 93: 0.7916666666666666
	Val acc at iteration 92: 0.6914893617021277
	Train acc at iteration 94: 0.7532051282051282
	Val acc at iteration 93: 0.648936170212766
	Train acc at iteration 95: 0.7628205128205128
	Val acc at iteration 94: 0.648936170212766
	Train acc at iteration 96: 0.780448717948718
	Val acc at iteration 95: 0.6276595744680851
	Train acc at iteration 97: 0.782051282051282
	Val acc at iteration 96: 0.6276595744680851
	Train acc at iteration 98: 0.7756410256410257
	Val acc at iteration 97: 0.7340425531914894
	Train acc at iteration 99: 0.7548076923076923
	Val acc at iteration 98: 0.7021276595744681
	Train acc at iteration 100: 0.7580128205128205
	Val acc at iteration 99: 0.648936170212766
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5266666666666666
Final val micro accuracy: 0.6382978723404256
Final test macro f1-score: 0.43666666666666665
Final test micro accuracy: 0.5531914893617021
Final validation:
	Cluster: 0.616995245218277
	Separation: 0.5408698320388794
Final test:
	Cluster: 0.5839377343654633
	Separation: 0.536297082901001
Saved Results

Attempting combination 7/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 2.4
l1_weight: 0.1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.22340425531914893
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.4574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6170212765957447
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.6382978723404256
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.7127659574468085
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7660256410256411
	Cluster: 0.6441341757774353
	Separation: 0.5180628538131714
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.5957446808510638
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.7553191489361702
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.776595744680851
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.6276595744680851
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7553191489361702
	Val acc at iteration 40: 0.7553191489361702
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.6170212765957447
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.6170212765957447
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.648936170212766
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.6276595744680851
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6595744680851063
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.6276595744680851
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.6702127659574468
	Val acc at iteration 85: 0.7553191489361702
	Val acc at iteration 86: 0.7340425531914894
	Val acc at iteration 87: 0.7021276595744681
	Val acc at iteration 88: 0.7659574468085106
	Val acc at iteration 89: 0.7021276595744681
	Val acc at iteration 90: 0.6382978723404256
	Val acc at iteration 91: 0.723404255319149
	Val acc at iteration 92: 0.6595744680851063
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.6808510638297872
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.6063829787234043
	Val acc at iteration 97: 0.648936170212766
	Val acc at iteration 98: 0.7021276595744681
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 16: 0.6808510638297872
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7676282051282052
	Cluster: 0.6516628980636596
	Separation: 0.5210728883743286
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.6276595744680851
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.6382978723404256
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.8297872340425532
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.5957446808510638
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.6382978723404256
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6382978723404256
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.5531914893617021
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.5957446808510638
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.8085106382978723
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.5851063829787234
	Val acc at iteration 65: 0.6170212765957447
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.6170212765957447
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.723404255319149
	Val acc at iteration 85: 0.6808510638297872
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.7127659574468085
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.7021276595744681
	Val acc at iteration 90: 0.6808510638297872
	Val acc at iteration 91: 0.7021276595744681
	Val acc at iteration 92: 0.6595744680851063
	Val acc at iteration 93: 0.6276595744680851
	Val acc at iteration 94: 0.6914893617021277
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.6702127659574468
	Val acc at iteration 97: 0.7553191489361702
	Val acc at iteration 98: 0.7340425531914894
	Val acc at iteration 99: 0.5851063829787234
Val acc before epoch 26: 0.6595744680851063
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8617021276595744
Stopping after epoch 36.
Final validation accuracy before push: 86.17021276595744%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7932692307692307
	Cluster: 0.6601250410079956
	Separation: 0.5243237972259521
(After push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7916666666666666
	Val acc at iteration 0: 0.6702127659574468
	Train acc at iteration 2: 0.782051282051282
	Val acc at iteration 1: 0.6702127659574468
	Train acc at iteration 3: 0.7708333333333334
	Val acc at iteration 2: 0.723404255319149
	Train acc at iteration 4: 0.7836538461538461
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.7868589743589743
	Val acc at iteration 4: 0.723404255319149
	Train acc at iteration 6: 0.7467948717948718
	Val acc at iteration 5: 0.7659574468085106
	Train acc at iteration 7: 0.7724358974358975
	Val acc at iteration 6: 0.6170212765957447
	Train acc at iteration 8: 0.7451923076923077
	Val acc at iteration 7: 0.648936170212766
	Train acc at iteration 9: 0.782051282051282
	Val acc at iteration 8: 0.6595744680851063
	Train acc at iteration 10: 0.780448717948718
	Val acc at iteration 9: 0.723404255319149
	Train acc at iteration 11: 0.8012820512820513
	Val acc at iteration 10: 0.7553191489361702
	Train acc at iteration 12: 0.7644230769230769
	Val acc at iteration 11: 0.7127659574468085
	Train acc at iteration 13: 0.7852564102564102
	Val acc at iteration 12: 0.6595744680851063
	Train acc at iteration 14: 0.7836538461538461
	Val acc at iteration 13: 0.6702127659574468
	Train acc at iteration 15: 0.7580128205128205
	Val acc at iteration 14: 0.7127659574468085
	Train acc at iteration 16: 0.7772435897435898
	Val acc at iteration 15: 0.6382978723404256
	Train acc at iteration 17: 0.7483974358974359
	Val acc at iteration 16: 0.6808510638297872
	Train acc at iteration 18: 0.7980769230769231
	Val acc at iteration 17: 0.6914893617021277
	Train acc at iteration 19: 0.7596153846153846
	Val acc at iteration 18: 0.723404255319149
	Train acc at iteration 20: 0.780448717948718
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.7724358974358975
	Val acc at iteration 20: 0.7553191489361702
	Train acc at iteration 22: 0.7772435897435898
	Val acc at iteration 21: 0.648936170212766
	Train acc at iteration 23: 0.7676282051282052
	Val acc at iteration 22: 0.6595744680851063
	Train acc at iteration 24: 0.7580128205128205
	Val acc at iteration 23: 0.7446808510638298
	Train acc at iteration 25: 0.7740384615384616
	Val acc at iteration 24: 0.648936170212766
	Train acc at iteration 26: 0.7916666666666666
	Val acc at iteration 25: 0.648936170212766
	Train acc at iteration 27: 0.7932692307692307
	Val acc at iteration 26: 0.7127659574468085
	Train acc at iteration 28: 0.7692307692307693
	Val acc at iteration 27: 0.648936170212766
	Train acc at iteration 29: 0.7788461538461539
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.8076923076923077
	Val acc at iteration 29: 0.7021276595744681
	Train acc at iteration 31: 0.7756410256410257
	Val acc at iteration 30: 0.723404255319149
	Train acc at iteration 32: 0.780448717948718
	Val acc at iteration 31: 0.6808510638297872
	Train acc at iteration 33: 0.7916666666666666
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.7612179487179487
	Val acc at iteration 33: 0.7021276595744681
	Train acc at iteration 35: 0.7564102564102564
	Val acc at iteration 34: 0.6170212765957447
	Train acc at iteration 36: 0.7548076923076923
	Val acc at iteration 35: 0.8085106382978723
	Train acc at iteration 37: 0.7772435897435898
	Val acc at iteration 36: 0.648936170212766
	Train acc at iteration 38: 0.7708333333333334
	Val acc at iteration 37: 0.6808510638297872
	Train acc at iteration 39: 0.8125
	Val acc at iteration 38: 0.6702127659574468
	Train acc at iteration 40: 0.7948717948717948
	Val acc at iteration 39: 0.723404255319149
	Train acc at iteration 41: 0.7708333333333334
	Val acc at iteration 40: 0.6808510638297872
	Train acc at iteration 42: 0.782051282051282
	Val acc at iteration 41: 0.6276595744680851
	Train acc at iteration 43: 0.7676282051282052
	Val acc at iteration 42: 0.7127659574468085
	Train acc at iteration 44: 0.8012820512820513
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.7580128205128205
	Val acc at iteration 44: 0.6808510638297872
	Train acc at iteration 46: 0.782051282051282
	Val acc at iteration 45: 0.6595744680851063
	Train acc at iteration 47: 0.7564102564102564
	Val acc at iteration 46: 0.6808510638297872
	Train acc at iteration 48: 0.7852564102564102
	Val acc at iteration 47: 0.6914893617021277
	Train acc at iteration 49: 0.7660256410256411
	Val acc at iteration 48: 0.7127659574468085
	Train acc at iteration 50: 0.7580128205128205
	Val acc at iteration 49: 0.648936170212766
	Train acc at iteration 51: 0.7532051282051282
	Val acc at iteration 50: 0.6808510638297872
	Train acc at iteration 52: 0.7740384615384616
	Val acc at iteration 51: 0.6595744680851063
	Train acc at iteration 53: 0.7916666666666666
	Val acc at iteration 52: 0.6276595744680851
	Train acc at iteration 54: 0.7740384615384616
	Val acc at iteration 53: 0.6382978723404256
	Train acc at iteration 55: 0.7628205128205128
	Val acc at iteration 54: 0.6914893617021277
	Train acc at iteration 56: 0.7884615384615384
	Val acc at iteration 55: 0.7446808510638298
	Train acc at iteration 57: 0.7932692307692307
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.7660256410256411
	Val acc at iteration 57: 0.6808510638297872
	Train acc at iteration 59: 0.7932692307692307
	Val acc at iteration 58: 0.6914893617021277
	Train acc at iteration 60: 0.7868589743589743
	Val acc at iteration 59: 0.7446808510638298
	Train acc at iteration 61: 0.8028846153846154
	Val acc at iteration 60: 0.7127659574468085
	Train acc at iteration 62: 0.7548076923076923
	Val acc at iteration 61: 0.7340425531914894
	Train acc at iteration 63: 0.7884615384615384
	Val acc at iteration 62: 0.7021276595744681
	Train acc at iteration 64: 0.7788461538461539
	Val acc at iteration 63: 0.6382978723404256
	Train acc at iteration 65: 0.7884615384615384
	Val acc at iteration 64: 0.6914893617021277
	Train acc at iteration 66: 0.7612179487179487
	Val acc at iteration 65: 0.723404255319149
	Train acc at iteration 67: 0.8092948717948718
	Val acc at iteration 66: 0.7553191489361702
	Train acc at iteration 68: 0.7435897435897436
	Val acc at iteration 67: 0.6808510638297872
	Train acc at iteration 69: 0.7660256410256411
	Val acc at iteration 68: 0.7021276595744681
	Train acc at iteration 70: 0.8012820512820513
	Val acc at iteration 69: 0.6595744680851063
	Train acc at iteration 71: 0.7916666666666666
	Val acc at iteration 70: 0.6808510638297872
	Train acc at iteration 72: 0.782051282051282
	Val acc at iteration 71: 0.7021276595744681
	Train acc at iteration 73: 0.7708333333333334
	Val acc at iteration 72: 0.7127659574468085
	Train acc at iteration 74: 0.780448717948718
	Val acc at iteration 73: 0.6702127659574468
	Train acc at iteration 75: 0.7644230769230769
	Val acc at iteration 74: 0.723404255319149
	Train acc at iteration 76: 0.7644230769230769
	Val acc at iteration 75: 0.6914893617021277
	Train acc at iteration 77: 0.7964743589743589
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.7628205128205128
	Val acc at iteration 77: 0.6595744680851063
	Train acc at iteration 79: 0.8253205128205128
	Val acc at iteration 78: 0.7446808510638298
	Train acc at iteration 80: 0.7900641025641025
	Val acc at iteration 79: 0.5851063829787234
	Train acc at iteration 81: 0.7516025641025641
	Val acc at iteration 80: 0.6595744680851063
	Train acc at iteration 82: 0.7692307692307693
	Val acc at iteration 81: 0.6702127659574468
	Train acc at iteration 83: 0.7467948717948718
	Val acc at iteration 82: 0.6382978723404256
	Train acc at iteration 84: 0.7772435897435898
	Val acc at iteration 83: 0.6702127659574468
	Train acc at iteration 85: 0.7724358974358975
	Val acc at iteration 84: 0.7659574468085106
	Train acc at iteration 86: 0.7948717948717948
	Val acc at iteration 85: 0.6063829787234043
	Train acc at iteration 87: 0.7964743589743589
	Val acc at iteration 86: 0.648936170212766
	Train acc at iteration 88: 0.7964743589743589
	Val acc at iteration 87: 0.648936170212766
	Train acc at iteration 89: 0.782051282051282
	Val acc at iteration 88: 0.6914893617021277
	Train acc at iteration 90: 0.780448717948718
	Val acc at iteration 89: 0.6595744680851063
	Train acc at iteration 91: 0.7740384615384616
	Val acc at iteration 90: 0.6808510638297872
	Train acc at iteration 92: 0.7932692307692307
	Val acc at iteration 91: 0.7021276595744681
	Train acc at iteration 93: 0.75
	Val acc at iteration 92: 0.6808510638297872
	Train acc at iteration 94: 0.7708333333333334
	Val acc at iteration 93: 0.6808510638297872
	Train acc at iteration 95: 0.7868589743589743
	Val acc at iteration 94: 0.723404255319149
	Train acc at iteration 96: 0.7756410256410257
	Val acc at iteration 95: 0.6914893617021277
	Train acc at iteration 97: 0.8060897435897436
	Val acc at iteration 96: 0.6808510638297872
	Train acc at iteration 98: 0.7692307692307693
	Val acc at iteration 97: 0.6170212765957447
	Train acc at iteration 99: 0.7676282051282052
	Val acc at iteration 98: 0.6702127659574468
	Train acc at iteration 100: 0.7884615384615384
	Val acc at iteration 99: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5578947368421051
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.45128205128205134
Final test micro accuracy: 0.5638297872340425
Final validation:
	Cluster: 0.6189519464969635
	Separation: 0.5424266457557678
Final test:
	Cluster: 0.6041229367256165
	Separation: 0.5321058630943298
Saved Results

Attempting combination 8/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 2.4
l1_weight: 0.01
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.30851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5212765957446809
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.5425531914893617
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7446808510638298
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.7446808510638298
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9787234042553191
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9680851063829787
Push epoch
After push, before retraining last layer:
	Train acc: 0.8044871794871795
	Cluster: 0.6520604968070984
	Separation: 0.5220184803009034
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.776595744680851
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.776595744680851
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.7446808510638298
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.7446808510638298
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6170212765957447
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.7659574468085106
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.6170212765957447
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.6276595744680851
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.776595744680851
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.6276595744680851
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.6595744680851063
	Val acc at iteration 85: 0.6914893617021277
	Val acc at iteration 86: 0.7340425531914894
	Val acc at iteration 87: 0.7340425531914894
	Val acc at iteration 88: 0.648936170212766
	Val acc at iteration 89: 0.723404255319149
	Val acc at iteration 90: 0.7340425531914894
	Val acc at iteration 91: 0.6382978723404256
	Val acc at iteration 92: 0.7340425531914894
	Val acc at iteration 93: 0.8191489361702128
	Val acc at iteration 94: 0.5957446808510638
	Val acc at iteration 95: 0.7446808510638298
	Val acc at iteration 96: 0.7659574468085106
	Val acc at iteration 97: 0.7127659574468085
	Val acc at iteration 98: 0.7446808510638298
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 16: 0.648936170212766
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Cluster: 0.6458631038665772
	Separation: 0.5225653529167176
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.7659574468085106
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.6276595744680851
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6170212765957447
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.5425531914893617
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.5851063829787234
	Val acc at iteration 48: 0.6382978723404256
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.648936170212766
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.6382978723404256
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.6382978723404256
	Val acc at iteration 80: 0.7978723404255319
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.7553191489361702
	Val acc at iteration 86: 0.7446808510638298
	Val acc at iteration 87: 0.7446808510638298
	Val acc at iteration 88: 0.6595744680851063
	Val acc at iteration 89: 0.648936170212766
	Val acc at iteration 90: 0.6808510638297872
	Val acc at iteration 91: 0.723404255319149
	Val acc at iteration 92: 0.7340425531914894
	Val acc at iteration 93: 0.6808510638297872
	Val acc at iteration 94: 0.7553191489361702
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.648936170212766
	Val acc at iteration 97: 0.6914893617021277
	Val acc at iteration 98: 0.7021276595744681
	Val acc at iteration 99: 0.7340425531914894
Val acc before epoch 26: 0.6702127659574468
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9148936170212766
Stopping after epoch 36.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7980769230769231
	Cluster: 0.6546502828598022
	Separation: 0.5223661422729492
(After push) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7916666666666666
	Val acc at iteration 0: 0.6382978723404256
	Train acc at iteration 2: 0.8012820512820513
	Val acc at iteration 1: 0.7340425531914894
	Train acc at iteration 3: 0.780448717948718
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.8189102564102564
	Val acc at iteration 3: 0.7446808510638298
	Train acc at iteration 5: 0.7516025641025641
	Val acc at iteration 4: 0.6808510638297872
	Train acc at iteration 6: 0.7932692307692307
	Val acc at iteration 5: 0.6595744680851063
	Train acc at iteration 7: 0.7964743589743589
	Val acc at iteration 6: 0.723404255319149
	Train acc at iteration 8: 0.7788461538461539
	Val acc at iteration 7: 0.723404255319149
	Train acc at iteration 9: 0.7964743589743589
	Val acc at iteration 8: 0.723404255319149
	Train acc at iteration 10: 0.7772435897435898
	Val acc at iteration 9: 0.7872340425531915
	Train acc at iteration 11: 0.7900641025641025
	Val acc at iteration 10: 0.6595744680851063
	Train acc at iteration 12: 0.8076923076923077
	Val acc at iteration 11: 0.7127659574468085
	Train acc at iteration 13: 0.7772435897435898
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.8060897435897436
	Val acc at iteration 13: 0.6914893617021277
	Train acc at iteration 15: 0.7900641025641025
	Val acc at iteration 14: 0.6170212765957447
	Train acc at iteration 16: 0.7644230769230769
	Val acc at iteration 15: 0.6808510638297872
	Train acc at iteration 17: 0.8012820512820513
	Val acc at iteration 16: 0.7127659574468085
	Train acc at iteration 18: 0.7852564102564102
	Val acc at iteration 17: 0.7021276595744681
	Train acc at iteration 19: 0.7772435897435898
	Val acc at iteration 18: 0.6914893617021277
	Train acc at iteration 20: 0.7644230769230769
	Val acc at iteration 19: 0.7340425531914894
	Train acc at iteration 21: 0.8205128205128205
	Val acc at iteration 20: 0.648936170212766
	Train acc at iteration 22: 0.7868589743589743
	Val acc at iteration 21: 0.6808510638297872
	Train acc at iteration 23: 0.782051282051282
	Val acc at iteration 22: 0.6382978723404256
	Train acc at iteration 24: 0.7836538461538461
	Val acc at iteration 23: 0.6595744680851063
	Train acc at iteration 25: 0.7948717948717948
	Val acc at iteration 24: 0.6276595744680851
	Train acc at iteration 26: 0.7756410256410257
	Val acc at iteration 25: 0.7021276595744681
	Train acc at iteration 27: 0.7772435897435898
	Val acc at iteration 26: 0.7021276595744681
	Train acc at iteration 28: 0.7980769230769231
	Val acc at iteration 27: 0.6808510638297872
	Train acc at iteration 29: 0.7900641025641025
	Val acc at iteration 28: 0.7127659574468085
	Train acc at iteration 30: 0.7884615384615384
	Val acc at iteration 29: 0.7127659574468085
	Train acc at iteration 31: 0.780448717948718
	Val acc at iteration 30: 0.6808510638297872
	Train acc at iteration 32: 0.7612179487179487
	Val acc at iteration 31: 0.6595744680851063
	Train acc at iteration 33: 0.8044871794871795
	Val acc at iteration 32: 0.7127659574468085
	Train acc at iteration 34: 0.7692307692307693
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.7884615384615384
	Val acc at iteration 34: 0.6702127659574468
	Train acc at iteration 36: 0.7644230769230769
	Val acc at iteration 35: 0.6382978723404256
	Train acc at iteration 37: 0.7948717948717948
	Val acc at iteration 36: 0.7340425531914894
	Train acc at iteration 38: 0.7916666666666666
	Val acc at iteration 37: 0.6702127659574468
	Train acc at iteration 39: 0.8012820512820513
	Val acc at iteration 38: 0.648936170212766
	Train acc at iteration 40: 0.782051282051282
	Val acc at iteration 39: 0.6914893617021277
	Train acc at iteration 41: 0.780448717948718
	Val acc at iteration 40: 0.7553191489361702
	Train acc at iteration 42: 0.7483974358974359
	Val acc at iteration 41: 0.6276595744680851
	Train acc at iteration 43: 0.782051282051282
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.7852564102564102
	Val acc at iteration 43: 0.6595744680851063
	Train acc at iteration 45: 0.7548076923076923
	Val acc at iteration 44: 0.7872340425531915
	Train acc at iteration 46: 0.7868589743589743
	Val acc at iteration 45: 0.6808510638297872
	Train acc at iteration 47: 0.782051282051282
	Val acc at iteration 46: 0.6702127659574468
	Train acc at iteration 48: 0.7932692307692307
	Val acc at iteration 47: 0.7659574468085106
	Train acc at iteration 49: 0.8044871794871795
	Val acc at iteration 48: 0.7127659574468085
	Train acc at iteration 50: 0.7852564102564102
	Val acc at iteration 49: 0.6914893617021277
	Train acc at iteration 51: 0.7916666666666666
	Val acc at iteration 50: 0.648936170212766
	Train acc at iteration 52: 0.7868589743589743
	Val acc at iteration 51: 0.723404255319149
	Train acc at iteration 53: 0.8092948717948718
	Val acc at iteration 52: 0.7021276595744681
	Train acc at iteration 54: 0.7772435897435898
	Val acc at iteration 53: 0.8297872340425532
	Train acc at iteration 55: 0.780448717948718
	Val acc at iteration 54: 0.6808510638297872
	Train acc at iteration 56: 0.7772435897435898
	Val acc at iteration 55: 0.7659574468085106
	Train acc at iteration 57: 0.8028846153846154
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.7900641025641025
	Val acc at iteration 57: 0.6914893617021277
	Train acc at iteration 59: 0.8237179487179487
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.7996794871794872
	Val acc at iteration 59: 0.7127659574468085
	Train acc at iteration 61: 0.7884615384615384
	Val acc at iteration 60: 0.6702127659574468
	Train acc at iteration 62: 0.8044871794871795
	Val acc at iteration 61: 0.7127659574468085
	Train acc at iteration 63: 0.7852564102564102
	Val acc at iteration 62: 0.6276595744680851
	Train acc at iteration 64: 0.7772435897435898
	Val acc at iteration 63: 0.6382978723404256
	Train acc at iteration 65: 0.7724358974358975
	Val acc at iteration 64: 0.7553191489361702
	Train acc at iteration 66: 0.7836538461538461
	Val acc at iteration 65: 0.7021276595744681
	Train acc at iteration 67: 0.7740384615384616
	Val acc at iteration 66: 0.6382978723404256
	Train acc at iteration 68: 0.7948717948717948
	Val acc at iteration 67: 0.7021276595744681
	Train acc at iteration 69: 0.8092948717948718
	Val acc at iteration 68: 0.7659574468085106
	Train acc at iteration 70: 0.7580128205128205
	Val acc at iteration 69: 0.7446808510638298
	Train acc at iteration 71: 0.7836538461538461
	Val acc at iteration 70: 0.723404255319149
	Train acc at iteration 72: 0.7836538461538461
	Val acc at iteration 71: 0.7340425531914894
	Train acc at iteration 73: 0.7980769230769231
	Val acc at iteration 72: 0.648936170212766
	Train acc at iteration 74: 0.8173076923076923
	Val acc at iteration 73: 0.7553191489361702
	Train acc at iteration 75: 0.8028846153846154
	Val acc at iteration 74: 0.7446808510638298
	Train acc at iteration 76: 0.7964743589743589
	Val acc at iteration 75: 0.7127659574468085
	Train acc at iteration 77: 0.7676282051282052
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.7580128205128205
	Val acc at iteration 77: 0.6808510638297872
	Train acc at iteration 79: 0.7724358974358975
	Val acc at iteration 78: 0.7340425531914894
	Train acc at iteration 80: 0.7884615384615384
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.7788461538461539
	Val acc at iteration 80: 0.7021276595744681
	Train acc at iteration 82: 0.8028846153846154
	Val acc at iteration 81: 0.7021276595744681
	Train acc at iteration 83: 0.7852564102564102
	Val acc at iteration 82: 0.6382978723404256
	Train acc at iteration 84: 0.7676282051282052
	Val acc at iteration 83: 0.723404255319149
	Train acc at iteration 85: 0.780448717948718
	Val acc at iteration 84: 0.6914893617021277
	Train acc at iteration 86: 0.7948717948717948
	Val acc at iteration 85: 0.7127659574468085
	Train acc at iteration 87: 0.8125
	Val acc at iteration 86: 0.7978723404255319
	Train acc at iteration 88: 0.8028846153846154
	Val acc at iteration 87: 0.6595744680851063
	Train acc at iteration 89: 0.7900641025641025
	Val acc at iteration 88: 0.7021276595744681
	Train acc at iteration 90: 0.8141025641025641
	Val acc at iteration 89: 0.6808510638297872
	Train acc at iteration 91: 0.7964743589743589
	Val acc at iteration 90: 0.723404255319149
	Train acc at iteration 92: 0.780448717948718
	Val acc at iteration 91: 0.7340425531914894
	Train acc at iteration 93: 0.7451923076923077
	Val acc at iteration 92: 0.7021276595744681
	Train acc at iteration 94: 0.8044871794871795
	Val acc at iteration 93: 0.723404255319149
	Train acc at iteration 95: 0.7788461538461539
	Val acc at iteration 94: 0.6808510638297872
	Train acc at iteration 96: 0.8076923076923077
	Val acc at iteration 95: 0.6914893617021277
	Train acc at iteration 97: 0.7724358974358975
	Val acc at iteration 96: 0.6170212765957447
	Train acc at iteration 98: 0.7836538461538461
	Val acc at iteration 97: 0.6914893617021277
	Train acc at iteration 99: 0.8189102564102564
	Val acc at iteration 98: 0.723404255319149
	Train acc at iteration 100: 0.8157051282051282
	Val acc at iteration 99: 0.7446808510638298
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5594059405940592
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.45125448028673837
Final test micro accuracy: 0.5957446808510638
Final validation:
	Cluster: 0.6239568889141083
	Separation: 0.5404480397701263
Final test:
	Cluster: 0.6007714867591858
	Separation: 0.5398012101650238
Saved Results

Attempting combination 9/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.2765957446808511
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.4787234042553192
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.5957446808510638
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.6276595744680851
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.6808510638297872
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Cluster: 0.6534440875053406
	Separation: 0.5176498293876648
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7872340425531915
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.5851063829787234
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.5957446808510638
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.7446808510638298
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.5851063829787234
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.7553191489361702
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.7872340425531915
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.7446808510638298
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.6382978723404256
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.5957446808510638
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.6170212765957447
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7872340425531915
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.7978723404255319
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7978723404255319
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7978723404255319
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7659574468085106
	Val acc at iteration 85: 0.7553191489361702
	Val acc at iteration 86: 0.6914893617021277
	Val acc at iteration 87: 0.7446808510638298
	Val acc at iteration 88: 0.7872340425531915
	Val acc at iteration 89: 0.7340425531914894
	Val acc at iteration 90: 0.723404255319149
	Val acc at iteration 91: 0.7340425531914894
	Val acc at iteration 92: 0.7659574468085106
	Val acc at iteration 93: 0.7553191489361702
	Val acc at iteration 94: 0.776595744680851
	Val acc at iteration 95: 0.7446808510638298
	Val acc at iteration 96: 0.7127659574468085
	Val acc at iteration 97: 0.7553191489361702
	Val acc at iteration 98: 0.723404255319149
	Val acc at iteration 99: 0.7446808510638298
Val acc before epoch 16: 0.7659574468085106
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8205128205128205
	Cluster: 0.6560554385185242
	Separation: 0.5220791101455688
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.7872340425531915
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.776595744680851
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.7659574468085106
	Val acc at iteration 18: 0.7659574468085106
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.776595744680851
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.7872340425531915
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.776595744680851
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.7978723404255319
	Val acc at iteration 35: 0.776595744680851
	Val acc at iteration 36: 0.7553191489361702
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7872340425531915
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.776595744680851
	Val acc at iteration 48: 0.8085106382978723
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.8404255319148937
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7978723404255319
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.8085106382978723
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7872340425531915
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.8085106382978723
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.776595744680851
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.851063829787234
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.7872340425531915
	Val acc at iteration 85: 0.7446808510638298
	Val acc at iteration 86: 0.6702127659574468
	Val acc at iteration 87: 0.6914893617021277
	Val acc at iteration 88: 0.7553191489361702
	Val acc at iteration 89: 0.7659574468085106
	Val acc at iteration 90: 0.7553191489361702
	Val acc at iteration 91: 0.7872340425531915
	Val acc at iteration 92: 0.7127659574468085
	Val acc at iteration 93: 0.7340425531914894
	Val acc at iteration 94: 0.7659574468085106
	Val acc at iteration 95: 0.776595744680851
	Val acc at iteration 96: 0.7340425531914894
	Val acc at iteration 97: 0.776595744680851
	Val acc at iteration 98: 0.723404255319149
	Val acc at iteration 99: 0.7978723404255319
Val acc before epoch 26: 0.7872340425531915
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8617021276595744
Stopping after epoch 36.
Final validation accuracy before push: 86.17021276595744%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8044871794871795
	Cluster: 0.6438230633735657
	Separation: 0.5154808759689331
(After push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8269230769230769
	Val acc at iteration 0: 0.7659574468085106
	Train acc at iteration 2: 0.8157051282051282
	Val acc at iteration 1: 0.6914893617021277
	Train acc at iteration 3: 0.8349358974358975
	Val acc at iteration 2: 0.7978723404255319
	Train acc at iteration 4: 0.8076923076923077
	Val acc at iteration 3: 0.7553191489361702
	Train acc at iteration 5: 0.8173076923076923
	Val acc at iteration 4: 0.7659574468085106
	Train acc at iteration 6: 0.8141025641025641
	Val acc at iteration 5: 0.7978723404255319
	Train acc at iteration 7: 0.8108974358974359
	Val acc at iteration 6: 0.723404255319149
	Train acc at iteration 8: 0.7916666666666666
	Val acc at iteration 7: 0.7446808510638298
	Train acc at iteration 9: 0.8028846153846154
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8333333333333334
	Val acc at iteration 9: 0.7553191489361702
	Train acc at iteration 11: 0.8044871794871795
	Val acc at iteration 10: 0.7340425531914894
	Train acc at iteration 12: 0.8333333333333334
	Val acc at iteration 11: 0.7872340425531915
	Train acc at iteration 13: 0.8173076923076923
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.8157051282051282
	Val acc at iteration 13: 0.8085106382978723
	Train acc at iteration 15: 0.8221153846153846
	Val acc at iteration 14: 0.7127659574468085
	Train acc at iteration 16: 0.8269230769230769
	Val acc at iteration 15: 0.7553191489361702
	Train acc at iteration 17: 0.7996794871794872
	Val acc at iteration 16: 0.6808510638297872
	Train acc at iteration 18: 0.8125
	Val acc at iteration 17: 0.7872340425531915
	Train acc at iteration 19: 0.8028846153846154
	Val acc at iteration 18: 0.7978723404255319
	Train acc at iteration 20: 0.7916666666666666
	Val acc at iteration 19: 0.723404255319149
	Train acc at iteration 21: 0.8044871794871795
	Val acc at iteration 20: 0.6914893617021277
	Train acc at iteration 22: 0.8028846153846154
	Val acc at iteration 21: 0.7340425531914894
	Train acc at iteration 23: 0.8237179487179487
	Val acc at iteration 22: 0.7340425531914894
	Train acc at iteration 24: 0.8125
	Val acc at iteration 23: 0.7872340425531915
	Train acc at iteration 25: 0.8125
	Val acc at iteration 24: 0.7340425531914894
	Train acc at iteration 26: 0.8108974358974359
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.8221153846153846
	Val acc at iteration 26: 0.7978723404255319
	Train acc at iteration 28: 0.8269230769230769
	Val acc at iteration 27: 0.7340425531914894
	Train acc at iteration 29: 0.8237179487179487
	Val acc at iteration 28: 0.723404255319149
	Train acc at iteration 30: 0.8173076923076923
	Val acc at iteration 29: 0.7021276595744681
	Train acc at iteration 31: 0.8157051282051282
	Val acc at iteration 30: 0.723404255319149
	Train acc at iteration 32: 0.8285256410256411
	Val acc at iteration 31: 0.6808510638297872
	Train acc at iteration 33: 0.844551282051282
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.8205128205128205
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.7932692307692307
	Val acc at iteration 34: 0.7553191489361702
	Train acc at iteration 36: 0.8141025641025641
	Val acc at iteration 35: 0.7127659574468085
	Train acc at iteration 37: 0.8477564102564102
	Val acc at iteration 36: 0.7659574468085106
	Train acc at iteration 38: 0.8205128205128205
	Val acc at iteration 37: 0.7340425531914894
	Train acc at iteration 39: 0.7996794871794872
	Val acc at iteration 38: 0.6595744680851063
	Train acc at iteration 40: 0.8189102564102564
	Val acc at iteration 39: 0.7446808510638298
	Train acc at iteration 41: 0.8317307692307693
	Val acc at iteration 40: 0.7127659574468085
	Train acc at iteration 42: 0.7932692307692307
	Val acc at iteration 41: 0.776595744680851
	Train acc at iteration 43: 0.8189102564102564
	Val acc at iteration 42: 0.8085106382978723
	Train acc at iteration 44: 0.8237179487179487
	Val acc at iteration 43: 0.6914893617021277
	Train acc at iteration 45: 0.8269230769230769
	Val acc at iteration 44: 0.7446808510638298
	Train acc at iteration 46: 0.7948717948717948
	Val acc at iteration 45: 0.776595744680851
	Train acc at iteration 47: 0.8076923076923077
	Val acc at iteration 46: 0.6914893617021277
	Train acc at iteration 48: 0.8253205128205128
	Val acc at iteration 47: 0.7659574468085106
	Train acc at iteration 49: 0.7900641025641025
	Val acc at iteration 48: 0.776595744680851
	Train acc at iteration 50: 0.7948717948717948
	Val acc at iteration 49: 0.723404255319149
	Train acc at iteration 51: 0.8092948717948718
	Val acc at iteration 50: 0.7340425531914894
	Train acc at iteration 52: 0.8108974358974359
	Val acc at iteration 51: 0.7872340425531915
	Train acc at iteration 53: 0.8189102564102564
	Val acc at iteration 52: 0.7127659574468085
	Train acc at iteration 54: 0.8157051282051282
	Val acc at iteration 53: 0.723404255319149
	Train acc at iteration 55: 0.8221153846153846
	Val acc at iteration 54: 0.7553191489361702
	Train acc at iteration 56: 0.8028846153846154
	Val acc at iteration 55: 0.7872340425531915
	Train acc at iteration 57: 0.8189102564102564
	Val acc at iteration 56: 0.7340425531914894
	Train acc at iteration 58: 0.8365384615384616
	Val acc at iteration 57: 0.7659574468085106
	Train acc at iteration 59: 0.8012820512820513
	Val acc at iteration 58: 0.7978723404255319
	Train acc at iteration 60: 0.8333333333333334
	Val acc at iteration 59: 0.7127659574468085
	Train acc at iteration 61: 0.7932692307692307
	Val acc at iteration 60: 0.776595744680851
	Train acc at iteration 62: 0.8028846153846154
	Val acc at iteration 61: 0.7872340425531915
	Train acc at iteration 63: 0.8253205128205128
	Val acc at iteration 62: 0.723404255319149
	Train acc at iteration 64: 0.8221153846153846
	Val acc at iteration 63: 0.6808510638297872
	Train acc at iteration 65: 0.8237179487179487
	Val acc at iteration 64: 0.776595744680851
	Train acc at iteration 66: 0.8333333333333334
	Val acc at iteration 65: 0.776595744680851
	Train acc at iteration 67: 0.8285256410256411
	Val acc at iteration 66: 0.7978723404255319
	Train acc at iteration 68: 0.8173076923076923
	Val acc at iteration 67: 0.723404255319149
	Train acc at iteration 69: 0.8237179487179487
	Val acc at iteration 68: 0.7127659574468085
	Train acc at iteration 70: 0.8221153846153846
	Val acc at iteration 69: 0.7553191489361702
	Train acc at iteration 71: 0.8125
	Val acc at iteration 70: 0.7659574468085106
	Train acc at iteration 72: 0.8205128205128205
	Val acc at iteration 71: 0.7340425531914894
	Train acc at iteration 73: 0.842948717948718
	Val acc at iteration 72: 0.776595744680851
	Train acc at iteration 74: 0.7996794871794872
	Val acc at iteration 73: 0.7446808510638298
	Train acc at iteration 75: 0.8189102564102564
	Val acc at iteration 74: 0.776595744680851
	Train acc at iteration 76: 0.8012820512820513
	Val acc at iteration 75: 0.8085106382978723
	Train acc at iteration 77: 0.8060897435897436
	Val acc at iteration 76: 0.7978723404255319
	Train acc at iteration 78: 0.7948717948717948
	Val acc at iteration 77: 0.776595744680851
	Train acc at iteration 79: 0.8301282051282052
	Val acc at iteration 78: 0.7872340425531915
	Train acc at iteration 80: 0.8108974358974359
	Val acc at iteration 79: 0.776595744680851
	Train acc at iteration 81: 0.8381410256410257
	Val acc at iteration 80: 0.8191489361702128
	Train acc at iteration 82: 0.8141025641025641
	Val acc at iteration 81: 0.7446808510638298
	Train acc at iteration 83: 0.8253205128205128
	Val acc at iteration 82: 0.7553191489361702
	Train acc at iteration 84: 0.8157051282051282
	Val acc at iteration 83: 0.8191489361702128
	Train acc at iteration 85: 0.7932692307692307
	Val acc at iteration 84: 0.8191489361702128
	Train acc at iteration 86: 0.8349358974358975
	Val acc at iteration 85: 0.7340425531914894
	Train acc at iteration 87: 0.8060897435897436
	Val acc at iteration 86: 0.6914893617021277
	Train acc at iteration 88: 0.8253205128205128
	Val acc at iteration 87: 0.6702127659574468
	Train acc at iteration 89: 0.8205128205128205
	Val acc at iteration 88: 0.7553191489361702
	Train acc at iteration 90: 0.8141025641025641
	Val acc at iteration 89: 0.7978723404255319
	Train acc at iteration 91: 0.8381410256410257
	Val acc at iteration 90: 0.7553191489361702
	Train acc at iteration 92: 0.8076923076923077
	Val acc at iteration 91: 0.7553191489361702
	Train acc at iteration 93: 0.8189102564102564
	Val acc at iteration 92: 0.723404255319149
	Train acc at iteration 94: 0.8253205128205128
	Val acc at iteration 93: 0.723404255319149
	Train acc at iteration 95: 0.8076923076923077
	Val acc at iteration 94: 0.7553191489361702
	Train acc at iteration 96: 0.8125
	Val acc at iteration 95: 0.723404255319149
	Train acc at iteration 97: 0.8205128205128205
	Val acc at iteration 96: 0.6808510638297872
	Train acc at iteration 98: 0.8189102564102564
	Val acc at iteration 97: 0.7127659574468085
	Train acc at iteration 99: 0.8157051282051282
	Val acc at iteration 98: 0.8297872340425532
	Train acc at iteration 100: 0.8365384615384616
	Val acc at iteration 99: 0.7127659574468085
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5927083333333334
Final val micro accuracy: 0.7127659574468085
Final test macro f1-score: 0.6452380952380952
Final test micro accuracy: 0.7553191489361702
Final validation:
	Cluster: 0.6264075934886932
	Separation: 0.5449284613132477
Final test:
	Cluster: 0.613711029291153
	Separation: 0.5331611931324005
Saved Results

Attempting combination 10/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 0.24
l1_weight: 10
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.2872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5212765957446809
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6914893617021277
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Cluster: 0.6455895662307739
	Separation: 0.5135638475418091
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6170212765957447
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.7659574468085106
	Val acc at iteration 26: 0.7553191489361702
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.5851063829787234
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.5531914893617021
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.5851063829787234
	Val acc at iteration 65: 0.5851063829787234
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.6170212765957447
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.648936170212766
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.648936170212766
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.6808510638297872
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.7446808510638298
	Val acc at iteration 87: 0.6914893617021277
	Val acc at iteration 88: 0.6063829787234043
	Val acc at iteration 89: 0.6808510638297872
	Val acc at iteration 90: 0.7127659574468085
	Val acc at iteration 91: 0.7872340425531915
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.6063829787234043
	Val acc at iteration 95: 0.648936170212766
	Val acc at iteration 96: 0.7340425531914894
	Val acc at iteration 97: 0.723404255319149
	Val acc at iteration 98: 0.7553191489361702
	Val acc at iteration 99: 0.7340425531914894
Val acc before epoch 16: 0.7446808510638298
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.776595744680851
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8191489361702128
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.8617021276595744
Push epoch
After push, before retraining last layer:
	Train acc: 0.8173076923076923
	Cluster: 0.6513013243675232
	Separation: 0.5194869041442871
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7127659574468085
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7659574468085106
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.7659574468085106
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.6382978723404256
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.776595744680851
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.7553191489361702
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.5638297872340425
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6063829787234043
	Val acc at iteration 60: 0.6276595744680851
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.5957446808510638
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.6914893617021277
	Val acc at iteration 85: 0.6914893617021277
	Val acc at iteration 86: 0.723404255319149
	Val acc at iteration 87: 0.7021276595744681
	Val acc at iteration 88: 0.648936170212766
	Val acc at iteration 89: 0.7553191489361702
	Val acc at iteration 90: 0.723404255319149
	Val acc at iteration 91: 0.7021276595744681
	Val acc at iteration 92: 0.723404255319149
	Val acc at iteration 93: 0.6170212765957447
	Val acc at iteration 94: 0.7340425531914894
	Val acc at iteration 95: 0.6808510638297872
	Val acc at iteration 96: 0.6595744680851063
	Val acc at iteration 97: 0.7553191489361702
	Val acc at iteration 98: 0.6808510638297872
	Val acc at iteration 99: 0.7553191489361702
Val acc before epoch 26: 0.6702127659574468
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7021276595744681
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8617021276595744
Stopping after epoch 36.
Final validation accuracy before push: 86.17021276595744%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7980769230769231
	Cluster: 0.6480238914489747
	Separation: 0.5216106176376343
(After push) Val acc at iteration 0: 0.574468085106383
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7884615384615384
	Val acc at iteration 0: 0.7553191489361702
	Train acc at iteration 2: 0.7980769230769231
	Val acc at iteration 1: 0.6914893617021277
	Train acc at iteration 3: 0.780448717948718
	Val acc at iteration 2: 0.7340425531914894
	Train acc at iteration 4: 0.7900641025641025
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.780448717948718
	Val acc at iteration 4: 0.6595744680851063
	Train acc at iteration 6: 0.782051282051282
	Val acc at iteration 5: 0.7127659574468085
	Train acc at iteration 7: 0.7740384615384616
	Val acc at iteration 6: 0.7021276595744681
	Train acc at iteration 8: 0.7692307692307693
	Val acc at iteration 7: 0.6276595744680851
	Train acc at iteration 9: 0.7948717948717948
	Val acc at iteration 8: 0.723404255319149
	Train acc at iteration 10: 0.8092948717948718
	Val acc at iteration 9: 0.7021276595744681
	Train acc at iteration 11: 0.7740384615384616
	Val acc at iteration 10: 0.7127659574468085
	Train acc at iteration 12: 0.7612179487179487
	Val acc at iteration 11: 0.7446808510638298
	Train acc at iteration 13: 0.7980769230769231
	Val acc at iteration 12: 0.7659574468085106
	Train acc at iteration 14: 0.7980769230769231
	Val acc at iteration 13: 0.7872340425531915
	Train acc at iteration 15: 0.7788461538461539
	Val acc at iteration 14: 0.6702127659574468
	Train acc at iteration 16: 0.7868589743589743
	Val acc at iteration 15: 0.6702127659574468
	Train acc at iteration 17: 0.7724358974358975
	Val acc at iteration 16: 0.7021276595744681
	Train acc at iteration 18: 0.7708333333333334
	Val acc at iteration 17: 0.7127659574468085
	Train acc at iteration 19: 0.7708333333333334
	Val acc at iteration 18: 0.7659574468085106
	Train acc at iteration 20: 0.7708333333333334
	Val acc at iteration 19: 0.7127659574468085
	Train acc at iteration 21: 0.7948717948717948
	Val acc at iteration 20: 0.7127659574468085
	Train acc at iteration 22: 0.7900641025641025
	Val acc at iteration 21: 0.6595744680851063
	Train acc at iteration 23: 0.7852564102564102
	Val acc at iteration 22: 0.648936170212766
	Train acc at iteration 24: 0.8012820512820513
	Val acc at iteration 23: 0.7021276595744681
	Train acc at iteration 25: 0.8012820512820513
	Val acc at iteration 24: 0.7446808510638298
	Train acc at iteration 26: 0.7980769230769231
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.7612179487179487
	Val acc at iteration 26: 0.6914893617021277
	Train acc at iteration 28: 0.7692307692307693
	Val acc at iteration 27: 0.7659574468085106
	Train acc at iteration 29: 0.7628205128205128
	Val acc at iteration 28: 0.7127659574468085
	Train acc at iteration 30: 0.8028846153846154
	Val acc at iteration 29: 0.7021276595744681
	Train acc at iteration 31: 0.780448717948718
	Val acc at iteration 30: 0.648936170212766
	Train acc at iteration 32: 0.8092948717948718
	Val acc at iteration 31: 0.7021276595744681
	Train acc at iteration 33: 0.7692307692307693
	Val acc at iteration 32: 0.7340425531914894
	Train acc at iteration 34: 0.7948717948717948
	Val acc at iteration 33: 0.723404255319149
	Train acc at iteration 35: 0.7708333333333334
	Val acc at iteration 34: 0.6595744680851063
	Train acc at iteration 36: 0.7836538461538461
	Val acc at iteration 35: 0.6914893617021277
	Train acc at iteration 37: 0.7676282051282052
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.7740384615384616
	Val acc at iteration 37: 0.7340425531914894
	Train acc at iteration 39: 0.782051282051282
	Val acc at iteration 38: 0.7340425531914894
	Train acc at iteration 40: 0.7836538461538461
	Val acc at iteration 39: 0.7340425531914894
	Train acc at iteration 41: 0.7788461538461539
	Val acc at iteration 40: 0.648936170212766
	Train acc at iteration 42: 0.7644230769230769
	Val acc at iteration 41: 0.7127659574468085
	Train acc at iteration 43: 0.7996794871794872
	Val acc at iteration 42: 0.7021276595744681
	Train acc at iteration 44: 0.780448717948718
	Val acc at iteration 43: 0.7446808510638298
	Train acc at iteration 45: 0.7836538461538461
	Val acc at iteration 44: 0.7127659574468085
	Train acc at iteration 46: 0.7628205128205128
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.780448717948718
	Val acc at iteration 46: 0.6808510638297872
	Train acc at iteration 48: 0.7692307692307693
	Val acc at iteration 47: 0.574468085106383
	Train acc at iteration 49: 0.7788461538461539
	Val acc at iteration 48: 0.6382978723404256
	Train acc at iteration 50: 0.7724358974358975
	Val acc at iteration 49: 0.6702127659574468
	Train acc at iteration 51: 0.7900641025641025
	Val acc at iteration 50: 0.5957446808510638
	Train acc at iteration 52: 0.7948717948717948
	Val acc at iteration 51: 0.7127659574468085
	Train acc at iteration 53: 0.7996794871794872
	Val acc at iteration 52: 0.6595744680851063
	Train acc at iteration 54: 0.8044871794871795
	Val acc at iteration 53: 0.7021276595744681
	Train acc at iteration 55: 0.7916666666666666
	Val acc at iteration 54: 0.7446808510638298
	Train acc at iteration 56: 0.7483974358974359
	Val acc at iteration 55: 0.7446808510638298
	Train acc at iteration 57: 0.7884615384615384
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.7692307692307693
	Val acc at iteration 57: 0.6808510638297872
	Train acc at iteration 59: 0.7708333333333334
	Val acc at iteration 58: 0.7021276595744681
	Train acc at iteration 60: 0.7548076923076923
	Val acc at iteration 59: 0.6808510638297872
	Train acc at iteration 61: 0.780448717948718
	Val acc at iteration 60: 0.6914893617021277
	Train acc at iteration 62: 0.7692307692307693
	Val acc at iteration 61: 0.7340425531914894
	Train acc at iteration 63: 0.7548076923076923
	Val acc at iteration 62: 0.7021276595744681
	Train acc at iteration 64: 0.7419871794871795
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.782051282051282
	Val acc at iteration 64: 0.6914893617021277
	Train acc at iteration 66: 0.7836538461538461
	Val acc at iteration 65: 0.7127659574468085
	Train acc at iteration 67: 0.7628205128205128
	Val acc at iteration 66: 0.7021276595744681
	Train acc at iteration 68: 0.7483974358974359
	Val acc at iteration 67: 0.7872340425531915
	Train acc at iteration 69: 0.7788461538461539
	Val acc at iteration 68: 0.7340425531914894
	Train acc at iteration 70: 0.7916666666666666
	Val acc at iteration 69: 0.6702127659574468
	Train acc at iteration 71: 0.782051282051282
	Val acc at iteration 70: 0.6702127659574468
	Train acc at iteration 72: 0.782051282051282
	Val acc at iteration 71: 0.6702127659574468
	Train acc at iteration 73: 0.7948717948717948
	Val acc at iteration 72: 0.6276595744680851
	Train acc at iteration 74: 0.7772435897435898
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.7916666666666666
	Val acc at iteration 74: 0.7021276595744681
	Train acc at iteration 76: 0.7964743589743589
	Val acc at iteration 75: 0.6382978723404256
	Train acc at iteration 77: 0.7756410256410257
	Val acc at iteration 76: 0.6702127659574468
	Train acc at iteration 78: 0.7692307692307693
	Val acc at iteration 77: 0.7446808510638298
	Train acc at iteration 79: 0.7852564102564102
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.7852564102564102
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.7852564102564102
	Val acc at iteration 80: 0.7340425531914894
	Train acc at iteration 82: 0.7788461538461539
	Val acc at iteration 81: 0.7553191489361702
	Train acc at iteration 83: 0.7772435897435898
	Val acc at iteration 82: 0.7340425531914894
	Train acc at iteration 84: 0.7644230769230769
	Val acc at iteration 83: 0.6808510638297872
	Train acc at iteration 85: 0.7964743589743589
	Val acc at iteration 84: 0.6702127659574468
	Train acc at iteration 86: 0.7788461538461539
	Val acc at iteration 85: 0.7127659574468085
	Train acc at iteration 87: 0.7980769230769231
	Val acc at iteration 86: 0.7553191489361702
	Train acc at iteration 88: 0.7852564102564102
	Val acc at iteration 87: 0.6702127659574468
	Train acc at iteration 89: 0.7884615384615384
	Val acc at iteration 88: 0.7021276595744681
	Train acc at iteration 90: 0.8076923076923077
	Val acc at iteration 89: 0.6702127659574468
	Train acc at iteration 91: 0.7868589743589743
	Val acc at iteration 90: 0.7872340425531915
	Train acc at iteration 92: 0.7676282051282052
	Val acc at iteration 91: 0.723404255319149
	Train acc at iteration 93: 0.7451923076923077
	Val acc at iteration 92: 0.6808510638297872
	Train acc at iteration 94: 0.7836538461538461
	Val acc at iteration 93: 0.6702127659574468
	Train acc at iteration 95: 0.782051282051282
	Val acc at iteration 94: 0.6808510638297872
	Train acc at iteration 96: 0.7772435897435898
	Val acc at iteration 95: 0.723404255319149
	Train acc at iteration 97: 0.7772435897435898
	Val acc at iteration 96: 0.7340425531914894
	Train acc at iteration 98: 0.7884615384615384
	Val acc at iteration 97: 0.6914893617021277
	Train acc at iteration 99: 0.7644230769230769
	Val acc at iteration 98: 0.7446808510638298
	Train acc at iteration 100: 0.7548076923076923
	Val acc at iteration 99: 0.7446808510638298
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5611111111111112
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.5159420289855072
Final test micro accuracy: 0.6276595744680851
Final validation:
	Cluster: 0.6380044519901276
	Separation: 0.545400857925415
Final test:
	Cluster: 0.6092746555805206
	Separation: 0.5394627153873444
Saved Results

Attempting combination 11/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 0.24
l1_weight: 1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.031914893617021274
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.24468085106382978
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.48936170212765956
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6702127659574468
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7021276595744681
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.7340425531914894
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7948717948717948
	Cluster: 0.6544625282287597
	Separation: 0.525260591506958
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.7553191489361702
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.7446808510638298
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6170212765957447
	Val acc at iteration 14: 0.6170212765957447
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.6063829787234043
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.7021276595744681
	Val acc at iteration 19: 0.7978723404255319
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.5957446808510638
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.6382978723404256
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.6276595744680851
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6170212765957447
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.6276595744680851
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.6276595744680851
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.6808510638297872
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.6170212765957447
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.648936170212766
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.574468085106383
	Val acc at iteration 84: 0.723404255319149
	Val acc at iteration 85: 0.6170212765957447
	Val acc at iteration 86: 0.6276595744680851
	Val acc at iteration 87: 0.6702127659574468
	Val acc at iteration 88: 0.6914893617021277
	Val acc at iteration 89: 0.7127659574468085
	Val acc at iteration 90: 0.6808510638297872
	Val acc at iteration 91: 0.5957446808510638
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.648936170212766
	Val acc at iteration 94: 0.7021276595744681
	Val acc at iteration 95: 0.6808510638297872
	Val acc at iteration 96: 0.7021276595744681
	Val acc at iteration 97: 0.723404255319149
	Val acc at iteration 98: 0.7021276595744681
	Val acc at iteration 99: 0.7021276595744681
Val acc before epoch 16: 0.6914893617021277
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Cluster: 0.657747995853424
	Separation: 0.5252152681350708
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.776595744680851
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.6382978723404256
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.6382978723404256
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.6276595744680851
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.5957446808510638
	Val acc at iteration 61: 0.6170212765957447
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.6063829787234043
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.6170212765957447
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.6276595744680851
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.6382978723404256
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.7021276595744681
	Val acc at iteration 85: 0.6276595744680851
	Val acc at iteration 86: 0.6702127659574468
	Val acc at iteration 87: 0.7021276595744681
	Val acc at iteration 88: 0.6595744680851063
	Val acc at iteration 89: 0.7127659574468085
	Val acc at iteration 90: 0.723404255319149
	Val acc at iteration 91: 0.7021276595744681
	Val acc at iteration 92: 0.7872340425531915
	Val acc at iteration 93: 0.6382978723404256
	Val acc at iteration 94: 0.5957446808510638
	Val acc at iteration 95: 0.7021276595744681
	Val acc at iteration 96: 0.6914893617021277
	Val acc at iteration 97: 0.7446808510638298
	Val acc at iteration 98: 0.6914893617021277
	Val acc at iteration 99: 0.6914893617021277
Val acc before epoch 26: 0.7340425531914894
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7553191489361702
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8191489361702128
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8829787234042553
Stopping after epoch 36.
Final validation accuracy before push: 88.29787234042553%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Cluster: 0.6579797267913818
	Separation: 0.5206440210342407
(After push) Val acc at iteration 0: 0.6170212765957447
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7916666666666666
	Val acc at iteration 0: 0.6914893617021277
	Train acc at iteration 2: 0.7836538461538461
	Val acc at iteration 1: 0.6702127659574468
	Train acc at iteration 3: 0.7884615384615384
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.8125
	Val acc at iteration 3: 0.6276595744680851
	Train acc at iteration 5: 0.7580128205128205
	Val acc at iteration 4: 0.6702127659574468
	Train acc at iteration 6: 0.7548076923076923
	Val acc at iteration 5: 0.6808510638297872
	Train acc at iteration 7: 0.7660256410256411
	Val acc at iteration 6: 0.7127659574468085
	Train acc at iteration 8: 0.7868589743589743
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.780448717948718
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8076923076923077
	Val acc at iteration 9: 0.6595744680851063
	Train acc at iteration 11: 0.8141025641025641
	Val acc at iteration 10: 0.6808510638297872
	Train acc at iteration 12: 0.7900641025641025
	Val acc at iteration 11: 0.648936170212766
	Train acc at iteration 13: 0.7884615384615384
	Val acc at iteration 12: 0.6595744680851063
	Train acc at iteration 14: 0.8028846153846154
	Val acc at iteration 13: 0.7340425531914894
	Train acc at iteration 15: 0.782051282051282
	Val acc at iteration 14: 0.7446808510638298
	Train acc at iteration 16: 0.8076923076923077
	Val acc at iteration 15: 0.7127659574468085
	Train acc at iteration 17: 0.8108974358974359
	Val acc at iteration 16: 0.648936170212766
	Train acc at iteration 18: 0.8012820512820513
	Val acc at iteration 17: 0.5638297872340425
	Train acc at iteration 19: 0.7868589743589743
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.7996794871794872
	Val acc at iteration 19: 0.6595744680851063
	Train acc at iteration 21: 0.7980769230769231
	Val acc at iteration 20: 0.6914893617021277
	Train acc at iteration 22: 0.7676282051282052
	Val acc at iteration 21: 0.723404255319149
	Train acc at iteration 23: 0.8012820512820513
	Val acc at iteration 22: 0.7340425531914894
	Train acc at iteration 24: 0.7692307692307693
	Val acc at iteration 23: 0.6808510638297872
	Train acc at iteration 25: 0.7868589743589743
	Val acc at iteration 24: 0.6276595744680851
	Train acc at iteration 26: 0.7740384615384616
	Val acc at iteration 25: 0.6382978723404256
	Train acc at iteration 27: 0.7900641025641025
	Val acc at iteration 26: 0.6595744680851063
	Train acc at iteration 28: 0.7964743589743589
	Val acc at iteration 27: 0.7021276595744681
	Train acc at iteration 29: 0.7580128205128205
	Val acc at iteration 28: 0.6276595744680851
	Train acc at iteration 30: 0.7948717948717948
	Val acc at iteration 29: 0.6702127659574468
	Train acc at iteration 31: 0.7836538461538461
	Val acc at iteration 30: 0.723404255319149
	Train acc at iteration 32: 0.7628205128205128
	Val acc at iteration 31: 0.6382978723404256
	Train acc at iteration 33: 0.8028846153846154
	Val acc at iteration 32: 0.6808510638297872
	Train acc at iteration 34: 0.8205128205128205
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.7756410256410257
	Val acc at iteration 34: 0.6914893617021277
	Train acc at iteration 36: 0.7644230769230769
	Val acc at iteration 35: 0.7127659574468085
	Train acc at iteration 37: 0.8028846153846154
	Val acc at iteration 36: 0.6276595744680851
	Train acc at iteration 38: 0.7836538461538461
	Val acc at iteration 37: 0.6914893617021277
	Train acc at iteration 39: 0.8012820512820513
	Val acc at iteration 38: 0.7553191489361702
	Train acc at iteration 40: 0.7692307692307693
	Val acc at iteration 39: 0.7340425531914894
	Train acc at iteration 41: 0.7884615384615384
	Val acc at iteration 40: 0.6914893617021277
	Train acc at iteration 42: 0.7692307692307693
	Val acc at iteration 41: 0.6595744680851063
	Train acc at iteration 43: 0.7884615384615384
	Val acc at iteration 42: 0.723404255319149
	Train acc at iteration 44: 0.7772435897435898
	Val acc at iteration 43: 0.6808510638297872
	Train acc at iteration 45: 0.7900641025641025
	Val acc at iteration 44: 0.723404255319149
	Train acc at iteration 46: 0.7852564102564102
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.8157051282051282
	Val acc at iteration 46: 0.7340425531914894
	Train acc at iteration 48: 0.782051282051282
	Val acc at iteration 47: 0.7659574468085106
	Train acc at iteration 49: 0.7932692307692307
	Val acc at iteration 48: 0.723404255319149
	Train acc at iteration 50: 0.7980769230769231
	Val acc at iteration 49: 0.7127659574468085
	Train acc at iteration 51: 0.7708333333333334
	Val acc at iteration 50: 0.6276595744680851
	Train acc at iteration 52: 0.7980769230769231
	Val acc at iteration 51: 0.7340425531914894
	Train acc at iteration 53: 0.8205128205128205
	Val acc at iteration 52: 0.7127659574468085
	Train acc at iteration 54: 0.7884615384615384
	Val acc at iteration 53: 0.7127659574468085
	Train acc at iteration 55: 0.7644230769230769
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.7836538461538461
	Val acc at iteration 55: 0.7127659574468085
	Train acc at iteration 57: 0.7884615384615384
	Val acc at iteration 56: 0.5638297872340425
	Train acc at iteration 58: 0.7852564102564102
	Val acc at iteration 57: 0.5957446808510638
	Train acc at iteration 59: 0.8141025641025641
	Val acc at iteration 58: 0.6063829787234043
	Train acc at iteration 60: 0.7516025641025641
	Val acc at iteration 59: 0.648936170212766
	Train acc at iteration 61: 0.782051282051282
	Val acc at iteration 60: 0.776595744680851
	Train acc at iteration 62: 0.7932692307692307
	Val acc at iteration 61: 0.6914893617021277
	Train acc at iteration 63: 0.7964743589743589
	Val acc at iteration 62: 0.7127659574468085
	Train acc at iteration 64: 0.7932692307692307
	Val acc at iteration 63: 0.6702127659574468
	Train acc at iteration 65: 0.7980769230769231
	Val acc at iteration 64: 0.6808510638297872
	Train acc at iteration 66: 0.7548076923076923
	Val acc at iteration 65: 0.723404255319149
	Train acc at iteration 67: 0.8141025641025641
	Val acc at iteration 66: 0.7446808510638298
	Train acc at iteration 68: 0.8044871794871795
	Val acc at iteration 67: 0.648936170212766
	Train acc at iteration 69: 0.7948717948717948
	Val acc at iteration 68: 0.7127659574468085
	Train acc at iteration 70: 0.7916666666666666
	Val acc at iteration 69: 0.5957446808510638
	Train acc at iteration 71: 0.7932692307692307
	Val acc at iteration 70: 0.6276595744680851
	Train acc at iteration 72: 0.7932692307692307
	Val acc at iteration 71: 0.723404255319149
	Train acc at iteration 73: 0.7884615384615384
	Val acc at iteration 72: 0.6808510638297872
	Train acc at iteration 74: 0.782051282051282
	Val acc at iteration 73: 0.6382978723404256
	Train acc at iteration 75: 0.8044871794871795
	Val acc at iteration 74: 0.6914893617021277
	Train acc at iteration 76: 0.8028846153846154
	Val acc at iteration 75: 0.6914893617021277
	Train acc at iteration 77: 0.7884615384615384
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.782051282051282
	Val acc at iteration 77: 0.7021276595744681
	Train acc at iteration 79: 0.7596153846153846
	Val acc at iteration 78: 0.7021276595744681
	Train acc at iteration 80: 0.7948717948717948
	Val acc at iteration 79: 0.5851063829787234
	Train acc at iteration 81: 0.7612179487179487
	Val acc at iteration 80: 0.776595744680851
	Train acc at iteration 82: 0.7772435897435898
	Val acc at iteration 81: 0.723404255319149
	Train acc at iteration 83: 0.7676282051282052
	Val acc at iteration 82: 0.648936170212766
	Train acc at iteration 84: 0.7756410256410257
	Val acc at iteration 83: 0.5957446808510638
	Train acc at iteration 85: 0.8028846153846154
	Val acc at iteration 84: 0.6808510638297872
	Train acc at iteration 86: 0.7948717948717948
	Val acc at iteration 85: 0.6702127659574468
	Train acc at iteration 87: 0.7932692307692307
	Val acc at iteration 86: 0.6702127659574468
	Train acc at iteration 88: 0.7852564102564102
	Val acc at iteration 87: 0.6276595744680851
	Train acc at iteration 89: 0.7884615384615384
	Val acc at iteration 88: 0.6382978723404256
	Train acc at iteration 90: 0.780448717948718
	Val acc at iteration 89: 0.7127659574468085
	Train acc at iteration 91: 0.8076923076923077
	Val acc at iteration 90: 0.7659574468085106
	Train acc at iteration 92: 0.8044871794871795
	Val acc at iteration 91: 0.648936170212766
	Train acc at iteration 93: 0.7756410256410257
	Val acc at iteration 92: 0.6808510638297872
	Train acc at iteration 94: 0.7964743589743589
	Val acc at iteration 93: 0.6276595744680851
	Train acc at iteration 95: 0.7772435897435898
	Val acc at iteration 94: 0.6276595744680851
	Train acc at iteration 96: 0.7980769230769231
	Val acc at iteration 95: 0.6914893617021277
	Train acc at iteration 97: 0.782051282051282
	Val acc at iteration 96: 0.648936170212766
	Train acc at iteration 98: 0.782051282051282
	Val acc at iteration 97: 0.6382978723404256
	Train acc at iteration 99: 0.7964743589743589
	Val acc at iteration 98: 0.6808510638297872
	Train acc at iteration 100: 0.8060897435897436
	Val acc at iteration 99: 0.6170212765957447
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5687074829931973
Final val micro accuracy: 0.6595744680851063
Final test macro f1-score: 0.4797101449275362
Final test micro accuracy: 0.5957446808510638
Final validation:
	Cluster: 0.6347131729125977
	Separation: 0.5482827723026276
Final test:
	Cluster: 0.6086686253547668
	Separation: 0.53487229347229
Saved Results

Attempting combination 12/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 0.24
l1_weight: 0.1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.2553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5106382978723404
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6382978723404256
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.6808510638297872
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7932692307692307
	Cluster: 0.6540820360183716
	Separation: 0.5245677351951599
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.776595744680851
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7446808510638298
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.776595744680851
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.6382978723404256
	Val acc at iteration 37: 0.5957446808510638
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.7553191489361702
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.776595744680851
	Val acc at iteration 45: 0.7553191489361702
	Val acc at iteration 46: 0.6063829787234043
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.7446808510638298
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.776595744680851
	Val acc at iteration 59: 0.7872340425531915
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6276595744680851
	Val acc at iteration 63: 0.5638297872340425
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7978723404255319
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.723404255319149
	Val acc at iteration 85: 0.6170212765957447
	Val acc at iteration 86: 0.7446808510638298
	Val acc at iteration 87: 0.7127659574468085
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.723404255319149
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.6595744680851063
	Val acc at iteration 92: 0.6595744680851063
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.648936170212766
	Val acc at iteration 95: 0.7553191489361702
	Val acc at iteration 96: 0.6914893617021277
	Val acc at iteration 97: 0.7446808510638298
	Val acc at iteration 98: 0.7021276595744681
	Val acc at iteration 99: 0.6808510638297872
Val acc before epoch 16: 0.7127659574468085
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Cluster: 0.647354531288147
	Separation: 0.5195643305778503
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.7659574468085106
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.7553191489361702
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.7446808510638298
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.7872340425531915
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.7659574468085106
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.776595744680851
	Val acc at iteration 22: 0.7446808510638298
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.8085106382978723
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7872340425531915
	Val acc at iteration 41: 0.8191489361702128
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.6382978723404256
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.776595744680851
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7872340425531915
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.7659574468085106
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.6808510638297872
	Val acc at iteration 85: 0.723404255319149
	Val acc at iteration 86: 0.7127659574468085
	Val acc at iteration 87: 0.7127659574468085
	Val acc at iteration 88: 0.723404255319149
	Val acc at iteration 89: 0.723404255319149
	Val acc at iteration 90: 0.7021276595744681
	Val acc at iteration 91: 0.6595744680851063
	Val acc at iteration 92: 0.7340425531914894
	Val acc at iteration 93: 0.723404255319149
	Val acc at iteration 94: 0.7340425531914894
	Val acc at iteration 95: 0.723404255319149
	Val acc at iteration 96: 0.648936170212766
	Val acc at iteration 97: 0.776595744680851
	Val acc at iteration 98: 0.6595744680851063
	Val acc at iteration 99: 0.7446808510638298
Val acc before epoch 26: 0.7127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7446808510638298
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9148936170212766
Stopping after epoch 36.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Cluster: 0.6482773303985596
	Separation: 0.51480553150177
(After push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7724358974358975
	Val acc at iteration 0: 0.7446808510638298
	Train acc at iteration 2: 0.8108974358974359
	Val acc at iteration 1: 0.6702127659574468
	Train acc at iteration 3: 0.7756410256410257
	Val acc at iteration 2: 0.7446808510638298
	Train acc at iteration 4: 0.8108974358974359
	Val acc at iteration 3: 0.6702127659574468
	Train acc at iteration 5: 0.7660256410256411
	Val acc at iteration 4: 0.7340425531914894
	Train acc at iteration 6: 0.7836538461538461
	Val acc at iteration 5: 0.7446808510638298
	Train acc at iteration 7: 0.7884615384615384
	Val acc at iteration 6: 0.7446808510638298
	Train acc at iteration 8: 0.7980769230769231
	Val acc at iteration 7: 0.6063829787234043
	Train acc at iteration 9: 0.7644230769230769
	Val acc at iteration 8: 0.7978723404255319
	Train acc at iteration 10: 0.7884615384615384
	Val acc at iteration 9: 0.7127659574468085
	Train acc at iteration 11: 0.7932692307692307
	Val acc at iteration 10: 0.7127659574468085
	Train acc at iteration 12: 0.8044871794871795
	Val acc at iteration 11: 0.7340425531914894
	Train acc at iteration 13: 0.8028846153846154
	Val acc at iteration 12: 0.6702127659574468
	Train acc at iteration 14: 0.7948717948717948
	Val acc at iteration 13: 0.6914893617021277
	Train acc at iteration 15: 0.7772435897435898
	Val acc at iteration 14: 0.6914893617021277
	Train acc at iteration 16: 0.7852564102564102
	Val acc at iteration 15: 0.648936170212766
	Train acc at iteration 17: 0.7900641025641025
	Val acc at iteration 16: 0.7340425531914894
	Train acc at iteration 18: 0.8012820512820513
	Val acc at iteration 17: 0.723404255319149
	Train acc at iteration 19: 0.7980769230769231
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.8028846153846154
	Val acc at iteration 19: 0.7340425531914894
	Train acc at iteration 21: 0.7836538461538461
	Val acc at iteration 20: 0.7340425531914894
	Train acc at iteration 22: 0.7660256410256411
	Val acc at iteration 21: 0.6808510638297872
	Train acc at iteration 23: 0.7996794871794872
	Val acc at iteration 22: 0.7340425531914894
	Train acc at iteration 24: 0.7868589743589743
	Val acc at iteration 23: 0.7021276595744681
	Train acc at iteration 25: 0.7868589743589743
	Val acc at iteration 24: 0.7127659574468085
	Train acc at iteration 26: 0.7708333333333334
	Val acc at iteration 25: 0.6382978723404256
	Train acc at iteration 27: 0.7980769230769231
	Val acc at iteration 26: 0.723404255319149
	Train acc at iteration 28: 0.7660256410256411
	Val acc at iteration 27: 0.7340425531914894
	Train acc at iteration 29: 0.8125
	Val acc at iteration 28: 0.6808510638297872
	Train acc at iteration 30: 0.7852564102564102
	Val acc at iteration 29: 0.7553191489361702
	Train acc at iteration 31: 0.8012820512820513
	Val acc at iteration 30: 0.6595744680851063
	Train acc at iteration 32: 0.8076923076923077
	Val acc at iteration 31: 0.7127659574468085
	Train acc at iteration 33: 0.7916666666666666
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.7964743589743589
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.7756410256410257
	Val acc at iteration 34: 0.6808510638297872
	Train acc at iteration 36: 0.7676282051282052
	Val acc at iteration 35: 0.7127659574468085
	Train acc at iteration 37: 0.780448717948718
	Val acc at iteration 36: 0.7553191489361702
	Train acc at iteration 38: 0.780448717948718
	Val acc at iteration 37: 0.7446808510638298
	Train acc at iteration 39: 0.7996794871794872
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.7900641025641025
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.782051282051282
	Val acc at iteration 40: 0.6808510638297872
	Train acc at iteration 42: 0.7564102564102564
	Val acc at iteration 41: 0.6382978723404256
	Train acc at iteration 43: 0.7932692307692307
	Val acc at iteration 42: 0.6382978723404256
	Train acc at iteration 44: 0.7580128205128205
	Val acc at iteration 43: 0.723404255319149
	Train acc at iteration 45: 0.7612179487179487
	Val acc at iteration 44: 0.7340425531914894
	Train acc at iteration 46: 0.7708333333333334
	Val acc at iteration 45: 0.7021276595744681
	Train acc at iteration 47: 0.7772435897435898
	Val acc at iteration 46: 0.7659574468085106
	Train acc at iteration 48: 0.782051282051282
	Val acc at iteration 47: 0.7021276595744681
	Train acc at iteration 49: 0.7868589743589743
	Val acc at iteration 48: 0.7446808510638298
	Train acc at iteration 50: 0.7756410256410257
	Val acc at iteration 49: 0.7340425531914894
	Train acc at iteration 51: 0.7900641025641025
	Val acc at iteration 50: 0.648936170212766
	Train acc at iteration 52: 0.7916666666666666
	Val acc at iteration 51: 0.6595744680851063
	Train acc at iteration 53: 0.7788461538461539
	Val acc at iteration 52: 0.723404255319149
	Train acc at iteration 54: 0.7948717948717948
	Val acc at iteration 53: 0.7446808510638298
	Train acc at iteration 55: 0.7788461538461539
	Val acc at iteration 54: 0.7127659574468085
	Train acc at iteration 56: 0.7996794871794872
	Val acc at iteration 55: 0.6702127659574468
	Train acc at iteration 57: 0.7916666666666666
	Val acc at iteration 56: 0.723404255319149
	Train acc at iteration 58: 0.7932692307692307
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.780448717948718
	Val acc at iteration 58: 0.6808510638297872
	Train acc at iteration 60: 0.7932692307692307
	Val acc at iteration 59: 0.7127659574468085
	Train acc at iteration 61: 0.7884615384615384
	Val acc at iteration 60: 0.6702127659574468
	Train acc at iteration 62: 0.7932692307692307
	Val acc at iteration 61: 0.7340425531914894
	Train acc at iteration 63: 0.7884615384615384
	Val acc at iteration 62: 0.6595744680851063
	Train acc at iteration 64: 0.7692307692307693
	Val acc at iteration 63: 0.6808510638297872
	Train acc at iteration 65: 0.7948717948717948
	Val acc at iteration 64: 0.723404255319149
	Train acc at iteration 66: 0.7932692307692307
	Val acc at iteration 65: 0.7872340425531915
	Train acc at iteration 67: 0.7772435897435898
	Val acc at iteration 66: 0.6702127659574468
	Train acc at iteration 68: 0.780448717948718
	Val acc at iteration 67: 0.7553191489361702
	Train acc at iteration 69: 0.7884615384615384
	Val acc at iteration 68: 0.648936170212766
	Train acc at iteration 70: 0.7948717948717948
	Val acc at iteration 69: 0.7127659574468085
	Train acc at iteration 71: 0.7932692307692307
	Val acc at iteration 70: 0.776595744680851
	Train acc at iteration 72: 0.7772435897435898
	Val acc at iteration 71: 0.7446808510638298
	Train acc at iteration 73: 0.8076923076923077
	Val acc at iteration 72: 0.6276595744680851
	Train acc at iteration 74: 0.7660256410256411
	Val acc at iteration 73: 0.7340425531914894
	Train acc at iteration 75: 0.7756410256410257
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.7884615384615384
	Val acc at iteration 75: 0.5957446808510638
	Train acc at iteration 77: 0.7868589743589743
	Val acc at iteration 76: 0.7872340425531915
	Train acc at iteration 78: 0.7836538461538461
	Val acc at iteration 77: 0.6914893617021277
	Train acc at iteration 79: 0.7884615384615384
	Val acc at iteration 78: 0.7021276595744681
	Train acc at iteration 80: 0.7964743589743589
	Val acc at iteration 79: 0.6063829787234043
	Train acc at iteration 81: 0.7884615384615384
	Val acc at iteration 80: 0.776595744680851
	Train acc at iteration 82: 0.7884615384615384
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7788461538461539
	Val acc at iteration 82: 0.7127659574468085
	Train acc at iteration 84: 0.8157051282051282
	Val acc at iteration 83: 0.7127659574468085
	Train acc at iteration 85: 0.780448717948718
	Val acc at iteration 84: 0.723404255319149
	Train acc at iteration 86: 0.7948717948717948
	Val acc at iteration 85: 0.6276595744680851
	Train acc at iteration 87: 0.7756410256410257
	Val acc at iteration 86: 0.7872340425531915
	Train acc at iteration 88: 0.7596153846153846
	Val acc at iteration 87: 0.723404255319149
	Train acc at iteration 89: 0.7900641025641025
	Val acc at iteration 88: 0.648936170212766
	Train acc at iteration 90: 0.7932692307692307
	Val acc at iteration 89: 0.723404255319149
	Train acc at iteration 91: 0.7868589743589743
	Val acc at iteration 90: 0.776595744680851
	Train acc at iteration 92: 0.8060897435897436
	Val acc at iteration 91: 0.7021276595744681
	Train acc at iteration 93: 0.8028846153846154
	Val acc at iteration 92: 0.776595744680851
	Train acc at iteration 94: 0.7868589743589743
	Val acc at iteration 93: 0.7127659574468085
	Train acc at iteration 95: 0.7932692307692307
	Val acc at iteration 94: 0.7340425531914894
	Train acc at iteration 96: 0.7852564102564102
	Val acc at iteration 95: 0.7340425531914894
	Train acc at iteration 97: 0.8157051282051282
	Val acc at iteration 96: 0.7446808510638298
	Train acc at iteration 98: 0.7948717948717948
	Val acc at iteration 97: 0.6914893617021277
	Train acc at iteration 99: 0.7836538461538461
	Val acc at iteration 98: 0.7127659574468085
	Train acc at iteration 100: 0.8173076923076923
	Val acc at iteration 99: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6145833333333334
Final val micro accuracy: 0.723404255319149
Final test macro f1-score: 0.4625468164794007
Final test micro accuracy: 0.5957446808510638
Final validation:
	Cluster: 0.6299822330474854
	Separation: 0.5449562966823578
Final test:
	Cluster: 0.5933898985385895
	Separation: 0.5344310700893402
Saved Results

Attempting combination 13/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 0.24
l1_weight: 0.01
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.2872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6914893617021277
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7446808510638298
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Cluster: 0.6531775951385498
	Separation: 0.5239974141120911
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.5851063829787234
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.648936170212766
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.6276595744680851
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.5957446808510638
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.5638297872340425
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.6063829787234043
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.648936170212766
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6170212765957447
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.6382978723404256
	Val acc at iteration 44: 0.6063829787234043
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.6382978723404256
	Val acc at iteration 51: 0.6063829787234043
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.6063829787234043
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.6276595744680851
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.6063829787234043
	Val acc at iteration 62: 0.5638297872340425
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.6276595744680851
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.648936170212766
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.6382978723404256
	Val acc at iteration 78: 0.6276595744680851
	Val acc at iteration 79: 0.648936170212766
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.5531914893617021
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.6170212765957447
	Val acc at iteration 85: 0.6276595744680851
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.6276595744680851
	Val acc at iteration 88: 0.6063829787234043
	Val acc at iteration 89: 0.6170212765957447
	Val acc at iteration 90: 0.723404255319149
	Val acc at iteration 91: 0.6170212765957447
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.6595744680851063
	Val acc at iteration 94: 0.6382978723404256
	Val acc at iteration 95: 0.6382978723404256
	Val acc at iteration 96: 0.6702127659574468
	Val acc at iteration 97: 0.7446808510638298
	Val acc at iteration 98: 0.6276595744680851
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 16: 0.6595744680851063
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7659574468085106
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8191489361702128
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.8297872340425532
Push epoch
After push, before retraining last layer:
	Train acc: 0.7676282051282052
	Cluster: 0.6510391712188721
	Separation: 0.5227339148521424
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.5851063829787234
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.6276595744680851
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.6276595744680851
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.5957446808510638
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.5957446808510638
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.574468085106383
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.6276595744680851
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.648936170212766
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.6382978723404256
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.6276595744680851
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.6063829787234043
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.6382978723404256
	Val acc at iteration 77: 0.574468085106383
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.6276595744680851
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.6808510638297872
	Val acc at iteration 85: 0.7127659574468085
	Val acc at iteration 86: 0.6595744680851063
	Val acc at iteration 87: 0.723404255319149
	Val acc at iteration 88: 0.6595744680851063
	Val acc at iteration 89: 0.6702127659574468
	Val acc at iteration 90: 0.6170212765957447
	Val acc at iteration 91: 0.6914893617021277
	Val acc at iteration 92: 0.7127659574468085
	Val acc at iteration 93: 0.648936170212766
	Val acc at iteration 94: 0.6702127659574468
	Val acc at iteration 95: 0.6382978723404256
	Val acc at iteration 96: 0.6382978723404256
	Val acc at iteration 97: 0.6170212765957447
	Val acc at iteration 98: 0.6808510638297872
	Val acc at iteration 99: 0.6702127659574468
Val acc before epoch 26: 0.648936170212766
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7659574468085106
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8191489361702128
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.7659574468085106
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8297872340425532
Stopping after epoch 36.
Final validation accuracy before push: 82.97872340425532%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7948717948717948
	Cluster: 0.6468974113464355
	Separation: 0.5233341813087463
(After push) Val acc at iteration 0: 0.648936170212766
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7708333333333334
	Val acc at iteration 0: 0.6276595744680851
	Train acc at iteration 2: 0.7628205128205128
	Val acc at iteration 1: 0.5851063829787234
	Train acc at iteration 3: 0.7772435897435898
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.7884615384615384
	Val acc at iteration 3: 0.6063829787234043
	Train acc at iteration 5: 0.7852564102564102
	Val acc at iteration 4: 0.6595744680851063
	Train acc at iteration 6: 0.8012820512820513
	Val acc at iteration 5: 0.6808510638297872
	Train acc at iteration 7: 0.7948717948717948
	Val acc at iteration 6: 0.5957446808510638
	Train acc at iteration 8: 0.8076923076923077
	Val acc at iteration 7: 0.6702127659574468
	Train acc at iteration 9: 0.780448717948718
	Val acc at iteration 8: 0.648936170212766
	Train acc at iteration 10: 0.8012820512820513
	Val acc at iteration 9: 0.6808510638297872
	Train acc at iteration 11: 0.7628205128205128
	Val acc at iteration 10: 0.723404255319149
	Train acc at iteration 12: 0.7756410256410257
	Val acc at iteration 11: 0.7021276595744681
	Train acc at iteration 13: 0.7996794871794872
	Val acc at iteration 12: 0.6276595744680851
	Train acc at iteration 14: 0.7788461538461539
	Val acc at iteration 13: 0.6595744680851063
	Train acc at iteration 15: 0.7788461538461539
	Val acc at iteration 14: 0.6595744680851063
	Train acc at iteration 16: 0.782051282051282
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.780448717948718
	Val acc at iteration 16: 0.7553191489361702
	Train acc at iteration 18: 0.7884615384615384
	Val acc at iteration 17: 0.6702127659574468
	Train acc at iteration 19: 0.7868589743589743
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.7451923076923077
	Val acc at iteration 19: 0.5638297872340425
	Train acc at iteration 21: 0.7836538461538461
	Val acc at iteration 20: 0.6276595744680851
	Train acc at iteration 22: 0.7884615384615384
	Val acc at iteration 21: 0.7340425531914894
	Train acc at iteration 23: 0.7852564102564102
	Val acc at iteration 22: 0.6595744680851063
	Train acc at iteration 24: 0.7548076923076923
	Val acc at iteration 23: 0.6382978723404256
	Train acc at iteration 25: 0.8044871794871795
	Val acc at iteration 24: 0.7553191489361702
	Train acc at iteration 26: 0.7884615384615384
	Val acc at iteration 25: 0.6382978723404256
	Train acc at iteration 27: 0.7740384615384616
	Val acc at iteration 26: 0.5957446808510638
	Train acc at iteration 28: 0.7852564102564102
	Val acc at iteration 27: 0.6170212765957447
	Train acc at iteration 29: 0.7724358974358975
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.8028846153846154
	Val acc at iteration 29: 0.6914893617021277
	Train acc at iteration 31: 0.8012820512820513
	Val acc at iteration 30: 0.6702127659574468
	Train acc at iteration 32: 0.7836538461538461
	Val acc at iteration 31: 0.6808510638297872
	Train acc at iteration 33: 0.7836538461538461
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.7900641025641025
	Val acc at iteration 33: 0.6276595744680851
	Train acc at iteration 35: 0.7628205128205128
	Val acc at iteration 34: 0.6276595744680851
	Train acc at iteration 36: 0.7708333333333334
	Val acc at iteration 35: 0.6702127659574468
	Train acc at iteration 37: 0.7916666666666666
	Val acc at iteration 36: 0.648936170212766
	Train acc at iteration 38: 0.7868589743589743
	Val acc at iteration 37: 0.6276595744680851
	Train acc at iteration 39: 0.7724358974358975
	Val acc at iteration 38: 0.6914893617021277
	Train acc at iteration 40: 0.7612179487179487
	Val acc at iteration 39: 0.7127659574468085
	Train acc at iteration 41: 0.8189102564102564
	Val acc at iteration 40: 0.7021276595744681
	Train acc at iteration 42: 0.7708333333333334
	Val acc at iteration 41: 0.6276595744680851
	Train acc at iteration 43: 0.7836538461538461
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.7740384615384616
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.7916666666666666
	Val acc at iteration 44: 0.6382978723404256
	Train acc at iteration 46: 0.7932692307692307
	Val acc at iteration 45: 0.7553191489361702
	Train acc at iteration 47: 0.7756410256410257
	Val acc at iteration 46: 0.6702127659574468
	Train acc at iteration 48: 0.8076923076923077
	Val acc at iteration 47: 0.6702127659574468
	Train acc at iteration 49: 0.7852564102564102
	Val acc at iteration 48: 0.6808510638297872
	Train acc at iteration 50: 0.7948717948717948
	Val acc at iteration 49: 0.648936170212766
	Train acc at iteration 51: 0.7932692307692307
	Val acc at iteration 50: 0.6382978723404256
	Train acc at iteration 52: 0.8205128205128205
	Val acc at iteration 51: 0.6276595744680851
	Train acc at iteration 53: 0.7708333333333334
	Val acc at iteration 52: 0.6382978723404256
	Train acc at iteration 54: 0.7852564102564102
	Val acc at iteration 53: 0.6382978723404256
	Train acc at iteration 55: 0.7708333333333334
	Val acc at iteration 54: 0.6808510638297872
	Train acc at iteration 56: 0.7580128205128205
	Val acc at iteration 55: 0.648936170212766
	Train acc at iteration 57: 0.7580128205128205
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.7660256410256411
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.7916666666666666
	Val acc at iteration 58: 0.6382978723404256
	Train acc at iteration 60: 0.7628205128205128
	Val acc at iteration 59: 0.7340425531914894
	Train acc at iteration 61: 0.7772435897435898
	Val acc at iteration 60: 0.723404255319149
	Train acc at iteration 62: 0.7756410256410257
	Val acc at iteration 61: 0.6170212765957447
	Train acc at iteration 63: 0.7660256410256411
	Val acc at iteration 62: 0.6595744680851063
	Train acc at iteration 64: 0.7724358974358975
	Val acc at iteration 63: 0.6382978723404256
	Train acc at iteration 65: 0.7852564102564102
	Val acc at iteration 64: 0.6382978723404256
	Train acc at iteration 66: 0.7932692307692307
	Val acc at iteration 65: 0.648936170212766
	Train acc at iteration 67: 0.7740384615384616
	Val acc at iteration 66: 0.6595744680851063
	Train acc at iteration 68: 0.7932692307692307
	Val acc at iteration 67: 0.6808510638297872
	Train acc at iteration 69: 0.7964743589743589
	Val acc at iteration 68: 0.6914893617021277
	Train acc at iteration 70: 0.7660256410256411
	Val acc at iteration 69: 0.6595744680851063
	Train acc at iteration 71: 0.782051282051282
	Val acc at iteration 70: 0.6702127659574468
	Train acc at iteration 72: 0.7916666666666666
	Val acc at iteration 71: 0.6170212765957447
	Train acc at iteration 73: 0.7948717948717948
	Val acc at iteration 72: 0.6808510638297872
	Train acc at iteration 74: 0.7660256410256411
	Val acc at iteration 73: 0.648936170212766
	Train acc at iteration 75: 0.7948717948717948
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.7708333333333334
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.7900641025641025
	Val acc at iteration 76: 0.6808510638297872
	Train acc at iteration 78: 0.7788461538461539
	Val acc at iteration 77: 0.7340425531914894
	Train acc at iteration 79: 0.7708333333333334
	Val acc at iteration 78: 0.5957446808510638
	Train acc at iteration 80: 0.7932692307692307
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.782051282051282
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.7932692307692307
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.8012820512820513
	Val acc at iteration 82: 0.723404255319149
	Train acc at iteration 84: 0.7900641025641025
	Val acc at iteration 83: 0.6914893617021277
	Train acc at iteration 85: 0.7836538461538461
	Val acc at iteration 84: 0.6914893617021277
	Train acc at iteration 86: 0.7596153846153846
	Val acc at iteration 85: 0.7659574468085106
	Train acc at iteration 87: 0.7868589743589743
	Val acc at iteration 86: 0.648936170212766
	Train acc at iteration 88: 0.7708333333333334
	Val acc at iteration 87: 0.648936170212766
	Train acc at iteration 89: 0.7564102564102564
	Val acc at iteration 88: 0.574468085106383
	Train acc at iteration 90: 0.7772435897435898
	Val acc at iteration 89: 0.6276595744680851
	Train acc at iteration 91: 0.7756410256410257
	Val acc at iteration 90: 0.6382978723404256
	Train acc at iteration 92: 0.8012820512820513
	Val acc at iteration 91: 0.6595744680851063
	Train acc at iteration 93: 0.7884615384615384
	Val acc at iteration 92: 0.5957446808510638
	Train acc at iteration 94: 0.7660256410256411
	Val acc at iteration 93: 0.6808510638297872
	Train acc at iteration 95: 0.8108974358974359
	Val acc at iteration 94: 0.6808510638297872
	Train acc at iteration 96: 0.7836538461538461
	Val acc at iteration 95: 0.6808510638297872
	Train acc at iteration 97: 0.780448717948718
	Val acc at iteration 96: 0.6808510638297872
	Train acc at iteration 98: 0.7628205128205128
	Val acc at iteration 97: 0.6595744680851063
	Train acc at iteration 99: 0.7996794871794872
	Val acc at iteration 98: 0.6276595744680851
	Train acc at iteration 100: 0.7596153846153846
	Val acc at iteration 99: 0.6063829787234043
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6082474226804123
Final val micro accuracy: 0.7127659574468085
Final test macro f1-score: 0.4737373737373736
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.630659282207489
	Separation: 0.5461228489875793
Final test:
	Cluster: 0.601742684841156
	Separation: 0.532607764005661
Saved Results

Attempting combination 14/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -96.0
sep_weight: 0.24
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.2553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.4787234042553192
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.5425531914893617
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.648936170212766
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7948717948717948
	Cluster: 0.6495501160621643
	Separation: 0.521158766746521
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6063829787234043
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6170212765957447
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.7659574468085106
	Val acc at iteration 43: 0.7340425531914894
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.7978723404255319
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.7872340425531915
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.5851063829787234
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.6170212765957447
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.7872340425531915
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.7446808510638298
	Val acc at iteration 86: 0.7553191489361702
	Val acc at iteration 87: 0.7446808510638298
	Val acc at iteration 88: 0.6595744680851063
	Val acc at iteration 89: 0.7127659574468085
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.6382978723404256
	Val acc at iteration 92: 0.7127659574468085
	Val acc at iteration 93: 0.7659574468085106
	Val acc at iteration 94: 0.7021276595744681
	Val acc at iteration 95: 0.7978723404255319
	Val acc at iteration 96: 0.6914893617021277
	Val acc at iteration 97: 0.7127659574468085
	Val acc at iteration 98: 0.6702127659574468
	Val acc at iteration 99: 0.776595744680851
Val acc before epoch 16: 0.7340425531914894
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8173076923076923
	Cluster: 0.6526824474334717
	Separation: 0.5230765223503113
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.7553191489361702
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.7872340425531915
	Val acc at iteration 8: 0.776595744680851
	Val acc at iteration 9: 0.776595744680851
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.7446808510638298
	Val acc at iteration 12: 0.776595744680851
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.7659574468085106
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7446808510638298
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.7872340425531915
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.7872340425531915
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.7978723404255319
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.7978723404255319
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.7872340425531915
	Val acc at iteration 78: 0.7978723404255319
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7340425531914894
	Val acc at iteration 85: 0.648936170212766
	Val acc at iteration 86: 0.6595744680851063
	Val acc at iteration 87: 0.7553191489361702
	Val acc at iteration 88: 0.7659574468085106
	Val acc at iteration 89: 0.7446808510638298
	Val acc at iteration 90: 0.7127659574468085
	Val acc at iteration 91: 0.6808510638297872
	Val acc at iteration 92: 0.7127659574468085
	Val acc at iteration 93: 0.6808510638297872
	Val acc at iteration 94: 0.7446808510638298
	Val acc at iteration 95: 0.648936170212766
	Val acc at iteration 96: 0.6702127659574468
	Val acc at iteration 97: 0.7446808510638298
	Val acc at iteration 98: 0.7127659574468085
	Val acc at iteration 99: 0.7659574468085106
Val acc before epoch 26: 0.7659574468085106
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8191489361702128
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9361702127659575
Stopping after epoch 36.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8461538461538461
	Cluster: 0.6506796240806579
	Separation: 0.5200361371040344
(After push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8285256410256411
	Val acc at iteration 0: 0.776595744680851
	Train acc at iteration 2: 0.7996794871794872
	Val acc at iteration 1: 0.7446808510638298
	Train acc at iteration 3: 0.8237179487179487
	Val acc at iteration 2: 0.7659574468085106
	Train acc at iteration 4: 0.8269230769230769
	Val acc at iteration 3: 0.776595744680851
	Train acc at iteration 5: 0.8076923076923077
	Val acc at iteration 4: 0.8191489361702128
	Train acc at iteration 6: 0.7708333333333334
	Val acc at iteration 5: 0.7659574468085106
	Train acc at iteration 7: 0.8125
	Val acc at iteration 6: 0.723404255319149
	Train acc at iteration 8: 0.7836538461538461
	Val acc at iteration 7: 0.6808510638297872
	Train acc at iteration 9: 0.7980769230769231
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8012820512820513
	Val acc at iteration 9: 0.7659574468085106
	Train acc at iteration 11: 0.8237179487179487
	Val acc at iteration 10: 0.7446808510638298
	Train acc at iteration 12: 0.8397435897435898
	Val acc at iteration 11: 0.7659574468085106
	Train acc at iteration 13: 0.7916666666666666
	Val acc at iteration 12: 0.723404255319149
	Train acc at iteration 14: 0.8173076923076923
	Val acc at iteration 13: 0.723404255319149
	Train acc at iteration 15: 0.8076923076923077
	Val acc at iteration 14: 0.723404255319149
	Train acc at iteration 16: 0.8125
	Val acc at iteration 15: 0.6702127659574468
	Train acc at iteration 17: 0.7756410256410257
	Val acc at iteration 16: 0.6914893617021277
	Train acc at iteration 18: 0.8012820512820513
	Val acc at iteration 17: 0.8085106382978723
	Train acc at iteration 19: 0.8189102564102564
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.7964743589743589
	Val acc at iteration 19: 0.6702127659574468
	Train acc at iteration 21: 0.8253205128205128
	Val acc at iteration 20: 0.6702127659574468
	Train acc at iteration 22: 0.8092948717948718
	Val acc at iteration 21: 0.7127659574468085
	Train acc at iteration 23: 0.8173076923076923
	Val acc at iteration 22: 0.723404255319149
	Train acc at iteration 24: 0.7948717948717948
	Val acc at iteration 23: 0.7340425531914894
	Train acc at iteration 25: 0.8141025641025641
	Val acc at iteration 24: 0.7659574468085106
	Train acc at iteration 26: 0.8397435897435898
	Val acc at iteration 25: 0.7021276595744681
	Train acc at iteration 27: 0.8141025641025641
	Val acc at iteration 26: 0.7446808510638298
	Train acc at iteration 28: 0.8349358974358975
	Val acc at iteration 27: 0.7659574468085106
	Train acc at iteration 29: 0.8397435897435898
	Val acc at iteration 28: 0.7340425531914894
	Train acc at iteration 30: 0.8092948717948718
	Val acc at iteration 29: 0.6914893617021277
	Train acc at iteration 31: 0.8108974358974359
	Val acc at iteration 30: 0.7446808510638298
	Train acc at iteration 32: 0.7916666666666666
	Val acc at iteration 31: 0.7978723404255319
	Train acc at iteration 33: 0.8044871794871795
	Val acc at iteration 32: 0.776595744680851
	Train acc at iteration 34: 0.7964743589743589
	Val acc at iteration 33: 0.7872340425531915
	Train acc at iteration 35: 0.8044871794871795
	Val acc at iteration 34: 0.7340425531914894
	Train acc at iteration 36: 0.8237179487179487
	Val acc at iteration 35: 0.7553191489361702
	Train acc at iteration 37: 0.782051282051282
	Val acc at iteration 36: 0.723404255319149
	Train acc at iteration 38: 0.7948717948717948
	Val acc at iteration 37: 0.7127659574468085
	Train acc at iteration 39: 0.8205128205128205
	Val acc at iteration 38: 0.6595744680851063
	Train acc at iteration 40: 0.8060897435897436
	Val acc at iteration 39: 0.723404255319149
	Train acc at iteration 41: 0.8092948717948718
	Val acc at iteration 40: 0.7872340425531915
	Train acc at iteration 42: 0.8301282051282052
	Val acc at iteration 41: 0.7021276595744681
	Train acc at iteration 43: 0.7660256410256411
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.8189102564102564
	Val acc at iteration 43: 0.7446808510638298
	Train acc at iteration 45: 0.8253205128205128
	Val acc at iteration 44: 0.7659574468085106
	Train acc at iteration 46: 0.8189102564102564
	Val acc at iteration 45: 0.6914893617021277
	Train acc at iteration 47: 0.8173076923076923
	Val acc at iteration 46: 0.776595744680851
	Train acc at iteration 48: 0.8285256410256411
	Val acc at iteration 47: 0.6914893617021277
	Train acc at iteration 49: 0.7948717948717948
	Val acc at iteration 48: 0.723404255319149
	Train acc at iteration 50: 0.7884615384615384
	Val acc at iteration 49: 0.7553191489361702
	Train acc at iteration 51: 0.7948717948717948
	Val acc at iteration 50: 0.7659574468085106
	Train acc at iteration 52: 0.7852564102564102
	Val acc at iteration 51: 0.7446808510638298
	Train acc at iteration 53: 0.8205128205128205
	Val acc at iteration 52: 0.7340425531914894
	Train acc at iteration 54: 0.8189102564102564
	Val acc at iteration 53: 0.7872340425531915
	Train acc at iteration 55: 0.8285256410256411
	Val acc at iteration 54: 0.8617021276595744
	Train acc at iteration 56: 0.8108974358974359
	Val acc at iteration 55: 0.7446808510638298
	Train acc at iteration 57: 0.8125
	Val acc at iteration 56: 0.723404255319149
	Train acc at iteration 58: 0.8060897435897436
	Val acc at iteration 57: 0.7446808510638298
	Train acc at iteration 59: 0.8076923076923077
	Val acc at iteration 58: 0.7446808510638298
	Train acc at iteration 60: 0.7980769230769231
	Val acc at iteration 59: 0.7446808510638298
	Train acc at iteration 61: 0.7948717948717948
	Val acc at iteration 60: 0.7659574468085106
	Train acc at iteration 62: 0.8044871794871795
	Val acc at iteration 61: 0.7340425531914894
	Train acc at iteration 63: 0.8141025641025641
	Val acc at iteration 62: 0.6382978723404256
	Train acc at iteration 64: 0.8237179487179487
	Val acc at iteration 63: 0.723404255319149
	Train acc at iteration 65: 0.8141025641025641
	Val acc at iteration 64: 0.8404255319148937
	Train acc at iteration 66: 0.842948717948718
	Val acc at iteration 65: 0.7021276595744681
	Train acc at iteration 67: 0.8044871794871795
	Val acc at iteration 66: 0.7659574468085106
	Train acc at iteration 68: 0.8092948717948718
	Val acc at iteration 67: 0.648936170212766
	Train acc at iteration 69: 0.7644230769230769
	Val acc at iteration 68: 0.7553191489361702
	Train acc at iteration 70: 0.8028846153846154
	Val acc at iteration 69: 0.7659574468085106
	Train acc at iteration 71: 0.8157051282051282
	Val acc at iteration 70: 0.6702127659574468
	Train acc at iteration 72: 0.8157051282051282
	Val acc at iteration 71: 0.648936170212766
	Train acc at iteration 73: 0.8125
	Val acc at iteration 72: 0.7446808510638298
	Train acc at iteration 74: 0.8060897435897436
	Val acc at iteration 73: 0.6595744680851063
	Train acc at iteration 75: 0.8157051282051282
	Val acc at iteration 74: 0.7340425531914894
	Train acc at iteration 76: 0.8189102564102564
	Val acc at iteration 75: 0.723404255319149
	Train acc at iteration 77: 0.8253205128205128
	Val acc at iteration 76: 0.7021276595744681
	Train acc at iteration 78: 0.8044871794871795
	Val acc at iteration 77: 0.7659574468085106
	Train acc at iteration 79: 0.8125
	Val acc at iteration 78: 0.7553191489361702
	Train acc at iteration 80: 0.8076923076923077
	Val acc at iteration 79: 0.648936170212766
	Train acc at iteration 81: 0.8157051282051282
	Val acc at iteration 80: 0.7446808510638298
	Train acc at iteration 82: 0.8301282051282052
	Val acc at iteration 81: 0.7553191489361702
	Train acc at iteration 83: 0.8349358974358975
	Val acc at iteration 82: 0.6914893617021277
	Train acc at iteration 84: 0.8108974358974359
	Val acc at iteration 83: 0.7446808510638298
	Train acc at iteration 85: 0.8092948717948718
	Val acc at iteration 84: 0.7659574468085106
	Train acc at iteration 86: 0.8365384615384616
	Val acc at iteration 85: 0.723404255319149
	Train acc at iteration 87: 0.8044871794871795
	Val acc at iteration 86: 0.7553191489361702
	Train acc at iteration 88: 0.8269230769230769
	Val acc at iteration 87: 0.7446808510638298
	Train acc at iteration 89: 0.7836538461538461
	Val acc at iteration 88: 0.7340425531914894
	Train acc at iteration 90: 0.7996794871794872
	Val acc at iteration 89: 0.7659574468085106
	Train acc at iteration 91: 0.8285256410256411
	Val acc at iteration 90: 0.7021276595744681
	Train acc at iteration 92: 0.8157051282051282
	Val acc at iteration 91: 0.776595744680851
	Train acc at iteration 93: 0.8060897435897436
	Val acc at iteration 92: 0.7340425531914894
	Train acc at iteration 94: 0.7996794871794872
	Val acc at iteration 93: 0.7340425531914894
	Train acc at iteration 95: 0.8253205128205128
	Val acc at iteration 94: 0.7872340425531915
	Train acc at iteration 96: 0.8108974358974359
	Val acc at iteration 95: 0.7978723404255319
	Train acc at iteration 97: 0.8301282051282052
	Val acc at iteration 96: 0.723404255319149
	Train acc at iteration 98: 0.7852564102564102
	Val acc at iteration 97: 0.7872340425531915
	Train acc at iteration 99: 0.8189102564102564
	Val acc at iteration 98: 0.7021276595744681
	Train acc at iteration 100: 0.8092948717948718
	Val acc at iteration 99: 0.776595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6596491228070175
Final val micro accuracy: 0.7446808510638298
Final test macro f1-score: 0.45709219858156025
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6218408346176147
	Separation: 0.5490948855876923
Final test:
	Cluster: 0.6016922891139984
	Separation: 0.5455138385295868
Saved Results

Attempting combination 15/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 24.0
l1_weight: 10
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9787234042553191
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Cluster: 0.6590396881103515
	Separation: 0.5242951035499572
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.5957446808510638
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.5851063829787234
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.6170212765957447
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6170212765957447
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.6382978723404256
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.6276595744680851
	Val acc at iteration 25: 0.776595744680851
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6170212765957447
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.574468085106383
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6063829787234043
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6063829787234043
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.6382978723404256
	Val acc at iteration 63: 0.6276595744680851
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.6063829787234043
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.5851063829787234
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.6276595744680851
	Val acc at iteration 72: 0.5957446808510638
	Val acc at iteration 73: 0.6063829787234043
	Val acc at iteration 74: 0.6382978723404256
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.6063829787234043
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.6382978723404256
	Val acc at iteration 85: 0.7340425531914894
	Val acc at iteration 86: 0.6382978723404256
	Val acc at iteration 87: 0.6276595744680851
	Val acc at iteration 88: 0.6382978723404256
	Val acc at iteration 89: 0.6382978723404256
	Val acc at iteration 90: 0.6382978723404256
	Val acc at iteration 91: 0.6170212765957447
	Val acc at iteration 92: 0.7127659574468085
	Val acc at iteration 93: 0.5851063829787234
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.7872340425531915
	Val acc at iteration 96: 0.6595744680851063
	Val acc at iteration 97: 0.6595744680851063
	Val acc at iteration 98: 0.6808510638297872
	Val acc at iteration 99: 0.6170212765957447
Val acc before epoch 16: 0.648936170212766
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7596153846153846
	Cluster: 0.6614263534545899
	Separation: 0.5248678684234619
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.5957446808510638
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6063829787234043
	Val acc at iteration 6: 0.6170212765957447
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.5425531914893617
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.5851063829787234
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.574468085106383
	Val acc at iteration 22: 0.5851063829787234
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.6276595744680851
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.5425531914893617
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.6276595744680851
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.6063829787234043
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.6382978723404256
	Val acc at iteration 64: 0.5851063829787234
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.5638297872340425
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.648936170212766
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.6063829787234043
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7446808510638298
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.6382978723404256
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.6382978723404256
	Val acc at iteration 85: 0.6914893617021277
	Val acc at iteration 86: 0.6808510638297872
	Val acc at iteration 87: 0.6063829787234043
	Val acc at iteration 88: 0.6914893617021277
	Val acc at iteration 89: 0.6808510638297872
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.6914893617021277
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.5957446808510638
	Val acc at iteration 94: 0.648936170212766
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.6702127659574468
	Val acc at iteration 98: 0.7659574468085106
	Val acc at iteration 99: 0.648936170212766
Val acc before epoch 26: 0.6382978723404256
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7872340425531915
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9361702127659575
Stopping after epoch 36.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8044871794871795
	Cluster: 0.6514022350311279
	Separation: 0.5198140978813172
(After push) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8044871794871795
	Val acc at iteration 0: 0.648936170212766
	Train acc at iteration 2: 0.7932692307692307
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.8044871794871795
	Val acc at iteration 2: 0.6170212765957447
	Train acc at iteration 4: 0.7740384615384616
	Val acc at iteration 3: 0.6063829787234043
	Train acc at iteration 5: 0.8269230769230769
	Val acc at iteration 4: 0.6702127659574468
	Train acc at iteration 6: 0.7708333333333334
	Val acc at iteration 5: 0.6170212765957447
	Train acc at iteration 7: 0.7644230769230769
	Val acc at iteration 6: 0.6702127659574468
	Train acc at iteration 8: 0.780448717948718
	Val acc at iteration 7: 0.6808510638297872
	Train acc at iteration 9: 0.7740384615384616
	Val acc at iteration 8: 0.6063829787234043
	Train acc at iteration 10: 0.8012820512820513
	Val acc at iteration 9: 0.723404255319149
	Train acc at iteration 11: 0.7612179487179487
	Val acc at iteration 10: 0.6808510638297872
	Train acc at iteration 12: 0.7852564102564102
	Val acc at iteration 11: 0.6702127659574468
	Train acc at iteration 13: 0.7916666666666666
	Val acc at iteration 12: 0.6063829787234043
	Train acc at iteration 14: 0.7836538461538461
	Val acc at iteration 13: 0.6808510638297872
	Train acc at iteration 15: 0.7772435897435898
	Val acc at iteration 14: 0.6595744680851063
	Train acc at iteration 16: 0.7644230769230769
	Val acc at iteration 15: 0.6702127659574468
	Train acc at iteration 17: 0.7676282051282052
	Val acc at iteration 16: 0.6595744680851063
	Train acc at iteration 18: 0.75
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.7596153846153846
	Val acc at iteration 18: 0.6595744680851063
	Train acc at iteration 20: 0.7708333333333334
	Val acc at iteration 19: 0.5319148936170213
	Train acc at iteration 21: 0.7916666666666666
	Val acc at iteration 20: 0.7021276595744681
	Train acc at iteration 22: 0.7756410256410257
	Val acc at iteration 21: 0.648936170212766
	Train acc at iteration 23: 0.7884615384615384
	Val acc at iteration 22: 0.6914893617021277
	Train acc at iteration 24: 0.7724358974358975
	Val acc at iteration 23: 0.6276595744680851
	Train acc at iteration 25: 0.7692307692307693
	Val acc at iteration 24: 0.5851063829787234
	Train acc at iteration 26: 0.7948717948717948
	Val acc at iteration 25: 0.6063829787234043
	Train acc at iteration 27: 0.7532051282051282
	Val acc at iteration 26: 0.7127659574468085
	Train acc at iteration 28: 0.7596153846153846
	Val acc at iteration 27: 0.648936170212766
	Train acc at iteration 29: 0.7740384615384616
	Val acc at iteration 28: 0.6063829787234043
	Train acc at iteration 30: 0.7724358974358975
	Val acc at iteration 29: 0.5957446808510638
	Train acc at iteration 31: 0.7692307692307693
	Val acc at iteration 30: 0.6063829787234043
	Train acc at iteration 32: 0.7884615384615384
	Val acc at iteration 31: 0.7340425531914894
	Train acc at iteration 33: 0.780448717948718
	Val acc at iteration 32: 0.5957446808510638
	Train acc at iteration 34: 0.7724358974358975
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.780448717948718
	Val acc at iteration 34: 0.6914893617021277
	Train acc at iteration 36: 0.7932692307692307
	Val acc at iteration 35: 0.6595744680851063
	Train acc at iteration 37: 0.7532051282051282
	Val acc at iteration 36: 0.574468085106383
	Train acc at iteration 38: 0.7580128205128205
	Val acc at iteration 37: 0.6808510638297872
	Train acc at iteration 39: 0.7596153846153846
	Val acc at iteration 38: 0.6382978723404256
	Train acc at iteration 40: 0.7916666666666666
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.7660256410256411
	Val acc at iteration 40: 0.7021276595744681
	Train acc at iteration 42: 0.7660256410256411
	Val acc at iteration 41: 0.7021276595744681
	Train acc at iteration 43: 0.8108974358974359
	Val acc at iteration 42: 0.7553191489361702
	Train acc at iteration 44: 0.7852564102564102
	Val acc at iteration 43: 0.6382978723404256
	Train acc at iteration 45: 0.7548076923076923
	Val acc at iteration 44: 0.648936170212766
	Train acc at iteration 46: 0.7612179487179487
	Val acc at iteration 45: 0.6595744680851063
	Train acc at iteration 47: 0.7916666666666666
	Val acc at iteration 46: 0.6702127659574468
	Train acc at iteration 48: 0.7644230769230769
	Val acc at iteration 47: 0.6702127659574468
	Train acc at iteration 49: 0.7788461538461539
	Val acc at iteration 48: 0.7446808510638298
	Train acc at iteration 50: 0.7612179487179487
	Val acc at iteration 49: 0.6595744680851063
	Train acc at iteration 51: 0.7676282051282052
	Val acc at iteration 50: 0.6170212765957447
	Train acc at iteration 52: 0.7596153846153846
	Val acc at iteration 51: 0.6170212765957447
	Train acc at iteration 53: 0.7483974358974359
	Val acc at iteration 52: 0.723404255319149
	Train acc at iteration 54: 0.780448717948718
	Val acc at iteration 53: 0.5957446808510638
	Train acc at iteration 55: 0.7884615384615384
	Val acc at iteration 54: 0.6595744680851063
	Train acc at iteration 56: 0.7708333333333334
	Val acc at iteration 55: 0.6276595744680851
	Train acc at iteration 57: 0.8012820512820513
	Val acc at iteration 56: 0.6595744680851063
	Train acc at iteration 58: 0.782051282051282
	Val acc at iteration 57: 0.574468085106383
	Train acc at iteration 59: 0.7868589743589743
	Val acc at iteration 58: 0.6170212765957447
	Train acc at iteration 60: 0.780448717948718
	Val acc at iteration 59: 0.6914893617021277
	Train acc at iteration 61: 0.7516025641025641
	Val acc at iteration 60: 0.723404255319149
	Train acc at iteration 62: 0.7772435897435898
	Val acc at iteration 61: 0.7553191489361702
	Train acc at iteration 63: 0.8012820512820513
	Val acc at iteration 62: 0.6595744680851063
	Train acc at iteration 64: 0.7724358974358975
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.7964743589743589
	Val acc at iteration 64: 0.6382978723404256
	Train acc at iteration 66: 0.8076923076923077
	Val acc at iteration 65: 0.5851063829787234
	Train acc at iteration 67: 0.7532051282051282
	Val acc at iteration 66: 0.6595744680851063
	Train acc at iteration 68: 0.7740384615384616
	Val acc at iteration 67: 0.6702127659574468
	Train acc at iteration 69: 0.7788461538461539
	Val acc at iteration 68: 0.648936170212766
	Train acc at iteration 70: 0.7564102564102564
	Val acc at iteration 69: 0.6808510638297872
	Train acc at iteration 71: 0.7788461538461539
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.7996794871794872
	Val acc at iteration 71: 0.6808510638297872
	Train acc at iteration 73: 0.782051282051282
	Val acc at iteration 72: 0.7127659574468085
	Train acc at iteration 74: 0.7532051282051282
	Val acc at iteration 73: 0.6063829787234043
	Train acc at iteration 75: 0.7724358974358975
	Val acc at iteration 74: 0.648936170212766
	Train acc at iteration 76: 0.7644230769230769
	Val acc at iteration 75: 0.6702127659574468
	Train acc at iteration 77: 0.7964743589743589
	Val acc at iteration 76: 0.6276595744680851
	Train acc at iteration 78: 0.7788461538461539
	Val acc at iteration 77: 0.7127659574468085
	Train acc at iteration 79: 0.7900641025641025
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.7644230769230769
	Val acc at iteration 79: 0.648936170212766
	Train acc at iteration 81: 0.7836538461538461
	Val acc at iteration 80: 0.7021276595744681
	Train acc at iteration 82: 0.7788461538461539
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7756410256410257
	Val acc at iteration 82: 0.6382978723404256
	Train acc at iteration 84: 0.7772435897435898
	Val acc at iteration 83: 0.7021276595744681
	Train acc at iteration 85: 0.7676282051282052
	Val acc at iteration 84: 0.7021276595744681
	Train acc at iteration 86: 0.7612179487179487
	Val acc at iteration 85: 0.6808510638297872
	Train acc at iteration 87: 0.7852564102564102
	Val acc at iteration 86: 0.7127659574468085
	Train acc at iteration 88: 0.7756410256410257
	Val acc at iteration 87: 0.6595744680851063
	Train acc at iteration 89: 0.7628205128205128
	Val acc at iteration 88: 0.6702127659574468
	Train acc at iteration 90: 0.7483974358974359
	Val acc at iteration 89: 0.7021276595744681
	Train acc at iteration 91: 0.7868589743589743
	Val acc at iteration 90: 0.723404255319149
	Train acc at iteration 92: 0.7740384615384616
	Val acc at iteration 91: 0.6808510638297872
	Train acc at iteration 93: 0.7772435897435898
	Val acc at iteration 92: 0.6382978723404256
	Train acc at iteration 94: 0.7451923076923077
	Val acc at iteration 93: 0.6808510638297872
	Train acc at iteration 95: 0.7868589743589743
	Val acc at iteration 94: 0.6063829787234043
	Train acc at iteration 96: 0.7612179487179487
	Val acc at iteration 95: 0.6063829787234043
	Train acc at iteration 97: 0.7980769230769231
	Val acc at iteration 96: 0.6595744680851063
	Train acc at iteration 98: 0.7580128205128205
	Val acc at iteration 97: 0.6702127659574468
	Train acc at iteration 99: 0.7676282051282052
	Val acc at iteration 98: 0.6914893617021277
	Train acc at iteration 100: 0.75
	Val acc at iteration 99: 0.6595744680851063
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5336700336700336
Final val micro accuracy: 0.648936170212766
Final test macro f1-score: 0.4662962962962963
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6206424236297607
	Separation: 0.5421324670314789
Final test:
	Cluster: 0.6191581189632416
	Separation: 0.5454204678535461
Saved Results

Attempting combination 16/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 24.0
l1_weight: 1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.4148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7980769230769231
	Cluster: 0.6536642193794251
	Separation: 0.5284199714660645
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.7659574468085106
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.5957446808510638
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.5957446808510638
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.5957446808510638
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.6595744680851063
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.6808510638297872
	Val acc at iteration 47: 0.6276595744680851
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.6702127659574468
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.6382978723404256
	Val acc at iteration 66: 0.6595744680851063
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6063829787234043
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.6595744680851063
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.574468085106383
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6382978723404256
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.7021276595744681
	Val acc at iteration 85: 0.648936170212766
	Val acc at iteration 86: 0.6595744680851063
	Val acc at iteration 87: 0.7127659574468085
	Val acc at iteration 88: 0.7340425531914894
	Val acc at iteration 89: 0.6702127659574468
	Val acc at iteration 90: 0.7553191489361702
	Val acc at iteration 91: 0.7127659574468085
	Val acc at iteration 92: 0.6702127659574468
	Val acc at iteration 93: 0.7340425531914894
	Val acc at iteration 94: 0.6382978723404256
	Val acc at iteration 95: 0.6808510638297872
	Val acc at iteration 96: 0.7127659574468085
	Val acc at iteration 97: 0.7872340425531915
	Val acc at iteration 98: 0.6702127659574468
	Val acc at iteration 99: 0.7021276595744681
Val acc before epoch 16: 0.6595744680851063
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7836538461538461
	Cluster: 0.6461122035980225
	Separation: 0.5165956497192383
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.574468085106383
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.776595744680851
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.7553191489361702
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.6170212765957447
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7446808510638298
	Val acc at iteration 37: 0.6276595744680851
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.5851063829787234
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.6276595744680851
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.6382978723404256
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.6382978723404256
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.648936170212766
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.6914893617021277
	Val acc at iteration 85: 0.6808510638297872
	Val acc at iteration 86: 0.6702127659574468
	Val acc at iteration 87: 0.6276595744680851
	Val acc at iteration 88: 0.6914893617021277
	Val acc at iteration 89: 0.7340425531914894
	Val acc at iteration 90: 0.648936170212766
	Val acc at iteration 91: 0.7446808510638298
	Val acc at iteration 92: 0.7446808510638298
	Val acc at iteration 93: 0.648936170212766
	Val acc at iteration 94: 0.7021276595744681
	Val acc at iteration 95: 0.723404255319149
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.7021276595744681
	Val acc at iteration 98: 0.6914893617021277
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 26: 0.6914893617021277
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7553191489361702
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.925531914893617
Stopping after epoch 36.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Cluster: 0.6452016234397888
	Separation: 0.5193662285804749
(After push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7884615384615384
	Val acc at iteration 0: 0.6702127659574468
	Train acc at iteration 2: 0.7740384615384616
	Val acc at iteration 1: 0.6702127659574468
	Train acc at iteration 3: 0.7964743589743589
	Val acc at iteration 2: 0.7021276595744681
	Train acc at iteration 4: 0.7660256410256411
	Val acc at iteration 3: 0.6595744680851063
	Train acc at iteration 5: 0.7740384615384616
	Val acc at iteration 4: 0.6382978723404256
	Train acc at iteration 6: 0.7916666666666666
	Val acc at iteration 5: 0.648936170212766
	Train acc at iteration 7: 0.8060897435897436
	Val acc at iteration 6: 0.6595744680851063
	Train acc at iteration 8: 0.8028846153846154
	Val acc at iteration 7: 0.7127659574468085
	Train acc at iteration 9: 0.7996794871794872
	Val acc at iteration 8: 0.7021276595744681
	Train acc at iteration 10: 0.7980769230769231
	Val acc at iteration 9: 0.648936170212766
	Train acc at iteration 11: 0.7628205128205128
	Val acc at iteration 10: 0.6595744680851063
	Train acc at iteration 12: 0.7948717948717948
	Val acc at iteration 11: 0.6170212765957447
	Train acc at iteration 13: 0.7564102564102564
	Val acc at iteration 12: 0.5851063829787234
	Train acc at iteration 14: 0.8317307692307693
	Val acc at iteration 13: 0.6276595744680851
	Train acc at iteration 15: 0.7644230769230769
	Val acc at iteration 14: 0.6170212765957447
	Train acc at iteration 16: 0.7660256410256411
	Val acc at iteration 15: 0.648936170212766
	Train acc at iteration 17: 0.7708333333333334
	Val acc at iteration 16: 0.6702127659574468
	Train acc at iteration 18: 0.7980769230769231
	Val acc at iteration 17: 0.7340425531914894
	Train acc at iteration 19: 0.7708333333333334
	Val acc at iteration 18: 0.6808510638297872
	Train acc at iteration 20: 0.7580128205128205
	Val acc at iteration 19: 0.7021276595744681
	Train acc at iteration 21: 0.7948717948717948
	Val acc at iteration 20: 0.7021276595744681
	Train acc at iteration 22: 0.7996794871794872
	Val acc at iteration 21: 0.6808510638297872
	Train acc at iteration 23: 0.780448717948718
	Val acc at iteration 22: 0.6702127659574468
	Train acc at iteration 24: 0.8076923076923077
	Val acc at iteration 23: 0.6702127659574468
	Train acc at iteration 25: 0.7964743589743589
	Val acc at iteration 24: 0.6702127659574468
	Train acc at iteration 26: 0.7868589743589743
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.7932692307692307
	Val acc at iteration 26: 0.723404255319149
	Train acc at iteration 28: 0.7980769230769231
	Val acc at iteration 27: 0.5957446808510638
	Train acc at iteration 29: 0.7916666666666666
	Val acc at iteration 28: 0.7340425531914894
	Train acc at iteration 30: 0.7916666666666666
	Val acc at iteration 29: 0.6276595744680851
	Train acc at iteration 31: 0.7660256410256411
	Val acc at iteration 30: 0.648936170212766
	Train acc at iteration 32: 0.7644230769230769
	Val acc at iteration 31: 0.6382978723404256
	Train acc at iteration 33: 0.7980769230769231
	Val acc at iteration 32: 0.6382978723404256
	Train acc at iteration 34: 0.7964743589743589
	Val acc at iteration 33: 0.723404255319149
	Train acc at iteration 35: 0.7948717948717948
	Val acc at iteration 34: 0.723404255319149
	Train acc at iteration 36: 0.8092948717948718
	Val acc at iteration 35: 0.6595744680851063
	Train acc at iteration 37: 0.7948717948717948
	Val acc at iteration 36: 0.648936170212766
	Train acc at iteration 38: 0.7900641025641025
	Val acc at iteration 37: 0.7021276595744681
	Train acc at iteration 39: 0.8012820512820513
	Val acc at iteration 38: 0.648936170212766
	Train acc at iteration 40: 0.7756410256410257
	Val acc at iteration 39: 0.5851063829787234
	Train acc at iteration 41: 0.7836538461538461
	Val acc at iteration 40: 0.7127659574468085
	Train acc at iteration 42: 0.7980769230769231
	Val acc at iteration 41: 0.6170212765957447
	Train acc at iteration 43: 0.7692307692307693
	Val acc at iteration 42: 0.7021276595744681
	Train acc at iteration 44: 0.8012820512820513
	Val acc at iteration 43: 0.6595744680851063
	Train acc at iteration 45: 0.8076923076923077
	Val acc at iteration 44: 0.7978723404255319
	Train acc at iteration 46: 0.780448717948718
	Val acc at iteration 45: 0.6170212765957447
	Train acc at iteration 47: 0.7996794871794872
	Val acc at iteration 46: 0.723404255319149
	Train acc at iteration 48: 0.780448717948718
	Val acc at iteration 47: 0.6808510638297872
	Train acc at iteration 49: 0.780448717948718
	Val acc at iteration 48: 0.7021276595744681
	Train acc at iteration 50: 0.7692307692307693
	Val acc at iteration 49: 0.6702127659574468
	Train acc at iteration 51: 0.7756410256410257
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.782051282051282
	Val acc at iteration 51: 0.6382978723404256
	Train acc at iteration 53: 0.7788461538461539
	Val acc at iteration 52: 0.6702127659574468
	Train acc at iteration 54: 0.7724358974358975
	Val acc at iteration 53: 0.6808510638297872
	Train acc at iteration 55: 0.7852564102564102
	Val acc at iteration 54: 0.6595744680851063
	Train acc at iteration 56: 0.7644230769230769
	Val acc at iteration 55: 0.6595744680851063
	Train acc at iteration 57: 0.7900641025641025
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.7900641025641025
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.7900641025641025
	Val acc at iteration 58: 0.6914893617021277
	Train acc at iteration 60: 0.7772435897435898
	Val acc at iteration 59: 0.7446808510638298
	Train acc at iteration 61: 0.8092948717948718
	Val acc at iteration 60: 0.648936170212766
	Train acc at iteration 62: 0.8028846153846154
	Val acc at iteration 61: 0.6702127659574468
	Train acc at iteration 63: 0.8092948717948718
	Val acc at iteration 62: 0.7127659574468085
	Train acc at iteration 64: 0.7964743589743589
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.7660256410256411
	Val acc at iteration 64: 0.723404255319149
	Train acc at iteration 66: 0.7932692307692307
	Val acc at iteration 65: 0.6382978723404256
	Train acc at iteration 67: 0.7740384615384616
	Val acc at iteration 66: 0.7553191489361702
	Train acc at iteration 68: 0.7708333333333334
	Val acc at iteration 67: 0.6808510638297872
	Train acc at iteration 69: 0.780448717948718
	Val acc at iteration 68: 0.7021276595744681
	Train acc at iteration 70: 0.7756410256410257
	Val acc at iteration 69: 0.6595744680851063
	Train acc at iteration 71: 0.8076923076923077
	Val acc at iteration 70: 0.7021276595744681
	Train acc at iteration 72: 0.7660256410256411
	Val acc at iteration 71: 0.6063829787234043
	Train acc at iteration 73: 0.7868589743589743
	Val acc at iteration 72: 0.6170212765957447
	Train acc at iteration 74: 0.8028846153846154
	Val acc at iteration 73: 0.7340425531914894
	Train acc at iteration 75: 0.7740384615384616
	Val acc at iteration 74: 0.648936170212766
	Train acc at iteration 76: 0.8189102564102564
	Val acc at iteration 75: 0.6808510638297872
	Train acc at iteration 77: 0.780448717948718
	Val acc at iteration 76: 0.776595744680851
	Train acc at iteration 78: 0.782051282051282
	Val acc at iteration 77: 0.7127659574468085
	Train acc at iteration 79: 0.7756410256410257
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.7916666666666666
	Val acc at iteration 79: 0.6808510638297872
	Train acc at iteration 81: 0.7916666666666666
	Val acc at iteration 80: 0.6914893617021277
	Train acc at iteration 82: 0.7692307692307693
	Val acc at iteration 81: 0.6808510638297872
	Train acc at iteration 83: 0.7836538461538461
	Val acc at iteration 82: 0.7446808510638298
	Train acc at iteration 84: 0.7772435897435898
	Val acc at iteration 83: 0.648936170212766
	Train acc at iteration 85: 0.8060897435897436
	Val acc at iteration 84: 0.6595744680851063
	Train acc at iteration 86: 0.7964743589743589
	Val acc at iteration 85: 0.723404255319149
	Train acc at iteration 87: 0.7836538461538461
	Val acc at iteration 86: 0.648936170212766
	Train acc at iteration 88: 0.7724358974358975
	Val acc at iteration 87: 0.5638297872340425
	Train acc at iteration 89: 0.7644230769230769
	Val acc at iteration 88: 0.6702127659574468
	Train acc at iteration 90: 0.7900641025641025
	Val acc at iteration 89: 0.7446808510638298
	Train acc at iteration 91: 0.7483974358974359
	Val acc at iteration 90: 0.7021276595744681
	Train acc at iteration 92: 0.7676282051282052
	Val acc at iteration 91: 0.6808510638297872
	Train acc at iteration 93: 0.8044871794871795
	Val acc at iteration 92: 0.5957446808510638
	Train acc at iteration 94: 0.7996794871794872
	Val acc at iteration 93: 0.6914893617021277
	Train acc at iteration 95: 0.8028846153846154
	Val acc at iteration 94: 0.6808510638297872
	Train acc at iteration 96: 0.7788461538461539
	Val acc at iteration 95: 0.723404255319149
	Train acc at iteration 97: 0.7836538461538461
	Val acc at iteration 96: 0.7446808510638298
	Train acc at iteration 98: 0.7932692307692307
	Val acc at iteration 97: 0.6914893617021277
	Train acc at iteration 99: 0.7868589743589743
	Val acc at iteration 98: 0.6170212765957447
	Train acc at iteration 100: 0.7772435897435898
	Val acc at iteration 99: 0.7659574468085106
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6717687074829933
Final val micro accuracy: 0.7446808510638298
Final test macro f1-score: 0.556439393939394
Final test micro accuracy: 0.6595744680851063
Final validation:
	Cluster: 0.6235792636871338
	Separation: 0.5372503697872162
Final test:
	Cluster: 0.6085292398929596
	Separation: 0.5357922911643982
Saved Results

Attempting combination 17/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 24.0
l1_weight: 0.1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6595744680851063
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Cluster: 0.648846435546875
	Separation: 0.5199478387832641
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6382978723404256
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.5957446808510638
	Val acc at iteration 6: 0.6170212765957447
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.6063829787234043
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.5957446808510638
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.7446808510638298
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.7021276595744681
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.5957446808510638
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6170212765957447
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.6382978723404256
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.6063829787234043
	Val acc at iteration 30: 0.6170212765957447
	Val acc at iteration 31: 0.5851063829787234
	Val acc at iteration 32: 0.5638297872340425
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.5638297872340425
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6063829787234043
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.6170212765957447
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.6276595744680851
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6382978723404256
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.6276595744680851
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.6063829787234043
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.5957446808510638
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.6170212765957447
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.5957446808510638
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6382978723404256
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.5851063829787234
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.6170212765957447
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.6382978723404256
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.6382978723404256
	Val acc at iteration 85: 0.7340425531914894
	Val acc at iteration 86: 0.6063829787234043
	Val acc at iteration 87: 0.6276595744680851
	Val acc at iteration 88: 0.7127659574468085
	Val acc at iteration 89: 0.6808510638297872
	Val acc at iteration 90: 0.6170212765957447
	Val acc at iteration 91: 0.7127659574468085
	Val acc at iteration 92: 0.6595744680851063
	Val acc at iteration 93: 0.6170212765957447
	Val acc at iteration 94: 0.6702127659574468
	Val acc at iteration 95: 0.6063829787234043
	Val acc at iteration 96: 0.6382978723404256
	Val acc at iteration 97: 0.7340425531914894
	Val acc at iteration 98: 0.6063829787234043
	Val acc at iteration 99: 0.6276595744680851
Val acc before epoch 16: 0.6702127659574468
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Cluster: 0.6522443294525146
	Separation: 0.518307340145111
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6170212765957447
	Val acc at iteration 9: 0.5531914893617021
	Val acc at iteration 10: 0.6170212765957447
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.6063829787234043
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.6276595744680851
	Val acc at iteration 17: 0.6063829787234043
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6063829787234043
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.6382978723404256
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.6276595744680851
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.5425531914893617
	Val acc at iteration 35: 0.6170212765957447
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.6276595744680851
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.5957446808510638
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.6063829787234043
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.6276595744680851
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.574468085106383
	Val acc at iteration 64: 0.6063829787234043
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.6170212765957447
	Val acc at iteration 67: 0.6063829787234043
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.6170212765957447
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.6382978723404256
	Val acc at iteration 78: 0.5638297872340425
	Val acc at iteration 79: 0.6276595744680851
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.648936170212766
	Val acc at iteration 85: 0.6276595744680851
	Val acc at iteration 86: 0.6702127659574468
	Val acc at iteration 87: 0.723404255319149
	Val acc at iteration 88: 0.648936170212766
	Val acc at iteration 89: 0.6382978723404256
	Val acc at iteration 90: 0.6382978723404256
	Val acc at iteration 91: 0.648936170212766
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.648936170212766
	Val acc at iteration 94: 0.6382978723404256
	Val acc at iteration 95: 0.6170212765957447
	Val acc at iteration 96: 0.6702127659574468
	Val acc at iteration 97: 0.6170212765957447
	Val acc at iteration 98: 0.6702127659574468
	Val acc at iteration 99: 0.6170212765957447
Val acc before epoch 26: 0.6063829787234043
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.6914893617021277
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9361702127659575
Stopping after epoch 36.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7916666666666666
	Cluster: 0.6613066554069519
	Separation: 0.5259528875350952
(After push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.782051282051282
	Val acc at iteration 0: 0.6595744680851063
	Train acc at iteration 2: 0.8060897435897436
	Val acc at iteration 1: 0.648936170212766
	Train acc at iteration 3: 0.8028846153846154
	Val acc at iteration 2: 0.6702127659574468
	Train acc at iteration 4: 0.7692307692307693
	Val acc at iteration 3: 0.6170212765957447
	Train acc at iteration 5: 0.780448717948718
	Val acc at iteration 4: 0.6063829787234043
	Train acc at iteration 6: 0.7852564102564102
	Val acc at iteration 5: 0.6702127659574468
	Train acc at iteration 7: 0.7916666666666666
	Val acc at iteration 6: 0.7127659574468085
	Train acc at iteration 8: 0.7948717948717948
	Val acc at iteration 7: 0.6702127659574468
	Train acc at iteration 9: 0.8092948717948718
	Val acc at iteration 8: 0.648936170212766
	Train acc at iteration 10: 0.782051282051282
	Val acc at iteration 9: 0.723404255319149
	Train acc at iteration 11: 0.7788461538461539
	Val acc at iteration 10: 0.5851063829787234
	Train acc at iteration 12: 0.8044871794871795
	Val acc at iteration 11: 0.7021276595744681
	Train acc at iteration 13: 0.8221153846153846
	Val acc at iteration 12: 0.6170212765957447
	Train acc at iteration 14: 0.7740384615384616
	Val acc at iteration 13: 0.7127659574468085
	Train acc at iteration 15: 0.7868589743589743
	Val acc at iteration 14: 0.5957446808510638
	Train acc at iteration 16: 0.782051282051282
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.7788461538461539
	Val acc at iteration 16: 0.6063829787234043
	Train acc at iteration 18: 0.7644230769230769
	Val acc at iteration 17: 0.6702127659574468
	Train acc at iteration 19: 0.7964743589743589
	Val acc at iteration 18: 0.6914893617021277
	Train acc at iteration 20: 0.8012820512820513
	Val acc at iteration 19: 0.6702127659574468
	Train acc at iteration 21: 0.7948717948717948
	Val acc at iteration 20: 0.7021276595744681
	Train acc at iteration 22: 0.7900641025641025
	Val acc at iteration 21: 0.7127659574468085
	Train acc at iteration 23: 0.7740384615384616
	Val acc at iteration 22: 0.6382978723404256
	Train acc at iteration 24: 0.7996794871794872
	Val acc at iteration 23: 0.6276595744680851
	Train acc at iteration 25: 0.7836538461538461
	Val acc at iteration 24: 0.6808510638297872
	Train acc at iteration 26: 0.8060897435897436
	Val acc at iteration 25: 0.6170212765957447
	Train acc at iteration 27: 0.7692307692307693
	Val acc at iteration 26: 0.6595744680851063
	Train acc at iteration 28: 0.8125
	Val acc at iteration 27: 0.648936170212766
	Train acc at iteration 29: 0.8092948717948718
	Val acc at iteration 28: 0.574468085106383
	Train acc at iteration 30: 0.8108974358974359
	Val acc at iteration 29: 0.6276595744680851
	Train acc at iteration 31: 0.7948717948717948
	Val acc at iteration 30: 0.6914893617021277
	Train acc at iteration 32: 0.782051282051282
	Val acc at iteration 31: 0.6276595744680851
	Train acc at iteration 33: 0.7996794871794872
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.780448717948718
	Val acc at iteration 33: 0.6808510638297872
	Train acc at iteration 35: 0.7644230769230769
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.7772435897435898
	Val acc at iteration 35: 0.7021276595744681
	Train acc at iteration 37: 0.8076923076923077
	Val acc at iteration 36: 0.6170212765957447
	Train acc at iteration 38: 0.7756410256410257
	Val acc at iteration 37: 0.7021276595744681
	Train acc at iteration 39: 0.7948717948717948
	Val acc at iteration 38: 0.6276595744680851
	Train acc at iteration 40: 0.7996794871794872
	Val acc at iteration 39: 0.5851063829787234
	Train acc at iteration 41: 0.7772435897435898
	Val acc at iteration 40: 0.6276595744680851
	Train acc at iteration 42: 0.7756410256410257
	Val acc at iteration 41: 0.6595744680851063
	Train acc at iteration 43: 0.7916666666666666
	Val acc at iteration 42: 0.6702127659574468
	Train acc at iteration 44: 0.7900641025641025
	Val acc at iteration 43: 0.574468085106383
	Train acc at iteration 45: 0.7996794871794872
	Val acc at iteration 44: 0.6276595744680851
	Train acc at iteration 46: 0.7836538461538461
	Val acc at iteration 45: 0.648936170212766
	Train acc at iteration 47: 0.7996794871794872
	Val acc at iteration 46: 0.6702127659574468
	Train acc at iteration 48: 0.7564102564102564
	Val acc at iteration 47: 0.6170212765957447
	Train acc at iteration 49: 0.7852564102564102
	Val acc at iteration 48: 0.6914893617021277
	Train acc at iteration 50: 0.7900641025641025
	Val acc at iteration 49: 0.6808510638297872
	Train acc at iteration 51: 0.8092948717948718
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.7980769230769231
	Val acc at iteration 51: 0.6170212765957447
	Train acc at iteration 53: 0.7884615384615384
	Val acc at iteration 52: 0.5957446808510638
	Train acc at iteration 54: 0.8028846153846154
	Val acc at iteration 53: 0.6276595744680851
	Train acc at iteration 55: 0.7900641025641025
	Val acc at iteration 54: 0.6595744680851063
	Train acc at iteration 56: 0.8076923076923077
	Val acc at iteration 55: 0.5957446808510638
	Train acc at iteration 57: 0.8012820512820513
	Val acc at iteration 56: 0.6702127659574468
	Train acc at iteration 58: 0.7980769230769231
	Val acc at iteration 57: 0.6595744680851063
	Train acc at iteration 59: 0.8076923076923077
	Val acc at iteration 58: 0.6382978723404256
	Train acc at iteration 60: 0.782051282051282
	Val acc at iteration 59: 0.648936170212766
	Train acc at iteration 61: 0.7948717948717948
	Val acc at iteration 60: 0.6702127659574468
	Train acc at iteration 62: 0.7948717948717948
	Val acc at iteration 61: 0.723404255319149
	Train acc at iteration 63: 0.8092948717948718
	Val acc at iteration 62: 0.6276595744680851
	Train acc at iteration 64: 0.8076923076923077
	Val acc at iteration 63: 0.6595744680851063
	Train acc at iteration 65: 0.7964743589743589
	Val acc at iteration 64: 0.6170212765957447
	Train acc at iteration 66: 0.7772435897435898
	Val acc at iteration 65: 0.6382978723404256
	Train acc at iteration 67: 0.7788461538461539
	Val acc at iteration 66: 0.6595744680851063
	Train acc at iteration 68: 0.7852564102564102
	Val acc at iteration 67: 0.6063829787234043
	Train acc at iteration 69: 0.7548076923076923
	Val acc at iteration 68: 0.6808510638297872
	Train acc at iteration 70: 0.8028846153846154
	Val acc at iteration 69: 0.6595744680851063
	Train acc at iteration 71: 0.8044871794871795
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.7932692307692307
	Val acc at iteration 71: 0.6382978723404256
	Train acc at iteration 73: 0.780448717948718
	Val acc at iteration 72: 0.7127659574468085
	Train acc at iteration 74: 0.8076923076923077
	Val acc at iteration 73: 0.7021276595744681
	Train acc at iteration 75: 0.780448717948718
	Val acc at iteration 74: 0.5851063829787234
	Train acc at iteration 76: 0.7980769230769231
	Val acc at iteration 75: 0.5957446808510638
	Train acc at iteration 77: 0.7868589743589743
	Val acc at iteration 76: 0.574468085106383
	Train acc at iteration 78: 0.7868589743589743
	Val acc at iteration 77: 0.6702127659574468
	Train acc at iteration 79: 0.7964743589743589
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.7900641025641025
	Val acc at iteration 79: 0.6382978723404256
	Train acc at iteration 81: 0.7772435897435898
	Val acc at iteration 80: 0.5957446808510638
	Train acc at iteration 82: 0.782051282051282
	Val acc at iteration 81: 0.6808510638297872
	Train acc at iteration 83: 0.7868589743589743
	Val acc at iteration 82: 0.6808510638297872
	Train acc at iteration 84: 0.8317307692307693
	Val acc at iteration 83: 0.6276595744680851
	Train acc at iteration 85: 0.7868589743589743
	Val acc at iteration 84: 0.7340425531914894
	Train acc at iteration 86: 0.7868589743589743
	Val acc at iteration 85: 0.6702127659574468
	Train acc at iteration 87: 0.7884615384615384
	Val acc at iteration 86: 0.6702127659574468
	Train acc at iteration 88: 0.7788461538461539
	Val acc at iteration 87: 0.6702127659574468
	Train acc at iteration 89: 0.8125
	Val acc at iteration 88: 0.6170212765957447
	Train acc at iteration 90: 0.8125
	Val acc at iteration 89: 0.6276595744680851
	Train acc at iteration 91: 0.8012820512820513
	Val acc at iteration 90: 0.6382978723404256
	Train acc at iteration 92: 0.8044871794871795
	Val acc at iteration 91: 0.6170212765957447
	Train acc at iteration 93: 0.7740384615384616
	Val acc at iteration 92: 0.6914893617021277
	Train acc at iteration 94: 0.7980769230769231
	Val acc at iteration 93: 0.6702127659574468
	Train acc at iteration 95: 0.8173076923076923
	Val acc at iteration 94: 0.6276595744680851
	Train acc at iteration 96: 0.7740384615384616
	Val acc at iteration 95: 0.6382978723404256
	Train acc at iteration 97: 0.8125
	Val acc at iteration 96: 0.6914893617021277
	Train acc at iteration 98: 0.780448717948718
	Val acc at iteration 97: 0.6595744680851063
	Train acc at iteration 99: 0.7996794871794872
	Val acc at iteration 98: 0.6914893617021277
	Train acc at iteration 100: 0.7980769230769231
	Val acc at iteration 99: 0.6808510638297872
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6197916666666666
Final val micro accuracy: 0.7021276595744681
Final test macro f1-score: 0.4898876404494382
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.6223104596138
	Separation: 0.5399293899536133
Final test:
	Cluster: 0.6019232273101807
	Separation: 0.5419142246246338
Saved Results

Attempting combination 18/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 24.0
l1_weight: 0.01
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.46808510638297873
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9574468085106383
Push epoch
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Cluster: 0.6516170501708984
	Separation: 0.5194345116615295
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7127659574468085
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.6382978723404256
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.7659574468085106
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.6170212765957447
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.5851063829787234
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.648936170212766
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.5425531914893617
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.6382978723404256
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.723404255319149
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.7446808510638298
	Val acc at iteration 88: 0.6808510638297872
	Val acc at iteration 89: 0.6382978723404256
	Val acc at iteration 90: 0.6276595744680851
	Val acc at iteration 91: 0.723404255319149
	Val acc at iteration 92: 0.723404255319149
	Val acc at iteration 93: 0.7340425531914894
	Val acc at iteration 94: 0.6702127659574468
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.6914893617021277
	Val acc at iteration 97: 0.7021276595744681
	Val acc at iteration 98: 0.6276595744680851
	Val acc at iteration 99: 0.6276595744680851
Val acc before epoch 16: 0.723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Cluster: 0.6497032403945923
	Separation: 0.519228708744049
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.648936170212766
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.8085106382978723
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.6063829787234043
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.6276595744680851
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.5851063829787234
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7659574468085106
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.6063829787234043
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.648936170212766
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.5957446808510638
	Val acc at iteration 66: 0.6382978723404256
	Val acc at iteration 67: 0.6808510638297872
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.7872340425531915
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.648936170212766
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.723404255319149
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.776595744680851
	Val acc at iteration 87: 0.5957446808510638
	Val acc at iteration 88: 0.7446808510638298
	Val acc at iteration 89: 0.648936170212766
	Val acc at iteration 90: 0.7340425531914894
	Val acc at iteration 91: 0.7446808510638298
	Val acc at iteration 92: 0.6808510638297872
	Val acc at iteration 93: 0.6276595744680851
	Val acc at iteration 94: 0.6595744680851063
	Val acc at iteration 95: 0.7340425531914894
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.6595744680851063
	Val acc at iteration 98: 0.5851063829787234
	Val acc at iteration 99: 0.7978723404255319
Val acc before epoch 26: 0.6914893617021277
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.6808510638297872
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.925531914893617
Stopping after epoch 36.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7852564102564102
	Cluster: 0.6539751291275024
	Separation: 0.5196666598320008
(After push) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8044871794871795
	Val acc at iteration 0: 0.6914893617021277
	Train acc at iteration 2: 0.7612179487179487
	Val acc at iteration 1: 0.574468085106383
	Train acc at iteration 3: 0.7948717948717948
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.7900641025641025
	Val acc at iteration 3: 0.6808510638297872
	Train acc at iteration 5: 0.8028846153846154
	Val acc at iteration 4: 0.723404255319149
	Train acc at iteration 6: 0.7756410256410257
	Val acc at iteration 5: 0.7659574468085106
	Train acc at iteration 7: 0.7644230769230769
	Val acc at iteration 6: 0.6276595744680851
	Train acc at iteration 8: 0.7660256410256411
	Val acc at iteration 7: 0.723404255319149
	Train acc at iteration 9: 0.7564102564102564
	Val acc at iteration 8: 0.648936170212766
	Train acc at iteration 10: 0.7740384615384616
	Val acc at iteration 9: 0.776595744680851
	Train acc at iteration 11: 0.7724358974358975
	Val acc at iteration 10: 0.6595744680851063
	Train acc at iteration 12: 0.7836538461538461
	Val acc at iteration 11: 0.6702127659574468
	Train acc at iteration 13: 0.7580128205128205
	Val acc at iteration 12: 0.7021276595744681
	Train acc at iteration 14: 0.8012820512820513
	Val acc at iteration 13: 0.6382978723404256
	Train acc at iteration 15: 0.7740384615384616
	Val acc at iteration 14: 0.6914893617021277
	Train acc at iteration 16: 0.7740384615384616
	Val acc at iteration 15: 0.6595744680851063
	Train acc at iteration 17: 0.7884615384615384
	Val acc at iteration 16: 0.6382978723404256
	Train acc at iteration 18: 0.7900641025641025
	Val acc at iteration 17: 0.6914893617021277
	Train acc at iteration 19: 0.7740384615384616
	Val acc at iteration 18: 0.6595744680851063
	Train acc at iteration 20: 0.7916666666666666
	Val acc at iteration 19: 0.6382978723404256
	Train acc at iteration 21: 0.7708333333333334
	Val acc at iteration 20: 0.6382978723404256
	Train acc at iteration 22: 0.7708333333333334
	Val acc at iteration 21: 0.5957446808510638
	Train acc at iteration 23: 0.7708333333333334
	Val acc at iteration 22: 0.648936170212766
	Train acc at iteration 24: 0.7868589743589743
	Val acc at iteration 23: 0.7553191489361702
	Train acc at iteration 25: 0.7852564102564102
	Val acc at iteration 24: 0.6808510638297872
	Train acc at iteration 26: 0.8108974358974359
	Val acc at iteration 25: 0.6914893617021277
	Train acc at iteration 27: 0.7435897435897436
	Val acc at iteration 26: 0.7127659574468085
	Train acc at iteration 28: 0.7660256410256411
	Val acc at iteration 27: 0.7021276595744681
	Train acc at iteration 29: 0.7532051282051282
	Val acc at iteration 28: 0.7127659574468085
	Train acc at iteration 30: 0.7932692307692307
	Val acc at iteration 29: 0.6170212765957447
	Train acc at iteration 31: 0.7756410256410257
	Val acc at iteration 30: 0.6595744680851063
	Train acc at iteration 32: 0.7628205128205128
	Val acc at iteration 31: 0.6276595744680851
	Train acc at iteration 33: 0.7692307692307693
	Val acc at iteration 32: 0.7659574468085106
	Train acc at iteration 34: 0.7900641025641025
	Val acc at iteration 33: 0.723404255319149
	Train acc at iteration 35: 0.7660256410256411
	Val acc at iteration 34: 0.6914893617021277
	Train acc at iteration 36: 0.7884615384615384
	Val acc at iteration 35: 0.6170212765957447
	Train acc at iteration 37: 0.7932692307692307
	Val acc at iteration 36: 0.6914893617021277
	Train acc at iteration 38: 0.7628205128205128
	Val acc at iteration 37: 0.723404255319149
	Train acc at iteration 39: 0.7980769230769231
	Val acc at iteration 38: 0.7127659574468085
	Train acc at iteration 40: 0.7868589743589743
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.7932692307692307
	Val acc at iteration 40: 0.5957446808510638
	Train acc at iteration 42: 0.7900641025641025
	Val acc at iteration 41: 0.776595744680851
	Train acc at iteration 43: 0.7644230769230769
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.7836538461538461
	Val acc at iteration 43: 0.7127659574468085
	Train acc at iteration 45: 0.7836538461538461
	Val acc at iteration 44: 0.6808510638297872
	Train acc at iteration 46: 0.7852564102564102
	Val acc at iteration 45: 0.6808510638297872
	Train acc at iteration 47: 0.7580128205128205
	Val acc at iteration 46: 0.7021276595744681
	Train acc at iteration 48: 0.7868589743589743
	Val acc at iteration 47: 0.7021276595744681
	Train acc at iteration 49: 0.780448717948718
	Val acc at iteration 48: 0.5851063829787234
	Train acc at iteration 50: 0.8012820512820513
	Val acc at iteration 49: 0.6808510638297872
	Train acc at iteration 51: 0.7676282051282052
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.7628205128205128
	Val acc at iteration 51: 0.776595744680851
	Train acc at iteration 53: 0.8012820512820513
	Val acc at iteration 52: 0.6170212765957447
	Train acc at iteration 54: 0.7740384615384616
	Val acc at iteration 53: 0.5851063829787234
	Train acc at iteration 55: 0.780448717948718
	Val acc at iteration 54: 0.6063829787234043
	Train acc at iteration 56: 0.8028846153846154
	Val acc at iteration 55: 0.7340425531914894
	Train acc at iteration 57: 0.782051282051282
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.7836538461538461
	Val acc at iteration 57: 0.5957446808510638
	Train acc at iteration 59: 0.7612179487179487
	Val acc at iteration 58: 0.648936170212766
	Train acc at iteration 60: 0.7852564102564102
	Val acc at iteration 59: 0.7553191489361702
	Train acc at iteration 61: 0.7788461538461539
	Val acc at iteration 60: 0.7446808510638298
	Train acc at iteration 62: 0.782051282051282
	Val acc at iteration 61: 0.7553191489361702
	Train acc at iteration 63: 0.782051282051282
	Val acc at iteration 62: 0.6808510638297872
	Train acc at iteration 64: 0.7788461538461539
	Val acc at iteration 63: 0.6702127659574468
	Train acc at iteration 65: 0.7483974358974359
	Val acc at iteration 64: 0.6914893617021277
	Train acc at iteration 66: 0.7692307692307693
	Val acc at iteration 65: 0.7659574468085106
	Train acc at iteration 67: 0.7740384615384616
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.7932692307692307
	Val acc at iteration 67: 0.6702127659574468
	Train acc at iteration 69: 0.7580128205128205
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.7836538461538461
	Val acc at iteration 69: 0.7021276595744681
	Train acc at iteration 71: 0.7948717948717948
	Val acc at iteration 70: 0.7127659574468085
	Train acc at iteration 72: 0.7868589743589743
	Val acc at iteration 71: 0.7446808510638298
	Train acc at iteration 73: 0.7692307692307693
	Val acc at iteration 72: 0.6808510638297872
	Train acc at iteration 74: 0.7724358974358975
	Val acc at iteration 73: 0.723404255319149
	Train acc at iteration 75: 0.7916666666666666
	Val acc at iteration 74: 0.6702127659574468
	Train acc at iteration 76: 0.7628205128205128
	Val acc at iteration 75: 0.6595744680851063
	Train acc at iteration 77: 0.7403846153846154
	Val acc at iteration 76: 0.6063829787234043
	Train acc at iteration 78: 0.7740384615384616
	Val acc at iteration 77: 0.6702127659574468
	Train acc at iteration 79: 0.7660256410256411
	Val acc at iteration 78: 0.6595744680851063
	Train acc at iteration 80: 0.7708333333333334
	Val acc at iteration 79: 0.5957446808510638
	Train acc at iteration 81: 0.7772435897435898
	Val acc at iteration 80: 0.6808510638297872
	Train acc at iteration 82: 0.7772435897435898
	Val acc at iteration 81: 0.7021276595744681
	Train acc at iteration 83: 0.75
	Val acc at iteration 82: 0.7340425531914894
	Train acc at iteration 84: 0.7756410256410257
	Val acc at iteration 83: 0.6595744680851063
	Train acc at iteration 85: 0.7868589743589743
	Val acc at iteration 84: 0.6808510638297872
	Train acc at iteration 86: 0.7724358974358975
	Val acc at iteration 85: 0.6914893617021277
	Train acc at iteration 87: 0.7868589743589743
	Val acc at iteration 86: 0.7021276595744681
	Train acc at iteration 88: 0.7836538461538461
	Val acc at iteration 87: 0.6808510638297872
	Train acc at iteration 89: 0.7628205128205128
	Val acc at iteration 88: 0.7553191489361702
	Train acc at iteration 90: 0.7564102564102564
	Val acc at iteration 89: 0.7021276595744681
	Train acc at iteration 91: 0.8125
	Val acc at iteration 90: 0.7872340425531915
	Train acc at iteration 92: 0.7564102564102564
	Val acc at iteration 91: 0.7872340425531915
	Train acc at iteration 93: 0.7772435897435898
	Val acc at iteration 92: 0.7021276595744681
	Train acc at iteration 94: 0.7612179487179487
	Val acc at iteration 93: 0.6595744680851063
	Train acc at iteration 95: 0.782051282051282
	Val acc at iteration 94: 0.6702127659574468
	Train acc at iteration 96: 0.7628205128205128
	Val acc at iteration 95: 0.6914893617021277
	Train acc at iteration 97: 0.7868589743589743
	Val acc at iteration 96: 0.6808510638297872
	Train acc at iteration 98: 0.7740384615384616
	Val acc at iteration 97: 0.5957446808510638
	Train acc at iteration 99: 0.7435897435897436
	Val acc at iteration 98: 0.7340425531914894
	Train acc at iteration 100: 0.7868589743589743
	Val acc at iteration 99: 0.6276595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5850340136054422
Final val micro accuracy: 0.7021276595744681
Final test macro f1-score: 0.4666666666666666
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.6320573389530182
	Separation: 0.5388067364692688
Final test:
	Cluster: 0.6057982742786407
	Separation: 0.5424661636352539
Saved Results

Attempting combination 19/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 24.0
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8044871794871795
	Cluster: 0.6565217494964599
	Separation: 0.521184253692627
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.7553191489361702
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.6276595744680851
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.7446808510638298
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.5638297872340425
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.7553191489361702
	Val acc at iteration 23: 0.7553191489361702
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.6382978723404256
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7659574468085106
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6382978723404256
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.5957446808510638
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.6276595744680851
	Val acc at iteration 86: 0.6914893617021277
	Val acc at iteration 87: 0.6702127659574468
	Val acc at iteration 88: 0.776595744680851
	Val acc at iteration 89: 0.6808510638297872
	Val acc at iteration 90: 0.7127659574468085
	Val acc at iteration 91: 0.6702127659574468
	Val acc at iteration 92: 0.7446808510638298
	Val acc at iteration 93: 0.6595744680851063
	Val acc at iteration 94: 0.6914893617021277
	Val acc at iteration 95: 0.648936170212766
	Val acc at iteration 96: 0.6382978723404256
	Val acc at iteration 97: 0.648936170212766
	Val acc at iteration 98: 0.7659574468085106
	Val acc at iteration 99: 0.7127659574468085
Val acc before epoch 16: 0.7021276595744681
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Cluster: 0.6489441752433777
	Separation: 0.5184892058372498
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.7872340425531915
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.7553191489361702
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.776595744680851
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.648936170212766
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.776595744680851
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.6170212765957447
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.7659574468085106
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.7021276595744681
	Val acc at iteration 85: 0.723404255319149
	Val acc at iteration 86: 0.6808510638297872
	Val acc at iteration 87: 0.7021276595744681
	Val acc at iteration 88: 0.7021276595744681
	Val acc at iteration 89: 0.776595744680851
	Val acc at iteration 90: 0.7127659574468085
	Val acc at iteration 91: 0.776595744680851
	Val acc at iteration 92: 0.648936170212766
	Val acc at iteration 93: 0.7021276595744681
	Val acc at iteration 94: 0.7978723404255319
	Val acc at iteration 95: 0.7553191489361702
	Val acc at iteration 96: 0.7127659574468085
	Val acc at iteration 97: 0.7553191489361702
	Val acc at iteration 98: 0.6914893617021277
	Val acc at iteration 99: 0.6170212765957447
Val acc before epoch 26: 0.7127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.925531914893617
Stopping after epoch 36.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Cluster: 0.6520140409469605
	Separation: 0.5176733493804931
(After push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8108974358974359
	Val acc at iteration 0: 0.7127659574468085
	Train acc at iteration 2: 0.8269230769230769
	Val acc at iteration 1: 0.6702127659574468
	Train acc at iteration 3: 0.8044871794871795
	Val acc at iteration 2: 0.7553191489361702
	Train acc at iteration 4: 0.8044871794871795
	Val acc at iteration 3: 0.6595744680851063
	Train acc at iteration 5: 0.8060897435897436
	Val acc at iteration 4: 0.6595744680851063
	Train acc at iteration 6: 0.8237179487179487
	Val acc at iteration 5: 0.7446808510638298
	Train acc at iteration 7: 0.8012820512820513
	Val acc at iteration 6: 0.7659574468085106
	Train acc at iteration 8: 0.7996794871794872
	Val acc at iteration 7: 0.723404255319149
	Train acc at iteration 9: 0.7948717948717948
	Val acc at iteration 8: 0.723404255319149
	Train acc at iteration 10: 0.8173076923076923
	Val acc at iteration 9: 0.723404255319149
	Train acc at iteration 11: 0.8092948717948718
	Val acc at iteration 10: 0.723404255319149
	Train acc at iteration 12: 0.844551282051282
	Val acc at iteration 11: 0.723404255319149
	Train acc at iteration 13: 0.8092948717948718
	Val acc at iteration 12: 0.7340425531914894
	Train acc at iteration 14: 0.8076923076923077
	Val acc at iteration 13: 0.723404255319149
	Train acc at iteration 15: 0.8157051282051282
	Val acc at iteration 14: 0.6702127659574468
	Train acc at iteration 16: 0.8028846153846154
	Val acc at iteration 15: 0.6595744680851063
	Train acc at iteration 17: 0.7884615384615384
	Val acc at iteration 16: 0.7127659574468085
	Train acc at iteration 18: 0.8076923076923077
	Val acc at iteration 17: 0.6914893617021277
	Train acc at iteration 19: 0.7996794871794872
	Val acc at iteration 18: 0.7659574468085106
	Train acc at iteration 20: 0.8221153846153846
	Val acc at iteration 19: 0.6914893617021277
	Train acc at iteration 21: 0.8092948717948718
	Val acc at iteration 20: 0.7340425531914894
	Train acc at iteration 22: 0.8125
	Val acc at iteration 21: 0.7978723404255319
	Train acc at iteration 23: 0.8060897435897436
	Val acc at iteration 22: 0.776595744680851
	Train acc at iteration 24: 0.780448717948718
	Val acc at iteration 23: 0.7553191489361702
	Train acc at iteration 25: 0.7932692307692307
	Val acc at iteration 24: 0.7021276595744681
	Train acc at iteration 26: 0.8189102564102564
	Val acc at iteration 25: 0.6914893617021277
	Train acc at iteration 27: 0.8189102564102564
	Val acc at iteration 26: 0.7127659574468085
	Train acc at iteration 28: 0.8076923076923077
	Val acc at iteration 27: 0.6808510638297872
	Train acc at iteration 29: 0.7852564102564102
	Val acc at iteration 28: 0.7340425531914894
	Train acc at iteration 30: 0.8044871794871795
	Val acc at iteration 29: 0.723404255319149
	Train acc at iteration 31: 0.8076923076923077
	Val acc at iteration 30: 0.7127659574468085
	Train acc at iteration 32: 0.7932692307692307
	Val acc at iteration 31: 0.7021276595744681
	Train acc at iteration 33: 0.8108974358974359
	Val acc at iteration 32: 0.7340425531914894
	Train acc at iteration 34: 0.7916666666666666
	Val acc at iteration 33: 0.6808510638297872
	Train acc at iteration 35: 0.8044871794871795
	Val acc at iteration 34: 0.6595744680851063
	Train acc at iteration 36: 0.8076923076923077
	Val acc at iteration 35: 0.6276595744680851
	Train acc at iteration 37: 0.7932692307692307
	Val acc at iteration 36: 0.7127659574468085
	Train acc at iteration 38: 0.8125
	Val acc at iteration 37: 0.723404255319149
	Train acc at iteration 39: 0.8173076923076923
	Val acc at iteration 38: 0.6808510638297872
	Train acc at iteration 40: 0.7996794871794872
	Val acc at iteration 39: 0.7340425531914894
	Train acc at iteration 41: 0.7900641025641025
	Val acc at iteration 40: 0.648936170212766
	Train acc at iteration 42: 0.8173076923076923
	Val acc at iteration 41: 0.7446808510638298
	Train acc at iteration 43: 0.8141025641025641
	Val acc at iteration 42: 0.7340425531914894
	Train acc at iteration 44: 0.7932692307692307
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.8285256410256411
	Val acc at iteration 44: 0.7340425531914894
	Train acc at iteration 46: 0.8189102564102564
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.7996794871794872
	Val acc at iteration 46: 0.7127659574468085
	Train acc at iteration 48: 0.8125
	Val acc at iteration 47: 0.7659574468085106
	Train acc at iteration 49: 0.7948717948717948
	Val acc at iteration 48: 0.7446808510638298
	Train acc at iteration 50: 0.7884615384615384
	Val acc at iteration 49: 0.7340425531914894
	Train acc at iteration 51: 0.7868589743589743
	Val acc at iteration 50: 0.7127659574468085
	Train acc at iteration 52: 0.7964743589743589
	Val acc at iteration 51: 0.7127659574468085
	Train acc at iteration 53: 0.8092948717948718
	Val acc at iteration 52: 0.723404255319149
	Train acc at iteration 54: 0.8189102564102564
	Val acc at iteration 53: 0.7021276595744681
	Train acc at iteration 55: 0.8012820512820513
	Val acc at iteration 54: 0.7021276595744681
	Train acc at iteration 56: 0.8253205128205128
	Val acc at iteration 55: 0.7021276595744681
	Train acc at iteration 57: 0.8189102564102564
	Val acc at iteration 56: 0.723404255319149
	Train acc at iteration 58: 0.8237179487179487
	Val acc at iteration 57: 0.6808510638297872
	Train acc at iteration 59: 0.8189102564102564
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.7772435897435898
	Val acc at iteration 59: 0.7659574468085106
	Train acc at iteration 61: 0.8108974358974359
	Val acc at iteration 60: 0.6382978723404256
	Train acc at iteration 62: 0.8253205128205128
	Val acc at iteration 61: 0.7446808510638298
	Train acc at iteration 63: 0.8461538461538461
	Val acc at iteration 62: 0.6702127659574468
	Train acc at iteration 64: 0.7996794871794872
	Val acc at iteration 63: 0.6914893617021277
	Train acc at iteration 65: 0.8060897435897436
	Val acc at iteration 64: 0.7021276595744681
	Train acc at iteration 66: 0.8157051282051282
	Val acc at iteration 65: 0.8085106382978723
	Train acc at iteration 67: 0.7900641025641025
	Val acc at iteration 66: 0.7127659574468085
	Train acc at iteration 68: 0.7932692307692307
	Val acc at iteration 67: 0.648936170212766
	Train acc at iteration 69: 0.7884615384615384
	Val acc at iteration 68: 0.7340425531914894
	Train acc at iteration 70: 0.8349358974358975
	Val acc at iteration 69: 0.723404255319149
	Train acc at iteration 71: 0.7996794871794872
	Val acc at iteration 70: 0.7340425531914894
	Train acc at iteration 72: 0.8157051282051282
	Val acc at iteration 71: 0.723404255319149
	Train acc at iteration 73: 0.8317307692307693
	Val acc at iteration 72: 0.7340425531914894
	Train acc at iteration 74: 0.8237179487179487
	Val acc at iteration 73: 0.7021276595744681
	Train acc at iteration 75: 0.8012820512820513
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.7740384615384616
	Val acc at iteration 75: 0.776595744680851
	Train acc at iteration 77: 0.7980769230769231
	Val acc at iteration 76: 0.6702127659574468
	Train acc at iteration 78: 0.8141025641025641
	Val acc at iteration 77: 0.723404255319149
	Train acc at iteration 79: 0.8157051282051282
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.8076923076923077
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.8301282051282052
	Val acc at iteration 80: 0.7127659574468085
	Train acc at iteration 82: 0.8173076923076923
	Val acc at iteration 81: 0.7021276595744681
	Train acc at iteration 83: 0.8141025641025641
	Val acc at iteration 82: 0.6808510638297872
	Train acc at iteration 84: 0.7980769230769231
	Val acc at iteration 83: 0.5957446808510638
	Train acc at iteration 85: 0.8221153846153846
	Val acc at iteration 84: 0.7021276595744681
	Train acc at iteration 86: 0.8237179487179487
	Val acc at iteration 85: 0.7340425531914894
	Train acc at iteration 87: 0.8173076923076923
	Val acc at iteration 86: 0.6914893617021277
	Train acc at iteration 88: 0.7932692307692307
	Val acc at iteration 87: 0.6808510638297872
	Train acc at iteration 89: 0.8189102564102564
	Val acc at iteration 88: 0.7021276595744681
	Train acc at iteration 90: 0.8060897435897436
	Val acc at iteration 89: 0.7446808510638298
	Train acc at iteration 91: 0.8060897435897436
	Val acc at iteration 90: 0.7340425531914894
	Train acc at iteration 92: 0.8253205128205128
	Val acc at iteration 91: 0.7127659574468085
	Train acc at iteration 93: 0.8141025641025641
	Val acc at iteration 92: 0.7553191489361702
	Train acc at iteration 94: 0.8269230769230769
	Val acc at iteration 93: 0.6702127659574468
	Train acc at iteration 95: 0.8092948717948718
	Val acc at iteration 94: 0.7340425531914894
	Train acc at iteration 96: 0.7916666666666666
	Val acc at iteration 95: 0.6382978723404256
	Train acc at iteration 97: 0.7788461538461539
	Val acc at iteration 96: 0.7127659574468085
	Train acc at iteration 98: 0.8092948717948718
	Val acc at iteration 97: 0.7340425531914894
	Train acc at iteration 99: 0.7836538461538461
	Val acc at iteration 98: 0.7446808510638298
	Train acc at iteration 100: 0.8141025641025641
	Val acc at iteration 99: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6122448979591837
Final val micro accuracy: 0.723404255319149
Final test macro f1-score: 0.560919540229885
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.61063352227211
	Separation: 0.5369578897953033
Final test:
	Cluster: 0.6156233251094818
	Separation: 0.5354093015193939
Saved Results

Attempting combination 20/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 10
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7916666666666666
	Cluster: 0.6416812896728515
	Separation: 0.5182361245155335
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.5531914893617021
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.5957446808510638
	Val acc at iteration 4: 0.6276595744680851
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.5957446808510638
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.5851063829787234
	Val acc at iteration 16: 0.5957446808510638
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.5638297872340425
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6276595744680851
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.7659574468085106
	Val acc at iteration 27: 0.5957446808510638
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.5957446808510638
	Val acc at iteration 30: 0.6063829787234043
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.6170212765957447
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.6276595744680851
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.6276595744680851
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.6382978723404256
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6063829787234043
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.6170212765957447
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.6170212765957447
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.776595744680851
	Val acc at iteration 81: 0.6170212765957447
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.723404255319149
	Val acc at iteration 85: 0.6914893617021277
	Val acc at iteration 86: 0.6595744680851063
	Val acc at iteration 87: 0.648936170212766
	Val acc at iteration 88: 0.6276595744680851
	Val acc at iteration 89: 0.6808510638297872
	Val acc at iteration 90: 0.648936170212766
	Val acc at iteration 91: 0.6808510638297872
	Val acc at iteration 92: 0.6702127659574468
	Val acc at iteration 93: 0.648936170212766
	Val acc at iteration 94: 0.7021276595744681
	Val acc at iteration 95: 0.6595744680851063
	Val acc at iteration 96: 0.7021276595744681
	Val acc at iteration 97: 0.723404255319149
	Val acc at iteration 98: 0.6063829787234043
	Val acc at iteration 99: 0.648936170212766
Val acc before epoch 16: 0.6595744680851063
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Cluster: 0.6535976767539978
	Separation: 0.5178787648677826
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.5957446808510638
	Val acc at iteration 7: 0.5957446808510638
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6063829787234043
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.5957446808510638
	Val acc at iteration 18: 0.574468085106383
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.776595744680851
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.6063829787234043
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.5851063829787234
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.6063829787234043
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.648936170212766
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6276595744680851
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.6382978723404256
	Val acc at iteration 79: 0.6382978723404256
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6914893617021277
	Val acc at iteration 85: 0.7021276595744681
	Val acc at iteration 86: 0.6170212765957447
	Val acc at iteration 87: 0.6276595744680851
	Val acc at iteration 88: 0.776595744680851
	Val acc at iteration 89: 0.6702127659574468
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.6382978723404256
	Val acc at iteration 92: 0.5957446808510638
	Val acc at iteration 93: 0.7021276595744681
	Val acc at iteration 94: 0.6170212765957447
	Val acc at iteration 95: 0.7021276595744681
	Val acc at iteration 96: 0.6595744680851063
	Val acc at iteration 97: 0.6276595744680851
	Val acc at iteration 98: 0.6276595744680851
	Val acc at iteration 99: 0.7021276595744681
Val acc before epoch 26: 0.6382978723404256
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.6914893617021277
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.851063829787234
Stopping after epoch 36.
Final validation accuracy before push: 85.1063829787234%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Cluster: 0.6497304797172546
	Separation: 0.5186522483825684
(After push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7948717948717948
	Val acc at iteration 0: 0.648936170212766
	Train acc at iteration 2: 0.8076923076923077
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.7900641025641025
	Val acc at iteration 2: 0.7659574468085106
	Train acc at iteration 4: 0.7964743589743589
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.7916666666666666
	Val acc at iteration 4: 0.6914893617021277
	Train acc at iteration 6: 0.7836538461538461
	Val acc at iteration 5: 0.7872340425531915
	Train acc at iteration 7: 0.7868589743589743
	Val acc at iteration 6: 0.7446808510638298
	Train acc at iteration 8: 0.7980769230769231
	Val acc at iteration 7: 0.7340425531914894
	Train acc at iteration 9: 0.782051282051282
	Val acc at iteration 8: 0.6170212765957447
	Train acc at iteration 10: 0.7788461538461539
	Val acc at iteration 9: 0.6063829787234043
	Train acc at iteration 11: 0.7980769230769231
	Val acc at iteration 10: 0.6276595744680851
	Train acc at iteration 12: 0.7740384615384616
	Val acc at iteration 11: 0.5957446808510638
	Train acc at iteration 13: 0.7772435897435898
	Val acc at iteration 12: 0.6276595744680851
	Train acc at iteration 14: 0.7980769230769231
	Val acc at iteration 13: 0.648936170212766
	Train acc at iteration 15: 0.7916666666666666
	Val acc at iteration 14: 0.6914893617021277
	Train acc at iteration 16: 0.7788461538461539
	Val acc at iteration 15: 0.6702127659574468
	Train acc at iteration 17: 0.7932692307692307
	Val acc at iteration 16: 0.6808510638297872
	Train acc at iteration 18: 0.7996794871794872
	Val acc at iteration 17: 0.6914893617021277
	Train acc at iteration 19: 0.7740384615384616
	Val acc at iteration 18: 0.648936170212766
	Train acc at iteration 20: 0.8012820512820513
	Val acc at iteration 19: 0.7553191489361702
	Train acc at iteration 21: 0.7740384615384616
	Val acc at iteration 20: 0.6382978723404256
	Train acc at iteration 22: 0.7964743589743589
	Val acc at iteration 21: 0.6382978723404256
	Train acc at iteration 23: 0.7932692307692307
	Val acc at iteration 22: 0.7021276595744681
	Train acc at iteration 24: 0.7708333333333334
	Val acc at iteration 23: 0.6276595744680851
	Train acc at iteration 25: 0.7964743589743589
	Val acc at iteration 24: 0.6702127659574468
	Train acc at iteration 26: 0.8028846153846154
	Val acc at iteration 25: 0.6276595744680851
	Train acc at iteration 27: 0.7852564102564102
	Val acc at iteration 26: 0.6808510638297872
	Train acc at iteration 28: 0.7900641025641025
	Val acc at iteration 27: 0.574468085106383
	Train acc at iteration 29: 0.8092948717948718
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.8060897435897436
	Val acc at iteration 29: 0.7446808510638298
	Train acc at iteration 31: 0.7996794871794872
	Val acc at iteration 30: 0.6808510638297872
	Train acc at iteration 32: 0.7756410256410257
	Val acc at iteration 31: 0.6808510638297872
	Train acc at iteration 33: 0.7980769230769231
	Val acc at iteration 32: 0.6382978723404256
	Train acc at iteration 34: 0.7756410256410257
	Val acc at iteration 33: 0.648936170212766
	Train acc at iteration 35: 0.7884615384615384
	Val acc at iteration 34: 0.723404255319149
	Train acc at iteration 36: 0.7676282051282052
	Val acc at iteration 35: 0.6595744680851063
	Train acc at iteration 37: 0.7772435897435898
	Val acc at iteration 36: 0.5957446808510638
	Train acc at iteration 38: 0.7852564102564102
	Val acc at iteration 37: 0.6595744680851063
	Train acc at iteration 39: 0.7980769230769231
	Val acc at iteration 38: 0.7127659574468085
	Train acc at iteration 40: 0.7916666666666666
	Val acc at iteration 39: 0.7340425531914894
	Train acc at iteration 41: 0.7772435897435898
	Val acc at iteration 40: 0.6276595744680851
	Train acc at iteration 42: 0.7900641025641025
	Val acc at iteration 41: 0.6702127659574468
	Train acc at iteration 43: 0.8076923076923077
	Val acc at iteration 42: 0.6595744680851063
	Train acc at iteration 44: 0.7836538461538461
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.8173076923076923
	Val acc at iteration 44: 0.6276595744680851
	Train acc at iteration 46: 0.8269230769230769
	Val acc at iteration 45: 0.6914893617021277
	Train acc at iteration 47: 0.7916666666666666
	Val acc at iteration 46: 0.6595744680851063
	Train acc at iteration 48: 0.782051282051282
	Val acc at iteration 47: 0.648936170212766
	Train acc at iteration 49: 0.7724358974358975
	Val acc at iteration 48: 0.6595744680851063
	Train acc at iteration 50: 0.7772435897435898
	Val acc at iteration 49: 0.7127659574468085
	Train acc at iteration 51: 0.7916666666666666
	Val acc at iteration 50: 0.6808510638297872
	Train acc at iteration 52: 0.7868589743589743
	Val acc at iteration 51: 0.7978723404255319
	Train acc at iteration 53: 0.7628205128205128
	Val acc at iteration 52: 0.6276595744680851
	Train acc at iteration 54: 0.7948717948717948
	Val acc at iteration 53: 0.723404255319149
	Train acc at iteration 55: 0.7932692307692307
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.7644230769230769
	Val acc at iteration 55: 0.5957446808510638
	Train acc at iteration 57: 0.7996794871794872
	Val acc at iteration 56: 0.6276595744680851
	Train acc at iteration 58: 0.7660256410256411
	Val acc at iteration 57: 0.7127659574468085
	Train acc at iteration 59: 0.8012820512820513
	Val acc at iteration 58: 0.648936170212766
	Train acc at iteration 60: 0.7756410256410257
	Val acc at iteration 59: 0.6595744680851063
	Train acc at iteration 61: 0.7996794871794872
	Val acc at iteration 60: 0.6808510638297872
	Train acc at iteration 62: 0.7948717948717948
	Val acc at iteration 61: 0.6808510638297872
	Train acc at iteration 63: 0.7900641025641025
	Val acc at iteration 62: 0.648936170212766
	Train acc at iteration 64: 0.8157051282051282
	Val acc at iteration 63: 0.648936170212766
	Train acc at iteration 65: 0.780448717948718
	Val acc at iteration 64: 0.6808510638297872
	Train acc at iteration 66: 0.7740384615384616
	Val acc at iteration 65: 0.6702127659574468
	Train acc at iteration 67: 0.8092948717948718
	Val acc at iteration 66: 0.7127659574468085
	Train acc at iteration 68: 0.8076923076923077
	Val acc at iteration 67: 0.6914893617021277
	Train acc at iteration 69: 0.7868589743589743
	Val acc at iteration 68: 0.6702127659574468
	Train acc at iteration 70: 0.8044871794871795
	Val acc at iteration 69: 0.6914893617021277
	Train acc at iteration 71: 0.7644230769230769
	Val acc at iteration 70: 0.6702127659574468
	Train acc at iteration 72: 0.7708333333333334
	Val acc at iteration 71: 0.7021276595744681
	Train acc at iteration 73: 0.7868589743589743
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.7900641025641025
	Val acc at iteration 73: 0.7340425531914894
	Train acc at iteration 75: 0.7740384615384616
	Val acc at iteration 74: 0.6914893617021277
	Train acc at iteration 76: 0.7916666666666666
	Val acc at iteration 75: 0.723404255319149
	Train acc at iteration 77: 0.8237179487179487
	Val acc at iteration 76: 0.6808510638297872
	Train acc at iteration 78: 0.7884615384615384
	Val acc at iteration 77: 0.7127659574468085
	Train acc at iteration 79: 0.8205128205128205
	Val acc at iteration 78: 0.574468085106383
	Train acc at iteration 80: 0.7772435897435898
	Val acc at iteration 79: 0.7446808510638298
	Train acc at iteration 81: 0.7996794871794872
	Val acc at iteration 80: 0.6808510638297872
	Train acc at iteration 82: 0.7724358974358975
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7868589743589743
	Val acc at iteration 82: 0.6808510638297872
	Train acc at iteration 84: 0.7836538461538461
	Val acc at iteration 83: 0.723404255319149
	Train acc at iteration 85: 0.8173076923076923
	Val acc at iteration 84: 0.6595744680851063
	Train acc at iteration 86: 0.7852564102564102
	Val acc at iteration 85: 0.7340425531914894
	Train acc at iteration 87: 0.7948717948717948
	Val acc at iteration 86: 0.7021276595744681
	Train acc at iteration 88: 0.8189102564102564
	Val acc at iteration 87: 0.723404255319149
	Train acc at iteration 89: 0.7900641025641025
	Val acc at iteration 88: 0.6170212765957447
	Train acc at iteration 90: 0.7932692307692307
	Val acc at iteration 89: 0.6595744680851063
	Train acc at iteration 91: 0.8060897435897436
	Val acc at iteration 90: 0.7340425531914894
	Train acc at iteration 92: 0.7996794871794872
	Val acc at iteration 91: 0.7446808510638298
	Train acc at iteration 93: 0.7900641025641025
	Val acc at iteration 92: 0.6595744680851063
	Train acc at iteration 94: 0.7964743589743589
	Val acc at iteration 93: 0.7659574468085106
	Train acc at iteration 95: 0.7772435897435898
	Val acc at iteration 94: 0.6808510638297872
	Train acc at iteration 96: 0.780448717948718
	Val acc at iteration 95: 0.7021276595744681
	Train acc at iteration 97: 0.7948717948717948
	Val acc at iteration 96: 0.7553191489361702
	Train acc at iteration 98: 0.7580128205128205
	Val acc at iteration 97: 0.6170212765957447
	Train acc at iteration 99: 0.7852564102564102
	Val acc at iteration 98: 0.7340425531914894
	Train acc at iteration 100: 0.8012820512820513
	Val acc at iteration 99: 0.6702127659574468
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6020408163265305
Final val micro accuracy: 0.7021276595744681
Final test macro f1-score: 0.5704545454545454
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.6206938922405243
	Separation: 0.5473177433013916
Final test:
	Cluster: 0.6079427301883698
	Separation: 0.5413737595081329
Saved Results

Attempting combination 21/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.40425531914893614
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Cluster: 0.6511457562446594
	Separation: 0.5178451657295227
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7872340425531915
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.7872340425531915
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6170212765957447
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.7446808510638298
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.6170212765957447
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.6276595744680851
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.6382978723404256
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.5957446808510638
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6063829787234043
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.6276595744680851
	Val acc at iteration 66: 0.5957446808510638
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.648936170212766
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.5957446808510638
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.648936170212766
	Val acc at iteration 84: 0.6063829787234043
	Val acc at iteration 85: 0.7127659574468085
	Val acc at iteration 86: 0.6914893617021277
	Val acc at iteration 87: 0.6170212765957447
	Val acc at iteration 88: 0.7127659574468085
	Val acc at iteration 89: 0.574468085106383
	Val acc at iteration 90: 0.7021276595744681
	Val acc at iteration 91: 0.6595744680851063
	Val acc at iteration 92: 0.7021276595744681
	Val acc at iteration 93: 0.8085106382978723
	Val acc at iteration 94: 0.723404255319149
	Val acc at iteration 95: 0.7553191489361702
	Val acc at iteration 96: 0.6595744680851063
	Val acc at iteration 97: 0.6702127659574468
	Val acc at iteration 98: 0.7340425531914894
	Val acc at iteration 99: 0.6063829787234043
Val acc before epoch 16: 0.6595744680851063
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7852564102564102
	Cluster: 0.6412893772125244
	Separation: 0.5139551162719727
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.776595744680851
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.6170212765957447
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.7659574468085106
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6170212765957447
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.6063829787234043
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.574468085106383
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.6382978723404256
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.6276595744680851
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.776595744680851
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.6170212765957447
	Val acc at iteration 67: 0.6382978723404256
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.723404255319149
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.7978723404255319
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.6808510638297872
	Val acc at iteration 85: 0.7127659574468085
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.7446808510638298
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.6808510638297872
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.6914893617021277
	Val acc at iteration 92: 0.6170212765957447
	Val acc at iteration 93: 0.6914893617021277
	Val acc at iteration 94: 0.6595744680851063
	Val acc at iteration 95: 0.7021276595744681
	Val acc at iteration 96: 0.7340425531914894
	Val acc at iteration 97: 0.723404255319149
	Val acc at iteration 98: 0.6382978723404256
	Val acc at iteration 99: 0.7659574468085106
Val acc before epoch 26: 0.6063829787234043
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8936170212765957
Stopping after epoch 36.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7660256410256411
	Cluster: 0.649377417564392
	Separation: 0.5239610314369202
(After push) Val acc at iteration 0: 0.648936170212766
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7644230769230769
	Val acc at iteration 0: 0.776595744680851
	Train acc at iteration 2: 0.7564102564102564
	Val acc at iteration 1: 0.6595744680851063
	Train acc at iteration 3: 0.7740384615384616
	Val acc at iteration 2: 0.6382978723404256
	Train acc at iteration 4: 0.7724358974358975
	Val acc at iteration 3: 0.6595744680851063
	Train acc at iteration 5: 0.8044871794871795
	Val acc at iteration 4: 0.7127659574468085
	Train acc at iteration 6: 0.7948717948717948
	Val acc at iteration 5: 0.6808510638297872
	Train acc at iteration 7: 0.7772435897435898
	Val acc at iteration 6: 0.6382978723404256
	Train acc at iteration 8: 0.7756410256410257
	Val acc at iteration 7: 0.7446808510638298
	Train acc at iteration 9: 0.7644230769230769
	Val acc at iteration 8: 0.7021276595744681
	Train acc at iteration 10: 0.780448717948718
	Val acc at iteration 9: 0.6808510638297872
	Train acc at iteration 11: 0.7371794871794872
	Val acc at iteration 10: 0.723404255319149
	Train acc at iteration 12: 0.7740384615384616
	Val acc at iteration 11: 0.7446808510638298
	Train acc at iteration 13: 0.7692307692307693
	Val acc at iteration 12: 0.6914893617021277
	Train acc at iteration 14: 0.7644230769230769
	Val acc at iteration 13: 0.7021276595744681
	Train acc at iteration 15: 0.7868589743589743
	Val acc at iteration 14: 0.6170212765957447
	Train acc at iteration 16: 0.7580128205128205
	Val acc at iteration 15: 0.648936170212766
	Train acc at iteration 17: 0.7852564102564102
	Val acc at iteration 16: 0.723404255319149
	Train acc at iteration 18: 0.782051282051282
	Val acc at iteration 17: 0.7127659574468085
	Train acc at iteration 19: 0.7676282051282052
	Val acc at iteration 18: 0.6702127659574468
	Train acc at iteration 20: 0.7628205128205128
	Val acc at iteration 19: 0.648936170212766
	Train acc at iteration 21: 0.7868589743589743
	Val acc at iteration 20: 0.6808510638297872
	Train acc at iteration 22: 0.7900641025641025
	Val acc at iteration 21: 0.6702127659574468
	Train acc at iteration 23: 0.7676282051282052
	Val acc at iteration 22: 0.776595744680851
	Train acc at iteration 24: 0.7676282051282052
	Val acc at iteration 23: 0.6595744680851063
	Train acc at iteration 25: 0.7483974358974359
	Val acc at iteration 24: 0.6914893617021277
	Train acc at iteration 26: 0.7708333333333334
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.7724358974358975
	Val acc at iteration 26: 0.6063829787234043
	Train acc at iteration 28: 0.7708333333333334
	Val acc at iteration 27: 0.6702127659574468
	Train acc at iteration 29: 0.8044871794871795
	Val acc at iteration 28: 0.7553191489361702
	Train acc at iteration 30: 0.7644230769230769
	Val acc at iteration 29: 0.776595744680851
	Train acc at iteration 31: 0.780448717948718
	Val acc at iteration 30: 0.6382978723404256
	Train acc at iteration 32: 0.7900641025641025
	Val acc at iteration 31: 0.6914893617021277
	Train acc at iteration 33: 0.7467948717948718
	Val acc at iteration 32: 0.6702127659574468
	Train acc at iteration 34: 0.7612179487179487
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.7596153846153846
	Val acc at iteration 34: 0.6808510638297872
	Train acc at iteration 36: 0.7467948717948718
	Val acc at iteration 35: 0.6595744680851063
	Train acc at iteration 37: 0.7868589743589743
	Val acc at iteration 36: 0.7553191489361702
	Train acc at iteration 38: 0.7676282051282052
	Val acc at iteration 37: 0.6382978723404256
	Train acc at iteration 39: 0.780448717948718
	Val acc at iteration 38: 0.6914893617021277
	Train acc at iteration 40: 0.7788461538461539
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.7884615384615384
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.7996794871794872
	Val acc at iteration 41: 0.6914893617021277
	Train acc at iteration 43: 0.7772435897435898
	Val acc at iteration 42: 0.8191489361702128
	Train acc at iteration 44: 0.7740384615384616
	Val acc at iteration 43: 0.6808510638297872
	Train acc at iteration 45: 0.7724358974358975
	Val acc at iteration 44: 0.7340425531914894
	Train acc at iteration 46: 0.8108974358974359
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.7692307692307693
	Val acc at iteration 46: 0.7553191489361702
	Train acc at iteration 48: 0.7451923076923077
	Val acc at iteration 47: 0.6595744680851063
	Train acc at iteration 49: 0.7836538461538461
	Val acc at iteration 48: 0.6702127659574468
	Train acc at iteration 50: 0.7756410256410257
	Val acc at iteration 49: 0.6702127659574468
	Train acc at iteration 51: 0.7932692307692307
	Val acc at iteration 50: 0.6914893617021277
	Train acc at iteration 52: 0.7836538461538461
	Val acc at iteration 51: 0.6702127659574468
	Train acc at iteration 53: 0.7836538461538461
	Val acc at iteration 52: 0.6595744680851063
	Train acc at iteration 54: 0.7708333333333334
	Val acc at iteration 53: 0.7446808510638298
	Train acc at iteration 55: 0.7676282051282052
	Val acc at iteration 54: 0.7659574468085106
	Train acc at iteration 56: 0.7740384615384616
	Val acc at iteration 55: 0.6808510638297872
	Train acc at iteration 57: 0.7900641025641025
	Val acc at iteration 56: 0.6702127659574468
	Train acc at iteration 58: 0.7724358974358975
	Val acc at iteration 57: 0.6382978723404256
	Train acc at iteration 59: 0.7612179487179487
	Val acc at iteration 58: 0.7659574468085106
	Train acc at iteration 60: 0.7548076923076923
	Val acc at iteration 59: 0.7127659574468085
	Train acc at iteration 61: 0.7836538461538461
	Val acc at iteration 60: 0.6595744680851063
	Train acc at iteration 62: 0.7548076923076923
	Val acc at iteration 61: 0.6914893617021277
	Train acc at iteration 63: 0.75
	Val acc at iteration 62: 0.6808510638297872
	Train acc at iteration 64: 0.7548076923076923
	Val acc at iteration 63: 0.6914893617021277
	Train acc at iteration 65: 0.7692307692307693
	Val acc at iteration 64: 0.723404255319149
	Train acc at iteration 66: 0.782051282051282
	Val acc at iteration 65: 0.7340425531914894
	Train acc at iteration 67: 0.7580128205128205
	Val acc at iteration 66: 0.7127659574468085
	Train acc at iteration 68: 0.7596153846153846
	Val acc at iteration 67: 0.6914893617021277
	Train acc at iteration 69: 0.7628205128205128
	Val acc at iteration 68: 0.7446808510638298
	Train acc at iteration 70: 0.7788461538461539
	Val acc at iteration 69: 0.6702127659574468
	Train acc at iteration 71: 0.7868589743589743
	Val acc at iteration 70: 0.723404255319149
	Train acc at iteration 72: 0.7564102564102564
	Val acc at iteration 71: 0.6914893617021277
	Train acc at iteration 73: 0.7868589743589743
	Val acc at iteration 72: 0.6276595744680851
	Train acc at iteration 74: 0.7836538461538461
	Val acc at iteration 73: 0.723404255319149
	Train acc at iteration 75: 0.7628205128205128
	Val acc at iteration 74: 0.723404255319149
	Train acc at iteration 76: 0.7483974358974359
	Val acc at iteration 75: 0.6595744680851063
	Train acc at iteration 77: 0.7852564102564102
	Val acc at iteration 76: 0.7127659574468085
	Train acc at iteration 78: 0.7788461538461539
	Val acc at iteration 77: 0.6382978723404256
	Train acc at iteration 79: 0.7596153846153846
	Val acc at iteration 78: 0.7553191489361702
	Train acc at iteration 80: 0.7740384615384616
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.7692307692307693
	Val acc at iteration 80: 0.7127659574468085
	Train acc at iteration 82: 0.7788461538461539
	Val acc at iteration 81: 0.7021276595744681
	Train acc at iteration 83: 0.7483974358974359
	Val acc at iteration 82: 0.6595744680851063
	Train acc at iteration 84: 0.7932692307692307
	Val acc at iteration 83: 0.7340425531914894
	Train acc at iteration 85: 0.7964743589743589
	Val acc at iteration 84: 0.6382978723404256
	Train acc at iteration 86: 0.7676282051282052
	Val acc at iteration 85: 0.7340425531914894
	Train acc at iteration 87: 0.780448717948718
	Val acc at iteration 86: 0.7127659574468085
	Train acc at iteration 88: 0.7836538461538461
	Val acc at iteration 87: 0.7659574468085106
	Train acc at iteration 89: 0.7580128205128205
	Val acc at iteration 88: 0.7340425531914894
	Train acc at iteration 90: 0.7660256410256411
	Val acc at iteration 89: 0.7021276595744681
	Train acc at iteration 91: 0.780448717948718
	Val acc at iteration 90: 0.7553191489361702
	Train acc at iteration 92: 0.7756410256410257
	Val acc at iteration 91: 0.723404255319149
	Train acc at iteration 93: 0.7916666666666666
	Val acc at iteration 92: 0.6808510638297872
	Train acc at iteration 94: 0.7964743589743589
	Val acc at iteration 93: 0.6914893617021277
	Train acc at iteration 95: 0.7756410256410257
	Val acc at iteration 94: 0.6914893617021277
	Train acc at iteration 96: 0.7660256410256411
	Val acc at iteration 95: 0.6808510638297872
	Train acc at iteration 97: 0.8076923076923077
	Val acc at iteration 96: 0.6702127659574468
	Train acc at iteration 98: 0.7724358974358975
	Val acc at iteration 97: 0.6808510638297872
	Train acc at iteration 99: 0.7676282051282052
	Val acc at iteration 98: 0.7446808510638298
	Train acc at iteration 100: 0.7612179487179487
	Val acc at iteration 99: 0.7340425531914894
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6374570446735396
Final val micro accuracy: 0.7446808510638298
Final test macro f1-score: 0.5537254901960784
Final test micro accuracy: 0.648936170212766
Final validation:
	Cluster: 0.6265649795532227
	Separation: 0.5427489876747131
Final test:
	Cluster: 0.5979797542095184
	Separation: 0.536983996629715
Saved Results

Attempting combination 22/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.35106382978723405
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8237179487179487
	Cluster: 0.651410186290741
	Separation: 0.5192342042922974
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.5531914893617021
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.7021276595744681
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.6276595744680851
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6063829787234043
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.6063829787234043
	Val acc at iteration 16: 0.5957446808510638
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.5851063829787234
	Val acc at iteration 24: 0.5957446808510638
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6276595744680851
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.7340425531914894
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.6702127659574468
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.776595744680851
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.6063829787234043
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.574468085106383
	Val acc at iteration 65: 0.6276595744680851
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.6595744680851063
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.6170212765957447
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.7021276595744681
	Val acc at iteration 86: 0.5957446808510638
	Val acc at iteration 87: 0.6276595744680851
	Val acc at iteration 88: 0.7127659574468085
	Val acc at iteration 89: 0.6595744680851063
	Val acc at iteration 90: 0.6595744680851063
	Val acc at iteration 91: 0.6595744680851063
	Val acc at iteration 92: 0.6595744680851063
	Val acc at iteration 93: 0.6170212765957447
	Val acc at iteration 94: 0.6595744680851063
	Val acc at iteration 95: 0.6276595744680851
	Val acc at iteration 96: 0.7127659574468085
	Val acc at iteration 97: 0.723404255319149
	Val acc at iteration 98: 0.7340425531914894
	Val acc at iteration 99: 0.648936170212766
Val acc before epoch 16: 0.6914893617021277
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7872340425531915
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9680851063829787
Push epoch
After push, before retraining last layer:
	Train acc: 0.7756410256410257
	Cluster: 0.645676064491272
	Separation: 0.5253978729248047
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.5319148936170213
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.6382978723404256
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.6808510638297872
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.6170212765957447
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.6063829787234043
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.6170212765957447
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.6382978723404256
	Val acc at iteration 86: 0.7553191489361702
	Val acc at iteration 87: 0.6382978723404256
	Val acc at iteration 88: 0.723404255319149
	Val acc at iteration 89: 0.776595744680851
	Val acc at iteration 90: 0.7446808510638298
	Val acc at iteration 91: 0.6702127659574468
	Val acc at iteration 92: 0.5
	Val acc at iteration 93: 0.6808510638297872
	Val acc at iteration 94: 0.7127659574468085
	Val acc at iteration 95: 0.6276595744680851
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.7021276595744681
	Val acc at iteration 98: 0.6063829787234043
	Val acc at iteration 99: 0.6382978723404256
Val acc before epoch 26: 0.7127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9148936170212766
Stopping after epoch 36.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7852564102564102
	Cluster: 0.6448667168617248
	Separation: 0.5233099460601807
(After push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7692307692307693
	Val acc at iteration 0: 0.7446808510638298
	Train acc at iteration 2: 0.7660256410256411
	Val acc at iteration 1: 0.6595744680851063
	Train acc at iteration 3: 0.8108974358974359
	Val acc at iteration 2: 0.6914893617021277
	Train acc at iteration 4: 0.7996794871794872
	Val acc at iteration 3: 0.7340425531914894
	Train acc at iteration 5: 0.7708333333333334
	Val acc at iteration 4: 0.6914893617021277
	Train acc at iteration 6: 0.7692307692307693
	Val acc at iteration 5: 0.6808510638297872
	Train acc at iteration 7: 0.7772435897435898
	Val acc at iteration 6: 0.6170212765957447
	Train acc at iteration 8: 0.7980769230769231
	Val acc at iteration 7: 0.723404255319149
	Train acc at iteration 9: 0.8108974358974359
	Val acc at iteration 8: 0.6063829787234043
	Train acc at iteration 10: 0.7900641025641025
	Val acc at iteration 9: 0.6170212765957447
	Train acc at iteration 11: 0.7740384615384616
	Val acc at iteration 10: 0.6276595744680851
	Train acc at iteration 12: 0.7676282051282052
	Val acc at iteration 11: 0.723404255319149
	Train acc at iteration 13: 0.7596153846153846
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.7772435897435898
	Val acc at iteration 13: 0.574468085106383
	Train acc at iteration 15: 0.7868589743589743
	Val acc at iteration 14: 0.7021276595744681
	Train acc at iteration 16: 0.7772435897435898
	Val acc at iteration 15: 0.6595744680851063
	Train acc at iteration 17: 0.8044871794871795
	Val acc at iteration 16: 0.6914893617021277
	Train acc at iteration 18: 0.8189102564102564
	Val acc at iteration 17: 0.6382978723404256
	Train acc at iteration 19: 0.780448717948718
	Val acc at iteration 18: 0.6914893617021277
	Train acc at iteration 20: 0.8221153846153846
	Val acc at iteration 19: 0.5957446808510638
	Train acc at iteration 21: 0.7740384615384616
	Val acc at iteration 20: 0.6170212765957447
	Train acc at iteration 22: 0.7708333333333334
	Val acc at iteration 21: 0.6702127659574468
	Train acc at iteration 23: 0.7996794871794872
	Val acc at iteration 22: 0.6276595744680851
	Train acc at iteration 24: 0.7916666666666666
	Val acc at iteration 23: 0.7340425531914894
	Train acc at iteration 25: 0.7724358974358975
	Val acc at iteration 24: 0.6702127659574468
	Train acc at iteration 26: 0.7772435897435898
	Val acc at iteration 25: 0.723404255319149
	Train acc at iteration 27: 0.7916666666666666
	Val acc at iteration 26: 0.6914893617021277
	Train acc at iteration 28: 0.7900641025641025
	Val acc at iteration 27: 0.6276595744680851
	Train acc at iteration 29: 0.7900641025641025
	Val acc at iteration 28: 0.6170212765957447
	Train acc at iteration 30: 0.7900641025641025
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.780448717948718
	Val acc at iteration 30: 0.6914893617021277
	Train acc at iteration 32: 0.7884615384615384
	Val acc at iteration 31: 0.6382978723404256
	Train acc at iteration 33: 0.7852564102564102
	Val acc at iteration 32: 0.6276595744680851
	Train acc at iteration 34: 0.8028846153846154
	Val acc at iteration 33: 0.7021276595744681
	Train acc at iteration 35: 0.7852564102564102
	Val acc at iteration 34: 0.6914893617021277
	Train acc at iteration 36: 0.7996794871794872
	Val acc at iteration 35: 0.7127659574468085
	Train acc at iteration 37: 0.7868589743589743
	Val acc at iteration 36: 0.574468085106383
	Train acc at iteration 38: 0.7980769230769231
	Val acc at iteration 37: 0.6914893617021277
	Train acc at iteration 39: 0.8012820512820513
	Val acc at iteration 38: 0.723404255319149
	Train acc at iteration 40: 0.7724358974358975
	Val acc at iteration 39: 0.7127659574468085
	Train acc at iteration 41: 0.7932692307692307
	Val acc at iteration 40: 0.6914893617021277
	Train acc at iteration 42: 0.7916666666666666
	Val acc at iteration 41: 0.6276595744680851
	Train acc at iteration 43: 0.782051282051282
	Val acc at iteration 42: 0.6595744680851063
	Train acc at iteration 44: 0.75
	Val acc at iteration 43: 0.6063829787234043
	Train acc at iteration 45: 0.7868589743589743
	Val acc at iteration 44: 0.7446808510638298
	Train acc at iteration 46: 0.7884615384615384
	Val acc at iteration 45: 0.6276595744680851
	Train acc at iteration 47: 0.8285256410256411
	Val acc at iteration 46: 0.6808510638297872
	Train acc at iteration 48: 0.782051282051282
	Val acc at iteration 47: 0.6914893617021277
	Train acc at iteration 49: 0.7900641025641025
	Val acc at iteration 48: 0.6595744680851063
	Train acc at iteration 50: 0.7644230769230769
	Val acc at iteration 49: 0.7021276595744681
	Train acc at iteration 51: 0.8028846153846154
	Val acc at iteration 50: 0.7021276595744681
	Train acc at iteration 52: 0.8189102564102564
	Val acc at iteration 51: 0.6595744680851063
	Train acc at iteration 53: 0.7868589743589743
	Val acc at iteration 52: 0.6595744680851063
	Train acc at iteration 54: 0.7580128205128205
	Val acc at iteration 53: 0.723404255319149
	Train acc at iteration 55: 0.7948717948717948
	Val acc at iteration 54: 0.6914893617021277
	Train acc at iteration 56: 0.8012820512820513
	Val acc at iteration 55: 0.6702127659574468
	Train acc at iteration 57: 0.7628205128205128
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.782051282051282
	Val acc at iteration 57: 0.6595744680851063
	Train acc at iteration 59: 0.7868589743589743
	Val acc at iteration 58: 0.6914893617021277
	Train acc at iteration 60: 0.8012820512820513
	Val acc at iteration 59: 0.648936170212766
	Train acc at iteration 61: 0.8076923076923077
	Val acc at iteration 60: 0.6276595744680851
	Train acc at iteration 62: 0.7964743589743589
	Val acc at iteration 61: 0.7021276595744681
	Train acc at iteration 63: 0.8028846153846154
	Val acc at iteration 62: 0.6595744680851063
	Train acc at iteration 64: 0.782051282051282
	Val acc at iteration 63: 0.6808510638297872
	Train acc at iteration 65: 0.7740384615384616
	Val acc at iteration 64: 0.6276595744680851
	Train acc at iteration 66: 0.8044871794871795
	Val acc at iteration 65: 0.6914893617021277
	Train acc at iteration 67: 0.7419871794871795
	Val acc at iteration 66: 0.6808510638297872
	Train acc at iteration 68: 0.7788461538461539
	Val acc at iteration 67: 0.7553191489361702
	Train acc at iteration 69: 0.7852564102564102
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.782051282051282
	Val acc at iteration 69: 0.5851063829787234
	Train acc at iteration 71: 0.7772435897435898
	Val acc at iteration 70: 0.6382978723404256
	Train acc at iteration 72: 0.7692307692307693
	Val acc at iteration 71: 0.7127659574468085
	Train acc at iteration 73: 0.7836538461538461
	Val acc at iteration 72: 0.6595744680851063
	Train acc at iteration 74: 0.7708333333333334
	Val acc at iteration 73: 0.7021276595744681
	Train acc at iteration 75: 0.7932692307692307
	Val acc at iteration 74: 0.6595744680851063
	Train acc at iteration 76: 0.8076923076923077
	Val acc at iteration 75: 0.6063829787234043
	Train acc at iteration 77: 0.7644230769230769
	Val acc at iteration 76: 0.6170212765957447
	Train acc at iteration 78: 0.7900641025641025
	Val acc at iteration 77: 0.7659574468085106
	Train acc at iteration 79: 0.7948717948717948
	Val acc at iteration 78: 0.648936170212766
	Train acc at iteration 80: 0.7996794871794872
	Val acc at iteration 79: 0.6382978723404256
	Train acc at iteration 81: 0.7692307692307693
	Val acc at iteration 80: 0.6595744680851063
	Train acc at iteration 82: 0.782051282051282
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7692307692307693
	Val acc at iteration 82: 0.6914893617021277
	Train acc at iteration 84: 0.782051282051282
	Val acc at iteration 83: 0.6808510638297872
	Train acc at iteration 85: 0.7836538461538461
	Val acc at iteration 84: 0.6914893617021277
	Train acc at iteration 86: 0.7788461538461539
	Val acc at iteration 85: 0.5957446808510638
	Train acc at iteration 87: 0.8092948717948718
	Val acc at iteration 86: 0.723404255319149
	Train acc at iteration 88: 0.7772435897435898
	Val acc at iteration 87: 0.6702127659574468
	Train acc at iteration 89: 0.7980769230769231
	Val acc at iteration 88: 0.6170212765957447
	Train acc at iteration 90: 0.7788461538461539
	Val acc at iteration 89: 0.7553191489361702
	Train acc at iteration 91: 0.7996794871794872
	Val acc at iteration 90: 0.6595744680851063
	Train acc at iteration 92: 0.7772435897435898
	Val acc at iteration 91: 0.6702127659574468
	Train acc at iteration 93: 0.8028846153846154
	Val acc at iteration 92: 0.6702127659574468
	Train acc at iteration 94: 0.7660256410256411
	Val acc at iteration 93: 0.648936170212766
	Train acc at iteration 95: 0.7868589743589743
	Val acc at iteration 94: 0.7127659574468085
	Train acc at iteration 96: 0.7788461538461539
	Val acc at iteration 95: 0.6595744680851063
	Train acc at iteration 97: 0.7884615384615384
	Val acc at iteration 96: 0.7553191489361702
	Train acc at iteration 98: 0.7884615384615384
	Val acc at iteration 97: 0.5957446808510638
	Train acc at iteration 99: 0.7900641025641025
	Val acc at iteration 98: 0.7021276595744681
	Train acc at iteration 100: 0.7788461538461539
	Val acc at iteration 99: 0.6276595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5505050505050504
Final val micro accuracy: 0.6595744680851063
Final test macro f1-score: 0.5060931899641578
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6171067357063293
	Separation: 0.5444581508636475
Final test:
	Cluster: 0.6021845638751984
	Separation: 0.5304867923259735
Saved Results

Attempting combination 23/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.01
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3404255319148936
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7340425531914894
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9574468085106383
Push epoch
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Cluster: 0.6361472010612488
	Separation: 0.5175736784934998
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.5638297872340425
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.5851063829787234
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.5851063829787234
	Val acc at iteration 16: 0.6276595744680851
	Val acc at iteration 17: 0.6063829787234043
	Val acc at iteration 18: 0.6276595744680851
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6170212765957447
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.6170212765957447
	Val acc at iteration 23: 0.5851063829787234
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.5851063829787234
	Val acc at iteration 26: 0.6063829787234043
	Val acc at iteration 27: 0.6382978723404256
	Val acc at iteration 28: 0.6276595744680851
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.6276595744680851
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.5957446808510638
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.6063829787234043
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.5957446808510638
	Val acc at iteration 46: 0.6276595744680851
	Val acc at iteration 47: 0.574468085106383
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.5851063829787234
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.6170212765957447
	Val acc at iteration 56: 0.6170212765957447
	Val acc at iteration 57: 0.6063829787234043
	Val acc at iteration 58: 0.6276595744680851
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.5531914893617021
	Val acc at iteration 61: 0.5957446808510638
	Val acc at iteration 62: 0.6382978723404256
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.5851063829787234
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.6063829787234043
	Val acc at iteration 68: 0.6276595744680851
	Val acc at iteration 69: 0.5957446808510638
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.5851063829787234
	Val acc at iteration 73: 0.6276595744680851
	Val acc at iteration 74: 0.6382978723404256
	Val acc at iteration 75: 0.6170212765957447
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.6170212765957447
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.6702127659574468
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.648936170212766
	Val acc at iteration 88: 0.6595744680851063
	Val acc at iteration 89: 0.6276595744680851
	Val acc at iteration 90: 0.723404255319149
	Val acc at iteration 91: 0.6170212765957447
	Val acc at iteration 92: 0.6808510638297872
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.6808510638297872
	Val acc at iteration 95: 0.6063829787234043
	Val acc at iteration 96: 0.648936170212766
	Val acc at iteration 97: 0.6276595744680851
	Val acc at iteration 98: 0.648936170212766
	Val acc at iteration 99: 0.6063829787234043
Val acc before epoch 16: 0.5851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7836538461538461
	Cluster: 0.656021237373352
	Separation: 0.5199435353279114
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.574468085106383
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.5851063829787234
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.5957446808510638
	Val acc at iteration 13: 0.6276595744680851
	Val acc at iteration 14: 0.5851063829787234
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.5851063829787234
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.5957446808510638
	Val acc at iteration 19: 0.6063829787234043
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.5851063829787234
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.6170212765957447
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.5957446808510638
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.6276595744680851
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6063829787234043
	Val acc at iteration 37: 0.5851063829787234
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.6063829787234043
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.6170212765957447
	Val acc at iteration 47: 0.6276595744680851
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.5638297872340425
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.6063829787234043
	Val acc at iteration 54: 0.5851063829787234
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.5851063829787234
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.6063829787234043
	Val acc at iteration 60: 0.574468085106383
	Val acc at iteration 61: 0.6170212765957447
	Val acc at iteration 62: 0.5425531914893617
	Val acc at iteration 63: 0.6382978723404256
	Val acc at iteration 64: 0.6170212765957447
	Val acc at iteration 65: 0.6276595744680851
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.6063829787234043
	Val acc at iteration 69: 0.6170212765957447
	Val acc at iteration 70: 0.6276595744680851
	Val acc at iteration 71: 0.6063829787234043
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.6170212765957447
	Val acc at iteration 78: 0.6382978723404256
	Val acc at iteration 79: 0.5531914893617021
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.5531914893617021
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6063829787234043
	Val acc at iteration 85: 0.6382978723404256
	Val acc at iteration 86: 0.6914893617021277
	Val acc at iteration 87: 0.5638297872340425
	Val acc at iteration 88: 0.5531914893617021
	Val acc at iteration 89: 0.648936170212766
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.7021276595744681
	Val acc at iteration 92: 0.7021276595744681
	Val acc at iteration 93: 0.6063829787234043
	Val acc at iteration 94: 0.6595744680851063
	Val acc at iteration 95: 0.5851063829787234
	Val acc at iteration 96: 0.6170212765957447
	Val acc at iteration 97: 0.5851063829787234
	Val acc at iteration 98: 0.5638297872340425
	Val acc at iteration 99: 0.6808510638297872
Val acc before epoch 26: 0.7446808510638298
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7340425531914894
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8191489361702128
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9361702127659575
Stopping after epoch 36.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7756410256410257
	Cluster: 0.6495811223983765
	Separation: 0.5176537513732911
(After push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7772435897435898
	Val acc at iteration 0: 0.6595744680851063
	Train acc at iteration 2: 0.7644230769230769
	Val acc at iteration 1: 0.6702127659574468
	Train acc at iteration 3: 0.7756410256410257
	Val acc at iteration 2: 0.6702127659574468
	Train acc at iteration 4: 0.7628205128205128
	Val acc at iteration 3: 0.6702127659574468
	Train acc at iteration 5: 0.7676282051282052
	Val acc at iteration 4: 0.6276595744680851
	Train acc at iteration 6: 0.7932692307692307
	Val acc at iteration 5: 0.6382978723404256
	Train acc at iteration 7: 0.7435897435897436
	Val acc at iteration 6: 0.5851063829787234
	Train acc at iteration 8: 0.7660256410256411
	Val acc at iteration 7: 0.5957446808510638
	Train acc at iteration 9: 0.7788461538461539
	Val acc at iteration 8: 0.6808510638297872
	Train acc at iteration 10: 0.7660256410256411
	Val acc at iteration 9: 0.5957446808510638
	Train acc at iteration 11: 0.7660256410256411
	Val acc at iteration 10: 0.648936170212766
	Train acc at iteration 12: 0.7532051282051282
	Val acc at iteration 11: 0.6382978723404256
	Train acc at iteration 13: 0.7644230769230769
	Val acc at iteration 12: 0.6382978723404256
	Train acc at iteration 14: 0.7708333333333334
	Val acc at iteration 13: 0.648936170212766
	Train acc at iteration 15: 0.7756410256410257
	Val acc at iteration 14: 0.6382978723404256
	Train acc at iteration 16: 0.7467948717948718
	Val acc at iteration 15: 0.7446808510638298
	Train acc at iteration 17: 0.7516025641025641
	Val acc at iteration 16: 0.6382978723404256
	Train acc at iteration 18: 0.7580128205128205
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.780448717948718
	Val acc at iteration 18: 0.6382978723404256
	Train acc at iteration 20: 0.7435897435897436
	Val acc at iteration 19: 0.6170212765957447
	Train acc at iteration 21: 0.7756410256410257
	Val acc at iteration 20: 0.723404255319149
	Train acc at iteration 22: 0.7564102564102564
	Val acc at iteration 21: 0.648936170212766
	Train acc at iteration 23: 0.7435897435897436
	Val acc at iteration 22: 0.6595744680851063
	Train acc at iteration 24: 0.7676282051282052
	Val acc at iteration 23: 0.5425531914893617
	Train acc at iteration 25: 0.7548076923076923
	Val acc at iteration 24: 0.6808510638297872
	Train acc at iteration 26: 0.782051282051282
	Val acc at iteration 25: 0.5851063829787234
	Train acc at iteration 27: 0.7884615384615384
	Val acc at iteration 26: 0.6063829787234043
	Train acc at iteration 28: 0.7628205128205128
	Val acc at iteration 27: 0.7127659574468085
	Train acc at iteration 29: 0.7564102564102564
	Val acc at iteration 28: 0.6382978723404256
	Train acc at iteration 30: 0.7564102564102564
	Val acc at iteration 29: 0.7021276595744681
	Train acc at iteration 31: 0.7852564102564102
	Val acc at iteration 30: 0.7446808510638298
	Train acc at iteration 32: 0.782051282051282
	Val acc at iteration 31: 0.6170212765957447
	Train acc at iteration 33: 0.7323717948717948
	Val acc at iteration 32: 0.6382978723404256
	Train acc at iteration 34: 0.7628205128205128
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.7708333333333334
	Val acc at iteration 34: 0.6170212765957447
	Train acc at iteration 36: 0.7564102564102564
	Val acc at iteration 35: 0.6808510638297872
	Train acc at iteration 37: 0.7660256410256411
	Val acc at iteration 36: 0.6702127659574468
	Train acc at iteration 38: 0.7564102564102564
	Val acc at iteration 37: 0.6702127659574468
	Train acc at iteration 39: 0.7660256410256411
	Val acc at iteration 38: 0.648936170212766
	Train acc at iteration 40: 0.7564102564102564
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.7612179487179487
	Val acc at iteration 40: 0.574468085106383
	Train acc at iteration 42: 0.7467948717948718
	Val acc at iteration 41: 0.6170212765957447
	Train acc at iteration 43: 0.7676282051282052
	Val acc at iteration 42: 0.6702127659574468
	Train acc at iteration 44: 0.782051282051282
	Val acc at iteration 43: 0.6595744680851063
	Train acc at iteration 45: 0.7580128205128205
	Val acc at iteration 44: 0.6276595744680851
	Train acc at iteration 46: 0.7596153846153846
	Val acc at iteration 45: 0.5851063829787234
	Train acc at iteration 47: 0.75
	Val acc at iteration 46: 0.6063829787234043
	Train acc at iteration 48: 0.7740384615384616
	Val acc at iteration 47: 0.6702127659574468
	Train acc at iteration 49: 0.7612179487179487
	Val acc at iteration 48: 0.5957446808510638
	Train acc at iteration 50: 0.7724358974358975
	Val acc at iteration 49: 0.648936170212766
	Train acc at iteration 51: 0.7516025641025641
	Val acc at iteration 50: 0.6702127659574468
	Train acc at iteration 52: 0.7756410256410257
	Val acc at iteration 51: 0.6914893617021277
	Train acc at iteration 53: 0.7483974358974359
	Val acc at iteration 52: 0.6808510638297872
	Train acc at iteration 54: 0.7628205128205128
	Val acc at iteration 53: 0.6808510638297872
	Train acc at iteration 55: 0.7596153846153846
	Val acc at iteration 54: 0.7021276595744681
	Train acc at iteration 56: 0.7548076923076923
	Val acc at iteration 55: 0.7127659574468085
	Train acc at iteration 57: 0.7548076923076923
	Val acc at iteration 56: 0.6170212765957447
	Train acc at iteration 58: 0.7884615384615384
	Val acc at iteration 57: 0.5319148936170213
	Train acc at iteration 59: 0.7772435897435898
	Val acc at iteration 58: 0.6276595744680851
	Train acc at iteration 60: 0.7580128205128205
	Val acc at iteration 59: 0.7127659574468085
	Train acc at iteration 61: 0.7564102564102564
	Val acc at iteration 60: 0.6808510638297872
	Train acc at iteration 62: 0.7612179487179487
	Val acc at iteration 61: 0.5957446808510638
	Train acc at iteration 63: 0.7516025641025641
	Val acc at iteration 62: 0.6382978723404256
	Train acc at iteration 64: 0.7628205128205128
	Val acc at iteration 63: 0.6595744680851063
	Train acc at iteration 65: 0.7467948717948718
	Val acc at iteration 64: 0.6595744680851063
	Train acc at iteration 66: 0.7772435897435898
	Val acc at iteration 65: 0.5851063829787234
	Train acc at iteration 67: 0.7580128205128205
	Val acc at iteration 66: 0.6063829787234043
	Train acc at iteration 68: 0.782051282051282
	Val acc at iteration 67: 0.5957446808510638
	Train acc at iteration 69: 0.75
	Val acc at iteration 68: 0.648936170212766
	Train acc at iteration 70: 0.7788461538461539
	Val acc at iteration 69: 0.6808510638297872
	Train acc at iteration 71: 0.7371794871794872
	Val acc at iteration 70: 0.6808510638297872
	Train acc at iteration 72: 0.7868589743589743
	Val acc at iteration 71: 0.6382978723404256
	Train acc at iteration 73: 0.7612179487179487
	Val acc at iteration 72: 0.574468085106383
	Train acc at iteration 74: 0.7852564102564102
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.7916666666666666
	Val acc at iteration 74: 0.7021276595744681
	Train acc at iteration 76: 0.7548076923076923
	Val acc at iteration 75: 0.648936170212766
	Train acc at iteration 77: 0.7467948717948718
	Val acc at iteration 76: 0.6914893617021277
	Train acc at iteration 78: 0.7612179487179487
	Val acc at iteration 77: 0.6595744680851063
	Train acc at iteration 79: 0.7772435897435898
	Val acc at iteration 78: 0.6702127659574468
	Train acc at iteration 80: 0.7419871794871795
	Val acc at iteration 79: 0.6702127659574468
	Train acc at iteration 81: 0.7692307692307693
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.7852564102564102
	Val acc at iteration 81: 0.6808510638297872
	Train acc at iteration 83: 0.7708333333333334
	Val acc at iteration 82: 0.6702127659574468
	Train acc at iteration 84: 0.7724358974358975
	Val acc at iteration 83: 0.6808510638297872
	Train acc at iteration 85: 0.7564102564102564
	Val acc at iteration 84: 0.6702127659574468
	Train acc at iteration 86: 0.7708333333333334
	Val acc at iteration 85: 0.7446808510638298
	Train acc at iteration 87: 0.7724358974358975
	Val acc at iteration 86: 0.6595744680851063
	Train acc at iteration 88: 0.7564102564102564
	Val acc at iteration 87: 0.6276595744680851
	Train acc at iteration 89: 0.7516025641025641
	Val acc at iteration 88: 0.5851063829787234
	Train acc at iteration 90: 0.7628205128205128
	Val acc at iteration 89: 0.6276595744680851
	Train acc at iteration 91: 0.7884615384615384
	Val acc at iteration 90: 0.6276595744680851
	Train acc at iteration 92: 0.7644230769230769
	Val acc at iteration 91: 0.7446808510638298
	Train acc at iteration 93: 0.7628205128205128
	Val acc at iteration 92: 0.6063829787234043
	Train acc at iteration 94: 0.7676282051282052
	Val acc at iteration 93: 0.6595744680851063
	Train acc at iteration 95: 0.7660256410256411
	Val acc at iteration 94: 0.6063829787234043
	Train acc at iteration 96: 0.7676282051282052
	Val acc at iteration 95: 0.6914893617021277
	Train acc at iteration 97: 0.7628205128205128
	Val acc at iteration 96: 0.5851063829787234
	Train acc at iteration 98: 0.7564102564102564
	Val acc at iteration 97: 0.6595744680851063
	Train acc at iteration 99: 0.7884615384615384
	Val acc at iteration 98: 0.5851063829787234
	Train acc at iteration 100: 0.7868589743589743
	Val acc at iteration 99: 0.6702127659574468
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5225694444444445
Final val micro accuracy: 0.6276595744680851
Final test macro f1-score: 0.4474074074074074
Final test micro accuracy: 0.5957446808510638
Final validation:
	Cluster: 0.6218590140342712
	Separation: 0.5481250584125519
Final test:
	Cluster: 0.6091873049736023
	Separation: 0.5394426584243774
Saved Results

Attempting combination 24/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7021276595744681
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Cluster: 0.6507330417633057
	Separation: 0.5199122905731202
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.7872340425531915
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.7127659574468085
	Val acc at iteration 6: 0.648936170212766
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.7446808510638298
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.7659574468085106
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.8085106382978723
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.6170212765957447
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.7446808510638298
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.8297872340425532
	Val acc at iteration 85: 0.7021276595744681
	Val acc at iteration 86: 0.7872340425531915
	Val acc at iteration 87: 0.7553191489361702
	Val acc at iteration 88: 0.7978723404255319
	Val acc at iteration 89: 0.7340425531914894
	Val acc at iteration 90: 0.7127659574468085
	Val acc at iteration 91: 0.7340425531914894
	Val acc at iteration 92: 0.7446808510638298
	Val acc at iteration 93: 0.7446808510638298
	Val acc at iteration 94: 0.7659574468085106
	Val acc at iteration 95: 0.7021276595744681
	Val acc at iteration 96: 0.7553191489361702
	Val acc at iteration 97: 0.6702127659574468
	Val acc at iteration 98: 0.7446808510638298
	Val acc at iteration 99: 0.7127659574468085
Val acc before epoch 16: 0.776595744680851
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Cluster: 0.6527216792106628
	Separation: 0.5261890053749084
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7127659574468085
	Val acc at iteration 1: 0.7340425531914894
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.7659574468085106
	Val acc at iteration 5: 0.776595744680851
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.6170212765957447
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.776595744680851
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7659574468085106
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.7978723404255319
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.776595744680851
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.776595744680851
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.7978723404255319
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.7978723404255319
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.8191489361702128
	Val acc at iteration 41: 0.7978723404255319
	Val acc at iteration 42: 0.7872340425531915
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.7872340425531915
	Val acc at iteration 51: 0.776595744680851
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.7978723404255319
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.7659574468085106
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.7978723404255319
	Val acc at iteration 73: 0.8297872340425532
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.7553191489361702
	Val acc at iteration 85: 0.7659574468085106
	Val acc at iteration 86: 0.7340425531914894
	Val acc at iteration 87: 0.7659574468085106
	Val acc at iteration 88: 0.7127659574468085
	Val acc at iteration 89: 0.723404255319149
	Val acc at iteration 90: 0.7446808510638298
	Val acc at iteration 91: 0.7127659574468085
	Val acc at iteration 92: 0.7446808510638298
	Val acc at iteration 93: 0.7659574468085106
	Val acc at iteration 94: 0.723404255319149
	Val acc at iteration 95: 0.7446808510638298
	Val acc at iteration 96: 0.7340425531914894
	Val acc at iteration 97: 0.7978723404255319
	Val acc at iteration 98: 0.7553191489361702
	Val acc at iteration 99: 0.7127659574468085
Val acc before epoch 26: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9361702127659575
Stopping after epoch 36.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8285256410256411
	Cluster: 0.6459045886993409
	Separation: 0.5150557875633239
(After push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8028846153846154
	Val acc at iteration 0: 0.6702127659574468
	Train acc at iteration 2: 0.7724358974358975
	Val acc at iteration 1: 0.7446808510638298
	Train acc at iteration 3: 0.8269230769230769
	Val acc at iteration 2: 0.776595744680851
	Train acc at iteration 4: 0.8076923076923077
	Val acc at iteration 3: 0.8085106382978723
	Train acc at iteration 5: 0.8237179487179487
	Val acc at iteration 4: 0.7446808510638298
	Train acc at iteration 6: 0.8189102564102564
	Val acc at iteration 5: 0.7553191489361702
	Train acc at iteration 7: 0.7948717948717948
	Val acc at iteration 6: 0.7446808510638298
	Train acc at iteration 8: 0.7868589743589743
	Val acc at iteration 7: 0.6382978723404256
	Train acc at iteration 9: 0.8173076923076923
	Val acc at iteration 8: 0.7340425531914894
	Train acc at iteration 10: 0.7900641025641025
	Val acc at iteration 9: 0.7978723404255319
	Train acc at iteration 11: 0.7948717948717948
	Val acc at iteration 10: 0.7553191489361702
	Train acc at iteration 12: 0.8012820512820513
	Val acc at iteration 11: 0.6595744680851063
	Train acc at iteration 13: 0.8173076923076923
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.7868589743589743
	Val acc at iteration 13: 0.7021276595744681
	Train acc at iteration 15: 0.7996794871794872
	Val acc at iteration 14: 0.6595744680851063
	Train acc at iteration 16: 0.7932692307692307
	Val acc at iteration 15: 0.6595744680851063
	Train acc at iteration 17: 0.8157051282051282
	Val acc at iteration 16: 0.7872340425531915
	Train acc at iteration 18: 0.8173076923076923
	Val acc at iteration 17: 0.7340425531914894
	Train acc at iteration 19: 0.8221153846153846
	Val acc at iteration 18: 0.7446808510638298
	Train acc at iteration 20: 0.8028846153846154
	Val acc at iteration 19: 0.7553191489361702
	Train acc at iteration 21: 0.780448717948718
	Val acc at iteration 20: 0.7340425531914894
	Train acc at iteration 22: 0.8253205128205128
	Val acc at iteration 21: 0.7553191489361702
	Train acc at iteration 23: 0.8269230769230769
	Val acc at iteration 22: 0.776595744680851
	Train acc at iteration 24: 0.7980769230769231
	Val acc at iteration 23: 0.723404255319149
	Train acc at iteration 25: 0.7900641025641025
	Val acc at iteration 24: 0.6808510638297872
	Train acc at iteration 26: 0.8141025641025641
	Val acc at iteration 25: 0.6702127659574468
	Train acc at iteration 27: 0.8205128205128205
	Val acc at iteration 26: 0.7340425531914894
	Train acc at iteration 28: 0.7996794871794872
	Val acc at iteration 27: 0.7978723404255319
	Train acc at iteration 29: 0.7964743589743589
	Val acc at iteration 28: 0.7021276595744681
	Train acc at iteration 30: 0.8012820512820513
	Val acc at iteration 29: 0.6702127659574468
	Train acc at iteration 31: 0.8157051282051282
	Val acc at iteration 30: 0.776595744680851
	Train acc at iteration 32: 0.8141025641025641
	Val acc at iteration 31: 0.7553191489361702
	Train acc at iteration 33: 0.8044871794871795
	Val acc at iteration 32: 0.6702127659574468
	Train acc at iteration 34: 0.844551282051282
	Val acc at iteration 33: 0.723404255319149
	Train acc at iteration 35: 0.8076923076923077
	Val acc at iteration 34: 0.7553191489361702
	Train acc at iteration 36: 0.8141025641025641
	Val acc at iteration 35: 0.8404255319148937
	Train acc at iteration 37: 0.8173076923076923
	Val acc at iteration 36: 0.776595744680851
	Train acc at iteration 38: 0.8157051282051282
	Val acc at iteration 37: 0.7446808510638298
	Train acc at iteration 39: 0.8189102564102564
	Val acc at iteration 38: 0.6808510638297872
	Train acc at iteration 40: 0.8108974358974359
	Val acc at iteration 39: 0.7553191489361702
	Train acc at iteration 41: 0.8108974358974359
	Val acc at iteration 40: 0.7446808510638298
	Train acc at iteration 42: 0.8189102564102564
	Val acc at iteration 41: 0.8191489361702128
	Train acc at iteration 43: 0.7836538461538461
	Val acc at iteration 42: 0.723404255319149
	Train acc at iteration 44: 0.7964743589743589
	Val acc at iteration 43: 0.7978723404255319
	Train acc at iteration 45: 0.8269230769230769
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.8237179487179487
	Val acc at iteration 45: 0.7127659574468085
	Train acc at iteration 47: 0.8125
	Val acc at iteration 46: 0.6914893617021277
	Train acc at iteration 48: 0.8253205128205128
	Val acc at iteration 47: 0.8085106382978723
	Train acc at iteration 49: 0.7916666666666666
	Val acc at iteration 48: 0.6808510638297872
	Train acc at iteration 50: 0.7932692307692307
	Val acc at iteration 49: 0.7021276595744681
	Train acc at iteration 51: 0.8253205128205128
	Val acc at iteration 50: 0.7340425531914894
	Train acc at iteration 52: 0.8381410256410257
	Val acc at iteration 51: 0.7659574468085106
	Train acc at iteration 53: 0.8012820512820513
	Val acc at iteration 52: 0.7553191489361702
	Train acc at iteration 54: 0.8461538461538461
	Val acc at iteration 53: 0.6595744680851063
	Train acc at iteration 55: 0.8317307692307693
	Val acc at iteration 54: 0.7659574468085106
	Train acc at iteration 56: 0.8060897435897436
	Val acc at iteration 55: 0.7978723404255319
	Train acc at iteration 57: 0.8060897435897436
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.8237179487179487
	Val acc at iteration 57: 0.7446808510638298
	Train acc at iteration 59: 0.7996794871794872
	Val acc at iteration 58: 0.7978723404255319
	Train acc at iteration 60: 0.7980769230769231
	Val acc at iteration 59: 0.723404255319149
	Train acc at iteration 61: 0.7996794871794872
	Val acc at iteration 60: 0.6595744680851063
	Train acc at iteration 62: 0.8205128205128205
	Val acc at iteration 61: 0.6808510638297872
	Train acc at iteration 63: 0.8221153846153846
	Val acc at iteration 62: 0.7659574468085106
	Train acc at iteration 64: 0.8205128205128205
	Val acc at iteration 63: 0.723404255319149
	Train acc at iteration 65: 0.8285256410256411
	Val acc at iteration 64: 0.7659574468085106
	Train acc at iteration 66: 0.8205128205128205
	Val acc at iteration 65: 0.7340425531914894
	Train acc at iteration 67: 0.7868589743589743
	Val acc at iteration 66: 0.7553191489361702
	Train acc at iteration 68: 0.7884615384615384
	Val acc at iteration 67: 0.7340425531914894
	Train acc at iteration 69: 0.8173076923076923
	Val acc at iteration 68: 0.7978723404255319
	Train acc at iteration 70: 0.8301282051282052
	Val acc at iteration 69: 0.7872340425531915
	Train acc at iteration 71: 0.8221153846153846
	Val acc at iteration 70: 0.723404255319149
	Train acc at iteration 72: 0.8125
	Val acc at iteration 71: 0.723404255319149
	Train acc at iteration 73: 0.7916666666666666
	Val acc at iteration 72: 0.7553191489361702
	Train acc at iteration 74: 0.8189102564102564
	Val acc at iteration 73: 0.7872340425531915
	Train acc at iteration 75: 0.7932692307692307
	Val acc at iteration 74: 0.7553191489361702
	Train acc at iteration 76: 0.8157051282051282
	Val acc at iteration 75: 0.723404255319149
	Train acc at iteration 77: 0.7996794871794872
	Val acc at iteration 76: 0.7659574468085106
	Train acc at iteration 78: 0.8125
	Val acc at iteration 77: 0.7659574468085106
	Train acc at iteration 79: 0.8221153846153846
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.8525641025641025
	Val acc at iteration 79: 0.7446808510638298
	Train acc at iteration 81: 0.8141025641025641
	Val acc at iteration 80: 0.7553191489361702
	Train acc at iteration 82: 0.7948717948717948
	Val acc at iteration 81: 0.7021276595744681
	Train acc at iteration 83: 0.8205128205128205
	Val acc at iteration 82: 0.7872340425531915
	Train acc at iteration 84: 0.8125
	Val acc at iteration 83: 0.7340425531914894
	Train acc at iteration 85: 0.7900641025641025
	Val acc at iteration 84: 0.7021276595744681
	Train acc at iteration 86: 0.8028846153846154
	Val acc at iteration 85: 0.7553191489361702
	Train acc at iteration 87: 0.8189102564102564
	Val acc at iteration 86: 0.7127659574468085
	Train acc at iteration 88: 0.8076923076923077
	Val acc at iteration 87: 0.776595744680851
	Train acc at iteration 89: 0.7964743589743589
	Val acc at iteration 88: 0.7553191489361702
	Train acc at iteration 90: 0.8317307692307693
	Val acc at iteration 89: 0.776595744680851
	Train acc at iteration 91: 0.8125
	Val acc at iteration 90: 0.8191489361702128
	Train acc at iteration 92: 0.8173076923076923
	Val acc at iteration 91: 0.7872340425531915
	Train acc at iteration 93: 0.8317307692307693
	Val acc at iteration 92: 0.7872340425531915
	Train acc at iteration 94: 0.8108974358974359
	Val acc at iteration 93: 0.6595744680851063
	Train acc at iteration 95: 0.8301282051282052
	Val acc at iteration 94: 0.723404255319149
	Train acc at iteration 96: 0.8173076923076923
	Val acc at iteration 95: 0.6702127659574468
	Train acc at iteration 97: 0.8173076923076923
	Val acc at iteration 96: 0.6382978723404256
	Train acc at iteration 98: 0.8493589743589743
	Val acc at iteration 97: 0.776595744680851
	Train acc at iteration 99: 0.8269230769230769
	Val acc at iteration 98: 0.7127659574468085
	Train acc at iteration 100: 0.8092948717948718
	Val acc at iteration 99: 0.7553191489361702
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6613475177304964
Final val micro accuracy: 0.7446808510638298
Final test macro f1-score: 0.5347985347985349
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.634820431470871
	Separation: 0.547235518693924
Final test:
	Cluster: 0.597906082868576
	Separation: 0.5329932868480682
Saved Results

Attempting combination 25/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 0.24
l1_weight: 10
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3617021276595745
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7340425531914894
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.7659574468085106
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Cluster: 0.6605865001678467
	Separation: 0.5285466313362122
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.5851063829787234
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.5638297872340425
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.7446808510638298
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.6170212765957447
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.6595744680851063
	Val acc at iteration 43: 0.6063829787234043
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.6276595744680851
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.6382978723404256
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.6276595744680851
	Val acc at iteration 55: 0.7872340425531915
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.6276595744680851
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.6063829787234043
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.6170212765957447
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.6170212765957447
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.6382978723404256
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.7659574468085106
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.5957446808510638
	Val acc at iteration 88: 0.6170212765957447
	Val acc at iteration 89: 0.6702127659574468
	Val acc at iteration 90: 0.6808510638297872
	Val acc at iteration 91: 0.7021276595744681
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.723404255319149
	Val acc at iteration 94: 0.648936170212766
	Val acc at iteration 95: 0.6170212765957447
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.6276595744680851
	Val acc at iteration 98: 0.6914893617021277
	Val acc at iteration 99: 0.648936170212766
Val acc before epoch 16: 0.7021276595744681
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8044871794871795
	Cluster: 0.6498704433441163
	Separation: 0.520076584815979
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.6914893617021277
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.5851063829787234
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.6276595744680851
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.7872340425531915
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6595744680851063
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.6170212765957447
	Val acc at iteration 31: 0.6382978723404256
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6063829787234043
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.5957446808510638
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.648936170212766
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7446808510638298
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.5957446808510638
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.6382978723404256
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.5851063829787234
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.7127659574468085
	Val acc at iteration 87: 0.648936170212766
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.6914893617021277
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.7021276595744681
	Val acc at iteration 92: 0.7340425531914894
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.7127659574468085
	Val acc at iteration 95: 0.6382978723404256
	Val acc at iteration 96: 0.7446808510638298
	Val acc at iteration 97: 0.648936170212766
	Val acc at iteration 98: 0.6382978723404256
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 26: 0.6702127659574468
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7659574468085106
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9148936170212766
Stopping after epoch 36.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7644230769230769
	Cluster: 0.644810426235199
	Separation: 0.518573772907257
(After push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7836538461538461
	Val acc at iteration 0: 0.6595744680851063
	Train acc at iteration 2: 0.8012820512820513
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.7740384615384616
	Val acc at iteration 2: 0.776595744680851
	Train acc at iteration 4: 0.7772435897435898
	Val acc at iteration 3: 0.6595744680851063
	Train acc at iteration 5: 0.7932692307692307
	Val acc at iteration 4: 0.6382978723404256
	Train acc at iteration 6: 0.7932692307692307
	Val acc at iteration 5: 0.6382978723404256
	Train acc at iteration 7: 0.7868589743589743
	Val acc at iteration 6: 0.6702127659574468
	Train acc at iteration 8: 0.7532051282051282
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.7884615384615384
	Val acc at iteration 8: 0.6382978723404256
	Train acc at iteration 10: 0.7884615384615384
	Val acc at iteration 9: 0.6276595744680851
	Train acc at iteration 11: 0.782051282051282
	Val acc at iteration 10: 0.6276595744680851
	Train acc at iteration 12: 0.7788461538461539
	Val acc at iteration 11: 0.7127659574468085
	Train acc at iteration 13: 0.782051282051282
	Val acc at iteration 12: 0.7021276595744681
	Train acc at iteration 14: 0.8028846153846154
	Val acc at iteration 13: 0.5957446808510638
	Train acc at iteration 15: 0.7740384615384616
	Val acc at iteration 14: 0.6382978723404256
	Train acc at iteration 16: 0.7948717948717948
	Val acc at iteration 15: 0.6382978723404256
	Train acc at iteration 17: 0.8028846153846154
	Val acc at iteration 16: 0.648936170212766
	Train acc at iteration 18: 0.8044871794871795
	Val acc at iteration 17: 0.7021276595744681
	Train acc at iteration 19: 0.7980769230769231
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.7788461538461539
	Val acc at iteration 19: 0.6382978723404256
	Train acc at iteration 21: 0.782051282051282
	Val acc at iteration 20: 0.6808510638297872
	Train acc at iteration 22: 0.8076923076923077
	Val acc at iteration 21: 0.6276595744680851
	Train acc at iteration 23: 0.7788461538461539
	Val acc at iteration 22: 0.6702127659574468
	Train acc at iteration 24: 0.7692307692307693
	Val acc at iteration 23: 0.6702127659574468
	Train acc at iteration 25: 0.7948717948717948
	Val acc at iteration 24: 0.6808510638297872
	Train acc at iteration 26: 0.7708333333333334
	Val acc at iteration 25: 0.6595744680851063
	Train acc at iteration 27: 0.7868589743589743
	Val acc at iteration 26: 0.648936170212766
	Train acc at iteration 28: 0.8125
	Val acc at iteration 27: 0.6595744680851063
	Train acc at iteration 29: 0.8028846153846154
	Val acc at iteration 28: 0.6702127659574468
	Train acc at iteration 30: 0.7788461538461539
	Val acc at iteration 29: 0.6808510638297872
	Train acc at iteration 31: 0.7916666666666666
	Val acc at iteration 30: 0.6702127659574468
	Train acc at iteration 32: 0.7948717948717948
	Val acc at iteration 31: 0.7021276595744681
	Train acc at iteration 33: 0.7964743589743589
	Val acc at iteration 32: 0.6382978723404256
	Train acc at iteration 34: 0.7868589743589743
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.8108974358974359
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.8012820512820513
	Val acc at iteration 35: 0.6170212765957447
	Train acc at iteration 37: 0.780448717948718
	Val acc at iteration 36: 0.6808510638297872
	Train acc at iteration 38: 0.780448717948718
	Val acc at iteration 37: 0.7021276595744681
	Train acc at iteration 39: 0.780448717948718
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.7836538461538461
	Val acc at iteration 39: 0.7127659574468085
	Train acc at iteration 41: 0.8012820512820513
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.8108974358974359
	Val acc at iteration 41: 0.6914893617021277
	Train acc at iteration 43: 0.7740384615384616
	Val acc at iteration 42: 0.6808510638297872
	Train acc at iteration 44: 0.7724358974358975
	Val acc at iteration 43: 0.648936170212766
	Train acc at iteration 45: 0.7772435897435898
	Val acc at iteration 44: 0.6914893617021277
	Train acc at iteration 46: 0.7644230769230769
	Val acc at iteration 45: 0.7446808510638298
	Train acc at iteration 47: 0.7532051282051282
	Val acc at iteration 46: 0.6808510638297872
	Train acc at iteration 48: 0.8076923076923077
	Val acc at iteration 47: 0.6914893617021277
	Train acc at iteration 49: 0.782051282051282
	Val acc at iteration 48: 0.6276595744680851
	Train acc at iteration 50: 0.8076923076923077
	Val acc at iteration 49: 0.7021276595744681
	Train acc at iteration 51: 0.8076923076923077
	Val acc at iteration 50: 0.723404255319149
	Train acc at iteration 52: 0.7836538461538461
	Val acc at iteration 51: 0.6702127659574468
	Train acc at iteration 53: 0.7692307692307693
	Val acc at iteration 52: 0.7446808510638298
	Train acc at iteration 54: 0.7788461538461539
	Val acc at iteration 53: 0.6063829787234043
	Train acc at iteration 55: 0.7932692307692307
	Val acc at iteration 54: 0.5425531914893617
	Train acc at iteration 56: 0.8076923076923077
	Val acc at iteration 55: 0.7021276595744681
	Train acc at iteration 57: 0.7740384615384616
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.7884615384615384
	Val acc at iteration 57: 0.6595744680851063
	Train acc at iteration 59: 0.8221153846153846
	Val acc at iteration 58: 0.648936170212766
	Train acc at iteration 60: 0.7660256410256411
	Val acc at iteration 59: 0.7021276595744681
	Train acc at iteration 61: 0.7964743589743589
	Val acc at iteration 60: 0.6914893617021277
	Train acc at iteration 62: 0.7564102564102564
	Val acc at iteration 61: 0.648936170212766
	Train acc at iteration 63: 0.7932692307692307
	Val acc at iteration 62: 0.7659574468085106
	Train acc at iteration 64: 0.8060897435897436
	Val acc at iteration 63: 0.6914893617021277
	Train acc at iteration 65: 0.7916666666666666
	Val acc at iteration 64: 0.6702127659574468
	Train acc at iteration 66: 0.8044871794871795
	Val acc at iteration 65: 0.6702127659574468
	Train acc at iteration 67: 0.7788461538461539
	Val acc at iteration 66: 0.6382978723404256
	Train acc at iteration 68: 0.7884615384615384
	Val acc at iteration 67: 0.6808510638297872
	Train acc at iteration 69: 0.7676282051282052
	Val acc at iteration 68: 0.6702127659574468
	Train acc at iteration 70: 0.7996794871794872
	Val acc at iteration 69: 0.7021276595744681
	Train acc at iteration 71: 0.7900641025641025
	Val acc at iteration 70: 0.6595744680851063
	Train acc at iteration 72: 0.7916666666666666
	Val acc at iteration 71: 0.7340425531914894
	Train acc at iteration 73: 0.7836538461538461
	Val acc at iteration 72: 0.6595744680851063
	Train acc at iteration 74: 0.8012820512820513
	Val acc at iteration 73: 0.6595744680851063
	Train acc at iteration 75: 0.7916666666666666
	Val acc at iteration 74: 0.723404255319149
	Train acc at iteration 76: 0.7676282051282052
	Val acc at iteration 75: 0.723404255319149
	Train acc at iteration 77: 0.7852564102564102
	Val acc at iteration 76: 0.8085106382978723
	Train acc at iteration 78: 0.7612179487179487
	Val acc at iteration 77: 0.6808510638297872
	Train acc at iteration 79: 0.7852564102564102
	Val acc at iteration 78: 0.723404255319149
	Train acc at iteration 80: 0.8157051282051282
	Val acc at iteration 79: 0.7340425531914894
	Train acc at iteration 81: 0.7948717948717948
	Val acc at iteration 80: 0.6170212765957447
	Train acc at iteration 82: 0.7836538461538461
	Val acc at iteration 81: 0.648936170212766
	Train acc at iteration 83: 0.7932692307692307
	Val acc at iteration 82: 0.5851063829787234
	Train acc at iteration 84: 0.7756410256410257
	Val acc at iteration 83: 0.6914893617021277
	Train acc at iteration 85: 0.780448717948718
	Val acc at iteration 84: 0.6702127659574468
	Train acc at iteration 86: 0.7916666666666666
	Val acc at iteration 85: 0.6808510638297872
	Train acc at iteration 87: 0.7948717948717948
	Val acc at iteration 86: 0.6170212765957447
	Train acc at iteration 88: 0.7788461538461539
	Val acc at iteration 87: 0.7021276595744681
	Train acc at iteration 89: 0.7996794871794872
	Val acc at iteration 88: 0.6382978723404256
	Train acc at iteration 90: 0.7612179487179487
	Val acc at iteration 89: 0.6595744680851063
	Train acc at iteration 91: 0.7692307692307693
	Val acc at iteration 90: 0.776595744680851
	Train acc at iteration 92: 0.7788461538461539
	Val acc at iteration 91: 0.6702127659574468
	Train acc at iteration 93: 0.7964743589743589
	Val acc at iteration 92: 0.6914893617021277
	Train acc at iteration 94: 0.7740384615384616
	Val acc at iteration 93: 0.6808510638297872
	Train acc at iteration 95: 0.7900641025641025
	Val acc at iteration 94: 0.7127659574468085
	Train acc at iteration 96: 0.7564102564102564
	Val acc at iteration 95: 0.6595744680851063
	Train acc at iteration 97: 0.7932692307692307
	Val acc at iteration 96: 0.7127659574468085
	Train acc at iteration 98: 0.7756410256410257
	Val acc at iteration 97: 0.723404255319149
	Train acc at iteration 99: 0.7932692307692307
	Val acc at iteration 98: 0.6382978723404256
	Train acc at iteration 100: 0.7964743589743589
	Val acc at iteration 99: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5746527777777778
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.4282051282051281
Final test micro accuracy: 0.5531914893617021
Final validation:
	Cluster: 0.6276372969150543
	Separation: 0.5402889847755432
Final test:
	Cluster: 0.6048606038093567
	Separation: 0.5448861718177795
Saved Results

Attempting combination 26/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 0.24
l1_weight: 1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3404255319148936
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.48936170212765956
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6595744680851063
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8108974358974359
	Cluster: 0.648961353302002
	Separation: 0.5155569195747376
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.6276595744680851
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.5957446808510638
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.5851063829787234
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.6170212765957447
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6276595744680851
	Val acc at iteration 45: 0.5851063829787234
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.6170212765957447
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.6276595744680851
	Val acc at iteration 85: 0.723404255319149
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.7553191489361702
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.7127659574468085
	Val acc at iteration 90: 0.7340425531914894
	Val acc at iteration 91: 0.6595744680851063
	Val acc at iteration 92: 0.723404255319149
	Val acc at iteration 93: 0.648936170212766
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.7978723404255319
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.6702127659574468
	Val acc at iteration 98: 0.6914893617021277
	Val acc at iteration 99: 0.6914893617021277
Val acc before epoch 16: 0.7340425531914894
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.8237179487179487
	Cluster: 0.6500322222709656
	Separation: 0.519262945652008
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.6063829787234043
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.776595744680851
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6170212765957447
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.6276595744680851
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6170212765957447
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.6170212765957447
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7553191489361702
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.574468085106383
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6170212765957447
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.6170212765957447
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.6276595744680851
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.6276595744680851
	Val acc at iteration 72: 0.6276595744680851
	Val acc at iteration 73: 0.6063829787234043
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.5638297872340425
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.6702127659574468
	Val acc at iteration 85: 0.6382978723404256
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.7021276595744681
	Val acc at iteration 88: 0.7021276595744681
	Val acc at iteration 89: 0.6170212765957447
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.6276595744680851
	Val acc at iteration 92: 0.723404255319149
	Val acc at iteration 93: 0.7127659574468085
	Val acc at iteration 94: 0.6595744680851063
	Val acc at iteration 95: 0.6276595744680851
	Val acc at iteration 96: 0.6595744680851063
	Val acc at iteration 97: 0.7127659574468085
	Val acc at iteration 98: 0.5851063829787234
	Val acc at iteration 99: 0.6063829787234043
Val acc before epoch 26: 0.6808510638297872
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7446808510638298
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.851063829787234
Stopping after epoch 36.
Final validation accuracy before push: 85.1063829787234%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8044871794871795
	Cluster: 0.641938042640686
	Separation: 0.5189079880714417
(After push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7948717948717948
	Val acc at iteration 0: 0.723404255319149
	Train acc at iteration 2: 0.7916666666666666
	Val acc at iteration 1: 0.6382978723404256
	Train acc at iteration 3: 0.7868589743589743
	Val acc at iteration 2: 0.6276595744680851
	Train acc at iteration 4: 0.7964743589743589
	Val acc at iteration 3: 0.6808510638297872
	Train acc at iteration 5: 0.7932692307692307
	Val acc at iteration 4: 0.648936170212766
	Train acc at iteration 6: 0.7884615384615384
	Val acc at iteration 5: 0.648936170212766
	Train acc at iteration 7: 0.8060897435897436
	Val acc at iteration 6: 0.723404255319149
	Train acc at iteration 8: 0.7836538461538461
	Val acc at iteration 7: 0.6808510638297872
	Train acc at iteration 9: 0.7980769230769231
	Val acc at iteration 8: 0.7021276595744681
	Train acc at iteration 10: 0.7692307692307693
	Val acc at iteration 9: 0.6914893617021277
	Train acc at iteration 11: 0.7996794871794872
	Val acc at iteration 10: 0.7446808510638298
	Train acc at iteration 12: 0.7772435897435898
	Val acc at iteration 11: 0.6595744680851063
	Train acc at iteration 13: 0.8044871794871795
	Val acc at iteration 12: 0.6170212765957447
	Train acc at iteration 14: 0.7964743589743589
	Val acc at iteration 13: 0.6595744680851063
	Train acc at iteration 15: 0.8060897435897436
	Val acc at iteration 14: 0.7446808510638298
	Train acc at iteration 16: 0.7980769230769231
	Val acc at iteration 15: 0.6382978723404256
	Train acc at iteration 17: 0.8157051282051282
	Val acc at iteration 16: 0.6808510638297872
	Train acc at iteration 18: 0.8044871794871795
	Val acc at iteration 17: 0.6808510638297872
	Train acc at iteration 19: 0.7884615384615384
	Val acc at iteration 18: 0.6595744680851063
	Train acc at iteration 20: 0.8012820512820513
	Val acc at iteration 19: 0.6595744680851063
	Train acc at iteration 21: 0.8141025641025641
	Val acc at iteration 20: 0.5319148936170213
	Train acc at iteration 22: 0.7964743589743589
	Val acc at iteration 21: 0.7553191489361702
	Train acc at iteration 23: 0.8092948717948718
	Val acc at iteration 22: 0.7021276595744681
	Train acc at iteration 24: 0.8076923076923077
	Val acc at iteration 23: 0.6702127659574468
	Train acc at iteration 25: 0.8012820512820513
	Val acc at iteration 24: 0.648936170212766
	Train acc at iteration 26: 0.8028846153846154
	Val acc at iteration 25: 0.723404255319149
	Train acc at iteration 27: 0.8076923076923077
	Val acc at iteration 26: 0.7340425531914894
	Train acc at iteration 28: 0.7980769230769231
	Val acc at iteration 27: 0.6808510638297872
	Train acc at iteration 29: 0.7964743589743589
	Val acc at iteration 28: 0.6702127659574468
	Train acc at iteration 30: 0.7884615384615384
	Val acc at iteration 29: 0.7021276595744681
	Train acc at iteration 31: 0.7916666666666666
	Val acc at iteration 30: 0.7553191489361702
	Train acc at iteration 32: 0.8028846153846154
	Val acc at iteration 31: 0.6914893617021277
	Train acc at iteration 33: 0.7964743589743589
	Val acc at iteration 32: 0.7021276595744681
	Train acc at iteration 34: 0.8108974358974359
	Val acc at iteration 33: 0.6914893617021277
	Train acc at iteration 35: 0.8125
	Val acc at iteration 34: 0.723404255319149
	Train acc at iteration 36: 0.7852564102564102
	Val acc at iteration 35: 0.6914893617021277
	Train acc at iteration 37: 0.7532051282051282
	Val acc at iteration 36: 0.7127659574468085
	Train acc at iteration 38: 0.8092948717948718
	Val acc at iteration 37: 0.648936170212766
	Train acc at iteration 39: 0.7932692307692307
	Val acc at iteration 38: 0.6808510638297872
	Train acc at iteration 40: 0.7980769230769231
	Val acc at iteration 39: 0.6595744680851063
	Train acc at iteration 41: 0.8012820512820513
	Val acc at iteration 40: 0.6808510638297872
	Train acc at iteration 42: 0.7980769230769231
	Val acc at iteration 41: 0.7021276595744681
	Train acc at iteration 43: 0.7884615384615384
	Val acc at iteration 42: 0.7021276595744681
	Train acc at iteration 44: 0.8076923076923077
	Val acc at iteration 43: 0.7553191489361702
	Train acc at iteration 45: 0.7980769230769231
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.8076923076923077
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.8044871794871795
	Val acc at iteration 46: 0.6595744680851063
	Train acc at iteration 48: 0.8028846153846154
	Val acc at iteration 47: 0.6170212765957447
	Train acc at iteration 49: 0.782051282051282
	Val acc at iteration 48: 0.5957446808510638
	Train acc at iteration 50: 0.780448717948718
	Val acc at iteration 49: 0.6382978723404256
	Train acc at iteration 51: 0.7884615384615384
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.8044871794871795
	Val acc at iteration 51: 0.6808510638297872
	Train acc at iteration 53: 0.8012820512820513
	Val acc at iteration 52: 0.6063829787234043
	Train acc at iteration 54: 0.7692307692307693
	Val acc at iteration 53: 0.7021276595744681
	Train acc at iteration 55: 0.7836538461538461
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.7868589743589743
	Val acc at iteration 55: 0.7021276595744681
	Train acc at iteration 57: 0.7868589743589743
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.7836538461538461
	Val acc at iteration 57: 0.6382978723404256
	Train acc at iteration 59: 0.8044871794871795
	Val acc at iteration 58: 0.6276595744680851
	Train acc at iteration 60: 0.8349358974358975
	Val acc at iteration 59: 0.6170212765957447
	Train acc at iteration 61: 0.7996794871794872
	Val acc at iteration 60: 0.6808510638297872
	Train acc at iteration 62: 0.7868589743589743
	Val acc at iteration 61: 0.723404255319149
	Train acc at iteration 63: 0.7836538461538461
	Val acc at iteration 62: 0.6702127659574468
	Train acc at iteration 64: 0.7612179487179487
	Val acc at iteration 63: 0.7021276595744681
	Train acc at iteration 65: 0.8157051282051282
	Val acc at iteration 64: 0.723404255319149
	Train acc at iteration 66: 0.7884615384615384
	Val acc at iteration 65: 0.7127659574468085
	Train acc at iteration 67: 0.8092948717948718
	Val acc at iteration 66: 0.7553191489361702
	Train acc at iteration 68: 0.7596153846153846
	Val acc at iteration 67: 0.6808510638297872
	Train acc at iteration 69: 0.7836538461538461
	Val acc at iteration 68: 0.6595744680851063
	Train acc at iteration 70: 0.7980769230769231
	Val acc at iteration 69: 0.648936170212766
	Train acc at iteration 71: 0.7852564102564102
	Val acc at iteration 70: 0.6063829787234043
	Train acc at iteration 72: 0.7692307692307693
	Val acc at iteration 71: 0.7340425531914894
	Train acc at iteration 73: 0.7708333333333334
	Val acc at iteration 72: 0.6595744680851063
	Train acc at iteration 74: 0.7788461538461539
	Val acc at iteration 73: 0.6276595744680851
	Train acc at iteration 75: 0.8092948717948718
	Val acc at iteration 74: 0.6702127659574468
	Train acc at iteration 76: 0.782051282051282
	Val acc at iteration 75: 0.6914893617021277
	Train acc at iteration 77: 0.7932692307692307
	Val acc at iteration 76: 0.6382978723404256
	Train acc at iteration 78: 0.782051282051282
	Val acc at iteration 77: 0.7340425531914894
	Train acc at iteration 79: 0.8125
	Val acc at iteration 78: 0.6702127659574468
	Train acc at iteration 80: 0.7788461538461539
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.7708333333333334
	Val acc at iteration 80: 0.6914893617021277
	Train acc at iteration 82: 0.7868589743589743
	Val acc at iteration 81: 0.7340425531914894
	Train acc at iteration 83: 0.7868589743589743
	Val acc at iteration 82: 0.6595744680851063
	Train acc at iteration 84: 0.7852564102564102
	Val acc at iteration 83: 0.6914893617021277
	Train acc at iteration 85: 0.7772435897435898
	Val acc at iteration 84: 0.6702127659574468
	Train acc at iteration 86: 0.8044871794871795
	Val acc at iteration 85: 0.6170212765957447
	Train acc at iteration 87: 0.7916666666666666
	Val acc at iteration 86: 0.648936170212766
	Train acc at iteration 88: 0.8028846153846154
	Val acc at iteration 87: 0.648936170212766
	Train acc at iteration 89: 0.7852564102564102
	Val acc at iteration 88: 0.7127659574468085
	Train acc at iteration 90: 0.7756410256410257
	Val acc at iteration 89: 0.6595744680851063
	Train acc at iteration 91: 0.7836538461538461
	Val acc at iteration 90: 0.6063829787234043
	Train acc at iteration 92: 0.7932692307692307
	Val acc at iteration 91: 0.7127659574468085
	Train acc at iteration 93: 0.7852564102564102
	Val acc at iteration 92: 0.6595744680851063
	Train acc at iteration 94: 0.8076923076923077
	Val acc at iteration 93: 0.7021276595744681
	Train acc at iteration 95: 0.7564102564102564
	Val acc at iteration 94: 0.7127659574468085
	Train acc at iteration 96: 0.8044871794871795
	Val acc at iteration 95: 0.6808510638297872
	Train acc at iteration 97: 0.8060897435897436
	Val acc at iteration 96: 0.6170212765957447
	Train acc at iteration 98: 0.8076923076923077
	Val acc at iteration 97: 0.776595744680851
	Train acc at iteration 99: 0.7900641025641025
	Val acc at iteration 98: 0.723404255319149
	Train acc at iteration 100: 0.780448717948718
	Val acc at iteration 99: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5584192439862543
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.47246376811594204
Final test micro accuracy: 0.6170212765957447
Final validation:
	Cluster: 0.6255658566951752
	Separation: 0.5317580997943878
Final test:
	Cluster: 0.6040360629558563
	Separation: 0.5290893316268921
Saved Results

Attempting combination 27/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 0.24
l1_weight: 0.1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.2765957446808511
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6914893617021277
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7446808510638298
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Cluster: 0.6518659710884094
	Separation: 0.5215722799301148
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.5851063829787234
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.5957446808510638
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.5851063829787234
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.776595744680851
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.5957446808510638
	Val acc at iteration 24: 0.6276595744680851
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.6276595744680851
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.6170212765957447
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.6170212765957447
	Val acc at iteration 47: 0.5638297872340425
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.6382978723404256
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.6276595744680851
	Val acc at iteration 66: 0.6063829787234043
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6170212765957447
	Val acc at iteration 71: 0.6382978723404256
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.6276595744680851
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.6276595744680851
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.648936170212766
	Val acc at iteration 85: 0.6914893617021277
	Val acc at iteration 86: 0.7127659574468085
	Val acc at iteration 87: 0.723404255319149
	Val acc at iteration 88: 0.7021276595744681
	Val acc at iteration 89: 0.6382978723404256
	Val acc at iteration 90: 0.6808510638297872
	Val acc at iteration 91: 0.6276595744680851
	Val acc at iteration 92: 0.7021276595744681
	Val acc at iteration 93: 0.7127659574468085
	Val acc at iteration 94: 0.648936170212766
	Val acc at iteration 95: 0.5957446808510638
	Val acc at iteration 96: 0.648936170212766
	Val acc at iteration 97: 0.648936170212766
	Val acc at iteration 98: 0.7127659574468085
	Val acc at iteration 99: 0.7127659574468085
Val acc before epoch 16: 0.6914893617021277
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7612179487179487
	Cluster: 0.6363733410835266
	Separation: 0.518422532081604
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.6170212765957447
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.6170212765957447
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.7659574468085106
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6063829787234043
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.6170212765957447
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.776595744680851
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.7553191489361702
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.6170212765957447
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.6382978723404256
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.5957446808510638
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.5957446808510638
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.5957446808510638
	Val acc at iteration 46: 0.5957446808510638
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.648936170212766
	Val acc at iteration 61: 0.6382978723404256
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6382978723404256
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.6595744680851063
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.5531914893617021
	Val acc at iteration 72: 0.6276595744680851
	Val acc at iteration 73: 0.6276595744680851
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.6382978723404256
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.574468085106383
	Val acc at iteration 84: 0.5957446808510638
	Val acc at iteration 85: 0.648936170212766
	Val acc at iteration 86: 0.6276595744680851
	Val acc at iteration 87: 0.7553191489361702
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.648936170212766
	Val acc at iteration 90: 0.6595744680851063
	Val acc at iteration 91: 0.648936170212766
	Val acc at iteration 92: 0.7446808510638298
	Val acc at iteration 93: 0.7021276595744681
	Val acc at iteration 94: 0.574468085106383
	Val acc at iteration 95: 0.7553191489361702
	Val acc at iteration 96: 0.648936170212766
	Val acc at iteration 97: 0.648936170212766
	Val acc at iteration 98: 0.6595744680851063
	Val acc at iteration 99: 0.6914893617021277
Val acc before epoch 26: 0.6808510638297872
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7659574468085106
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8936170212765957
Stopping after epoch 36.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8076923076923077
	Cluster: 0.6541828870773315
	Separation: 0.5234413146972656
(After push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7756410256410257
	Val acc at iteration 0: 0.6914893617021277
	Train acc at iteration 2: 0.7676282051282052
	Val acc at iteration 1: 0.7340425531914894
	Train acc at iteration 3: 0.7852564102564102
	Val acc at iteration 2: 0.6595744680851063
	Train acc at iteration 4: 0.7724358974358975
	Val acc at iteration 3: 0.6063829787234043
	Train acc at iteration 5: 0.7483974358974359
	Val acc at iteration 4: 0.7127659574468085
	Train acc at iteration 6: 0.7580128205128205
	Val acc at iteration 5: 0.6808510638297872
	Train acc at iteration 7: 0.8012820512820513
	Val acc at iteration 6: 0.7127659574468085
	Train acc at iteration 8: 0.7612179487179487
	Val acc at iteration 7: 0.7021276595744681
	Train acc at iteration 9: 0.8060897435897436
	Val acc at iteration 8: 0.648936170212766
	Train acc at iteration 10: 0.7836538461538461
	Val acc at iteration 9: 0.6914893617021277
	Train acc at iteration 11: 0.7628205128205128
	Val acc at iteration 10: 0.6595744680851063
	Train acc at iteration 12: 0.780448717948718
	Val acc at iteration 11: 0.7021276595744681
	Train acc at iteration 13: 0.7852564102564102
	Val acc at iteration 12: 0.6595744680851063
	Train acc at iteration 14: 0.7724358974358975
	Val acc at iteration 13: 0.6382978723404256
	Train acc at iteration 15: 0.7948717948717948
	Val acc at iteration 14: 0.6595744680851063
	Train acc at iteration 16: 0.7467948717948718
	Val acc at iteration 15: 0.6702127659574468
	Train acc at iteration 17: 0.7483974358974359
	Val acc at iteration 16: 0.6276595744680851
	Train acc at iteration 18: 0.7612179487179487
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.7532051282051282
	Val acc at iteration 18: 0.6276595744680851
	Train acc at iteration 20: 0.780448717948718
	Val acc at iteration 19: 0.648936170212766
	Train acc at iteration 21: 0.8044871794871795
	Val acc at iteration 20: 0.7021276595744681
	Train acc at iteration 22: 0.7900641025641025
	Val acc at iteration 21: 0.6914893617021277
	Train acc at iteration 23: 0.7676282051282052
	Val acc at iteration 22: 0.6914893617021277
	Train acc at iteration 24: 0.7708333333333334
	Val acc at iteration 23: 0.6595744680851063
	Train acc at iteration 25: 0.7788461538461539
	Val acc at iteration 24: 0.6702127659574468
	Train acc at iteration 26: 0.782051282051282
	Val acc at iteration 25: 0.6382978723404256
	Train acc at iteration 27: 0.7836538461538461
	Val acc at iteration 26: 0.6170212765957447
	Train acc at iteration 28: 0.7980769230769231
	Val acc at iteration 27: 0.7127659574468085
	Train acc at iteration 29: 0.7451923076923077
	Val acc at iteration 28: 0.723404255319149
	Train acc at iteration 30: 0.7996794871794872
	Val acc at iteration 29: 0.6170212765957447
	Train acc at iteration 31: 0.7676282051282052
	Val acc at iteration 30: 0.6276595744680851
	Train acc at iteration 32: 0.7692307692307693
	Val acc at iteration 31: 0.7553191489361702
	Train acc at iteration 33: 0.7932692307692307
	Val acc at iteration 32: 0.6595744680851063
	Train acc at iteration 34: 0.7868589743589743
	Val acc at iteration 33: 0.7021276595744681
	Train acc at iteration 35: 0.7516025641025641
	Val acc at iteration 34: 0.723404255319149
	Train acc at iteration 36: 0.7724358974358975
	Val acc at iteration 35: 0.6063829787234043
	Train acc at iteration 37: 0.782051282051282
	Val acc at iteration 36: 0.6276595744680851
	Train acc at iteration 38: 0.7612179487179487
	Val acc at iteration 37: 0.6914893617021277
	Train acc at iteration 39: 0.7756410256410257
	Val acc at iteration 38: 0.7127659574468085
	Train acc at iteration 40: 0.8108974358974359
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.7884615384615384
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.7836538461538461
	Val acc at iteration 41: 0.6595744680851063
	Train acc at iteration 43: 0.7580128205128205
	Val acc at iteration 42: 0.7340425531914894
	Train acc at iteration 44: 0.7724358974358975
	Val acc at iteration 43: 0.7127659574468085
	Train acc at iteration 45: 0.7644230769230769
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.7852564102564102
	Val acc at iteration 45: 0.5957446808510638
	Train acc at iteration 47: 0.7756410256410257
	Val acc at iteration 46: 0.6702127659574468
	Train acc at iteration 48: 0.780448717948718
	Val acc at iteration 47: 0.6914893617021277
	Train acc at iteration 49: 0.7596153846153846
	Val acc at iteration 48: 0.7446808510638298
	Train acc at iteration 50: 0.7676282051282052
	Val acc at iteration 49: 0.7446808510638298
	Train acc at iteration 51: 0.7852564102564102
	Val acc at iteration 50: 0.648936170212766
	Train acc at iteration 52: 0.7644230769230769
	Val acc at iteration 51: 0.6382978723404256
	Train acc at iteration 53: 0.7852564102564102
	Val acc at iteration 52: 0.7127659574468085
	Train acc at iteration 54: 0.7724358974358975
	Val acc at iteration 53: 0.6595744680851063
	Train acc at iteration 55: 0.7980769230769231
	Val acc at iteration 54: 0.6914893617021277
	Train acc at iteration 56: 0.7900641025641025
	Val acc at iteration 55: 0.5851063829787234
	Train acc at iteration 57: 0.7676282051282052
	Val acc at iteration 56: 0.723404255319149
	Train acc at iteration 58: 0.782051282051282
	Val acc at iteration 57: 0.7659574468085106
	Train acc at iteration 59: 0.7692307692307693
	Val acc at iteration 58: 0.6595744680851063
	Train acc at iteration 60: 0.7836538461538461
	Val acc at iteration 59: 0.648936170212766
	Train acc at iteration 61: 0.7836538461538461
	Val acc at iteration 60: 0.7021276595744681
	Train acc at iteration 62: 0.7740384615384616
	Val acc at iteration 61: 0.7127659574468085
	Train acc at iteration 63: 0.7451923076923077
	Val acc at iteration 62: 0.6276595744680851
	Train acc at iteration 64: 0.75
	Val acc at iteration 63: 0.6702127659574468
	Train acc at iteration 65: 0.7868589743589743
	Val acc at iteration 64: 0.6595744680851063
	Train acc at iteration 66: 0.7740384615384616
	Val acc at iteration 65: 0.6808510638297872
	Train acc at iteration 67: 0.7740384615384616
	Val acc at iteration 66: 0.6595744680851063
	Train acc at iteration 68: 0.7483974358974359
	Val acc at iteration 67: 0.6702127659574468
	Train acc at iteration 69: 0.7836538461538461
	Val acc at iteration 68: 0.7446808510638298
	Train acc at iteration 70: 0.8125
	Val acc at iteration 69: 0.7021276595744681
	Train acc at iteration 71: 0.7852564102564102
	Val acc at iteration 70: 0.6595744680851063
	Train acc at iteration 72: 0.7868589743589743
	Val acc at iteration 71: 0.648936170212766
	Train acc at iteration 73: 0.7852564102564102
	Val acc at iteration 72: 0.6808510638297872
	Train acc at iteration 74: 0.7580128205128205
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.7916666666666666
	Val acc at iteration 74: 0.6382978723404256
	Train acc at iteration 76: 0.7932692307692307
	Val acc at iteration 75: 0.723404255319149
	Train acc at iteration 77: 0.7516025641025641
	Val acc at iteration 76: 0.6170212765957447
	Train acc at iteration 78: 0.7628205128205128
	Val acc at iteration 77: 0.648936170212766
	Train acc at iteration 79: 0.7596153846153846
	Val acc at iteration 78: 0.6276595744680851
	Train acc at iteration 80: 0.7580128205128205
	Val acc at iteration 79: 0.6702127659574468
	Train acc at iteration 81: 0.7836538461538461
	Val acc at iteration 80: 0.6595744680851063
	Train acc at iteration 82: 0.782051282051282
	Val acc at iteration 81: 0.6382978723404256
	Train acc at iteration 83: 0.7772435897435898
	Val acc at iteration 82: 0.6595744680851063
	Train acc at iteration 84: 0.7884615384615384
	Val acc at iteration 83: 0.6702127659574468
	Train acc at iteration 85: 0.7788461538461539
	Val acc at iteration 84: 0.7553191489361702
	Train acc at iteration 86: 0.7676282051282052
	Val acc at iteration 85: 0.6595744680851063
	Train acc at iteration 87: 0.7580128205128205
	Val acc at iteration 86: 0.7553191489361702
	Train acc at iteration 88: 0.7740384615384616
	Val acc at iteration 87: 0.7446808510638298
	Train acc at iteration 89: 0.7772435897435898
	Val acc at iteration 88: 0.6808510638297872
	Train acc at iteration 90: 0.7628205128205128
	Val acc at iteration 89: 0.723404255319149
	Train acc at iteration 91: 0.7836538461538461
	Val acc at iteration 90: 0.7340425531914894
	Train acc at iteration 92: 0.7932692307692307
	Val acc at iteration 91: 0.723404255319149
	Train acc at iteration 93: 0.7708333333333334
	Val acc at iteration 92: 0.7340425531914894
	Train acc at iteration 94: 0.782051282051282
	Val acc at iteration 93: 0.6595744680851063
	Train acc at iteration 95: 0.7788461538461539
	Val acc at iteration 94: 0.6808510638297872
	Train acc at iteration 96: 0.7692307692307693
	Val acc at iteration 95: 0.6808510638297872
	Train acc at iteration 97: 0.7548076923076923
	Val acc at iteration 96: 0.6702127659574468
	Train acc at iteration 98: 0.7548076923076923
	Val acc at iteration 97: 0.6914893617021277
	Train acc at iteration 99: 0.7660256410256411
	Val acc at iteration 98: 0.6595744680851063
	Train acc at iteration 100: 0.7676282051282052
	Val acc at iteration 99: 0.6808510638297872
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5434027777777778
Final val micro accuracy: 0.6382978723404256
Final test macro f1-score: 0.5344569288389512
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.6361981928348541
	Separation: 0.5413410663604736
Final test:
	Cluster: 0.6042793393135071
	Separation: 0.5366563498973846
Saved Results

Attempting combination 28/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 0.24
l1_weight: 0.01
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.32978723404255317
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.6063829787234043
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.6914893617021277
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.7978723404255319
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Cluster: 0.6456125736236572
	Separation: 0.5185698747634888
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7127659574468085
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.7021276595744681
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.574468085106383
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.7659574468085106
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.776595744680851
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.6170212765957447
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.6276595744680851
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6382978723404256
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.776595744680851
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6170212765957447
	Val acc at iteration 45: 0.7553191489361702
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.7446808510638298
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7553191489361702
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.6702127659574468
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.6808510638297872
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.7127659574468085
	Val acc at iteration 87: 0.6702127659574468
	Val acc at iteration 88: 0.6595744680851063
	Val acc at iteration 89: 0.7021276595744681
	Val acc at iteration 90: 0.6702127659574468
	Val acc at iteration 91: 0.7553191489361702
	Val acc at iteration 92: 0.723404255319149
	Val acc at iteration 93: 0.7340425531914894
	Val acc at iteration 94: 0.6808510638297872
	Val acc at iteration 95: 0.723404255319149
	Val acc at iteration 96: 0.6914893617021277
	Val acc at iteration 97: 0.648936170212766
	Val acc at iteration 98: 0.6914893617021277
	Val acc at iteration 99: 0.6702127659574468
Val acc before epoch 16: 0.6702127659574468
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8237179487179487
	Cluster: 0.6535982847213745
	Separation: 0.52194904088974
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.7553191489361702
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.776595744680851
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.7553191489361702
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.7659574468085106
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6702127659574468
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.8085106382978723
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.6382978723404256
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.6170212765957447
	Val acc at iteration 80: 0.6276595744680851
	Val acc at iteration 81: 0.6276595744680851
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.6808510638297872
	Val acc at iteration 85: 0.723404255319149
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.7446808510638298
	Val acc at iteration 88: 0.7021276595744681
	Val acc at iteration 89: 0.6382978723404256
	Val acc at iteration 90: 0.8085106382978723
	Val acc at iteration 91: 0.7127659574468085
	Val acc at iteration 92: 0.648936170212766
	Val acc at iteration 93: 0.7021276595744681
	Val acc at iteration 94: 0.6702127659574468
	Val acc at iteration 95: 0.7446808510638298
	Val acc at iteration 96: 0.6702127659574468
	Val acc at iteration 97: 0.6595744680851063
	Val acc at iteration 98: 0.7127659574468085
	Val acc at iteration 99: 0.6702127659574468
Val acc before epoch 26: 0.6595744680851063
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.776595744680851
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9148936170212766
Stopping after epoch 36.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Cluster: 0.6503762006759644
	Separation: 0.5211079359054566
(After push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7980769230769231
	Val acc at iteration 0: 0.7021276595744681
	Train acc at iteration 2: 0.7708333333333334
	Val acc at iteration 1: 0.723404255319149
	Train acc at iteration 3: 0.7836538461538461
	Val acc at iteration 2: 0.6914893617021277
	Train acc at iteration 4: 0.7852564102564102
	Val acc at iteration 3: 0.723404255319149
	Train acc at iteration 5: 0.8092948717948718
	Val acc at iteration 4: 0.648936170212766
	Train acc at iteration 6: 0.7996794871794872
	Val acc at iteration 5: 0.6914893617021277
	Train acc at iteration 7: 0.8125
	Val acc at iteration 6: 0.7340425531914894
	Train acc at iteration 8: 0.8028846153846154
	Val acc at iteration 7: 0.7127659574468085
	Train acc at iteration 9: 0.7980769230769231
	Val acc at iteration 8: 0.6808510638297872
	Train acc at iteration 10: 0.8012820512820513
	Val acc at iteration 9: 0.723404255319149
	Train acc at iteration 11: 0.780448717948718
	Val acc at iteration 10: 0.7978723404255319
	Train acc at iteration 12: 0.7916666666666666
	Val acc at iteration 11: 0.7340425531914894
	Train acc at iteration 13: 0.7948717948717948
	Val acc at iteration 12: 0.6382978723404256
	Train acc at iteration 14: 0.7788461538461539
	Val acc at iteration 13: 0.6914893617021277
	Train acc at iteration 15: 0.7884615384615384
	Val acc at iteration 14: 0.7340425531914894
	Train acc at iteration 16: 0.7980769230769231
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.7884615384615384
	Val acc at iteration 16: 0.6914893617021277
	Train acc at iteration 18: 0.7916666666666666
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.8108974358974359
	Val acc at iteration 18: 0.7127659574468085
	Train acc at iteration 20: 0.8028846153846154
	Val acc at iteration 19: 0.6063829787234043
	Train acc at iteration 21: 0.7916666666666666
	Val acc at iteration 20: 0.6595744680851063
	Train acc at iteration 22: 0.7692307692307693
	Val acc at iteration 21: 0.7446808510638298
	Train acc at iteration 23: 0.8092948717948718
	Val acc at iteration 22: 0.648936170212766
	Train acc at iteration 24: 0.7884615384615384
	Val acc at iteration 23: 0.6702127659574468
	Train acc at iteration 25: 0.7724358974358975
	Val acc at iteration 24: 0.6595744680851063
	Train acc at iteration 26: 0.8141025641025641
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.8125
	Val acc at iteration 26: 0.6808510638297872
	Train acc at iteration 28: 0.7964743589743589
	Val acc at iteration 27: 0.7446808510638298
	Train acc at iteration 29: 0.7852564102564102
	Val acc at iteration 28: 0.776595744680851
	Train acc at iteration 30: 0.7708333333333334
	Val acc at iteration 29: 0.7340425531914894
	Train acc at iteration 31: 0.7836538461538461
	Val acc at iteration 30: 0.7127659574468085
	Train acc at iteration 32: 0.7964743589743589
	Val acc at iteration 31: 0.7021276595744681
	Train acc at iteration 33: 0.7916666666666666
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.7836538461538461
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.8012820512820513
	Val acc at iteration 34: 0.7659574468085106
	Train acc at iteration 36: 0.7948717948717948
	Val acc at iteration 35: 0.648936170212766
	Train acc at iteration 37: 0.7948717948717948
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.7676282051282052
	Val acc at iteration 37: 0.648936170212766
	Train acc at iteration 39: 0.8108974358974359
	Val acc at iteration 38: 0.7553191489361702
	Train acc at iteration 40: 0.7836538461538461
	Val acc at iteration 39: 0.7127659574468085
	Train acc at iteration 41: 0.7884615384615384
	Val acc at iteration 40: 0.6914893617021277
	Train acc at iteration 42: 0.7916666666666666
	Val acc at iteration 41: 0.723404255319149
	Train acc at iteration 43: 0.780448717948718
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.7852564102564102
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.782051282051282
	Val acc at iteration 44: 0.6808510638297872
	Train acc at iteration 46: 0.780448717948718
	Val acc at iteration 45: 0.723404255319149
	Train acc at iteration 47: 0.780448717948718
	Val acc at iteration 46: 0.8085106382978723
	Train acc at iteration 48: 0.7836538461538461
	Val acc at iteration 47: 0.723404255319149
	Train acc at iteration 49: 0.8205128205128205
	Val acc at iteration 48: 0.776595744680851
	Train acc at iteration 50: 0.8076923076923077
	Val acc at iteration 49: 0.723404255319149
	Train acc at iteration 51: 0.8012820512820513
	Val acc at iteration 50: 0.648936170212766
	Train acc at iteration 52: 0.7724358974358975
	Val acc at iteration 51: 0.7127659574468085
	Train acc at iteration 53: 0.782051282051282
	Val acc at iteration 52: 0.6808510638297872
	Train acc at iteration 54: 0.7772435897435898
	Val acc at iteration 53: 0.7340425531914894
	Train acc at iteration 55: 0.782051282051282
	Val acc at iteration 54: 0.6914893617021277
	Train acc at iteration 56: 0.7980769230769231
	Val acc at iteration 55: 0.7021276595744681
	Train acc at iteration 57: 0.780448717948718
	Val acc at iteration 56: 0.648936170212766
	Train acc at iteration 58: 0.7788461538461539
	Val acc at iteration 57: 0.6808510638297872
	Train acc at iteration 59: 0.8157051282051282
	Val acc at iteration 58: 0.6382978723404256
	Train acc at iteration 60: 0.8092948717948718
	Val acc at iteration 59: 0.6595744680851063
	Train acc at iteration 61: 0.8076923076923077
	Val acc at iteration 60: 0.6914893617021277
	Train acc at iteration 62: 0.7740384615384616
	Val acc at iteration 61: 0.7127659574468085
	Train acc at iteration 63: 0.8060897435897436
	Val acc at iteration 62: 0.6382978723404256
	Train acc at iteration 64: 0.7996794871794872
	Val acc at iteration 63: 0.6808510638297872
	Train acc at iteration 65: 0.7660256410256411
	Val acc at iteration 64: 0.7340425531914894
	Train acc at iteration 66: 0.8205128205128205
	Val acc at iteration 65: 0.6914893617021277
	Train acc at iteration 67: 0.7772435897435898
	Val acc at iteration 66: 0.7127659574468085
	Train acc at iteration 68: 0.8269230769230769
	Val acc at iteration 67: 0.6914893617021277
	Train acc at iteration 69: 0.7644230769230769
	Val acc at iteration 68: 0.648936170212766
	Train acc at iteration 70: 0.7996794871794872
	Val acc at iteration 69: 0.7446808510638298
	Train acc at iteration 71: 0.7884615384615384
	Val acc at iteration 70: 0.7021276595744681
	Train acc at iteration 72: 0.7580128205128205
	Val acc at iteration 71: 0.7340425531914894
	Train acc at iteration 73: 0.7948717948717948
	Val acc at iteration 72: 0.7127659574468085
	Train acc at iteration 74: 0.7868589743589743
	Val acc at iteration 73: 0.6808510638297872
	Train acc at iteration 75: 0.8076923076923077
	Val acc at iteration 74: 0.7446808510638298
	Train acc at iteration 76: 0.8141025641025641
	Val acc at iteration 75: 0.6702127659574468
	Train acc at iteration 77: 0.7964743589743589
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.7932692307692307
	Val acc at iteration 77: 0.723404255319149
	Train acc at iteration 79: 0.7884615384615384
	Val acc at iteration 78: 0.7127659574468085
	Train acc at iteration 80: 0.7900641025641025
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.8044871794871795
	Val acc at iteration 80: 0.723404255319149
	Train acc at iteration 82: 0.7852564102564102
	Val acc at iteration 81: 0.648936170212766
	Train acc at iteration 83: 0.7772435897435898
	Val acc at iteration 82: 0.6808510638297872
	Train acc at iteration 84: 0.8028846153846154
	Val acc at iteration 83: 0.6808510638297872
	Train acc at iteration 85: 0.7836538461538461
	Val acc at iteration 84: 0.7553191489361702
	Train acc at iteration 86: 0.7884615384615384
	Val acc at iteration 85: 0.7127659574468085
	Train acc at iteration 87: 0.8141025641025641
	Val acc at iteration 86: 0.7553191489361702
	Train acc at iteration 88: 0.7852564102564102
	Val acc at iteration 87: 0.7127659574468085
	Train acc at iteration 89: 0.7740384615384616
	Val acc at iteration 88: 0.648936170212766
	Train acc at iteration 90: 0.8333333333333334
	Val acc at iteration 89: 0.7021276595744681
	Train acc at iteration 91: 0.7916666666666666
	Val acc at iteration 90: 0.723404255319149
	Train acc at iteration 92: 0.7900641025641025
	Val acc at iteration 91: 0.6914893617021277
	Train acc at iteration 93: 0.7916666666666666
	Val acc at iteration 92: 0.7340425531914894
	Train acc at iteration 94: 0.8092948717948718
	Val acc at iteration 93: 0.6914893617021277
	Train acc at iteration 95: 0.7692307692307693
	Val acc at iteration 94: 0.6702127659574468
	Train acc at iteration 96: 0.8028846153846154
	Val acc at iteration 95: 0.6914893617021277
	Train acc at iteration 97: 0.8125
	Val acc at iteration 96: 0.723404255319149
	Train acc at iteration 98: 0.7996794871794872
	Val acc at iteration 97: 0.723404255319149
	Train acc at iteration 99: 0.8125
	Val acc at iteration 98: 0.7553191489361702
	Train acc at iteration 100: 0.7996794871794872
	Val acc at iteration 99: 0.7127659574468085
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5825242718446602
Final val micro accuracy: 0.7021276595744681
Final test macro f1-score: 0.4579710144927536
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6302417516708374
	Separation: 0.541735976934433
Final test:
	Cluster: 0.5930911898612976
	Separation: 0.5458186566829681
Saved Results

Attempting combination 29/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 0.24
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.40425531914893614
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7740384615384616
	Cluster: 0.646219801902771
	Separation: 0.5164651870727539
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.5212765957446809
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.5425531914893617
	Val acc at iteration 3: 0.6063829787234043
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.5638297872340425
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.7659574468085106
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6276595744680851
	Val acc at iteration 27: 0.6382978723404256
	Val acc at iteration 28: 0.6170212765957447
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.574468085106383
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.6063829787234043
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.5851063829787234
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.5957446808510638
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.648936170212766
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.776595744680851
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6382978723404256
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.6276595744680851
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.6276595744680851
	Val acc at iteration 77: 0.6595744680851063
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.6702127659574468
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.6702127659574468
	Val acc at iteration 87: 0.6382978723404256
	Val acc at iteration 88: 0.6276595744680851
	Val acc at iteration 89: 0.6382978723404256
	Val acc at iteration 90: 0.648936170212766
	Val acc at iteration 91: 0.6702127659574468
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.6276595744680851
	Val acc at iteration 94: 0.776595744680851
	Val acc at iteration 95: 0.7553191489361702
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.6808510638297872
	Val acc at iteration 98: 0.6170212765957447
	Val acc at iteration 99: 0.648936170212766
Val acc before epoch 16: 0.6382978723404256
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.8173076923076923
	Cluster: 0.6499387502670289
	Separation: 0.5176786780357361
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.6170212765957447
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.6276595744680851
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6063829787234043
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.6170212765957447
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.6170212765957447
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6276595744680851
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6702127659574468
	Val acc at iteration 85: 0.7340425531914894
	Val acc at iteration 86: 0.6382978723404256
	Val acc at iteration 87: 0.723404255319149
	Val acc at iteration 88: 0.7553191489361702
	Val acc at iteration 89: 0.7446808510638298
	Val acc at iteration 90: 0.7340425531914894
	Val acc at iteration 91: 0.6595744680851063
	Val acc at iteration 92: 0.648936170212766
	Val acc at iteration 93: 0.7446808510638298
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.7021276595744681
	Val acc at iteration 96: 0.7127659574468085
	Val acc at iteration 97: 0.7021276595744681
	Val acc at iteration 98: 0.7553191489361702
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 26: 0.6063829787234043
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7446808510638298
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8617021276595744
Stopping after epoch 36.
Final validation accuracy before push: 86.17021276595744%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8125
	Cluster: 0.6507282137870789
	Separation: 0.5214203596115112
(After push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8028846153846154
	Val acc at iteration 0: 0.7340425531914894
	Train acc at iteration 2: 0.7948717948717948
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.8221153846153846
	Val acc at iteration 2: 0.7021276595744681
	Train acc at iteration 4: 0.8301282051282052
	Val acc at iteration 3: 0.6170212765957447
	Train acc at iteration 5: 0.7900641025641025
	Val acc at iteration 4: 0.6914893617021277
	Train acc at iteration 6: 0.7900641025641025
	Val acc at iteration 5: 0.6382978723404256
	Train acc at iteration 7: 0.7916666666666666
	Val acc at iteration 6: 0.7127659574468085
	Train acc at iteration 8: 0.7772435897435898
	Val acc at iteration 7: 0.6276595744680851
	Train acc at iteration 9: 0.7948717948717948
	Val acc at iteration 8: 0.7340425531914894
	Train acc at iteration 10: 0.8221153846153846
	Val acc at iteration 9: 0.6808510638297872
	Train acc at iteration 11: 0.7852564102564102
	Val acc at iteration 10: 0.6808510638297872
	Train acc at iteration 12: 0.782051282051282
	Val acc at iteration 11: 0.6702127659574468
	Train acc at iteration 13: 0.8221153846153846
	Val acc at iteration 12: 0.6595744680851063
	Train acc at iteration 14: 0.7996794871794872
	Val acc at iteration 13: 0.7446808510638298
	Train acc at iteration 15: 0.782051282051282
	Val acc at iteration 14: 0.6914893617021277
	Train acc at iteration 16: 0.8253205128205128
	Val acc at iteration 15: 0.6914893617021277
	Train acc at iteration 17: 0.8044871794871795
	Val acc at iteration 16: 0.7021276595744681
	Train acc at iteration 18: 0.7724358974358975
	Val acc at iteration 17: 0.7872340425531915
	Train acc at iteration 19: 0.7884615384615384
	Val acc at iteration 18: 0.7340425531914894
	Train acc at iteration 20: 0.8092948717948718
	Val acc at iteration 19: 0.6382978723404256
	Train acc at iteration 21: 0.8060897435897436
	Val acc at iteration 20: 0.6914893617021277
	Train acc at iteration 22: 0.7948717948717948
	Val acc at iteration 21: 0.6595744680851063
	Train acc at iteration 23: 0.8189102564102564
	Val acc at iteration 22: 0.6914893617021277
	Train acc at iteration 24: 0.7980769230769231
	Val acc at iteration 23: 0.7340425531914894
	Train acc at iteration 25: 0.8044871794871795
	Val acc at iteration 24: 0.7659574468085106
	Train acc at iteration 26: 0.7836538461538461
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.8125
	Val acc at iteration 26: 0.6382978723404256
	Train acc at iteration 28: 0.8060897435897436
	Val acc at iteration 27: 0.7553191489361702
	Train acc at iteration 29: 0.7836538461538461
	Val acc at iteration 28: 0.723404255319149
	Train acc at iteration 30: 0.7868589743589743
	Val acc at iteration 29: 0.6702127659574468
	Train acc at iteration 31: 0.7932692307692307
	Val acc at iteration 30: 0.6702127659574468
	Train acc at iteration 32: 0.7996794871794872
	Val acc at iteration 31: 0.6702127659574468
	Train acc at iteration 33: 0.8028846153846154
	Val acc at iteration 32: 0.6702127659574468
	Train acc at iteration 34: 0.8092948717948718
	Val acc at iteration 33: 0.723404255319149
	Train acc at iteration 35: 0.8044871794871795
	Val acc at iteration 34: 0.7446808510638298
	Train acc at iteration 36: 0.7932692307692307
	Val acc at iteration 35: 0.7127659574468085
	Train acc at iteration 37: 0.7756410256410257
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.7996794871794872
	Val acc at iteration 37: 0.6808510638297872
	Train acc at iteration 39: 0.8108974358974359
	Val acc at iteration 38: 0.6595744680851063
	Train acc at iteration 40: 0.8141025641025641
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.8044871794871795
	Val acc at iteration 40: 0.723404255319149
	Train acc at iteration 42: 0.7932692307692307
	Val acc at iteration 41: 0.648936170212766
	Train acc at iteration 43: 0.7980769230769231
	Val acc at iteration 42: 0.7021276595744681
	Train acc at iteration 44: 0.8141025641025641
	Val acc at iteration 43: 0.6595744680851063
	Train acc at iteration 45: 0.7836538461538461
	Val acc at iteration 44: 0.7127659574468085
	Train acc at iteration 46: 0.8141025641025641
	Val acc at iteration 45: 0.6808510638297872
	Train acc at iteration 47: 0.7964743589743589
	Val acc at iteration 46: 0.6382978723404256
	Train acc at iteration 48: 0.8060897435897436
	Val acc at iteration 47: 0.7659574468085106
	Train acc at iteration 49: 0.7884615384615384
	Val acc at iteration 48: 0.648936170212766
	Train acc at iteration 50: 0.8157051282051282
	Val acc at iteration 49: 0.6595744680851063
	Train acc at iteration 51: 0.8317307692307693
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.8092948717948718
	Val acc at iteration 51: 0.6702127659574468
	Train acc at iteration 53: 0.8157051282051282
	Val acc at iteration 52: 0.7446808510638298
	Train acc at iteration 54: 0.8092948717948718
	Val acc at iteration 53: 0.6808510638297872
	Train acc at iteration 55: 0.8125
	Val acc at iteration 54: 0.7021276595744681
	Train acc at iteration 56: 0.7964743589743589
	Val acc at iteration 55: 0.6914893617021277
	Train acc at iteration 57: 0.7996794871794872
	Val acc at iteration 56: 0.6914893617021277
	Train acc at iteration 58: 0.7948717948717948
	Val acc at iteration 57: 0.6702127659574468
	Train acc at iteration 59: 0.7836538461538461
	Val acc at iteration 58: 0.7553191489361702
	Train acc at iteration 60: 0.8173076923076923
	Val acc at iteration 59: 0.7659574468085106
	Train acc at iteration 61: 0.8060897435897436
	Val acc at iteration 60: 0.6914893617021277
	Train acc at iteration 62: 0.8221153846153846
	Val acc at iteration 61: 0.7446808510638298
	Train acc at iteration 63: 0.7836538461538461
	Val acc at iteration 62: 0.7446808510638298
	Train acc at iteration 64: 0.7980769230769231
	Val acc at iteration 63: 0.7340425531914894
	Train acc at iteration 65: 0.8060897435897436
	Val acc at iteration 64: 0.6702127659574468
	Train acc at iteration 66: 0.7916666666666666
	Val acc at iteration 65: 0.6063829787234043
	Train acc at iteration 67: 0.8125
	Val acc at iteration 66: 0.723404255319149
	Train acc at iteration 68: 0.782051282051282
	Val acc at iteration 67: 0.7021276595744681
	Train acc at iteration 69: 0.7916666666666666
	Val acc at iteration 68: 0.6914893617021277
	Train acc at iteration 70: 0.8108974358974359
	Val acc at iteration 69: 0.7659574468085106
	Train acc at iteration 71: 0.7916666666666666
	Val acc at iteration 70: 0.6808510638297872
	Train acc at iteration 72: 0.8012820512820513
	Val acc at iteration 71: 0.6382978723404256
	Train acc at iteration 73: 0.8076923076923077
	Val acc at iteration 72: 0.6063829787234043
	Train acc at iteration 74: 0.8141025641025641
	Val acc at iteration 73: 0.7446808510638298
	Train acc at iteration 75: 0.7916666666666666
	Val acc at iteration 74: 0.6914893617021277
	Train acc at iteration 76: 0.8076923076923077
	Val acc at iteration 75: 0.648936170212766
	Train acc at iteration 77: 0.7932692307692307
	Val acc at iteration 76: 0.776595744680851
	Train acc at iteration 78: 0.7996794871794872
	Val acc at iteration 77: 0.7127659574468085
	Train acc at iteration 79: 0.7932692307692307
	Val acc at iteration 78: 0.7021276595744681
	Train acc at iteration 80: 0.7948717948717948
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.7980769230769231
	Val acc at iteration 80: 0.7553191489361702
	Train acc at iteration 82: 0.8108974358974359
	Val acc at iteration 81: 0.6702127659574468
	Train acc at iteration 83: 0.7964743589743589
	Val acc at iteration 82: 0.7127659574468085
	Train acc at iteration 84: 0.7852564102564102
	Val acc at iteration 83: 0.7127659574468085
	Train acc at iteration 85: 0.8028846153846154
	Val acc at iteration 84: 0.723404255319149
	Train acc at iteration 86: 0.7996794871794872
	Val acc at iteration 85: 0.6382978723404256
	Train acc at iteration 87: 0.7980769230769231
	Val acc at iteration 86: 0.6170212765957447
	Train acc at iteration 88: 0.7932692307692307
	Val acc at iteration 87: 0.7340425531914894
	Train acc at iteration 89: 0.7900641025641025
	Val acc at iteration 88: 0.7659574468085106
	Train acc at iteration 90: 0.8173076923076923
	Val acc at iteration 89: 0.7127659574468085
	Train acc at iteration 91: 0.8221153846153846
	Val acc at iteration 90: 0.6808510638297872
	Train acc at iteration 92: 0.8125
	Val acc at iteration 91: 0.6595744680851063
	Train acc at iteration 93: 0.8189102564102564
	Val acc at iteration 92: 0.6914893617021277
	Train acc at iteration 94: 0.8076923076923077
	Val acc at iteration 93: 0.6914893617021277
	Train acc at iteration 95: 0.8173076923076923
	Val acc at iteration 94: 0.7340425531914894
	Train acc at iteration 96: 0.8285256410256411
	Val acc at iteration 95: 0.7340425531914894
	Train acc at iteration 97: 0.8285256410256411
	Val acc at iteration 96: 0.7659574468085106
	Train acc at iteration 98: 0.7916666666666666
	Val acc at iteration 97: 0.648936170212766
	Train acc at iteration 99: 0.8028846153846154
	Val acc at iteration 98: 0.6808510638297872
	Train acc at iteration 100: 0.7948717948717948
	Val acc at iteration 99: 0.7127659574468085
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6030927835051546
Final val micro accuracy: 0.6914893617021277
Final test macro f1-score: 0.4921348314606741
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6128375232219696
	Separation: 0.5416196286678314
Final test:
	Cluster: 0.5995074510574341
	Separation: 0.5457387864589691
Saved Results

Attempting combination 30/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 24.0
l1_weight: 10
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.39361702127659576
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7978723404255319
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7916666666666666
	Cluster: 0.6521699547767639
	Separation: 0.5188868641853333
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.7553191489361702
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.776595744680851
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6170212765957447
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.6276595744680851
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.776595744680851
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.6595744680851063
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.7978723404255319
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.7978723404255319
	Val acc at iteration 37: 0.7446808510638298
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.7553191489361702
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.5957446808510638
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.6276595744680851
	Val acc at iteration 85: 0.7127659574468085
	Val acc at iteration 86: 0.6914893617021277
	Val acc at iteration 87: 0.6914893617021277
	Val acc at iteration 88: 0.723404255319149
	Val acc at iteration 89: 0.7021276595744681
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.6702127659574468
	Val acc at iteration 92: 0.7127659574468085
	Val acc at iteration 93: 0.7021276595744681
	Val acc at iteration 94: 0.6914893617021277
	Val acc at iteration 95: 0.7553191489361702
	Val acc at iteration 96: 0.7021276595744681
	Val acc at iteration 97: 0.7127659574468085
	Val acc at iteration 98: 0.6595744680851063
	Val acc at iteration 99: 0.7340425531914894
Val acc before epoch 16: 0.6702127659574468
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Cluster: 0.6408468127250672
	Separation: 0.5180029749870301
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7127659574468085
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.6276595744680851
	Val acc at iteration 5: 0.776595744680851
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.7446808510638298
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.7659574468085106
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.6063829787234043
	Val acc at iteration 31: 0.7553191489361702
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.648936170212766
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.7659574468085106
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.6382978723404256
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.7659574468085106
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.6276595744680851
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7659574468085106
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.6170212765957447
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.7553191489361702
	Val acc at iteration 86: 0.7340425531914894
	Val acc at iteration 87: 0.7127659574468085
	Val acc at iteration 88: 0.7021276595744681
	Val acc at iteration 89: 0.7127659574468085
	Val acc at iteration 90: 0.723404255319149
	Val acc at iteration 91: 0.7021276595744681
	Val acc at iteration 92: 0.7340425531914894
	Val acc at iteration 93: 0.7021276595744681
	Val acc at iteration 94: 0.6808510638297872
	Val acc at iteration 95: 0.6808510638297872
	Val acc at iteration 96: 0.723404255319149
	Val acc at iteration 97: 0.7340425531914894
	Val acc at iteration 98: 0.7021276595744681
	Val acc at iteration 99: 0.723404255319149
Val acc before epoch 26: 0.7446808510638298
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7553191489361702
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8829787234042553
Stopping after epoch 36.
Final validation accuracy before push: 88.29787234042553%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Cluster: 0.6532900094985962
	Separation: 0.5219589233398437
(After push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8012820512820513
	Val acc at iteration 0: 0.7021276595744681
	Train acc at iteration 2: 0.782051282051282
	Val acc at iteration 1: 0.6382978723404256
	Train acc at iteration 3: 0.7708333333333334
	Val acc at iteration 2: 0.7127659574468085
	Train acc at iteration 4: 0.7724358974358975
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.7852564102564102
	Val acc at iteration 4: 0.7446808510638298
	Train acc at iteration 6: 0.7948717948717948
	Val acc at iteration 5: 0.7021276595744681
	Train acc at iteration 7: 0.8060897435897436
	Val acc at iteration 6: 0.6702127659574468
	Train acc at iteration 8: 0.8349358974358975
	Val acc at iteration 7: 0.5957446808510638
	Train acc at iteration 9: 0.7660256410256411
	Val acc at iteration 8: 0.7021276595744681
	Train acc at iteration 10: 0.8060897435897436
	Val acc at iteration 9: 0.723404255319149
	Train acc at iteration 11: 0.7788461538461539
	Val acc at iteration 10: 0.7021276595744681
	Train acc at iteration 12: 0.7980769230769231
	Val acc at iteration 11: 0.7021276595744681
	Train acc at iteration 13: 0.7692307692307693
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.7868589743589743
	Val acc at iteration 13: 0.6702127659574468
	Train acc at iteration 15: 0.7756410256410257
	Val acc at iteration 14: 0.6382978723404256
	Train acc at iteration 16: 0.7788461538461539
	Val acc at iteration 15: 0.6382978723404256
	Train acc at iteration 17: 0.7772435897435898
	Val acc at iteration 16: 0.7021276595744681
	Train acc at iteration 18: 0.7996794871794872
	Val acc at iteration 17: 0.7340425531914894
	Train acc at iteration 19: 0.7724358974358975
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.8125
	Val acc at iteration 19: 0.7127659574468085
	Train acc at iteration 21: 0.7692307692307693
	Val acc at iteration 20: 0.7553191489361702
	Train acc at iteration 22: 0.8076923076923077
	Val acc at iteration 21: 0.7127659574468085
	Train acc at iteration 23: 0.782051282051282
	Val acc at iteration 22: 0.7553191489361702
	Train acc at iteration 24: 0.780448717948718
	Val acc at iteration 23: 0.7021276595744681
	Train acc at iteration 25: 0.7788461538461539
	Val acc at iteration 24: 0.7553191489361702
	Train acc at iteration 26: 0.7692307692307693
	Val acc at iteration 25: 0.6808510638297872
	Train acc at iteration 27: 0.7932692307692307
	Val acc at iteration 26: 0.7021276595744681
	Train acc at iteration 28: 0.7932692307692307
	Val acc at iteration 27: 0.6702127659574468
	Train acc at iteration 29: 0.7708333333333334
	Val acc at iteration 28: 0.6595744680851063
	Train acc at iteration 30: 0.7740384615384616
	Val acc at iteration 29: 0.6914893617021277
	Train acc at iteration 31: 0.7564102564102564
	Val acc at iteration 30: 0.7340425531914894
	Train acc at iteration 32: 0.7644230769230769
	Val acc at iteration 31: 0.7659574468085106
	Train acc at iteration 33: 0.7772435897435898
	Val acc at iteration 32: 0.7127659574468085
	Train acc at iteration 34: 0.8157051282051282
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.7932692307692307
	Val acc at iteration 34: 0.7553191489361702
	Train acc at iteration 36: 0.7868589743589743
	Val acc at iteration 35: 0.7021276595744681
	Train acc at iteration 37: 0.7644230769230769
	Val acc at iteration 36: 0.7553191489361702
	Train acc at iteration 38: 0.7836538461538461
	Val acc at iteration 37: 0.7872340425531915
	Train acc at iteration 39: 0.7788461538461539
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.7772435897435898
	Val acc at iteration 39: 0.723404255319149
	Train acc at iteration 41: 0.8028846153846154
	Val acc at iteration 40: 0.7021276595744681
	Train acc at iteration 42: 0.7724358974358975
	Val acc at iteration 41: 0.7021276595744681
	Train acc at iteration 43: 0.7868589743589743
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.7964743589743589
	Val acc at iteration 43: 0.6595744680851063
	Train acc at iteration 45: 0.7964743589743589
	Val acc at iteration 44: 0.776595744680851
	Train acc at iteration 46: 0.7932692307692307
	Val acc at iteration 45: 0.7127659574468085
	Train acc at iteration 47: 0.780448717948718
	Val acc at iteration 46: 0.6808510638297872
	Train acc at iteration 48: 0.7580128205128205
	Val acc at iteration 47: 0.7021276595744681
	Train acc at iteration 49: 0.8173076923076923
	Val acc at iteration 48: 0.6063829787234043
	Train acc at iteration 50: 0.7932692307692307
	Val acc at iteration 49: 0.7127659574468085
	Train acc at iteration 51: 0.7708333333333334
	Val acc at iteration 50: 0.7446808510638298
	Train acc at iteration 52: 0.7788461538461539
	Val acc at iteration 51: 0.7446808510638298
	Train acc at iteration 53: 0.7564102564102564
	Val acc at iteration 52: 0.7127659574468085
	Train acc at iteration 54: 0.7948717948717948
	Val acc at iteration 53: 0.6808510638297872
	Train acc at iteration 55: 0.7868589743589743
	Val acc at iteration 54: 0.6808510638297872
	Train acc at iteration 56: 0.7548076923076923
	Val acc at iteration 55: 0.7021276595744681
	Train acc at iteration 57: 0.7916666666666666
	Val acc at iteration 56: 0.6702127659574468
	Train acc at iteration 58: 0.7900641025641025
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.7516025641025641
	Val acc at iteration 58: 0.6914893617021277
	Train acc at iteration 60: 0.7868589743589743
	Val acc at iteration 59: 0.7021276595744681
	Train acc at iteration 61: 0.8028846153846154
	Val acc at iteration 60: 0.7978723404255319
	Train acc at iteration 62: 0.7948717948717948
	Val acc at iteration 61: 0.6914893617021277
	Train acc at iteration 63: 0.7948717948717948
	Val acc at iteration 62: 0.7659574468085106
	Train acc at iteration 64: 0.7788461538461539
	Val acc at iteration 63: 0.7446808510638298
	Train acc at iteration 65: 0.7756410256410257
	Val acc at iteration 64: 0.7021276595744681
	Train acc at iteration 66: 0.7724358974358975
	Val acc at iteration 65: 0.648936170212766
	Train acc at iteration 67: 0.7612179487179487
	Val acc at iteration 66: 0.6808510638297872
	Train acc at iteration 68: 0.7852564102564102
	Val acc at iteration 67: 0.7446808510638298
	Train acc at iteration 69: 0.7836538461538461
	Val acc at iteration 68: 0.7021276595744681
	Train acc at iteration 70: 0.7596153846153846
	Val acc at iteration 69: 0.6808510638297872
	Train acc at iteration 71: 0.7964743589743589
	Val acc at iteration 70: 0.6702127659574468
	Train acc at iteration 72: 0.8125
	Val acc at iteration 71: 0.723404255319149
	Train acc at iteration 73: 0.7788461538461539
	Val acc at iteration 72: 0.6808510638297872
	Train acc at iteration 74: 0.7788461538461539
	Val acc at iteration 73: 0.6808510638297872
	Train acc at iteration 75: 0.7628205128205128
	Val acc at iteration 74: 0.6382978723404256
	Train acc at iteration 76: 0.7580128205128205
	Val acc at iteration 75: 0.6914893617021277
	Train acc at iteration 77: 0.7740384615384616
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.7900641025641025
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.7740384615384616
	Val acc at iteration 78: 0.7340425531914894
	Train acc at iteration 80: 0.7964743589743589
	Val acc at iteration 79: 0.7340425531914894
	Train acc at iteration 81: 0.7788461538461539
	Val acc at iteration 80: 0.776595744680851
	Train acc at iteration 82: 0.7900641025641025
	Val acc at iteration 81: 0.6808510638297872
	Train acc at iteration 83: 0.7900641025641025
	Val acc at iteration 82: 0.723404255319149
	Train acc at iteration 84: 0.7996794871794872
	Val acc at iteration 83: 0.7021276595744681
	Train acc at iteration 85: 0.7900641025641025
	Val acc at iteration 84: 0.6595744680851063
	Train acc at iteration 86: 0.7980769230769231
	Val acc at iteration 85: 0.6063829787234043
	Train acc at iteration 87: 0.7708333333333334
	Val acc at iteration 86: 0.7340425531914894
	Train acc at iteration 88: 0.8125
	Val acc at iteration 87: 0.723404255319149
	Train acc at iteration 89: 0.8108974358974359
	Val acc at iteration 88: 0.6808510638297872
	Train acc at iteration 90: 0.7884615384615384
	Val acc at iteration 89: 0.6382978723404256
	Train acc at iteration 91: 0.7692307692307693
	Val acc at iteration 90: 0.648936170212766
	Train acc at iteration 92: 0.7916666666666666
	Val acc at iteration 91: 0.7553191489361702
	Train acc at iteration 93: 0.780448717948718
	Val acc at iteration 92: 0.7446808510638298
	Train acc at iteration 94: 0.7756410256410257
	Val acc at iteration 93: 0.7021276595744681
	Train acc at iteration 95: 0.7516025641025641
	Val acc at iteration 94: 0.7127659574468085
	Train acc at iteration 96: 0.8060897435897436
	Val acc at iteration 95: 0.7021276595744681
	Train acc at iteration 97: 0.7483974358974359
	Val acc at iteration 96: 0.723404255319149
	Train acc at iteration 98: 0.7852564102564102
	Val acc at iteration 97: 0.7127659574468085
	Train acc at iteration 99: 0.7916666666666666
	Val acc at iteration 98: 0.7021276595744681
	Train acc at iteration 100: 0.8108974358974359
	Val acc at iteration 99: 0.7127659574468085
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6598639455782312
Final val micro accuracy: 0.7872340425531915
Final test macro f1-score: 0.4528985507246376
Final test micro accuracy: 0.5638297872340425
Final validation:
	Cluster: 0.6259596049785614
	Separation: 0.5360006093978882
Final test:
	Cluster: 0.5939176678657532
	Separation: 0.5408563017845154
Saved Results

Attempting combination 31/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 24.0
l1_weight: 1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3617021276595745
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Cluster: 0.6458683729171752
	Separation: 0.5230903863906861
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6382978723404256
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6170212765957447
	Val acc at iteration 5: 0.7127659574468085
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6063829787234043
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.7553191489361702
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.5957446808510638
	Val acc at iteration 21: 0.6063829787234043
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.6276595744680851
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.6702127659574468
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.5957446808510638
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.6276595744680851
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.574468085106383
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.6170212765957447
	Val acc at iteration 67: 0.6382978723404256
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.6276595744680851
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.5957446808510638
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.7872340425531915
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.648936170212766
	Val acc at iteration 84: 0.6382978723404256
	Val acc at iteration 85: 0.6063829787234043
	Val acc at iteration 86: 0.6808510638297872
	Val acc at iteration 87: 0.6914893617021277
	Val acc at iteration 88: 0.7127659574468085
	Val acc at iteration 89: 0.6382978723404256
	Val acc at iteration 90: 0.6063829787234043
	Val acc at iteration 91: 0.723404255319149
	Val acc at iteration 92: 0.6382978723404256
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.7127659574468085
	Val acc at iteration 95: 0.6702127659574468
	Val acc at iteration 96: 0.6382978723404256
	Val acc at iteration 97: 0.648936170212766
	Val acc at iteration 98: 0.6382978723404256
	Val acc at iteration 99: 0.7553191489361702
Val acc before epoch 16: 0.6808510638297872
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Cluster: 0.6415544867515564
	Separation: 0.520717179775238
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.5957446808510638
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6063829787234043
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.6170212765957447
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.5957446808510638
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.6382978723404256
	Val acc at iteration 26: 0.5851063829787234
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.6063829787234043
	Val acc at iteration 31: 0.6276595744680851
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.5957446808510638
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.6382978723404256
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6276595744680851
	Val acc at iteration 45: 0.7553191489361702
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.5851063829787234
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.5957446808510638
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.6382978723404256
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6276595744680851
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.7340425531914894
	Val acc at iteration 85: 0.6808510638297872
	Val acc at iteration 86: 0.723404255319149
	Val acc at iteration 87: 0.723404255319149
	Val acc at iteration 88: 0.6276595744680851
	Val acc at iteration 89: 0.648936170212766
	Val acc at iteration 90: 0.6914893617021277
	Val acc at iteration 91: 0.7021276595744681
	Val acc at iteration 92: 0.648936170212766
	Val acc at iteration 93: 0.7340425531914894
	Val acc at iteration 94: 0.6914893617021277
	Val acc at iteration 95: 0.6914893617021277
	Val acc at iteration 96: 0.6170212765957447
	Val acc at iteration 97: 0.7021276595744681
	Val acc at iteration 98: 0.6808510638297872
	Val acc at iteration 99: 0.7021276595744681
Val acc before epoch 26: 0.6702127659574468
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.6914893617021277
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9148936170212766
Stopping after epoch 36.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7772435897435898
	Cluster: 0.6440720438957215
	Separation: 0.5182809352874755
(After push) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7516025641025641
	Val acc at iteration 0: 0.723404255319149
	Train acc at iteration 2: 0.7756410256410257
	Val acc at iteration 1: 0.7340425531914894
	Train acc at iteration 3: 0.7628205128205128
	Val acc at iteration 2: 0.7127659574468085
	Train acc at iteration 4: 0.7836538461538461
	Val acc at iteration 3: 0.6595744680851063
	Train acc at iteration 5: 0.7788461538461539
	Val acc at iteration 4: 0.5531914893617021
	Train acc at iteration 6: 0.7612179487179487
	Val acc at iteration 5: 0.6808510638297872
	Train acc at iteration 7: 0.7644230769230769
	Val acc at iteration 6: 0.6914893617021277
	Train acc at iteration 8: 0.7676282051282052
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.7900641025641025
	Val acc at iteration 8: 0.6702127659574468
	Train acc at iteration 10: 0.7836538461538461
	Val acc at iteration 9: 0.7127659574468085
	Train acc at iteration 11: 0.8125
	Val acc at iteration 10: 0.6595744680851063
	Train acc at iteration 12: 0.7868589743589743
	Val acc at iteration 11: 0.6702127659574468
	Train acc at iteration 13: 0.7772435897435898
	Val acc at iteration 12: 0.6595744680851063
	Train acc at iteration 14: 0.7756410256410257
	Val acc at iteration 13: 0.723404255319149
	Train acc at iteration 15: 0.7868589743589743
	Val acc at iteration 14: 0.6808510638297872
	Train acc at iteration 16: 0.8060897435897436
	Val acc at iteration 15: 0.6382978723404256
	Train acc at iteration 17: 0.7836538461538461
	Val acc at iteration 16: 0.6595744680851063
	Train acc at iteration 18: 0.7932692307692307
	Val acc at iteration 17: 0.6276595744680851
	Train acc at iteration 19: 0.7676282051282052
	Val acc at iteration 18: 0.6702127659574468
	Train acc at iteration 20: 0.7852564102564102
	Val acc at iteration 19: 0.648936170212766
	Train acc at iteration 21: 0.7756410256410257
	Val acc at iteration 20: 0.6702127659574468
	Train acc at iteration 22: 0.8012820512820513
	Val acc at iteration 21: 0.7021276595744681
	Train acc at iteration 23: 0.7580128205128205
	Val acc at iteration 22: 0.7446808510638298
	Train acc at iteration 24: 0.7788461538461539
	Val acc at iteration 23: 0.6808510638297872
	Train acc at iteration 25: 0.7676282051282052
	Val acc at iteration 24: 0.7021276595744681
	Train acc at iteration 26: 0.7788461538461539
	Val acc at iteration 25: 0.6276595744680851
	Train acc at iteration 27: 0.7996794871794872
	Val acc at iteration 26: 0.6276595744680851
	Train acc at iteration 28: 0.7852564102564102
	Val acc at iteration 27: 0.6170212765957447
	Train acc at iteration 29: 0.7724358974358975
	Val acc at iteration 28: 0.6808510638297872
	Train acc at iteration 30: 0.7660256410256411
	Val acc at iteration 29: 0.7021276595744681
	Train acc at iteration 31: 0.7371794871794872
	Val acc at iteration 30: 0.6276595744680851
	Train acc at iteration 32: 0.8012820512820513
	Val acc at iteration 31: 0.5425531914893617
	Train acc at iteration 33: 0.7564102564102564
	Val acc at iteration 32: 0.723404255319149
	Train acc at iteration 34: 0.8173076923076923
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.7900641025641025
	Val acc at iteration 34: 0.723404255319149
	Train acc at iteration 36: 0.782051282051282
	Val acc at iteration 35: 0.6914893617021277
	Train acc at iteration 37: 0.7884615384615384
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.7756410256410257
	Val acc at iteration 37: 0.6170212765957447
	Train acc at iteration 39: 0.7772435897435898
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.7932692307692307
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.7996794871794872
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.7932692307692307
	Val acc at iteration 41: 0.6808510638297872
	Train acc at iteration 43: 0.7692307692307693
	Val acc at iteration 42: 0.7340425531914894
	Train acc at iteration 44: 0.8044871794871795
	Val acc at iteration 43: 0.6170212765957447
	Train acc at iteration 45: 0.7644230769230769
	Val acc at iteration 44: 0.6595744680851063
	Train acc at iteration 46: 0.7932692307692307
	Val acc at iteration 45: 0.7340425531914894
	Train acc at iteration 47: 0.7916666666666666
	Val acc at iteration 46: 0.7021276595744681
	Train acc at iteration 48: 0.782051282051282
	Val acc at iteration 47: 0.6595744680851063
	Train acc at iteration 49: 0.7596153846153846
	Val acc at iteration 48: 0.723404255319149
	Train acc at iteration 50: 0.8012820512820513
	Val acc at iteration 49: 0.648936170212766
	Train acc at iteration 51: 0.7852564102564102
	Val acc at iteration 50: 0.648936170212766
	Train acc at iteration 52: 0.7900641025641025
	Val acc at iteration 51: 0.6276595744680851
	Train acc at iteration 53: 0.7868589743589743
	Val acc at iteration 52: 0.7446808510638298
	Train acc at iteration 54: 0.7980769230769231
	Val acc at iteration 53: 0.6914893617021277
	Train acc at iteration 55: 0.7628205128205128
	Val acc at iteration 54: 0.6808510638297872
	Train acc at iteration 56: 0.7916666666666666
	Val acc at iteration 55: 0.723404255319149
	Train acc at iteration 57: 0.7724358974358975
	Val acc at iteration 56: 0.6170212765957447
	Train acc at iteration 58: 0.7532051282051282
	Val acc at iteration 57: 0.6808510638297872
	Train acc at iteration 59: 0.7932692307692307
	Val acc at iteration 58: 0.7021276595744681
	Train acc at iteration 60: 0.7788461538461539
	Val acc at iteration 59: 0.7127659574468085
	Train acc at iteration 61: 0.7772435897435898
	Val acc at iteration 60: 0.648936170212766
	Train acc at iteration 62: 0.7467948717948718
	Val acc at iteration 61: 0.6808510638297872
	Train acc at iteration 63: 0.782051282051282
	Val acc at iteration 62: 0.6595744680851063
	Train acc at iteration 64: 0.7580128205128205
	Val acc at iteration 63: 0.6914893617021277
	Train acc at iteration 65: 0.7692307692307693
	Val acc at iteration 64: 0.6170212765957447
	Train acc at iteration 66: 0.782051282051282
	Val acc at iteration 65: 0.6276595744680851
	Train acc at iteration 67: 0.7852564102564102
	Val acc at iteration 66: 0.6702127659574468
	Train acc at iteration 68: 0.8028846153846154
	Val acc at iteration 67: 0.7127659574468085
	Train acc at iteration 69: 0.7788461538461539
	Val acc at iteration 68: 0.6382978723404256
	Train acc at iteration 70: 0.7644230769230769
	Val acc at iteration 69: 0.6382978723404256
	Train acc at iteration 71: 0.7628205128205128
	Val acc at iteration 70: 0.6382978723404256
	Train acc at iteration 72: 0.7644230769230769
	Val acc at iteration 71: 0.5957446808510638
	Train acc at iteration 73: 0.8044871794871795
	Val acc at iteration 72: 0.723404255319149
	Train acc at iteration 74: 0.7788461538461539
	Val acc at iteration 73: 0.574468085106383
	Train acc at iteration 75: 0.7852564102564102
	Val acc at iteration 74: 0.648936170212766
	Train acc at iteration 76: 0.7676282051282052
	Val acc at iteration 75: 0.6914893617021277
	Train acc at iteration 77: 0.7644230769230769
	Val acc at iteration 76: 0.6808510638297872
	Train acc at iteration 78: 0.7628205128205128
	Val acc at iteration 77: 0.6063829787234043
	Train acc at iteration 79: 0.7772435897435898
	Val acc at iteration 78: 0.6808510638297872
	Train acc at iteration 80: 0.7596153846153846
	Val acc at iteration 79: 0.723404255319149
	Train acc at iteration 81: 0.7932692307692307
	Val acc at iteration 80: 0.7021276595744681
	Train acc at iteration 82: 0.7467948717948718
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7852564102564102
	Val acc at iteration 82: 0.648936170212766
	Train acc at iteration 84: 0.8060897435897436
	Val acc at iteration 83: 0.6595744680851063
	Train acc at iteration 85: 0.7884615384615384
	Val acc at iteration 84: 0.6808510638297872
	Train acc at iteration 86: 0.7868589743589743
	Val acc at iteration 85: 0.6063829787234043
	Train acc at iteration 87: 0.7900641025641025
	Val acc at iteration 86: 0.7021276595744681
	Train acc at iteration 88: 0.782051282051282
	Val acc at iteration 87: 0.6595744680851063
	Train acc at iteration 89: 0.780448717948718
	Val acc at iteration 88: 0.7021276595744681
	Train acc at iteration 90: 0.7564102564102564
	Val acc at iteration 89: 0.6808510638297872
	Train acc at iteration 91: 0.7900641025641025
	Val acc at iteration 90: 0.7021276595744681
	Train acc at iteration 92: 0.7868589743589743
	Val acc at iteration 91: 0.6382978723404256
	Train acc at iteration 93: 0.7932692307692307
	Val acc at iteration 92: 0.6276595744680851
	Train acc at iteration 94: 0.7692307692307693
	Val acc at iteration 93: 0.6382978723404256
	Train acc at iteration 95: 0.7676282051282052
	Val acc at iteration 94: 0.6808510638297872
	Train acc at iteration 96: 0.780448717948718
	Val acc at iteration 95: 0.7446808510638298
	Train acc at iteration 97: 0.7724358974358975
	Val acc at iteration 96: 0.6808510638297872
	Train acc at iteration 98: 0.782051282051282
	Val acc at iteration 97: 0.6914893617021277
	Train acc at iteration 99: 0.7868589743589743
	Val acc at iteration 98: 0.6914893617021277
	Train acc at iteration 100: 0.7932692307692307
	Val acc at iteration 99: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6280701754385964
Final val micro accuracy: 0.723404255319149
Final test macro f1-score: 0.4131944444444444
Final test micro accuracy: 0.5425531914893617
Final validation:
	Cluster: 0.6213617622852325
	Separation: 0.5495695173740387
Final test:
	Cluster: 0.5926343500614166
	Separation: 0.5421754121780396
Saved Results

Attempting combination 32/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 24.0
l1_weight: 0.1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.425531914893617
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7978723404255319
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9574468085106383
Push epoch
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Cluster: 0.659628689289093
	Separation: 0.52316312789917
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.7340425531914894
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.7446808510638298
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.6276595744680851
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.574468085106383
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.5957446808510638
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.6276595744680851
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.648936170212766
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.5957446808510638
	Val acc at iteration 84: 0.6914893617021277
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.7446808510638298
	Val acc at iteration 88: 0.6808510638297872
	Val acc at iteration 89: 0.6914893617021277
	Val acc at iteration 90: 0.6276595744680851
	Val acc at iteration 91: 0.6702127659574468
	Val acc at iteration 92: 0.7553191489361702
	Val acc at iteration 93: 0.6382978723404256
	Val acc at iteration 94: 0.5957446808510638
	Val acc at iteration 95: 0.6702127659574468
	Val acc at iteration 96: 0.6702127659574468
	Val acc at iteration 97: 0.6914893617021277
	Val acc at iteration 98: 0.6702127659574468
	Val acc at iteration 99: 0.7127659574468085
Val acc before epoch 16: 0.6702127659574468
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9680851063829787
Push epoch
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Cluster: 0.661410641670227
	Separation: 0.5293914318084717
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6382978723404256
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.5957446808510638
	Val acc at iteration 7: 0.6170212765957447
	Val acc at iteration 8: 0.6276595744680851
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6170212765957447
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6382978723404256
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.6063829787234043
	Val acc at iteration 25: 0.5851063829787234
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.7978723404255319
	Val acc at iteration 31: 0.5851063829787234
	Val acc at iteration 32: 0.5957446808510638
	Val acc at iteration 33: 0.6382978723404256
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6063829787234043
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.574468085106383
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6063829787234043
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.5957446808510638
	Val acc at iteration 63: 0.6276595744680851
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.6382978723404256
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.6063829787234043
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.6382978723404256
	Val acc at iteration 73: 0.5957446808510638
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.5851063829787234
	Val acc at iteration 77: 0.6382978723404256
	Val acc at iteration 78: 0.6063829787234043
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.6063829787234043
	Val acc at iteration 81: 0.6276595744680851
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.6276595744680851
	Val acc at iteration 85: 0.7021276595744681
	Val acc at iteration 86: 0.6382978723404256
	Val acc at iteration 87: 0.6595744680851063
	Val acc at iteration 88: 0.776595744680851
	Val acc at iteration 89: 0.5957446808510638
	Val acc at iteration 90: 0.6702127659574468
	Val acc at iteration 91: 0.6276595744680851
	Val acc at iteration 92: 0.7127659574468085
	Val acc at iteration 93: 0.7340425531914894
	Val acc at iteration 94: 0.6914893617021277
	Val acc at iteration 95: 0.6595744680851063
	Val acc at iteration 96: 0.723404255319149
	Val acc at iteration 97: 0.6808510638297872
	Val acc at iteration 98: 0.6382978723404256
	Val acc at iteration 99: 0.6702127659574468
Val acc before epoch 26: 0.6276595744680851
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.925531914893617
Stopping after epoch 36.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7740384615384616
	Cluster: 0.6547915697097778
	Separation: 0.5257344841957092
(After push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7868589743589743
	Val acc at iteration 0: 0.648936170212766
	Train acc at iteration 2: 0.780448717948718
	Val acc at iteration 1: 0.7021276595744681
	Train acc at iteration 3: 0.782051282051282
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.7980769230769231
	Val acc at iteration 3: 0.7659574468085106
	Train acc at iteration 5: 0.7644230769230769
	Val acc at iteration 4: 0.6808510638297872
	Train acc at iteration 6: 0.7628205128205128
	Val acc at iteration 5: 0.6276595744680851
	Train acc at iteration 7: 0.7836538461538461
	Val acc at iteration 6: 0.7021276595744681
	Train acc at iteration 8: 0.7676282051282052
	Val acc at iteration 7: 0.723404255319149
	Train acc at iteration 9: 0.7884615384615384
	Val acc at iteration 8: 0.7127659574468085
	Train acc at iteration 10: 0.7532051282051282
	Val acc at iteration 9: 0.6914893617021277
	Train acc at iteration 11: 0.7836538461538461
	Val acc at iteration 10: 0.6595744680851063
	Train acc at iteration 12: 0.7788461538461539
	Val acc at iteration 11: 0.7021276595744681
	Train acc at iteration 13: 0.7419871794871795
	Val acc at iteration 12: 0.6808510638297872
	Train acc at iteration 14: 0.7868589743589743
	Val acc at iteration 13: 0.6914893617021277
	Train acc at iteration 15: 0.7772435897435898
	Val acc at iteration 14: 0.6808510638297872
	Train acc at iteration 16: 0.782051282051282
	Val acc at iteration 15: 0.6702127659574468
	Train acc at iteration 17: 0.7644230769230769
	Val acc at iteration 16: 0.6702127659574468
	Train acc at iteration 18: 0.7772435897435898
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.7900641025641025
	Val acc at iteration 18: 0.6702127659574468
	Train acc at iteration 20: 0.7708333333333334
	Val acc at iteration 19: 0.7021276595744681
	Train acc at iteration 21: 0.7932692307692307
	Val acc at iteration 20: 0.723404255319149
	Train acc at iteration 22: 0.7836538461538461
	Val acc at iteration 21: 0.6808510638297872
	Train acc at iteration 23: 0.7852564102564102
	Val acc at iteration 22: 0.6063829787234043
	Train acc at iteration 24: 0.780448717948718
	Val acc at iteration 23: 0.6914893617021277
	Train acc at iteration 25: 0.7724358974358975
	Val acc at iteration 24: 0.7127659574468085
	Train acc at iteration 26: 0.7692307692307693
	Val acc at iteration 25: 0.6808510638297872
	Train acc at iteration 27: 0.7660256410256411
	Val acc at iteration 26: 0.6276595744680851
	Train acc at iteration 28: 0.7948717948717948
	Val acc at iteration 27: 0.7127659574468085
	Train acc at iteration 29: 0.7852564102564102
	Val acc at iteration 28: 0.6595744680851063
	Train acc at iteration 30: 0.782051282051282
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.780448717948718
	Val acc at iteration 30: 0.6382978723404256
	Train acc at iteration 32: 0.7788461538461539
	Val acc at iteration 31: 0.6063829787234043
	Train acc at iteration 33: 0.7644230769230769
	Val acc at iteration 32: 0.6595744680851063
	Train acc at iteration 34: 0.7724358974358975
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.7884615384615384
	Val acc at iteration 34: 0.5957446808510638
	Train acc at iteration 36: 0.7724358974358975
	Val acc at iteration 35: 0.7021276595744681
	Train acc at iteration 37: 0.7916666666666666
	Val acc at iteration 36: 0.723404255319149
	Train acc at iteration 38: 0.7756410256410257
	Val acc at iteration 37: 0.6702127659574468
	Train acc at iteration 39: 0.7516025641025641
	Val acc at iteration 38: 0.7127659574468085
	Train acc at iteration 40: 0.7916666666666666
	Val acc at iteration 39: 0.6382978723404256
	Train acc at iteration 41: 0.7708333333333334
	Val acc at iteration 40: 0.648936170212766
	Train acc at iteration 42: 0.7868589743589743
	Val acc at iteration 41: 0.6595744680851063
	Train acc at iteration 43: 0.7836538461538461
	Val acc at iteration 42: 0.6595744680851063
	Train acc at iteration 44: 0.7932692307692307
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.8028846153846154
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.7692307692307693
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.7772435897435898
	Val acc at iteration 46: 0.6595744680851063
	Train acc at iteration 48: 0.7868589743589743
	Val acc at iteration 47: 0.6276595744680851
	Train acc at iteration 49: 0.7868589743589743
	Val acc at iteration 48: 0.6063829787234043
	Train acc at iteration 50: 0.7900641025641025
	Val acc at iteration 49: 0.6702127659574468
	Train acc at iteration 51: 0.7596153846153846
	Val acc at iteration 50: 0.6808510638297872
	Train acc at iteration 52: 0.7836538461538461
	Val acc at iteration 51: 0.7127659574468085
	Train acc at iteration 53: 0.7724358974358975
	Val acc at iteration 52: 0.6063829787234043
	Train acc at iteration 54: 0.7884615384615384
	Val acc at iteration 53: 0.6914893617021277
	Train acc at iteration 55: 0.7788461538461539
	Val acc at iteration 54: 0.6063829787234043
	Train acc at iteration 56: 0.782051282051282
	Val acc at iteration 55: 0.5531914893617021
	Train acc at iteration 57: 0.7580128205128205
	Val acc at iteration 56: 0.6382978723404256
	Train acc at iteration 58: 0.8012820512820513
	Val acc at iteration 57: 0.7127659574468085
	Train acc at iteration 59: 0.7884615384615384
	Val acc at iteration 58: 0.723404255319149
	Train acc at iteration 60: 0.7724358974358975
	Val acc at iteration 59: 0.5851063829787234
	Train acc at iteration 61: 0.7836538461538461
	Val acc at iteration 60: 0.7127659574468085
	Train acc at iteration 62: 0.7708333333333334
	Val acc at iteration 61: 0.7340425531914894
	Train acc at iteration 63: 0.7724358974358975
	Val acc at iteration 62: 0.648936170212766
	Train acc at iteration 64: 0.7788461538461539
	Val acc at iteration 63: 0.6914893617021277
	Train acc at iteration 65: 0.7788461538461539
	Val acc at iteration 64: 0.6914893617021277
	Train acc at iteration 66: 0.782051282051282
	Val acc at iteration 65: 0.6702127659574468
	Train acc at iteration 67: 0.7483974358974359
	Val acc at iteration 66: 0.6702127659574468
	Train acc at iteration 68: 0.7900641025641025
	Val acc at iteration 67: 0.6382978723404256
	Train acc at iteration 69: 0.7916666666666666
	Val acc at iteration 68: 0.648936170212766
	Train acc at iteration 70: 0.7660256410256411
	Val acc at iteration 69: 0.648936170212766
	Train acc at iteration 71: 0.780448717948718
	Val acc at iteration 70: 0.6063829787234043
	Train acc at iteration 72: 0.7772435897435898
	Val acc at iteration 71: 0.6595744680851063
	Train acc at iteration 73: 0.7564102564102564
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.7644230769230769
	Val acc at iteration 73: 0.6276595744680851
	Train acc at iteration 75: 0.782051282051282
	Val acc at iteration 74: 0.6702127659574468
	Train acc at iteration 76: 0.8076923076923077
	Val acc at iteration 75: 0.6808510638297872
	Train acc at iteration 77: 0.780448717948718
	Val acc at iteration 76: 0.723404255319149
	Train acc at iteration 78: 0.7884615384615384
	Val acc at iteration 77: 0.7021276595744681
	Train acc at iteration 79: 0.7435897435897436
	Val acc at iteration 78: 0.6276595744680851
	Train acc at iteration 80: 0.7788461538461539
	Val acc at iteration 79: 0.648936170212766
	Train acc at iteration 81: 0.7756410256410257
	Val acc at iteration 80: 0.6702127659574468
	Train acc at iteration 82: 0.7676282051282052
	Val acc at iteration 81: 0.6808510638297872
	Train acc at iteration 83: 0.7548076923076923
	Val acc at iteration 82: 0.6382978723404256
	Train acc at iteration 84: 0.7852564102564102
	Val acc at iteration 83: 0.7446808510638298
	Train acc at iteration 85: 0.7516025641025641
	Val acc at iteration 84: 0.6914893617021277
	Train acc at iteration 86: 0.7564102564102564
	Val acc at iteration 85: 0.6914893617021277
	Train acc at iteration 87: 0.7868589743589743
	Val acc at iteration 86: 0.6808510638297872
	Train acc at iteration 88: 0.7836538461538461
	Val acc at iteration 87: 0.5957446808510638
	Train acc at iteration 89: 0.7884615384615384
	Val acc at iteration 88: 0.6702127659574468
	Train acc at iteration 90: 0.8092948717948718
	Val acc at iteration 89: 0.6914893617021277
	Train acc at iteration 91: 0.7532051282051282
	Val acc at iteration 90: 0.6170212765957447
	Train acc at iteration 92: 0.7676282051282052
	Val acc at iteration 91: 0.7553191489361702
	Train acc at iteration 93: 0.7948717948717948
	Val acc at iteration 92: 0.6595744680851063
	Train acc at iteration 94: 0.7532051282051282
	Val acc at iteration 93: 0.7127659574468085
	Train acc at iteration 95: 0.7644230769230769
	Val acc at iteration 94: 0.6808510638297872
	Train acc at iteration 96: 0.7532051282051282
	Val acc at iteration 95: 0.648936170212766
	Train acc at iteration 97: 0.7836538461538461
	Val acc at iteration 96: 0.7340425531914894
	Train acc at iteration 98: 0.7628205128205128
	Val acc at iteration 97: 0.7872340425531915
	Train acc at iteration 99: 0.7692307692307693
	Val acc at iteration 98: 0.6063829787234043
	Train acc at iteration 100: 0.7580128205128205
	Val acc at iteration 99: 0.6808510638297872
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5666666666666668
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.4689138576779026
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.6264292001724243
	Separation: 0.5421610772609711
Final test:
	Cluster: 0.5987851917743683
	Separation: 0.5327736437320709
Saved Results

Attempting combination 33/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 24.0
l1_weight: 0.01
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7836538461538461
	Cluster: 0.6458487153053284
	Separation: 0.5196388006210327
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6276595744680851
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6276595744680851
	Val acc at iteration 14: 0.6063829787234043
	Val acc at iteration 15: 0.6382978723404256
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.5319148936170213
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.6170212765957447
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.6170212765957447
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.5957446808510638
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.6382978723404256
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.6170212765957447
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.5957446808510638
	Val acc at iteration 46: 0.6063829787234043
	Val acc at iteration 47: 0.5638297872340425
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.6276595744680851
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.6170212765957447
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.6382978723404256
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.6170212765957447
	Val acc at iteration 70: 0.5851063829787234
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.5957446808510638
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.5851063829787234
	Val acc at iteration 77: 0.6382978723404256
	Val acc at iteration 78: 0.6170212765957447
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.648936170212766
	Val acc at iteration 84: 0.6808510638297872
	Val acc at iteration 85: 0.648936170212766
	Val acc at iteration 86: 0.648936170212766
	Val acc at iteration 87: 0.6276595744680851
	Val acc at iteration 88: 0.6808510638297872
	Val acc at iteration 89: 0.6808510638297872
	Val acc at iteration 90: 0.6702127659574468
	Val acc at iteration 91: 0.6276595744680851
	Val acc at iteration 92: 0.5851063829787234
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.6914893617021277
	Val acc at iteration 95: 0.5957446808510638
	Val acc at iteration 96: 0.6595744680851063
	Val acc at iteration 97: 0.6914893617021277
	Val acc at iteration 98: 0.6595744680851063
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 16: 0.574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7872340425531915
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Cluster: 0.6467163920402527
	Separation: 0.5184228658676148
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6170212765957447
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6063829787234043
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.574468085106383
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6382978723404256
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.6170212765957447
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.6276595744680851
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.6276595744680851
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.6170212765957447
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6063829787234043
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.6382978723404256
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.6276595744680851
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.6276595744680851
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.574468085106383
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6063829787234043
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.6170212765957447
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.7978723404255319
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6276595744680851
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.574468085106383
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.6170212765957447
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.6382978723404256
	Val acc at iteration 74: 0.5531914893617021
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.574468085106383
	Val acc at iteration 80: 0.5851063829787234
	Val acc at iteration 81: 0.6170212765957447
	Val acc at iteration 82: 0.6170212765957447
	Val acc at iteration 83: 0.5957446808510638
	Val acc at iteration 84: 0.6595744680851063
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.6702127659574468
	Val acc at iteration 87: 0.6276595744680851
	Val acc at iteration 88: 0.5425531914893617
	Val acc at iteration 89: 0.6808510638297872
	Val acc at iteration 90: 0.7021276595744681
	Val acc at iteration 91: 0.648936170212766
	Val acc at iteration 92: 0.6170212765957447
	Val acc at iteration 93: 0.6382978723404256
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.6382978723404256
	Val acc at iteration 96: 0.6382978723404256
	Val acc at iteration 97: 0.6914893617021277
	Val acc at iteration 98: 0.648936170212766
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 26: 0.6702127659574468
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.776595744680851
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9148936170212766
Stopping after epoch 36.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Cluster: 0.6466609597206116
	Separation: 0.5236403822898865
(After push) Val acc at iteration 0: 0.5851063829787234
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8092948717948718
	Val acc at iteration 0: 0.6914893617021277
	Train acc at iteration 2: 0.7788461538461539
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.7964743589743589
	Val acc at iteration 2: 0.6170212765957447
	Train acc at iteration 4: 0.7964743589743589
	Val acc at iteration 3: 0.6276595744680851
	Train acc at iteration 5: 0.7884615384615384
	Val acc at iteration 4: 0.5851063829787234
	Train acc at iteration 6: 0.7692307692307693
	Val acc at iteration 5: 0.6702127659574468
	Train acc at iteration 7: 0.7756410256410257
	Val acc at iteration 6: 0.6595744680851063
	Train acc at iteration 8: 0.7836538461538461
	Val acc at iteration 7: 0.6702127659574468
	Train acc at iteration 9: 0.8012820512820513
	Val acc at iteration 8: 0.6595744680851063
	Train acc at iteration 10: 0.7772435897435898
	Val acc at iteration 9: 0.7127659574468085
	Train acc at iteration 11: 0.8060897435897436
	Val acc at iteration 10: 0.6808510638297872
	Train acc at iteration 12: 0.7756410256410257
	Val acc at iteration 11: 0.6382978723404256
	Train acc at iteration 13: 0.7852564102564102
	Val acc at iteration 12: 0.6276595744680851
	Train acc at iteration 14: 0.7644230769230769
	Val acc at iteration 13: 0.6063829787234043
	Train acc at iteration 15: 0.7467948717948718
	Val acc at iteration 14: 0.6382978723404256
	Train acc at iteration 16: 0.7756410256410257
	Val acc at iteration 15: 0.6170212765957447
	Train acc at iteration 17: 0.75
	Val acc at iteration 16: 0.6702127659574468
	Train acc at iteration 18: 0.8092948717948718
	Val acc at iteration 17: 0.7446808510638298
	Train acc at iteration 19: 0.7692307692307693
	Val acc at iteration 18: 0.6702127659574468
	Train acc at iteration 20: 0.7612179487179487
	Val acc at iteration 19: 0.6382978723404256
	Train acc at iteration 21: 0.7403846153846154
	Val acc at iteration 20: 0.7021276595744681
	Train acc at iteration 22: 0.7852564102564102
	Val acc at iteration 21: 0.7340425531914894
	Train acc at iteration 23: 0.7564102564102564
	Val acc at iteration 22: 0.6276595744680851
	Train acc at iteration 24: 0.7740384615384616
	Val acc at iteration 23: 0.6595744680851063
	Train acc at iteration 25: 0.780448717948718
	Val acc at iteration 24: 0.6382978723404256
	Train acc at iteration 26: 0.8076923076923077
	Val acc at iteration 25: 0.5531914893617021
	Train acc at iteration 27: 0.782051282051282
	Val acc at iteration 26: 0.6063829787234043
	Train acc at iteration 28: 0.7868589743589743
	Val acc at iteration 27: 0.7127659574468085
	Train acc at iteration 29: 0.7772435897435898
	Val acc at iteration 28: 0.6276595744680851
	Train acc at iteration 30: 0.7692307692307693
	Val acc at iteration 29: 0.6702127659574468
	Train acc at iteration 31: 0.7516025641025641
	Val acc at iteration 30: 0.6808510638297872
	Train acc at iteration 32: 0.7980769230769231
	Val acc at iteration 31: 0.7127659574468085
	Train acc at iteration 33: 0.8269230769230769
	Val acc at iteration 32: 0.6276595744680851
	Train acc at iteration 34: 0.8125
	Val acc at iteration 33: 0.648936170212766
	Train acc at iteration 35: 0.7740384615384616
	Val acc at iteration 34: 0.6808510638297872
	Train acc at iteration 36: 0.7852564102564102
	Val acc at iteration 35: 0.6595744680851063
	Train acc at iteration 37: 0.7932692307692307
	Val acc at iteration 36: 0.648936170212766
	Train acc at iteration 38: 0.7516025641025641
	Val acc at iteration 37: 0.5851063829787234
	Train acc at iteration 39: 0.782051282051282
	Val acc at iteration 38: 0.723404255319149
	Train acc at iteration 40: 0.7708333333333334
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.7932692307692307
	Val acc at iteration 40: 0.648936170212766
	Train acc at iteration 42: 0.7900641025641025
	Val acc at iteration 41: 0.6382978723404256
	Train acc at iteration 43: 0.7868589743589743
	Val acc at iteration 42: 0.723404255319149
	Train acc at iteration 44: 0.7756410256410257
	Val acc at iteration 43: 0.5957446808510638
	Train acc at iteration 45: 0.7740384615384616
	Val acc at iteration 44: 0.6808510638297872
	Train acc at iteration 46: 0.7916666666666666
	Val acc at iteration 45: 0.6063829787234043
	Train acc at iteration 47: 0.7788461538461539
	Val acc at iteration 46: 0.648936170212766
	Train acc at iteration 48: 0.7772435897435898
	Val acc at iteration 47: 0.5957446808510638
	Train acc at iteration 49: 0.7628205128205128
	Val acc at iteration 48: 0.6170212765957447
	Train acc at iteration 50: 0.782051282051282
	Val acc at iteration 49: 0.6808510638297872
	Train acc at iteration 51: 0.7596153846153846
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.7948717948717948
	Val acc at iteration 51: 0.6382978723404256
	Train acc at iteration 53: 0.7676282051282052
	Val acc at iteration 52: 0.574468085106383
	Train acc at iteration 54: 0.7884615384615384
	Val acc at iteration 53: 0.7021276595744681
	Train acc at iteration 55: 0.7868589743589743
	Val acc at iteration 54: 0.6595744680851063
	Train acc at iteration 56: 0.7740384615384616
	Val acc at iteration 55: 0.648936170212766
	Train acc at iteration 57: 0.7708333333333334
	Val acc at iteration 56: 0.6276595744680851
	Train acc at iteration 58: 0.7916666666666666
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.7852564102564102
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.7916666666666666
	Val acc at iteration 59: 0.574468085106383
	Train acc at iteration 61: 0.7740384615384616
	Val acc at iteration 60: 0.6595744680851063
	Train acc at iteration 62: 0.7980769230769231
	Val acc at iteration 61: 0.7127659574468085
	Train acc at iteration 63: 0.7932692307692307
	Val acc at iteration 62: 0.6702127659574468
	Train acc at iteration 64: 0.7900641025641025
	Val acc at iteration 63: 0.7340425531914894
	Train acc at iteration 65: 0.780448717948718
	Val acc at iteration 64: 0.7021276595744681
	Train acc at iteration 66: 0.7532051282051282
	Val acc at iteration 65: 0.6276595744680851
	Train acc at iteration 67: 0.7772435897435898
	Val acc at iteration 66: 0.648936170212766
	Train acc at iteration 68: 0.8125
	Val acc at iteration 67: 0.6808510638297872
	Train acc at iteration 69: 0.7660256410256411
	Val acc at iteration 68: 0.6063829787234043
	Train acc at iteration 70: 0.7708333333333334
	Val acc at iteration 69: 0.7021276595744681
	Train acc at iteration 71: 0.8028846153846154
	Val acc at iteration 70: 0.6595744680851063
	Train acc at iteration 72: 0.7900641025641025
	Val acc at iteration 71: 0.6063829787234043
	Train acc at iteration 73: 0.7948717948717948
	Val acc at iteration 72: 0.6382978723404256
	Train acc at iteration 74: 0.7772435897435898
	Val acc at iteration 73: 0.7021276595744681
	Train acc at iteration 75: 0.7788461538461539
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.7596153846153846
	Val acc at iteration 75: 0.6276595744680851
	Train acc at iteration 77: 0.7916666666666666
	Val acc at iteration 76: 0.6702127659574468
	Train acc at iteration 78: 0.7900641025641025
	Val acc at iteration 77: 0.6808510638297872
	Train acc at iteration 79: 0.7916666666666666
	Val acc at iteration 78: 0.6595744680851063
	Train acc at iteration 80: 0.7724358974358975
	Val acc at iteration 79: 0.7127659574468085
	Train acc at iteration 81: 0.7868589743589743
	Val acc at iteration 80: 0.5957446808510638
	Train acc at iteration 82: 0.7852564102564102
	Val acc at iteration 81: 0.6276595744680851
	Train acc at iteration 83: 0.7788461538461539
	Val acc at iteration 82: 0.6382978723404256
	Train acc at iteration 84: 0.8012820512820513
	Val acc at iteration 83: 0.6063829787234043
	Train acc at iteration 85: 0.7740384615384616
	Val acc at iteration 84: 0.648936170212766
	Train acc at iteration 86: 0.7788461538461539
	Val acc at iteration 85: 0.6702127659574468
	Train acc at iteration 87: 0.7852564102564102
	Val acc at iteration 86: 0.6595744680851063
	Train acc at iteration 88: 0.7740384615384616
	Val acc at iteration 87: 0.6702127659574468
	Train acc at iteration 89: 0.7692307692307693
	Val acc at iteration 88: 0.6170212765957447
	Train acc at iteration 90: 0.7756410256410257
	Val acc at iteration 89: 0.723404255319149
	Train acc at iteration 91: 0.780448717948718
	Val acc at iteration 90: 0.6170212765957447
	Train acc at iteration 92: 0.7708333333333334
	Val acc at iteration 91: 0.6808510638297872
	Train acc at iteration 93: 0.7564102564102564
	Val acc at iteration 92: 0.648936170212766
	Train acc at iteration 94: 0.780448717948718
	Val acc at iteration 93: 0.6170212765957447
	Train acc at iteration 95: 0.7884615384615384
	Val acc at iteration 94: 0.6276595744680851
	Train acc at iteration 96: 0.7916666666666666
	Val acc at iteration 95: 0.6382978723404256
	Train acc at iteration 97: 0.7740384615384616
	Val acc at iteration 96: 0.7021276595744681
	Train acc at iteration 98: 0.7740384615384616
	Val acc at iteration 97: 0.6914893617021277
	Train acc at iteration 99: 0.7948717948717948
	Val acc at iteration 98: 0.7021276595744681
	Train acc at iteration 100: 0.7692307692307693
	Val acc at iteration 99: 0.6702127659574468
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5419243986254296
Final val micro accuracy: 0.648936170212766
Final test macro f1-score: 0.4816479400749063
Final test micro accuracy: 0.6170212765957447
Final validation:
	Cluster: 0.6099023818969727
	Separation: 0.5484155714511871
Final test:
	Cluster: 0.6018961071968079
	Separation: 0.5382501184940338
Saved Results

Attempting combination 34/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 24.0
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3617021276595745
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9574468085106383
Push epoch
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Cluster: 0.6496069073677063
	Separation: 0.522428286075592
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.7553191489361702
	Val acc at iteration 2: 0.7978723404255319
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.648936170212766
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.7446808510638298
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.7659574468085106
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.776595744680851
	Val acc at iteration 26: 0.7659574468085106
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.6170212765957447
	Val acc at iteration 30: 0.6170212765957447
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.6808510638297872
	Val acc at iteration 40: 0.7978723404255319
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.7872340425531915
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.7446808510638298
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.6276595744680851
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7553191489361702
	Val acc at iteration 85: 0.7446808510638298
	Val acc at iteration 86: 0.6276595744680851
	Val acc at iteration 87: 0.7446808510638298
	Val acc at iteration 88: 0.6808510638297872
	Val acc at iteration 89: 0.6914893617021277
	Val acc at iteration 90: 0.7446808510638298
	Val acc at iteration 91: 0.7021276595744681
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.6808510638297872
	Val acc at iteration 94: 0.7553191489361702
	Val acc at iteration 95: 0.7872340425531915
	Val acc at iteration 96: 0.723404255319149
	Val acc at iteration 97: 0.6914893617021277
	Val acc at iteration 98: 0.6808510638297872
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 16: 0.723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9680851063829787
Push epoch
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Cluster: 0.6555836915969848
	Separation: 0.5222202420234681
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.8191489361702128
	Val acc at iteration 1: 0.776595744680851
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.7021276595744681
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.6063829787234043
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.776595744680851
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.776595744680851
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.7553191489361702
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.8191489361702128
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.776595744680851
	Val acc at iteration 43: 0.7659574468085106
	Val acc at iteration 44: 0.7872340425531915
	Val acc at iteration 45: 0.7872340425531915
	Val acc at iteration 46: 0.7978723404255319
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.851063829787234
	Val acc at iteration 49: 0.7659574468085106
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.7978723404255319
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.776595744680851
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7872340425531915
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.7127659574468085
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.6170212765957447
	Val acc at iteration 77: 0.7340425531914894
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.7446808510638298
	Val acc at iteration 86: 0.7978723404255319
	Val acc at iteration 87: 0.6702127659574468
	Val acc at iteration 88: 0.7553191489361702
	Val acc at iteration 89: 0.7872340425531915
	Val acc at iteration 90: 0.7021276595744681
	Val acc at iteration 91: 0.8191489361702128
	Val acc at iteration 92: 0.723404255319149
	Val acc at iteration 93: 0.7340425531914894
	Val acc at iteration 94: 0.7553191489361702
	Val acc at iteration 95: 0.7978723404255319
	Val acc at iteration 96: 0.7340425531914894
	Val acc at iteration 97: 0.7659574468085106
	Val acc at iteration 98: 0.723404255319149
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 26: 0.7872340425531915
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.776595744680851
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8829787234042553
Stopping after epoch 36.
Final validation accuracy before push: 88.29787234042553%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8301282051282052
	Cluster: 0.6616987705230712
	Separation: 0.5234225869178772
(After push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8269230769230769
	Val acc at iteration 0: 0.776595744680851
	Train acc at iteration 2: 0.8621794871794872
	Val acc at iteration 1: 0.7340425531914894
	Train acc at iteration 3: 0.8092948717948718
	Val acc at iteration 2: 0.8085106382978723
	Train acc at iteration 4: 0.8237179487179487
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.8237179487179487
	Val acc at iteration 4: 0.6808510638297872
	Train acc at iteration 6: 0.8269230769230769
	Val acc at iteration 5: 0.7340425531914894
	Train acc at iteration 7: 0.8189102564102564
	Val acc at iteration 6: 0.7553191489361702
	Train acc at iteration 8: 0.8076923076923077
	Val acc at iteration 7: 0.7340425531914894
	Train acc at iteration 9: 0.8253205128205128
	Val acc at iteration 8: 0.8191489361702128
	Train acc at iteration 10: 0.8173076923076923
	Val acc at iteration 9: 0.7553191489361702
	Train acc at iteration 11: 0.8076923076923077
	Val acc at iteration 10: 0.7340425531914894
	Train acc at iteration 12: 0.8285256410256411
	Val acc at iteration 11: 0.648936170212766
	Train acc at iteration 13: 0.8301282051282052
	Val acc at iteration 12: 0.7553191489361702
	Train acc at iteration 14: 0.8157051282051282
	Val acc at iteration 13: 0.7127659574468085
	Train acc at iteration 15: 0.8028846153846154
	Val acc at iteration 14: 0.7340425531914894
	Train acc at iteration 16: 0.8413461538461539
	Val acc at iteration 15: 0.7340425531914894
	Train acc at iteration 17: 0.8269230769230769
	Val acc at iteration 16: 0.7446808510638298
	Train acc at iteration 18: 0.8205128205128205
	Val acc at iteration 17: 0.7553191489361702
	Train acc at iteration 19: 0.8125
	Val acc at iteration 18: 0.648936170212766
	Train acc at iteration 20: 0.8269230769230769
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.8365384615384616
	Val acc at iteration 20: 0.7021276595744681
	Train acc at iteration 22: 0.8060897435897436
	Val acc at iteration 21: 0.7340425531914894
	Train acc at iteration 23: 0.8317307692307693
	Val acc at iteration 22: 0.7659574468085106
	Train acc at iteration 24: 0.8221153846153846
	Val acc at iteration 23: 0.7446808510638298
	Train acc at iteration 25: 0.844551282051282
	Val acc at iteration 24: 0.8297872340425532
	Train acc at iteration 26: 0.8253205128205128
	Val acc at iteration 25: 0.6170212765957447
	Train acc at iteration 27: 0.8381410256410257
	Val acc at iteration 26: 0.7127659574468085
	Train acc at iteration 28: 0.8060897435897436
	Val acc at iteration 27: 0.7978723404255319
	Train acc at iteration 29: 0.8349358974358975
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.8413461538461539
	Val acc at iteration 29: 0.723404255319149
	Train acc at iteration 31: 0.8060897435897436
	Val acc at iteration 30: 0.723404255319149
	Train acc at iteration 32: 0.8125
	Val acc at iteration 31: 0.7659574468085106
	Train acc at iteration 33: 0.8205128205128205
	Val acc at iteration 32: 0.8085106382978723
	Train acc at iteration 34: 0.8173076923076923
	Val acc at iteration 33: 0.7659574468085106
	Train acc at iteration 35: 0.8349358974358975
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.8333333333333334
	Val acc at iteration 35: 0.8191489361702128
	Train acc at iteration 37: 0.8125
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.8076923076923077
	Val acc at iteration 37: 0.7659574468085106
	Train acc at iteration 39: 0.8333333333333334
	Val acc at iteration 38: 0.6382978723404256
	Train acc at iteration 40: 0.8301282051282052
	Val acc at iteration 39: 0.7659574468085106
	Train acc at iteration 41: 0.8108974358974359
	Val acc at iteration 40: 0.6808510638297872
	Train acc at iteration 42: 0.8269230769230769
	Val acc at iteration 41: 0.6702127659574468
	Train acc at iteration 43: 0.8317307692307693
	Val acc at iteration 42: 0.7446808510638298
	Train acc at iteration 44: 0.8125
	Val acc at iteration 43: 0.648936170212766
	Train acc at iteration 45: 0.8253205128205128
	Val acc at iteration 44: 0.776595744680851
	Train acc at iteration 46: 0.8333333333333334
	Val acc at iteration 45: 0.7978723404255319
	Train acc at iteration 47: 0.8076923076923077
	Val acc at iteration 46: 0.7340425531914894
	Train acc at iteration 48: 0.8108974358974359
	Val acc at iteration 47: 0.7127659574468085
	Train acc at iteration 49: 0.8333333333333334
	Val acc at iteration 48: 0.7446808510638298
	Train acc at iteration 50: 0.8044871794871795
	Val acc at iteration 49: 0.6808510638297872
	Train acc at iteration 51: 0.8028846153846154
	Val acc at iteration 50: 0.7872340425531915
	Train acc at iteration 52: 0.8237179487179487
	Val acc at iteration 51: 0.7978723404255319
	Train acc at iteration 53: 0.8349358974358975
	Val acc at iteration 52: 0.6382978723404256
	Train acc at iteration 54: 0.8541666666666666
	Val acc at iteration 53: 0.7659574468085106
	Train acc at iteration 55: 0.8269230769230769
	Val acc at iteration 54: 0.7127659574468085
	Train acc at iteration 56: 0.8173076923076923
	Val acc at iteration 55: 0.7340425531914894
	Train acc at iteration 57: 0.8237179487179487
	Val acc at iteration 56: 0.6382978723404256
	Train acc at iteration 58: 0.8365384615384616
	Val acc at iteration 57: 0.8085106382978723
	Train acc at iteration 59: 0.8461538461538461
	Val acc at iteration 58: 0.7553191489361702
	Train acc at iteration 60: 0.8157051282051282
	Val acc at iteration 59: 0.7553191489361702
	Train acc at iteration 61: 0.8076923076923077
	Val acc at iteration 60: 0.648936170212766
	Train acc at iteration 62: 0.8381410256410257
	Val acc at iteration 61: 0.7872340425531915
	Train acc at iteration 63: 0.8253205128205128
	Val acc at iteration 62: 0.7340425531914894
	Train acc at iteration 64: 0.8541666666666666
	Val acc at iteration 63: 0.7978723404255319
	Train acc at iteration 65: 0.8381410256410257
	Val acc at iteration 64: 0.7872340425531915
	Train acc at iteration 66: 0.8397435897435898
	Val acc at iteration 65: 0.6808510638297872
	Train acc at iteration 67: 0.8092948717948718
	Val acc at iteration 66: 0.7021276595744681
	Train acc at iteration 68: 0.7932692307692307
	Val acc at iteration 67: 0.7127659574468085
	Train acc at iteration 69: 0.8269230769230769
	Val acc at iteration 68: 0.7340425531914894
	Train acc at iteration 70: 0.8092948717948718
	Val acc at iteration 69: 0.7446808510638298
	Train acc at iteration 71: 0.8076923076923077
	Val acc at iteration 70: 0.7340425531914894
	Train acc at iteration 72: 0.8173076923076923
	Val acc at iteration 71: 0.7127659574468085
	Train acc at iteration 73: 0.8285256410256411
	Val acc at iteration 72: 0.723404255319149
	Train acc at iteration 74: 0.8221153846153846
	Val acc at iteration 73: 0.776595744680851
	Train acc at iteration 75: 0.8301282051282052
	Val acc at iteration 74: 0.6702127659574468
	Train acc at iteration 76: 0.8205128205128205
	Val acc at iteration 75: 0.7127659574468085
	Train acc at iteration 77: 0.842948717948718
	Val acc at iteration 76: 0.7553191489361702
	Train acc at iteration 78: 0.8589743589743589
	Val acc at iteration 77: 0.6914893617021277
	Train acc at iteration 79: 0.8012820512820513
	Val acc at iteration 78: 0.7340425531914894
	Train acc at iteration 80: 0.8108974358974359
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.8205128205128205
	Val acc at iteration 80: 0.7553191489361702
	Train acc at iteration 82: 0.8253205128205128
	Val acc at iteration 81: 0.7872340425531915
	Train acc at iteration 83: 0.8157051282051282
	Val acc at iteration 82: 0.7659574468085106
	Train acc at iteration 84: 0.8205128205128205
	Val acc at iteration 83: 0.7340425531914894
	Train acc at iteration 85: 0.8125
	Val acc at iteration 84: 0.7872340425531915
	Train acc at iteration 86: 0.8205128205128205
	Val acc at iteration 85: 0.7553191489361702
	Train acc at iteration 87: 0.8205128205128205
	Val acc at iteration 86: 0.648936170212766
	Train acc at iteration 88: 0.8237179487179487
	Val acc at iteration 87: 0.648936170212766
	Train acc at iteration 89: 0.8317307692307693
	Val acc at iteration 88: 0.6914893617021277
	Train acc at iteration 90: 0.782051282051282
	Val acc at iteration 89: 0.6914893617021277
	Train acc at iteration 91: 0.8189102564102564
	Val acc at iteration 90: 0.7127659574468085
	Train acc at iteration 92: 0.8060897435897436
	Val acc at iteration 91: 0.7659574468085106
	Train acc at iteration 93: 0.8269230769230769
	Val acc at iteration 92: 0.6914893617021277
	Train acc at iteration 94: 0.8365384615384616
	Val acc at iteration 93: 0.723404255319149
	Train acc at iteration 95: 0.8349358974358975
	Val acc at iteration 94: 0.8297872340425532
	Train acc at iteration 96: 0.8333333333333334
	Val acc at iteration 95: 0.7021276595744681
	Train acc at iteration 97: 0.8125
	Val acc at iteration 96: 0.723404255319149
	Train acc at iteration 98: 0.8092948717948718
	Val acc at iteration 97: 0.7127659574468085
	Train acc at iteration 99: 0.8060897435897436
	Val acc at iteration 98: 0.7340425531914894
	Train acc at iteration 100: 0.8141025641025641
	Val acc at iteration 99: 0.7446808510638298
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5918367346938774
Final val micro accuracy: 0.7021276595744681
Final test macro f1-score: 0.5017921146953405
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6202951669692993
	Separation: 0.5349298715591431
Final test:
	Cluster: 0.60753133893013
	Separation: 0.5389705002307892
Saved Results

Attempting combination 35/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 2.4
l1_weight: 10
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.776595744680851
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Cluster: 0.6462807774543762
	Separation: 0.5202388644218445
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6382978723404256
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.6170212765957447
	Val acc at iteration 12: 0.574468085106383
	Val acc at iteration 13: 0.6276595744680851
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.5851063829787234
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.6063829787234043
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.6063829787234043
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6170212765957447
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.6276595744680851
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.7978723404255319
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.6382978723404256
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.648936170212766
	Val acc at iteration 54: 0.6276595744680851
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6276595744680851
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.6170212765957447
	Val acc at iteration 68: 0.6170212765957447
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.6382978723404256
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.7659574468085106
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.7553191489361702
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.6382978723404256
	Val acc at iteration 87: 0.6702127659574468
	Val acc at iteration 88: 0.6382978723404256
	Val acc at iteration 89: 0.6595744680851063
	Val acc at iteration 90: 0.7553191489361702
	Val acc at iteration 91: 0.6702127659574468
	Val acc at iteration 92: 0.6595744680851063
	Val acc at iteration 93: 0.7127659574468085
	Val acc at iteration 94: 0.6702127659574468
	Val acc at iteration 95: 0.7659574468085106
	Val acc at iteration 96: 0.7127659574468085
	Val acc at iteration 97: 0.7127659574468085
	Val acc at iteration 98: 0.7553191489361702
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 16: 0.6170212765957447
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8092948717948718
	Cluster: 0.6592549681663513
	Separation: 0.5176564216613769
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.5957446808510638
	Val acc at iteration 17: 0.6170212765957447
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.5957446808510638
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.5638297872340425
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.5851063829787234
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.648936170212766
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.6063829787234043
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.5957446808510638
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6276595744680851
	Val acc at iteration 71: 0.5638297872340425
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.7446808510638298
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.6063829787234043
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.6170212765957447
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.6914893617021277
	Val acc at iteration 87: 0.6170212765957447
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.6382978723404256
	Val acc at iteration 90: 0.7127659574468085
	Val acc at iteration 91: 0.6702127659574468
	Val acc at iteration 92: 0.7978723404255319
	Val acc at iteration 93: 0.6808510638297872
	Val acc at iteration 94: 0.6808510638297872
	Val acc at iteration 95: 0.6808510638297872
	Val acc at iteration 96: 0.7127659574468085
	Val acc at iteration 97: 0.6170212765957447
	Val acc at iteration 98: 0.648936170212766
	Val acc at iteration 99: 0.7021276595744681
Val acc before epoch 26: 0.7021276595744681
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7872340425531915
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9361702127659575
Stopping after epoch 36.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Cluster: 0.6532352089881897
	Separation: 0.5229451179504394
(After push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7948717948717948
	Val acc at iteration 0: 0.7659574468085106
	Train acc at iteration 2: 0.7660256410256411
	Val acc at iteration 1: 0.7446808510638298
	Train acc at iteration 3: 0.7692307692307693
	Val acc at iteration 2: 0.7340425531914894
	Train acc at iteration 4: 0.782051282051282
	Val acc at iteration 3: 0.6808510638297872
	Train acc at iteration 5: 0.7483974358974359
	Val acc at iteration 4: 0.7553191489361702
	Train acc at iteration 6: 0.7740384615384616
	Val acc at iteration 5: 0.6808510638297872
	Train acc at iteration 7: 0.7996794871794872
	Val acc at iteration 6: 0.6702127659574468
	Train acc at iteration 8: 0.7836538461538461
	Val acc at iteration 7: 0.6382978723404256
	Train acc at iteration 9: 0.7612179487179487
	Val acc at iteration 8: 0.574468085106383
	Train acc at iteration 10: 0.7724358974358975
	Val acc at iteration 9: 0.8085106382978723
	Train acc at iteration 11: 0.7916666666666666
	Val acc at iteration 10: 0.6595744680851063
	Train acc at iteration 12: 0.7836538461538461
	Val acc at iteration 11: 0.6595744680851063
	Train acc at iteration 13: 0.7916666666666666
	Val acc at iteration 12: 0.6063829787234043
	Train acc at iteration 14: 0.780448717948718
	Val acc at iteration 13: 0.7127659574468085
	Train acc at iteration 15: 0.7788461538461539
	Val acc at iteration 14: 0.648936170212766
	Train acc at iteration 16: 0.7740384615384616
	Val acc at iteration 15: 0.6276595744680851
	Train acc at iteration 17: 0.7692307692307693
	Val acc at iteration 16: 0.6702127659574468
	Train acc at iteration 18: 0.7756410256410257
	Val acc at iteration 17: 0.6595744680851063
	Train acc at iteration 19: 0.7708333333333334
	Val acc at iteration 18: 0.6808510638297872
	Train acc at iteration 20: 0.7900641025641025
	Val acc at iteration 19: 0.6808510638297872
	Train acc at iteration 21: 0.7836538461538461
	Val acc at iteration 20: 0.6914893617021277
	Train acc at iteration 22: 0.7756410256410257
	Val acc at iteration 21: 0.7340425531914894
	Train acc at iteration 23: 0.8028846153846154
	Val acc at iteration 22: 0.648936170212766
	Train acc at iteration 24: 0.7708333333333334
	Val acc at iteration 23: 0.6382978723404256
	Train acc at iteration 25: 0.7788461538461539
	Val acc at iteration 24: 0.6808510638297872
	Train acc at iteration 26: 0.7628205128205128
	Val acc at iteration 25: 0.6595744680851063
	Train acc at iteration 27: 0.7868589743589743
	Val acc at iteration 26: 0.7021276595744681
	Train acc at iteration 28: 0.7612179487179487
	Val acc at iteration 27: 0.6276595744680851
	Train acc at iteration 29: 0.7836538461538461
	Val acc at iteration 28: 0.5638297872340425
	Train acc at iteration 30: 0.7532051282051282
	Val acc at iteration 29: 0.7127659574468085
	Train acc at iteration 31: 0.7740384615384616
	Val acc at iteration 30: 0.7127659574468085
	Train acc at iteration 32: 0.8125
	Val acc at iteration 31: 0.648936170212766
	Train acc at iteration 33: 0.7483974358974359
	Val acc at iteration 32: 0.7127659574468085
	Train acc at iteration 34: 0.782051282051282
	Val acc at iteration 33: 0.723404255319149
	Train acc at iteration 35: 0.7532051282051282
	Val acc at iteration 34: 0.6382978723404256
	Train acc at iteration 36: 0.7916666666666666
	Val acc at iteration 35: 0.6170212765957447
	Train acc at iteration 37: 0.7852564102564102
	Val acc at iteration 36: 0.7127659574468085
	Train acc at iteration 38: 0.7692307692307693
	Val acc at iteration 37: 0.6382978723404256
	Train acc at iteration 39: 0.7660256410256411
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.7772435897435898
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.780448717948718
	Val acc at iteration 40: 0.7021276595744681
	Train acc at iteration 42: 0.7676282051282052
	Val acc at iteration 41: 0.6808510638297872
	Train acc at iteration 43: 0.7868589743589743
	Val acc at iteration 42: 0.6702127659574468
	Train acc at iteration 44: 0.7692307692307693
	Val acc at iteration 43: 0.6276595744680851
	Train acc at iteration 45: 0.7772435897435898
	Val acc at iteration 44: 0.7127659574468085
	Train acc at iteration 46: 0.7852564102564102
	Val acc at iteration 45: 0.6595744680851063
	Train acc at iteration 47: 0.7916666666666666
	Val acc at iteration 46: 0.648936170212766
	Train acc at iteration 48: 0.7788461538461539
	Val acc at iteration 47: 0.723404255319149
	Train acc at iteration 49: 0.8060897435897436
	Val acc at iteration 48: 0.7021276595744681
	Train acc at iteration 50: 0.7580128205128205
	Val acc at iteration 49: 0.7446808510638298
	Train acc at iteration 51: 0.7852564102564102
	Val acc at iteration 50: 0.7340425531914894
	Train acc at iteration 52: 0.7676282051282052
	Val acc at iteration 51: 0.7021276595744681
	Train acc at iteration 53: 0.7788461538461539
	Val acc at iteration 52: 0.6382978723404256
	Train acc at iteration 54: 0.7676282051282052
	Val acc at iteration 53: 0.6382978723404256
	Train acc at iteration 55: 0.7980769230769231
	Val acc at iteration 54: 0.648936170212766
	Train acc at iteration 56: 0.7580128205128205
	Val acc at iteration 55: 0.6914893617021277
	Train acc at iteration 57: 0.7964743589743589
	Val acc at iteration 56: 0.648936170212766
	Train acc at iteration 58: 0.8012820512820513
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.7660256410256411
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.75
	Val acc at iteration 59: 0.6595744680851063
	Train acc at iteration 61: 0.7788461538461539
	Val acc at iteration 60: 0.6382978723404256
	Train acc at iteration 62: 0.8060897435897436
	Val acc at iteration 61: 0.6595744680851063
	Train acc at iteration 63: 0.7644230769230769
	Val acc at iteration 62: 0.6382978723404256
	Train acc at iteration 64: 0.7756410256410257
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.7628205128205128
	Val acc at iteration 64: 0.6914893617021277
	Train acc at iteration 66: 0.7788461538461539
	Val acc at iteration 65: 0.6914893617021277
	Train acc at iteration 67: 0.7900641025641025
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.7451923076923077
	Val acc at iteration 67: 0.6702127659574468
	Train acc at iteration 69: 0.7692307692307693
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.7772435897435898
	Val acc at iteration 69: 0.6382978723404256
	Train acc at iteration 71: 0.7628205128205128
	Val acc at iteration 70: 0.7127659574468085
	Train acc at iteration 72: 0.7532051282051282
	Val acc at iteration 71: 0.7127659574468085
	Train acc at iteration 73: 0.7628205128205128
	Val acc at iteration 72: 0.6808510638297872
	Train acc at iteration 74: 0.7628205128205128
	Val acc at iteration 73: 0.648936170212766
	Train acc at iteration 75: 0.7660256410256411
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.7548076923076923
	Val acc at iteration 75: 0.5531914893617021
	Train acc at iteration 77: 0.7788461538461539
	Val acc at iteration 76: 0.6702127659574468
	Train acc at iteration 78: 0.7884615384615384
	Val acc at iteration 77: 0.5638297872340425
	Train acc at iteration 79: 0.7724358974358975
	Val acc at iteration 78: 0.5851063829787234
	Train acc at iteration 80: 0.7740384615384616
	Val acc at iteration 79: 0.6595744680851063
	Train acc at iteration 81: 0.7788461538461539
	Val acc at iteration 80: 0.7021276595744681
	Train acc at iteration 82: 0.7676282051282052
	Val acc at iteration 81: 0.648936170212766
	Train acc at iteration 83: 0.7948717948717948
	Val acc at iteration 82: 0.6914893617021277
	Train acc at iteration 84: 0.8092948717948718
	Val acc at iteration 83: 0.7127659574468085
	Train acc at iteration 85: 0.7788461538461539
	Val acc at iteration 84: 0.7021276595744681
	Train acc at iteration 86: 0.7580128205128205
	Val acc at iteration 85: 0.723404255319149
	Train acc at iteration 87: 0.782051282051282
	Val acc at iteration 86: 0.6276595744680851
	Train acc at iteration 88: 0.7772435897435898
	Val acc at iteration 87: 0.723404255319149
	Train acc at iteration 89: 0.7932692307692307
	Val acc at iteration 88: 0.7021276595744681
	Train acc at iteration 90: 0.7868589743589743
	Val acc at iteration 89: 0.7340425531914894
	Train acc at iteration 91: 0.7932692307692307
	Val acc at iteration 90: 0.6276595744680851
	Train acc at iteration 92: 0.7852564102564102
	Val acc at iteration 91: 0.6276595744680851
	Train acc at iteration 93: 0.7628205128205128
	Val acc at iteration 92: 0.5957446808510638
	Train acc at iteration 94: 0.7932692307692307
	Val acc at iteration 93: 0.7872340425531915
	Train acc at iteration 95: 0.7996794871794872
	Val acc at iteration 94: 0.7127659574468085
	Train acc at iteration 96: 0.7868589743589743
	Val acc at iteration 95: 0.723404255319149
	Train acc at iteration 97: 0.7980769230769231
	Val acc at iteration 96: 0.6595744680851063
	Train acc at iteration 98: 0.8012820512820513
	Val acc at iteration 97: 0.7127659574468085
	Train acc at iteration 99: 0.7900641025641025
	Val acc at iteration 98: 0.6808510638297872
	Train acc at iteration 100: 0.7740384615384616
	Val acc at iteration 99: 0.6702127659574468
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6374570446735395
Final val micro accuracy: 0.7340425531914894
Final test macro f1-score: 0.43663003663003663
Final test micro accuracy: 0.574468085106383
Final validation:
	Cluster: 0.627421498298645
	Separation: 0.5438270568847656
Final test:
	Cluster: 0.617819756269455
	Separation: 0.5389526188373566
Saved Results

Attempting combination 36/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 2.4
l1_weight: 1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7948717948717948
	Cluster: 0.6478911399841308
	Separation: 0.5175814032554626
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.5638297872340425
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.574468085106383
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.7553191489361702
	Val acc at iteration 25: 0.6382978723404256
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.5957446808510638
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.5957446808510638
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.6170212765957447
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.6276595744680851
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.648936170212766
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.6702127659574468
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6382978723404256
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.6276595744680851
	Val acc at iteration 67: 0.6382978723404256
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6170212765957447
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.6063829787234043
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.6382978723404256
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.6382978723404256
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.7659574468085106
	Val acc at iteration 85: 0.648936170212766
	Val acc at iteration 86: 0.7127659574468085
	Val acc at iteration 87: 0.723404255319149
	Val acc at iteration 88: 0.6702127659574468
	Val acc at iteration 89: 0.6702127659574468
	Val acc at iteration 90: 0.6808510638297872
	Val acc at iteration 91: 0.648936170212766
	Val acc at iteration 92: 0.6702127659574468
	Val acc at iteration 93: 0.7021276595744681
	Val acc at iteration 94: 0.7021276595744681
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.6382978723404256
	Val acc at iteration 97: 0.6595744680851063
	Val acc at iteration 98: 0.7127659574468085
	Val acc at iteration 99: 0.648936170212766
Val acc before epoch 16: 0.7340425531914894
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9680851063829787
Push epoch
After push, before retraining last layer:
	Train acc: 0.8221153846153846
	Cluster: 0.6483266830444336
	Separation: 0.5209677457809448
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.5957446808510638
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.776595744680851
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.6276595744680851
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.6595744680851063
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.6276595744680851
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.6170212765957447
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.6382978723404256
	Val acc at iteration 67: 0.7659574468085106
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.648936170212766
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.6170212765957447
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.7127659574468085
	Val acc at iteration 87: 0.648936170212766
	Val acc at iteration 88: 0.648936170212766
	Val acc at iteration 89: 0.7340425531914894
	Val acc at iteration 90: 0.7340425531914894
	Val acc at iteration 91: 0.7340425531914894
	Val acc at iteration 92: 0.6702127659574468
	Val acc at iteration 93: 0.6063829787234043
	Val acc at iteration 94: 0.5957446808510638
	Val acc at iteration 95: 0.6276595744680851
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.6808510638297872
	Val acc at iteration 98: 0.648936170212766
	Val acc at iteration 99: 0.6276595744680851
Val acc before epoch 26: 0.6702127659574468
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9361702127659575
Stopping after epoch 36.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Cluster: 0.6548283457756042
	Separation: 0.5222251534461975
(After push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7852564102564102
	Val acc at iteration 0: 0.6702127659574468
	Train acc at iteration 2: 0.7756410256410257
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.7996794871794872
	Val acc at iteration 2: 0.7127659574468085
	Train acc at iteration 4: 0.8157051282051282
	Val acc at iteration 3: 0.6702127659574468
	Train acc at iteration 5: 0.7708333333333334
	Val acc at iteration 4: 0.648936170212766
	Train acc at iteration 6: 0.7708333333333334
	Val acc at iteration 5: 0.6808510638297872
	Train acc at iteration 7: 0.7900641025641025
	Val acc at iteration 6: 0.7021276595744681
	Train acc at iteration 8: 0.7868589743589743
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.7644230769230769
	Val acc at iteration 8: 0.648936170212766
	Train acc at iteration 10: 0.7692307692307693
	Val acc at iteration 9: 0.7340425531914894
	Train acc at iteration 11: 0.7868589743589743
	Val acc at iteration 10: 0.7021276595744681
	Train acc at iteration 12: 0.7932692307692307
	Val acc at iteration 11: 0.6914893617021277
	Train acc at iteration 13: 0.7996794871794872
	Val acc at iteration 12: 0.6276595744680851
	Train acc at iteration 14: 0.7916666666666666
	Val acc at iteration 13: 0.648936170212766
	Train acc at iteration 15: 0.7916666666666666
	Val acc at iteration 14: 0.6595744680851063
	Train acc at iteration 16: 0.7916666666666666
	Val acc at iteration 15: 0.7446808510638298
	Train acc at iteration 17: 0.8012820512820513
	Val acc at iteration 16: 0.6276595744680851
	Train acc at iteration 18: 0.7932692307692307
	Val acc at iteration 17: 0.7446808510638298
	Train acc at iteration 19: 0.7932692307692307
	Val acc at iteration 18: 0.6382978723404256
	Train acc at iteration 20: 0.7660256410256411
	Val acc at iteration 19: 0.6276595744680851
	Train acc at iteration 21: 0.8157051282051282
	Val acc at iteration 20: 0.6914893617021277
	Train acc at iteration 22: 0.7788461538461539
	Val acc at iteration 21: 0.7127659574468085
	Train acc at iteration 23: 0.7916666666666666
	Val acc at iteration 22: 0.7021276595744681
	Train acc at iteration 24: 0.7788461538461539
	Val acc at iteration 23: 0.648936170212766
	Train acc at iteration 25: 0.7900641025641025
	Val acc at iteration 24: 0.6702127659574468
	Train acc at iteration 26: 0.7868589743589743
	Val acc at iteration 25: 0.6808510638297872
	Train acc at iteration 27: 0.7788461538461539
	Val acc at iteration 26: 0.6808510638297872
	Train acc at iteration 28: 0.8125
	Val acc at iteration 27: 0.723404255319149
	Train acc at iteration 29: 0.7660256410256411
	Val acc at iteration 28: 0.7021276595744681
	Train acc at iteration 30: 0.8173076923076923
	Val acc at iteration 29: 0.6808510638297872
	Train acc at iteration 31: 0.7788461538461539
	Val acc at iteration 30: 0.7340425531914894
	Train acc at iteration 32: 0.8205128205128205
	Val acc at iteration 31: 0.7127659574468085
	Train acc at iteration 33: 0.8125
	Val acc at iteration 32: 0.6808510638297872
	Train acc at iteration 34: 0.7852564102564102
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.7932692307692307
	Val acc at iteration 34: 0.7340425531914894
	Train acc at iteration 36: 0.8060897435897436
	Val acc at iteration 35: 0.7021276595744681
	Train acc at iteration 37: 0.8076923076923077
	Val acc at iteration 36: 0.5851063829787234
	Train acc at iteration 38: 0.7964743589743589
	Val acc at iteration 37: 0.7127659574468085
	Train acc at iteration 39: 0.7836538461538461
	Val acc at iteration 38: 0.6914893617021277
	Train acc at iteration 40: 0.7628205128205128
	Val acc at iteration 39: 0.6595744680851063
	Train acc at iteration 41: 0.782051282051282
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.7900641025641025
	Val acc at iteration 41: 0.6382978723404256
	Train acc at iteration 43: 0.7852564102564102
	Val acc at iteration 42: 0.648936170212766
	Train acc at iteration 44: 0.7596153846153846
	Val acc at iteration 43: 0.6702127659574468
	Train acc at iteration 45: 0.8108974358974359
	Val acc at iteration 44: 0.6382978723404256
	Train acc at iteration 46: 0.7740384615384616
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.7932692307692307
	Val acc at iteration 46: 0.6702127659574468
	Train acc at iteration 48: 0.7900641025641025
	Val acc at iteration 47: 0.7021276595744681
	Train acc at iteration 49: 0.7996794871794872
	Val acc at iteration 48: 0.6914893617021277
	Train acc at iteration 50: 0.7980769230769231
	Val acc at iteration 49: 0.6808510638297872
	Train acc at iteration 51: 0.8269230769230769
	Val acc at iteration 50: 0.5425531914893617
	Train acc at iteration 52: 0.8269230769230769
	Val acc at iteration 51: 0.7446808510638298
	Train acc at iteration 53: 0.780448717948718
	Val acc at iteration 52: 0.6595744680851063
	Train acc at iteration 54: 0.8125
	Val acc at iteration 53: 0.6595744680851063
	Train acc at iteration 55: 0.7884615384615384
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.7772435897435898
	Val acc at iteration 55: 0.6170212765957447
	Train acc at iteration 57: 0.8141025641025641
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.780448717948718
	Val acc at iteration 57: 0.6595744680851063
	Train acc at iteration 59: 0.7692307692307693
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.8060897435897436
	Val acc at iteration 59: 0.6702127659574468
	Train acc at iteration 61: 0.7836538461538461
	Val acc at iteration 60: 0.6702127659574468
	Train acc at iteration 62: 0.7980769230769231
	Val acc at iteration 61: 0.6276595744680851
	Train acc at iteration 63: 0.7884615384615384
	Val acc at iteration 62: 0.6914893617021277
	Train acc at iteration 64: 0.8141025641025641
	Val acc at iteration 63: 0.6382978723404256
	Train acc at iteration 65: 0.7964743589743589
	Val acc at iteration 64: 0.5957446808510638
	Train acc at iteration 66: 0.7964743589743589
	Val acc at iteration 65: 0.6702127659574468
	Train acc at iteration 67: 0.7964743589743589
	Val acc at iteration 66: 0.648936170212766
	Train acc at iteration 68: 0.782051282051282
	Val acc at iteration 67: 0.7021276595744681
	Train acc at iteration 69: 0.8381410256410257
	Val acc at iteration 68: 0.7127659574468085
	Train acc at iteration 70: 0.7932692307692307
	Val acc at iteration 69: 0.7021276595744681
	Train acc at iteration 71: 0.8269230769230769
	Val acc at iteration 70: 0.6914893617021277
	Train acc at iteration 72: 0.8092948717948718
	Val acc at iteration 71: 0.6702127659574468
	Train acc at iteration 73: 0.7980769230769231
	Val acc at iteration 72: 0.6276595744680851
	Train acc at iteration 74: 0.7852564102564102
	Val acc at iteration 73: 0.5638297872340425
	Train acc at iteration 75: 0.7964743589743589
	Val acc at iteration 74: 0.6914893617021277
	Train acc at iteration 76: 0.7996794871794872
	Val acc at iteration 75: 0.6702127659574468
	Train acc at iteration 77: 0.8076923076923077
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.7884615384615384
	Val acc at iteration 77: 0.6808510638297872
	Train acc at iteration 79: 0.8028846153846154
	Val acc at iteration 78: 0.723404255319149
	Train acc at iteration 80: 0.8012820512820513
	Val acc at iteration 79: 0.6808510638297872
	Train acc at iteration 81: 0.8173076923076923
	Val acc at iteration 80: 0.6276595744680851
	Train acc at iteration 82: 0.7564102564102564
	Val acc at iteration 81: 0.6702127659574468
	Train acc at iteration 83: 0.7900641025641025
	Val acc at iteration 82: 0.6914893617021277
	Train acc at iteration 84: 0.8044871794871795
	Val acc at iteration 83: 0.648936170212766
	Train acc at iteration 85: 0.7916666666666666
	Val acc at iteration 84: 0.6808510638297872
	Train acc at iteration 86: 0.7884615384615384
	Val acc at iteration 85: 0.6702127659574468
	Train acc at iteration 87: 0.7964743589743589
	Val acc at iteration 86: 0.7021276595744681
	Train acc at iteration 88: 0.7884615384615384
	Val acc at iteration 87: 0.6808510638297872
	Train acc at iteration 89: 0.8060897435897436
	Val acc at iteration 88: 0.7021276595744681
	Train acc at iteration 90: 0.7964743589743589
	Val acc at iteration 89: 0.6170212765957447
	Train acc at iteration 91: 0.7980769230769231
	Val acc at iteration 90: 0.7340425531914894
	Train acc at iteration 92: 0.8125
	Val acc at iteration 91: 0.6595744680851063
	Train acc at iteration 93: 0.8141025641025641
	Val acc at iteration 92: 0.6276595744680851
	Train acc at iteration 94: 0.7852564102564102
	Val acc at iteration 93: 0.6914893617021277
	Train acc at iteration 95: 0.7756410256410257
	Val acc at iteration 94: 0.7021276595744681
	Train acc at iteration 96: 0.7756410256410257
	Val acc at iteration 95: 0.6276595744680851
	Train acc at iteration 97: 0.7932692307692307
	Val acc at iteration 96: 0.7340425531914894
	Train acc at iteration 98: 0.8044871794871795
	Val acc at iteration 97: 0.7021276595744681
	Train acc at iteration 99: 0.7964743589743589
	Val acc at iteration 98: 0.6914893617021277
	Train acc at iteration 100: 0.8028846153846154
	Val acc at iteration 99: 0.5957446808510638
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5513333333333333
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.5213768115942028
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6193388104438782
	Separation: 0.5339967012405396
Final test:
	Cluster: 0.6061212420463562
	Separation: 0.5318910777568817
Saved Results

Attempting combination 37/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 2.4
l1_weight: 0.1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.5319148936170213
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9680851063829787
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9787234042553191
Push epoch
After push, before retraining last layer:
	Train acc: 0.7772435897435898
	Cluster: 0.6456061124801635
	Separation: 0.5189216136932373
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.5212765957446809
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.6170212765957447
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.6063829787234043
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6170212765957447
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.6063829787234043
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.6170212765957447
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.6170212765957447
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.6170212765957447
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.6595744680851063
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.574468085106383
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.5957446808510638
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.648936170212766
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.6276595744680851
	Val acc at iteration 81: 0.6276595744680851
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.648936170212766
	Val acc at iteration 85: 0.6808510638297872
	Val acc at iteration 86: 0.6702127659574468
	Val acc at iteration 87: 0.6170212765957447
	Val acc at iteration 88: 0.6808510638297872
	Val acc at iteration 89: 0.6595744680851063
	Val acc at iteration 90: 0.6595744680851063
	Val acc at iteration 91: 0.6914893617021277
	Val acc at iteration 92: 0.7127659574468085
	Val acc at iteration 93: 0.6170212765957447
	Val acc at iteration 94: 0.7127659574468085
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.6382978723404256
	Val acc at iteration 97: 0.6702127659574468
	Val acc at iteration 98: 0.7127659574468085
	Val acc at iteration 99: 0.6382978723404256
Val acc before epoch 16: 0.7021276595744681
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7659574468085106
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9680851063829787
Push epoch
After push, before retraining last layer:
	Train acc: 0.7660256410256411
	Cluster: 0.6451758503913879
	Separation: 0.5194744348526001
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.5425531914893617
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.7446808510638298
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.6170212765957447
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6276595744680851
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.6063829787234043
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6276595744680851
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.6276595744680851
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.6276595744680851
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.6063829787234043
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.6170212765957447
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.6595744680851063
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6276595744680851
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.5957446808510638
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.6382978723404256
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.648936170212766
	Val acc at iteration 85: 0.6914893617021277
	Val acc at iteration 86: 0.6808510638297872
	Val acc at iteration 87: 0.6702127659574468
	Val acc at iteration 88: 0.6382978723404256
	Val acc at iteration 89: 0.7446808510638298
	Val acc at iteration 90: 0.6595744680851063
	Val acc at iteration 91: 0.6914893617021277
	Val acc at iteration 92: 0.648936170212766
	Val acc at iteration 93: 0.6808510638297872
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.6276595744680851
	Val acc at iteration 96: 0.6063829787234043
	Val acc at iteration 97: 0.6702127659574468
	Val acc at iteration 98: 0.6382978723404256
	Val acc at iteration 99: 0.6808510638297872
Val acc before epoch 26: 0.648936170212766
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8829787234042553
Stopping after epoch 36.
Final validation accuracy before push: 88.29787234042553%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7948717948717948
	Cluster: 0.6534854650497437
	Separation: 0.521260678768158
(After push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7868589743589743
	Val acc at iteration 0: 0.7021276595744681
	Train acc at iteration 2: 0.7932692307692307
	Val acc at iteration 1: 0.5957446808510638
	Train acc at iteration 3: 0.7884615384615384
	Val acc at iteration 2: 0.6914893617021277
	Train acc at iteration 4: 0.7772435897435898
	Val acc at iteration 3: 0.6702127659574468
	Train acc at iteration 5: 0.7692307692307693
	Val acc at iteration 4: 0.6276595744680851
	Train acc at iteration 6: 0.7996794871794872
	Val acc at iteration 5: 0.6808510638297872
	Train acc at iteration 7: 0.8044871794871795
	Val acc at iteration 6: 0.7127659574468085
	Train acc at iteration 8: 0.7612179487179487
	Val acc at iteration 7: 0.6595744680851063
	Train acc at iteration 9: 0.7980769230769231
	Val acc at iteration 8: 0.6595744680851063
	Train acc at iteration 10: 0.7852564102564102
	Val acc at iteration 9: 0.7127659574468085
	Train acc at iteration 11: 0.7772435897435898
	Val acc at iteration 10: 0.7021276595744681
	Train acc at iteration 12: 0.7580128205128205
	Val acc at iteration 11: 0.6808510638297872
	Train acc at iteration 13: 0.7612179487179487
	Val acc at iteration 12: 0.6595744680851063
	Train acc at iteration 14: 0.7916666666666666
	Val acc at iteration 13: 0.6914893617021277
	Train acc at iteration 15: 0.7772435897435898
	Val acc at iteration 14: 0.7340425531914894
	Train acc at iteration 16: 0.7836538461538461
	Val acc at iteration 15: 0.6808510638297872
	Train acc at iteration 17: 0.7948717948717948
	Val acc at iteration 16: 0.6808510638297872
	Train acc at iteration 18: 0.7932692307692307
	Val acc at iteration 17: 0.6702127659574468
	Train acc at iteration 19: 0.7467948717948718
	Val acc at iteration 18: 0.6276595744680851
	Train acc at iteration 20: 0.7964743589743589
	Val acc at iteration 19: 0.6382978723404256
	Train acc at iteration 21: 0.7948717948717948
	Val acc at iteration 20: 0.6702127659574468
	Train acc at iteration 22: 0.7868589743589743
	Val acc at iteration 21: 0.6808510638297872
	Train acc at iteration 23: 0.7964743589743589
	Val acc at iteration 22: 0.6276595744680851
	Train acc at iteration 24: 0.7756410256410257
	Val acc at iteration 23: 0.6382978723404256
	Train acc at iteration 25: 0.7772435897435898
	Val acc at iteration 24: 0.648936170212766
	Train acc at iteration 26: 0.7644230769230769
	Val acc at iteration 25: 0.7446808510638298
	Train acc at iteration 27: 0.7692307692307693
	Val acc at iteration 26: 0.6063829787234043
	Train acc at iteration 28: 0.782051282051282
	Val acc at iteration 27: 0.6382978723404256
	Train acc at iteration 29: 0.782051282051282
	Val acc at iteration 28: 0.6382978723404256
	Train acc at iteration 30: 0.7580128205128205
	Val acc at iteration 29: 0.574468085106383
	Train acc at iteration 31: 0.780448717948718
	Val acc at iteration 30: 0.6914893617021277
	Train acc at iteration 32: 0.7884615384615384
	Val acc at iteration 31: 0.723404255319149
	Train acc at iteration 33: 0.7644230769230769
	Val acc at iteration 32: 0.6382978723404256
	Train acc at iteration 34: 0.7948717948717948
	Val acc at iteration 33: 0.6808510638297872
	Train acc at iteration 35: 0.782051282051282
	Val acc at iteration 34: 0.6382978723404256
	Train acc at iteration 36: 0.7564102564102564
	Val acc at iteration 35: 0.648936170212766
	Train acc at iteration 37: 0.7724358974358975
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.7740384615384616
	Val acc at iteration 37: 0.6595744680851063
	Train acc at iteration 39: 0.7964743589743589
	Val acc at iteration 38: 0.6914893617021277
	Train acc at iteration 40: 0.7628205128205128
	Val acc at iteration 39: 0.6382978723404256
	Train acc at iteration 41: 0.7788461538461539
	Val acc at iteration 40: 0.6595744680851063
	Train acc at iteration 42: 0.7644230769230769
	Val acc at iteration 41: 0.6170212765957447
	Train acc at iteration 43: 0.7884615384615384
	Val acc at iteration 42: 0.6276595744680851
	Train acc at iteration 44: 0.7451923076923077
	Val acc at iteration 43: 0.6702127659574468
	Train acc at iteration 45: 0.7548076923076923
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.75
	Val acc at iteration 45: 0.6170212765957447
	Train acc at iteration 47: 0.7948717948717948
	Val acc at iteration 46: 0.7340425531914894
	Train acc at iteration 48: 0.7932692307692307
	Val acc at iteration 47: 0.6702127659574468
	Train acc at iteration 49: 0.7740384615384616
	Val acc at iteration 48: 0.6063829787234043
	Train acc at iteration 50: 0.7916666666666666
	Val acc at iteration 49: 0.6382978723404256
	Train acc at iteration 51: 0.7932692307692307
	Val acc at iteration 50: 0.5957446808510638
	Train acc at iteration 52: 0.7676282051282052
	Val acc at iteration 51: 0.648936170212766
	Train acc at iteration 53: 0.7676282051282052
	Val acc at iteration 52: 0.723404255319149
	Train acc at iteration 54: 0.7612179487179487
	Val acc at iteration 53: 0.6382978723404256
	Train acc at iteration 55: 0.8141025641025641
	Val acc at iteration 54: 0.648936170212766
	Train acc at iteration 56: 0.7708333333333334
	Val acc at iteration 55: 0.6063829787234043
	Train acc at iteration 57: 0.7451923076923077
	Val acc at iteration 56: 0.648936170212766
	Train acc at iteration 58: 0.7740384615384616
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.7980769230769231
	Val acc at iteration 58: 0.5957446808510638
	Train acc at iteration 60: 0.7836538461538461
	Val acc at iteration 59: 0.648936170212766
	Train acc at iteration 61: 0.7692307692307693
	Val acc at iteration 60: 0.6276595744680851
	Train acc at iteration 62: 0.7836538461538461
	Val acc at iteration 61: 0.6808510638297872
	Train acc at iteration 63: 0.7548076923076923
	Val acc at iteration 62: 0.6914893617021277
	Train acc at iteration 64: 0.7788461538461539
	Val acc at iteration 63: 0.7021276595744681
	Train acc at iteration 65: 0.7884615384615384
	Val acc at iteration 64: 0.6382978723404256
	Train acc at iteration 66: 0.7580128205128205
	Val acc at iteration 65: 0.648936170212766
	Train acc at iteration 67: 0.780448717948718
	Val acc at iteration 66: 0.6702127659574468
	Train acc at iteration 68: 0.7532051282051282
	Val acc at iteration 67: 0.5957446808510638
	Train acc at iteration 69: 0.782051282051282
	Val acc at iteration 68: 0.6276595744680851
	Train acc at iteration 70: 0.8108974358974359
	Val acc at iteration 69: 0.6382978723404256
	Train acc at iteration 71: 0.7788461538461539
	Val acc at iteration 70: 0.6914893617021277
	Train acc at iteration 72: 0.7371794871794872
	Val acc at iteration 71: 0.7021276595744681
	Train acc at iteration 73: 0.8092948717948718
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.7964743589743589
	Val acc at iteration 73: 0.6063829787234043
	Train acc at iteration 75: 0.7772435897435898
	Val acc at iteration 74: 0.723404255319149
	Train acc at iteration 76: 0.7868589743589743
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.7516025641025641
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.7676282051282052
	Val acc at iteration 77: 0.7127659574468085
	Train acc at iteration 79: 0.7580128205128205
	Val acc at iteration 78: 0.6808510638297872
	Train acc at iteration 80: 0.7676282051282052
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.7868589743589743
	Val acc at iteration 80: 0.6276595744680851
	Train acc at iteration 82: 0.7724358974358975
	Val acc at iteration 81: 0.6808510638297872
	Train acc at iteration 83: 0.7724358974358975
	Val acc at iteration 82: 0.6063829787234043
	Train acc at iteration 84: 0.7660256410256411
	Val acc at iteration 83: 0.648936170212766
	Train acc at iteration 85: 0.7948717948717948
	Val acc at iteration 84: 0.6382978723404256
	Train acc at iteration 86: 0.782051282051282
	Val acc at iteration 85: 0.648936170212766
	Train acc at iteration 87: 0.7660256410256411
	Val acc at iteration 86: 0.6914893617021277
	Train acc at iteration 88: 0.7435897435897436
	Val acc at iteration 87: 0.5957446808510638
	Train acc at iteration 89: 0.7772435897435898
	Val acc at iteration 88: 0.6808510638297872
	Train acc at iteration 90: 0.7916666666666666
	Val acc at iteration 89: 0.648936170212766
	Train acc at iteration 91: 0.7756410256410257
	Val acc at iteration 90: 0.7659574468085106
	Train acc at iteration 92: 0.7596153846153846
	Val acc at iteration 91: 0.6808510638297872
	Train acc at iteration 93: 0.7724358974358975
	Val acc at iteration 92: 0.7021276595744681
	Train acc at iteration 94: 0.7692307692307693
	Val acc at iteration 93: 0.5638297872340425
	Train acc at iteration 95: 0.7724358974358975
	Val acc at iteration 94: 0.7021276595744681
	Train acc at iteration 96: 0.7852564102564102
	Val acc at iteration 95: 0.6914893617021277
	Train acc at iteration 97: 0.7932692307692307
	Val acc at iteration 96: 0.6382978723404256
	Train acc at iteration 98: 0.7900641025641025
	Val acc at iteration 97: 0.6595744680851063
	Train acc at iteration 99: 0.7660256410256411
	Val acc at iteration 98: 0.648936170212766
	Train acc at iteration 100: 0.7772435897435898
	Val acc at iteration 99: 0.6382978723404256
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.532051282051282
Final val micro accuracy: 0.648936170212766
Final test macro f1-score: 0.4846153846153846
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.6207847893238068
	Separation: 0.5388268530368805
Final test:
	Cluster: 0.5970918536186218
	Separation: 0.5282174050807953
Saved Results

Attempting combination 38/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 2.4
l1_weight: 0.01
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.46808510638297873
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7553191489361702
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Cluster: 0.6438259601593017
	Separation: 0.5134076476097107
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.574468085106383
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.574468085106383
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6170212765957447
	Val acc at iteration 10: 0.5851063829787234
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.5531914893617021
	Val acc at iteration 16: 0.6063829787234043
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.5957446808510638
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.5957446808510638
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.5212765957446809
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.574468085106383
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.648936170212766
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6170212765957447
	Val acc at iteration 38: 0.5957446808510638
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.5851063829787234
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.6276595744680851
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.6170212765957447
	Val acc at iteration 51: 0.6170212765957447
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.574468085106383
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.5638297872340425
	Val acc at iteration 56: 0.6170212765957447
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.5851063829787234
	Val acc at iteration 62: 0.6063829787234043
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.6276595744680851
	Val acc at iteration 70: 0.6170212765957447
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.648936170212766
	Val acc at iteration 74: 0.6382978723404256
	Val acc at iteration 75: 0.5425531914893617
	Val acc at iteration 76: 0.6276595744680851
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.5957446808510638
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.6170212765957447
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.574468085106383
	Val acc at iteration 85: 0.5851063829787234
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.7446808510638298
	Val acc at iteration 88: 0.6808510638297872
	Val acc at iteration 89: 0.648936170212766
	Val acc at iteration 90: 0.648936170212766
	Val acc at iteration 91: 0.6276595744680851
	Val acc at iteration 92: 0.6595744680851063
	Val acc at iteration 93: 0.6914893617021277
	Val acc at iteration 94: 0.6808510638297872
	Val acc at iteration 95: 0.723404255319149
	Val acc at iteration 96: 0.648936170212766
	Val acc at iteration 97: 0.5957446808510638
	Val acc at iteration 98: 0.6595744680851063
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 16: 0.6914893617021277
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9680851063829787
Push epoch
After push, before retraining last layer:
	Train acc: 0.7916666666666666
	Cluster: 0.6495087265968322
	Separation: 0.5195013880729675
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.6914893617021277
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.5957446808510638
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.6170212765957447
	Val acc at iteration 18: 0.7021276595744681
	Val acc at iteration 19: 0.6170212765957447
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6170212765957447
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.6276595744680851
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6063829787234043
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.5957446808510638
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.6808510638297872
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.574468085106383
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.5638297872340425
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6276595744680851
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.6382978723404256
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6170212765957447
	Val acc at iteration 64: 0.574468085106383
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6595744680851063
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.6276595744680851
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.6063829787234043
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.5957446808510638
	Val acc at iteration 80: 0.6170212765957447
	Val acc at iteration 81: 0.6276595744680851
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.5957446808510638
	Val acc at iteration 84: 0.6808510638297872
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.6170212765957447
	Val acc at iteration 87: 0.6276595744680851
	Val acc at iteration 88: 0.723404255319149
	Val acc at iteration 89: 0.6276595744680851
	Val acc at iteration 90: 0.6702127659574468
	Val acc at iteration 91: 0.6382978723404256
	Val acc at iteration 92: 0.6914893617021277
	Val acc at iteration 93: 0.7127659574468085
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.6063829787234043
	Val acc at iteration 96: 0.6382978723404256
	Val acc at iteration 97: 0.6914893617021277
	Val acc at iteration 98: 0.6808510638297872
	Val acc at iteration 99: 0.7446808510638298
Val acc before epoch 26: 0.574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7553191489361702
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8829787234042553
Stopping after epoch 36.
Final validation accuracy before push: 88.29787234042553%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Cluster: 0.6502394199371337
	Separation: 0.5174374461174012
(After push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7580128205128205
	Val acc at iteration 0: 0.6808510638297872
	Train acc at iteration 2: 0.7916666666666666
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.782051282051282
	Val acc at iteration 2: 0.6170212765957447
	Train acc at iteration 4: 0.7676282051282052
	Val acc at iteration 3: 0.6702127659574468
	Train acc at iteration 5: 0.7772435897435898
	Val acc at iteration 4: 0.5957446808510638
	Train acc at iteration 6: 0.7740384615384616
	Val acc at iteration 5: 0.648936170212766
	Train acc at iteration 7: 0.7692307692307693
	Val acc at iteration 6: 0.5425531914893617
	Train acc at iteration 8: 0.7708333333333334
	Val acc at iteration 7: 0.6276595744680851
	Train acc at iteration 9: 0.7660256410256411
	Val acc at iteration 8: 0.6382978723404256
	Train acc at iteration 10: 0.7772435897435898
	Val acc at iteration 9: 0.6702127659574468
	Train acc at iteration 11: 0.7852564102564102
	Val acc at iteration 10: 0.6914893617021277
	Train acc at iteration 12: 0.7900641025641025
	Val acc at iteration 11: 0.6702127659574468
	Train acc at iteration 13: 0.7516025641025641
	Val acc at iteration 12: 0.6170212765957447
	Train acc at iteration 14: 0.7740384615384616
	Val acc at iteration 13: 0.5957446808510638
	Train acc at iteration 15: 0.7772435897435898
	Val acc at iteration 14: 0.648936170212766
	Train acc at iteration 16: 0.7467948717948718
	Val acc at iteration 15: 0.648936170212766
	Train acc at iteration 17: 0.7788461538461539
	Val acc at iteration 16: 0.7553191489361702
	Train acc at iteration 18: 0.7932692307692307
	Val acc at iteration 17: 0.7446808510638298
	Train acc at iteration 19: 0.7628205128205128
	Val acc at iteration 18: 0.6914893617021277
	Train acc at iteration 20: 0.7964743589743589
	Val acc at iteration 19: 0.6382978723404256
	Train acc at iteration 21: 0.7628205128205128
	Val acc at iteration 20: 0.6170212765957447
	Train acc at iteration 22: 0.7692307692307693
	Val acc at iteration 21: 0.6914893617021277
	Train acc at iteration 23: 0.8044871794871795
	Val acc at iteration 22: 0.7021276595744681
	Train acc at iteration 24: 0.7900641025641025
	Val acc at iteration 23: 0.6914893617021277
	Train acc at iteration 25: 0.7724358974358975
	Val acc at iteration 24: 0.648936170212766
	Train acc at iteration 26: 0.7692307692307693
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.7564102564102564
	Val acc at iteration 26: 0.7872340425531915
	Train acc at iteration 28: 0.7772435897435898
	Val acc at iteration 27: 0.648936170212766
	Train acc at iteration 29: 0.7916666666666666
	Val acc at iteration 28: 0.6276595744680851
	Train acc at iteration 30: 0.7564102564102564
	Val acc at iteration 29: 0.648936170212766
	Train acc at iteration 31: 0.7724358974358975
	Val acc at iteration 30: 0.574468085106383
	Train acc at iteration 32: 0.7692307692307693
	Val acc at iteration 31: 0.6595744680851063
	Train acc at iteration 33: 0.8092948717948718
	Val acc at iteration 32: 0.7127659574468085
	Train acc at iteration 34: 0.782051282051282
	Val acc at iteration 33: 0.6063829787234043
	Train acc at iteration 35: 0.7740384615384616
	Val acc at iteration 34: 0.6170212765957447
	Train acc at iteration 36: 0.782051282051282
	Val acc at iteration 35: 0.6914893617021277
	Train acc at iteration 37: 0.8044871794871795
	Val acc at iteration 36: 0.5851063829787234
	Train acc at iteration 38: 0.780448717948718
	Val acc at iteration 37: 0.7021276595744681
	Train acc at iteration 39: 0.7836538461538461
	Val acc at iteration 38: 0.6914893617021277
	Train acc at iteration 40: 0.7996794871794872
	Val acc at iteration 39: 0.6595744680851063
	Train acc at iteration 41: 0.8092948717948718
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.7756410256410257
	Val acc at iteration 41: 0.648936170212766
	Train acc at iteration 43: 0.7916666666666666
	Val acc at iteration 42: 0.723404255319149
	Train acc at iteration 44: 0.7932692307692307
	Val acc at iteration 43: 0.6702127659574468
	Train acc at iteration 45: 0.7548076923076923
	Val acc at iteration 44: 0.574468085106383
	Train acc at iteration 46: 0.782051282051282
	Val acc at iteration 45: 0.7021276595744681
	Train acc at iteration 47: 0.7580128205128205
	Val acc at iteration 46: 0.648936170212766
	Train acc at iteration 48: 0.7660256410256411
	Val acc at iteration 47: 0.6170212765957447
	Train acc at iteration 49: 0.7548076923076923
	Val acc at iteration 48: 0.648936170212766
	Train acc at iteration 50: 0.7772435897435898
	Val acc at iteration 49: 0.6276595744680851
	Train acc at iteration 51: 0.7419871794871795
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.7932692307692307
	Val acc at iteration 51: 0.6170212765957447
	Train acc at iteration 53: 0.7740384615384616
	Val acc at iteration 52: 0.648936170212766
	Train acc at iteration 54: 0.780448717948718
	Val acc at iteration 53: 0.7340425531914894
	Train acc at iteration 55: 0.7868589743589743
	Val acc at iteration 54: 0.648936170212766
	Train acc at iteration 56: 0.7708333333333334
	Val acc at iteration 55: 0.6382978723404256
	Train acc at iteration 57: 0.7580128205128205
	Val acc at iteration 56: 0.6808510638297872
	Train acc at iteration 58: 0.780448717948718
	Val acc at iteration 57: 0.6808510638297872
	Train acc at iteration 59: 0.7548076923076923
	Val acc at iteration 58: 0.6276595744680851
	Train acc at iteration 60: 0.7836538461538461
	Val acc at iteration 59: 0.6382978723404256
	Train acc at iteration 61: 0.7788461538461539
	Val acc at iteration 60: 0.7021276595744681
	Train acc at iteration 62: 0.7676282051282052
	Val acc at iteration 61: 0.6808510638297872
	Train acc at iteration 63: 0.7708333333333334
	Val acc at iteration 62: 0.5425531914893617
	Train acc at iteration 64: 0.7724358974358975
	Val acc at iteration 63: 0.648936170212766
	Train acc at iteration 65: 0.7948717948717948
	Val acc at iteration 64: 0.6595744680851063
	Train acc at iteration 66: 0.7724358974358975
	Val acc at iteration 65: 0.6702127659574468
	Train acc at iteration 67: 0.7580128205128205
	Val acc at iteration 66: 0.648936170212766
	Train acc at iteration 68: 0.7612179487179487
	Val acc at iteration 67: 0.648936170212766
	Train acc at iteration 69: 0.782051282051282
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.782051282051282
	Val acc at iteration 69: 0.648936170212766
	Train acc at iteration 71: 0.780448717948718
	Val acc at iteration 70: 0.6702127659574468
	Train acc at iteration 72: 0.7852564102564102
	Val acc at iteration 71: 0.5638297872340425
	Train acc at iteration 73: 0.7756410256410257
	Val acc at iteration 72: 0.648936170212766
	Train acc at iteration 74: 0.780448717948718
	Val acc at iteration 73: 0.6170212765957447
	Train acc at iteration 75: 0.7884615384615384
	Val acc at iteration 74: 0.6382978723404256
	Train acc at iteration 76: 0.8012820512820513
	Val acc at iteration 75: 0.6382978723404256
	Train acc at iteration 77: 0.8269230769230769
	Val acc at iteration 76: 0.6382978723404256
	Train acc at iteration 78: 0.7788461538461539
	Val acc at iteration 77: 0.6702127659574468
	Train acc at iteration 79: 0.7692307692307693
	Val acc at iteration 78: 0.7340425531914894
	Train acc at iteration 80: 0.7708333333333334
	Val acc at iteration 79: 0.6276595744680851
	Train acc at iteration 81: 0.7868589743589743
	Val acc at iteration 80: 0.6170212765957447
	Train acc at iteration 82: 0.7724358974358975
	Val acc at iteration 81: 0.7021276595744681
	Train acc at iteration 83: 0.7964743589743589
	Val acc at iteration 82: 0.7021276595744681
	Train acc at iteration 84: 0.7692307692307693
	Val acc at iteration 83: 0.6063829787234043
	Train acc at iteration 85: 0.7756410256410257
	Val acc at iteration 84: 0.6595744680851063
	Train acc at iteration 86: 0.7740384615384616
	Val acc at iteration 85: 0.7340425531914894
	Train acc at iteration 87: 0.782051282051282
	Val acc at iteration 86: 0.6382978723404256
	Train acc at iteration 88: 0.7772435897435898
	Val acc at iteration 87: 0.6063829787234043
	Train acc at iteration 89: 0.7708333333333334
	Val acc at iteration 88: 0.5957446808510638
	Train acc at iteration 90: 0.8092948717948718
	Val acc at iteration 89: 0.5531914893617021
	Train acc at iteration 91: 0.7836538461538461
	Val acc at iteration 90: 0.6170212765957447
	Train acc at iteration 92: 0.7676282051282052
	Val acc at iteration 91: 0.6063829787234043
	Train acc at iteration 93: 0.7564102564102564
	Val acc at iteration 92: 0.5106382978723404
	Train acc at iteration 94: 0.7644230769230769
	Val acc at iteration 93: 0.6063829787234043
	Train acc at iteration 95: 0.7756410256410257
	Val acc at iteration 94: 0.6702127659574468
	Train acc at iteration 96: 0.7628205128205128
	Val acc at iteration 95: 0.6063829787234043
	Train acc at iteration 97: 0.7628205128205128
	Val acc at iteration 96: 0.6595744680851063
	Train acc at iteration 98: 0.7692307692307693
	Val acc at iteration 97: 0.6595744680851063
	Train acc at iteration 99: 0.7628205128205128
	Val acc at iteration 98: 0.6276595744680851
	Train acc at iteration 100: 0.7612179487179487
	Val acc at iteration 99: 0.6276595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5979381443298968
Final val micro accuracy: 0.6914893617021277
Final test macro f1-score: 0.5146067415730335
Final test micro accuracy: 0.6170212765957447
Final validation:
	Cluster: 0.6144769191741943
	Separation: 0.5395393967628479
Final test:
	Cluster: 0.6066950261592865
	Separation: 0.5387546420097351
Saved Results

Attempting combination 39/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.776595744680851
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Cluster: 0.6587688446044921
	Separation: 0.5217271208763122
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6170212765957447
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.5638297872340425
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.6276595744680851
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.6276595744680851
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.6382978723404256
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.6276595744680851
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.5531914893617021
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7659574468085106
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.648936170212766
	Val acc at iteration 87: 0.7446808510638298
	Val acc at iteration 88: 0.7340425531914894
	Val acc at iteration 89: 0.6170212765957447
	Val acc at iteration 90: 0.7978723404255319
	Val acc at iteration 91: 0.7659574468085106
	Val acc at iteration 92: 0.723404255319149
	Val acc at iteration 93: 0.6702127659574468
	Val acc at iteration 94: 0.6595744680851063
	Val acc at iteration 95: 0.6808510638297872
	Val acc at iteration 96: 0.6914893617021277
	Val acc at iteration 97: 0.6382978723404256
	Val acc at iteration 98: 0.7127659574468085
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 16: 0.6808510638297872
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8092948717948718
	Cluster: 0.6611696720123291
	Separation: 0.5268418431282044
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.5957446808510638
	Val acc at iteration 16: 0.7553191489361702
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.6170212765957447
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.6914893617021277
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.7659574468085106
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.5957446808510638
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.7340425531914894
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.7978723404255319
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.6170212765957447
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.6063829787234043
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.6382978723404256
	Val acc at iteration 77: 0.7340425531914894
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.776595744680851
	Val acc at iteration 85: 0.6914893617021277
	Val acc at iteration 86: 0.7021276595744681
	Val acc at iteration 87: 0.6702127659574468
	Val acc at iteration 88: 0.6808510638297872
	Val acc at iteration 89: 0.6808510638297872
	Val acc at iteration 90: 0.6702127659574468
	Val acc at iteration 91: 0.6595744680851063
	Val acc at iteration 92: 0.6702127659574468
	Val acc at iteration 93: 0.574468085106383
	Val acc at iteration 94: 0.6808510638297872
	Val acc at iteration 95: 0.7446808510638298
	Val acc at iteration 96: 0.648936170212766
	Val acc at iteration 97: 0.7872340425531915
	Val acc at iteration 98: 0.7659574468085106
	Val acc at iteration 99: 0.723404255319149
Val acc before epoch 26: 0.6914893617021277
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9468085106382979
Stopping after epoch 36.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7932692307692307
	Cluster: 0.6451516509056091
	Separation: 0.5209261655807496
(After push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8221153846153846
	Val acc at iteration 0: 0.6276595744680851
	Train acc at iteration 2: 0.8173076923076923
	Val acc at iteration 1: 0.648936170212766
	Train acc at iteration 3: 0.7964743589743589
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.7900641025641025
	Val acc at iteration 3: 0.6595744680851063
	Train acc at iteration 5: 0.8044871794871795
	Val acc at iteration 4: 0.7127659574468085
	Train acc at iteration 6: 0.7964743589743589
	Val acc at iteration 5: 0.7553191489361702
	Train acc at iteration 7: 0.8221153846153846
	Val acc at iteration 6: 0.6382978723404256
	Train acc at iteration 8: 0.8269230769230769
	Val acc at iteration 7: 0.6808510638297872
	Train acc at iteration 9: 0.8108974358974359
	Val acc at iteration 8: 0.6914893617021277
	Train acc at iteration 10: 0.7996794871794872
	Val acc at iteration 9: 0.6702127659574468
	Train acc at iteration 11: 0.8044871794871795
	Val acc at iteration 10: 0.6808510638297872
	Train acc at iteration 12: 0.780448717948718
	Val acc at iteration 11: 0.6276595744680851
	Train acc at iteration 13: 0.8157051282051282
	Val acc at iteration 12: 0.7659574468085106
	Train acc at iteration 14: 0.8189102564102564
	Val acc at iteration 13: 0.7021276595744681
	Train acc at iteration 15: 0.8060897435897436
	Val acc at iteration 14: 0.7127659574468085
	Train acc at iteration 16: 0.782051282051282
	Val acc at iteration 15: 0.723404255319149
	Train acc at iteration 17: 0.7980769230769231
	Val acc at iteration 16: 0.7127659574468085
	Train acc at iteration 18: 0.8012820512820513
	Val acc at iteration 17: 0.7446808510638298
	Train acc at iteration 19: 0.8044871794871795
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.8092948717948718
	Val acc at iteration 19: 0.6914893617021277
	Train acc at iteration 21: 0.8028846153846154
	Val acc at iteration 20: 0.6808510638297872
	Train acc at iteration 22: 0.8125
	Val acc at iteration 21: 0.7021276595744681
	Train acc at iteration 23: 0.7868589743589743
	Val acc at iteration 22: 0.6702127659574468
	Train acc at iteration 24: 0.7996794871794872
	Val acc at iteration 23: 0.6914893617021277
	Train acc at iteration 25: 0.8141025641025641
	Val acc at iteration 24: 0.6702127659574468
	Train acc at iteration 26: 0.8028846153846154
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.7852564102564102
	Val acc at iteration 26: 0.6914893617021277
	Train acc at iteration 28: 0.782051282051282
	Val acc at iteration 27: 0.648936170212766
	Train acc at iteration 29: 0.8044871794871795
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.8076923076923077
	Val acc at iteration 29: 0.648936170212766
	Train acc at iteration 31: 0.8108974358974359
	Val acc at iteration 30: 0.6276595744680851
	Train acc at iteration 32: 0.8333333333333334
	Val acc at iteration 31: 0.6914893617021277
	Train acc at iteration 33: 0.8092948717948718
	Val acc at iteration 32: 0.7340425531914894
	Train acc at iteration 34: 0.8189102564102564
	Val acc at iteration 33: 0.6702127659574468
	Train acc at iteration 35: 0.8028846153846154
	Val acc at iteration 34: 0.7021276595744681
	Train acc at iteration 36: 0.8205128205128205
	Val acc at iteration 35: 0.7553191489361702
	Train acc at iteration 37: 0.8269230769230769
	Val acc at iteration 36: 0.6914893617021277
	Train acc at iteration 38: 0.8157051282051282
	Val acc at iteration 37: 0.7659574468085106
	Train acc at iteration 39: 0.8076923076923077
	Val acc at iteration 38: 0.7659574468085106
	Train acc at iteration 40: 0.7980769230769231
	Val acc at iteration 39: 0.7340425531914894
	Train acc at iteration 41: 0.8125
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.8092948717948718
	Val acc at iteration 41: 0.7021276595744681
	Train acc at iteration 43: 0.8012820512820513
	Val acc at iteration 42: 0.6276595744680851
	Train acc at iteration 44: 0.8141025641025641
	Val acc at iteration 43: 0.6276595744680851
	Train acc at iteration 45: 0.8141025641025641
	Val acc at iteration 44: 0.7659574468085106
	Train acc at iteration 46: 0.7980769230769231
	Val acc at iteration 45: 0.6063829787234043
	Train acc at iteration 47: 0.7964743589743589
	Val acc at iteration 46: 0.648936170212766
	Train acc at iteration 48: 0.8173076923076923
	Val acc at iteration 47: 0.7127659574468085
	Train acc at iteration 49: 0.8157051282051282
	Val acc at iteration 48: 0.7340425531914894
	Train acc at iteration 50: 0.8060897435897436
	Val acc at iteration 49: 0.7340425531914894
	Train acc at iteration 51: 0.8141025641025641
	Val acc at iteration 50: 0.7021276595744681
	Train acc at iteration 52: 0.8060897435897436
	Val acc at iteration 51: 0.6702127659574468
	Train acc at iteration 53: 0.8189102564102564
	Val acc at iteration 52: 0.7021276595744681
	Train acc at iteration 54: 0.842948717948718
	Val acc at iteration 53: 0.648936170212766
	Train acc at iteration 55: 0.8157051282051282
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.8060897435897436
	Val acc at iteration 55: 0.7446808510638298
	Train acc at iteration 57: 0.7948717948717948
	Val acc at iteration 56: 0.7978723404255319
	Train acc at iteration 58: 0.8028846153846154
	Val acc at iteration 57: 0.6702127659574468
	Train acc at iteration 59: 0.8157051282051282
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.7692307692307693
	Val acc at iteration 59: 0.648936170212766
	Train acc at iteration 61: 0.7948717948717948
	Val acc at iteration 60: 0.6914893617021277
	Train acc at iteration 62: 0.7916666666666666
	Val acc at iteration 61: 0.776595744680851
	Train acc at iteration 63: 0.8253205128205128
	Val acc at iteration 62: 0.776595744680851
	Train acc at iteration 64: 0.8012820512820513
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.7916666666666666
	Val acc at iteration 64: 0.7021276595744681
	Train acc at iteration 66: 0.7708333333333334
	Val acc at iteration 65: 0.6808510638297872
	Train acc at iteration 67: 0.8205128205128205
	Val acc at iteration 66: 0.723404255319149
	Train acc at iteration 68: 0.8012820512820513
	Val acc at iteration 67: 0.723404255319149
	Train acc at iteration 69: 0.8012820512820513
	Val acc at iteration 68: 0.7340425531914894
	Train acc at iteration 70: 0.8060897435897436
	Val acc at iteration 69: 0.6702127659574468
	Train acc at iteration 71: 0.8028846153846154
	Val acc at iteration 70: 0.7553191489361702
	Train acc at iteration 72: 0.7932692307692307
	Val acc at iteration 71: 0.7553191489361702
	Train acc at iteration 73: 0.8012820512820513
	Val acc at iteration 72: 0.648936170212766
	Train acc at iteration 74: 0.8028846153846154
	Val acc at iteration 73: 0.6702127659574468
	Train acc at iteration 75: 0.7868589743589743
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.7948717948717948
	Val acc at iteration 75: 0.6382978723404256
	Train acc at iteration 77: 0.8253205128205128
	Val acc at iteration 76: 0.6063829787234043
	Train acc at iteration 78: 0.8221153846153846
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.8044871794871795
	Val acc at iteration 78: 0.6276595744680851
	Train acc at iteration 80: 0.8060897435897436
	Val acc at iteration 79: 0.7340425531914894
	Train acc at iteration 81: 0.7932692307692307
	Val acc at iteration 80: 0.723404255319149
	Train acc at iteration 82: 0.8173076923076923
	Val acc at iteration 81: 0.6595744680851063
	Train acc at iteration 83: 0.8173076923076923
	Val acc at iteration 82: 0.776595744680851
	Train acc at iteration 84: 0.8317307692307693
	Val acc at iteration 83: 0.6595744680851063
	Train acc at iteration 85: 0.8092948717948718
	Val acc at iteration 84: 0.648936170212766
	Train acc at iteration 86: 0.8365384615384616
	Val acc at iteration 85: 0.6914893617021277
	Train acc at iteration 87: 0.8044871794871795
	Val acc at iteration 86: 0.6702127659574468
	Train acc at iteration 88: 0.8028846153846154
	Val acc at iteration 87: 0.7021276595744681
	Train acc at iteration 89: 0.8028846153846154
	Val acc at iteration 88: 0.7978723404255319
	Train acc at iteration 90: 0.7852564102564102
	Val acc at iteration 89: 0.7127659574468085
	Train acc at iteration 91: 0.8060897435897436
	Val acc at iteration 90: 0.6702127659574468
	Train acc at iteration 92: 0.8269230769230769
	Val acc at iteration 91: 0.6382978723404256
	Train acc at iteration 93: 0.7948717948717948
	Val acc at iteration 92: 0.6914893617021277
	Train acc at iteration 94: 0.8173076923076923
	Val acc at iteration 93: 0.723404255319149
	Train acc at iteration 95: 0.8141025641025641
	Val acc at iteration 94: 0.723404255319149
	Train acc at iteration 96: 0.8108974358974359
	Val acc at iteration 95: 0.6808510638297872
	Train acc at iteration 97: 0.8044871794871795
	Val acc at iteration 96: 0.7340425531914894
	Train acc at iteration 98: 0.8237179487179487
	Val acc at iteration 97: 0.6808510638297872
	Train acc at iteration 99: 0.8253205128205128
	Val acc at iteration 98: 0.6063829787234043
	Train acc at iteration 100: 0.7868589743589743
	Val acc at iteration 99: 0.7127659574468085
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5396039603960395
Final val micro accuracy: 0.6595744680851063
Final test macro f1-score: 0.5303030303030303
Final test micro accuracy: 0.648936170212766
Final validation:
	Cluster: 0.6169525384902954
	Separation: 0.5461520552635193
Final test:
	Cluster: 0.6029735505580902
	Separation: 0.534894585609436
Saved Results

Attempting combination 40/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 0.24
l1_weight: 10
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.39361702127659576
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7978723404255319
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Cluster: 0.6567765831947326
	Separation: 0.5220156908035278
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.6914893617021277
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.5531914893617021
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6063829787234043
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.5957446808510638
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.5638297872340425
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.6382978723404256
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6276595744680851
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.5957446808510638
	Val acc at iteration 39: 0.6063829787234043
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.6063829787234043
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.5957446808510638
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.5957446808510638
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.6170212765957447
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.6382978723404256
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.6808510638297872
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.6063829787234043
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.6276595744680851
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.6382978723404256
	Val acc at iteration 77: 0.6595744680851063
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.6595744680851063
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.6170212765957447
	Val acc at iteration 85: 0.6170212765957447
	Val acc at iteration 86: 0.5638297872340425
	Val acc at iteration 87: 0.7553191489361702
	Val acc at iteration 88: 0.6914893617021277
	Val acc at iteration 89: 0.6702127659574468
	Val acc at iteration 90: 0.648936170212766
	Val acc at iteration 91: 0.7127659574468085
	Val acc at iteration 92: 0.6382978723404256
	Val acc at iteration 93: 0.6914893617021277
	Val acc at iteration 94: 0.648936170212766
	Val acc at iteration 95: 0.7021276595744681
	Val acc at iteration 96: 0.7340425531914894
	Val acc at iteration 97: 0.5957446808510638
	Val acc at iteration 98: 0.6808510638297872
	Val acc at iteration 99: 0.6063829787234043
Val acc before epoch 16: 0.648936170212766
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7852564102564102
	Cluster: 0.6379662871360778
	Separation: 0.5186149477958679
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.574468085106383
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6276595744680851
	Val acc at iteration 5: 0.6063829787234043
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.574468085106383
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.6063829787234043
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.5851063829787234
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.5957446808510638
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.6170212765957447
	Val acc at iteration 31: 0.6170212765957447
	Val acc at iteration 32: 0.6170212765957447
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6382978723404256
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.6170212765957447
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.5957446808510638
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6276595744680851
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.6063829787234043
	Val acc at iteration 47: 0.6276595744680851
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.5851063829787234
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.5638297872340425
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.6063829787234043
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.6382978723404256
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.5957446808510638
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.6382978723404256
	Val acc at iteration 73: 0.6382978723404256
	Val acc at iteration 74: 0.5851063829787234
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.6170212765957447
	Val acc at iteration 77: 0.6170212765957447
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.6276595744680851
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.6276595744680851
	Val acc at iteration 83: 0.6382978723404256
	Val acc at iteration 84: 0.6170212765957447
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.5425531914893617
	Val acc at iteration 87: 0.6702127659574468
	Val acc at iteration 88: 0.6914893617021277
	Val acc at iteration 89: 0.5851063829787234
	Val acc at iteration 90: 0.648936170212766
	Val acc at iteration 91: 0.6808510638297872
	Val acc at iteration 92: 0.723404255319149
	Val acc at iteration 93: 0.6276595744680851
	Val acc at iteration 94: 0.5638297872340425
	Val acc at iteration 95: 0.6595744680851063
	Val acc at iteration 96: 0.7446808510638298
	Val acc at iteration 97: 0.7021276595744681
	Val acc at iteration 98: 0.723404255319149
	Val acc at iteration 99: 0.7340425531914894
Val acc before epoch 26: 0.648936170212766
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7553191489361702
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9148936170212766
Stopping after epoch 36.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Cluster: 0.6517372488975525
	Separation: 0.5218415021896362
(After push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7932692307692307
	Val acc at iteration 0: 0.648936170212766
	Train acc at iteration 2: 0.7676282051282052
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.7996794871794872
	Val acc at iteration 2: 0.6382978723404256
	Train acc at iteration 4: 0.7916666666666666
	Val acc at iteration 3: 0.6276595744680851
	Train acc at iteration 5: 0.7948717948717948
	Val acc at iteration 4: 0.6276595744680851
	Train acc at iteration 6: 0.7900641025641025
	Val acc at iteration 5: 0.6276595744680851
	Train acc at iteration 7: 0.7724358974358975
	Val acc at iteration 6: 0.648936170212766
	Train acc at iteration 8: 0.7788461538461539
	Val acc at iteration 7: 0.6595744680851063
	Train acc at iteration 9: 0.7724358974358975
	Val acc at iteration 8: 0.6382978723404256
	Train acc at iteration 10: 0.7932692307692307
	Val acc at iteration 9: 0.7021276595744681
	Train acc at iteration 11: 0.782051282051282
	Val acc at iteration 10: 0.6702127659574468
	Train acc at iteration 12: 0.7612179487179487
	Val acc at iteration 11: 0.6382978723404256
	Train acc at iteration 13: 0.7724358974358975
	Val acc at iteration 12: 0.723404255319149
	Train acc at iteration 14: 0.7932692307692307
	Val acc at iteration 13: 0.6702127659574468
	Train acc at iteration 15: 0.7708333333333334
	Val acc at iteration 14: 0.7021276595744681
	Train acc at iteration 16: 0.7612179487179487
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.7996794871794872
	Val acc at iteration 16: 0.7021276595744681
	Train acc at iteration 18: 0.8125
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.7756410256410257
	Val acc at iteration 18: 0.6063829787234043
	Train acc at iteration 20: 0.7932692307692307
	Val acc at iteration 19: 0.7021276595744681
	Train acc at iteration 21: 0.7756410256410257
	Val acc at iteration 20: 0.5957446808510638
	Train acc at iteration 22: 0.8189102564102564
	Val acc at iteration 21: 0.574468085106383
	Train acc at iteration 23: 0.782051282051282
	Val acc at iteration 22: 0.7127659574468085
	Train acc at iteration 24: 0.7772435897435898
	Val acc at iteration 23: 0.6170212765957447
	Train acc at iteration 25: 0.7980769230769231
	Val acc at iteration 24: 0.6702127659574468
	Train acc at iteration 26: 0.7676282051282052
	Val acc at iteration 25: 0.723404255319149
	Train acc at iteration 27: 0.7852564102564102
	Val acc at iteration 26: 0.6063829787234043
	Train acc at iteration 28: 0.7740384615384616
	Val acc at iteration 27: 0.6382978723404256
	Train acc at iteration 29: 0.7964743589743589
	Val acc at iteration 28: 0.7127659574468085
	Train acc at iteration 30: 0.7884615384615384
	Val acc at iteration 29: 0.6063829787234043
	Train acc at iteration 31: 0.7692307692307693
	Val acc at iteration 30: 0.6063829787234043
	Train acc at iteration 32: 0.7852564102564102
	Val acc at iteration 31: 0.6063829787234043
	Train acc at iteration 33: 0.7612179487179487
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.8141025641025641
	Val acc at iteration 33: 0.6595744680851063
	Train acc at iteration 35: 0.7852564102564102
	Val acc at iteration 34: 0.723404255319149
	Train acc at iteration 36: 0.7948717948717948
	Val acc at iteration 35: 0.6063829787234043
	Train acc at iteration 37: 0.7948717948717948
	Val acc at iteration 36: 0.5425531914893617
	Train acc at iteration 38: 0.7852564102564102
	Val acc at iteration 37: 0.6063829787234043
	Train acc at iteration 39: 0.7852564102564102
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.782051282051282
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.8028846153846154
	Val acc at iteration 40: 0.6808510638297872
	Train acc at iteration 42: 0.8076923076923077
	Val acc at iteration 41: 0.7021276595744681
	Train acc at iteration 43: 0.7788461538461539
	Val acc at iteration 42: 0.6702127659574468
	Train acc at iteration 44: 0.7580128205128205
	Val acc at iteration 43: 0.723404255319149
	Train acc at iteration 45: 0.7884615384615384
	Val acc at iteration 44: 0.6170212765957447
	Train acc at iteration 46: 0.7964743589743589
	Val acc at iteration 45: 0.6595744680851063
	Train acc at iteration 47: 0.7932692307692307
	Val acc at iteration 46: 0.7127659574468085
	Train acc at iteration 48: 0.7756410256410257
	Val acc at iteration 47: 0.6595744680851063
	Train acc at iteration 49: 0.8060897435897436
	Val acc at iteration 48: 0.723404255319149
	Train acc at iteration 50: 0.7772435897435898
	Val acc at iteration 49: 0.648936170212766
	Train acc at iteration 51: 0.7964743589743589
	Val acc at iteration 50: 0.6063829787234043
	Train acc at iteration 52: 0.7948717948717948
	Val acc at iteration 51: 0.5851063829787234
	Train acc at iteration 53: 0.782051282051282
	Val acc at iteration 52: 0.7872340425531915
	Train acc at iteration 54: 0.7932692307692307
	Val acc at iteration 53: 0.7021276595744681
	Train acc at iteration 55: 0.8060897435897436
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.7708333333333334
	Val acc at iteration 55: 0.5957446808510638
	Train acc at iteration 57: 0.8044871794871795
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.7836538461538461
	Val acc at iteration 57: 0.6808510638297872
	Train acc at iteration 59: 0.8060897435897436
	Val acc at iteration 58: 0.7127659574468085
	Train acc at iteration 60: 0.7948717948717948
	Val acc at iteration 59: 0.6808510638297872
	Train acc at iteration 61: 0.7996794871794872
	Val acc at iteration 60: 0.5957446808510638
	Train acc at iteration 62: 0.8044871794871795
	Val acc at iteration 61: 0.7446808510638298
	Train acc at iteration 63: 0.7916666666666666
	Val acc at iteration 62: 0.6276595744680851
	Train acc at iteration 64: 0.7692307692307693
	Val acc at iteration 63: 0.7021276595744681
	Train acc at iteration 65: 0.7884615384615384
	Val acc at iteration 64: 0.6382978723404256
	Train acc at iteration 66: 0.7964743589743589
	Val acc at iteration 65: 0.6595744680851063
	Train acc at iteration 67: 0.7724358974358975
	Val acc at iteration 66: 0.6382978723404256
	Train acc at iteration 68: 0.7708333333333334
	Val acc at iteration 67: 0.6808510638297872
	Train acc at iteration 69: 0.7932692307692307
	Val acc at iteration 68: 0.6382978723404256
	Train acc at iteration 70: 0.7932692307692307
	Val acc at iteration 69: 0.6702127659574468
	Train acc at iteration 71: 0.782051282051282
	Val acc at iteration 70: 0.6276595744680851
	Train acc at iteration 72: 0.8141025641025641
	Val acc at iteration 71: 0.6063829787234043
	Train acc at iteration 73: 0.8092948717948718
	Val acc at iteration 72: 0.7446808510638298
	Train acc at iteration 74: 0.7724358974358975
	Val acc at iteration 73: 0.6382978723404256
	Train acc at iteration 75: 0.8028846153846154
	Val acc at iteration 74: 0.6595744680851063
	Train acc at iteration 76: 0.7772435897435898
	Val acc at iteration 75: 0.7021276595744681
	Train acc at iteration 77: 0.8076923076923077
	Val acc at iteration 76: 0.7021276595744681
	Train acc at iteration 78: 0.7580128205128205
	Val acc at iteration 77: 0.6702127659574468
	Train acc at iteration 79: 0.7884615384615384
	Val acc at iteration 78: 0.6595744680851063
	Train acc at iteration 80: 0.7884615384615384
	Val acc at iteration 79: 0.6276595744680851
	Train acc at iteration 81: 0.7628205128205128
	Val acc at iteration 80: 0.6063829787234043
	Train acc at iteration 82: 0.7628205128205128
	Val acc at iteration 81: 0.6170212765957447
	Train acc at iteration 83: 0.7788461538461539
	Val acc at iteration 82: 0.6276595744680851
	Train acc at iteration 84: 0.780448717948718
	Val acc at iteration 83: 0.6595744680851063
	Train acc at iteration 85: 0.7788461538461539
	Val acc at iteration 84: 0.6063829787234043
	Train acc at iteration 86: 0.8012820512820513
	Val acc at iteration 85: 0.6702127659574468
	Train acc at iteration 87: 0.8125
	Val acc at iteration 86: 0.7446808510638298
	Train acc at iteration 88: 0.7852564102564102
	Val acc at iteration 87: 0.6808510638297872
	Train acc at iteration 89: 0.7756410256410257
	Val acc at iteration 88: 0.6702127659574468
	Train acc at iteration 90: 0.7900641025641025
	Val acc at iteration 89: 0.7021276595744681
	Train acc at iteration 91: 0.7836538461538461
	Val acc at iteration 90: 0.6382978723404256
	Train acc at iteration 92: 0.7564102564102564
	Val acc at iteration 91: 0.6276595744680851
	Train acc at iteration 93: 0.7756410256410257
	Val acc at iteration 92: 0.6808510638297872
	Train acc at iteration 94: 0.7980769230769231
	Val acc at iteration 93: 0.648936170212766
	Train acc at iteration 95: 0.7724358974358975
	Val acc at iteration 94: 0.648936170212766
	Train acc at iteration 96: 0.7692307692307693
	Val acc at iteration 95: 0.6170212765957447
	Train acc at iteration 97: 0.7916666666666666
	Val acc at iteration 96: 0.5531914893617021
	Train acc at iteration 98: 0.782051282051282
	Val acc at iteration 97: 0.6170212765957447
	Train acc at iteration 99: 0.7852564102564102
	Val acc at iteration 98: 0.6276595744680851
	Train acc at iteration 100: 0.7740384615384616
	Val acc at iteration 99: 0.5851063829787234
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5454545454545454
Final val micro accuracy: 0.648936170212766
Final test macro f1-score: 0.4531135531135531
Final test micro accuracy: 0.5531914893617021
Final validation:
	Cluster: 0.6110219061374664
	Separation: 0.5458110868930817
Final test:
	Cluster: 0.5880806148052216
	Separation: 0.5415045320987701
Saved Results

Attempting combination 41/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 0.24
l1_weight: 1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Cluster: 0.6534050345420838
	Separation: 0.5235658407211303
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.5531914893617021
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.5851063829787234
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.5957446808510638
	Val acc at iteration 14: 0.5425531914893617
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.5957446808510638
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.7659574468085106
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.6063829787234043
	Val acc at iteration 53: 0.6276595744680851
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6382978723404256
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.6382978723404256
	Val acc at iteration 67: 0.6170212765957447
	Val acc at iteration 68: 0.5957446808510638
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.5425531914893617
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.723404255319149
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.6382978723404256
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.6276595744680851
	Val acc at iteration 83: 0.6063829787234043
	Val acc at iteration 84: 0.6595744680851063
	Val acc at iteration 85: 0.5638297872340425
	Val acc at iteration 86: 0.6382978723404256
	Val acc at iteration 87: 0.7659574468085106
	Val acc at iteration 88: 0.7127659574468085
	Val acc at iteration 89: 0.7340425531914894
	Val acc at iteration 90: 0.7021276595744681
	Val acc at iteration 91: 0.5638297872340425
	Val acc at iteration 92: 0.6595744680851063
	Val acc at iteration 93: 0.648936170212766
	Val acc at iteration 94: 0.6702127659574468
	Val acc at iteration 95: 0.6914893617021277
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.7021276595744681
	Val acc at iteration 98: 0.6170212765957447
	Val acc at iteration 99: 0.6063829787234043
Val acc before epoch 16: 0.648936170212766
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7836538461538461
	Cluster: 0.6544577360153199
	Separation: 0.5216037034988403
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.6170212765957447
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.574468085106383
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.6170212765957447
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.5957446808510638
	Val acc at iteration 51: 0.723404255319149
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.648936170212766
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.6276595744680851
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.648936170212766
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.6382978723404256
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.5638297872340425
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.5851063829787234
	Val acc at iteration 66: 0.6170212765957447
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.6170212765957447
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.6595744680851063
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.648936170212766
	Val acc at iteration 82: 0.648936170212766
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.723404255319149
	Val acc at iteration 85: 0.574468085106383
	Val acc at iteration 86: 0.7127659574468085
	Val acc at iteration 87: 0.7127659574468085
	Val acc at iteration 88: 0.6808510638297872
	Val acc at iteration 89: 0.6595744680851063
	Val acc at iteration 90: 0.6808510638297872
	Val acc at iteration 91: 0.6382978723404256
	Val acc at iteration 92: 0.6702127659574468
	Val acc at iteration 93: 0.6595744680851063
	Val acc at iteration 94: 0.7340425531914894
	Val acc at iteration 95: 0.6808510638297872
	Val acc at iteration 96: 0.6276595744680851
	Val acc at iteration 97: 0.6063829787234043
	Val acc at iteration 98: 0.648936170212766
	Val acc at iteration 99: 0.6276595744680851
Val acc before epoch 26: 0.7446808510638298
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.7659574468085106
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.851063829787234
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.8936170212765957
Stopping after epoch 36.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Cluster: 0.6454582333564758
	Separation: 0.523399829864502
(After push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7836538461538461
	Val acc at iteration 0: 0.5957446808510638
	Train acc at iteration 2: 0.782051282051282
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.780448717948718
	Val acc at iteration 2: 0.6595744680851063
	Train acc at iteration 4: 0.7740384615384616
	Val acc at iteration 3: 0.648936170212766
	Train acc at iteration 5: 0.782051282051282
	Val acc at iteration 4: 0.7127659574468085
	Train acc at iteration 6: 0.7980769230769231
	Val acc at iteration 5: 0.648936170212766
	Train acc at iteration 7: 0.7948717948717948
	Val acc at iteration 6: 0.6595744680851063
	Train acc at iteration 8: 0.7676282051282052
	Val acc at iteration 7: 0.6702127659574468
	Train acc at iteration 9: 0.7692307692307693
	Val acc at iteration 8: 0.6382978723404256
	Train acc at iteration 10: 0.7852564102564102
	Val acc at iteration 9: 0.6382978723404256
	Train acc at iteration 11: 0.7868589743589743
	Val acc at iteration 10: 0.6808510638297872
	Train acc at iteration 12: 0.7628205128205128
	Val acc at iteration 11: 0.6808510638297872
	Train acc at iteration 13: 0.7756410256410257
	Val acc at iteration 12: 0.6170212765957447
	Train acc at iteration 14: 0.7483974358974359
	Val acc at iteration 13: 0.6702127659574468
	Train acc at iteration 15: 0.7980769230769231
	Val acc at iteration 14: 0.723404255319149
	Train acc at iteration 16: 0.7964743589743589
	Val acc at iteration 15: 0.6595744680851063
	Train acc at iteration 17: 0.782051282051282
	Val acc at iteration 16: 0.6808510638297872
	Train acc at iteration 18: 0.7676282051282052
	Val acc at iteration 17: 0.6702127659574468
	Train acc at iteration 19: 0.7948717948717948
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.7788461538461539
	Val acc at iteration 19: 0.6914893617021277
	Train acc at iteration 21: 0.7884615384615384
	Val acc at iteration 20: 0.6382978723404256
	Train acc at iteration 22: 0.7948717948717948
	Val acc at iteration 21: 0.6382978723404256
	Train acc at iteration 23: 0.7740384615384616
	Val acc at iteration 22: 0.6063829787234043
	Train acc at iteration 24: 0.7932692307692307
	Val acc at iteration 23: 0.6702127659574468
	Train acc at iteration 25: 0.7948717948717948
	Val acc at iteration 24: 0.6063829787234043
	Train acc at iteration 26: 0.7580128205128205
	Val acc at iteration 25: 0.6382978723404256
	Train acc at iteration 27: 0.7932692307692307
	Val acc at iteration 26: 0.7127659574468085
	Train acc at iteration 28: 0.7884615384615384
	Val acc at iteration 27: 0.6702127659574468
	Train acc at iteration 29: 0.7964743589743589
	Val acc at iteration 28: 0.648936170212766
	Train acc at iteration 30: 0.7900641025641025
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.7836538461538461
	Val acc at iteration 30: 0.5957446808510638
	Train acc at iteration 32: 0.7916666666666666
	Val acc at iteration 31: 0.648936170212766
	Train acc at iteration 33: 0.7740384615384616
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.7516025641025641
	Val acc at iteration 33: 0.6595744680851063
	Train acc at iteration 35: 0.7724358974358975
	Val acc at iteration 34: 0.648936170212766
	Train acc at iteration 36: 0.7916666666666666
	Val acc at iteration 35: 0.6170212765957447
	Train acc at iteration 37: 0.7772435897435898
	Val acc at iteration 36: 0.6702127659574468
	Train acc at iteration 38: 0.7868589743589743
	Val acc at iteration 37: 0.648936170212766
	Train acc at iteration 39: 0.7596153846153846
	Val acc at iteration 38: 0.648936170212766
	Train acc at iteration 40: 0.7884615384615384
	Val acc at iteration 39: 0.6170212765957447
	Train acc at iteration 41: 0.7660256410256411
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.7868589743589743
	Val acc at iteration 41: 0.5531914893617021
	Train acc at iteration 43: 0.75
	Val acc at iteration 42: 0.6595744680851063
	Train acc at iteration 44: 0.7756410256410257
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.782051282051282
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.7451923076923077
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.7836538461538461
	Val acc at iteration 46: 0.723404255319149
	Train acc at iteration 48: 0.8044871794871795
	Val acc at iteration 47: 0.6276595744680851
	Train acc at iteration 49: 0.7884615384615384
	Val acc at iteration 48: 0.6808510638297872
	Train acc at iteration 50: 0.7916666666666666
	Val acc at iteration 49: 0.6914893617021277
	Train acc at iteration 51: 0.7788461538461539
	Val acc at iteration 50: 0.6914893617021277
	Train acc at iteration 52: 0.782051282051282
	Val acc at iteration 51: 0.648936170212766
	Train acc at iteration 53: 0.7724358974358975
	Val acc at iteration 52: 0.6808510638297872
	Train acc at iteration 54: 0.7580128205128205
	Val acc at iteration 53: 0.6063829787234043
	Train acc at iteration 55: 0.7852564102564102
	Val acc at iteration 54: 0.6170212765957447
	Train acc at iteration 56: 0.7900641025641025
	Val acc at iteration 55: 0.6914893617021277
	Train acc at iteration 57: 0.7756410256410257
	Val acc at iteration 56: 0.7021276595744681
	Train acc at iteration 58: 0.7708333333333334
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.7724358974358975
	Val acc at iteration 58: 0.6170212765957447
	Train acc at iteration 60: 0.7964743589743589
	Val acc at iteration 59: 0.6808510638297872
	Train acc at iteration 61: 0.7676282051282052
	Val acc at iteration 60: 0.723404255319149
	Train acc at iteration 62: 0.7676282051282052
	Val acc at iteration 61: 0.6702127659574468
	Train acc at iteration 63: 0.7708333333333334
	Val acc at iteration 62: 0.6063829787234043
	Train acc at iteration 64: 0.8044871794871795
	Val acc at iteration 63: 0.6914893617021277
	Train acc at iteration 65: 0.7708333333333334
	Val acc at iteration 64: 0.6702127659574468
	Train acc at iteration 66: 0.7612179487179487
	Val acc at iteration 65: 0.6702127659574468
	Train acc at iteration 67: 0.7852564102564102
	Val acc at iteration 66: 0.6382978723404256
	Train acc at iteration 68: 0.780448717948718
	Val acc at iteration 67: 0.6382978723404256
	Train acc at iteration 69: 0.7916666666666666
	Val acc at iteration 68: 0.7446808510638298
	Train acc at iteration 70: 0.7868589743589743
	Val acc at iteration 69: 0.648936170212766
	Train acc at iteration 71: 0.7884615384615384
	Val acc at iteration 70: 0.6276595744680851
	Train acc at iteration 72: 0.7788461538461539
	Val acc at iteration 71: 0.574468085106383
	Train acc at iteration 73: 0.7628205128205128
	Val acc at iteration 72: 0.723404255319149
	Train acc at iteration 74: 0.7756410256410257
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.7900641025641025
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.7772435897435898
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.7596153846153846
	Val acc at iteration 76: 0.7659574468085106
	Train acc at iteration 78: 0.7884615384615384
	Val acc at iteration 77: 0.7340425531914894
	Train acc at iteration 79: 0.7868589743589743
	Val acc at iteration 78: 0.6276595744680851
	Train acc at iteration 80: 0.7548076923076923
	Val acc at iteration 79: 0.6702127659574468
	Train acc at iteration 81: 0.7948717948717948
	Val acc at iteration 80: 0.6170212765957447
	Train acc at iteration 82: 0.7660256410256411
	Val acc at iteration 81: 0.6276595744680851
	Train acc at iteration 83: 0.780448717948718
	Val acc at iteration 82: 0.7021276595744681
	Train acc at iteration 84: 0.7996794871794872
	Val acc at iteration 83: 0.7127659574468085
	Train acc at iteration 85: 0.7708333333333334
	Val acc at iteration 84: 0.7553191489361702
	Train acc at iteration 86: 0.7948717948717948
	Val acc at iteration 85: 0.6382978723404256
	Train acc at iteration 87: 0.7772435897435898
	Val acc at iteration 86: 0.574468085106383
	Train acc at iteration 88: 0.7916666666666666
	Val acc at iteration 87: 0.723404255319149
	Train acc at iteration 89: 0.7788461538461539
	Val acc at iteration 88: 0.7340425531914894
	Train acc at iteration 90: 0.8012820512820513
	Val acc at iteration 89: 0.6595744680851063
	Train acc at iteration 91: 0.7932692307692307
	Val acc at iteration 90: 0.7021276595744681
	Train acc at iteration 92: 0.7628205128205128
	Val acc at iteration 91: 0.5851063829787234
	Train acc at iteration 93: 0.7852564102564102
	Val acc at iteration 92: 0.648936170212766
	Train acc at iteration 94: 0.7980769230769231
	Val acc at iteration 93: 0.6595744680851063
	Train acc at iteration 95: 0.7756410256410257
	Val acc at iteration 94: 0.6382978723404256
	Train acc at iteration 96: 0.7884615384615384
	Val acc at iteration 95: 0.6914893617021277
	Train acc at iteration 97: 0.7996794871794872
	Val acc at iteration 96: 0.6914893617021277
	Train acc at iteration 98: 0.7612179487179487
	Val acc at iteration 97: 0.6595744680851063
	Train acc at iteration 99: 0.7852564102564102
	Val acc at iteration 98: 0.6170212765957447
	Train acc at iteration 100: 0.7644230769230769
	Val acc at iteration 99: 0.7021276595744681
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5343434343434342
Final val micro accuracy: 0.648936170212766
Final test macro f1-score: 0.5459770114942528
Final test micro accuracy: 0.648936170212766
Final validation:
	Cluster: 0.6287513375282288
	Separation: 0.5415434539318085
Final test:
	Cluster: 0.6142462193965912
	Separation: 0.5340131223201752
Saved Results

Attempting combination 42/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 0.24
l1_weight: 0.1
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3617021276595745
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Cluster: 0.6462289571762085
	Separation: 0.5207767963409424
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6063829787234043
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.6063829787234043
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.574468085106383
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6382978723404256
	Val acc at iteration 16: 0.574468085106383
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6382978723404256
	Val acc at iteration 26: 0.6276595744680851
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.6170212765957447
	Val acc at iteration 35: 0.6276595744680851
	Val acc at iteration 36: 0.6063829787234043
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6170212765957447
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.6170212765957447
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.6276595744680851
	Val acc at iteration 51: 0.776595744680851
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.6276595744680851
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.574468085106383
	Val acc at iteration 60: 0.6276595744680851
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6276595744680851
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.5957446808510638
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.5957446808510638
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.6595744680851063
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.6276595744680851
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.648936170212766
	Val acc at iteration 84: 0.6808510638297872
	Val acc at iteration 85: 0.6382978723404256
	Val acc at iteration 86: 0.723404255319149
	Val acc at iteration 87: 0.6170212765957447
	Val acc at iteration 88: 0.6595744680851063
	Val acc at iteration 89: 0.723404255319149
	Val acc at iteration 90: 0.6382978723404256
	Val acc at iteration 91: 0.648936170212766
	Val acc at iteration 92: 0.6382978723404256
	Val acc at iteration 93: 0.5957446808510638
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.6808510638297872
	Val acc at iteration 96: 0.6170212765957447
	Val acc at iteration 97: 0.6914893617021277
	Val acc at iteration 98: 0.7021276595744681
	Val acc at iteration 99: 0.574468085106383
Val acc before epoch 16: 0.6063829787234043
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Cluster: 0.6490512490272522
	Separation: 0.5233521938323975
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.5957446808510638
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.574468085106383
	Val acc at iteration 7: 0.5957446808510638
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.5425531914893617
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6276595744680851
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.6170212765957447
	Val acc at iteration 15: 0.6382978723404256
	Val acc at iteration 16: 0.6063829787234043
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.5957446808510638
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.6063829787234043
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.5638297872340425
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6276595744680851
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.5957446808510638
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.6063829787234043
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.6382978723404256
	Val acc at iteration 42: 0.6170212765957447
	Val acc at iteration 43: 0.6170212765957447
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.6276595744680851
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.574468085106383
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.5851063829787234
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.5851063829787234
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6170212765957447
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.6382978723404256
	Val acc at iteration 63: 0.6382978723404256
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.6063829787234043
	Val acc at iteration 67: 0.5425531914893617
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.5957446808510638
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.648936170212766
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.6063829787234043
	Val acc at iteration 78: 0.6382978723404256
	Val acc at iteration 79: 0.6595744680851063
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.6702127659574468
	Val acc at iteration 85: 0.6702127659574468
	Val acc at iteration 86: 0.6170212765957447
	Val acc at iteration 87: 0.6276595744680851
	Val acc at iteration 88: 0.6382978723404256
	Val acc at iteration 89: 0.5531914893617021
	Val acc at iteration 90: 0.648936170212766
	Val acc at iteration 91: 0.648936170212766
	Val acc at iteration 92: 0.6382978723404256
	Val acc at iteration 93: 0.6382978723404256
	Val acc at iteration 94: 0.6276595744680851
	Val acc at iteration 95: 0.6702127659574468
	Val acc at iteration 96: 0.6808510638297872
	Val acc at iteration 97: 0.6276595744680851
	Val acc at iteration 98: 0.6702127659574468
	Val acc at iteration 99: 0.6382978723404256
Val acc before epoch 26: 0.6808510638297872
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.776595744680851
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8191489361702128
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9361702127659575
Stopping after epoch 36.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Cluster: 0.6484929919242859
	Separation: 0.5218544960021972
(After push) Val acc at iteration 0: 0.5425531914893617
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7564102564102564
	Val acc at iteration 0: 0.6702127659574468
	Train acc at iteration 2: 0.7467948717948718
	Val acc at iteration 1: 0.6595744680851063
	Train acc at iteration 3: 0.7692307692307693
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.8108974358974359
	Val acc at iteration 3: 0.6276595744680851
	Train acc at iteration 5: 0.780448717948718
	Val acc at iteration 4: 0.6382978723404256
	Train acc at iteration 6: 0.7916666666666666
	Val acc at iteration 5: 0.6170212765957447
	Train acc at iteration 7: 0.7676282051282052
	Val acc at iteration 6: 0.6382978723404256
	Train acc at iteration 8: 0.7660256410256411
	Val acc at iteration 7: 0.6595744680851063
	Train acc at iteration 9: 0.8044871794871795
	Val acc at iteration 8: 0.6702127659574468
	Train acc at iteration 10: 0.7852564102564102
	Val acc at iteration 9: 0.648936170212766
	Train acc at iteration 11: 0.7740384615384616
	Val acc at iteration 10: 0.7021276595744681
	Train acc at iteration 12: 0.7740384615384616
	Val acc at iteration 11: 0.648936170212766
	Train acc at iteration 13: 0.7676282051282052
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.7724358974358975
	Val acc at iteration 13: 0.5957446808510638
	Train acc at iteration 15: 0.7676282051282052
	Val acc at iteration 14: 0.6808510638297872
	Train acc at iteration 16: 0.7932692307692307
	Val acc at iteration 15: 0.5957446808510638
	Train acc at iteration 17: 0.7756410256410257
	Val acc at iteration 16: 0.6702127659574468
	Train acc at iteration 18: 0.7884615384615384
	Val acc at iteration 17: 0.6702127659574468
	Train acc at iteration 19: 0.7788461538461539
	Val acc at iteration 18: 0.6808510638297872
	Train acc at iteration 20: 0.7708333333333334
	Val acc at iteration 19: 0.6063829787234043
	Train acc at iteration 21: 0.7532051282051282
	Val acc at iteration 20: 0.6063829787234043
	Train acc at iteration 22: 0.7612179487179487
	Val acc at iteration 21: 0.6702127659574468
	Train acc at iteration 23: 0.7516025641025641
	Val acc at iteration 22: 0.6170212765957447
	Train acc at iteration 24: 0.7756410256410257
	Val acc at iteration 23: 0.6914893617021277
	Train acc at iteration 25: 0.7932692307692307
	Val acc at iteration 24: 0.6170212765957447
	Train acc at iteration 26: 0.7740384615384616
	Val acc at iteration 25: 0.6808510638297872
	Train acc at iteration 27: 0.7868589743589743
	Val acc at iteration 26: 0.6914893617021277
	Train acc at iteration 28: 0.7964743589743589
	Val acc at iteration 27: 0.648936170212766
	Train acc at iteration 29: 0.7532051282051282
	Val acc at iteration 28: 0.6702127659574468
	Train acc at iteration 30: 0.7660256410256411
	Val acc at iteration 29: 0.6914893617021277
	Train acc at iteration 31: 0.7772435897435898
	Val acc at iteration 30: 0.6595744680851063
	Train acc at iteration 32: 0.7740384615384616
	Val acc at iteration 31: 0.6382978723404256
	Train acc at iteration 33: 0.7740384615384616
	Val acc at iteration 32: 0.6382978723404256
	Train acc at iteration 34: 0.7884615384615384
	Val acc at iteration 33: 0.6382978723404256
	Train acc at iteration 35: 0.7676282051282052
	Val acc at iteration 34: 0.6276595744680851
	Train acc at iteration 36: 0.7756410256410257
	Val acc at iteration 35: 0.5957446808510638
	Train acc at iteration 37: 0.7628205128205128
	Val acc at iteration 36: 0.5851063829787234
	Train acc at iteration 38: 0.782051282051282
	Val acc at iteration 37: 0.7021276595744681
	Train acc at iteration 39: 0.7756410256410257
	Val acc at iteration 38: 0.6808510638297872
	Train acc at iteration 40: 0.7708333333333334
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.7964743589743589
	Val acc at iteration 40: 0.6808510638297872
	Train acc at iteration 42: 0.782051282051282
	Val acc at iteration 41: 0.6808510638297872
	Train acc at iteration 43: 0.780448717948718
	Val acc at iteration 42: 0.6808510638297872
	Train acc at iteration 44: 0.7900641025641025
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.7788461538461539
	Val acc at iteration 44: 0.6276595744680851
	Train acc at iteration 46: 0.7964743589743589
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.7660256410256411
	Val acc at iteration 46: 0.6914893617021277
	Train acc at iteration 48: 0.7756410256410257
	Val acc at iteration 47: 0.6914893617021277
	Train acc at iteration 49: 0.7596153846153846
	Val acc at iteration 48: 0.7446808510638298
	Train acc at iteration 50: 0.7692307692307693
	Val acc at iteration 49: 0.5957446808510638
	Train acc at iteration 51: 0.7628205128205128
	Val acc at iteration 50: 0.5957446808510638
	Train acc at iteration 52: 0.780448717948718
	Val acc at iteration 51: 0.648936170212766
	Train acc at iteration 53: 0.7772435897435898
	Val acc at iteration 52: 0.6382978723404256
	Train acc at iteration 54: 0.7852564102564102
	Val acc at iteration 53: 0.6914893617021277
	Train acc at iteration 55: 0.7708333333333334
	Val acc at iteration 54: 0.723404255319149
	Train acc at iteration 56: 0.7996794871794872
	Val acc at iteration 55: 0.7659574468085106
	Train acc at iteration 57: 0.7532051282051282
	Val acc at iteration 56: 0.648936170212766
	Train acc at iteration 58: 0.7740384615384616
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.7836538461538461
	Val acc at iteration 58: 0.6808510638297872
	Train acc at iteration 60: 0.7708333333333334
	Val acc at iteration 59: 0.6702127659574468
	Train acc at iteration 61: 0.780448717948718
	Val acc at iteration 60: 0.648936170212766
	Train acc at iteration 62: 0.7724358974358975
	Val acc at iteration 61: 0.6170212765957447
	Train acc at iteration 63: 0.7980769230769231
	Val acc at iteration 62: 0.6063829787234043
	Train acc at iteration 64: 0.7596153846153846
	Val acc at iteration 63: 0.5851063829787234
	Train acc at iteration 65: 0.7756410256410257
	Val acc at iteration 64: 0.6276595744680851
	Train acc at iteration 66: 0.7996794871794872
	Val acc at iteration 65: 0.6382978723404256
	Train acc at iteration 67: 0.7724358974358975
	Val acc at iteration 66: 0.6170212765957447
	Train acc at iteration 68: 0.780448717948718
	Val acc at iteration 67: 0.7021276595744681
	Train acc at iteration 69: 0.7467948717948718
	Val acc at iteration 68: 0.6702127659574468
	Train acc at iteration 70: 0.7564102564102564
	Val acc at iteration 69: 0.648936170212766
	Train acc at iteration 71: 0.7676282051282052
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.7660256410256411
	Val acc at iteration 71: 0.6702127659574468
	Train acc at iteration 73: 0.782051282051282
	Val acc at iteration 72: 0.6595744680851063
	Train acc at iteration 74: 0.7596153846153846
	Val acc at iteration 73: 0.5957446808510638
	Train acc at iteration 75: 0.7676282051282052
	Val acc at iteration 74: 0.6276595744680851
	Train acc at iteration 76: 0.7852564102564102
	Val acc at iteration 75: 0.6382978723404256
	Train acc at iteration 77: 0.7996794871794872
	Val acc at iteration 76: 0.6276595744680851
	Train acc at iteration 78: 0.7980769230769231
	Val acc at iteration 77: 0.6382978723404256
	Train acc at iteration 79: 0.7836538461538461
	Val acc at iteration 78: 0.6382978723404256
	Train acc at iteration 80: 0.7483974358974359
	Val acc at iteration 79: 0.6595744680851063
	Train acc at iteration 81: 0.7708333333333334
	Val acc at iteration 80: 0.5957446808510638
	Train acc at iteration 82: 0.7660256410256411
	Val acc at iteration 81: 0.6382978723404256
	Train acc at iteration 83: 0.7435897435897436
	Val acc at iteration 82: 0.6914893617021277
	Train acc at iteration 84: 0.7964743589743589
	Val acc at iteration 83: 0.6702127659574468
	Train acc at iteration 85: 0.7932692307692307
	Val acc at iteration 84: 0.6914893617021277
	Train acc at iteration 86: 0.7852564102564102
	Val acc at iteration 85: 0.7021276595744681
	Train acc at iteration 87: 0.7644230769230769
	Val acc at iteration 86: 0.6063829787234043
	Train acc at iteration 88: 0.8012820512820513
	Val acc at iteration 87: 0.6702127659574468
	Train acc at iteration 89: 0.7660256410256411
	Val acc at iteration 88: 0.5957446808510638
	Train acc at iteration 90: 0.7564102564102564
	Val acc at iteration 89: 0.6382978723404256
	Train acc at iteration 91: 0.7788461538461539
	Val acc at iteration 90: 0.723404255319149
	Train acc at iteration 92: 0.7836538461538461
	Val acc at iteration 91: 0.6382978723404256
	Train acc at iteration 93: 0.7692307692307693
	Val acc at iteration 92: 0.6702127659574468
	Train acc at iteration 94: 0.7788461538461539
	Val acc at iteration 93: 0.6170212765957447
	Train acc at iteration 95: 0.7900641025641025
	Val acc at iteration 94: 0.6276595744680851
	Train acc at iteration 96: 0.780448717948718
	Val acc at iteration 95: 0.648936170212766
	Train acc at iteration 97: 0.7740384615384616
	Val acc at iteration 96: 0.7021276595744681
	Train acc at iteration 98: 0.7660256410256411
	Val acc at iteration 97: 0.723404255319149
	Train acc at iteration 99: 0.7435897435897436
	Val acc at iteration 98: 0.5957446808510638
	Train acc at iteration 100: 0.7948717948717948
	Val acc at iteration 99: 0.7021276595744681
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5183673469387755
Final val micro accuracy: 0.6063829787234043
Final test macro f1-score: 0.46738351254480287
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6095882654190063
	Separation: 0.5383083522319794
Final test:
	Cluster: 0.6107639074325562
	Separation: 0.5492354035377502
Saved Results

Attempting combination 43/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 0.24
l1_weight: 0.01
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9787234042553191
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7756410256410257
	Cluster: 0.6480578541755676
	Separation: 0.5208540201187134
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.8191489361702128
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.7446808510638298
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.7659574468085106
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.7978723404255319
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.7659574468085106
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.7978723404255319
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7446808510638298
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.6170212765957447
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.7659574468085106
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7872340425531915
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.6382978723404256
	Val acc at iteration 83: 0.648936170212766
	Val acc at iteration 84: 0.7340425531914894
	Val acc at iteration 85: 0.6595744680851063
	Val acc at iteration 86: 0.723404255319149
	Val acc at iteration 87: 0.7659574468085106
	Val acc at iteration 88: 0.6808510638297872
	Val acc at iteration 89: 0.7553191489361702
	Val acc at iteration 90: 0.723404255319149
	Val acc at iteration 91: 0.7446808510638298
	Val acc at iteration 92: 0.776595744680851
	Val acc at iteration 93: 0.7446808510638298
	Val acc at iteration 94: 0.7872340425531915
	Val acc at iteration 95: 0.6702127659574468
	Val acc at iteration 96: 0.6914893617021277
	Val acc at iteration 97: 0.7340425531914894
	Val acc at iteration 98: 0.7340425531914894
	Val acc at iteration 99: 0.7021276595744681
Val acc before epoch 16: 0.7127659574468085
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8191489361702128
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7852564102564102
	Cluster: 0.6478891134262085
	Separation: 0.520068371295929
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.6914893617021277
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7659574468085106
	Val acc at iteration 13: 0.7553191489361702
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.7446808510638298
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.7659574468085106
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.7553191489361702
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7872340425531915
	Val acc at iteration 37: 0.6170212765957447
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.6702127659574468
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.7872340425531915
	Val acc at iteration 58: 0.776595744680851
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.5957446808510638
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.7978723404255319
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.7659574468085106
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.7446808510638298
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.6702127659574468
	Val acc at iteration 85: 0.5957446808510638
	Val acc at iteration 86: 0.7446808510638298
	Val acc at iteration 87: 0.6808510638297872
	Val acc at iteration 88: 0.6914893617021277
	Val acc at iteration 89: 0.7553191489361702
	Val acc at iteration 90: 0.6063829787234043
	Val acc at iteration 91: 0.776595744680851
	Val acc at iteration 92: 0.7021276595744681
	Val acc at iteration 93: 0.7021276595744681
	Val acc at iteration 94: 0.723404255319149
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.6382978723404256
	Val acc at iteration 97: 0.723404255319149
	Val acc at iteration 98: 0.7553191489361702
	Val acc at iteration 99: 0.7021276595744681
Val acc before epoch 26: 0.6808510638297872
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9680851063829787
Stopping after epoch 36.
Final validation accuracy before push: 96.80851063829788%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8285256410256411
	Cluster: 0.6558665037155151
	Separation: 0.5213297247886658
(After push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.7932692307692307
	Val acc at iteration 0: 0.7021276595744681
	Train acc at iteration 2: 0.7916666666666666
	Val acc at iteration 1: 0.7446808510638298
	Train acc at iteration 3: 0.8060897435897436
	Val acc at iteration 2: 0.7340425531914894
	Train acc at iteration 4: 0.8044871794871795
	Val acc at iteration 3: 0.7446808510638298
	Train acc at iteration 5: 0.7724358974358975
	Val acc at iteration 4: 0.6914893617021277
	Train acc at iteration 6: 0.7948717948717948
	Val acc at iteration 5: 0.7340425531914894
	Train acc at iteration 7: 0.8092948717948718
	Val acc at iteration 6: 0.7021276595744681
	Train acc at iteration 8: 0.8028846153846154
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.7916666666666666
	Val acc at iteration 8: 0.6382978723404256
	Train acc at iteration 10: 0.8044871794871795
	Val acc at iteration 9: 0.6914893617021277
	Train acc at iteration 11: 0.7676282051282052
	Val acc at iteration 10: 0.6595744680851063
	Train acc at iteration 12: 0.7836538461538461
	Val acc at iteration 11: 0.7446808510638298
	Train acc at iteration 13: 0.7980769230769231
	Val acc at iteration 12: 0.5638297872340425
	Train acc at iteration 14: 0.8028846153846154
	Val acc at iteration 13: 0.6702127659574468
	Train acc at iteration 15: 0.7980769230769231
	Val acc at iteration 14: 0.6595744680851063
	Train acc at iteration 16: 0.7836538461538461
	Val acc at iteration 15: 0.7553191489361702
	Train acc at iteration 17: 0.7884615384615384
	Val acc at iteration 16: 0.8191489361702128
	Train acc at iteration 18: 0.7852564102564102
	Val acc at iteration 17: 0.7659574468085106
	Train acc at iteration 19: 0.7708333333333334
	Val acc at iteration 18: 0.7340425531914894
	Train acc at iteration 20: 0.7948717948717948
	Val acc at iteration 19: 0.7127659574468085
	Train acc at iteration 21: 0.8044871794871795
	Val acc at iteration 20: 0.7446808510638298
	Train acc at iteration 22: 0.7852564102564102
	Val acc at iteration 21: 0.7553191489361702
	Train acc at iteration 23: 0.8221153846153846
	Val acc at iteration 22: 0.776595744680851
	Train acc at iteration 24: 0.7708333333333334
	Val acc at iteration 23: 0.6595744680851063
	Train acc at iteration 25: 0.7900641025641025
	Val acc at iteration 24: 0.6914893617021277
	Train acc at iteration 26: 0.8237179487179487
	Val acc at iteration 25: 0.648936170212766
	Train acc at iteration 27: 0.782051282051282
	Val acc at iteration 26: 0.7127659574468085
	Train acc at iteration 28: 0.8285256410256411
	Val acc at iteration 27: 0.7659574468085106
	Train acc at iteration 29: 0.7852564102564102
	Val acc at iteration 28: 0.6702127659574468
	Train acc at iteration 30: 0.7884615384615384
	Val acc at iteration 29: 0.7127659574468085
	Train acc at iteration 31: 0.7772435897435898
	Val acc at iteration 30: 0.7446808510638298
	Train acc at iteration 32: 0.7996794871794872
	Val acc at iteration 31: 0.648936170212766
	Train acc at iteration 33: 0.8076923076923077
	Val acc at iteration 32: 0.7446808510638298
	Train acc at iteration 34: 0.7772435897435898
	Val acc at iteration 33: 0.6170212765957447
	Train acc at iteration 35: 0.7932692307692307
	Val acc at iteration 34: 0.6702127659574468
	Train acc at iteration 36: 0.7852564102564102
	Val acc at iteration 35: 0.6595744680851063
	Train acc at iteration 37: 0.782051282051282
	Val acc at iteration 36: 0.6914893617021277
	Train acc at iteration 38: 0.8012820512820513
	Val acc at iteration 37: 0.6808510638297872
	Train acc at iteration 39: 0.7852564102564102
	Val acc at iteration 38: 0.7127659574468085
	Train acc at iteration 40: 0.7900641025641025
	Val acc at iteration 39: 0.6914893617021277
	Train acc at iteration 41: 0.8108974358974359
	Val acc at iteration 40: 0.6595744680851063
	Train acc at iteration 42: 0.7660256410256411
	Val acc at iteration 41: 0.7340425531914894
	Train acc at iteration 43: 0.7836538461538461
	Val acc at iteration 42: 0.5957446808510638
	Train acc at iteration 44: 0.7964743589743589
	Val acc at iteration 43: 0.7340425531914894
	Train acc at iteration 45: 0.782051282051282
	Val acc at iteration 44: 0.7340425531914894
	Train acc at iteration 46: 0.8108974358974359
	Val acc at iteration 45: 0.6276595744680851
	Train acc at iteration 47: 0.7868589743589743
	Val acc at iteration 46: 0.6914893617021277
	Train acc at iteration 48: 0.7964743589743589
	Val acc at iteration 47: 0.7978723404255319
	Train acc at iteration 49: 0.7644230769230769
	Val acc at iteration 48: 0.6382978723404256
	Train acc at iteration 50: 0.7964743589743589
	Val acc at iteration 49: 0.6808510638297872
	Train acc at iteration 51: 0.7900641025641025
	Val acc at iteration 50: 0.7872340425531915
	Train acc at iteration 52: 0.8012820512820513
	Val acc at iteration 51: 0.6914893617021277
	Train acc at iteration 53: 0.7756410256410257
	Val acc at iteration 52: 0.8085106382978723
	Train acc at iteration 54: 0.7980769230769231
	Val acc at iteration 53: 0.6914893617021277
	Train acc at iteration 55: 0.7948717948717948
	Val acc at iteration 54: 0.6914893617021277
	Train acc at iteration 56: 0.8092948717948718
	Val acc at iteration 55: 0.7659574468085106
	Train acc at iteration 57: 0.8205128205128205
	Val acc at iteration 56: 0.6702127659574468
	Train acc at iteration 58: 0.7836538461538461
	Val acc at iteration 57: 0.6702127659574468
	Train acc at iteration 59: 0.7948717948717948
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.8028846153846154
	Val acc at iteration 59: 0.7553191489361702
	Train acc at iteration 61: 0.7580128205128205
	Val acc at iteration 60: 0.7021276595744681
	Train acc at iteration 62: 0.7836538461538461
	Val acc at iteration 61: 0.7021276595744681
	Train acc at iteration 63: 0.8237179487179487
	Val acc at iteration 62: 0.723404255319149
	Train acc at iteration 64: 0.7596153846153846
	Val acc at iteration 63: 0.6276595744680851
	Train acc at iteration 65: 0.7772435897435898
	Val acc at iteration 64: 0.7127659574468085
	Train acc at iteration 66: 0.7980769230769231
	Val acc at iteration 65: 0.6595744680851063
	Train acc at iteration 67: 0.7932692307692307
	Val acc at iteration 66: 0.7446808510638298
	Train acc at iteration 68: 0.7852564102564102
	Val acc at iteration 67: 0.7659574468085106
	Train acc at iteration 69: 0.7964743589743589
	Val acc at iteration 68: 0.6382978723404256
	Train acc at iteration 70: 0.7964743589743589
	Val acc at iteration 69: 0.6382978723404256
	Train acc at iteration 71: 0.7852564102564102
	Val acc at iteration 70: 0.7446808510638298
	Train acc at iteration 72: 0.8157051282051282
	Val acc at iteration 71: 0.7127659574468085
	Train acc at iteration 73: 0.7836538461538461
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.7724358974358975
	Val acc at iteration 73: 0.6702127659574468
	Train acc at iteration 75: 0.8285256410256411
	Val acc at iteration 74: 0.5851063829787234
	Train acc at iteration 76: 0.8092948717948718
	Val acc at iteration 75: 0.7340425531914894
	Train acc at iteration 77: 0.7932692307692307
	Val acc at iteration 76: 0.7127659574468085
	Train acc at iteration 78: 0.7580128205128205
	Val acc at iteration 77: 0.6808510638297872
	Train acc at iteration 79: 0.7996794871794872
	Val acc at iteration 78: 0.7446808510638298
	Train acc at iteration 80: 0.7852564102564102
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.780448717948718
	Val acc at iteration 80: 0.7553191489361702
	Train acc at iteration 82: 0.7948717948717948
	Val acc at iteration 81: 0.723404255319149
	Train acc at iteration 83: 0.7724358974358975
	Val acc at iteration 82: 0.6914893617021277
	Train acc at iteration 84: 0.8076923076923077
	Val acc at iteration 83: 0.7446808510638298
	Train acc at iteration 85: 0.7772435897435898
	Val acc at iteration 84: 0.6595744680851063
	Train acc at iteration 86: 0.7980769230769231
	Val acc at iteration 85: 0.6808510638297872
	Train acc at iteration 87: 0.7692307692307693
	Val acc at iteration 86: 0.7446808510638298
	Train acc at iteration 88: 0.7884615384615384
	Val acc at iteration 87: 0.7446808510638298
	Train acc at iteration 89: 0.8157051282051282
	Val acc at iteration 88: 0.7978723404255319
	Train acc at iteration 90: 0.7980769230769231
	Val acc at iteration 89: 0.648936170212766
	Train acc at iteration 91: 0.8189102564102564
	Val acc at iteration 90: 0.7553191489361702
	Train acc at iteration 92: 0.7996794871794872
	Val acc at iteration 91: 0.6914893617021277
	Train acc at iteration 93: 0.7548076923076923
	Val acc at iteration 92: 0.6808510638297872
	Train acc at iteration 94: 0.7868589743589743
	Val acc at iteration 93: 0.7127659574468085
	Train acc at iteration 95: 0.8092948717948718
	Val acc at iteration 94: 0.7340425531914894
	Train acc at iteration 96: 0.8076923076923077
	Val acc at iteration 95: 0.776595744680851
	Train acc at iteration 97: 0.7980769230769231
	Val acc at iteration 96: 0.6276595744680851
	Train acc at iteration 98: 0.7724358974358975
	Val acc at iteration 97: 0.6595744680851063
	Train acc at iteration 99: 0.7708333333333334
	Val acc at iteration 98: 0.6914893617021277
	Train acc at iteration 100: 0.7900641025641025
	Val acc at iteration 99: 0.7127659574468085
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5814035087719298
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.44652014652014643
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6283882558345795
	Separation: 0.5425880551338196
Final test:
	Cluster: 0.5889309346675873
	Separation: 0.538468599319458
Saved Results

Attempting combination 44/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: 0.2
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -0.9600000000000002
sep_weight: 0.24
l1_weight: 0.001
warm_ptype_lr: 0.1
last_layer_lr: 0.0005
num_warm_epochs: 1000000
push_gap: 10
push_start: 15
num_pushes: 2
last_layer_epochs: 100
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 35
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.32978723404255317
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5531914893617021
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7978723404255319
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 11: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 15: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Cluster: 0.6573348641395569
	Separation: 0.5258288979530334
Retraining last layer: 
Last layer lr: 0.0005
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.5957446808510638
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.7446808510638298
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.6382978723404256
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.7978723404255319
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6170212765957447
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.6170212765957447
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6382978723404256
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.6276595744680851
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.648936170212766
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.7127659574468085
	Val acc at iteration 85: 0.7340425531914894
	Val acc at iteration 86: 0.7446808510638298
	Val acc at iteration 87: 0.7553191489361702
	Val acc at iteration 88: 0.723404255319149
	Val acc at iteration 89: 0.5851063829787234
	Val acc at iteration 90: 0.7021276595744681
	Val acc at iteration 91: 0.7127659574468085
	Val acc at iteration 92: 0.7446808510638298
	Val acc at iteration 93: 0.723404255319149
	Val acc at iteration 94: 0.7021276595744681
	Val acc at iteration 95: 0.7127659574468085
	Val acc at iteration 96: 0.723404255319149
	Val acc at iteration 97: 0.723404255319149
	Val acc at iteration 98: 0.6702127659574468
	Val acc at iteration 99: 0.6595744680851063
Val acc before epoch 16: 0.6595744680851063
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8076923076923077
	Cluster: 0.650872778892517
	Separation: 0.5227724432945251
Retraining last layer: 
Last layer lr: 0.00025
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.7978723404255319
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.7659574468085106
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.8191489361702128
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.6914893617021277
	Val acc at iteration 85: 0.723404255319149
	Val acc at iteration 86: 0.6808510638297872
	Val acc at iteration 87: 0.7340425531914894
	Val acc at iteration 88: 0.6808510638297872
	Val acc at iteration 89: 0.6702127659574468
	Val acc at iteration 90: 0.7446808510638298
	Val acc at iteration 91: 0.7127659574468085
	Val acc at iteration 92: 0.7127659574468085
	Val acc at iteration 93: 0.7127659574468085
	Val acc at iteration 94: 0.7872340425531915
	Val acc at iteration 95: 0.6808510638297872
	Val acc at iteration 96: 0.7872340425531915
	Val acc at iteration 97: 0.7553191489361702
	Val acc at iteration 98: 0.7021276595744681
	Val acc at iteration 99: 0.6382978723404256
Val acc before epoch 26: 0.7127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 30: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 35: 0.9361702127659575
Stopping after epoch 36.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7948717948717948
	Cluster: 0.6434882879257202
	Separation: 0.5210004448890686
(After push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: 0.000125
	Train acc at iteration 1: 0.8269230769230769
	Val acc at iteration 0: 0.6914893617021277
	Train acc at iteration 2: 0.7964743589743589
	Val acc at iteration 1: 0.6702127659574468
	Train acc at iteration 3: 0.8125
	Val acc at iteration 2: 0.7021276595744681
	Train acc at iteration 4: 0.8092948717948718
	Val acc at iteration 3: 0.723404255319149
	Train acc at iteration 5: 0.7996794871794872
	Val acc at iteration 4: 0.7127659574468085
	Train acc at iteration 6: 0.8028846153846154
	Val acc at iteration 5: 0.648936170212766
	Train acc at iteration 7: 0.8012820512820513
	Val acc at iteration 6: 0.648936170212766
	Train acc at iteration 8: 0.7612179487179487
	Val acc at iteration 7: 0.6702127659574468
	Train acc at iteration 9: 0.8413461538461539
	Val acc at iteration 8: 0.7340425531914894
	Train acc at iteration 10: 0.7868589743589743
	Val acc at iteration 9: 0.7021276595744681
	Train acc at iteration 11: 0.8157051282051282
	Val acc at iteration 10: 0.7021276595744681
	Train acc at iteration 12: 0.7932692307692307
	Val acc at iteration 11: 0.7127659574468085
	Train acc at iteration 13: 0.8221153846153846
	Val acc at iteration 12: 0.7446808510638298
	Train acc at iteration 14: 0.8189102564102564
	Val acc at iteration 13: 0.7340425531914894
	Train acc at iteration 15: 0.8092948717948718
	Val acc at iteration 14: 0.6914893617021277
	Train acc at iteration 16: 0.7916666666666666
	Val acc at iteration 15: 0.723404255319149
	Train acc at iteration 17: 0.7948717948717948
	Val acc at iteration 16: 0.648936170212766
	Train acc at iteration 18: 0.8044871794871795
	Val acc at iteration 17: 0.6914893617021277
	Train acc at iteration 19: 0.7868589743589743
	Val acc at iteration 18: 0.6914893617021277
	Train acc at iteration 20: 0.8285256410256411
	Val acc at iteration 19: 0.7127659574468085
	Train acc at iteration 21: 0.8141025641025641
	Val acc at iteration 20: 0.7553191489361702
	Train acc at iteration 22: 0.7852564102564102
	Val acc at iteration 21: 0.7021276595744681
	Train acc at iteration 23: 0.7916666666666666
	Val acc at iteration 22: 0.7446808510638298
	Train acc at iteration 24: 0.7980769230769231
	Val acc at iteration 23: 0.723404255319149
	Train acc at iteration 25: 0.8012820512820513
	Val acc at iteration 24: 0.6914893617021277
	Train acc at iteration 26: 0.8012820512820513
	Val acc at iteration 25: 0.7446808510638298
	Train acc at iteration 27: 0.8060897435897436
	Val acc at iteration 26: 0.7340425531914894
	Train acc at iteration 28: 0.7836538461538461
	Val acc at iteration 27: 0.7340425531914894
	Train acc at iteration 29: 0.8125
	Val acc at iteration 28: 0.723404255319149
	Train acc at iteration 30: 0.8301282051282052
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.8173076923076923
	Val acc at iteration 30: 0.7127659574468085
	Train acc at iteration 32: 0.7932692307692307
	Val acc at iteration 31: 0.776595744680851
	Train acc at iteration 33: 0.8076923076923077
	Val acc at iteration 32: 0.7127659574468085
	Train acc at iteration 34: 0.8108974358974359
	Val acc at iteration 33: 0.7872340425531915
	Train acc at iteration 35: 0.7948717948717948
	Val acc at iteration 34: 0.723404255319149
	Train acc at iteration 36: 0.8125
	Val acc at iteration 35: 0.776595744680851
	Train acc at iteration 37: 0.8237179487179487
	Val acc at iteration 36: 0.7553191489361702
	Train acc at iteration 38: 0.8092948717948718
	Val acc at iteration 37: 0.7340425531914894
	Train acc at iteration 39: 0.8076923076923077
	Val acc at iteration 38: 0.7340425531914894
	Train acc at iteration 40: 0.8092948717948718
	Val acc at iteration 39: 0.6595744680851063
	Train acc at iteration 41: 0.8028846153846154
	Val acc at iteration 40: 0.7021276595744681
	Train acc at iteration 42: 0.7980769230769231
	Val acc at iteration 41: 0.6914893617021277
	Train acc at iteration 43: 0.7948717948717948
	Val acc at iteration 42: 0.7021276595744681
	Train acc at iteration 44: 0.8092948717948718
	Val acc at iteration 43: 0.7446808510638298
	Train acc at iteration 45: 0.8125
	Val acc at iteration 44: 0.7446808510638298
	Train acc at iteration 46: 0.7964743589743589
	Val acc at iteration 45: 0.723404255319149
	Train acc at iteration 47: 0.8141025641025641
	Val acc at iteration 46: 0.7446808510638298
	Train acc at iteration 48: 0.7932692307692307
	Val acc at iteration 47: 0.7553191489361702
	Train acc at iteration 49: 0.8461538461538461
	Val acc at iteration 48: 0.723404255319149
	Train acc at iteration 50: 0.8125
	Val acc at iteration 49: 0.7446808510638298
	Train acc at iteration 51: 0.8269230769230769
	Val acc at iteration 50: 0.648936170212766
	Train acc at iteration 52: 0.782051282051282
	Val acc at iteration 51: 0.7127659574468085
	Train acc at iteration 53: 0.8044871794871795
	Val acc at iteration 52: 0.6808510638297872
	Train acc at iteration 54: 0.7692307692307693
	Val acc at iteration 53: 0.776595744680851
	Train acc at iteration 55: 0.8092948717948718
	Val acc at iteration 54: 0.7553191489361702
	Train acc at iteration 56: 0.8125
	Val acc at iteration 55: 0.6702127659574468
	Train acc at iteration 57: 0.782051282051282
	Val acc at iteration 56: 0.7021276595744681
	Train acc at iteration 58: 0.7948717948717948
	Val acc at iteration 57: 0.7340425531914894
	Train acc at iteration 59: 0.8108974358974359
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.7932692307692307
	Val acc at iteration 59: 0.776595744680851
	Train acc at iteration 61: 0.8044871794871795
	Val acc at iteration 60: 0.6808510638297872
	Train acc at iteration 62: 0.8125
	Val acc at iteration 61: 0.7340425531914894
	Train acc at iteration 63: 0.8092948717948718
	Val acc at iteration 62: 0.7340425531914894
	Train acc at iteration 64: 0.8221153846153846
	Val acc at iteration 63: 0.6808510638297872
	Train acc at iteration 65: 0.7996794871794872
	Val acc at iteration 64: 0.6914893617021277
	Train acc at iteration 66: 0.7932692307692307
	Val acc at iteration 65: 0.7446808510638298
	Train acc at iteration 67: 0.8028846153846154
	Val acc at iteration 66: 0.7127659574468085
	Train acc at iteration 68: 0.8028846153846154
	Val acc at iteration 67: 0.6914893617021277
	Train acc at iteration 69: 0.8205128205128205
	Val acc at iteration 68: 0.7553191489361702
	Train acc at iteration 70: 0.8157051282051282
	Val acc at iteration 69: 0.7127659574468085
	Train acc at iteration 71: 0.8157051282051282
	Val acc at iteration 70: 0.7446808510638298
	Train acc at iteration 72: 0.7964743589743589
	Val acc at iteration 71: 0.648936170212766
	Train acc at iteration 73: 0.8237179487179487
	Val acc at iteration 72: 0.7553191489361702
	Train acc at iteration 74: 0.8044871794871795
	Val acc at iteration 73: 0.648936170212766
	Train acc at iteration 75: 0.7932692307692307
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.8028846153846154
	Val acc at iteration 75: 0.723404255319149
	Train acc at iteration 77: 0.8173076923076923
	Val acc at iteration 76: 0.6914893617021277
	Train acc at iteration 78: 0.8028846153846154
	Val acc at iteration 77: 0.7021276595744681
	Train acc at iteration 79: 0.7996794871794872
	Val acc at iteration 78: 0.723404255319149
	Train acc at iteration 80: 0.8060897435897436
	Val acc at iteration 79: 0.723404255319149
	Train acc at iteration 81: 0.8221153846153846
	Val acc at iteration 80: 0.6914893617021277
	Train acc at iteration 82: 0.8157051282051282
	Val acc at iteration 81: 0.7021276595744681
	Train acc at iteration 83: 0.8157051282051282
	Val acc at iteration 82: 0.6702127659574468
	Train acc at iteration 84: 0.780448717948718
	Val acc at iteration 83: 0.7127659574468085
	Train acc at iteration 85: 0.8189102564102564
	Val acc at iteration 84: 0.7340425531914894
	Train acc at iteration 86: 0.8349358974358975
	Val acc at iteration 85: 0.7021276595744681
	Train acc at iteration 87: 0.8076923076923077
	Val acc at iteration 86: 0.7340425531914894
	Train acc at iteration 88: 0.7916666666666666
	Val acc at iteration 87: 0.7340425531914894
	Train acc at iteration 89: 0.8044871794871795
	Val acc at iteration 88: 0.723404255319149
	Train acc at iteration 90: 0.7964743589743589
	Val acc at iteration 89: 0.7659574468085106
	Train acc at iteration 91: 0.7948717948717948
	Val acc at iteration 90: 0.7127659574468085
	Train acc at iteration 92: 0.8076923076923077
	Val acc at iteration 91: 0.6914893617021277
	Train acc at iteration 93: 0.7836538461538461
	Val acc at iteration 92: 0.7659574468085106
	Train acc at iteration 94: 0.8092948717948718
	Val acc at iteration 93: 0.6808510638297872
	Train acc at iteration 95: 0.7916666666666666
	Val acc at iteration 94: 0.6914893617021277
	Train acc at iteration 96: 0.8253205128205128
	Val acc at iteration 95: 0.723404255319149
	Train acc at iteration 97: 0.7980769230769231
	Val acc at iteration 96: 0.7340425531914894
	Train acc at iteration 98: 0.7900641025641025
	Val acc at iteration 97: 0.723404255319149
	Train acc at iteration 99: 0.7740384615384616
	Val acc at iteration 98: 0.6702127659574468
	Train acc at iteration 100: 0.8076923076923077
	Val acc at iteration 99: 0.7553191489361702
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5660066006600659
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.519927536231884
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6202825605869293
	Separation: 0.5486901700496674
Final test:
	Cluster: 0.6170758306980133
	Separation: 0.5396246612071991
Saved Results
Finished search.
