===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Fri Mar 29 09:26:17 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-03-29 09:26:30.803979: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-29 09:26:31.365131: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-29 09:26:31.365210: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-29 09:26:31.368275: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-29 09:26:31.737466: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94
Hyperparameters: {'prototype_shape': [(468, 520, 29)], 'latent_weight': [0.8], 'joint_weight_decay': [-1], 'gamma': [-1], 'warm_lr_step_size': [5000000], 'crs_ent_weight': [1], 'clst_weight': [-9.600000000000001], 'sep_weight': [2.4], 'l1_weight': [0.0001, 0.0005, 0.001, 0.005, 0.01, 0.1, 0.5, 1], 'warm_ptype_lr': [0.4], 'last_layer_lr': [0.001], 'last_layer_lr_after_second_push': [0.5, 0.1, 0.05, 0.01, 0.005, 0.001, 0.0005, 0.0001, 5e-05], 'num_warm_epochs': [1000000], 'push_gap': [12], 'push_start': [12], 'num_pushes': [2], 'last_layer_epochs': [85], 'joint_lr_step_size': [-1], 'joint_optimizer_lrs': [{'features': -1, 'prototype_vectors': -1}]}




Exploring 72 hyperparameter combinations for grid search.


Attempting combination 1/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.031914893617021274
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5957446808510638
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7872340425531915
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7644230769230769
	Train Cluster: 0.6386419892311096
	Train Separation: 0.5138106942176819
(Directly after push) Val acc at iteration 0: 0.5319148936170213
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.5957446808510638
	Val acc at iteration 3: 0.6063829787234043
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.6063829787234043
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6170212765957447
	Val acc at iteration 22: 0.6170212765957447
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7553191489361702
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.5957446808510638
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.648936170212766
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7659574468085106
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.648936170212766
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.6382978723404256
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.7872340425531915
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.6170212765957447
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.7872340425531915
	Val acc at iteration 77: 0.6595744680851063
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.7127659574468085
Val acc before epoch 13: 0.6914893617021277
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8076923076923077
	Train Cluster: 0.6382114052772522
	Train Separation: 0.519769549369812
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.776595744680851
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.7553191489361702
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.8085106382978723
	Val acc at iteration 9: 0.776595744680851
	Val acc at iteration 10: 0.776595744680851
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.7446808510638298
	Val acc at iteration 15: 0.8085106382978723
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.7659574468085106
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.8085106382978723
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.7446808510638298
	Val acc at iteration 23: 0.776595744680851
	Val acc at iteration 24: 0.7553191489361702
	Val acc at iteration 25: 0.7978723404255319
	Val acc at iteration 26: 0.7553191489361702
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7872340425531915
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.7659574468085106
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.7872340425531915
	Val acc at iteration 39: 0.8085106382978723
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.7872340425531915
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.776595744680851
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.776595744680851
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.8191489361702128
	Val acc at iteration 59: 0.851063829787234
	Val acc at iteration 60: 0.7872340425531915
	Val acc at iteration 61: 0.7978723404255319
	Val acc at iteration 62: 0.7659574468085106
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7872340425531915
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.7872340425531915
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.8191489361702128
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.8191489361702128
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.8297872340425532
	Val acc at iteration 76: 0.776595744680851
	Val acc at iteration 77: 0.7340425531914894
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.776595744680851
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.8297872340425532
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 25: 0.7340425531914894
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.842948717948718
	Train Cluster: 0.642905306816101
	TrainSeparation: 0.5169013261795044
(Directly after push) Val acc at iteration 0: 0.8085106382978723
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.21474358974358973
	Val acc at iteration 0: 0.02127659574468085
	Train acc at iteration 2: 0.017628205128205128
	Val acc at iteration 1: 0.05319148936170213
	Train acc at iteration 3: 0.009615384615384616
	Val acc at iteration 2: 0.09574468085106383
	Train acc at iteration 4: 0.04006410256410257
	Val acc at iteration 3: 0.05319148936170213
	Train acc at iteration 5: 0.017628205128205128
	Val acc at iteration 4: 0.031914893617021274
	Train acc at iteration 6: 0.027243589743589744
	Val acc at iteration 5: 0.05319148936170213
	Train acc at iteration 7: 0.022435897435897436
	Val acc at iteration 6: 0.02127659574468085
	Train acc at iteration 8: 0.011217948717948718
	Val acc at iteration 7: 0.031914893617021274
	Train acc at iteration 9: 0.020833333333333332
	Val acc at iteration 8: 0.031914893617021274
	Train acc at iteration 10: 0.016025641025641024
	Val acc at iteration 9: 0.031914893617021274
	Train acc at iteration 11: 0.020833333333333332
	Val acc at iteration 10: 0.0425531914893617
	Train acc at iteration 12: 0.009615384615384616
	Val acc at iteration 11: 0.02127659574468085
	Train acc at iteration 13: 0.017628205128205128
	Val acc at iteration 12: 0.06382978723404255
	Train acc at iteration 14: 0.03685897435897436
	Val acc at iteration 13: 0.010638297872340425
	Train acc at iteration 15: 0.019230769230769232
	Val acc at iteration 14: 0.031914893617021274
	Train acc at iteration 16: 0.014423076923076924
	Val acc at iteration 15: 0.02127659574468085
	Train acc at iteration 17: 0.016025641025641024
	Val acc at iteration 16: 0.05319148936170213
	Train acc at iteration 18: 0.03205128205128205
	Val acc at iteration 17: 0.0425531914893617
	Train acc at iteration 19: 0.02564102564102564
	Val acc at iteration 18: 0.031914893617021274
	Train acc at iteration 20: 0.030448717948717948
	Val acc at iteration 19: 0.031914893617021274
	Train acc at iteration 21: 0.03685897435897436
	Val acc at iteration 20: 0.0425531914893617
	Train acc at iteration 22: 0.035256410256410256
	Val acc at iteration 21: 0.0851063829787234
	Train acc at iteration 23: 0.038461538461538464
	Val acc at iteration 22: 0.06382978723404255
	Train acc at iteration 24: 0.04326923076923077
	Val acc at iteration 23: 0.07446808510638298
	Train acc at iteration 25: 0.07051282051282051
	Val acc at iteration 24: 0.06382978723404255
	Train acc at iteration 26: 0.05128205128205128
	Val acc at iteration 25: 0.09574468085106383
	Train acc at iteration 27: 0.10576923076923077
	Val acc at iteration 26: 0.07446808510638298
	Train acc at iteration 28: 0.07852564102564102
	Val acc at iteration 27: 0.10638297872340426
	Train acc at iteration 29: 0.08653846153846154
	Val acc at iteration 28: 0.13829787234042554
	Train acc at iteration 30: 0.1282051282051282
	Val acc at iteration 29: 0.14893617021276595
	Train acc at iteration 31: 0.16987179487179488
	Val acc at iteration 30: 0.26595744680851063
	Train acc at iteration 32: 0.1875
	Val acc at iteration 31: 0.2553191489361702
	Train acc at iteration 33: 0.23557692307692307
	Val acc at iteration 32: 0.23404255319148937
	Train acc at iteration 34: 0.25961538461538464
	Val acc at iteration 33: 0.2765957446808511
	Train acc at iteration 35: 0.3189102564102564
	Val acc at iteration 34: 0.3191489361702128
	Train acc at iteration 36: 0.25961538461538464
	Val acc at iteration 35: 0.3829787234042553
	Train acc at iteration 37: 0.34775641025641024
	Val acc at iteration 36: 0.3617021276595745
	Train acc at iteration 38: 0.3701923076923077
	Val acc at iteration 37: 0.40425531914893614
	Train acc at iteration 39: 0.4310897435897436
	Val acc at iteration 38: 0.4574468085106383
	Train acc at iteration 40: 0.4791666666666667
	Val acc at iteration 39: 0.5425531914893617
	Train acc at iteration 41: 0.5096153846153846
	Val acc at iteration 40: 0.5531914893617021
	Train acc at iteration 42: 0.5625
	Val acc at iteration 41: 0.6170212765957447
	Train acc at iteration 43: 0.594551282051282
	Val acc at iteration 42: 0.6170212765957447
	Train acc at iteration 44: 0.6490384615384616
	Val acc at iteration 43: 0.6382978723404256
	Train acc at iteration 45: 0.6826923076923077
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.6634615384615384
	Val acc at iteration 45: 0.6276595744680851
	Train acc at iteration 47: 0.7003205128205128
	Val acc at iteration 46: 0.6914893617021277
	Train acc at iteration 48: 0.7163461538461539
	Val acc at iteration 47: 0.723404255319149
	Train acc at iteration 49: 0.7339743589743589
	Val acc at iteration 48: 0.6914893617021277
	Train acc at iteration 50: 0.7612179487179487
	Val acc at iteration 49: 0.776595744680851
	Train acc at iteration 51: 0.75
	Val acc at iteration 50: 0.776595744680851
	Train acc at iteration 52: 0.7644230769230769
	Val acc at iteration 51: 0.7446808510638298
	Train acc at iteration 53: 0.7532051282051282
	Val acc at iteration 52: 0.776595744680851
	Train acc at iteration 54: 0.7419871794871795
	Val acc at iteration 53: 0.7978723404255319
	Train acc at iteration 55: 0.782051282051282
	Val acc at iteration 54: 0.7446808510638298
	Train acc at iteration 56: 0.7628205128205128
	Val acc at iteration 55: 0.7872340425531915
	Train acc at iteration 57: 0.7483974358974359
	Val acc at iteration 56: 0.7446808510638298
	Train acc at iteration 58: 0.7692307692307693
	Val acc at iteration 57: 0.776595744680851
	Train acc at iteration 59: 0.7932692307692307
	Val acc at iteration 58: 0.7446808510638298
	Train acc at iteration 60: 0.7724358974358975
	Val acc at iteration 59: 0.7872340425531915
	Train acc at iteration 61: 0.8141025641025641
	Val acc at iteration 60: 0.7446808510638298
	Train acc at iteration 62: 0.7692307692307693
	Val acc at iteration 61: 0.8085106382978723
	Train acc at iteration 63: 0.7564102564102564
	Val acc at iteration 62: 0.8191489361702128
	Train acc at iteration 64: 0.7788461538461539
	Val acc at iteration 63: 0.776595744680851
	Train acc at iteration 65: 0.7900641025641025
	Val acc at iteration 64: 0.7872340425531915
	Train acc at iteration 66: 0.8092948717948718
	Val acc at iteration 65: 0.8617021276595744
	Train acc at iteration 67: 0.7948717948717948
	Val acc at iteration 66: 0.7872340425531915
	Train acc at iteration 68: 0.7980769230769231
	Val acc at iteration 67: 0.8085106382978723
	Train acc at iteration 69: 0.7932692307692307
	Val acc at iteration 68: 0.8404255319148937
	Train acc at iteration 70: 0.7932692307692307
	Val acc at iteration 69: 0.776595744680851
	Train acc at iteration 71: 0.7724358974358975
	Val acc at iteration 70: 0.8085106382978723
	Train acc at iteration 72: 0.8173076923076923
	Val acc at iteration 71: 0.8829787234042553
	Train acc at iteration 73: 0.8076923076923077
	Val acc at iteration 72: 0.8191489361702128
	Train acc at iteration 74: 0.8189102564102564
	Val acc at iteration 73: 0.8297872340425532
	Train acc at iteration 75: 0.8205128205128205
	Val acc at iteration 74: 0.8297872340425532
	Train acc at iteration 76: 0.8125
	Val acc at iteration 75: 0.7978723404255319
	Train acc at iteration 77: 0.8157051282051282
	Val acc at iteration 76: 0.8297872340425532
	Train acc at iteration 78: 0.8189102564102564
	Val acc at iteration 77: 0.7872340425531915
	Train acc at iteration 79: 0.8317307692307693
	Val acc at iteration 78: 0.8617021276595744
	Train acc at iteration 80: 0.8301282051282052
	Val acc at iteration 79: 0.8085106382978723
	Train acc at iteration 81: 0.8108974358974359
	Val acc at iteration 80: 0.8297872340425532
	Train acc at iteration 82: 0.8141025641025641
	Val acc at iteration 81: 0.8404255319148937
	Train acc at iteration 83: 0.8317307692307693
	Val acc at iteration 82: 0.8085106382978723
	Train acc at iteration 84: 0.8253205128205128
	Val acc at iteration 83: 0.8191489361702128
	Train acc at iteration 85: 0.8253205128205128
	Val acc at iteration 84: 0.851063829787234
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7902621722846443
Final val micro accuracy: 0.851063829787234
Final test macro f1-score: 0.6966244725738396
Final test micro accuracy: 0.7872340425531915
Final validation:
	Cluster: 0.6268578469753265
	Separation: 0.5410849452018738
Final test:
	Cluster: 0.6082808673381805
	Separation: 0.5370079874992371
Saved Results

Attempting combination 2/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.75
	Train Cluster: 0.6436664700508118
	Train Separation: 0.521158754825592
(Directly after push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5957446808510638
	Val acc at iteration 1: 0.5851063829787234
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.7446808510638298
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.5957446808510638
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.6063829787234043
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.7978723404255319
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.5957446808510638
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.6808510638297872
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.7872340425531915
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7021276595744681
Val acc before epoch 13: 0.7553191489361702
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.6384004592895508
	Train Separation: 0.5165325284004212
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.7978723404255319
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.8085106382978723
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.7553191489361702
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.7872340425531915
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.8297872340425532
	Val acc at iteration 17: 0.7659574468085106
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.8085106382978723
	Val acc at iteration 20: 0.8085106382978723
	Val acc at iteration 21: 0.7659574468085106
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.8191489361702128
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.7978723404255319
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.8085106382978723
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.6276595744680851
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.7978723404255319
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.8085106382978723
	Val acc at iteration 61: 0.8191489361702128
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.7872340425531915
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.8191489361702128
	Val acc at iteration 68: 0.7978723404255319
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.8617021276595744
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7978723404255319
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.7872340425531915
	Val acc at iteration 77: 0.7872340425531915
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.8085106382978723
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.8191489361702128
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7978723404255319
Val acc before epoch 25: 0.7446808510638298
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.643997848033905
	TrainSeparation: 0.5227360010147095
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.32532051282051283
	Val acc at iteration 0: 0.23404255319148937
	Train acc at iteration 2: 0.08974358974358974
	Val acc at iteration 1: 0.20212765957446807
	Train acc at iteration 3: 0.10737179487179487
	Val acc at iteration 2: 0.0851063829787234
	Train acc at iteration 4: 0.07852564102564102
	Val acc at iteration 3: 0.11702127659574468
	Train acc at iteration 5: 0.11378205128205128
	Val acc at iteration 4: 0.14893617021276595
	Train acc at iteration 6: 0.08653846153846154
	Val acc at iteration 5: 0.11702127659574468
	Train acc at iteration 7: 0.1233974358974359
	Val acc at iteration 6: 0.09574468085106383
	Train acc at iteration 8: 0.09775641025641026
	Val acc at iteration 7: 0.10638297872340426
	Train acc at iteration 9: 0.09134615384615384
	Val acc at iteration 8: 0.09574468085106383
	Train acc at iteration 10: 0.10576923076923077
	Val acc at iteration 9: 0.1276595744680851
	Train acc at iteration 11: 0.09615384615384616
	Val acc at iteration 10: 0.14893617021276595
	Train acc at iteration 12: 0.10416666666666667
	Val acc at iteration 11: 0.11702127659574468
	Train acc at iteration 13: 0.09134615384615384
	Val acc at iteration 12: 0.1276595744680851
	Train acc at iteration 14: 0.15384615384615385
	Val acc at iteration 13: 0.13829787234042554
	Train acc at iteration 15: 0.10897435897435898
	Val acc at iteration 14: 0.09574468085106383
	Train acc at iteration 16: 0.11057692307692307
	Val acc at iteration 15: 0.1276595744680851
	Train acc at iteration 17: 0.11698717948717949
	Val acc at iteration 16: 0.14893617021276595
	Train acc at iteration 18: 0.15865384615384615
	Val acc at iteration 17: 0.1276595744680851
	Train acc at iteration 19: 0.16185897435897437
	Val acc at iteration 18: 0.14893617021276595
	Train acc at iteration 20: 0.19230769230769232
	Val acc at iteration 19: 0.24468085106382978
	Train acc at iteration 21: 0.18108974358974358
	Val acc at iteration 20: 0.22340425531914893
	Train acc at iteration 22: 0.23717948717948717
	Val acc at iteration 21: 0.20212765957446807
	Train acc at iteration 23: 0.1907051282051282
	Val acc at iteration 22: 0.24468085106382978
	Train acc at iteration 24: 0.2419871794871795
	Val acc at iteration 23: 0.32978723404255317
	Train acc at iteration 25: 0.3108974358974359
	Val acc at iteration 24: 0.26595744680851063
	Train acc at iteration 26: 0.3125
	Val acc at iteration 25: 0.3829787234042553
	Train acc at iteration 27: 0.33974358974358976
	Val acc at iteration 26: 0.4574468085106383
	Train acc at iteration 28: 0.3814102564102564
	Val acc at iteration 27: 0.32978723404255317
	Train acc at iteration 29: 0.391025641025641
	Val acc at iteration 28: 0.4787234042553192
	Train acc at iteration 30: 0.45032051282051283
	Val acc at iteration 29: 0.574468085106383
	Train acc at iteration 31: 0.5144230769230769
	Val acc at iteration 30: 0.48936170212765956
	Train acc at iteration 32: 0.47115384615384615
	Val acc at iteration 31: 0.5957446808510638
	Train acc at iteration 33: 0.6185897435897436
	Val acc at iteration 32: 0.648936170212766
	Train acc at iteration 34: 0.5849358974358975
	Val acc at iteration 33: 0.6702127659574468
	Train acc at iteration 35: 0.6089743589743589
	Val acc at iteration 34: 0.7446808510638298
	Train acc at iteration 36: 0.6955128205128205
	Val acc at iteration 35: 0.7340425531914894
	Train acc at iteration 37: 0.6698717948717948
	Val acc at iteration 36: 0.6702127659574468
	Train acc at iteration 38: 0.6474358974358975
	Val acc at iteration 37: 0.7340425531914894
	Train acc at iteration 39: 0.6746794871794872
	Val acc at iteration 38: 0.7553191489361702
	Train acc at iteration 40: 0.7339743589743589
	Val acc at iteration 39: 0.6914893617021277
	Train acc at iteration 41: 0.7339743589743589
	Val acc at iteration 40: 0.7021276595744681
	Train acc at iteration 42: 0.6987179487179487
	Val acc at iteration 41: 0.6808510638297872
	Train acc at iteration 43: 0.7051282051282052
	Val acc at iteration 42: 0.7340425531914894
	Train acc at iteration 44: 0.7403846153846154
	Val acc at iteration 43: 0.7340425531914894
	Train acc at iteration 45: 0.7243589743589743
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.7067307692307693
	Val acc at iteration 45: 0.7553191489361702
	Train acc at iteration 47: 0.7387820512820513
	Val acc at iteration 46: 0.6702127659574468
	Train acc at iteration 48: 0.7131410256410257
	Val acc at iteration 47: 0.7340425531914894
	Train acc at iteration 49: 0.7051282051282052
	Val acc at iteration 48: 0.7872340425531915
	Train acc at iteration 50: 0.7211538461538461
	Val acc at iteration 49: 0.6595744680851063
	Train acc at iteration 51: 0.7403846153846154
	Val acc at iteration 50: 0.6914893617021277
	Train acc at iteration 52: 0.7419871794871795
	Val acc at iteration 51: 0.7659574468085106
	Train acc at iteration 53: 0.719551282051282
	Val acc at iteration 52: 0.723404255319149
	Train acc at iteration 54: 0.7099358974358975
	Val acc at iteration 53: 0.7340425531914894
	Train acc at iteration 55: 0.7403846153846154
	Val acc at iteration 54: 0.7127659574468085
	Train acc at iteration 56: 0.717948717948718
	Val acc at iteration 55: 0.7127659574468085
	Train acc at iteration 57: 0.7083333333333334
	Val acc at iteration 56: 0.8085106382978723
	Train acc at iteration 58: 0.7371794871794872
	Val acc at iteration 57: 0.7446808510638298
	Train acc at iteration 59: 0.7467948717948718
	Val acc at iteration 58: 0.7340425531914894
	Train acc at iteration 60: 0.7307692307692307
	Val acc at iteration 59: 0.7978723404255319
	Train acc at iteration 61: 0.7387820512820513
	Val acc at iteration 60: 0.7553191489361702
	Train acc at iteration 62: 0.7243589743589743
	Val acc at iteration 61: 0.776595744680851
	Train acc at iteration 63: 0.7291666666666666
	Val acc at iteration 62: 0.6808510638297872
	Train acc at iteration 64: 0.7275641025641025
	Val acc at iteration 63: 0.7021276595744681
	Train acc at iteration 65: 0.7163461538461539
	Val acc at iteration 64: 0.723404255319149
	Train acc at iteration 66: 0.7564102564102564
	Val acc at iteration 65: 0.8404255319148937
	Train acc at iteration 67: 0.6987179487179487
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.7483974358974359
	Val acc at iteration 67: 0.7872340425531915
	Train acc at iteration 69: 0.7419871794871795
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.7355769230769231
	Val acc at iteration 69: 0.776595744680851
	Train acc at iteration 71: 0.717948717948718
	Val acc at iteration 70: 0.7021276595744681
	Train acc at iteration 72: 0.7051282051282052
	Val acc at iteration 71: 0.6914893617021277
	Train acc at iteration 73: 0.7019230769230769
	Val acc at iteration 72: 0.7553191489361702
	Train acc at iteration 74: 0.7035256410256411
	Val acc at iteration 73: 0.7553191489361702
	Train acc at iteration 75: 0.6955128205128205
	Val acc at iteration 74: 0.7340425531914894
	Train acc at iteration 76: 0.7371794871794872
	Val acc at iteration 75: 0.7978723404255319
	Train acc at iteration 77: 0.7355769230769231
	Val acc at iteration 76: 0.7553191489361702
	Train acc at iteration 78: 0.7259615384615384
	Val acc at iteration 77: 0.7659574468085106
	Train acc at iteration 79: 0.7403846153846154
	Val acc at iteration 78: 0.7659574468085106
	Train acc at iteration 80: 0.719551282051282
	Val acc at iteration 79: 0.7340425531914894
	Train acc at iteration 81: 0.7211538461538461
	Val acc at iteration 80: 0.7872340425531915
	Train acc at iteration 82: 0.7483974358974359
	Val acc at iteration 81: 0.7446808510638298
	Train acc at iteration 83: 0.7275641025641025
	Val acc at iteration 82: 0.7021276595744681
	Train acc at iteration 84: 0.7291666666666666
	Val acc at iteration 83: 0.7340425531914894
	Train acc at iteration 85: 0.717948717948718
	Val acc at iteration 84: 0.6808510638297872
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5874587458745875
Final val micro accuracy: 0.7127659574468085
Final test macro f1-score: 0.5051587301587301
Final test micro accuracy: 0.6276595744680851
Final validation:
	Cluster: 0.6180741488933563
	Separation: 0.5404178500175476
Final test:
	Cluster: 0.5944159030914307
	Separation: 0.5444085597991943
Saved Results

Attempting combination 3/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5319148936170213
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7580128205128205
	Train Cluster: 0.634467089176178
	Train Separation: 0.5173687696456909
(Directly after push) Val acc at iteration 0: 0.5638297872340425
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.5638297872340425
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.6170212765957447
	Val acc at iteration 5: 0.5425531914893617
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.6063829787234043
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6276595744680851
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6276595744680851
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.5957446808510638
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.8085106382978723
	Val acc at iteration 62: 0.7659574468085106
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7340425531914894
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.7446808510638298
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8173076923076923
	Train Cluster: 0.6436674952507019
	Train Separation: 0.5202789902687073
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.8297872340425532
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7553191489361702
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.8085106382978723
	Val acc at iteration 8: 0.8297872340425532
	Val acc at iteration 9: 0.776595744680851
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.776595744680851
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.7659574468085106
	Val acc at iteration 14: 0.5851063829787234
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.8085106382978723
	Val acc at iteration 18: 0.7659574468085106
	Val acc at iteration 19: 0.7659574468085106
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.8085106382978723
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.7659574468085106
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.8085106382978723
	Val acc at iteration 34: 0.7872340425531915
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.8191489361702128
	Val acc at iteration 38: 0.7659574468085106
	Val acc at iteration 39: 0.776595744680851
	Val acc at iteration 40: 0.7872340425531915
	Val acc at iteration 41: 0.7978723404255319
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.8085106382978723
	Val acc at iteration 44: 0.776595744680851
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.7872340425531915
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.8191489361702128
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.8085106382978723
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.7978723404255319
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.8191489361702128
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.7659574468085106
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.8297872340425532
	Val acc at iteration 71: 0.7872340425531915
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.7978723404255319
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.8085106382978723
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.8191489361702128
Val acc before epoch 25: 0.8191489361702128
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9680851063829787
Stopping after epoch 37.
Final validation accuracy before push: 96.80851063829788%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8525641025641025
	Train Cluster: 0.6609951376914978
	TrainSeparation: 0.5289139032363892
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.05
	Train acc at iteration 1: 0.4551282051282051
	Val acc at iteration 0: 0.44680851063829785
	Train acc at iteration 2: 0.3173076923076923
	Val acc at iteration 1: 0.3617021276595745
	Train acc at iteration 3: 0.26121794871794873
	Val acc at iteration 2: 0.32978723404255317
	Train acc at iteration 4: 0.328525641025641
	Val acc at iteration 3: 0.3723404255319149
	Train acc at iteration 5: 0.27403846153846156
	Val acc at iteration 4: 0.35106382978723405
	Train acc at iteration 6: 0.34134615384615385
	Val acc at iteration 5: 0.35106382978723405
	Train acc at iteration 7: 0.3605769230769231
	Val acc at iteration 6: 0.425531914893617
	Train acc at iteration 8: 0.3557692307692308
	Val acc at iteration 7: 0.3723404255319149
	Train acc at iteration 9: 0.4198717948717949
	Val acc at iteration 8: 0.3829787234042553
	Train acc at iteration 10: 0.4310897435897436
	Val acc at iteration 9: 0.3617021276595745
	Train acc at iteration 11: 0.40705128205128205
	Val acc at iteration 10: 0.48936170212765956
	Train acc at iteration 12: 0.42467948717948717
	Val acc at iteration 11: 0.5212765957446809
	Train acc at iteration 13: 0.4855769230769231
	Val acc at iteration 12: 0.648936170212766
	Train acc at iteration 14: 0.46153846153846156
	Val acc at iteration 13: 0.5319148936170213
	Train acc at iteration 15: 0.47115384615384615
	Val acc at iteration 14: 0.5638297872340425
	Train acc at iteration 16: 0.4807692307692308
	Val acc at iteration 15: 0.5957446808510638
	Train acc at iteration 17: 0.5176282051282052
	Val acc at iteration 16: 0.6063829787234043
	Train acc at iteration 18: 0.5432692307692307
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.6041666666666666
	Val acc at iteration 18: 0.5531914893617021
	Train acc at iteration 20: 0.5625
	Val acc at iteration 19: 0.6276595744680851
	Train acc at iteration 21: 0.5721153846153846
	Val acc at iteration 20: 0.574468085106383
	Train acc at iteration 22: 0.5897435897435898
	Val acc at iteration 21: 0.6808510638297872
	Train acc at iteration 23: 0.5993589743589743
	Val acc at iteration 22: 0.7021276595744681
	Train acc at iteration 24: 0.6073717948717948
	Val acc at iteration 23: 0.7021276595744681
	Train acc at iteration 25: 0.6442307692307693
	Val acc at iteration 24: 0.5531914893617021
	Train acc at iteration 26: 0.5737179487179487
	Val acc at iteration 25: 0.648936170212766
	Train acc at iteration 27: 0.6378205128205128
	Val acc at iteration 26: 0.6595744680851063
	Train acc at iteration 28: 0.6073717948717948
	Val acc at iteration 27: 0.6063829787234043
	Train acc at iteration 29: 0.6185897435897436
	Val acc at iteration 28: 0.648936170212766
	Train acc at iteration 30: 0.6378205128205128
	Val acc at iteration 29: 0.7021276595744681
	Train acc at iteration 31: 0.6121794871794872
	Val acc at iteration 30: 0.7127659574468085
	Train acc at iteration 32: 0.6474358974358975
	Val acc at iteration 31: 0.7340425531914894
	Train acc at iteration 33: 0.6185897435897436
	Val acc at iteration 32: 0.648936170212766
	Train acc at iteration 34: 0.5961538461538461
	Val acc at iteration 33: 0.6808510638297872
	Train acc at iteration 35: 0.6314102564102564
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.6233974358974359
	Val acc at iteration 35: 0.6063829787234043
	Train acc at iteration 37: 0.6971153846153846
	Val acc at iteration 36: 0.7340425531914894
	Train acc at iteration 38: 0.6858974358974359
	Val acc at iteration 37: 0.723404255319149
	Train acc at iteration 39: 0.6410256410256411
	Val acc at iteration 38: 0.723404255319149
	Train acc at iteration 40: 0.6794871794871795
	Val acc at iteration 39: 0.6808510638297872
	Train acc at iteration 41: 0.657051282051282
	Val acc at iteration 40: 0.7021276595744681
	Train acc at iteration 42: 0.6474358974358975
	Val acc at iteration 41: 0.6914893617021277
	Train acc at iteration 43: 0.657051282051282
	Val acc at iteration 42: 0.723404255319149
	Train acc at iteration 44: 0.6746794871794872
	Val acc at iteration 43: 0.7340425531914894
	Train acc at iteration 45: 0.6618589743589743
	Val acc at iteration 44: 0.776595744680851
	Train acc at iteration 46: 0.6891025641025641
	Val acc at iteration 45: 0.6914893617021277
	Train acc at iteration 47: 0.6810897435897436
	Val acc at iteration 46: 0.6063829787234043
	Train acc at iteration 48: 0.6875
	Val acc at iteration 47: 0.723404255319149
	Train acc at iteration 49: 0.7371794871794872
	Val acc at iteration 48: 0.7553191489361702
	Train acc at iteration 50: 0.717948717948718
	Val acc at iteration 49: 0.6595744680851063
	Train acc at iteration 51: 0.6746794871794872
	Val acc at iteration 50: 0.7340425531914894
	Train acc at iteration 52: 0.6826923076923077
	Val acc at iteration 51: 0.6595744680851063
	Train acc at iteration 53: 0.6714743589743589
	Val acc at iteration 52: 0.7021276595744681
	Train acc at iteration 54: 0.6987179487179487
	Val acc at iteration 53: 0.7127659574468085
	Train acc at iteration 55: 0.7307692307692307
	Val acc at iteration 54: 0.7127659574468085
	Train acc at iteration 56: 0.717948717948718
	Val acc at iteration 55: 0.723404255319149
	Train acc at iteration 57: 0.6971153846153846
	Val acc at iteration 56: 0.6914893617021277
	Train acc at iteration 58: 0.7051282051282052
	Val acc at iteration 57: 0.6595744680851063
	Train acc at iteration 59: 0.6939102564102564
	Val acc at iteration 58: 0.723404255319149
	Train acc at iteration 60: 0.7211538461538461
	Val acc at iteration 59: 0.6914893617021277
	Train acc at iteration 61: 0.7051282051282052
	Val acc at iteration 60: 0.6914893617021277
	Train acc at iteration 62: 0.6987179487179487
	Val acc at iteration 61: 0.6914893617021277
	Train acc at iteration 63: 0.7051282051282052
	Val acc at iteration 62: 0.7127659574468085
	Train acc at iteration 64: 0.7147435897435898
	Val acc at iteration 63: 0.723404255319149
	Train acc at iteration 65: 0.7227564102564102
	Val acc at iteration 64: 0.8085106382978723
	Train acc at iteration 66: 0.7307692307692307
	Val acc at iteration 65: 0.7553191489361702
	Train acc at iteration 67: 0.7339743589743589
	Val acc at iteration 66: 0.723404255319149
	Train acc at iteration 68: 0.6826923076923077
	Val acc at iteration 67: 0.7553191489361702
	Train acc at iteration 69: 0.6762820512820513
	Val acc at iteration 68: 0.7553191489361702
	Train acc at iteration 70: 0.7339743589743589
	Val acc at iteration 69: 0.8085106382978723
	Train acc at iteration 71: 0.7227564102564102
	Val acc at iteration 70: 0.6808510638297872
	Train acc at iteration 72: 0.6875
	Val acc at iteration 71: 0.851063829787234
	Train acc at iteration 73: 0.7163461538461539
	Val acc at iteration 72: 0.7021276595744681
	Train acc at iteration 74: 0.7211538461538461
	Val acc at iteration 73: 0.7446808510638298
	Train acc at iteration 75: 0.6987179487179487
	Val acc at iteration 74: 0.7553191489361702
	Train acc at iteration 76: 0.7403846153846154
	Val acc at iteration 75: 0.7553191489361702
	Train acc at iteration 77: 0.7147435897435898
	Val acc at iteration 76: 0.8085106382978723
	Train acc at iteration 78: 0.6746794871794872
	Val acc at iteration 77: 0.776595744680851
	Train acc at iteration 79: 0.7451923076923077
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.7339743589743589
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.7419871794871795
	Val acc at iteration 80: 0.7127659574468085
	Train acc at iteration 82: 0.7051282051282052
	Val acc at iteration 81: 0.7659574468085106
	Train acc at iteration 83: 0.7051282051282052
	Val acc at iteration 82: 0.6382978723404256
	Train acc at iteration 84: 0.7291666666666666
	Val acc at iteration 83: 0.7553191489361702
	Train acc at iteration 85: 0.7003205128205128
	Val acc at iteration 84: 0.7021276595744681
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5642611683848797
Final val micro accuracy: 0.6595744680851063
Final test macro f1-score: 0.5635854341736695
Final test micro accuracy: 0.6914893617021277
Final validation:
	Cluster: 0.6174545288085938
	Separation: 0.5377880334854126
Final test:
	Cluster: 0.60384202003479
	Separation: 0.5414698123931885
Saved Results

Attempting combination 4/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.01
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.425531914893617
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Train Cluster: 0.6519452214241028
	Train Separation: 0.5198206186294556
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.6914893617021277
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.7446808510638298
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.574468085106383
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.7659574468085106
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.6170212765957447
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.776595744680851
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.8191489361702128
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.7978723404255319
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7872340425531915
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.6382978723404256
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.6914893617021277
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.7872340425531915
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.7659574468085106
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.7872340425531915
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 13: 0.7553191489361702
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8085106382978723
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.8205128205128205
	Train Cluster: 0.6437639474868775
	Train Separation: 0.5201975464820862
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.776595744680851
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.8617021276595744
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7978723404255319
	Val acc at iteration 6: 0.776595744680851
	Val acc at iteration 7: 0.7872340425531915
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.8191489361702128
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.7659574468085106
	Val acc at iteration 12: 0.8404255319148937
	Val acc at iteration 13: 0.8297872340425532
	Val acc at iteration 14: 0.7872340425531915
	Val acc at iteration 15: 0.8404255319148937
	Val acc at iteration 16: 0.7978723404255319
	Val acc at iteration 17: 0.776595744680851
	Val acc at iteration 18: 0.776595744680851
	Val acc at iteration 19: 0.8085106382978723
	Val acc at iteration 20: 0.7659574468085106
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.776595744680851
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.7978723404255319
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.8191489361702128
	Val acc at iteration 29: 0.7978723404255319
	Val acc at iteration 30: 0.7978723404255319
	Val acc at iteration 31: 0.776595744680851
	Val acc at iteration 32: 0.7978723404255319
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.7872340425531915
	Val acc at iteration 35: 0.8085106382978723
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.8297872340425532
	Val acc at iteration 38: 0.7553191489361702
	Val acc at iteration 39: 0.7872340425531915
	Val acc at iteration 40: 0.7553191489361702
	Val acc at iteration 41: 0.7978723404255319
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.8404255319148937
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.8191489361702128
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7659574468085106
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.7978723404255319
	Val acc at iteration 50: 0.8191489361702128
	Val acc at iteration 51: 0.7872340425531915
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.8404255319148937
	Val acc at iteration 54: 0.8191489361702128
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.7978723404255319
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.8085106382978723
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.8617021276595744
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.8191489361702128
	Val acc at iteration 64: 0.8191489361702128
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.8936170212765957
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.8085106382978723
	Val acc at iteration 70: 0.7978723404255319
	Val acc at iteration 71: 0.8191489361702128
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.8191489361702128
	Val acc at iteration 76: 0.8297872340425532
	Val acc at iteration 77: 0.7340425531914894
	Val acc at iteration 78: 0.8297872340425532
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.8191489361702128
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.8191489361702128
Val acc before epoch 25: 0.7446808510638298
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8653846153846154
	Train Cluster: 0.6495309829711914
	TrainSeparation: 0.5177037715911865
(Directly after push) Val acc at iteration 0: 0.8297872340425532
Retraining last layer
Last layer lr: 0.01
	Train acc at iteration 1: 0.7644230769230769
	Val acc at iteration 0: 0.7021276595744681
	Train acc at iteration 2: 0.7163461538461539
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.6875
	Val acc at iteration 2: 0.7021276595744681
	Train acc at iteration 4: 0.6891025641025641
	Val acc at iteration 3: 0.6914893617021277
	Train acc at iteration 5: 0.7051282051282052
	Val acc at iteration 4: 0.7446808510638298
	Train acc at iteration 6: 0.7163461538461539
	Val acc at iteration 5: 0.6382978723404256
	Train acc at iteration 7: 0.6907051282051282
	Val acc at iteration 6: 0.6382978723404256
	Train acc at iteration 8: 0.6762820512820513
	Val acc at iteration 7: 0.7127659574468085
	Train acc at iteration 9: 0.6778846153846154
	Val acc at iteration 8: 0.7340425531914894
	Train acc at iteration 10: 0.7051282051282052
	Val acc at iteration 9: 0.7446808510638298
	Train acc at iteration 11: 0.7692307692307693
	Val acc at iteration 10: 0.7446808510638298
	Train acc at iteration 12: 0.7516025641025641
	Val acc at iteration 11: 0.7340425531914894
	Train acc at iteration 13: 0.7051282051282052
	Val acc at iteration 12: 0.7659574468085106
	Train acc at iteration 14: 0.7548076923076923
	Val acc at iteration 13: 0.776595744680851
	Train acc at iteration 15: 0.7275641025641025
	Val acc at iteration 14: 0.7659574468085106
	Train acc at iteration 16: 0.7323717948717948
	Val acc at iteration 15: 0.7340425531914894
	Train acc at iteration 17: 0.7692307692307693
	Val acc at iteration 16: 0.7872340425531915
	Train acc at iteration 18: 0.7628205128205128
	Val acc at iteration 17: 0.8085106382978723
	Train acc at iteration 19: 0.7371794871794872
	Val acc at iteration 18: 0.7340425531914894
	Train acc at iteration 20: 0.7676282051282052
	Val acc at iteration 19: 0.6808510638297872
	Train acc at iteration 21: 0.7660256410256411
	Val acc at iteration 20: 0.776595744680851
	Train acc at iteration 22: 0.7612179487179487
	Val acc at iteration 21: 0.8085106382978723
	Train acc at iteration 23: 0.782051282051282
	Val acc at iteration 22: 0.8191489361702128
	Train acc at iteration 24: 0.7564102564102564
	Val acc at iteration 23: 0.8191489361702128
	Train acc at iteration 25: 0.7900641025641025
	Val acc at iteration 24: 0.7659574468085106
	Train acc at iteration 26: 0.7724358974358975
	Val acc at iteration 25: 0.8085106382978723
	Train acc at iteration 27: 0.8012820512820513
	Val acc at iteration 26: 0.7872340425531915
	Train acc at iteration 28: 0.7772435897435898
	Val acc at iteration 27: 0.7872340425531915
	Train acc at iteration 29: 0.7996794871794872
	Val acc at iteration 28: 0.8191489361702128
	Train acc at iteration 30: 0.8012820512820513
	Val acc at iteration 29: 0.7553191489361702
	Train acc at iteration 31: 0.7948717948717948
	Val acc at iteration 30: 0.8297872340425532
	Train acc at iteration 32: 0.7756410256410257
	Val acc at iteration 31: 0.8191489361702128
	Train acc at iteration 33: 0.7884615384615384
	Val acc at iteration 32: 0.8297872340425532
	Train acc at iteration 34: 0.7996794871794872
	Val acc at iteration 33: 0.8191489361702128
	Train acc at iteration 35: 0.8157051282051282
	Val acc at iteration 34: 0.776595744680851
	Train acc at iteration 36: 0.8060897435897436
	Val acc at iteration 35: 0.7872340425531915
	Train acc at iteration 37: 0.8012820512820513
	Val acc at iteration 36: 0.8297872340425532
	Train acc at iteration 38: 0.8269230769230769
	Val acc at iteration 37: 0.8085106382978723
	Train acc at iteration 39: 0.8205128205128205
	Val acc at iteration 38: 0.8404255319148937
	Train acc at iteration 40: 0.8189102564102564
	Val acc at iteration 39: 0.8085106382978723
	Train acc at iteration 41: 0.8141025641025641
	Val acc at iteration 40: 0.776595744680851
	Train acc at iteration 42: 0.8092948717948718
	Val acc at iteration 41: 0.8404255319148937
	Train acc at iteration 43: 0.8141025641025641
	Val acc at iteration 42: 0.8085106382978723
	Train acc at iteration 44: 0.8669871794871795
	Val acc at iteration 43: 0.8404255319148937
	Train acc at iteration 45: 0.8365384615384616
	Val acc at iteration 44: 0.8297872340425532
	Train acc at iteration 46: 0.8237179487179487
	Val acc at iteration 45: 0.8723404255319149
	Train acc at iteration 47: 0.7948717948717948
	Val acc at iteration 46: 0.8617021276595744
	Train acc at iteration 48: 0.8028846153846154
	Val acc at iteration 47: 0.8617021276595744
	Train acc at iteration 49: 0.8541666666666666
	Val acc at iteration 48: 0.851063829787234
	Train acc at iteration 50: 0.842948717948718
	Val acc at iteration 49: 0.8404255319148937
	Train acc at iteration 51: 0.8253205128205128
	Val acc at iteration 50: 0.8297872340425532
	Train acc at iteration 52: 0.842948717948718
	Val acc at iteration 51: 0.8297872340425532
	Train acc at iteration 53: 0.8701923076923077
	Val acc at iteration 52: 0.8191489361702128
	Train acc at iteration 54: 0.8525641025641025
	Val acc at iteration 53: 0.851063829787234
	Train acc at iteration 55: 0.8589743589743589
	Val acc at iteration 54: 0.8723404255319149
	Train acc at iteration 56: 0.8173076923076923
	Val acc at iteration 55: 0.8297872340425532
	Train acc at iteration 57: 0.8365384615384616
	Val acc at iteration 56: 0.8404255319148937
	Train acc at iteration 58: 0.8509615384615384
	Val acc at iteration 57: 0.8936170212765957
	Train acc at iteration 59: 0.8157051282051282
	Val acc at iteration 58: 0.8404255319148937
	Train acc at iteration 60: 0.8557692307692307
	Val acc at iteration 59: 0.8191489361702128
	Train acc at iteration 61: 0.8397435897435898
	Val acc at iteration 60: 0.9042553191489362
	Train acc at iteration 62: 0.8798076923076923
	Val acc at iteration 61: 0.8723404255319149
	Train acc at iteration 63: 0.8541666666666666
	Val acc at iteration 62: 0.8829787234042553
	Train acc at iteration 64: 0.8525641025641025
	Val acc at iteration 63: 0.8829787234042553
	Train acc at iteration 65: 0.8653846153846154
	Val acc at iteration 64: 0.8297872340425532
	Train acc at iteration 66: 0.8253205128205128
	Val acc at iteration 65: 0.8404255319148937
	Train acc at iteration 67: 0.8397435897435898
	Val acc at iteration 66: 0.8723404255319149
	Train acc at iteration 68: 0.842948717948718
	Val acc at iteration 67: 0.851063829787234
	Train acc at iteration 69: 0.8605769230769231
	Val acc at iteration 68: 0.851063829787234
	Train acc at iteration 70: 0.8637820512820513
	Val acc at iteration 69: 0.8829787234042553
	Train acc at iteration 71: 0.8846153846153846
	Val acc at iteration 70: 0.8723404255319149
	Train acc at iteration 72: 0.8605769230769231
	Val acc at iteration 71: 0.8829787234042553
	Train acc at iteration 73: 0.8589743589743589
	Val acc at iteration 72: 0.851063829787234
	Train acc at iteration 74: 0.8413461538461539
	Val acc at iteration 73: 0.8617021276595744
	Train acc at iteration 75: 0.8589743589743589
	Val acc at iteration 74: 0.851063829787234
	Train acc at iteration 76: 0.8685897435897436
	Val acc at iteration 75: 0.851063829787234
	Train acc at iteration 77: 0.8557692307692307
	Val acc at iteration 76: 0.8829787234042553
	Train acc at iteration 78: 0.8717948717948718
	Val acc at iteration 77: 0.8191489361702128
	Train acc at iteration 79: 0.8685897435897436
	Val acc at iteration 78: 0.9148936170212766
	Train acc at iteration 80: 0.8669871794871795
	Val acc at iteration 79: 0.8829787234042553
	Train acc at iteration 81: 0.8541666666666666
	Val acc at iteration 80: 0.8085106382978723
	Train acc at iteration 82: 0.8733974358974359
	Val acc at iteration 81: 0.8191489361702128
	Train acc at iteration 83: 0.8557692307692307
	Val acc at iteration 82: 0.9042553191489362
	Train acc at iteration 84: 0.8461538461538461
	Val acc at iteration 83: 0.925531914893617
	Train acc at iteration 85: 0.8798076923076923
	Val acc at iteration 84: 0.8297872340425532
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.8814814814814814
Final val micro accuracy: 0.925531914893617
Final test macro f1-score: 0.6930894308943089
Final test micro accuracy: 0.7978723404255319
Final validation:
	Cluster: 0.6238952279090881
	Separation: 0.5463893115520477
Final test:
	Cluster: 0.6199115812778473
	Separation: 0.5398093461990356
Saved Results

Attempting combination 5/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5319148936170213
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7446808510638298
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7596153846153846
	Train Cluster: 0.6463025569915771
	Train Separation: 0.5221914887428284
(Directly after push) Val acc at iteration 0: 0.6170212765957447
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.574468085106383
	Val acc at iteration 1: 0.574468085106383
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.648936170212766
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.7553191489361702
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.7553191489361702
	Val acc at iteration 24: 0.6382978723404256
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7659574468085106
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.5957446808510638
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7446808510638298
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.7872340425531915
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.776595744680851
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7872340425531915
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.7978723404255319
	Val acc at iteration 60: 0.7872340425531915
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.8297872340425532
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.8085106382978723
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 13: 0.7127659574468085
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9787234042553191
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9787234042553191
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7852564102564102
	Train Cluster: 0.6484092593193054
	Train Separation: 0.5199014663696289
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.776595744680851
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.7872340425531915
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.776595744680851
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.7978723404255319
	Val acc at iteration 10: 0.7446808510638298
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.7978723404255319
	Val acc at iteration 13: 0.7553191489361702
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.7659574468085106
	Val acc at iteration 16: 0.8297872340425532
	Val acc at iteration 17: 0.8191489361702128
	Val acc at iteration 18: 0.7872340425531915
	Val acc at iteration 19: 0.8085106382978723
	Val acc at iteration 20: 0.7872340425531915
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.7978723404255319
	Val acc at iteration 26: 0.7659574468085106
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.8085106382978723
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.851063829787234
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7978723404255319
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.7872340425531915
	Val acc at iteration 37: 0.8404255319148937
	Val acc at iteration 38: 0.7872340425531915
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.7553191489361702
	Val acc at iteration 41: 0.8191489361702128
	Val acc at iteration 42: 0.7978723404255319
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.7978723404255319
	Val acc at iteration 46: 0.7872340425531915
	Val acc at iteration 47: 0.8191489361702128
	Val acc at iteration 48: 0.7872340425531915
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7872340425531915
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.7978723404255319
	Val acc at iteration 53: 0.776595744680851
	Val acc at iteration 54: 0.8085106382978723
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.8085106382978723
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.8191489361702128
	Val acc at iteration 62: 0.8829787234042553
	Val acc at iteration 63: 0.8404255319148937
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.8191489361702128
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.8404255319148937
	Val acc at iteration 68: 0.7872340425531915
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.8191489361702128
	Val acc at iteration 72: 0.8297872340425532
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.8191489361702128
	Val acc at iteration 75: 0.8085106382978723
	Val acc at iteration 76: 0.7978723404255319
	Val acc at iteration 77: 0.8191489361702128
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.8191489361702128
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 25: 0.8191489361702128
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9042553191489362
Stopping after epoch 37.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.844551282051282
	Train Cluster: 0.6445367693901062
	TrainSeparation: 0.5195158839225769
(Directly after push) Val acc at iteration 0: 0.8404255319148937
Retraining last layer
Last layer lr: 0.005
	Train acc at iteration 1: 0.7948717948717948
	Val acc at iteration 0: 0.7553191489361702
	Train acc at iteration 2: 0.8189102564102564
	Val acc at iteration 1: 0.776595744680851
	Train acc at iteration 3: 0.8012820512820513
	Val acc at iteration 2: 0.7553191489361702
	Train acc at iteration 4: 0.8012820512820513
	Val acc at iteration 3: 0.723404255319149
	Train acc at iteration 5: 0.8092948717948718
	Val acc at iteration 4: 0.8085106382978723
	Train acc at iteration 6: 0.7900641025641025
	Val acc at iteration 5: 0.7553191489361702
	Train acc at iteration 7: 0.782051282051282
	Val acc at iteration 6: 0.723404255319149
	Train acc at iteration 8: 0.7948717948717948
	Val acc at iteration 7: 0.7021276595744681
	Train acc at iteration 9: 0.7932692307692307
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.7964743589743589
	Val acc at iteration 9: 0.7446808510638298
	Train acc at iteration 11: 0.7788461538461539
	Val acc at iteration 10: 0.7446808510638298
	Train acc at iteration 12: 0.7980769230769231
	Val acc at iteration 11: 0.776595744680851
	Train acc at iteration 13: 0.7948717948717948
	Val acc at iteration 12: 0.8085106382978723
	Train acc at iteration 14: 0.8173076923076923
	Val acc at iteration 13: 0.8085106382978723
	Train acc at iteration 15: 0.8125
	Val acc at iteration 14: 0.7872340425531915
	Train acc at iteration 16: 0.8157051282051282
	Val acc at iteration 15: 0.7553191489361702
	Train acc at iteration 17: 0.8221153846153846
	Val acc at iteration 16: 0.7659574468085106
	Train acc at iteration 18: 0.7900641025641025
	Val acc at iteration 17: 0.7553191489361702
	Train acc at iteration 19: 0.7932692307692307
	Val acc at iteration 18: 0.7659574468085106
	Train acc at iteration 20: 0.8301282051282052
	Val acc at iteration 19: 0.723404255319149
	Train acc at iteration 21: 0.8205128205128205
	Val acc at iteration 20: 0.7553191489361702
	Train acc at iteration 22: 0.8205128205128205
	Val acc at iteration 21: 0.8085106382978723
	Train acc at iteration 23: 0.8205128205128205
	Val acc at iteration 22: 0.7340425531914894
	Train acc at iteration 24: 0.8044871794871795
	Val acc at iteration 23: 0.7446808510638298
	Train acc at iteration 25: 0.8157051282051282
	Val acc at iteration 24: 0.7978723404255319
	Train acc at iteration 26: 0.8221153846153846
	Val acc at iteration 25: 0.7553191489361702
	Train acc at iteration 27: 0.7964743589743589
	Val acc at iteration 26: 0.7553191489361702
	Train acc at iteration 28: 0.8269230769230769
	Val acc at iteration 27: 0.7978723404255319
	Train acc at iteration 29: 0.782051282051282
	Val acc at iteration 28: 0.8297872340425532
	Train acc at iteration 30: 0.8253205128205128
	Val acc at iteration 29: 0.8297872340425532
	Train acc at iteration 31: 0.8221153846153846
	Val acc at iteration 30: 0.7553191489361702
	Train acc at iteration 32: 0.8189102564102564
	Val acc at iteration 31: 0.7553191489361702
	Train acc at iteration 33: 0.8157051282051282
	Val acc at iteration 32: 0.7872340425531915
	Train acc at iteration 34: 0.7964743589743589
	Val acc at iteration 33: 0.7872340425531915
	Train acc at iteration 35: 0.8413461538461539
	Val acc at iteration 34: 0.8617021276595744
	Train acc at iteration 36: 0.8044871794871795
	Val acc at iteration 35: 0.7978723404255319
	Train acc at iteration 37: 0.8397435897435898
	Val acc at iteration 36: 0.851063829787234
	Train acc at iteration 38: 0.842948717948718
	Val acc at iteration 37: 0.8617021276595744
	Train acc at iteration 39: 0.8189102564102564
	Val acc at iteration 38: 0.8085106382978723
	Train acc at iteration 40: 0.8381410256410257
	Val acc at iteration 39: 0.8191489361702128
	Train acc at iteration 41: 0.8269230769230769
	Val acc at iteration 40: 0.8085106382978723
	Train acc at iteration 42: 0.8333333333333334
	Val acc at iteration 41: 0.7978723404255319
	Train acc at iteration 43: 0.8317307692307693
	Val acc at iteration 42: 0.8297872340425532
	Train acc at iteration 44: 0.8637820512820513
	Val acc at iteration 43: 0.9148936170212766
	Train acc at iteration 45: 0.8301282051282052
	Val acc at iteration 44: 0.851063829787234
	Train acc at iteration 46: 0.8605769230769231
	Val acc at iteration 45: 0.776595744680851
	Train acc at iteration 47: 0.8205128205128205
	Val acc at iteration 46: 0.851063829787234
	Train acc at iteration 48: 0.8333333333333334
	Val acc at iteration 47: 0.8723404255319149
	Train acc at iteration 49: 0.8525641025641025
	Val acc at iteration 48: 0.776595744680851
	Train acc at iteration 50: 0.8349358974358975
	Val acc at iteration 49: 0.8404255319148937
	Train acc at iteration 51: 0.8541666666666666
	Val acc at iteration 50: 0.851063829787234
	Train acc at iteration 52: 0.8189102564102564
	Val acc at iteration 51: 0.8617021276595744
	Train acc at iteration 53: 0.8301282051282052
	Val acc at iteration 52: 0.8829787234042553
	Train acc at iteration 54: 0.8221153846153846
	Val acc at iteration 53: 0.8191489361702128
	Train acc at iteration 55: 0.8413461538461539
	Val acc at iteration 54: 0.8936170212765957
	Train acc at iteration 56: 0.8253205128205128
	Val acc at iteration 55: 0.8191489361702128
	Train acc at iteration 57: 0.8733974358974359
	Val acc at iteration 56: 0.8404255319148937
	Train acc at iteration 58: 0.8557692307692307
	Val acc at iteration 57: 0.8723404255319149
	Train acc at iteration 59: 0.8557692307692307
	Val acc at iteration 58: 0.8191489361702128
	Train acc at iteration 60: 0.8381410256410257
	Val acc at iteration 59: 0.8297872340425532
	Train acc at iteration 61: 0.8557692307692307
	Val acc at iteration 60: 0.8617021276595744
	Train acc at iteration 62: 0.844551282051282
	Val acc at iteration 61: 0.8404255319148937
	Train acc at iteration 63: 0.8637820512820513
	Val acc at iteration 62: 0.8085106382978723
	Train acc at iteration 64: 0.8846153846153846
	Val acc at iteration 63: 0.8404255319148937
	Train acc at iteration 65: 0.8685897435897436
	Val acc at iteration 64: 0.8936170212765957
	Train acc at iteration 66: 0.8733974358974359
	Val acc at iteration 65: 0.851063829787234
	Train acc at iteration 67: 0.8814102564102564
	Val acc at iteration 66: 0.8617021276595744
	Train acc at iteration 68: 0.8846153846153846
	Val acc at iteration 67: 0.8723404255319149
	Train acc at iteration 69: 0.8477564102564102
	Val acc at iteration 68: 0.851063829787234
	Train acc at iteration 70: 0.8621794871794872
	Val acc at iteration 69: 0.851063829787234
	Train acc at iteration 71: 0.875
	Val acc at iteration 70: 0.851063829787234
	Train acc at iteration 72: 0.8509615384615384
	Val acc at iteration 71: 0.8723404255319149
	Train acc at iteration 73: 0.8525641025641025
	Val acc at iteration 72: 0.851063829787234
	Train acc at iteration 74: 0.8782051282051282
	Val acc at iteration 73: 0.8404255319148937
	Train acc at iteration 75: 0.8766025641025641
	Val acc at iteration 74: 0.8723404255319149
	Train acc at iteration 76: 0.875
	Val acc at iteration 75: 0.851063829787234
	Train acc at iteration 77: 0.8605769230769231
	Val acc at iteration 76: 0.8617021276595744
	Train acc at iteration 78: 0.8974358974358975
	Val acc at iteration 77: 0.8404255319148937
	Train acc at iteration 79: 0.8589743589743589
	Val acc at iteration 78: 0.8617021276595744
	Train acc at iteration 80: 0.8830128205128205
	Val acc at iteration 79: 0.8297872340425532
	Train acc at iteration 81: 0.8798076923076923
	Val acc at iteration 80: 0.8829787234042553
	Train acc at iteration 82: 0.8766025641025641
	Val acc at iteration 81: 0.776595744680851
	Train acc at iteration 83: 0.8990384615384616
	Val acc at iteration 82: 0.8829787234042553
	Train acc at iteration 84: 0.8461538461538461
	Val acc at iteration 83: 0.8617021276595744
	Train acc at iteration 85: 0.8637820512820513
	Val acc at iteration 84: 0.8297872340425532
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7893772893772893
Final val micro accuracy: 0.851063829787234
Final test macro f1-score: 0.6845528455284553
Final test micro accuracy: 0.7659574468085106
Final validation:
	Cluster: 0.6321258842945099
	Separation: 0.5343443751335144
Final test:
	Cluster: 0.6074482202529907
	Separation: 0.5442081987857819
Saved Results

Attempting combination 6/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.6528388381004333
	Train Separation: 0.5261908173561096
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5957446808510638
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.5957446808510638
	Val acc at iteration 3: 0.5638297872340425
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.7872340425531915
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.7659574468085106
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.7659574468085106
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.776595744680851
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.7978723404255319
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.7872340425531915
	Val acc at iteration 48: 0.7659574468085106
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.7978723404255319
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.8617021276595744
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.8191489361702128
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 13: 0.7127659574468085
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8349358974358975
	Train Cluster: 0.6462677717208862
	Train Separation: 0.5230881571769714
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.7872340425531915
	Val acc at iteration 3: 0.851063829787234
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.7553191489361702
	Val acc at iteration 9: 0.776595744680851
	Val acc at iteration 10: 0.7659574468085106
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.7446808510638298
	Val acc at iteration 14: 0.776595744680851
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.7978723404255319
	Val acc at iteration 17: 0.7659574468085106
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.8085106382978723
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.7872340425531915
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.7872340425531915
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.776595744680851
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.7872340425531915
	Val acc at iteration 30: 0.8297872340425532
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.8191489361702128
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.7872340425531915
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7978723404255319
	Val acc at iteration 41: 0.7659574468085106
	Val acc at iteration 42: 0.776595744680851
	Val acc at iteration 43: 0.7659574468085106
	Val acc at iteration 44: 0.8191489361702128
	Val acc at iteration 45: 0.7659574468085106
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.7872340425531915
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.8085106382978723
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.776595744680851
	Val acc at iteration 52: 0.8085106382978723
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7659574468085106
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.8191489361702128
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.8297872340425532
	Val acc at iteration 62: 0.7872340425531915
	Val acc at iteration 63: 0.7978723404255319
	Val acc at iteration 64: 0.8085106382978723
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.7978723404255319
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7978723404255319
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.8404255319148937
	Val acc at iteration 73: 0.7872340425531915
	Val acc at iteration 74: 0.8085106382978723
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.8085106382978723
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.8191489361702128
	Val acc at iteration 84: 0.7978723404255319
Val acc before epoch 25: 0.7340425531914894
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8205128205128205
	Train Cluster: 0.6438603878021241
	TrainSeparation: 0.5214076638221741
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.001
	Train acc at iteration 1: 0.8125
	Val acc at iteration 0: 0.776595744680851
	Train acc at iteration 2: 0.842948717948718
	Val acc at iteration 1: 0.7872340425531915
	Train acc at iteration 3: 0.8044871794871795
	Val acc at iteration 2: 0.7659574468085106
	Train acc at iteration 4: 0.8333333333333334
	Val acc at iteration 3: 0.7446808510638298
	Train acc at iteration 5: 0.8413461538461539
	Val acc at iteration 4: 0.8404255319148937
	Train acc at iteration 6: 0.8461538461538461
	Val acc at iteration 5: 0.8085106382978723
	Train acc at iteration 7: 0.8108974358974359
	Val acc at iteration 6: 0.8404255319148937
	Train acc at iteration 8: 0.844551282051282
	Val acc at iteration 7: 0.8617021276595744
	Train acc at iteration 9: 0.8269230769230769
	Val acc at iteration 8: 0.8191489361702128
	Train acc at iteration 10: 0.8413461538461539
	Val acc at iteration 9: 0.8191489361702128
	Train acc at iteration 11: 0.8397435897435898
	Val acc at iteration 10: 0.8297872340425532
	Train acc at iteration 12: 0.8189102564102564
	Val acc at iteration 11: 0.8297872340425532
	Train acc at iteration 13: 0.8285256410256411
	Val acc at iteration 12: 0.776595744680851
	Train acc at iteration 14: 0.8237179487179487
	Val acc at iteration 13: 0.851063829787234
	Train acc at iteration 15: 0.8461538461538461
	Val acc at iteration 14: 0.776595744680851
	Train acc at iteration 16: 0.8301282051282052
	Val acc at iteration 15: 0.8191489361702128
	Train acc at iteration 17: 0.842948717948718
	Val acc at iteration 16: 0.8191489361702128
	Train acc at iteration 18: 0.8317307692307693
	Val acc at iteration 17: 0.8085106382978723
	Train acc at iteration 19: 0.8173076923076923
	Val acc at iteration 18: 0.8191489361702128
	Train acc at iteration 20: 0.8333333333333334
	Val acc at iteration 19: 0.8404255319148937
	Train acc at iteration 21: 0.8189102564102564
	Val acc at iteration 20: 0.8085106382978723
	Train acc at iteration 22: 0.8189102564102564
	Val acc at iteration 21: 0.7446808510638298
	Train acc at iteration 23: 0.8381410256410257
	Val acc at iteration 22: 0.7978723404255319
	Train acc at iteration 24: 0.8317307692307693
	Val acc at iteration 23: 0.8085106382978723
	Train acc at iteration 25: 0.8317307692307693
	Val acc at iteration 24: 0.7446808510638298
	Train acc at iteration 26: 0.8189102564102564
	Val acc at iteration 25: 0.7978723404255319
	Train acc at iteration 27: 0.8605769230769231
	Val acc at iteration 26: 0.8617021276595744
	Train acc at iteration 28: 0.8461538461538461
	Val acc at iteration 27: 0.8191489361702128
	Train acc at iteration 29: 0.8397435897435898
	Val acc at iteration 28: 0.7978723404255319
	Train acc at iteration 30: 0.8237179487179487
	Val acc at iteration 29: 0.776595744680851
	Train acc at iteration 31: 0.8493589743589743
	Val acc at iteration 30: 0.8191489361702128
	Train acc at iteration 32: 0.8157051282051282
	Val acc at iteration 31: 0.8404255319148937
	Train acc at iteration 33: 0.8509615384615384
	Val acc at iteration 32: 0.8297872340425532
	Train acc at iteration 34: 0.8221153846153846
	Val acc at iteration 33: 0.7978723404255319
	Train acc at iteration 35: 0.8685897435897436
	Val acc at iteration 34: 0.8617021276595744
	Train acc at iteration 36: 0.8509615384615384
	Val acc at iteration 35: 0.8404255319148937
	Train acc at iteration 37: 0.8637820512820513
	Val acc at iteration 36: 0.8085106382978723
	Train acc at iteration 38: 0.8637820512820513
	Val acc at iteration 37: 0.8297872340425532
	Train acc at iteration 39: 0.8317307692307693
	Val acc at iteration 38: 0.8191489361702128
	Train acc at iteration 40: 0.8221153846153846
	Val acc at iteration 39: 0.7659574468085106
	Train acc at iteration 41: 0.8285256410256411
	Val acc at iteration 40: 0.7872340425531915
	Train acc at iteration 42: 0.8541666666666666
	Val acc at iteration 41: 0.8191489361702128
	Train acc at iteration 43: 0.8541666666666666
	Val acc at iteration 42: 0.7659574468085106
	Train acc at iteration 44: 0.8141025641025641
	Val acc at iteration 43: 0.7872340425531915
	Train acc at iteration 45: 0.8285256410256411
	Val acc at iteration 44: 0.8191489361702128
	Train acc at iteration 46: 0.8493589743589743
	Val acc at iteration 45: 0.7872340425531915
	Train acc at iteration 47: 0.8237179487179487
	Val acc at iteration 46: 0.7340425531914894
	Train acc at iteration 48: 0.8525641025641025
	Val acc at iteration 47: 0.8617021276595744
	Train acc at iteration 49: 0.8605769230769231
	Val acc at iteration 48: 0.8297872340425532
	Train acc at iteration 50: 0.8189102564102564
	Val acc at iteration 49: 0.8191489361702128
	Train acc at iteration 51: 0.8285256410256411
	Val acc at iteration 50: 0.8191489361702128
	Train acc at iteration 52: 0.8365384615384616
	Val acc at iteration 51: 0.8404255319148937
	Train acc at iteration 53: 0.8605769230769231
	Val acc at iteration 52: 0.8723404255319149
	Train acc at iteration 54: 0.844551282051282
	Val acc at iteration 53: 0.7446808510638298
	Train acc at iteration 55: 0.8253205128205128
	Val acc at iteration 54: 0.8404255319148937
	Train acc at iteration 56: 0.8413461538461539
	Val acc at iteration 55: 0.7872340425531915
	Train acc at iteration 57: 0.8669871794871795
	Val acc at iteration 56: 0.851063829787234
	Train acc at iteration 58: 0.8413461538461539
	Val acc at iteration 57: 0.7978723404255319
	Train acc at iteration 59: 0.8557692307692307
	Val acc at iteration 58: 0.7340425531914894
	Train acc at iteration 60: 0.8541666666666666
	Val acc at iteration 59: 0.8085106382978723
	Train acc at iteration 61: 0.8301282051282052
	Val acc at iteration 60: 0.8191489361702128
	Train acc at iteration 62: 0.8621794871794872
	Val acc at iteration 61: 0.7872340425531915
	Train acc at iteration 63: 0.8413461538461539
	Val acc at iteration 62: 0.8297872340425532
	Train acc at iteration 64: 0.844551282051282
	Val acc at iteration 63: 0.7553191489361702
	Train acc at iteration 65: 0.8477564102564102
	Val acc at iteration 64: 0.8297872340425532
	Train acc at iteration 66: 0.8525641025641025
	Val acc at iteration 65: 0.7978723404255319
	Train acc at iteration 67: 0.8557692307692307
	Val acc at iteration 66: 0.776595744680851
	Train acc at iteration 68: 0.8685897435897436
	Val acc at iteration 67: 0.7978723404255319
	Train acc at iteration 69: 0.8669871794871795
	Val acc at iteration 68: 0.8191489361702128
	Train acc at iteration 70: 0.8653846153846154
	Val acc at iteration 69: 0.8404255319148937
	Train acc at iteration 71: 0.8669871794871795
	Val acc at iteration 70: 0.8191489361702128
	Train acc at iteration 72: 0.8413461538461539
	Val acc at iteration 71: 0.851063829787234
	Train acc at iteration 73: 0.8541666666666666
	Val acc at iteration 72: 0.776595744680851
	Train acc at iteration 74: 0.8589743589743589
	Val acc at iteration 73: 0.7978723404255319
	Train acc at iteration 75: 0.8349358974358975
	Val acc at iteration 74: 0.8191489361702128
	Train acc at iteration 76: 0.844551282051282
	Val acc at iteration 75: 0.8297872340425532
	Train acc at iteration 77: 0.842948717948718
	Val acc at iteration 76: 0.8085106382978723
	Train acc at iteration 78: 0.844551282051282
	Val acc at iteration 77: 0.8404255319148937
	Train acc at iteration 79: 0.8477564102564102
	Val acc at iteration 78: 0.723404255319149
	Train acc at iteration 80: 0.8637820512820513
	Val acc at iteration 79: 0.8191489361702128
	Train acc at iteration 81: 0.844551282051282
	Val acc at iteration 80: 0.8297872340425532
	Train acc at iteration 82: 0.8493589743589743
	Val acc at iteration 81: 0.7872340425531915
	Train acc at iteration 83: 0.8605769230769231
	Val acc at iteration 82: 0.7978723404255319
	Train acc at iteration 84: 0.8349358974358975
	Val acc at iteration 83: 0.8297872340425532
	Train acc at iteration 85: 0.8605769230769231
	Val acc at iteration 84: 0.9042553191489362
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.7074468085106385
Final val micro accuracy: 0.7872340425531915
Final test macro f1-score: 0.683739837398374
Final test micro accuracy: 0.776595744680851
Final validation:
	Cluster: 0.6320889294147491
	Separation: 0.5461694300174713
Final test:
	Cluster: 0.6141704618930817
	Separation: 0.5410591661930084
Saved Results

Attempting combination 7/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7756410256410257
	Train Cluster: 0.6437593698501587
	Train Separation: 0.5192004561424255
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.574468085106383
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.7659574468085106
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.6170212765957447
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6276595744680851
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.6276595744680851
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.7553191489361702
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.776595744680851
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.6595744680851063
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.6595744680851063
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.7659574468085106
Val acc before epoch 13: 0.7553191489361702
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.8205128205128205
	Train Cluster: 0.6507348895072937
	Train Separation: 0.5226675391197204
(Directly after push) Val acc at iteration 0: 0.7978723404255319
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.8085106382978723
	Val acc at iteration 1: 0.8191489361702128
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.7872340425531915
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.7978723404255319
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.8191489361702128
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.776595744680851
	Val acc at iteration 17: 0.7872340425531915
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.776595744680851
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7446808510638298
	Val acc at iteration 22: 0.7446808510638298
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7978723404255319
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.8404255319148937
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.8085106382978723
	Val acc at iteration 35: 0.776595744680851
	Val acc at iteration 36: 0.7659574468085106
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.8085106382978723
	Val acc at iteration 39: 0.7978723404255319
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.8297872340425532
	Val acc at iteration 44: 0.8404255319148937
	Val acc at iteration 45: 0.7553191489361702
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.7872340425531915
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.776595744680851
	Val acc at iteration 52: 0.8085106382978723
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.7978723404255319
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.7872340425531915
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.8085106382978723
	Val acc at iteration 60: 0.8085106382978723
	Val acc at iteration 61: 0.8404255319148937
	Val acc at iteration 62: 0.7659574468085106
	Val acc at iteration 63: 0.8297872340425532
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7659574468085106
	Val acc at iteration 70: 0.7872340425531915
	Val acc at iteration 71: 0.8085106382978723
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.8085106382978723
	Val acc at iteration 74: 0.8297872340425532
	Val acc at iteration 75: 0.776595744680851
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.7340425531914894
	Val acc at iteration 78: 0.8085106382978723
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.7872340425531915
	Val acc at iteration 84: 0.7872340425531915
Val acc before epoch 25: 0.7553191489361702
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8605769230769231
	Train Cluster: 0.6499592542648316
	TrainSeparation: 0.5192708015441895
(Directly after push) Val acc at iteration 0: 0.8085106382978723
Retraining last layer
Last layer lr: 0.0005
	Train acc at iteration 1: 0.8397435897435898
	Val acc at iteration 0: 0.8191489361702128
	Train acc at iteration 2: 0.8349358974358975
	Val acc at iteration 1: 0.8191489361702128
	Train acc at iteration 3: 0.8205128205128205
	Val acc at iteration 2: 0.8297872340425532
	Train acc at iteration 4: 0.8301282051282052
	Val acc at iteration 3: 0.851063829787234
	Train acc at iteration 5: 0.8365384615384616
	Val acc at iteration 4: 0.7872340425531915
	Train acc at iteration 6: 0.8317307692307693
	Val acc at iteration 5: 0.7978723404255319
	Train acc at iteration 7: 0.8589743589743589
	Val acc at iteration 6: 0.7446808510638298
	Train acc at iteration 8: 0.8125
	Val acc at iteration 7: 0.7659574468085106
	Train acc at iteration 9: 0.8365384615384616
	Val acc at iteration 8: 0.8085106382978723
	Train acc at iteration 10: 0.8413461538461539
	Val acc at iteration 9: 0.7340425531914894
	Train acc at iteration 11: 0.8413461538461539
	Val acc at iteration 10: 0.723404255319149
	Train acc at iteration 12: 0.8317307692307693
	Val acc at iteration 11: 0.8191489361702128
	Train acc at iteration 13: 0.8205128205128205
	Val acc at iteration 12: 0.8085106382978723
	Train acc at iteration 14: 0.8253205128205128
	Val acc at iteration 13: 0.7872340425531915
	Train acc at iteration 15: 0.8285256410256411
	Val acc at iteration 14: 0.8085106382978723
	Train acc at iteration 16: 0.8317307692307693
	Val acc at iteration 15: 0.776595744680851
	Train acc at iteration 17: 0.8397435897435898
	Val acc at iteration 16: 0.8085106382978723
	Train acc at iteration 18: 0.8205128205128205
	Val acc at iteration 17: 0.7978723404255319
	Train acc at iteration 19: 0.8221153846153846
	Val acc at iteration 18: 0.7978723404255319
	Train acc at iteration 20: 0.844551282051282
	Val acc at iteration 19: 0.7659574468085106
	Train acc at iteration 21: 0.8557692307692307
	Val acc at iteration 20: 0.8191489361702128
	Train acc at iteration 22: 0.8637820512820513
	Val acc at iteration 21: 0.776595744680851
	Train acc at iteration 23: 0.8205128205128205
	Val acc at iteration 22: 0.7978723404255319
	Train acc at iteration 24: 0.8301282051282052
	Val acc at iteration 23: 0.8085106382978723
	Train acc at iteration 25: 0.8493589743589743
	Val acc at iteration 24: 0.8297872340425532
	Train acc at iteration 26: 0.8509615384615384
	Val acc at iteration 25: 0.7553191489361702
	Train acc at iteration 27: 0.8333333333333334
	Val acc at iteration 26: 0.7872340425531915
	Train acc at iteration 28: 0.8541666666666666
	Val acc at iteration 27: 0.7659574468085106
	Train acc at iteration 29: 0.8317307692307693
	Val acc at iteration 28: 0.776595744680851
	Train acc at iteration 30: 0.8205128205128205
	Val acc at iteration 29: 0.8829787234042553
	Train acc at iteration 31: 0.842948717948718
	Val acc at iteration 30: 0.8297872340425532
	Train acc at iteration 32: 0.8141025641025641
	Val acc at iteration 31: 0.8404255319148937
	Train acc at iteration 33: 0.844551282051282
	Val acc at iteration 32: 0.7340425531914894
	Train acc at iteration 34: 0.844551282051282
	Val acc at iteration 33: 0.7659574468085106
	Train acc at iteration 35: 0.8621794871794872
	Val acc at iteration 34: 0.776595744680851
	Train acc at iteration 36: 0.8573717948717948
	Val acc at iteration 35: 0.8191489361702128
	Train acc at iteration 37: 0.8285256410256411
	Val acc at iteration 36: 0.851063829787234
	Train acc at iteration 38: 0.8237179487179487
	Val acc at iteration 37: 0.8297872340425532
	Train acc at iteration 39: 0.8557692307692307
	Val acc at iteration 38: 0.776595744680851
	Train acc at iteration 40: 0.8557692307692307
	Val acc at iteration 39: 0.8085106382978723
	Train acc at iteration 41: 0.8285256410256411
	Val acc at iteration 40: 0.7021276595744681
	Train acc at iteration 42: 0.8477564102564102
	Val acc at iteration 41: 0.8191489361702128
	Train acc at iteration 43: 0.8333333333333334
	Val acc at iteration 42: 0.8404255319148937
	Train acc at iteration 44: 0.8461538461538461
	Val acc at iteration 43: 0.8297872340425532
	Train acc at iteration 45: 0.8237179487179487
	Val acc at iteration 44: 0.8191489361702128
	Train acc at iteration 46: 0.8253205128205128
	Val acc at iteration 45: 0.8191489361702128
	Train acc at iteration 47: 0.8141025641025641
	Val acc at iteration 46: 0.8191489361702128
	Train acc at iteration 48: 0.8285256410256411
	Val acc at iteration 47: 0.7978723404255319
	Train acc at iteration 49: 0.8541666666666666
	Val acc at iteration 48: 0.8297872340425532
	Train acc at iteration 50: 0.8573717948717948
	Val acc at iteration 49: 0.851063829787234
	Train acc at iteration 51: 0.8637820512820513
	Val acc at iteration 50: 0.8191489361702128
	Train acc at iteration 52: 0.8477564102564102
	Val acc at iteration 51: 0.8085106382978723
	Train acc at iteration 53: 0.8157051282051282
	Val acc at iteration 52: 0.7553191489361702
	Train acc at iteration 54: 0.844551282051282
	Val acc at iteration 53: 0.8297872340425532
	Train acc at iteration 55: 0.8333333333333334
	Val acc at iteration 54: 0.7978723404255319
	Train acc at iteration 56: 0.8173076923076923
	Val acc at iteration 55: 0.7872340425531915
	Train acc at iteration 57: 0.8766025641025641
	Val acc at iteration 56: 0.7872340425531915
	Train acc at iteration 58: 0.8493589743589743
	Val acc at iteration 57: 0.8297872340425532
	Train acc at iteration 59: 0.8221153846153846
	Val acc at iteration 58: 0.7553191489361702
	Train acc at iteration 60: 0.8525641025641025
	Val acc at iteration 59: 0.7872340425531915
	Train acc at iteration 61: 0.8349358974358975
	Val acc at iteration 60: 0.8085106382978723
	Train acc at iteration 62: 0.8221153846153846
	Val acc at iteration 61: 0.8297872340425532
	Train acc at iteration 63: 0.8733974358974359
	Val acc at iteration 62: 0.8085106382978723
	Train acc at iteration 64: 0.8589743589743589
	Val acc at iteration 63: 0.7978723404255319
	Train acc at iteration 65: 0.8076923076923077
	Val acc at iteration 64: 0.851063829787234
	Train acc at iteration 66: 0.8349358974358975
	Val acc at iteration 65: 0.7659574468085106
	Train acc at iteration 67: 0.844551282051282
	Val acc at iteration 66: 0.8297872340425532
	Train acc at iteration 68: 0.844551282051282
	Val acc at iteration 67: 0.723404255319149
	Train acc at iteration 69: 0.8397435897435898
	Val acc at iteration 68: 0.8297872340425532
	Train acc at iteration 70: 0.8301282051282052
	Val acc at iteration 69: 0.7978723404255319
	Train acc at iteration 71: 0.8653846153846154
	Val acc at iteration 70: 0.7978723404255319
	Train acc at iteration 72: 0.8413461538461539
	Val acc at iteration 71: 0.8617021276595744
	Train acc at iteration 73: 0.8493589743589743
	Val acc at iteration 72: 0.8191489361702128
	Train acc at iteration 74: 0.8573717948717948
	Val acc at iteration 73: 0.8085106382978723
	Train acc at iteration 75: 0.8477564102564102
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.8525641025641025
	Val acc at iteration 75: 0.7872340425531915
	Train acc at iteration 77: 0.8589743589743589
	Val acc at iteration 76: 0.8404255319148937
	Train acc at iteration 78: 0.8541666666666666
	Val acc at iteration 77: 0.8085106382978723
	Train acc at iteration 79: 0.842948717948718
	Val acc at iteration 78: 0.8191489361702128
	Train acc at iteration 80: 0.8605769230769231
	Val acc at iteration 79: 0.776595744680851
	Train acc at iteration 81: 0.8461538461538461
	Val acc at iteration 80: 0.851063829787234
	Train acc at iteration 82: 0.8301282051282052
	Val acc at iteration 81: 0.7553191489361702
	Train acc at iteration 83: 0.842948717948718
	Val acc at iteration 82: 0.776595744680851
	Train acc at iteration 84: 0.8397435897435898
	Val acc at iteration 83: 0.776595744680851
	Train acc at iteration 85: 0.8413461538461539
	Val acc at iteration 84: 0.851063829787234
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6547619047619048
Final val micro accuracy: 0.7659574468085106
Final test macro f1-score: 0.5389513108614231
Final test micro accuracy: 0.6595744680851063
Final validation:
	Cluster: 0.6211073696613312
	Separation: 0.5384983122348785
Final test:
	Cluster: 0.605561375617981
	Separation: 0.5422497987747192
Saved Results

Attempting combination 8/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8617021276595744
Push epoch
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Train Cluster: 0.6489238500595093
	Train Separation: 0.5267693400382996
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.5851063829787234
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.5851063829787234
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6063829787234043
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6276595744680851
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7978723404255319
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.6170212765957447
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.7446808510638298
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.8085106382978723
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 13: 0.7446808510638298
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7980769230769231
	Train Cluster: 0.6496879816055298
	Train Separation: 0.5229083895683289
(Directly after push) Val acc at iteration 0: 0.8404255319148937
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7978723404255319
	Val acc at iteration 1: 0.7340425531914894
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.7978723404255319
	Val acc at iteration 8: 0.7659574468085106
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.776595744680851
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.7659574468085106
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.7659574468085106
	Val acc at iteration 17: 0.7659574468085106
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.7659574468085106
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7978723404255319
	Val acc at iteration 22: 0.7446808510638298
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.776595744680851
	Val acc at iteration 27: 0.776595744680851
	Val acc at iteration 28: 0.8297872340425532
	Val acc at iteration 29: 0.776595744680851
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.8085106382978723
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7872340425531915
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.8191489361702128
	Val acc at iteration 40: 0.7978723404255319
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.8085106382978723
	Val acc at iteration 44: 0.8191489361702128
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.8297872340425532
	Val acc at iteration 47: 0.776595744680851
	Val acc at iteration 48: 0.8191489361702128
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.8191489361702128
	Val acc at iteration 56: 0.7978723404255319
	Val acc at iteration 57: 0.7978723404255319
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.7872340425531915
	Val acc at iteration 60: 0.7446808510638298
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.8085106382978723
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7978723404255319
	Val acc at iteration 71: 0.7553191489361702
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.7872340425531915
	Val acc at iteration 74: 0.7978723404255319
	Val acc at iteration 75: 0.776595744680851
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.8404255319148937
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.7978723404255319
	Val acc at iteration 81: 0.8297872340425532
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.7446808510638298
Val acc before epoch 25: 0.8191489361702128
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8269230769230769
	Train Cluster: 0.6569661140441895
	TrainSeparation: 0.5221406102180481
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.0001
	Train acc at iteration 1: 0.8173076923076923
	Val acc at iteration 0: 0.7659574468085106
	Train acc at iteration 2: 0.8237179487179487
	Val acc at iteration 1: 0.776595744680851
	Train acc at iteration 3: 0.8413461538461539
	Val acc at iteration 2: 0.7659574468085106
	Train acc at iteration 4: 0.8301282051282052
	Val acc at iteration 3: 0.8404255319148937
	Train acc at iteration 5: 0.8525641025641025
	Val acc at iteration 4: 0.7872340425531915
	Train acc at iteration 6: 0.8525641025641025
	Val acc at iteration 5: 0.851063829787234
	Train acc at iteration 7: 0.8541666666666666
	Val acc at iteration 6: 0.776595744680851
	Train acc at iteration 8: 0.8477564102564102
	Val acc at iteration 7: 0.8085106382978723
	Train acc at iteration 9: 0.844551282051282
	Val acc at iteration 8: 0.8191489361702128
	Train acc at iteration 10: 0.844551282051282
	Val acc at iteration 9: 0.7978723404255319
	Train acc at iteration 11: 0.8173076923076923
	Val acc at iteration 10: 0.7553191489361702
	Train acc at iteration 12: 0.842948717948718
	Val acc at iteration 11: 0.7872340425531915
	Train acc at iteration 13: 0.875
	Val acc at iteration 12: 0.8085106382978723
	Train acc at iteration 14: 0.8349358974358975
	Val acc at iteration 13: 0.7978723404255319
	Train acc at iteration 15: 0.842948717948718
	Val acc at iteration 14: 0.7978723404255319
	Train acc at iteration 16: 0.8509615384615384
	Val acc at iteration 15: 0.8404255319148937
	Train acc at iteration 17: 0.8461538461538461
	Val acc at iteration 16: 0.7872340425531915
	Train acc at iteration 18: 0.8333333333333334
	Val acc at iteration 17: 0.7978723404255319
	Train acc at iteration 19: 0.8397435897435898
	Val acc at iteration 18: 0.776595744680851
	Train acc at iteration 20: 0.8493589743589743
	Val acc at iteration 19: 0.7978723404255319
	Train acc at iteration 21: 0.875
	Val acc at iteration 20: 0.7553191489361702
	Train acc at iteration 22: 0.8205128205128205
	Val acc at iteration 21: 0.7872340425531915
	Train acc at iteration 23: 0.8381410256410257
	Val acc at iteration 22: 0.8085106382978723
	Train acc at iteration 24: 0.8381410256410257
	Val acc at iteration 23: 0.7872340425531915
	Train acc at iteration 25: 0.842948717948718
	Val acc at iteration 24: 0.7340425531914894
	Train acc at iteration 26: 0.8253205128205128
	Val acc at iteration 25: 0.723404255319149
	Train acc at iteration 27: 0.8365384615384616
	Val acc at iteration 26: 0.8191489361702128
	Train acc at iteration 28: 0.8461538461538461
	Val acc at iteration 27: 0.7553191489361702
	Train acc at iteration 29: 0.8493589743589743
	Val acc at iteration 28: 0.7553191489361702
	Train acc at iteration 30: 0.8317307692307693
	Val acc at iteration 29: 0.7978723404255319
	Train acc at iteration 31: 0.8413461538461539
	Val acc at iteration 30: 0.8297872340425532
	Train acc at iteration 32: 0.8509615384615384
	Val acc at iteration 31: 0.7553191489361702
	Train acc at iteration 33: 0.8349358974358975
	Val acc at iteration 32: 0.776595744680851
	Train acc at iteration 34: 0.8365384615384616
	Val acc at iteration 33: 0.7978723404255319
	Train acc at iteration 35: 0.8397435897435898
	Val acc at iteration 34: 0.8085106382978723
	Train acc at iteration 36: 0.8397435897435898
	Val acc at iteration 35: 0.7978723404255319
	Train acc at iteration 37: 0.8333333333333334
	Val acc at iteration 36: 0.7872340425531915
	Train acc at iteration 38: 0.8461538461538461
	Val acc at iteration 37: 0.8191489361702128
	Train acc at iteration 39: 0.8557692307692307
	Val acc at iteration 38: 0.7553191489361702
	Train acc at iteration 40: 0.8365384615384616
	Val acc at iteration 39: 0.7978723404255319
	Train acc at iteration 41: 0.8333333333333334
	Val acc at iteration 40: 0.8085106382978723
	Train acc at iteration 42: 0.8557692307692307
	Val acc at iteration 41: 0.8085106382978723
	Train acc at iteration 43: 0.8461538461538461
	Val acc at iteration 42: 0.8617021276595744
	Train acc at iteration 44: 0.844551282051282
	Val acc at iteration 43: 0.8404255319148937
	Train acc at iteration 45: 0.8189102564102564
	Val acc at iteration 44: 0.8297872340425532
	Train acc at iteration 46: 0.8269230769230769
	Val acc at iteration 45: 0.8297872340425532
	Train acc at iteration 47: 0.8493589743589743
	Val acc at iteration 46: 0.776595744680851
	Train acc at iteration 48: 0.8509615384615384
	Val acc at iteration 47: 0.8085106382978723
	Train acc at iteration 49: 0.8044871794871795
	Val acc at iteration 48: 0.7872340425531915
	Train acc at iteration 50: 0.8605769230769231
	Val acc at iteration 49: 0.7127659574468085
	Train acc at iteration 51: 0.8237179487179487
	Val acc at iteration 50: 0.776595744680851
	Train acc at iteration 52: 0.8141025641025641
	Val acc at iteration 51: 0.7553191489361702
	Train acc at iteration 53: 0.8621794871794872
	Val acc at iteration 52: 0.7872340425531915
	Train acc at iteration 54: 0.8317307692307693
	Val acc at iteration 53: 0.7978723404255319
	Train acc at iteration 55: 0.8413461538461539
	Val acc at iteration 54: 0.7872340425531915
	Train acc at iteration 56: 0.8301282051282052
	Val acc at iteration 55: 0.8297872340425532
	Train acc at iteration 57: 0.8493589743589743
	Val acc at iteration 56: 0.8617021276595744
	Train acc at iteration 58: 0.8173076923076923
	Val acc at iteration 57: 0.7978723404255319
	Train acc at iteration 59: 0.8381410256410257
	Val acc at iteration 58: 0.7978723404255319
	Train acc at iteration 60: 0.8413461538461539
	Val acc at iteration 59: 0.7872340425531915
	Train acc at iteration 61: 0.8461538461538461
	Val acc at iteration 60: 0.7872340425531915
	Train acc at iteration 62: 0.8493589743589743
	Val acc at iteration 61: 0.8085106382978723
	Train acc at iteration 63: 0.8557692307692307
	Val acc at iteration 62: 0.7872340425531915
	Train acc at iteration 64: 0.844551282051282
	Val acc at iteration 63: 0.776595744680851
	Train acc at iteration 65: 0.8573717948717948
	Val acc at iteration 64: 0.8191489361702128
	Train acc at iteration 66: 0.8285256410256411
	Val acc at iteration 65: 0.8191489361702128
	Train acc at iteration 67: 0.8381410256410257
	Val acc at iteration 66: 0.7127659574468085
	Train acc at iteration 68: 0.8285256410256411
	Val acc at iteration 67: 0.7340425531914894
	Train acc at iteration 69: 0.8365384615384616
	Val acc at iteration 68: 0.8297872340425532
	Train acc at iteration 70: 0.8365384615384616
	Val acc at iteration 69: 0.7978723404255319
	Train acc at iteration 71: 0.8173076923076923
	Val acc at iteration 70: 0.7553191489361702
	Train acc at iteration 72: 0.8333333333333334
	Val acc at iteration 71: 0.7978723404255319
	Train acc at iteration 73: 0.8621794871794872
	Val acc at iteration 72: 0.7659574468085106
	Train acc at iteration 74: 0.8413461538461539
	Val acc at iteration 73: 0.8191489361702128
	Train acc at iteration 75: 0.8349358974358975
	Val acc at iteration 74: 0.7340425531914894
	Train acc at iteration 76: 0.8397435897435898
	Val acc at iteration 75: 0.8297872340425532
	Train acc at iteration 77: 0.8269230769230769
	Val acc at iteration 76: 0.8085106382978723
	Train acc at iteration 78: 0.8477564102564102
	Val acc at iteration 77: 0.8297872340425532
	Train acc at iteration 79: 0.8413461538461539
	Val acc at iteration 78: 0.8191489361702128
	Train acc at iteration 80: 0.8525641025641025
	Val acc at iteration 79: 0.776595744680851
	Train acc at iteration 81: 0.8269230769230769
	Val acc at iteration 80: 0.7978723404255319
	Train acc at iteration 82: 0.8237179487179487
	Val acc at iteration 81: 0.7553191489361702
	Train acc at iteration 83: 0.844551282051282
	Val acc at iteration 82: 0.8297872340425532
	Train acc at iteration 84: 0.842948717948718
	Val acc at iteration 83: 0.7340425531914894
	Train acc at iteration 85: 0.8253205128205128
	Val acc at iteration 84: 0.776595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.8113553113553112
Final val micro accuracy: 0.8617021276595744
Final test macro f1-score: 0.5800766283524904
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.6253441274166107
	Separation: 0.5382800698280334
Final test:
	Cluster: 0.5921008586883545
	Separation: 0.5357131659984589
Saved Results

Attempting combination 9/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 5e-05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6063829787234043
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Train Cluster: 0.642374062538147
	Train Separation: 0.5217140913009644
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6170212765957447
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.6170212765957447
	Val acc at iteration 9: 0.6170212765957447
	Val acc at iteration 10: 0.6170212765957447
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7978723404255319
	Val acc at iteration 36: 0.7446808510638298
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.7659574468085106
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.8085106382978723
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.7978723404255319
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.776595744680851
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.7659574468085106
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.8191489361702128
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.7021276595744681
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Train Cluster: 0.6546580910682678
	Train Separation: 0.5246710181236267
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.7021276595744681
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.776595744680851
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.7340425531914894
	Val acc at iteration 9: 0.776595744680851
	Val acc at iteration 10: 0.776595744680851
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7659574468085106
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.7978723404255319
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.776595744680851
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.7978723404255319
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.8085106382978723
	Val acc at iteration 23: 0.776595744680851
	Val acc at iteration 24: 0.7978723404255319
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7553191489361702
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.7659574468085106
	Val acc at iteration 34: 0.7872340425531915
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7553191489361702
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7978723404255319
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.776595744680851
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.7978723404255319
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.7978723404255319
	Val acc at iteration 51: 0.8085106382978723
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.7978723404255319
	Val acc at iteration 57: 0.7659574468085106
	Val acc at iteration 58: 0.7978723404255319
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.8404255319148937
	Val acc at iteration 62: 0.7872340425531915
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7978723404255319
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7872340425531915
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7872340425531915
	Val acc at iteration 78: 0.7872340425531915
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.8191489361702128
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.8191489361702128
Val acc before epoch 25: 0.7340425531914894
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9042553191489362
Stopping after epoch 37.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8605769230769231
	Train Cluster: 0.6482914328575134
	TrainSeparation: 0.5222175598144532
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 5e-05
	Train acc at iteration 1: 0.8125
	Val acc at iteration 0: 0.723404255319149
	Train acc at iteration 2: 0.8525641025641025
	Val acc at iteration 1: 0.8404255319148937
	Train acc at iteration 3: 0.8461538461538461
	Val acc at iteration 2: 0.776595744680851
	Train acc at iteration 4: 0.8413461538461539
	Val acc at iteration 3: 0.7978723404255319
	Train acc at iteration 5: 0.8509615384615384
	Val acc at iteration 4: 0.7659574468085106
	Train acc at iteration 6: 0.8477564102564102
	Val acc at iteration 5: 0.851063829787234
	Train acc at iteration 7: 0.8461538461538461
	Val acc at iteration 6: 0.7659574468085106
	Train acc at iteration 8: 0.8477564102564102
	Val acc at iteration 7: 0.7872340425531915
	Train acc at iteration 9: 0.8365384615384616
	Val acc at iteration 8: 0.7978723404255319
	Train acc at iteration 10: 0.8397435897435898
	Val acc at iteration 9: 0.7659574468085106
	Train acc at iteration 11: 0.8573717948717948
	Val acc at iteration 10: 0.8723404255319149
	Train acc at iteration 12: 0.8381410256410257
	Val acc at iteration 11: 0.6808510638297872
	Train acc at iteration 13: 0.8493589743589743
	Val acc at iteration 12: 0.7978723404255319
	Train acc at iteration 14: 0.8365384615384616
	Val acc at iteration 13: 0.851063829787234
	Train acc at iteration 15: 0.8541666666666666
	Val acc at iteration 14: 0.776595744680851
	Train acc at iteration 16: 0.8221153846153846
	Val acc at iteration 15: 0.7978723404255319
	Train acc at iteration 17: 0.8381410256410257
	Val acc at iteration 16: 0.7446808510638298
	Train acc at iteration 18: 0.8525641025641025
	Val acc at iteration 17: 0.723404255319149
	Train acc at iteration 19: 0.8798076923076923
	Val acc at iteration 18: 0.7978723404255319
	Train acc at iteration 20: 0.8413461538461539
	Val acc at iteration 19: 0.8191489361702128
	Train acc at iteration 21: 0.8301282051282052
	Val acc at iteration 20: 0.8297872340425532
	Train acc at iteration 22: 0.8413461538461539
	Val acc at iteration 21: 0.7659574468085106
	Train acc at iteration 23: 0.8541666666666666
	Val acc at iteration 22: 0.7127659574468085
	Train acc at iteration 24: 0.8269230769230769
	Val acc at iteration 23: 0.8297872340425532
	Train acc at iteration 25: 0.8333333333333334
	Val acc at iteration 24: 0.7127659574468085
	Train acc at iteration 26: 0.8413461538461539
	Val acc at iteration 25: 0.776595744680851
	Train acc at iteration 27: 0.8397435897435898
	Val acc at iteration 26: 0.7659574468085106
	Train acc at iteration 28: 0.8541666666666666
	Val acc at iteration 27: 0.8085106382978723
	Train acc at iteration 29: 0.8397435897435898
	Val acc at iteration 28: 0.8297872340425532
	Train acc at iteration 30: 0.8381410256410257
	Val acc at iteration 29: 0.7872340425531915
	Train acc at iteration 31: 0.8317307692307693
	Val acc at iteration 30: 0.776595744680851
	Train acc at iteration 32: 0.8509615384615384
	Val acc at iteration 31: 0.776595744680851
	Train acc at iteration 33: 0.8253205128205128
	Val acc at iteration 32: 0.7872340425531915
	Train acc at iteration 34: 0.842948717948718
	Val acc at iteration 33: 0.7659574468085106
	Train acc at iteration 35: 0.8397435897435898
	Val acc at iteration 34: 0.7340425531914894
	Train acc at iteration 36: 0.8573717948717948
	Val acc at iteration 35: 0.8404255319148937
	Train acc at iteration 37: 0.8285256410256411
	Val acc at iteration 36: 0.8085106382978723
	Train acc at iteration 38: 0.8253205128205128
	Val acc at iteration 37: 0.7659574468085106
	Train acc at iteration 39: 0.8381410256410257
	Val acc at iteration 38: 0.8085106382978723
	Train acc at iteration 40: 0.8285256410256411
	Val acc at iteration 39: 0.7340425531914894
	Train acc at iteration 41: 0.8060897435897436
	Val acc at iteration 40: 0.8085106382978723
	Train acc at iteration 42: 0.8365384615384616
	Val acc at iteration 41: 0.7553191489361702
	Train acc at iteration 43: 0.8285256410256411
	Val acc at iteration 42: 0.8085106382978723
	Train acc at iteration 44: 0.8301282051282052
	Val acc at iteration 43: 0.7659574468085106
	Train acc at iteration 45: 0.8573717948717948
	Val acc at iteration 44: 0.7659574468085106
	Train acc at iteration 46: 0.8317307692307693
	Val acc at iteration 45: 0.7659574468085106
	Train acc at iteration 47: 0.8589743589743589
	Val acc at iteration 46: 0.7446808510638298
	Train acc at iteration 48: 0.8493589743589743
	Val acc at iteration 47: 0.8085106382978723
	Train acc at iteration 49: 0.8333333333333334
	Val acc at iteration 48: 0.8297872340425532
	Train acc at iteration 50: 0.8253205128205128
	Val acc at iteration 49: 0.7659574468085106
	Train acc at iteration 51: 0.8541666666666666
	Val acc at iteration 50: 0.7978723404255319
	Train acc at iteration 52: 0.8461538461538461
	Val acc at iteration 51: 0.8297872340425532
	Train acc at iteration 53: 0.8605769230769231
	Val acc at iteration 52: 0.776595744680851
	Train acc at iteration 54: 0.8525641025641025
	Val acc at iteration 53: 0.7127659574468085
	Train acc at iteration 55: 0.8269230769230769
	Val acc at iteration 54: 0.776595744680851
	Train acc at iteration 56: 0.8605769230769231
	Val acc at iteration 55: 0.776595744680851
	Train acc at iteration 57: 0.8253205128205128
	Val acc at iteration 56: 0.7978723404255319
	Train acc at iteration 58: 0.8237179487179487
	Val acc at iteration 57: 0.7659574468085106
	Train acc at iteration 59: 0.8461538461538461
	Val acc at iteration 58: 0.8404255319148937
	Train acc at iteration 60: 0.8525641025641025
	Val acc at iteration 59: 0.8297872340425532
	Train acc at iteration 61: 0.8349358974358975
	Val acc at iteration 60: 0.7340425531914894
	Train acc at iteration 62: 0.8669871794871795
	Val acc at iteration 61: 0.7978723404255319
	Train acc at iteration 63: 0.8413461538461539
	Val acc at iteration 62: 0.851063829787234
	Train acc at iteration 64: 0.8349358974358975
	Val acc at iteration 63: 0.8191489361702128
	Train acc at iteration 65: 0.842948717948718
	Val acc at iteration 64: 0.8085106382978723
	Train acc at iteration 66: 0.8605769230769231
	Val acc at iteration 65: 0.8085106382978723
	Train acc at iteration 67: 0.8253205128205128
	Val acc at iteration 66: 0.7553191489361702
	Train acc at iteration 68: 0.8189102564102564
	Val acc at iteration 67: 0.7872340425531915
	Train acc at iteration 69: 0.8285256410256411
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.8621794871794872
	Val acc at iteration 69: 0.7659574468085106
	Train acc at iteration 71: 0.8493589743589743
	Val acc at iteration 70: 0.7872340425531915
	Train acc at iteration 72: 0.8333333333333334
	Val acc at iteration 71: 0.7659574468085106
	Train acc at iteration 73: 0.844551282051282
	Val acc at iteration 72: 0.8191489361702128
	Train acc at iteration 74: 0.8333333333333334
	Val acc at iteration 73: 0.8191489361702128
	Train acc at iteration 75: 0.8333333333333334
	Val acc at iteration 74: 0.7446808510638298
	Train acc at iteration 76: 0.8285256410256411
	Val acc at iteration 75: 0.7659574468085106
	Train acc at iteration 77: 0.8237179487179487
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.8589743589743589
	Val acc at iteration 77: 0.776595744680851
	Train acc at iteration 79: 0.8349358974358975
	Val acc at iteration 78: 0.7978723404255319
	Train acc at iteration 80: 0.842948717948718
	Val acc at iteration 79: 0.7446808510638298
	Train acc at iteration 81: 0.8253205128205128
	Val acc at iteration 80: 0.8191489361702128
	Train acc at iteration 82: 0.8413461538461539
	Val acc at iteration 81: 0.7872340425531915
	Train acc at iteration 83: 0.844551282051282
	Val acc at iteration 82: 0.7872340425531915
	Train acc at iteration 84: 0.844551282051282
	Val acc at iteration 83: 0.723404255319149
	Train acc at iteration 85: 0.8525641025641025
	Val acc at iteration 84: 0.8404255319148937
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.736111111111111
Final val micro accuracy: 0.8297872340425532
Final test macro f1-score: 0.550187265917603
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.6204690635204315
	Separation: 0.5408200919628143
Final test:
	Cluster: 0.6060126721858978
	Separation: 0.5401847958564758
Saved Results

Attempting combination 10/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.782051282051282
	Train Cluster: 0.6428705096244812
	Train Separation: 0.5182169437408447
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.6170212765957447
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.5851063829787234
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6063829787234043
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6276595744680851
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.5957446808510638
	Val acc at iteration 36: 0.6382978723404256
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.5957446808510638
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.6170212765957447
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.6170212765957447
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.6063829787234043
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7127659574468085
Val acc before epoch 13: 0.7021276595744681
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8237179487179487
	Train Cluster: 0.6542395234107972
	Train Separation: 0.522633719444275
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7659574468085106
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.7659574468085106
	Val acc at iteration 3: 0.8297872340425532
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.7872340425531915
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.776595744680851
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.8297872340425532
	Val acc at iteration 18: 0.776595744680851
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.776595744680851
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.7446808510638298
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.776595744680851
	Val acc at iteration 38: 0.7553191489361702
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.7127659574468085
	Val acc at iteration 42: 0.7659574468085106
	Val acc at iteration 43: 0.7340425531914894
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.776595744680851
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.7872340425531915
	Val acc at iteration 58: 0.7978723404255319
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.7978723404255319
	Val acc at iteration 63: 0.7872340425531915
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.7978723404255319
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.6808510638297872
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 25: 0.7659574468085106
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9680851063829787
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9042553191489362
Stopping after epoch 37.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8397435897435898
	Train Cluster: 0.6523398637771607
	TrainSeparation: 0.5206028103828431
(Directly after push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.22916666666666666
	Val acc at iteration 0: 0.010638297872340425
	Train acc at iteration 2: 0.008012820512820512
	Val acc at iteration 1: 0.031914893617021274
	Train acc at iteration 3: 0.016025641025641024
	Val acc at iteration 2: 0.0425531914893617
	Train acc at iteration 4: 0.011217948717948718
	Val acc at iteration 3: 0.010638297872340425
	Train acc at iteration 5: 0.02564102564102564
	Val acc at iteration 4: 0.010638297872340425
	Train acc at iteration 6: 0.02403846153846154
	Val acc at iteration 5: 0.0425531914893617
	Train acc at iteration 7: 0.04006410256410257
	Val acc at iteration 6: 0.06382978723404255
	Train acc at iteration 8: 0.030448717948717948
	Val acc at iteration 7: 0.0425531914893617
	Train acc at iteration 9: 0.020833333333333332
	Val acc at iteration 8: 0.010638297872340425
	Train acc at iteration 10: 0.03685897435897436
	Val acc at iteration 9: 0.05319148936170213
	Train acc at iteration 11: 0.02403846153846154
	Val acc at iteration 10: 0.0425531914893617
	Train acc at iteration 12: 0.019230769230769232
	Val acc at iteration 11: 0.031914893617021274
	Train acc at iteration 13: 0.04006410256410257
	Val acc at iteration 12: 0.010638297872340425
	Train acc at iteration 14: 0.016025641025641024
	Val acc at iteration 13: 0.09574468085106383
	Train acc at iteration 15: 0.04807692307692308
	Val acc at iteration 14: 0.05319148936170213
	Train acc at iteration 16: 0.046474358974358976
	Val acc at iteration 15: 0.05319148936170213
	Train acc at iteration 17: 0.05608974358974359
	Val acc at iteration 16: 0.10638297872340426
	Train acc at iteration 18: 0.03365384615384615
	Val acc at iteration 17: 0.11702127659574468
	Train acc at iteration 19: 0.05608974358974359
	Val acc at iteration 18: 0.05319148936170213
	Train acc at iteration 20: 0.060897435897435896
	Val acc at iteration 19: 0.10638297872340426
	Train acc at iteration 21: 0.07371794871794872
	Val acc at iteration 20: 0.1276595744680851
	Train acc at iteration 22: 0.060897435897435896
	Val acc at iteration 21: 0.10638297872340426
	Train acc at iteration 23: 0.10576923076923077
	Val acc at iteration 22: 0.07446808510638298
	Train acc at iteration 24: 0.09935897435897435
	Val acc at iteration 23: 0.1595744680851064
	Train acc at iteration 25: 0.1282051282051282
	Val acc at iteration 24: 0.0851063829787234
	Train acc at iteration 26: 0.15705128205128205
	Val acc at iteration 25: 0.1276595744680851
	Train acc at iteration 27: 0.15705128205128205
	Val acc at iteration 26: 0.2553191489361702
	Train acc at iteration 28: 0.21794871794871795
	Val acc at iteration 27: 0.23404255319148937
	Train acc at iteration 29: 0.1762820512820513
	Val acc at iteration 28: 0.18085106382978725
	Train acc at iteration 30: 0.2692307692307692
	Val acc at iteration 29: 0.22340425531914893
	Train acc at iteration 31: 0.27884615384615385
	Val acc at iteration 30: 0.30851063829787234
	Train acc at iteration 32: 0.33653846153846156
	Val acc at iteration 31: 0.2978723404255319
	Train acc at iteration 33: 0.38461538461538464
	Val acc at iteration 32: 0.3404255319148936
	Train acc at iteration 34: 0.3894230769230769
	Val acc at iteration 33: 0.46808510638297873
	Train acc at iteration 35: 0.4567307692307692
	Val acc at iteration 34: 0.425531914893617
	Train acc at iteration 36: 0.4407051282051282
	Val acc at iteration 35: 0.5
	Train acc at iteration 37: 0.47596153846153844
	Val acc at iteration 36: 0.5319148936170213
	Train acc at iteration 38: 0.5080128205128205
	Val acc at iteration 37: 0.5319148936170213
	Train acc at iteration 39: 0.5144230769230769
	Val acc at iteration 38: 0.5319148936170213
	Train acc at iteration 40: 0.5560897435897436
	Val acc at iteration 39: 0.5638297872340425
	Train acc at iteration 41: 0.5560897435897436
	Val acc at iteration 40: 0.4574468085106383
	Train acc at iteration 42: 0.5865384615384616
	Val acc at iteration 41: 0.5638297872340425
	Train acc at iteration 43: 0.6089743589743589
	Val acc at iteration 42: 0.5638297872340425
	Train acc at iteration 44: 0.6266025641025641
	Val acc at iteration 43: 0.6382978723404256
	Train acc at iteration 45: 0.6169871794871795
	Val acc at iteration 44: 0.574468085106383
	Train acc at iteration 46: 0.6426282051282052
	Val acc at iteration 45: 0.6063829787234043
	Train acc at iteration 47: 0.6282051282051282
	Val acc at iteration 46: 0.6808510638297872
	Train acc at iteration 48: 0.6490384615384616
	Val acc at iteration 47: 0.6276595744680851
	Train acc at iteration 49: 0.6522435897435898
	Val acc at iteration 48: 0.5957446808510638
	Train acc at iteration 50: 0.6826923076923077
	Val acc at iteration 49: 0.6276595744680851
	Train acc at iteration 51: 0.47596153846153844
	Val acc at iteration 50: 0.6063829787234043
	Train acc at iteration 52: 0.6362179487179487
	Val acc at iteration 51: 0.5957446808510638
	Train acc at iteration 53: 0.5913461538461539
	Val acc at iteration 52: 0.574468085106383
	Train acc at iteration 54: 0.5352564102564102
	Val acc at iteration 53: 0.5957446808510638
	Train acc at iteration 55: 0.5464743589743589
	Val acc at iteration 54: 0.6382978723404256
	Train acc at iteration 56: 0.5288461538461539
	Val acc at iteration 55: 0.6170212765957447
	Train acc at iteration 57: 0.5432692307692307
	Val acc at iteration 56: 0.5212765957446809
	Train acc at iteration 58: 0.4439102564102564
	Val acc at iteration 57: 0.40425531914893614
	Train acc at iteration 59: 0.4407051282051282
	Val acc at iteration 58: 0.4574468085106383
	Train acc at iteration 60: 0.5032051282051282
	Val acc at iteration 59: 0.574468085106383
	Train acc at iteration 61: 0.5096153846153846
	Val acc at iteration 60: 0.5319148936170213
	Train acc at iteration 62: 0.5560897435897436
	Val acc at iteration 61: 0.5
	Train acc at iteration 63: 0.48878205128205127
	Val acc at iteration 62: 0.5425531914893617
	Train acc at iteration 64: 0.5528846153846154
	Val acc at iteration 63: 0.44680851063829785
	Train acc at iteration 65: 0.483974358974359
	Val acc at iteration 64: 0.5425531914893617
	Train acc at iteration 66: 0.5641025641025641
	Val acc at iteration 65: 0.5319148936170213
	Train acc at iteration 67: 0.532051282051282
	Val acc at iteration 66: 0.5957446808510638
	Train acc at iteration 68: 0.5048076923076923
	Val acc at iteration 67: 0.4787234042553192
	Train acc at iteration 69: 0.5496794871794872
	Val acc at iteration 68: 0.6170212765957447
	Train acc at iteration 70: 0.5272435897435898
	Val acc at iteration 69: 0.4148936170212766
	Train acc at iteration 71: 0.5336538461538461
	Val acc at iteration 70: 0.5212765957446809
	Train acc at iteration 72: 0.5801282051282052
	Val acc at iteration 71: 0.46808510638297873
	Train acc at iteration 73: 0.5528846153846154
	Val acc at iteration 72: 0.4787234042553192
	Train acc at iteration 74: 0.5480769230769231
	Val acc at iteration 73: 0.4574468085106383
	Train acc at iteration 75: 0.5352564102564102
	Val acc at iteration 74: 0.5
	Train acc at iteration 76: 0.5560897435897436
	Val acc at iteration 75: 0.4574468085106383
	Train acc at iteration 77: 0.5480769230769231
	Val acc at iteration 76: 0.3723404255319149
	Train acc at iteration 78: 0.5496794871794872
	Val acc at iteration 77: 0.5319148936170213
	Train acc at iteration 79: 0.5240384615384616
	Val acc at iteration 78: 0.4574468085106383
	Train acc at iteration 80: 0.5913461538461539
	Val acc at iteration 79: 0.5
	Train acc at iteration 81: 0.46474358974358976
	Val acc at iteration 80: 0.44680851063829785
	Train acc at iteration 82: 0.5721153846153846
	Val acc at iteration 81: 0.5319148936170213
	Train acc at iteration 83: 0.5112179487179487
	Val acc at iteration 82: 0.5
	Train acc at iteration 84: 0.5592948717948718
	Val acc at iteration 83: 0.5638297872340425
	Train acc at iteration 85: 0.47275641025641024
	Val acc at iteration 84: 0.5
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.3195819581958196
Final val micro accuracy: 0.43617021276595747
Final test macro f1-score: 0.299057239057239
Final test micro accuracy: 0.4148936170212766
Final validation:
	Cluster: 0.6231464445590973
	Separation: 0.545492023229599
Final test:
	Cluster: 0.5790182650089264
	Separation: 0.5345154106616974
Saved Results

Attempting combination 11/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7371794871794872
	Train Cluster: 0.6387914299964905
	Train Separation: 0.5222462177276611
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6382978723404256
	Val acc at iteration 1: 0.5212765957446809
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6063829787234043
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.6276595744680851
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.6170212765957447
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6170212765957447
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.5957446808510638
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.5851063829787234
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.5851063829787234
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6276595744680851
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.5957446808510638
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6276595744680851
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6170212765957447
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.6276595744680851
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6382978723404256
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.6276595744680851
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.6063829787234043
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.6595744680851063
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.7021276595744681
Val acc before epoch 13: 0.6382978723404256
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.8269230769230769
	Train Cluster: 0.6426964521408081
	Train Separation: 0.5189719438552857
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.723404255319149
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.7553191489361702
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.7340425531914894
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.7659574468085106
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.7021276595744681
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.7659574468085106
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.776595744680851
	Val acc at iteration 28: 0.7872340425531915
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.7659574468085106
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.776595744680851
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.776595744680851
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.8191489361702128
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.6382978723404256
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.7872340425531915
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.8085106382978723
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.648936170212766
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.6808510638297872
Val acc before epoch 25: 0.7659574468085106
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8297872340425532
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.8936170212765957
Stopping after epoch 37.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8125
	Train Cluster: 0.6380005240440368
	TrainSeparation: 0.5180678248405457
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.2532051282051282
	Val acc at iteration 0: 0.1702127659574468
	Train acc at iteration 2: 0.07211538461538461
	Val acc at iteration 1: 0.1276595744680851
	Train acc at iteration 3: 0.052884615384615384
	Val acc at iteration 2: 0.031914893617021274
	Train acc at iteration 4: 0.02564102564102564
	Val acc at iteration 3: 0.07446808510638298
	Train acc at iteration 5: 0.060897435897435896
	Val acc at iteration 4: 0.05319148936170213
	Train acc at iteration 6: 0.04807692307692308
	Val acc at iteration 5: 0.09574468085106383
	Train acc at iteration 7: 0.12179487179487179
	Val acc at iteration 6: 0.09574468085106383
	Train acc at iteration 8: 0.08173076923076923
	Val acc at iteration 7: 0.09574468085106383
	Train acc at iteration 9: 0.1282051282051282
	Val acc at iteration 8: 0.10638297872340426
	Train acc at iteration 10: 0.1330128205128205
	Val acc at iteration 9: 0.10638297872340426
	Train acc at iteration 11: 0.10737179487179487
	Val acc at iteration 10: 0.09574468085106383
	Train acc at iteration 12: 0.10256410256410256
	Val acc at iteration 11: 0.13829787234042554
	Train acc at iteration 13: 0.11538461538461539
	Val acc at iteration 12: 0.18085106382978725
	Train acc at iteration 14: 0.1233974358974359
	Val acc at iteration 13: 0.1702127659574468
	Train acc at iteration 15: 0.21153846153846154
	Val acc at iteration 14: 0.13829787234042554
	Train acc at iteration 16: 0.1282051282051282
	Val acc at iteration 15: 0.2127659574468085
	Train acc at iteration 17: 0.1233974358974359
	Val acc at iteration 16: 0.1702127659574468
	Train acc at iteration 18: 0.16987179487179488
	Val acc at iteration 17: 0.1595744680851064
	Train acc at iteration 19: 0.1778846153846154
	Val acc at iteration 18: 0.18085106382978725
	Train acc at iteration 20: 0.16506410256410256
	Val acc at iteration 19: 0.11702127659574468
	Train acc at iteration 21: 0.16987179487179488
	Val acc at iteration 20: 0.2127659574468085
	Train acc at iteration 22: 0.20512820512820512
	Val acc at iteration 21: 0.22340425531914893
	Train acc at iteration 23: 0.21314102564102563
	Val acc at iteration 22: 0.2553191489361702
	Train acc at iteration 24: 0.17467948717948717
	Val acc at iteration 23: 0.30851063829787234
	Train acc at iteration 25: 0.2419871794871795
	Val acc at iteration 24: 0.14893617021276595
	Train acc at iteration 26: 0.20993589743589744
	Val acc at iteration 25: 0.2127659574468085
	Train acc at iteration 27: 0.21955128205128205
	Val acc at iteration 26: 0.24468085106382978
	Train acc at iteration 28: 0.2900641025641026
	Val acc at iteration 27: 0.2553191489361702
	Train acc at iteration 29: 0.2692307692307692
	Val acc at iteration 28: 0.3191489361702128
	Train acc at iteration 30: 0.28205128205128205
	Val acc at iteration 29: 0.26595744680851063
	Train acc at iteration 31: 0.3301282051282051
	Val acc at iteration 30: 0.2872340425531915
	Train acc at iteration 32: 0.3108974358974359
	Val acc at iteration 31: 0.2765957446808511
	Train acc at iteration 33: 0.34615384615384615
	Val acc at iteration 32: 0.35106382978723405
	Train acc at iteration 34: 0.34294871794871795
	Val acc at iteration 33: 0.3404255319148936
	Train acc at iteration 35: 0.3605769230769231
	Val acc at iteration 34: 0.2978723404255319
	Train acc at iteration 36: 0.36378205128205127
	Val acc at iteration 35: 0.5
	Train acc at iteration 37: 0.44551282051282054
	Val acc at iteration 36: 0.30851063829787234
	Train acc at iteration 38: 0.39903846153846156
	Val acc at iteration 37: 0.4787234042553192
	Train acc at iteration 39: 0.5
	Val acc at iteration 38: 0.5106382978723404
	Train acc at iteration 40: 0.40865384615384615
	Val acc at iteration 39: 0.3723404255319149
	Train acc at iteration 41: 0.4583333333333333
	Val acc at iteration 40: 0.5638297872340425
	Train acc at iteration 42: 0.5496794871794872
	Val acc at iteration 41: 0.5212765957446809
	Train acc at iteration 43: 0.46153846153846156
	Val acc at iteration 42: 0.5531914893617021
	Train acc at iteration 44: 0.5897435897435898
	Val acc at iteration 43: 0.6276595744680851
	Train acc at iteration 45: 0.5432692307692307
	Val acc at iteration 44: 0.5851063829787234
	Train acc at iteration 46: 0.5657051282051282
	Val acc at iteration 45: 0.5957446808510638
	Train acc at iteration 47: 0.5496794871794872
	Val acc at iteration 46: 0.43617021276595747
	Train acc at iteration 48: 0.48717948717948717
	Val acc at iteration 47: 0.5531914893617021
	Train acc at iteration 49: 0.5785256410256411
	Val acc at iteration 48: 0.44680851063829785
	Train acc at iteration 50: 0.5592948717948718
	Val acc at iteration 49: 0.5425531914893617
	Train acc at iteration 51: 0.5865384615384616
	Val acc at iteration 50: 0.5531914893617021
	Train acc at iteration 52: 0.5448717948717948
	Val acc at iteration 51: 0.44680851063829785
	Train acc at iteration 53: 0.6298076923076923
	Val acc at iteration 52: 0.6595744680851063
	Train acc at iteration 54: 0.6378205128205128
	Val acc at iteration 53: 0.5425531914893617
	Train acc at iteration 55: 0.5737179487179487
	Val acc at iteration 54: 0.48936170212765956
	Train acc at iteration 56: 0.5753205128205128
	Val acc at iteration 55: 0.648936170212766
	Train acc at iteration 57: 0.6474358974358975
	Val acc at iteration 56: 0.5531914893617021
	Train acc at iteration 58: 0.6121794871794872
	Val acc at iteration 57: 0.5638297872340425
	Train acc at iteration 59: 0.6298076923076923
	Val acc at iteration 58: 0.5212765957446809
	Train acc at iteration 60: 0.6474358974358975
	Val acc at iteration 59: 0.5319148936170213
	Train acc at iteration 61: 0.6426282051282052
	Val acc at iteration 60: 0.6170212765957447
	Train acc at iteration 62: 0.6858974358974359
	Val acc at iteration 61: 0.574468085106383
	Train acc at iteration 63: 0.6490384615384616
	Val acc at iteration 62: 0.6170212765957447
	Train acc at iteration 64: 0.6298076923076923
	Val acc at iteration 63: 0.6382978723404256
	Train acc at iteration 65: 0.6346153846153846
	Val acc at iteration 64: 0.6595744680851063
	Train acc at iteration 66: 0.6682692307692307
	Val acc at iteration 65: 0.5
	Train acc at iteration 67: 0.6634615384615384
	Val acc at iteration 66: 0.6063829787234043
	Train acc at iteration 68: 0.6346153846153846
	Val acc at iteration 67: 0.5957446808510638
	Train acc at iteration 69: 0.655448717948718
	Val acc at iteration 68: 0.5957446808510638
	Train acc at iteration 70: 0.6666666666666666
	Val acc at iteration 69: 0.648936170212766
	Train acc at iteration 71: 0.6875
	Val acc at iteration 70: 0.6276595744680851
	Train acc at iteration 72: 0.6923076923076923
	Val acc at iteration 71: 0.5531914893617021
	Train acc at iteration 73: 0.6314102564102564
	Val acc at iteration 72: 0.6063829787234043
	Train acc at iteration 74: 0.6762820512820513
	Val acc at iteration 73: 0.6170212765957447
	Train acc at iteration 75: 0.6730769230769231
	Val acc at iteration 74: 0.6276595744680851
	Train acc at iteration 76: 0.6490384615384616
	Val acc at iteration 75: 0.5319148936170213
	Train acc at iteration 77: 0.5801282051282052
	Val acc at iteration 76: 0.6595744680851063
	Train acc at iteration 78: 0.6923076923076923
	Val acc at iteration 77: 0.6063829787234043
	Train acc at iteration 79: 0.6842948717948718
	Val acc at iteration 78: 0.6595744680851063
	Train acc at iteration 80: 0.6907051282051282
	Val acc at iteration 79: 0.5531914893617021
	Train acc at iteration 81: 0.6826923076923077
	Val acc at iteration 80: 0.574468085106383
	Train acc at iteration 82: 0.6698717948717948
	Val acc at iteration 81: 0.6170212765957447
	Train acc at iteration 83: 0.7083333333333334
	Val acc at iteration 82: 0.6276595744680851
	Train acc at iteration 84: 0.6907051282051282
	Val acc at iteration 83: 0.6063829787234043
	Train acc at iteration 85: 0.7115384615384616
	Val acc at iteration 84: 0.6063829787234043
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6164874551971326
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.5859437751004016
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.6104913651943207
	Separation: 0.5387757420539856
Final test:
	Cluster: 0.6078280508518219
	Separation: 0.5381271839141846
Saved Results

Attempting combination 12/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9574468085106383
Push epoch
After push, before retraining last layer:
	Train acc: 0.7676282051282052
	Train Cluster: 0.6495739102363587
	Train Separation: 0.5182702898979187
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5425531914893617
	Val acc at iteration 1: 0.574468085106383
	Val acc at iteration 2: 0.6063829787234043
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.648936170212766
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.6170212765957447
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.7553191489361702
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.6276595744680851
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7978723404255319
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.7659574468085106
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.776595744680851
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.648936170212766
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.8085106382978723
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.5425531914893617
	Val acc at iteration 68: 0.7978723404255319
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.5957446808510638
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.7021276595744681
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.7127659574468085
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9574468085106383
Push epoch
After push, before retraining last layer:
	Train acc: 0.8108974358974359
	Train Cluster: 0.6487597465515137
	Train Separation: 0.5173670053482056
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.7659574468085106
	Val acc at iteration 2: 0.8297872340425532
	Val acc at iteration 3: 0.7553191489361702
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.7872340425531915
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.776595744680851
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.776595744680851
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.8297872340425532
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.776595744680851
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.8617021276595744
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.776595744680851
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.776595744680851
	Val acc at iteration 36: 0.7553191489361702
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.7978723404255319
	Val acc at iteration 39: 0.7872340425531915
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.776595744680851
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.7872340425531915
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.8085106382978723
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.7872340425531915
	Val acc at iteration 52: 0.7553191489361702
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.776595744680851
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.8085106382978723
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.8085106382978723
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.7659574468085106
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.7659574468085106
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.8085106382978723
	Val acc at iteration 81: 0.8191489361702128
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 25: 0.723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8365384615384616
	Train Cluster: 0.6567578434944152
	TrainSeparation: 0.5236096501350402
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.05
	Train acc at iteration 1: 0.4423076923076923
	Val acc at iteration 0: 0.3617021276595745
	Train acc at iteration 2: 0.2467948717948718
	Val acc at iteration 1: 0.32978723404255317
	Train acc at iteration 3: 0.1907051282051282
	Val acc at iteration 2: 0.22340425531914893
	Train acc at iteration 4: 0.1858974358974359
	Val acc at iteration 3: 0.20212765957446807
	Train acc at iteration 5: 0.20352564102564102
	Val acc at iteration 4: 0.20212765957446807
	Train acc at iteration 6: 0.1842948717948718
	Val acc at iteration 5: 0.1595744680851064
	Train acc at iteration 7: 0.14102564102564102
	Val acc at iteration 6: 0.2765957446808511
	Train acc at iteration 8: 0.20192307692307693
	Val acc at iteration 7: 0.22340425531914893
	Train acc at iteration 9: 0.2548076923076923
	Val acc at iteration 8: 0.23404255319148937
	Train acc at iteration 10: 0.21634615384615385
	Val acc at iteration 9: 0.20212765957446807
	Train acc at iteration 11: 0.21153846153846154
	Val acc at iteration 10: 0.26595744680851063
	Train acc at iteration 12: 0.20993589743589744
	Val acc at iteration 11: 0.24468085106382978
	Train acc at iteration 13: 0.23717948717948717
	Val acc at iteration 12: 0.32978723404255317
	Train acc at iteration 14: 0.266025641025641
	Val acc at iteration 13: 0.3404255319148936
	Train acc at iteration 15: 0.32211538461538464
	Val acc at iteration 14: 0.2872340425531915
	Train acc at iteration 16: 0.28365384615384615
	Val acc at iteration 15: 0.19148936170212766
	Train acc at iteration 17: 0.2516025641025641
	Val acc at iteration 16: 0.4148936170212766
	Train acc at iteration 18: 0.32211538461538464
	Val acc at iteration 17: 0.3404255319148936
	Train acc at iteration 19: 0.3525641025641026
	Val acc at iteration 18: 0.2978723404255319
	Train acc at iteration 20: 0.33653846153846156
	Val acc at iteration 19: 0.4148936170212766
	Train acc at iteration 21: 0.3573717948717949
	Val acc at iteration 20: 0.3829787234042553
	Train acc at iteration 22: 0.39903846153846156
	Val acc at iteration 21: 0.44680851063829785
	Train acc at iteration 23: 0.3814102564102564
	Val acc at iteration 22: 0.35106382978723405
	Train acc at iteration 24: 0.3926282051282051
	Val acc at iteration 23: 0.5106382978723404
	Train acc at iteration 25: 0.421474358974359
	Val acc at iteration 24: 0.425531914893617
	Train acc at iteration 26: 0.42788461538461536
	Val acc at iteration 25: 0.4787234042553192
	Train acc at iteration 27: 0.42467948717948717
	Val acc at iteration 26: 0.3829787234042553
	Train acc at iteration 28: 0.4439102564102564
	Val acc at iteration 27: 0.46808510638297873
	Train acc at iteration 29: 0.44551282051282054
	Val acc at iteration 28: 0.4574468085106383
	Train acc at iteration 30: 0.47115384615384615
	Val acc at iteration 29: 0.48936170212765956
	Train acc at iteration 31: 0.49038461538461536
	Val acc at iteration 30: 0.574468085106383
	Train acc at iteration 32: 0.5544871794871795
	Val acc at iteration 31: 0.5
	Train acc at iteration 33: 0.5336538461538461
	Val acc at iteration 32: 0.5319148936170213
	Train acc at iteration 34: 0.5176282051282052
	Val acc at iteration 33: 0.48936170212765956
	Train acc at iteration 35: 0.532051282051282
	Val acc at iteration 34: 0.5
	Train acc at iteration 36: 0.5352564102564102
	Val acc at iteration 35: 0.5957446808510638
	Train acc at iteration 37: 0.5224358974358975
	Val acc at iteration 36: 0.5212765957446809
	Train acc at iteration 38: 0.5144230769230769
	Val acc at iteration 37: 0.425531914893617
	Train acc at iteration 39: 0.5048076923076923
	Val acc at iteration 38: 0.6063829787234043
	Train acc at iteration 40: 0.5
	Val acc at iteration 39: 0.4574468085106383
	Train acc at iteration 41: 0.5833333333333334
	Val acc at iteration 40: 0.5425531914893617
	Train acc at iteration 42: 0.5256410256410257
	Val acc at iteration 41: 0.5531914893617021
	Train acc at iteration 43: 0.5576923076923077
	Val acc at iteration 42: 0.5531914893617021
	Train acc at iteration 44: 0.5592948717948718
	Val acc at iteration 43: 0.5212765957446809
	Train acc at iteration 45: 0.594551282051282
	Val acc at iteration 44: 0.6063829787234043
	Train acc at iteration 46: 0.6009615384615384
	Val acc at iteration 45: 0.4574468085106383
	Train acc at iteration 47: 0.5865384615384616
	Val acc at iteration 46: 0.5425531914893617
	Train acc at iteration 48: 0.5528846153846154
	Val acc at iteration 47: 0.5319148936170213
	Train acc at iteration 49: 0.5849358974358975
	Val acc at iteration 48: 0.574468085106383
	Train acc at iteration 50: 0.5769230769230769
	Val acc at iteration 49: 0.5212765957446809
	Train acc at iteration 51: 0.5689102564102564
	Val acc at iteration 50: 0.574468085106383
	Train acc at iteration 52: 0.625
	Val acc at iteration 51: 0.574468085106383
	Train acc at iteration 53: 0.6105769230769231
	Val acc at iteration 52: 0.7021276595744681
	Train acc at iteration 54: 0.6041666666666666
	Val acc at iteration 53: 0.5212765957446809
	Train acc at iteration 55: 0.6282051282051282
	Val acc at iteration 54: 0.5851063829787234
	Train acc at iteration 56: 0.6009615384615384
	Val acc at iteration 55: 0.5851063829787234
	Train acc at iteration 57: 0.6233974358974359
	Val acc at iteration 56: 0.5531914893617021
	Train acc at iteration 58: 0.6153846153846154
	Val acc at iteration 57: 0.5531914893617021
	Train acc at iteration 59: 0.5993589743589743
	Val acc at iteration 58: 0.6914893617021277
	Train acc at iteration 60: 0.6153846153846154
	Val acc at iteration 59: 0.5851063829787234
	Train acc at iteration 61: 0.6217948717948718
	Val acc at iteration 60: 0.5425531914893617
	Train acc at iteration 62: 0.6346153846153846
	Val acc at iteration 61: 0.5957446808510638
	Train acc at iteration 63: 0.625
	Val acc at iteration 62: 0.6276595744680851
	Train acc at iteration 64: 0.6426282051282052
	Val acc at iteration 63: 0.6702127659574468
	Train acc at iteration 65: 0.6025641025641025
	Val acc at iteration 64: 0.5638297872340425
	Train acc at iteration 66: 0.6682692307692307
	Val acc at iteration 65: 0.6063829787234043
	Train acc at iteration 67: 0.6490384615384616
	Val acc at iteration 66: 0.6595744680851063
	Train acc at iteration 68: 0.6586538461538461
	Val acc at iteration 67: 0.6063829787234043
	Train acc at iteration 69: 0.6762820512820513
	Val acc at iteration 68: 0.6063829787234043
	Train acc at iteration 70: 0.6474358974358975
	Val acc at iteration 69: 0.6595744680851063
	Train acc at iteration 71: 0.6602564102564102
	Val acc at iteration 70: 0.6382978723404256
	Train acc at iteration 72: 0.6506410256410257
	Val acc at iteration 71: 0.6914893617021277
	Train acc at iteration 73: 0.655448717948718
	Val acc at iteration 72: 0.5851063829787234
	Train acc at iteration 74: 0.6458333333333334
	Val acc at iteration 73: 0.7127659574468085
	Train acc at iteration 75: 0.6858974358974359
	Val acc at iteration 74: 0.6276595744680851
	Train acc at iteration 76: 0.6394230769230769
	Val acc at iteration 75: 0.6382978723404256
	Train acc at iteration 77: 0.6602564102564102
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.6538461538461539
	Val acc at iteration 77: 0.5531914893617021
	Train acc at iteration 79: 0.6490384615384616
	Val acc at iteration 78: 0.7021276595744681
	Train acc at iteration 80: 0.6682692307692307
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.6666666666666666
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.7163461538461539
	Val acc at iteration 81: 0.6276595744680851
	Train acc at iteration 83: 0.6618589743589743
	Val acc at iteration 82: 0.6382978723404256
	Train acc at iteration 84: 0.6330128205128205
	Val acc at iteration 83: 0.6382978723404256
	Train acc at iteration 85: 0.6810897435897436
	Val acc at iteration 84: 0.5638297872340425
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.4506666666666666
Final val micro accuracy: 0.5851063829787234
Final test macro f1-score: 0.4670588235294118
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6119055449962616
	Separation: 0.5479000806808472
Final test:
	Cluster: 0.6093443632125854
	Separation: 0.537559300661087
Saved Results

Attempting combination 13/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.01
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Train Cluster: 0.6388317346572876
	Train Separation: 0.5163491010665894
(Directly after push) Val acc at iteration 0: 0.5851063829787234
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5851063829787234
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.6276595744680851
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.5957446808510638
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.6170212765957447
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6170212765957447
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.6063829787234043
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6170212765957447
	Val acc at iteration 44: 0.6276595744680851
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6276595744680851
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.648936170212766
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.6063829787234043
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.5425531914893617
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.7659574468085106
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.6595744680851063
	Val acc at iteration 74: 0.7872340425531915
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6808510638297872
Val acc before epoch 13: 0.7021276595744681
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.8173076923076923
	Train Cluster: 0.6470600962638855
	Train Separation: 0.5199217677116394
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.7553191489361702
	Val acc at iteration 4: 0.776595744680851
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.7872340425531915
	Val acc at iteration 8: 0.7340425531914894
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.7659574468085106
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7659574468085106
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.7659574468085106
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.7659574468085106
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.776595744680851
	Val acc at iteration 36: 0.7659574468085106
	Val acc at iteration 37: 0.7446808510638298
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.7872340425531915
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.7872340425531915
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.7978723404255319
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.8297872340425532
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.7872340425531915
	Val acc at iteration 57: 0.7659574468085106
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.8085106382978723
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.7659574468085106
	Val acc at iteration 70: 0.7978723404255319
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.6595744680851063
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.7446808510638298
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.8191489361702128
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.8191489361702128
	Val acc at iteration 84: 0.8085106382978723
Val acc before epoch 25: 0.7553191489361702
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8477564102564102
	Train Cluster: 0.6608314275741577
	TrainSeparation: 0.520421826839447
(Directly after push) Val acc at iteration 0: 0.8191489361702128
Retraining last layer
Last layer lr: 0.01
	Train acc at iteration 1: 0.7291666666666666
	Val acc at iteration 0: 0.648936170212766
	Train acc at iteration 2: 0.7259615384615384
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.6474358974358975
	Val acc at iteration 2: 0.6063829787234043
	Train acc at iteration 4: 0.6810897435897436
	Val acc at iteration 3: 0.6276595744680851
	Train acc at iteration 5: 0.6201923076923077
	Val acc at iteration 4: 0.574468085106383
	Train acc at iteration 6: 0.6698717948717948
	Val acc at iteration 5: 0.5957446808510638
	Train acc at iteration 7: 0.6266025641025641
	Val acc at iteration 6: 0.6702127659574468
	Train acc at iteration 8: 0.6506410256410257
	Val acc at iteration 7: 0.6170212765957447
	Train acc at iteration 9: 0.6506410256410257
	Val acc at iteration 8: 0.7127659574468085
	Train acc at iteration 10: 0.6923076923076923
	Val acc at iteration 9: 0.648936170212766
	Train acc at iteration 11: 0.6458333333333334
	Val acc at iteration 10: 0.723404255319149
	Train acc at iteration 12: 0.6810897435897436
	Val acc at iteration 11: 0.5638297872340425
	Train acc at iteration 13: 0.6939102564102564
	Val acc at iteration 12: 0.6595744680851063
	Train acc at iteration 14: 0.6794871794871795
	Val acc at iteration 13: 0.5851063829787234
	Train acc at iteration 15: 0.6618589743589743
	Val acc at iteration 14: 0.6170212765957447
	Train acc at iteration 16: 0.6394230769230769
	Val acc at iteration 15: 0.6702127659574468
	Train acc at iteration 17: 0.657051282051282
	Val acc at iteration 16: 0.574468085106383
	Train acc at iteration 18: 0.6201923076923077
	Val acc at iteration 17: 0.5212765957446809
	Train acc at iteration 19: 0.6153846153846154
	Val acc at iteration 18: 0.5851063829787234
	Train acc at iteration 20: 0.5737179487179487
	Val acc at iteration 19: 0.6063829787234043
	Train acc at iteration 21: 0.655448717948718
	Val acc at iteration 20: 0.6170212765957447
	Train acc at iteration 22: 0.5977564102564102
	Val acc at iteration 21: 0.5531914893617021
	Train acc at iteration 23: 0.6394230769230769
	Val acc at iteration 22: 0.5851063829787234
	Train acc at iteration 24: 0.6185897435897436
	Val acc at iteration 23: 0.5638297872340425
	Train acc at iteration 25: 0.6298076923076923
	Val acc at iteration 24: 0.5957446808510638
	Train acc at iteration 26: 0.6137820512820513
	Val acc at iteration 25: 0.6382978723404256
	Train acc at iteration 27: 0.6474358974358975
	Val acc at iteration 26: 0.6063829787234043
	Train acc at iteration 28: 0.5833333333333334
	Val acc at iteration 27: 0.5957446808510638
	Train acc at iteration 29: 0.6201923076923077
	Val acc at iteration 28: 0.5851063829787234
	Train acc at iteration 30: 0.6169871794871795
	Val acc at iteration 29: 0.5319148936170213
	Train acc at iteration 31: 0.5977564102564102
	Val acc at iteration 30: 0.5425531914893617
	Train acc at iteration 32: 0.6201923076923077
	Val acc at iteration 31: 0.6382978723404256
	Train acc at iteration 33: 0.6394230769230769
	Val acc at iteration 32: 0.5531914893617021
	Train acc at iteration 34: 0.6538461538461539
	Val acc at iteration 33: 0.5531914893617021
	Train acc at iteration 35: 0.6201923076923077
	Val acc at iteration 34: 0.5638297872340425
	Train acc at iteration 36: 0.6169871794871795
	Val acc at iteration 35: 0.5531914893617021
	Train acc at iteration 37: 0.6442307692307693
	Val acc at iteration 36: 0.6702127659574468
	Train acc at iteration 38: 0.6778846153846154
	Val acc at iteration 37: 0.5425531914893617
	Train acc at iteration 39: 0.6266025641025641
	Val acc at iteration 38: 0.5531914893617021
	Train acc at iteration 40: 0.5993589743589743
	Val acc at iteration 39: 0.5531914893617021
	Train acc at iteration 41: 0.6410256410256411
	Val acc at iteration 40: 0.6702127659574468
	Train acc at iteration 42: 0.6522435897435898
	Val acc at iteration 41: 0.5851063829787234
	Train acc at iteration 43: 0.6618589743589743
	Val acc at iteration 42: 0.5851063829787234
	Train acc at iteration 44: 0.6698717948717948
	Val acc at iteration 43: 0.574468085106383
	Train acc at iteration 45: 0.657051282051282
	Val acc at iteration 44: 0.5851063829787234
	Train acc at iteration 46: 0.6346153846153846
	Val acc at iteration 45: 0.6170212765957447
	Train acc at iteration 47: 0.6634615384615384
	Val acc at iteration 46: 0.6063829787234043
	Train acc at iteration 48: 0.6089743589743589
	Val acc at iteration 47: 0.5957446808510638
	Train acc at iteration 49: 0.6650641025641025
	Val acc at iteration 48: 0.6276595744680851
	Train acc at iteration 50: 0.6875
	Val acc at iteration 49: 0.6063829787234043
	Train acc at iteration 51: 0.6762820512820513
	Val acc at iteration 50: 0.5957446808510638
	Train acc at iteration 52: 0.6923076923076923
	Val acc at iteration 51: 0.6063829787234043
	Train acc at iteration 53: 0.6842948717948718
	Val acc at iteration 52: 0.6063829787234043
	Train acc at iteration 54: 0.6442307692307693
	Val acc at iteration 53: 0.6276595744680851
	Train acc at iteration 55: 0.6698717948717948
	Val acc at iteration 54: 0.6063829787234043
	Train acc at iteration 56: 0.6778846153846154
	Val acc at iteration 55: 0.6702127659574468
	Train acc at iteration 57: 0.6778846153846154
	Val acc at iteration 56: 0.6914893617021277
	Train acc at iteration 58: 0.7035256410256411
	Val acc at iteration 57: 0.6276595744680851
	Train acc at iteration 59: 0.6875
	Val acc at iteration 58: 0.6595744680851063
	Train acc at iteration 60: 0.6778846153846154
	Val acc at iteration 59: 0.6170212765957447
	Train acc at iteration 61: 0.6762820512820513
	Val acc at iteration 60: 0.723404255319149
	Train acc at iteration 62: 0.7227564102564102
	Val acc at iteration 61: 0.6170212765957447
	Train acc at iteration 63: 0.7051282051282052
	Val acc at iteration 62: 0.648936170212766
	Train acc at iteration 64: 0.7067307692307693
	Val acc at iteration 63: 0.6382978723404256
	Train acc at iteration 65: 0.6842948717948718
	Val acc at iteration 64: 0.6595744680851063
	Train acc at iteration 66: 0.6891025641025641
	Val acc at iteration 65: 0.6702127659574468
	Train acc at iteration 67: 0.6650641025641025
	Val acc at iteration 66: 0.6063829787234043
	Train acc at iteration 68: 0.6794871794871795
	Val acc at iteration 67: 0.6702127659574468
	Train acc at iteration 69: 0.7291666666666666
	Val acc at iteration 68: 0.6808510638297872
	Train acc at iteration 70: 0.6923076923076923
	Val acc at iteration 69: 0.6595744680851063
	Train acc at iteration 71: 0.6730769230769231
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.6971153846153846
	Val acc at iteration 71: 0.6276595744680851
	Train acc at iteration 73: 0.7083333333333334
	Val acc at iteration 72: 0.6914893617021277
	Train acc at iteration 74: 0.6698717948717948
	Val acc at iteration 73: 0.5319148936170213
	Train acc at iteration 75: 0.717948717948718
	Val acc at iteration 74: 0.5957446808510638
	Train acc at iteration 76: 0.719551282051282
	Val acc at iteration 75: 0.6808510638297872
	Train acc at iteration 77: 0.7275641025641025
	Val acc at iteration 76: 0.5425531914893617
	Train acc at iteration 78: 0.7115384615384616
	Val acc at iteration 77: 0.6382978723404256
	Train acc at iteration 79: 0.7451923076923077
	Val acc at iteration 78: 0.5957446808510638
	Train acc at iteration 80: 0.7131410256410257
	Val acc at iteration 79: 0.6063829787234043
	Train acc at iteration 81: 0.7564102564102564
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.6971153846153846
	Val acc at iteration 81: 0.7340425531914894
	Train acc at iteration 83: 0.717948717948718
	Val acc at iteration 82: 0.6595744680851063
	Train acc at iteration 84: 0.7596153846153846
	Val acc at iteration 83: 0.6702127659574468
	Train acc at iteration 85: 0.7339743589743589
	Val acc at iteration 84: 0.7340425531914894
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5683168316831683
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.4885185185185185
Final test micro accuracy: 0.6170212765957447
Final validation:
	Cluster: 0.6162793338298798
	Separation: 0.5282856225967407
Final test:
	Cluster: 0.5950655937194824
	Separation: 0.548536479473114
Saved Results

Attempting combination 14/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7483974358974359
	Train Cluster: 0.6398226857185364
	Train Separation: 0.5160725712776184
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5851063829787234
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.574468085106383
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.648936170212766
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.7872340425531915
	Val acc at iteration 19: 0.5957446808510638
	Val acc at iteration 20: 0.6063829787234043
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.574468085106383
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6382978723404256
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.5851063829787234
	Val acc at iteration 37: 0.6170212765957447
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.6382978723404256
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6276595744680851
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.6382978723404256
	Val acc at iteration 46: 0.5851063829787234
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.5957446808510638
	Val acc at iteration 49: 0.648936170212766
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6276595744680851
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.6276595744680851
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.7021276595744681
	Val acc at iteration 75: 0.7553191489361702
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6382978723404256
Val acc before epoch 13: 0.7127659574468085
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8092948717948718
	Train Cluster: 0.6467334985733032
	Train Separation: 0.5198609709739686
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.7340425531914894
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.8085106382978723
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.7872340425531915
	Val acc at iteration 9: 0.723404255319149
	Val acc at iteration 10: 0.776595744680851
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.7446808510638298
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.776595744680851
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.7553191489361702
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.7659574468085106
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.7872340425531915
	Val acc at iteration 30: 0.7659574468085106
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.8404255319148937
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.7659574468085106
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7978723404255319
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.7659574468085106
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7978723404255319
	Val acc at iteration 48: 0.7978723404255319
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7978723404255319
	Val acc at iteration 51: 0.7872340425531915
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7872340425531915
	Val acc at iteration 55: 0.8085106382978723
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.7872340425531915
	Val acc at iteration 59: 0.8085106382978723
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.7659574468085106
	Val acc at iteration 62: 0.8297872340425532
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.7659574468085106
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.8617021276595744
	Val acc at iteration 67: 0.8191489361702128
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.8085106382978723
	Val acc at iteration 75: 0.7872340425531915
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.7872340425531915
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.8085106382978723
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.8191489361702128
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Train Cluster: 0.6506752848625184
	TrainSeparation: 0.5231108784675598
(Directly after push) Val acc at iteration 0: 0.8085106382978723
Retraining last layer
Last layer lr: 0.005
	Train acc at iteration 1: 0.8092948717948718
	Val acc at iteration 0: 0.6808510638297872
	Train acc at iteration 2: 0.7403846153846154
	Val acc at iteration 1: 0.7340425531914894
	Train acc at iteration 3: 0.719551282051282
	Val acc at iteration 2: 0.6170212765957447
	Train acc at iteration 4: 0.7724358974358975
	Val acc at iteration 3: 0.7340425531914894
	Train acc at iteration 5: 0.7772435897435898
	Val acc at iteration 4: 0.6702127659574468
	Train acc at iteration 6: 0.7403846153846154
	Val acc at iteration 5: 0.6808510638297872
	Train acc at iteration 7: 0.7548076923076923
	Val acc at iteration 6: 0.7021276595744681
	Train acc at iteration 8: 0.7339743589743589
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.7580128205128205
	Val acc at iteration 8: 0.7553191489361702
	Train acc at iteration 10: 0.7163461538461539
	Val acc at iteration 9: 0.6808510638297872
	Train acc at iteration 11: 0.7467948717948718
	Val acc at iteration 10: 0.7446808510638298
	Train acc at iteration 12: 0.7291666666666666
	Val acc at iteration 11: 0.6170212765957447
	Train acc at iteration 13: 0.7692307692307693
	Val acc at iteration 12: 0.776595744680851
	Train acc at iteration 14: 0.7483974358974359
	Val acc at iteration 13: 0.7021276595744681
	Train acc at iteration 15: 0.7644230769230769
	Val acc at iteration 14: 0.7659574468085106
	Train acc at iteration 16: 0.7756410256410257
	Val acc at iteration 15: 0.776595744680851
	Train acc at iteration 17: 0.782051282051282
	Val acc at iteration 16: 0.7446808510638298
	Train acc at iteration 18: 0.7676282051282052
	Val acc at iteration 17: 0.723404255319149
	Train acc at iteration 19: 0.7708333333333334
	Val acc at iteration 18: 0.6808510638297872
	Train acc at iteration 20: 0.7996794871794872
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.7612179487179487
	Val acc at iteration 20: 0.723404255319149
	Train acc at iteration 22: 0.7932692307692307
	Val acc at iteration 21: 0.7872340425531915
	Train acc at iteration 23: 0.7756410256410257
	Val acc at iteration 22: 0.7659574468085106
	Train acc at iteration 24: 0.7532051282051282
	Val acc at iteration 23: 0.6808510638297872
	Train acc at iteration 25: 0.7676282051282052
	Val acc at iteration 24: 0.6914893617021277
	Train acc at iteration 26: 0.7852564102564102
	Val acc at iteration 25: 0.776595744680851
	Train acc at iteration 27: 0.7516025641025641
	Val acc at iteration 26: 0.7340425531914894
	Train acc at iteration 28: 0.7467948717948718
	Val acc at iteration 27: 0.7446808510638298
	Train acc at iteration 29: 0.7628205128205128
	Val acc at iteration 28: 0.6808510638297872
	Train acc at iteration 30: 0.7708333333333334
	Val acc at iteration 29: 0.6808510638297872
	Train acc at iteration 31: 0.75
	Val acc at iteration 30: 0.6702127659574468
	Train acc at iteration 32: 0.7724358974358975
	Val acc at iteration 31: 0.6382978723404256
	Train acc at iteration 33: 0.7403846153846154
	Val acc at iteration 32: 0.6382978723404256
	Train acc at iteration 34: 0.7403846153846154
	Val acc at iteration 33: 0.6595744680851063
	Train acc at iteration 35: 0.7628205128205128
	Val acc at iteration 34: 0.6702127659574468
	Train acc at iteration 36: 0.7275641025641025
	Val acc at iteration 35: 0.6276595744680851
	Train acc at iteration 37: 0.7355769230769231
	Val acc at iteration 36: 0.6702127659574468
	Train acc at iteration 38: 0.7371794871794872
	Val acc at iteration 37: 0.7446808510638298
	Train acc at iteration 39: 0.7355769230769231
	Val acc at iteration 38: 0.7127659574468085
	Train acc at iteration 40: 0.7548076923076923
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.717948717948718
	Val acc at iteration 40: 0.574468085106383
	Train acc at iteration 42: 0.717948717948718
	Val acc at iteration 41: 0.6702127659574468
	Train acc at iteration 43: 0.7451923076923077
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.7211538461538461
	Val acc at iteration 43: 0.6702127659574468
	Train acc at iteration 45: 0.7323717948717948
	Val acc at iteration 44: 0.6382978723404256
	Train acc at iteration 46: 0.7323717948717948
	Val acc at iteration 45: 0.6063829787234043
	Train acc at iteration 47: 0.7403846153846154
	Val acc at iteration 46: 0.6170212765957447
	Train acc at iteration 48: 0.7163461538461539
	Val acc at iteration 47: 0.6170212765957447
	Train acc at iteration 49: 0.7131410256410257
	Val acc at iteration 48: 0.6595744680851063
	Train acc at iteration 50: 0.7403846153846154
	Val acc at iteration 49: 0.648936170212766
	Train acc at iteration 51: 0.7275641025641025
	Val acc at iteration 50: 0.7659574468085106
	Train acc at iteration 52: 0.7532051282051282
	Val acc at iteration 51: 0.6276595744680851
	Train acc at iteration 53: 0.7099358974358975
	Val acc at iteration 52: 0.648936170212766
	Train acc at iteration 54: 0.7019230769230769
	Val acc at iteration 53: 0.6382978723404256
	Train acc at iteration 55: 0.6955128205128205
	Val acc at iteration 54: 0.6063829787234043
	Train acc at iteration 56: 0.7355769230769231
	Val acc at iteration 55: 0.723404255319149
	Train acc at iteration 57: 0.7243589743589743
	Val acc at iteration 56: 0.648936170212766
	Train acc at iteration 58: 0.7483974358974359
	Val acc at iteration 57: 0.5531914893617021
	Train acc at iteration 59: 0.7099358974358975
	Val acc at iteration 58: 0.574468085106383
	Train acc at iteration 60: 0.6810897435897436
	Val acc at iteration 59: 0.5851063829787234
	Train acc at iteration 61: 0.7355769230769231
	Val acc at iteration 60: 0.6382978723404256
	Train acc at iteration 62: 0.7564102564102564
	Val acc at iteration 61: 0.648936170212766
	Train acc at iteration 63: 0.719551282051282
	Val acc at iteration 62: 0.5106382978723404
	Train acc at iteration 64: 0.7083333333333334
	Val acc at iteration 63: 0.6914893617021277
	Train acc at iteration 65: 0.7227564102564102
	Val acc at iteration 64: 0.6063829787234043
	Train acc at iteration 66: 0.719551282051282
	Val acc at iteration 65: 0.6276595744680851
	Train acc at iteration 67: 0.7051282051282052
	Val acc at iteration 66: 0.6276595744680851
	Train acc at iteration 68: 0.7259615384615384
	Val acc at iteration 67: 0.6276595744680851
	Train acc at iteration 69: 0.6666666666666666
	Val acc at iteration 68: 0.6382978723404256
	Train acc at iteration 70: 0.7291666666666666
	Val acc at iteration 69: 0.4787234042553192
	Train acc at iteration 71: 0.7291666666666666
	Val acc at iteration 70: 0.6276595744680851
	Train acc at iteration 72: 0.6971153846153846
	Val acc at iteration 71: 0.648936170212766
	Train acc at iteration 73: 0.6858974358974359
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.7115384615384616
	Val acc at iteration 73: 0.7021276595744681
	Train acc at iteration 75: 0.7131410256410257
	Val acc at iteration 74: 0.6595744680851063
	Train acc at iteration 76: 0.6858974358974359
	Val acc at iteration 75: 0.648936170212766
	Train acc at iteration 77: 0.7035256410256411
	Val acc at iteration 76: 0.5957446808510638
	Train acc at iteration 78: 0.7003205128205128
	Val acc at iteration 77: 0.6276595744680851
	Train acc at iteration 79: 0.7163461538461539
	Val acc at iteration 78: 0.648936170212766
	Train acc at iteration 80: 0.719551282051282
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.717948717948718
	Val acc at iteration 80: 0.5957446808510638
	Train acc at iteration 82: 0.7371794871794872
	Val acc at iteration 81: 0.6808510638297872
	Train acc at iteration 83: 0.7387820512820513
	Val acc at iteration 82: 0.6063829787234043
	Train acc at iteration 84: 0.7387820512820513
	Val acc at iteration 83: 0.5638297872340425
	Train acc at iteration 85: 0.7275641025641025
	Val acc at iteration 84: 0.6063829787234043
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5402735562310029
Final val micro accuracy: 0.6170212765957447
Final test macro f1-score: 0.5149812734082396
Final test micro accuracy: 0.6276595744680851
Final validation:
	Cluster: 0.6193233132362366
	Separation: 0.5384913384914398
Final test:
	Cluster: 0.6177100837230682
	Separation: 0.5331780314445496
Saved Results

Attempting combination 15/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5212765957446809
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7708333333333334
	Train Cluster: 0.6413745045661926
	Train Separation: 0.5201385617256165
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.574468085106383
	Val acc at iteration 3: 0.6063829787234043
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.5851063829787234
	Val acc at iteration 6: 0.5638297872340425
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.5851063829787234
	Val acc at iteration 9: 0.6063829787234043
	Val acc at iteration 10: 0.5851063829787234
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.5957446808510638
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.6382978723404256
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.5957446808510638
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.7127659574468085
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.6382978723404256
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.574468085106383
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.6170212765957447
	Val acc at iteration 47: 0.574468085106383
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.6170212765957447
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.7021276595744681
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.6595744680851063
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7446808510638298
Val acc before epoch 13: 0.7021276595744681
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8092948717948718
	Train Cluster: 0.6444214463233948
	Train Separation: 0.5198320031166077
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7127659574468085
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.776595744680851
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.7978723404255319
	Val acc at iteration 15: 0.7659574468085106
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.7446808510638298
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.776595744680851
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7872340425531915
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.776595744680851
	Val acc at iteration 30: 0.7978723404255319
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.7659574468085106
	Val acc at iteration 34: 0.776595744680851
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.8085106382978723
	Val acc at iteration 37: 0.7659574468085106
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.776595744680851
	Val acc at iteration 60: 0.7978723404255319
	Val acc at iteration 61: 0.7872340425531915
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.7340425531914894
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.7978723404255319
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.7553191489361702
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.8297872340425532
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.7659574468085106
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 25: 0.6914893617021277
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8301282051282052
	Train Cluster: 0.6463922023773193
	TrainSeparation: 0.5170605301856994
(Directly after push) Val acc at iteration 0: 0.8297872340425532
Retraining last layer
Last layer lr: 0.001
	Train acc at iteration 1: 0.8076923076923077
	Val acc at iteration 0: 0.8191489361702128
	Train acc at iteration 2: 0.7884615384615384
	Val acc at iteration 1: 0.7872340425531915
	Train acc at iteration 3: 0.8028846153846154
	Val acc at iteration 2: 0.7659574468085106
	Train acc at iteration 4: 0.7916666666666666
	Val acc at iteration 3: 0.7553191489361702
	Train acc at iteration 5: 0.7852564102564102
	Val acc at iteration 4: 0.7659574468085106
	Train acc at iteration 6: 0.8157051282051282
	Val acc at iteration 5: 0.7872340425531915
	Train acc at iteration 7: 0.8173076923076923
	Val acc at iteration 6: 0.7127659574468085
	Train acc at iteration 8: 0.8381410256410257
	Val acc at iteration 7: 0.7872340425531915
	Train acc at iteration 9: 0.8076923076923077
	Val acc at iteration 8: 0.6914893617021277
	Train acc at iteration 10: 0.8044871794871795
	Val acc at iteration 9: 0.7021276595744681
	Train acc at iteration 11: 0.7916666666666666
	Val acc at iteration 10: 0.7446808510638298
	Train acc at iteration 12: 0.8044871794871795
	Val acc at iteration 11: 0.8191489361702128
	Train acc at iteration 13: 0.8221153846153846
	Val acc at iteration 12: 0.7553191489361702
	Train acc at iteration 14: 0.8125
	Val acc at iteration 13: 0.7659574468085106
	Train acc at iteration 15: 0.7932692307692307
	Val acc at iteration 14: 0.7872340425531915
	Train acc at iteration 16: 0.8333333333333334
	Val acc at iteration 15: 0.6702127659574468
	Train acc at iteration 17: 0.8269230769230769
	Val acc at iteration 16: 0.7659574468085106
	Train acc at iteration 18: 0.8125
	Val acc at iteration 17: 0.7127659574468085
	Train acc at iteration 19: 0.8269230769230769
	Val acc at iteration 18: 0.7340425531914894
	Train acc at iteration 20: 0.7964743589743589
	Val acc at iteration 19: 0.7978723404255319
	Train acc at iteration 21: 0.8028846153846154
	Val acc at iteration 20: 0.776595744680851
	Train acc at iteration 22: 0.8108974358974359
	Val acc at iteration 21: 0.7553191489361702
	Train acc at iteration 23: 0.8060897435897436
	Val acc at iteration 22: 0.7659574468085106
	Train acc at iteration 24: 0.8269230769230769
	Val acc at iteration 23: 0.7553191489361702
	Train acc at iteration 25: 0.8189102564102564
	Val acc at iteration 24: 0.776595744680851
	Train acc at iteration 26: 0.8253205128205128
	Val acc at iteration 25: 0.7553191489361702
	Train acc at iteration 27: 0.8092948717948718
	Val acc at iteration 26: 0.7659574468085106
	Train acc at iteration 28: 0.8044871794871795
	Val acc at iteration 27: 0.8297872340425532
	Train acc at iteration 29: 0.842948717948718
	Val acc at iteration 28: 0.8191489361702128
	Train acc at iteration 30: 0.8044871794871795
	Val acc at iteration 29: 0.776595744680851
	Train acc at iteration 31: 0.8189102564102564
	Val acc at iteration 30: 0.7340425531914894
	Train acc at iteration 32: 0.7948717948717948
	Val acc at iteration 31: 0.723404255319149
	Train acc at iteration 33: 0.8237179487179487
	Val acc at iteration 32: 0.7659574468085106
	Train acc at iteration 34: 0.7868589743589743
	Val acc at iteration 33: 0.7021276595744681
	Train acc at iteration 35: 0.8092948717948718
	Val acc at iteration 34: 0.776595744680851
	Train acc at iteration 36: 0.7980769230769231
	Val acc at iteration 35: 0.7978723404255319
	Train acc at iteration 37: 0.8076923076923077
	Val acc at iteration 36: 0.7978723404255319
	Train acc at iteration 38: 0.8301282051282052
	Val acc at iteration 37: 0.723404255319149
	Train acc at iteration 39: 0.8333333333333334
	Val acc at iteration 38: 0.7340425531914894
	Train acc at iteration 40: 0.8141025641025641
	Val acc at iteration 39: 0.8297872340425532
	Train acc at iteration 41: 0.8509615384615384
	Val acc at iteration 40: 0.7872340425531915
	Train acc at iteration 42: 0.8108974358974359
	Val acc at iteration 41: 0.7659574468085106
	Train acc at iteration 43: 0.8108974358974359
	Val acc at iteration 42: 0.8085106382978723
	Train acc at iteration 44: 0.8333333333333334
	Val acc at iteration 43: 0.7553191489361702
	Train acc at iteration 45: 0.8621794871794872
	Val acc at iteration 44: 0.7978723404255319
	Train acc at iteration 46: 0.8205128205128205
	Val acc at iteration 45: 0.7340425531914894
	Train acc at iteration 47: 0.8205128205128205
	Val acc at iteration 46: 0.776595744680851
	Train acc at iteration 48: 0.8253205128205128
	Val acc at iteration 47: 0.7659574468085106
	Train acc at iteration 49: 0.780448717948718
	Val acc at iteration 48: 0.7553191489361702
	Train acc at iteration 50: 0.8381410256410257
	Val acc at iteration 49: 0.7872340425531915
	Train acc at iteration 51: 0.8028846153846154
	Val acc at iteration 50: 0.776595744680851
	Train acc at iteration 52: 0.8301282051282052
	Val acc at iteration 51: 0.7872340425531915
	Train acc at iteration 53: 0.8301282051282052
	Val acc at iteration 52: 0.776595744680851
	Train acc at iteration 54: 0.7948717948717948
	Val acc at iteration 53: 0.7446808510638298
	Train acc at iteration 55: 0.8237179487179487
	Val acc at iteration 54: 0.8191489361702128
	Train acc at iteration 56: 0.8333333333333334
	Val acc at iteration 55: 0.7553191489361702
	Train acc at iteration 57: 0.8269230769230769
	Val acc at iteration 56: 0.8297872340425532
	Train acc at iteration 58: 0.8413461538461539
	Val acc at iteration 57: 0.7553191489361702
	Train acc at iteration 59: 0.8285256410256411
	Val acc at iteration 58: 0.7553191489361702
	Train acc at iteration 60: 0.8157051282051282
	Val acc at iteration 59: 0.7659574468085106
	Train acc at iteration 61: 0.8189102564102564
	Val acc at iteration 60: 0.7659574468085106
	Train acc at iteration 62: 0.7980769230769231
	Val acc at iteration 61: 0.776595744680851
	Train acc at iteration 63: 0.8125
	Val acc at iteration 62: 0.7340425531914894
	Train acc at iteration 64: 0.8157051282051282
	Val acc at iteration 63: 0.776595744680851
	Train acc at iteration 65: 0.8125
	Val acc at iteration 64: 0.7659574468085106
	Train acc at iteration 66: 0.8349358974358975
	Val acc at iteration 65: 0.7446808510638298
	Train acc at iteration 67: 0.8060897435897436
	Val acc at iteration 66: 0.8297872340425532
	Train acc at iteration 68: 0.8125
	Val acc at iteration 67: 0.8723404255319149
	Train acc at iteration 69: 0.8012820512820513
	Val acc at iteration 68: 0.7872340425531915
	Train acc at iteration 70: 0.8333333333333334
	Val acc at iteration 69: 0.7553191489361702
	Train acc at iteration 71: 0.7852564102564102
	Val acc at iteration 70: 0.7659574468085106
	Train acc at iteration 72: 0.844551282051282
	Val acc at iteration 71: 0.8191489361702128
	Train acc at iteration 73: 0.8141025641025641
	Val acc at iteration 72: 0.776595744680851
	Train acc at iteration 74: 0.8189102564102564
	Val acc at iteration 73: 0.776595744680851
	Train acc at iteration 75: 0.8044871794871795
	Val acc at iteration 74: 0.7659574468085106
	Train acc at iteration 76: 0.8189102564102564
	Val acc at iteration 75: 0.7659574468085106
	Train acc at iteration 77: 0.8044871794871795
	Val acc at iteration 76: 0.7978723404255319
	Train acc at iteration 78: 0.8205128205128205
	Val acc at iteration 77: 0.7978723404255319
	Train acc at iteration 79: 0.8349358974358975
	Val acc at iteration 78: 0.8191489361702128
	Train acc at iteration 80: 0.8525641025641025
	Val acc at iteration 79: 0.8404255319148937
	Train acc at iteration 81: 0.8493589743589743
	Val acc at iteration 80: 0.8297872340425532
	Train acc at iteration 82: 0.844551282051282
	Val acc at iteration 81: 0.8085106382978723
	Train acc at iteration 83: 0.8157051282051282
	Val acc at iteration 82: 0.723404255319149
	Train acc at iteration 84: 0.8301282051282052
	Val acc at iteration 83: 0.7340425531914894
	Train acc at iteration 85: 0.8189102564102564
	Val acc at iteration 84: 0.723404255319149
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.729824561403509
Final val micro accuracy: 0.7978723404255319
Final test macro f1-score: 0.6507936507936508
Final test micro accuracy: 0.7446808510638298
Final validation:
	Cluster: 0.6202938556671143
	Separation: 0.5406734943389893
Final test:
	Cluster: 0.6273097395896912
	Separation: 0.5413290560245514
Saved Results

Attempting combination 16/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7564102564102564
	Train Cluster: 0.6469955205917358
	Train Separation: 0.5224248766899109
(Directly after push) Val acc at iteration 0: 0.5638297872340425
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5319148936170213
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.6276595744680851
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6170212765957447
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6063829787234043
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.6063829787234043
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.6170212765957447
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6170212765957447
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.574468085106383
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.574468085106383
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.6170212765957447
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.648936170212766
	Val acc at iteration 50: 0.6382978723404256
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.6063829787234043
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6063829787234043
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.7021276595744681
	Val acc at iteration 67: 0.6382978723404256
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.776595744680851
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7872340425531915
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.6808510638297872
Val acc before epoch 13: 0.7340425531914894
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Train Cluster: 0.6437487125396728
	Train Separation: 0.5166045904159546
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7446808510638298
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7659574468085106
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.7553191489361702
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.7872340425531915
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.7659574468085106
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.6170212765957447
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7553191489361702
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.7872340425531915
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7872340425531915
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.7659574468085106
	Val acc at iteration 70: 0.6702127659574468
	Val acc at iteration 71: 0.8191489361702128
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 25: 0.7553191489361702
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8317307692307693
	Train Cluster: 0.6449994564056396
	TrainSeparation: 0.5192440986633301
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.0005
	Train acc at iteration 1: 0.8333333333333334
	Val acc at iteration 0: 0.7659574468085106
	Train acc at iteration 2: 0.8205128205128205
	Val acc at iteration 1: 0.8297872340425532
	Train acc at iteration 3: 0.7932692307692307
	Val acc at iteration 2: 0.723404255319149
	Train acc at iteration 4: 0.8253205128205128
	Val acc at iteration 3: 0.776595744680851
	Train acc at iteration 5: 0.8092948717948718
	Val acc at iteration 4: 0.7340425531914894
	Train acc at iteration 6: 0.8092948717948718
	Val acc at iteration 5: 0.7872340425531915
	Train acc at iteration 7: 0.8269230769230769
	Val acc at iteration 6: 0.6914893617021277
	Train acc at iteration 8: 0.8205128205128205
	Val acc at iteration 7: 0.7446808510638298
	Train acc at iteration 9: 0.8461538461538461
	Val acc at iteration 8: 0.7127659574468085
	Train acc at iteration 10: 0.8205128205128205
	Val acc at iteration 9: 0.723404255319149
	Train acc at iteration 11: 0.8365384615384616
	Val acc at iteration 10: 0.6914893617021277
	Train acc at iteration 12: 0.8333333333333334
	Val acc at iteration 11: 0.8085106382978723
	Train acc at iteration 13: 0.7964743589743589
	Val acc at iteration 12: 0.7553191489361702
	Train acc at iteration 14: 0.8365384615384616
	Val acc at iteration 13: 0.7340425531914894
	Train acc at iteration 15: 0.8269230769230769
	Val acc at iteration 14: 0.6702127659574468
	Train acc at iteration 16: 0.8509615384615384
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.7980769230769231
	Val acc at iteration 16: 0.7553191489361702
	Train acc at iteration 18: 0.8044871794871795
	Val acc at iteration 17: 0.7659574468085106
	Train acc at iteration 19: 0.8060897435897436
	Val acc at iteration 18: 0.7127659574468085
	Train acc at iteration 20: 0.8028846153846154
	Val acc at iteration 19: 0.776595744680851
	Train acc at iteration 21: 0.8317307692307693
	Val acc at iteration 20: 0.7446808510638298
	Train acc at iteration 22: 0.8317307692307693
	Val acc at iteration 21: 0.7872340425531915
	Train acc at iteration 23: 0.8253205128205128
	Val acc at iteration 22: 0.7446808510638298
	Train acc at iteration 24: 0.844551282051282
	Val acc at iteration 23: 0.7021276595744681
	Train acc at iteration 25: 0.8076923076923077
	Val acc at iteration 24: 0.723404255319149
	Train acc at iteration 26: 0.8237179487179487
	Val acc at iteration 25: 0.723404255319149
	Train acc at iteration 27: 0.8461538461538461
	Val acc at iteration 26: 0.7446808510638298
	Train acc at iteration 28: 0.842948717948718
	Val acc at iteration 27: 0.7978723404255319
	Train acc at iteration 29: 0.8365384615384616
	Val acc at iteration 28: 0.7872340425531915
	Train acc at iteration 30: 0.8509615384615384
	Val acc at iteration 29: 0.7127659574468085
	Train acc at iteration 31: 0.8141025641025641
	Val acc at iteration 30: 0.7659574468085106
	Train acc at iteration 32: 0.8541666666666666
	Val acc at iteration 31: 0.7978723404255319
	Train acc at iteration 33: 0.8349358974358975
	Val acc at iteration 32: 0.7340425531914894
	Train acc at iteration 34: 0.8173076923076923
	Val acc at iteration 33: 0.7553191489361702
	Train acc at iteration 35: 0.8060897435897436
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.8397435897435898
	Val acc at iteration 35: 0.723404255319149
	Train acc at iteration 37: 0.8044871794871795
	Val acc at iteration 36: 0.6595744680851063
	Train acc at iteration 38: 0.8557692307692307
	Val acc at iteration 37: 0.7978723404255319
	Train acc at iteration 39: 0.8317307692307693
	Val acc at iteration 38: 0.7872340425531915
	Train acc at iteration 40: 0.8141025641025641
	Val acc at iteration 39: 0.7553191489361702
	Train acc at iteration 41: 0.8317307692307693
	Val acc at iteration 40: 0.7340425531914894
	Train acc at iteration 42: 0.8333333333333334
	Val acc at iteration 41: 0.7553191489361702
	Train acc at iteration 43: 0.8141025641025641
	Val acc at iteration 42: 0.7978723404255319
	Train acc at iteration 44: 0.8317307692307693
	Val acc at iteration 43: 0.7659574468085106
	Train acc at iteration 45: 0.8205128205128205
	Val acc at iteration 44: 0.7127659574468085
	Train acc at iteration 46: 0.8237179487179487
	Val acc at iteration 45: 0.7127659574468085
	Train acc at iteration 47: 0.8189102564102564
	Val acc at iteration 46: 0.7872340425531915
	Train acc at iteration 48: 0.8076923076923077
	Val acc at iteration 47: 0.7872340425531915
	Train acc at iteration 49: 0.8365384615384616
	Val acc at iteration 48: 0.7659574468085106
	Train acc at iteration 50: 0.8413461538461539
	Val acc at iteration 49: 0.7553191489361702
	Train acc at iteration 51: 0.8205128205128205
	Val acc at iteration 50: 0.6382978723404256
	Train acc at iteration 52: 0.8141025641025641
	Val acc at iteration 51: 0.7127659574468085
	Train acc at iteration 53: 0.8205128205128205
	Val acc at iteration 52: 0.7978723404255319
	Train acc at iteration 54: 0.8413461538461539
	Val acc at iteration 53: 0.7872340425531915
	Train acc at iteration 55: 0.8397435897435898
	Val acc at iteration 54: 0.7659574468085106
	Train acc at iteration 56: 0.8461538461538461
	Val acc at iteration 55: 0.7659574468085106
	Train acc at iteration 57: 0.8237179487179487
	Val acc at iteration 56: 0.7553191489361702
	Train acc at iteration 58: 0.8125
	Val acc at iteration 57: 0.776595744680851
	Train acc at iteration 59: 0.8237179487179487
	Val acc at iteration 58: 0.7659574468085106
	Train acc at iteration 60: 0.8381410256410257
	Val acc at iteration 59: 0.7659574468085106
	Train acc at iteration 61: 0.8317307692307693
	Val acc at iteration 60: 0.7659574468085106
	Train acc at iteration 62: 0.8349358974358975
	Val acc at iteration 61: 0.7978723404255319
	Train acc at iteration 63: 0.8509615384615384
	Val acc at iteration 62: 0.7446808510638298
	Train acc at iteration 64: 0.8381410256410257
	Val acc at iteration 63: 0.7872340425531915
	Train acc at iteration 65: 0.8044871794871795
	Val acc at iteration 64: 0.6914893617021277
	Train acc at iteration 66: 0.8060897435897436
	Val acc at iteration 65: 0.7127659574468085
	Train acc at iteration 67: 0.8189102564102564
	Val acc at iteration 66: 0.7021276595744681
	Train acc at iteration 68: 0.8189102564102564
	Val acc at iteration 67: 0.7659574468085106
	Train acc at iteration 69: 0.8317307692307693
	Val acc at iteration 68: 0.8297872340425532
	Train acc at iteration 70: 0.8237179487179487
	Val acc at iteration 69: 0.7340425531914894
	Train acc at iteration 71: 0.8221153846153846
	Val acc at iteration 70: 0.7978723404255319
	Train acc at iteration 72: 0.8333333333333334
	Val acc at iteration 71: 0.7872340425531915
	Train acc at iteration 73: 0.8157051282051282
	Val acc at iteration 72: 0.723404255319149
	Train acc at iteration 74: 0.844551282051282
	Val acc at iteration 73: 0.8191489361702128
	Train acc at iteration 75: 0.842948717948718
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.8189102564102564
	Val acc at iteration 75: 0.8085106382978723
	Train acc at iteration 77: 0.8221153846153846
	Val acc at iteration 76: 0.6914893617021277
	Train acc at iteration 78: 0.844551282051282
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.844551282051282
	Val acc at iteration 78: 0.776595744680851
	Train acc at iteration 80: 0.8365384615384616
	Val acc at iteration 79: 0.7127659574468085
	Train acc at iteration 81: 0.8397435897435898
	Val acc at iteration 80: 0.723404255319149
	Train acc at iteration 82: 0.7996794871794872
	Val acc at iteration 81: 0.7978723404255319
	Train acc at iteration 83: 0.8381410256410257
	Val acc at iteration 82: 0.8297872340425532
	Train acc at iteration 84: 0.8397435897435898
	Val acc at iteration 83: 0.7553191489361702
	Train acc at iteration 85: 0.8060897435897436
	Val acc at iteration 84: 0.7340425531914894
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6822916666666666
Final val micro accuracy: 0.776595744680851
Final test macro f1-score: 0.5244186046511627
Final test micro accuracy: 0.6595744680851063
Final validation:
	Cluster: 0.6354058682918549
	Separation: 0.5337014198303223
Final test:
	Cluster: 0.6042506992816925
	Separation: 0.5333373844623566
Saved Results

Attempting combination 17/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5212765957446809
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Train Cluster: 0.6397133231163025
	Train Separation: 0.5184494256973267
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6595744680851063
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6170212765957447
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.6382978723404256
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.723404255319149
	Val acc at iteration 33: 0.6276595744680851
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.776595744680851
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.776595744680851
	Val acc at iteration 43: 0.6808510638297872
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.7553191489361702
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6382978723404256
	Val acc at iteration 68: 0.7872340425531915
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.7872340425531915
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8205128205128205
	Train Cluster: 0.648116934299469
	Train Separation: 0.5187537908554077
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.7340425531914894
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.7553191489361702
	Val acc at iteration 5: 0.8297872340425532
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.8085106382978723
	Val acc at iteration 9: 0.8191489361702128
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.8404255319148937
	Val acc at iteration 12: 0.723404255319149
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.8191489361702128
	Val acc at iteration 16: 0.7659574468085106
	Val acc at iteration 17: 0.7872340425531915
	Val acc at iteration 18: 0.7659574468085106
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.8297872340425532
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.776595744680851
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7553191489361702
	Val acc at iteration 28: 0.776595744680851
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.7978723404255319
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.776595744680851
	Val acc at iteration 36: 0.7978723404255319
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.7978723404255319
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.8085106382978723
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.8191489361702128
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.7872340425531915
	Val acc at iteration 59: 0.7659574468085106
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.776595744680851
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7872340425531915
	Val acc at iteration 71: 0.7553191489361702
	Val acc at iteration 72: 0.8085106382978723
	Val acc at iteration 73: 0.7978723404255319
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.8404255319148937
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.8085106382978723
Val acc before epoch 25: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8349358974358975
	Train Cluster: 0.6489000797271729
	TrainSeparation: 0.5202349901199341
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.0001
	Train acc at iteration 1: 0.8237179487179487
	Val acc at iteration 0: 0.6702127659574468
	Train acc at iteration 2: 0.8397435897435898
	Val acc at iteration 1: 0.7659574468085106
	Train acc at iteration 3: 0.8381410256410257
	Val acc at iteration 2: 0.7872340425531915
	Train acc at iteration 4: 0.8285256410256411
	Val acc at iteration 3: 0.776595744680851
	Train acc at iteration 5: 0.8237179487179487
	Val acc at iteration 4: 0.7021276595744681
	Train acc at iteration 6: 0.8413461538461539
	Val acc at iteration 5: 0.8085106382978723
	Train acc at iteration 7: 0.8349358974358975
	Val acc at iteration 6: 0.7659574468085106
	Train acc at iteration 8: 0.8493589743589743
	Val acc at iteration 7: 0.7127659574468085
	Train acc at iteration 9: 0.8397435897435898
	Val acc at iteration 8: 0.8191489361702128
	Train acc at iteration 10: 0.8189102564102564
	Val acc at iteration 9: 0.7021276595744681
	Train acc at iteration 11: 0.8285256410256411
	Val acc at iteration 10: 0.8404255319148937
	Train acc at iteration 12: 0.8333333333333334
	Val acc at iteration 11: 0.7872340425531915
	Train acc at iteration 13: 0.8269230769230769
	Val acc at iteration 12: 0.7446808510638298
	Train acc at iteration 14: 0.842948717948718
	Val acc at iteration 13: 0.7978723404255319
	Train acc at iteration 15: 0.8269230769230769
	Val acc at iteration 14: 0.723404255319149
	Train acc at iteration 16: 0.8333333333333334
	Val acc at iteration 15: 0.7872340425531915
	Train acc at iteration 17: 0.8125
	Val acc at iteration 16: 0.776595744680851
	Train acc at iteration 18: 0.8349358974358975
	Val acc at iteration 17: 0.7659574468085106
	Train acc at iteration 19: 0.8381410256410257
	Val acc at iteration 18: 0.7446808510638298
	Train acc at iteration 20: 0.8525641025641025
	Val acc at iteration 19: 0.776595744680851
	Train acc at iteration 21: 0.8237179487179487
	Val acc at iteration 20: 0.7340425531914894
	Train acc at iteration 22: 0.8108974358974359
	Val acc at iteration 21: 0.776595744680851
	Train acc at iteration 23: 0.8205128205128205
	Val acc at iteration 22: 0.723404255319149
	Train acc at iteration 24: 0.8413461538461539
	Val acc at iteration 23: 0.7978723404255319
	Train acc at iteration 25: 0.8605769230769231
	Val acc at iteration 24: 0.8297872340425532
	Train acc at iteration 26: 0.8285256410256411
	Val acc at iteration 25: 0.7446808510638298
	Train acc at iteration 27: 0.8557692307692307
	Val acc at iteration 26: 0.7446808510638298
	Train acc at iteration 28: 0.8477564102564102
	Val acc at iteration 27: 0.7659574468085106
	Train acc at iteration 29: 0.8589743589743589
	Val acc at iteration 28: 0.7659574468085106
	Train acc at iteration 30: 0.842948717948718
	Val acc at iteration 29: 0.7553191489361702
	Train acc at iteration 31: 0.8285256410256411
	Val acc at iteration 30: 0.7340425531914894
	Train acc at iteration 32: 0.8044871794871795
	Val acc at iteration 31: 0.7659574468085106
	Train acc at iteration 33: 0.8108974358974359
	Val acc at iteration 32: 0.723404255319149
	Train acc at iteration 34: 0.8237179487179487
	Val acc at iteration 33: 0.7553191489361702
	Train acc at iteration 35: 0.844551282051282
	Val acc at iteration 34: 0.6914893617021277
	Train acc at iteration 36: 0.8541666666666666
	Val acc at iteration 35: 0.7659574468085106
	Train acc at iteration 37: 0.8028846153846154
	Val acc at iteration 36: 0.7553191489361702
	Train acc at iteration 38: 0.8141025641025641
	Val acc at iteration 37: 0.7872340425531915
	Train acc at iteration 39: 0.8349358974358975
	Val acc at iteration 38: 0.7659574468085106
	Train acc at iteration 40: 0.8365384615384616
	Val acc at iteration 39: 0.7446808510638298
	Train acc at iteration 41: 0.8269230769230769
	Val acc at iteration 40: 0.7553191489361702
	Train acc at iteration 42: 0.8413461538461539
	Val acc at iteration 41: 0.723404255319149
	Train acc at iteration 43: 0.8253205128205128
	Val acc at iteration 42: 0.7872340425531915
	Train acc at iteration 44: 0.8301282051282052
	Val acc at iteration 43: 0.7978723404255319
	Train acc at iteration 45: 0.8189102564102564
	Val acc at iteration 44: 0.7553191489361702
	Train acc at iteration 46: 0.8397435897435898
	Val acc at iteration 45: 0.7659574468085106
	Train acc at iteration 47: 0.842948717948718
	Val acc at iteration 46: 0.7553191489361702
	Train acc at iteration 48: 0.8381410256410257
	Val acc at iteration 47: 0.776595744680851
	Train acc at iteration 49: 0.8285256410256411
	Val acc at iteration 48: 0.7659574468085106
	Train acc at iteration 50: 0.8044871794871795
	Val acc at iteration 49: 0.776595744680851
	Train acc at iteration 51: 0.8269230769230769
	Val acc at iteration 50: 0.7659574468085106
	Train acc at iteration 52: 0.8157051282051282
	Val acc at iteration 51: 0.7978723404255319
	Train acc at iteration 53: 0.8349358974358975
	Val acc at iteration 52: 0.7659574468085106
	Train acc at iteration 54: 0.8349358974358975
	Val acc at iteration 53: 0.7978723404255319
	Train acc at iteration 55: 0.8301282051282052
	Val acc at iteration 54: 0.7553191489361702
	Train acc at iteration 56: 0.8413461538461539
	Val acc at iteration 55: 0.7978723404255319
	Train acc at iteration 57: 0.8349358974358975
	Val acc at iteration 56: 0.776595744680851
	Train acc at iteration 58: 0.8381410256410257
	Val acc at iteration 57: 0.776595744680851
	Train acc at iteration 59: 0.8301282051282052
	Val acc at iteration 58: 0.7872340425531915
	Train acc at iteration 60: 0.8285256410256411
	Val acc at iteration 59: 0.7340425531914894
	Train acc at iteration 61: 0.8397435897435898
	Val acc at iteration 60: 0.776595744680851
	Train acc at iteration 62: 0.8397435897435898
	Val acc at iteration 61: 0.7872340425531915
	Train acc at iteration 63: 0.8108974358974359
	Val acc at iteration 62: 0.7446808510638298
	Train acc at iteration 64: 0.8509615384615384
	Val acc at iteration 63: 0.723404255319149
	Train acc at iteration 65: 0.8381410256410257
	Val acc at iteration 64: 0.776595744680851
	Train acc at iteration 66: 0.8205128205128205
	Val acc at iteration 65: 0.7340425531914894
	Train acc at iteration 67: 0.8589743589743589
	Val acc at iteration 66: 0.6595744680851063
	Train acc at iteration 68: 0.8189102564102564
	Val acc at iteration 67: 0.7553191489361702
	Train acc at iteration 69: 0.844551282051282
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.8509615384615384
	Val acc at iteration 69: 0.7872340425531915
	Train acc at iteration 71: 0.8397435897435898
	Val acc at iteration 70: 0.8191489361702128
	Train acc at iteration 72: 0.8285256410256411
	Val acc at iteration 71: 0.7127659574468085
	Train acc at iteration 73: 0.8269230769230769
	Val acc at iteration 72: 0.7659574468085106
	Train acc at iteration 74: 0.8621794871794872
	Val acc at iteration 73: 0.7340425531914894
	Train acc at iteration 75: 0.8060897435897436
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.8237179487179487
	Val acc at iteration 75: 0.7340425531914894
	Train acc at iteration 77: 0.8092948717948718
	Val acc at iteration 76: 0.7978723404255319
	Train acc at iteration 78: 0.8301282051282052
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.8173076923076923
	Val acc at iteration 78: 0.8191489361702128
	Train acc at iteration 80: 0.8221153846153846
	Val acc at iteration 79: 0.7446808510638298
	Train acc at iteration 81: 0.8557692307692307
	Val acc at iteration 80: 0.7127659574468085
	Train acc at iteration 82: 0.8541666666666666
	Val acc at iteration 81: 0.7340425531914894
	Train acc at iteration 83: 0.8108974358974359
	Val acc at iteration 82: 0.7340425531914894
	Train acc at iteration 84: 0.8413461538461539
	Val acc at iteration 83: 0.7659574468085106
	Train acc at iteration 85: 0.8205128205128205
	Val acc at iteration 84: 0.7659574468085106
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6890034364261169
Final val micro accuracy: 0.7872340425531915
Final test macro f1-score: 0.6217054263565892
Final test micro accuracy: 0.7340425531914894
Final validation:
	Cluster: 0.6234901547431946
	Separation: 0.5385304093360901
Final test:
	Cluster: 0.6116470992565155
	Separation: 0.5327504277229309
Saved Results

Attempting combination 18/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.0005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 5e-05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.425531914893617
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7580128205128205
	Train Cluster: 0.637957751750946
	Train Separation: 0.5204287171363831
(Directly after push) Val acc at iteration 0: 0.5957446808510638
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5957446808510638
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.5957446808510638
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.7553191489361702
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.5638297872340425
	Val acc at iteration 10: 0.6170212765957447
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.574468085106383
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6170212765957447
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.5957446808510638
	Val acc at iteration 23: 0.5319148936170213
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6063829787234043
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7553191489361702
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.5851063829787234
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.5957446808510638
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.776595744680851
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.7978723404255319
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.6595744680851063
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7553191489361702
	Val acc at iteration 63: 0.6382978723404256
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.8297872340425532
	Val acc at iteration 69: 0.6808510638297872
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.6063829787234043
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.7872340425531915
Val acc before epoch 13: 0.7446808510638298
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8085106382978723
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7852564102564102
	Train Cluster: 0.6434293031692505
	Train Separation: 0.5190386414527893
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.776595744680851
	Val acc at iteration 5: 0.8191489361702128
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.7446808510638298
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.7553191489361702
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.7446808510638298
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7872340425531915
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.8404255319148937
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7978723404255319
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.8085106382978723
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.776595744680851
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.8191489361702128
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.776595744680851
	Val acc at iteration 52: 0.8085106382978723
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.7659574468085106
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.6914893617021277
	Val acc at iteration 66: 0.8085106382978723
	Val acc at iteration 67: 0.7659574468085106
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.7978723404255319
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7340425531914894
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.7659574468085106
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.7978723404255319
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 25: 0.8085106382978723
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8076923076923077
	Train Cluster: 0.6324638605117798
	TrainSeparation: 0.5155102014541626
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 5e-05
	Train acc at iteration 1: 0.8221153846153846
	Val acc at iteration 0: 0.7340425531914894
	Train acc at iteration 2: 0.8125
	Val acc at iteration 1: 0.723404255319149
	Train acc at iteration 3: 0.7996794871794872
	Val acc at iteration 2: 0.7978723404255319
	Train acc at iteration 4: 0.7932692307692307
	Val acc at iteration 3: 0.7021276595744681
	Train acc at iteration 5: 0.8076923076923077
	Val acc at iteration 4: 0.7659574468085106
	Train acc at iteration 6: 0.7916666666666666
	Val acc at iteration 5: 0.7978723404255319
	Train acc at iteration 7: 0.8044871794871795
	Val acc at iteration 6: 0.7021276595744681
	Train acc at iteration 8: 0.8060897435897436
	Val acc at iteration 7: 0.7659574468085106
	Train acc at iteration 9: 0.7964743589743589
	Val acc at iteration 8: 0.6914893617021277
	Train acc at iteration 10: 0.7948717948717948
	Val acc at iteration 9: 0.776595744680851
	Train acc at iteration 11: 0.8092948717948718
	Val acc at iteration 10: 0.723404255319149
	Train acc at iteration 12: 0.8221153846153846
	Val acc at iteration 11: 0.7978723404255319
	Train acc at iteration 13: 0.8108974358974359
	Val acc at iteration 12: 0.7978723404255319
	Train acc at iteration 14: 0.8173076923076923
	Val acc at iteration 13: 0.7021276595744681
	Train acc at iteration 15: 0.8205128205128205
	Val acc at iteration 14: 0.7872340425531915
	Train acc at iteration 16: 0.7980769230769231
	Val acc at iteration 15: 0.7659574468085106
	Train acc at iteration 17: 0.8237179487179487
	Val acc at iteration 16: 0.7446808510638298
	Train acc at iteration 18: 0.7852564102564102
	Val acc at iteration 17: 0.7659574468085106
	Train acc at iteration 19: 0.8221153846153846
	Val acc at iteration 18: 0.8085106382978723
	Train acc at iteration 20: 0.8269230769230769
	Val acc at iteration 19: 0.7553191489361702
	Train acc at iteration 21: 0.8397435897435898
	Val acc at iteration 20: 0.7446808510638298
	Train acc at iteration 22: 0.8173076923076923
	Val acc at iteration 21: 0.723404255319149
	Train acc at iteration 23: 0.7996794871794872
	Val acc at iteration 22: 0.7872340425531915
	Train acc at iteration 24: 0.8301282051282052
	Val acc at iteration 23: 0.8085106382978723
	Train acc at iteration 25: 0.7740384615384616
	Val acc at iteration 24: 0.7127659574468085
	Train acc at iteration 26: 0.8237179487179487
	Val acc at iteration 25: 0.776595744680851
	Train acc at iteration 27: 0.8044871794871795
	Val acc at iteration 26: 0.7553191489361702
	Train acc at iteration 28: 0.8044871794871795
	Val acc at iteration 27: 0.7872340425531915
	Train acc at iteration 29: 0.8012820512820513
	Val acc at iteration 28: 0.7021276595744681
	Train acc at iteration 30: 0.8157051282051282
	Val acc at iteration 29: 0.7446808510638298
	Train acc at iteration 31: 0.8076923076923077
	Val acc at iteration 30: 0.8191489361702128
	Train acc at iteration 32: 0.7772435897435898
	Val acc at iteration 31: 0.7340425531914894
	Train acc at iteration 33: 0.7708333333333334
	Val acc at iteration 32: 0.776595744680851
	Train acc at iteration 34: 0.8157051282051282
	Val acc at iteration 33: 0.7446808510638298
	Train acc at iteration 35: 0.8269230769230769
	Val acc at iteration 34: 0.7446808510638298
	Train acc at iteration 36: 0.8044871794871795
	Val acc at iteration 35: 0.7127659574468085
	Train acc at iteration 37: 0.8044871794871795
	Val acc at iteration 36: 0.7340425531914894
	Train acc at iteration 38: 0.8028846153846154
	Val acc at iteration 37: 0.7340425531914894
	Train acc at iteration 39: 0.8076923076923077
	Val acc at iteration 38: 0.7553191489361702
	Train acc at iteration 40: 0.8237179487179487
	Val acc at iteration 39: 0.7340425531914894
	Train acc at iteration 41: 0.8493589743589743
	Val acc at iteration 40: 0.7659574468085106
	Train acc at iteration 42: 0.8141025641025641
	Val acc at iteration 41: 0.7553191489361702
	Train acc at iteration 43: 0.8333333333333334
	Val acc at iteration 42: 0.7553191489361702
	Train acc at iteration 44: 0.8060897435897436
	Val acc at iteration 43: 0.7446808510638298
	Train acc at iteration 45: 0.8525641025641025
	Val acc at iteration 44: 0.6914893617021277
	Train acc at iteration 46: 0.8189102564102564
	Val acc at iteration 45: 0.6808510638297872
	Train acc at iteration 47: 0.8205128205128205
	Val acc at iteration 46: 0.7553191489361702
	Train acc at iteration 48: 0.8028846153846154
	Val acc at iteration 47: 0.7978723404255319
	Train acc at iteration 49: 0.8189102564102564
	Val acc at iteration 48: 0.7446808510638298
	Train acc at iteration 50: 0.8397435897435898
	Val acc at iteration 49: 0.7659574468085106
	Train acc at iteration 51: 0.8076923076923077
	Val acc at iteration 50: 0.8191489361702128
	Train acc at iteration 52: 0.8205128205128205
	Val acc at iteration 51: 0.7446808510638298
	Train acc at iteration 53: 0.7852564102564102
	Val acc at iteration 52: 0.6914893617021277
	Train acc at iteration 54: 0.8076923076923077
	Val acc at iteration 53: 0.8297872340425532
	Train acc at iteration 55: 0.8012820512820513
	Val acc at iteration 54: 0.8085106382978723
	Train acc at iteration 56: 0.8237179487179487
	Val acc at iteration 55: 0.7553191489361702
	Train acc at iteration 57: 0.8333333333333334
	Val acc at iteration 56: 0.7553191489361702
	Train acc at iteration 58: 0.8076923076923077
	Val acc at iteration 57: 0.7553191489361702
	Train acc at iteration 59: 0.8060897435897436
	Val acc at iteration 58: 0.7659574468085106
	Train acc at iteration 60: 0.7996794871794872
	Val acc at iteration 59: 0.7553191489361702
	Train acc at iteration 61: 0.8060897435897436
	Val acc at iteration 60: 0.7978723404255319
	Train acc at iteration 62: 0.8092948717948718
	Val acc at iteration 61: 0.7446808510638298
	Train acc at iteration 63: 0.8125
	Val acc at iteration 62: 0.7446808510638298
	Train acc at iteration 64: 0.8141025641025641
	Val acc at iteration 63: 0.8297872340425532
	Train acc at iteration 65: 0.8125
	Val acc at iteration 64: 0.8191489361702128
	Train acc at iteration 66: 0.8221153846153846
	Val acc at iteration 65: 0.8404255319148937
	Train acc at iteration 67: 0.8269230769230769
	Val acc at iteration 66: 0.7659574468085106
	Train acc at iteration 68: 0.8028846153846154
	Val acc at iteration 67: 0.7127659574468085
	Train acc at iteration 69: 0.8253205128205128
	Val acc at iteration 68: 0.8085106382978723
	Train acc at iteration 70: 0.8269230769230769
	Val acc at iteration 69: 0.776595744680851
	Train acc at iteration 71: 0.8285256410256411
	Val acc at iteration 70: 0.7659574468085106
	Train acc at iteration 72: 0.8285256410256411
	Val acc at iteration 71: 0.6914893617021277
	Train acc at iteration 73: 0.8157051282051282
	Val acc at iteration 72: 0.7340425531914894
	Train acc at iteration 74: 0.8108974358974359
	Val acc at iteration 73: 0.776595744680851
	Train acc at iteration 75: 0.8125
	Val acc at iteration 74: 0.723404255319149
	Train acc at iteration 76: 0.8076923076923077
	Val acc at iteration 75: 0.7872340425531915
	Train acc at iteration 77: 0.8076923076923077
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.8301282051282052
	Val acc at iteration 77: 0.7659574468085106
	Train acc at iteration 79: 0.844551282051282
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.8189102564102564
	Val acc at iteration 79: 0.7978723404255319
	Train acc at iteration 81: 0.8285256410256411
	Val acc at iteration 80: 0.6808510638297872
	Train acc at iteration 82: 0.8060897435897436
	Val acc at iteration 81: 0.776595744680851
	Train acc at iteration 83: 0.8141025641025641
	Val acc at iteration 82: 0.6914893617021277
	Train acc at iteration 84: 0.8028846153846154
	Val acc at iteration 83: 0.723404255319149
	Train acc at iteration 85: 0.8173076923076923
	Val acc at iteration 84: 0.7659574468085106
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6353951890034365
Final val micro accuracy: 0.7340425531914894
Final test macro f1-score: 0.5346709470304976
Final test micro accuracy: 0.6382978723404256
Final validation:
	Cluster: 0.6074515879154205
	Separation: 0.5427616834640503
Final test:
	Cluster: 0.5916909277439117
	Separation: 0.5372421443462372
Saved Results

Attempting combination 19/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6808510638297872
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7467948717948718
	Train Cluster: 0.6396600723266601
	Train Separation: 0.5188054919242859
(Directly after push) Val acc at iteration 0: 0.5531914893617021
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5425531914893617
	Val acc at iteration 1: 0.648936170212766
	Val acc at iteration 2: 0.5531914893617021
	Val acc at iteration 3: 0.5638297872340425
	Val acc at iteration 4: 0.5957446808510638
	Val acc at iteration 5: 0.6063829787234043
	Val acc at iteration 6: 0.6170212765957447
	Val acc at iteration 7: 0.5425531914893617
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.5957446808510638
	Val acc at iteration 12: 0.5638297872340425
	Val acc at iteration 13: 0.5851063829787234
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.723404255319149
	Val acc at iteration 16: 0.5957446808510638
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6063829787234043
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.5851063829787234
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.5851063829787234
	Val acc at iteration 27: 0.5638297872340425
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.5957446808510638
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.6382978723404256
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6063829787234043
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.648936170212766
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.5531914893617021
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 13: 0.6914893617021277
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.8044871794871795
	Train Cluster: 0.6471649885177613
	Train Separation: 0.5203899145126343
(Directly after push) Val acc at iteration 0: 0.5957446808510638
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.7021276595744681
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6170212765957447
	Val acc at iteration 14: 0.6382978723404256
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6808510638297872
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.7872340425531915
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.6170212765957447
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.8085106382978723
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.6702127659574468
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.6063829787234043
	Val acc at iteration 74: 0.6382978723404256
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6276595744680851
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.6595744680851063
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 25: 0.7127659574468085
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8191489361702128
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.8936170212765957
Stopping after epoch 37.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8125
	Train Cluster: 0.6544759273529053
	TrainSeparation: 0.5220977425575256
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.21634615384615385
	Val acc at iteration 0: 0.0425531914893617
	Train acc at iteration 2: 0.004807692307692308
	Val acc at iteration 1: 0.0
	Train acc at iteration 3: 0.0016025641025641025
	Val acc at iteration 2: 0.0851063829787234
	Train acc at iteration 4: 0.020833333333333332
	Val acc at iteration 3: 0.10638297872340426
	Train acc at iteration 5: 0.057692307692307696
	Val acc at iteration 4: 0.0425531914893617
	Train acc at iteration 6: 0.05128205128205128
	Val acc at iteration 5: 0.0425531914893617
	Train acc at iteration 7: 0.060897435897435896
	Val acc at iteration 6: 0.031914893617021274
	Train acc at iteration 8: 0.060897435897435896
	Val acc at iteration 7: 0.05319148936170213
	Train acc at iteration 9: 0.03365384615384615
	Val acc at iteration 8: 0.05319148936170213
	Train acc at iteration 10: 0.04807692307692308
	Val acc at iteration 9: 0.05319148936170213
	Train acc at iteration 11: 0.04807692307692308
	Val acc at iteration 10: 0.07446808510638298
	Train acc at iteration 12: 0.04006410256410257
	Val acc at iteration 11: 0.031914893617021274
	Train acc at iteration 13: 0.05128205128205128
	Val acc at iteration 12: 0.07446808510638298
	Train acc at iteration 14: 0.07211538461538461
	Val acc at iteration 13: 0.0851063829787234
	Train acc at iteration 15: 0.05608974358974359
	Val acc at iteration 14: 0.06382978723404255
	Train acc at iteration 16: 0.057692307692307696
	Val acc at iteration 15: 0.09574468085106383
	Train acc at iteration 17: 0.09775641025641026
	Val acc at iteration 16: 0.1276595744680851
	Train acc at iteration 18: 0.11538461538461539
	Val acc at iteration 17: 0.0851063829787234
	Train acc at iteration 19: 0.1266025641025641
	Val acc at iteration 18: 0.0851063829787234
	Train acc at iteration 20: 0.10256410256410256
	Val acc at iteration 19: 0.13829787234042554
	Train acc at iteration 21: 0.08333333333333333
	Val acc at iteration 20: 0.11702127659574468
	Train acc at iteration 22: 0.14743589743589744
	Val acc at iteration 21: 0.24468085106382978
	Train acc at iteration 23: 0.20833333333333334
	Val acc at iteration 22: 0.1702127659574468
	Train acc at iteration 24: 0.125
	Val acc at iteration 23: 0.10638297872340426
	Train acc at iteration 25: 0.14423076923076922
	Val acc at iteration 24: 0.22340425531914893
	Train acc at iteration 26: 0.20032051282051283
	Val acc at iteration 25: 0.2127659574468085
	Train acc at iteration 27: 0.16666666666666666
	Val acc at iteration 26: 0.22340425531914893
	Train acc at iteration 28: 0.23237179487179488
	Val acc at iteration 27: 0.1276595744680851
	Train acc at iteration 29: 0.14583333333333334
	Val acc at iteration 28: 0.20212765957446807
	Train acc at iteration 30: 0.16987179487179488
	Val acc at iteration 29: 0.24468085106382978
	Train acc at iteration 31: 0.21955128205128205
	Val acc at iteration 30: 0.1702127659574468
	Train acc at iteration 32: 0.20993589743589744
	Val acc at iteration 31: 0.24468085106382978
	Train acc at iteration 33: 0.1762820512820513
	Val acc at iteration 32: 0.20212765957446807
	Train acc at iteration 34: 0.2483974358974359
	Val acc at iteration 33: 0.1595744680851064
	Train acc at iteration 35: 0.20512820512820512
	Val acc at iteration 34: 0.3191489361702128
	Train acc at iteration 36: 0.26121794871794873
	Val acc at iteration 35: 0.22340425531914893
	Train acc at iteration 37: 0.266025641025641
	Val acc at iteration 36: 0.2978723404255319
	Train acc at iteration 38: 0.28846153846153844
	Val acc at iteration 37: 0.19148936170212766
	Train acc at iteration 39: 0.23557692307692307
	Val acc at iteration 38: 0.3404255319148936
	Train acc at iteration 40: 0.2403846153846154
	Val acc at iteration 39: 0.4148936170212766
	Train acc at iteration 41: 0.30128205128205127
	Val acc at iteration 40: 0.2553191489361702
	Train acc at iteration 42: 0.22756410256410256
	Val acc at iteration 41: 0.3723404255319149
	Train acc at iteration 43: 0.34294871794871795
	Val acc at iteration 42: 0.18085106382978725
	Train acc at iteration 44: 0.15544871794871795
	Val acc at iteration 43: 0.2765957446808511
	Train acc at iteration 45: 0.23397435897435898
	Val acc at iteration 44: 0.3617021276595745
	Train acc at iteration 46: 0.30128205128205127
	Val acc at iteration 45: 0.3404255319148936
	Train acc at iteration 47: 0.35096153846153844
	Val acc at iteration 46: 0.2978723404255319
	Train acc at iteration 48: 0.28044871794871795
	Val acc at iteration 47: 0.2553191489361702
	Train acc at iteration 49: 0.34775641025641024
	Val acc at iteration 48: 0.22340425531914893
	Train acc at iteration 50: 0.33974358974358976
	Val acc at iteration 49: 0.3829787234042553
	Train acc at iteration 51: 0.38621794871794873
	Val acc at iteration 50: 0.44680851063829785
	Train acc at iteration 52: 0.3557692307692308
	Val acc at iteration 51: 0.26595744680851063
	Train acc at iteration 53: 0.42467948717948717
	Val acc at iteration 52: 0.3829787234042553
	Train acc at iteration 54: 0.27724358974358976
	Val acc at iteration 53: 0.2553191489361702
	Train acc at iteration 55: 0.2948717948717949
	Val acc at iteration 54: 0.35106382978723405
	Train acc at iteration 56: 0.35096153846153844
	Val acc at iteration 55: 0.30851063829787234
	Train acc at iteration 57: 0.40224358974358976
	Val acc at iteration 56: 0.3617021276595745
	Train acc at iteration 58: 0.46153846153846156
	Val acc at iteration 57: 0.3404255319148936
	Train acc at iteration 59: 0.4439102564102564
	Val acc at iteration 58: 0.26595744680851063
	Train acc at iteration 60: 0.2980769230769231
	Val acc at iteration 59: 0.22340425531914893
	Train acc at iteration 61: 0.41185897435897434
	Val acc at iteration 60: 0.3829787234042553
	Train acc at iteration 62: 0.391025641025641
	Val acc at iteration 61: 0.32978723404255317
	Train acc at iteration 63: 0.40064102564102566
	Val acc at iteration 62: 0.425531914893617
	Train acc at iteration 64: 0.4967948717948718
	Val acc at iteration 63: 0.5638297872340425
	Train acc at iteration 65: 0.5
	Val acc at iteration 64: 0.48936170212765956
	Train acc at iteration 66: 0.5288461538461539
	Val acc at iteration 65: 0.574468085106383
	Train acc at iteration 67: 0.4967948717948718
	Val acc at iteration 66: 0.44680851063829785
	Train acc at iteration 68: 0.47435897435897434
	Val acc at iteration 67: 0.4787234042553192
	Train acc at iteration 69: 0.5336538461538461
	Val acc at iteration 68: 0.5851063829787234
	Train acc at iteration 70: 0.5400641025641025
	Val acc at iteration 69: 0.40425531914893614
	Train acc at iteration 71: 0.4807692307692308
	Val acc at iteration 70: 0.5
	Train acc at iteration 72: 0.5737179487179487
	Val acc at iteration 71: 0.46808510638297873
	Train acc at iteration 73: 0.5128205128205128
	Val acc at iteration 72: 0.2872340425531915
	Train acc at iteration 74: 0.483974358974359
	Val acc at iteration 73: 0.4148936170212766
	Train acc at iteration 75: 0.5432692307692307
	Val acc at iteration 74: 0.5531914893617021
	Train acc at iteration 76: 0.5977564102564102
	Val acc at iteration 75: 0.5638297872340425
	Train acc at iteration 77: 0.6073717948717948
	Val acc at iteration 76: 0.6276595744680851
	Train acc at iteration 78: 0.5897435897435898
	Val acc at iteration 77: 0.5957446808510638
	Train acc at iteration 79: 0.6538461538461539
	Val acc at iteration 78: 0.6276595744680851
	Train acc at iteration 80: 0.6314102564102564
	Val acc at iteration 79: 0.5212765957446809
	Train acc at iteration 81: 0.6474358974358975
	Val acc at iteration 80: 0.48936170212765956
	Train acc at iteration 82: 0.6490384615384616
	Val acc at iteration 81: 0.5319148936170213
	Train acc at iteration 83: 0.5512820512820513
	Val acc at iteration 82: 0.5957446808510638
	Train acc at iteration 84: 0.6442307692307693
	Val acc at iteration 83: 0.5638297872340425
	Train acc at iteration 85: 0.6538461538461539
	Val acc at iteration 84: 0.6063829787234043
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.455
Final val micro accuracy: 0.5638297872340425
Final test macro f1-score: 0.4768627450980392
Final test micro accuracy: 0.5531914893617021
Final validation:
	Cluster: 0.6196371912956238
	Separation: 0.535283774137497
Final test:
	Cluster: 0.6028659641742706
	Separation: 0.5387850701808929
Saved Results

Attempting combination 20/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Train Cluster: 0.6444966316223144
	Train Separation: 0.5183327317237854
(Directly after push) Val acc at iteration 0: 0.574468085106383
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.5531914893617021
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.5851063829787234
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.6170212765957447
	Val acc at iteration 41: 0.7553191489361702
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6914893617021277
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.574468085106383
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.5851063829787234
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.7446808510638298
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.6808510638297872
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.6914893617021277
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.648936170212766
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.6808510638297872
Val acc before epoch 13: 0.7127659574468085
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Train Cluster: 0.642682945728302
	Train Separation: 0.5188391923904419
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.7553191489361702
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.7978723404255319
	Val acc at iteration 14: 0.7446808510638298
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.7553191489361702
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.8404255319148937
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.8085106382978723
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6808510638297872
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.7978723404255319
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.7872340425531915
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.6808510638297872
	Val acc at iteration 61: 0.648936170212766
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.6382978723404256
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.6276595744680851
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.6808510638297872
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7127659574468085
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.6276595744680851
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7021276595744681
Val acc before epoch 25: 0.6382978723404256
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8108974358974359
	Train Cluster: 0.6335838079452515
	TrainSeparation: 0.515790855884552
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.2532051282051282
	Val acc at iteration 0: 0.18085106382978725
	Train acc at iteration 2: 0.10096153846153846
	Val acc at iteration 1: 0.19148936170212766
	Train acc at iteration 3: 0.0625
	Val acc at iteration 2: 0.1702127659574468
	Train acc at iteration 4: 0.10737179487179487
	Val acc at iteration 3: 0.10638297872340426
	Train acc at iteration 5: 0.07692307692307693
	Val acc at iteration 4: 0.031914893617021274
	Train acc at iteration 6: 0.05929487179487179
	Val acc at iteration 5: 0.031914893617021274
	Train acc at iteration 7: 0.02564102564102564
	Val acc at iteration 6: 0.031914893617021274
	Train acc at iteration 8: 0.05929487179487179
	Val acc at iteration 7: 0.02127659574468085
	Train acc at iteration 9: 0.07532051282051282
	Val acc at iteration 8: 0.19148936170212766
	Train acc at iteration 10: 0.09134615384615384
	Val acc at iteration 9: 0.06382978723404255
	Train acc at iteration 11: 0.08173076923076923
	Val acc at iteration 10: 0.2127659574468085
	Train acc at iteration 12: 0.14583333333333334
	Val acc at iteration 11: 0.09574468085106383
	Train acc at iteration 13: 0.07692307692307693
	Val acc at iteration 12: 0.13829787234042554
	Train acc at iteration 14: 0.15544871794871795
	Val acc at iteration 13: 0.06382978723404255
	Train acc at iteration 15: 0.08974358974358974
	Val acc at iteration 14: 0.1595744680851064
	Train acc at iteration 16: 0.10256410256410256
	Val acc at iteration 15: 0.2553191489361702
	Train acc at iteration 17: 0.1891025641025641
	Val acc at iteration 16: 0.14893617021276595
	Train acc at iteration 18: 0.20352564102564102
	Val acc at iteration 17: 0.13829787234042554
	Train acc at iteration 19: 0.18108974358974358
	Val acc at iteration 18: 0.18085106382978725
	Train acc at iteration 20: 0.20032051282051283
	Val acc at iteration 19: 0.18085106382978725
	Train acc at iteration 21: 0.22275641025641027
	Val acc at iteration 20: 0.19148936170212766
	Train acc at iteration 22: 0.20993589743589744
	Val acc at iteration 21: 0.23404255319148937
	Train acc at iteration 23: 0.23557692307692307
	Val acc at iteration 22: 0.11702127659574468
	Train acc at iteration 24: 0.21153846153846154
	Val acc at iteration 23: 0.26595744680851063
	Train acc at iteration 25: 0.1842948717948718
	Val acc at iteration 24: 0.2553191489361702
	Train acc at iteration 26: 0.26282051282051283
	Val acc at iteration 25: 0.22340425531914893
	Train acc at iteration 27: 0.21794871794871795
	Val acc at iteration 26: 0.24468085106382978
	Train acc at iteration 28: 0.23557692307692307
	Val acc at iteration 27: 0.20212765957446807
	Train acc at iteration 29: 0.2948717948717949
	Val acc at iteration 28: 0.24468085106382978
	Train acc at iteration 30: 0.27884615384615385
	Val acc at iteration 29: 0.2765957446808511
	Train acc at iteration 31: 0.28365384615384615
	Val acc at iteration 30: 0.2553191489361702
	Train acc at iteration 32: 0.28044871794871795
	Val acc at iteration 31: 0.2872340425531915
	Train acc at iteration 33: 0.34775641025641024
	Val acc at iteration 32: 0.425531914893617
	Train acc at iteration 34: 0.33814102564102566
	Val acc at iteration 33: 0.19148936170212766
	Train acc at iteration 35: 0.2564102564102564
	Val acc at iteration 34: 0.13829787234042554
	Train acc at iteration 36: 0.3685897435897436
	Val acc at iteration 35: 0.2765957446808511
	Train acc at iteration 37: 0.4230769230769231
	Val acc at iteration 36: 0.4148936170212766
	Train acc at iteration 38: 0.3701923076923077
	Val acc at iteration 37: 0.43617021276595747
	Train acc at iteration 39: 0.42467948717948717
	Val acc at iteration 38: 0.40425531914893614
	Train acc at iteration 40: 0.3926282051282051
	Val acc at iteration 39: 0.2127659574468085
	Train acc at iteration 41: 0.3685897435897436
	Val acc at iteration 40: 0.24468085106382978
	Train acc at iteration 42: 0.40064102564102566
	Val acc at iteration 41: 0.2872340425531915
	Train acc at iteration 43: 0.5144230769230769
	Val acc at iteration 42: 0.5212765957446809
	Train acc at iteration 44: 0.5224358974358975
	Val acc at iteration 43: 0.5106382978723404
	Train acc at iteration 45: 0.5464743589743589
	Val acc at iteration 44: 0.4787234042553192
	Train acc at iteration 46: 0.5144230769230769
	Val acc at iteration 45: 0.5531914893617021
	Train acc at iteration 47: 0.532051282051282
	Val acc at iteration 46: 0.5531914893617021
	Train acc at iteration 48: 0.5961538461538461
	Val acc at iteration 47: 0.5
	Train acc at iteration 49: 0.5464743589743589
	Val acc at iteration 48: 0.44680851063829785
	Train acc at iteration 50: 0.5817307692307693
	Val acc at iteration 49: 0.5531914893617021
	Train acc at iteration 51: 0.5641025641025641
	Val acc at iteration 50: 0.44680851063829785
	Train acc at iteration 52: 0.5625
	Val acc at iteration 51: 0.5425531914893617
	Train acc at iteration 53: 0.6105769230769231
	Val acc at iteration 52: 0.48936170212765956
	Train acc at iteration 54: 0.5913461538461539
	Val acc at iteration 53: 0.5425531914893617
	Train acc at iteration 55: 0.5961538461538461
	Val acc at iteration 54: 0.5531914893617021
	Train acc at iteration 56: 0.6057692307692307
	Val acc at iteration 55: 0.6063829787234043
	Train acc at iteration 57: 0.657051282051282
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.625
	Val acc at iteration 57: 0.5
	Train acc at iteration 59: 0.657051282051282
	Val acc at iteration 58: 0.5638297872340425
	Train acc at iteration 60: 0.6666666666666666
	Val acc at iteration 59: 0.5531914893617021
	Train acc at iteration 61: 0.5977564102564102
	Val acc at iteration 60: 0.5851063829787234
	Train acc at iteration 62: 0.6826923076923077
	Val acc at iteration 61: 0.6702127659574468
	Train acc at iteration 63: 0.6602564102564102
	Val acc at iteration 62: 0.6808510638297872
	Train acc at iteration 64: 0.6714743589743589
	Val acc at iteration 63: 0.6170212765957447
	Train acc at iteration 65: 0.7083333333333334
	Val acc at iteration 64: 0.6170212765957447
	Train acc at iteration 66: 0.7003205128205128
	Val acc at iteration 65: 0.5106382978723404
	Train acc at iteration 67: 0.6666666666666666
	Val acc at iteration 66: 0.7021276595744681
	Train acc at iteration 68: 0.6987179487179487
	Val acc at iteration 67: 0.7553191489361702
	Train acc at iteration 69: 0.7035256410256411
	Val acc at iteration 68: 0.6595744680851063
	Train acc at iteration 70: 0.6602564102564102
	Val acc at iteration 69: 0.6063829787234043
	Train acc at iteration 71: 0.6987179487179487
	Val acc at iteration 70: 0.6382978723404256
	Train acc at iteration 72: 0.657051282051282
	Val acc at iteration 71: 0.6063829787234043
	Train acc at iteration 73: 0.6858974358974359
	Val acc at iteration 72: 0.6276595744680851
	Train acc at iteration 74: 0.6442307692307693
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.7003205128205128
	Val acc at iteration 74: 0.6595744680851063
	Train acc at iteration 76: 0.6955128205128205
	Val acc at iteration 75: 0.5957446808510638
	Train acc at iteration 77: 0.7307692307692307
	Val acc at iteration 76: 0.6276595744680851
	Train acc at iteration 78: 0.6794871794871795
	Val acc at iteration 77: 0.6170212765957447
	Train acc at iteration 79: 0.6971153846153846
	Val acc at iteration 78: 0.6702127659574468
	Train acc at iteration 80: 0.7051282051282052
	Val acc at iteration 79: 0.6382978723404256
	Train acc at iteration 81: 0.6891025641025641
	Val acc at iteration 80: 0.6382978723404256
	Train acc at iteration 82: 0.7035256410256411
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7083333333333334
	Val acc at iteration 82: 0.648936170212766
	Train acc at iteration 84: 0.6826923076923077
	Val acc at iteration 83: 0.5851063829787234
	Train acc at iteration 85: 0.6506410256410257
	Val acc at iteration 84: 0.6914893617021277
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.563859649122807
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.5293831168831168
Final test micro accuracy: 0.6276595744680851
Final validation:
	Cluster: 0.6238242983818054
	Separation: 0.5438736081123352
Final test:
	Cluster: 0.6035920977592468
	Separation: 0.5341092348098755
Saved Results

Attempting combination 21/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7836538461538461
	Train Cluster: 0.6523183107376098
	Train Separation: 0.5249985337257386
(Directly after push) Val acc at iteration 0: 0.6170212765957447
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6382978723404256
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.5957446808510638
	Val acc at iteration 3: 0.5851063829787234
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.6808510638297872
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.7127659574468085
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.574468085106383
	Val acc at iteration 20: 0.648936170212766
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6170212765957447
	Val acc at iteration 28: 0.7127659574468085
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.776595744680851
	Val acc at iteration 31: 0.6276595744680851
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.6914893617021277
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.574468085106383
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.6276595744680851
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.6808510638297872
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.723404255319149
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.574468085106383
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6170212765957447
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.6595744680851063
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.6276595744680851
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6702127659574468
Val acc before epoch 13: 0.6702127659574468
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7980769230769231
	Train Cluster: 0.6463259696960449
	Train Separation: 0.5202933073043823
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7659574468085106
	Val acc at iteration 6: 0.7659574468085106
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.7340425531914894
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.776595744680851
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.7446808510638298
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7553191489361702
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.776595744680851
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.7340425531914894
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.7659574468085106
	Val acc at iteration 44: 0.7659574468085106
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.7659574468085106
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.776595744680851
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.6914893617021277
	Val acc at iteration 55: 0.6382978723404256
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.7872340425531915
	Val acc at iteration 63: 0.8297872340425532
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.7127659574468085
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.7872340425531915
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7978723404255319
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 25: 0.6595744680851063
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8285256410256411
	Train Cluster: 0.6517214059829712
	TrainSeparation: 0.522906506061554
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.05
	Train acc at iteration 1: 0.32211538461538464
	Val acc at iteration 0: 0.3404255319148936
	Train acc at iteration 2: 0.1907051282051282
	Val acc at iteration 1: 0.24468085106382978
	Train acc at iteration 3: 0.22115384615384615
	Val acc at iteration 2: 0.22340425531914893
	Train acc at iteration 4: 0.20192307692307693
	Val acc at iteration 3: 0.3617021276595745
	Train acc at iteration 5: 0.2676282051282051
	Val acc at iteration 4: 0.22340425531914893
	Train acc at iteration 6: 0.14743589743589744
	Val acc at iteration 5: 0.10638297872340426
	Train acc at iteration 7: 0.13141025641025642
	Val acc at iteration 6: 0.24468085106382978
	Train acc at iteration 8: 0.20833333333333334
	Val acc at iteration 7: 0.32978723404255317
	Train acc at iteration 9: 0.1955128205128205
	Val acc at iteration 8: 0.30851063829787234
	Train acc at iteration 10: 0.27884615384615385
	Val acc at iteration 9: 0.24468085106382978
	Train acc at iteration 11: 0.27403846153846156
	Val acc at iteration 10: 0.39361702127659576
	Train acc at iteration 12: 0.3189102564102564
	Val acc at iteration 11: 0.32978723404255317
	Train acc at iteration 13: 0.23557692307692307
	Val acc at iteration 12: 0.24468085106382978
	Train acc at iteration 14: 0.2532051282051282
	Val acc at iteration 13: 0.4148936170212766
	Train acc at iteration 15: 0.3717948717948718
	Val acc at iteration 14: 0.3617021276595745
	Train acc at iteration 16: 0.38782051282051283
	Val acc at iteration 15: 0.48936170212765956
	Train acc at iteration 17: 0.40705128205128205
	Val acc at iteration 16: 0.43617021276595747
	Train acc at iteration 18: 0.4326923076923077
	Val acc at iteration 17: 0.4787234042553192
	Train acc at iteration 19: 0.33974358974358976
	Val acc at iteration 18: 0.4787234042553192
	Train acc at iteration 20: 0.391025641025641
	Val acc at iteration 19: 0.39361702127659576
	Train acc at iteration 21: 0.4358974358974359
	Val acc at iteration 20: 0.4787234042553192
	Train acc at iteration 22: 0.42948717948717946
	Val acc at iteration 21: 0.3829787234042553
	Train acc at iteration 23: 0.4326923076923077
	Val acc at iteration 22: 0.4574468085106383
	Train acc at iteration 24: 0.4342948717948718
	Val acc at iteration 23: 0.39361702127659576
	Train acc at iteration 25: 0.5096153846153846
	Val acc at iteration 24: 0.4148936170212766
	Train acc at iteration 26: 0.44871794871794873
	Val acc at iteration 25: 0.574468085106383
	Train acc at iteration 27: 0.5224358974358975
	Val acc at iteration 26: 0.46808510638297873
	Train acc at iteration 28: 0.5336538461538461
	Val acc at iteration 27: 0.5212765957446809
	Train acc at iteration 29: 0.47275641025641024
	Val acc at iteration 28: 0.46808510638297873
	Train acc at iteration 30: 0.4807692307692308
	Val acc at iteration 29: 0.5106382978723404
	Train acc at iteration 31: 0.5208333333333334
	Val acc at iteration 30: 0.3829787234042553
	Train acc at iteration 32: 0.5192307692307693
	Val acc at iteration 31: 0.5531914893617021
	Train acc at iteration 33: 0.5496794871794872
	Val acc at iteration 32: 0.5531914893617021
	Train acc at iteration 34: 0.5641025641025641
	Val acc at iteration 33: 0.48936170212765956
	Train acc at iteration 35: 0.5480769230769231
	Val acc at iteration 34: 0.5
	Train acc at iteration 36: 0.5865384615384616
	Val acc at iteration 35: 0.5957446808510638
	Train acc at iteration 37: 0.5657051282051282
	Val acc at iteration 36: 0.5851063829787234
	Train acc at iteration 38: 0.5817307692307693
	Val acc at iteration 37: 0.5319148936170213
	Train acc at iteration 39: 0.5705128205128205
	Val acc at iteration 38: 0.48936170212765956
	Train acc at iteration 40: 0.6169871794871795
	Val acc at iteration 39: 0.5212765957446809
	Train acc at iteration 41: 0.5817307692307693
	Val acc at iteration 40: 0.5319148936170213
	Train acc at iteration 42: 0.6089743589743589
	Val acc at iteration 41: 0.5425531914893617
	Train acc at iteration 43: 0.6217948717948718
	Val acc at iteration 42: 0.6276595744680851
	Train acc at iteration 44: 0.592948717948718
	Val acc at iteration 43: 0.5531914893617021
	Train acc at iteration 45: 0.6426282051282052
	Val acc at iteration 44: 0.6063829787234043
	Train acc at iteration 46: 0.6057692307692307
	Val acc at iteration 45: 0.5319148936170213
	Train acc at iteration 47: 0.6298076923076923
	Val acc at iteration 46: 0.5425531914893617
	Train acc at iteration 48: 0.5737179487179487
	Val acc at iteration 47: 0.5851063829787234
	Train acc at iteration 49: 0.6346153846153846
	Val acc at iteration 48: 0.6170212765957447
	Train acc at iteration 50: 0.6201923076923077
	Val acc at iteration 49: 0.6382978723404256
	Train acc at iteration 51: 0.6169871794871795
	Val acc at iteration 50: 0.5425531914893617
	Train acc at iteration 52: 0.6282051282051282
	Val acc at iteration 51: 0.5531914893617021
	Train acc at iteration 53: 0.6266025641025641
	Val acc at iteration 52: 0.6382978723404256
	Train acc at iteration 54: 0.6185897435897436
	Val acc at iteration 53: 0.5638297872340425
	Train acc at iteration 55: 0.6538461538461539
	Val acc at iteration 54: 0.6063829787234043
	Train acc at iteration 56: 0.6314102564102564
	Val acc at iteration 55: 0.5957446808510638
	Train acc at iteration 57: 0.6426282051282052
	Val acc at iteration 56: 0.6276595744680851
	Train acc at iteration 58: 0.6474358974358975
	Val acc at iteration 57: 0.6063829787234043
	Train acc at iteration 59: 0.6842948717948718
	Val acc at iteration 58: 0.5957446808510638
	Train acc at iteration 60: 0.6698717948717948
	Val acc at iteration 59: 0.6276595744680851
	Train acc at iteration 61: 0.7083333333333334
	Val acc at iteration 60: 0.5638297872340425
	Train acc at iteration 62: 0.655448717948718
	Val acc at iteration 61: 0.5957446808510638
	Train acc at iteration 63: 0.6891025641025641
	Val acc at iteration 62: 0.6063829787234043
	Train acc at iteration 64: 0.657051282051282
	Val acc at iteration 63: 0.6170212765957447
	Train acc at iteration 65: 0.6939102564102564
	Val acc at iteration 64: 0.5638297872340425
	Train acc at iteration 66: 0.655448717948718
	Val acc at iteration 65: 0.6063829787234043
	Train acc at iteration 67: 0.6698717948717948
	Val acc at iteration 66: 0.6382978723404256
	Train acc at iteration 68: 0.655448717948718
	Val acc at iteration 67: 0.574468085106383
	Train acc at iteration 69: 0.6778846153846154
	Val acc at iteration 68: 0.6595744680851063
	Train acc at iteration 70: 0.6778846153846154
	Val acc at iteration 69: 0.5957446808510638
	Train acc at iteration 71: 0.6682692307692307
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.6939102564102564
	Val acc at iteration 71: 0.6170212765957447
	Train acc at iteration 73: 0.6891025641025641
	Val acc at iteration 72: 0.6063829787234043
	Train acc at iteration 74: 0.6682692307692307
	Val acc at iteration 73: 0.5957446808510638
	Train acc at iteration 75: 0.6842948717948718
	Val acc at iteration 74: 0.6170212765957447
	Train acc at iteration 76: 0.6474358974358975
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.7035256410256411
	Val acc at iteration 76: 0.6063829787234043
	Train acc at iteration 78: 0.7051282051282052
	Val acc at iteration 77: 0.6382978723404256
	Train acc at iteration 79: 0.7019230769230769
	Val acc at iteration 78: 0.5531914893617021
	Train acc at iteration 80: 0.7051282051282052
	Val acc at iteration 79: 0.6808510638297872
	Train acc at iteration 81: 0.6907051282051282
	Val acc at iteration 80: 0.7340425531914894
	Train acc at iteration 82: 0.6907051282051282
	Val acc at iteration 81: 0.6276595744680851
	Train acc at iteration 83: 0.7051282051282052
	Val acc at iteration 82: 0.5638297872340425
	Train acc at iteration 84: 0.7019230769230769
	Val acc at iteration 83: 0.6595744680851063
	Train acc at iteration 85: 0.7003205128205128
	Val acc at iteration 84: 0.6702127659574468
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5156666666666666
Final val micro accuracy: 0.6382978723404256
Final test macro f1-score: 0.475925925925926
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.6187847554683685
	Separation: 0.5407200157642365
Final test:
	Cluster: 0.607677698135376
	Separation: 0.5422645807266235
Saved Results

Attempting combination 22/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.01
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.40425531914893614
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.782051282051282
	Train Cluster: 0.6446361422538758
	Train Separation: 0.5186932802200317
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.7021276595744681
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.7553191489361702
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.6276595744680851
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.6595744680851063
	Val acc at iteration 27: 0.6063829787234043
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.7340425531914894
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.8085106382978723
	Val acc at iteration 48: 0.6702127659574468
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.6063829787234043
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.7127659574468085
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.6808510638297872
	Val acc at iteration 68: 0.6063829787234043
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.7659574468085106
Val acc before epoch 13: 0.7446808510638298
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Train Cluster: 0.6511683940887452
	Train Separation: 0.5223077416419983
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7127659574468085
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.7659574468085106
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6276595744680851
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.7659574468085106
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.776595744680851
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.6808510638297872
	Val acc at iteration 27: 0.5851063829787234
	Val acc at iteration 28: 0.7659574468085106
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.7978723404255319
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.6276595744680851
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.7021276595744681
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7021276595744681
	Val acc at iteration 59: 0.7872340425531915
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.7446808510638298
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.7978723404255319
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 25: 0.7021276595744681
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8125
	Train Cluster: 0.6516828656196594
	TrainSeparation: 0.5150656580924988
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.01
	Train acc at iteration 1: 0.7051282051282052
	Val acc at iteration 0: 0.6808510638297872
	Train acc at iteration 2: 0.6458333333333334
	Val acc at iteration 1: 0.5957446808510638
	Train acc at iteration 3: 0.6346153846153846
	Val acc at iteration 2: 0.5425531914893617
	Train acc at iteration 4: 0.5977564102564102
	Val acc at iteration 3: 0.46808510638297873
	Train acc at iteration 5: 0.5352564102564102
	Val acc at iteration 4: 0.48936170212765956
	Train acc at iteration 6: 0.5368589743589743
	Val acc at iteration 5: 0.5531914893617021
	Train acc at iteration 7: 0.5913461538461539
	Val acc at iteration 6: 0.5319148936170213
	Train acc at iteration 8: 0.5833333333333334
	Val acc at iteration 7: 0.5
	Train acc at iteration 9: 0.5849358974358975
	Val acc at iteration 8: 0.5319148936170213
	Train acc at iteration 10: 0.5897435897435898
	Val acc at iteration 9: 0.5212765957446809
	Train acc at iteration 11: 0.6298076923076923
	Val acc at iteration 10: 0.6063829787234043
	Train acc at iteration 12: 0.5705128205128205
	Val acc at iteration 11: 0.5212765957446809
	Train acc at iteration 13: 0.5737179487179487
	Val acc at iteration 12: 0.5957446808510638
	Train acc at iteration 14: 0.6089743589743589
	Val acc at iteration 13: 0.5531914893617021
	Train acc at iteration 15: 0.6346153846153846
	Val acc at iteration 14: 0.5851063829787234
	Train acc at iteration 16: 0.5432692307692307
	Val acc at iteration 15: 0.5638297872340425
	Train acc at iteration 17: 0.625
	Val acc at iteration 16: 0.6808510638297872
	Train acc at iteration 18: 0.6682692307692307
	Val acc at iteration 17: 0.5106382978723404
	Train acc at iteration 19: 0.5977564102564102
	Val acc at iteration 18: 0.4574468085106383
	Train acc at iteration 20: 0.6282051282051282
	Val acc at iteration 19: 0.6063829787234043
	Train acc at iteration 21: 0.6105769230769231
	Val acc at iteration 20: 0.5851063829787234
	Train acc at iteration 22: 0.6650641025641025
	Val acc at iteration 21: 0.5425531914893617
	Train acc at iteration 23: 0.6121794871794872
	Val acc at iteration 22: 0.5851063829787234
	Train acc at iteration 24: 0.6410256410256411
	Val acc at iteration 23: 0.7127659574468085
	Train acc at iteration 25: 0.6634615384615384
	Val acc at iteration 24: 0.5531914893617021
	Train acc at iteration 26: 0.6618589743589743
	Val acc at iteration 25: 0.5851063829787234
	Train acc at iteration 27: 0.6330128205128205
	Val acc at iteration 26: 0.5425531914893617
	Train acc at iteration 28: 0.6666666666666666
	Val acc at iteration 27: 0.648936170212766
	Train acc at iteration 29: 0.657051282051282
	Val acc at iteration 28: 0.5851063829787234
	Train acc at iteration 30: 0.6634615384615384
	Val acc at iteration 29: 0.5425531914893617
	Train acc at iteration 31: 0.6730769230769231
	Val acc at iteration 30: 0.574468085106383
	Train acc at iteration 32: 0.6282051282051282
	Val acc at iteration 31: 0.6914893617021277
	Train acc at iteration 33: 0.6778846153846154
	Val acc at iteration 32: 0.6702127659574468
	Train acc at iteration 34: 0.6730769230769231
	Val acc at iteration 33: 0.5851063829787234
	Train acc at iteration 35: 0.6618589743589743
	Val acc at iteration 34: 0.6170212765957447
	Train acc at iteration 36: 0.6586538461538461
	Val acc at iteration 35: 0.5212765957446809
	Train acc at iteration 37: 0.6714743589743589
	Val acc at iteration 36: 0.5957446808510638
	Train acc at iteration 38: 0.7211538461538461
	Val acc at iteration 37: 0.6170212765957447
	Train acc at iteration 39: 0.6987179487179487
	Val acc at iteration 38: 0.574468085106383
	Train acc at iteration 40: 0.6858974358974359
	Val acc at iteration 39: 0.6063829787234043
	Train acc at iteration 41: 0.7051282051282052
	Val acc at iteration 40: 0.6170212765957447
	Train acc at iteration 42: 0.6794871794871795
	Val acc at iteration 41: 0.6382978723404256
	Train acc at iteration 43: 0.6891025641025641
	Val acc at iteration 42: 0.574468085106383
	Train acc at iteration 44: 0.6907051282051282
	Val acc at iteration 43: 0.6276595744680851
	Train acc at iteration 45: 0.6907051282051282
	Val acc at iteration 44: 0.6170212765957447
	Train acc at iteration 46: 0.6778846153846154
	Val acc at iteration 45: 0.6170212765957447
	Train acc at iteration 47: 0.6875
	Val acc at iteration 46: 0.7127659574468085
	Train acc at iteration 48: 0.7051282051282052
	Val acc at iteration 47: 0.7021276595744681
	Train acc at iteration 49: 0.6923076923076923
	Val acc at iteration 48: 0.6702127659574468
	Train acc at iteration 50: 0.7147435897435898
	Val acc at iteration 49: 0.6063829787234043
	Train acc at iteration 51: 0.6858974358974359
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.7051282051282052
	Val acc at iteration 51: 0.6595744680851063
	Train acc at iteration 53: 0.717948717948718
	Val acc at iteration 52: 0.6382978723404256
	Train acc at iteration 54: 0.7163461538461539
	Val acc at iteration 53: 0.723404255319149
	Train acc at iteration 55: 0.719551282051282
	Val acc at iteration 54: 0.6808510638297872
	Train acc at iteration 56: 0.7003205128205128
	Val acc at iteration 55: 0.7127659574468085
	Train acc at iteration 57: 0.7339743589743589
	Val acc at iteration 56: 0.6276595744680851
	Train acc at iteration 58: 0.7035256410256411
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.7211538461538461
	Val acc at iteration 58: 0.6170212765957447
	Train acc at iteration 60: 0.6875
	Val acc at iteration 59: 0.6702127659574468
	Train acc at iteration 61: 0.7243589743589743
	Val acc at iteration 60: 0.648936170212766
	Train acc at iteration 62: 0.75
	Val acc at iteration 61: 0.7127659574468085
	Train acc at iteration 63: 0.719551282051282
	Val acc at iteration 62: 0.7021276595744681
	Train acc at iteration 64: 0.7419871794871795
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.7243589743589743
	Val acc at iteration 64: 0.648936170212766
	Train acc at iteration 66: 0.7035256410256411
	Val acc at iteration 65: 0.648936170212766
	Train acc at iteration 67: 0.7387820512820513
	Val acc at iteration 66: 0.6276595744680851
	Train acc at iteration 68: 0.6955128205128205
	Val acc at iteration 67: 0.6914893617021277
	Train acc at iteration 69: 0.7483974358974359
	Val acc at iteration 68: 0.6595744680851063
	Train acc at iteration 70: 0.7355769230769231
	Val acc at iteration 69: 0.648936170212766
	Train acc at iteration 71: 0.7387820512820513
	Val acc at iteration 70: 0.6808510638297872
	Train acc at iteration 72: 0.7227564102564102
	Val acc at iteration 71: 0.6382978723404256
	Train acc at iteration 73: 0.7371794871794872
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.7163461538461539
	Val acc at iteration 73: 0.6276595744680851
	Train acc at iteration 75: 0.7451923076923077
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.7516025641025641
	Val acc at iteration 75: 0.6808510638297872
	Train acc at iteration 77: 0.7532051282051282
	Val acc at iteration 76: 0.6063829787234043
	Train acc at iteration 78: 0.7099358974358975
	Val acc at iteration 77: 0.6595744680851063
	Train acc at iteration 79: 0.7580128205128205
	Val acc at iteration 78: 0.6595744680851063
	Train acc at iteration 80: 0.7211538461538461
	Val acc at iteration 79: 0.6170212765957447
	Train acc at iteration 81: 0.7307692307692307
	Val acc at iteration 80: 0.6914893617021277
	Train acc at iteration 82: 0.7115384615384616
	Val acc at iteration 81: 0.6276595744680851
	Train acc at iteration 83: 0.7403846153846154
	Val acc at iteration 82: 0.6276595744680851
	Train acc at iteration 84: 0.7259615384615384
	Val acc at iteration 83: 0.7021276595744681
	Train acc at iteration 85: 0.7243589743589743
	Val acc at iteration 84: 0.6808510638297872
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.41262135922330095
Final val micro accuracy: 0.5425531914893617
Final test macro f1-score: 0.5659090909090909
Final test micro accuracy: 0.6702127659574468
Final validation:
	Cluster: 0.6093287765979767
	Separation: 0.5418775081634521
Final test:
	Cluster: 0.6143410801887512
	Separation: 0.5426658689975739
Saved Results

Attempting combination 23/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6063829787234043
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7340425531914894
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7932692307692307
	Train Cluster: 0.6508426904678345
	Train Separation: 0.5223793268203736
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5851063829787234
	Val acc at iteration 1: 0.5531914893617021
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.5851063829787234
	Val acc at iteration 4: 0.4787234042553192
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6170212765957447
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.5957446808510638
	Val acc at iteration 10: 0.5851063829787234
	Val acc at iteration 11: 0.7659574468085106
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.574468085106383
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.6063829787234043
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.6702127659574468
	Val acc at iteration 20: 0.6382978723404256
	Val acc at iteration 21: 0.5957446808510638
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.6170212765957447
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.723404255319149
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.6276595744680851
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.6382978723404256
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6063829787234043
	Val acc at iteration 60: 0.7021276595744681
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.6276595744680851
	Val acc at iteration 63: 0.6276595744680851
	Val acc at iteration 64: 0.6170212765957447
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.648936170212766
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.723404255319149
	Val acc at iteration 74: 0.6382978723404256
	Val acc at iteration 75: 0.6276595744680851
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.5957446808510638
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.648936170212766
Val acc before epoch 13: 0.6595744680851063
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.776595744680851
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.851063829787234
Push epoch
After push, before retraining last layer:
	Train acc: 0.8044871794871795
	Train Cluster: 0.6459459662437439
	Train Separation: 0.513845932483673
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.7446808510638298
	Val acc at iteration 5: 0.7659574468085106
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.7872340425531915
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.776595744680851
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.7553191489361702
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.7659574468085106
	Val acc at iteration 43: 0.7340425531914894
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.6382978723404256
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.6808510638297872
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7446808510638298
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.6702127659574468
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7553191489361702
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.6914893617021277
	Val acc at iteration 80: 0.723404255319149
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.6808510638297872
Val acc before epoch 25: 0.6702127659574468
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9042553191489362
Stopping after epoch 37.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.842948717948718
	Train Cluster: 0.6469770669937134
	TrainSeparation: 0.5202089071273803
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.005
	Train acc at iteration 1: 0.7708333333333334
	Val acc at iteration 0: 0.648936170212766
	Train acc at iteration 2: 0.7371794871794872
	Val acc at iteration 1: 0.7021276595744681
	Train acc at iteration 3: 0.7644230769230769
	Val acc at iteration 2: 0.6595744680851063
	Train acc at iteration 4: 0.6923076923076923
	Val acc at iteration 3: 0.6595744680851063
	Train acc at iteration 5: 0.7131410256410257
	Val acc at iteration 4: 0.6382978723404256
	Train acc at iteration 6: 0.7131410256410257
	Val acc at iteration 5: 0.6382978723404256
	Train acc at iteration 7: 0.6987179487179487
	Val acc at iteration 6: 0.648936170212766
	Train acc at iteration 8: 0.7115384615384616
	Val acc at iteration 7: 0.5851063829787234
	Train acc at iteration 9: 0.6586538461538461
	Val acc at iteration 8: 0.6276595744680851
	Train acc at iteration 10: 0.7403846153846154
	Val acc at iteration 9: 0.5319148936170213
	Train acc at iteration 11: 0.6987179487179487
	Val acc at iteration 10: 0.648936170212766
	Train acc at iteration 12: 0.7291666666666666
	Val acc at iteration 11: 0.5531914893617021
	Train acc at iteration 13: 0.6971153846153846
	Val acc at iteration 12: 0.5638297872340425
	Train acc at iteration 14: 0.7291666666666666
	Val acc at iteration 13: 0.648936170212766
	Train acc at iteration 15: 0.7259615384615384
	Val acc at iteration 14: 0.6063829787234043
	Train acc at iteration 16: 0.7147435897435898
	Val acc at iteration 15: 0.574468085106383
	Train acc at iteration 17: 0.6730769230769231
	Val acc at iteration 16: 0.5531914893617021
	Train acc at iteration 18: 0.6891025641025641
	Val acc at iteration 17: 0.6276595744680851
	Train acc at iteration 19: 0.7211538461538461
	Val acc at iteration 18: 0.5531914893617021
	Train acc at iteration 20: 0.7019230769230769
	Val acc at iteration 19: 0.648936170212766
	Train acc at iteration 21: 0.7243589743589743
	Val acc at iteration 20: 0.6702127659574468
	Train acc at iteration 22: 0.7275641025641025
	Val acc at iteration 21: 0.6063829787234043
	Train acc at iteration 23: 0.7051282051282052
	Val acc at iteration 22: 0.6914893617021277
	Train acc at iteration 24: 0.7147435897435898
	Val acc at iteration 23: 0.6382978723404256
	Train acc at iteration 25: 0.7355769230769231
	Val acc at iteration 24: 0.5957446808510638
	Train acc at iteration 26: 0.6971153846153846
	Val acc at iteration 25: 0.648936170212766
	Train acc at iteration 27: 0.7099358974358975
	Val acc at iteration 26: 0.6276595744680851
	Train acc at iteration 28: 0.7035256410256411
	Val acc at iteration 27: 0.6382978723404256
	Train acc at iteration 29: 0.7115384615384616
	Val acc at iteration 28: 0.5638297872340425
	Train acc at iteration 30: 0.717948717948718
	Val acc at iteration 29: 0.6382978723404256
	Train acc at iteration 31: 0.7243589743589743
	Val acc at iteration 30: 0.648936170212766
	Train acc at iteration 32: 0.7339743589743589
	Val acc at iteration 31: 0.6382978723404256
	Train acc at iteration 33: 0.7451923076923077
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.7355769230769231
	Val acc at iteration 33: 0.6595744680851063
	Train acc at iteration 35: 0.7131410256410257
	Val acc at iteration 34: 0.5212765957446809
	Train acc at iteration 36: 0.7323717948717948
	Val acc at iteration 35: 0.6808510638297872
	Train acc at iteration 37: 0.6794871794871795
	Val acc at iteration 36: 0.7127659574468085
	Train acc at iteration 38: 0.7051282051282052
	Val acc at iteration 37: 0.5957446808510638
	Train acc at iteration 39: 0.7307692307692307
	Val acc at iteration 38: 0.6382978723404256
	Train acc at iteration 40: 0.7099358974358975
	Val acc at iteration 39: 0.6276595744680851
	Train acc at iteration 41: 0.719551282051282
	Val acc at iteration 40: 0.6595744680851063
	Train acc at iteration 42: 0.7387820512820513
	Val acc at iteration 41: 0.6382978723404256
	Train acc at iteration 43: 0.7051282051282052
	Val acc at iteration 42: 0.6382978723404256
	Train acc at iteration 44: 0.7419871794871795
	Val acc at iteration 43: 0.648936170212766
	Train acc at iteration 45: 0.717948717948718
	Val acc at iteration 44: 0.6170212765957447
	Train acc at iteration 46: 0.7371794871794872
	Val acc at iteration 45: 0.6276595744680851
	Train acc at iteration 47: 0.7275641025641025
	Val acc at iteration 46: 0.648936170212766
	Train acc at iteration 48: 0.7483974358974359
	Val acc at iteration 47: 0.6595744680851063
	Train acc at iteration 49: 0.7051282051282052
	Val acc at iteration 48: 0.6382978723404256
	Train acc at iteration 50: 0.7387820512820513
	Val acc at iteration 49: 0.6063829787234043
	Train acc at iteration 51: 0.7083333333333334
	Val acc at iteration 50: 0.6063829787234043
	Train acc at iteration 52: 0.7243589743589743
	Val acc at iteration 51: 0.648936170212766
	Train acc at iteration 53: 0.7387820512820513
	Val acc at iteration 52: 0.6063829787234043
	Train acc at iteration 54: 0.7323717948717948
	Val acc at iteration 53: 0.6170212765957447
	Train acc at iteration 55: 0.7275641025641025
	Val acc at iteration 54: 0.5638297872340425
	Train acc at iteration 56: 0.719551282051282
	Val acc at iteration 55: 0.6276595744680851
	Train acc at iteration 57: 0.7307692307692307
	Val acc at iteration 56: 0.5425531914893617
	Train acc at iteration 58: 0.7467948717948718
	Val acc at iteration 57: 0.6170212765957447
	Train acc at iteration 59: 0.7099358974358975
	Val acc at iteration 58: 0.6170212765957447
	Train acc at iteration 60: 0.7307692307692307
	Val acc at iteration 59: 0.5851063829787234
	Train acc at iteration 61: 0.7628205128205128
	Val acc at iteration 60: 0.6276595744680851
	Train acc at iteration 62: 0.75
	Val acc at iteration 61: 0.7021276595744681
	Train acc at iteration 63: 0.7275641025641025
	Val acc at iteration 62: 0.6063829787234043
	Train acc at iteration 64: 0.7596153846153846
	Val acc at iteration 63: 0.6276595744680851
	Train acc at iteration 65: 0.7211538461538461
	Val acc at iteration 64: 0.5957446808510638
	Train acc at iteration 66: 0.7323717948717948
	Val acc at iteration 65: 0.6170212765957447
	Train acc at iteration 67: 0.7291666666666666
	Val acc at iteration 66: 0.648936170212766
	Train acc at iteration 68: 0.7259615384615384
	Val acc at iteration 67: 0.6276595744680851
	Train acc at iteration 69: 0.7259615384615384
	Val acc at iteration 68: 0.5851063829787234
	Train acc at iteration 70: 0.7163461538461539
	Val acc at iteration 69: 0.5531914893617021
	Train acc at iteration 71: 0.7548076923076923
	Val acc at iteration 70: 0.6702127659574468
	Train acc at iteration 72: 0.7532051282051282
	Val acc at iteration 71: 0.648936170212766
	Train acc at iteration 73: 0.75
	Val acc at iteration 72: 0.7021276595744681
	Train acc at iteration 74: 0.7467948717948718
	Val acc at iteration 73: 0.6170212765957447
	Train acc at iteration 75: 0.7403846153846154
	Val acc at iteration 74: 0.648936170212766
	Train acc at iteration 76: 0.7467948717948718
	Val acc at iteration 75: 0.7340425531914894
	Train acc at iteration 77: 0.7211538461538461
	Val acc at iteration 76: 0.6170212765957447
	Train acc at iteration 78: 0.7483974358974359
	Val acc at iteration 77: 0.6808510638297872
	Train acc at iteration 79: 0.7339743589743589
	Val acc at iteration 78: 0.5851063829787234
	Train acc at iteration 80: 0.7243589743589743
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.7403846153846154
	Val acc at iteration 80: 0.7021276595744681
	Train acc at iteration 82: 0.7676282051282052
	Val acc at iteration 81: 0.6702127659574468
	Train acc at iteration 83: 0.7419871794871795
	Val acc at iteration 82: 0.5851063829787234
	Train acc at iteration 84: 0.7307692307692307
	Val acc at iteration 83: 0.5851063829787234
	Train acc at iteration 85: 0.7516025641025641
	Val acc at iteration 84: 0.6382978723404256
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.4883333333333333
Final val micro accuracy: 0.5957446808510638
Final test macro f1-score: 0.4627659574468085
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6140527129173279
	Separation: 0.5423928499221802
Final test:
	Cluster: 0.5990782380104065
	Separation: 0.5367250740528107
Saved Results

Attempting combination 24/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.425531914893617
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5957446808510638
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7516025641025641
	Train Cluster: 0.6469407916069031
	Train Separation: 0.5232365965843201
(Directly after push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.5531914893617021
	Val acc at iteration 4: 0.6170212765957447
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.5851063829787234
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.5957446808510638
	Val acc at iteration 10: 0.5957446808510638
	Val acc at iteration 11: 0.5957446808510638
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.5851063829787234
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.5851063829787234
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.574468085106383
	Val acc at iteration 20: 0.6170212765957447
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.6382978723404256
	Val acc at iteration 23: 0.7021276595744681
	Val acc at iteration 24: 0.6170212765957447
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.5851063829787234
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.7446808510638298
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.6063829787234043
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.5957446808510638
	Val acc at iteration 40: 0.6170212765957447
	Val acc at iteration 41: 0.574468085106383
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.5851063829787234
	Val acc at iteration 49: 0.6063829787234043
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.5531914893617021
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6063829787234043
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.5957446808510638
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.5957446808510638
	Val acc at iteration 62: 0.5851063829787234
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6170212765957447
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.7553191489361702
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.6276595744680851
	Val acc at iteration 73: 0.6170212765957447
	Val acc at iteration 74: 0.6382978723404256
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.6808510638297872
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.6382978723404256
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.6702127659574468
Val acc before epoch 13: 0.6595744680851063
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.7978723404255319
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Train Cluster: 0.6454450130462647
	Train Separation: 0.5161027550697327
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.6914893617021277
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.7021276595744681
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.7872340425531915
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.7659574468085106
	Val acc at iteration 11: 0.7127659574468085
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.574468085106383
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.7340425531914894
	Val acc at iteration 26: 0.6276595744680851
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.6170212765957447
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.6382978723404256
	Val acc at iteration 39: 0.6170212765957447
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6595744680851063
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.7659574468085106
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.776595744680851
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.5957446808510638
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.6170212765957447
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.776595744680851
	Val acc at iteration 73: 0.6063829787234043
	Val acc at iteration 74: 0.6382978723404256
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.7021276595744681
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6382978723404256
Val acc before epoch 25: 0.6808510638297872
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.8829787234042553
Stopping after epoch 37.
Final validation accuracy before push: 88.29787234042553%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8173076923076923
	Train Cluster: 0.6603154540061951
	TrainSeparation: 0.5263566613197327
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.001
	Train acc at iteration 1: 0.8060897435897436
	Val acc at iteration 0: 0.6914893617021277
	Train acc at iteration 2: 0.7676282051282052
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.7836538461538461
	Val acc at iteration 2: 0.7340425531914894
	Train acc at iteration 4: 0.7836538461538461
	Val acc at iteration 3: 0.6702127659574468
	Train acc at iteration 5: 0.7980769230769231
	Val acc at iteration 4: 0.7127659574468085
	Train acc at iteration 6: 0.8060897435897436
	Val acc at iteration 5: 0.7127659574468085
	Train acc at iteration 7: 0.7964743589743589
	Val acc at iteration 6: 0.6170212765957447
	Train acc at iteration 8: 0.7900641025641025
	Val acc at iteration 7: 0.7446808510638298
	Train acc at iteration 9: 0.8108974358974359
	Val acc at iteration 8: 0.6808510638297872
	Train acc at iteration 10: 0.8044871794871795
	Val acc at iteration 9: 0.7659574468085106
	Train acc at iteration 11: 0.7948717948717948
	Val acc at iteration 10: 0.6914893617021277
	Train acc at iteration 12: 0.780448717948718
	Val acc at iteration 11: 0.7553191489361702
	Train acc at iteration 13: 0.7868589743589743
	Val acc at iteration 12: 0.6702127659574468
	Train acc at iteration 14: 0.7724358974358975
	Val acc at iteration 13: 0.7127659574468085
	Train acc at iteration 15: 0.7852564102564102
	Val acc at iteration 14: 0.723404255319149
	Train acc at iteration 16: 0.7980769230769231
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.7852564102564102
	Val acc at iteration 16: 0.7127659574468085
	Train acc at iteration 18: 0.8141025641025641
	Val acc at iteration 17: 0.6808510638297872
	Train acc at iteration 19: 0.780448717948718
	Val acc at iteration 18: 0.7127659574468085
	Train acc at iteration 20: 0.7996794871794872
	Val acc at iteration 19: 0.6702127659574468
	Train acc at iteration 21: 0.7916666666666666
	Val acc at iteration 20: 0.7021276595744681
	Train acc at iteration 22: 0.8028846153846154
	Val acc at iteration 21: 0.6808510638297872
	Train acc at iteration 23: 0.8028846153846154
	Val acc at iteration 22: 0.7021276595744681
	Train acc at iteration 24: 0.7932692307692307
	Val acc at iteration 23: 0.7127659574468085
	Train acc at iteration 25: 0.8060897435897436
	Val acc at iteration 24: 0.6914893617021277
	Train acc at iteration 26: 0.8012820512820513
	Val acc at iteration 25: 0.6595744680851063
	Train acc at iteration 27: 0.7980769230769231
	Val acc at iteration 26: 0.6702127659574468
	Train acc at iteration 28: 0.7724358974358975
	Val acc at iteration 27: 0.7127659574468085
	Train acc at iteration 29: 0.782051282051282
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.7852564102564102
	Val acc at iteration 29: 0.6702127659574468
	Train acc at iteration 31: 0.7772435897435898
	Val acc at iteration 30: 0.7127659574468085
	Train acc at iteration 32: 0.7724358974358975
	Val acc at iteration 31: 0.6170212765957447
	Train acc at iteration 33: 0.7724358974358975
	Val acc at iteration 32: 0.648936170212766
	Train acc at iteration 34: 0.7724358974358975
	Val acc at iteration 33: 0.6063829787234043
	Train acc at iteration 35: 0.782051282051282
	Val acc at iteration 34: 0.5957446808510638
	Train acc at iteration 36: 0.7596153846153846
	Val acc at iteration 35: 0.7446808510638298
	Train acc at iteration 37: 0.7516025641025641
	Val acc at iteration 36: 0.648936170212766
	Train acc at iteration 38: 0.7756410256410257
	Val acc at iteration 37: 0.723404255319149
	Train acc at iteration 39: 0.7964743589743589
	Val acc at iteration 38: 0.574468085106383
	Train acc at iteration 40: 0.7516025641025641
	Val acc at iteration 39: 0.7127659574468085
	Train acc at iteration 41: 0.7580128205128205
	Val acc at iteration 40: 0.6276595744680851
	Train acc at iteration 42: 0.7852564102564102
	Val acc at iteration 41: 0.5957446808510638
	Train acc at iteration 43: 0.7644230769230769
	Val acc at iteration 42: 0.6808510638297872
	Train acc at iteration 44: 0.7676282051282052
	Val acc at iteration 43: 0.5957446808510638
	Train acc at iteration 45: 0.7836538461538461
	Val acc at iteration 44: 0.6702127659574468
	Train acc at iteration 46: 0.75
	Val acc at iteration 45: 0.723404255319149
	Train acc at iteration 47: 0.7692307692307693
	Val acc at iteration 46: 0.5957446808510638
	Train acc at iteration 48: 0.7756410256410257
	Val acc at iteration 47: 0.6702127659574468
	Train acc at iteration 49: 0.7644230769230769
	Val acc at iteration 48: 0.648936170212766
	Train acc at iteration 50: 0.7403846153846154
	Val acc at iteration 49: 0.7127659574468085
	Train acc at iteration 51: 0.7371794871794872
	Val acc at iteration 50: 0.648936170212766
	Train acc at iteration 52: 0.7275641025641025
	Val acc at iteration 51: 0.6063829787234043
	Train acc at iteration 53: 0.7435897435897436
	Val acc at iteration 52: 0.7127659574468085
	Train acc at iteration 54: 0.75
	Val acc at iteration 53: 0.6170212765957447
	Train acc at iteration 55: 0.7724358974358975
	Val acc at iteration 54: 0.7021276595744681
	Train acc at iteration 56: 0.7467948717948718
	Val acc at iteration 55: 0.6595744680851063
	Train acc at iteration 57: 0.719551282051282
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.7852564102564102
	Val acc at iteration 57: 0.574468085106383
	Train acc at iteration 59: 0.7948717948717948
	Val acc at iteration 58: 0.6276595744680851
	Train acc at iteration 60: 0.7580128205128205
	Val acc at iteration 59: 0.6808510638297872
	Train acc at iteration 61: 0.7836538461538461
	Val acc at iteration 60: 0.6595744680851063
	Train acc at iteration 62: 0.7772435897435898
	Val acc at iteration 61: 0.6063829787234043
	Train acc at iteration 63: 0.7532051282051282
	Val acc at iteration 62: 0.6170212765957447
	Train acc at iteration 64: 0.7355769230769231
	Val acc at iteration 63: 0.6063829787234043
	Train acc at iteration 65: 0.7772435897435898
	Val acc at iteration 64: 0.5851063829787234
	Train acc at iteration 66: 0.7628205128205128
	Val acc at iteration 65: 0.648936170212766
	Train acc at iteration 67: 0.7564102564102564
	Val acc at iteration 66: 0.6276595744680851
	Train acc at iteration 68: 0.7932692307692307
	Val acc at iteration 67: 0.5638297872340425
	Train acc at iteration 69: 0.7788461538461539
	Val acc at iteration 68: 0.6914893617021277
	Train acc at iteration 70: 0.7596153846153846
	Val acc at iteration 69: 0.6063829787234043
	Train acc at iteration 71: 0.7467948717948718
	Val acc at iteration 70: 0.6276595744680851
	Train acc at iteration 72: 0.7355769230769231
	Val acc at iteration 71: 0.6063829787234043
	Train acc at iteration 73: 0.7451923076923077
	Val acc at iteration 72: 0.648936170212766
	Train acc at iteration 74: 0.7724358974358975
	Val acc at iteration 73: 0.6382978723404256
	Train acc at iteration 75: 0.7676282051282052
	Val acc at iteration 74: 0.5531914893617021
	Train acc at iteration 76: 0.7740384615384616
	Val acc at iteration 75: 0.6702127659574468
	Train acc at iteration 77: 0.7676282051282052
	Val acc at iteration 76: 0.648936170212766
	Train acc at iteration 78: 0.7740384615384616
	Val acc at iteration 77: 0.5851063829787234
	Train acc at iteration 79: 0.7564102564102564
	Val acc at iteration 78: 0.6170212765957447
	Train acc at iteration 80: 0.7676282051282052
	Val acc at iteration 79: 0.5638297872340425
	Train acc at iteration 81: 0.7660256410256411
	Val acc at iteration 80: 0.723404255319149
	Train acc at iteration 82: 0.7692307692307693
	Val acc at iteration 81: 0.6063829787234043
	Train acc at iteration 83: 0.7708333333333334
	Val acc at iteration 82: 0.5851063829787234
	Train acc at iteration 84: 0.7548076923076923
	Val acc at iteration 83: 0.7021276595744681
	Train acc at iteration 85: 0.7628205128205128
	Val acc at iteration 84: 0.648936170212766
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.503960396039604
Final val micro accuracy: 0.6276595744680851
Final test macro f1-score: 0.43820224719101125
Final test micro accuracy: 0.5425531914893617
Final validation:
	Cluster: 0.6170261800289154
	Separation: 0.5427972674369812
Final test:
	Cluster: 0.5969993472099304
	Separation: 0.542831689119339
Saved Results

Attempting combination 25/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.3829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7548076923076923
	Train Cluster: 0.6473565578460694
	Train Separation: 0.5222296595573426
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.5531914893617021
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.6063829787234043
	Val acc at iteration 5: 0.574468085106383
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.6170212765957447
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.5851063829787234
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.5957446808510638
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.5957446808510638
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.648936170212766
	Val acc at iteration 25: 0.6382978723404256
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.5957446808510638
	Val acc at iteration 46: 0.8191489361702128
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.6276595744680851
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.6702127659574468
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.5957446808510638
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.6382978723404256
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.6276595744680851
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.7021276595744681
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.6382978723404256
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.723404255319149
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 13: 0.6382978723404256
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Train Cluster: 0.6529807567596435
	Train Separation: 0.5233651876449585
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.7127659574468085
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.5957446808510638
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6276595744680851
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.6170212765957447
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.574468085106383
	Val acc at iteration 21: 0.6914893617021277
	Val acc at iteration 22: 0.6276595744680851
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.6170212765957447
	Val acc at iteration 29: 0.6063829787234043
	Val acc at iteration 30: 0.5851063829787234
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.6276595744680851
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.6276595744680851
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.6382978723404256
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6276595744680851
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.6276595744680851
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.648936170212766
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.6914893617021277
	Val acc at iteration 69: 0.6063829787234043
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.6276595744680851
	Val acc at iteration 73: 0.6063829787234043
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.6595744680851063
	Val acc at iteration 79: 0.6382978723404256
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 25: 0.7340425531914894
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9680851063829787
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.6586894035339356
	TrainSeparation: 0.5230700373649597
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.0005
	Train acc at iteration 1: 0.8157051282051282
	Val acc at iteration 0: 0.7553191489361702
	Train acc at iteration 2: 0.8076923076923077
	Val acc at iteration 1: 0.6170212765957447
	Train acc at iteration 3: 0.7772435897435898
	Val acc at iteration 2: 0.7553191489361702
	Train acc at iteration 4: 0.8060897435897436
	Val acc at iteration 3: 0.6914893617021277
	Train acc at iteration 5: 0.8076923076923077
	Val acc at iteration 4: 0.6808510638297872
	Train acc at iteration 6: 0.8012820512820513
	Val acc at iteration 5: 0.6914893617021277
	Train acc at iteration 7: 0.8285256410256411
	Val acc at iteration 6: 0.6276595744680851
	Train acc at iteration 8: 0.7932692307692307
	Val acc at iteration 7: 0.6808510638297872
	Train acc at iteration 9: 0.8301282051282052
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8108974358974359
	Val acc at iteration 9: 0.723404255319149
	Train acc at iteration 11: 0.7884615384615384
	Val acc at iteration 10: 0.6702127659574468
	Train acc at iteration 12: 0.8269230769230769
	Val acc at iteration 11: 0.6595744680851063
	Train acc at iteration 13: 0.7612179487179487
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.8108974358974359
	Val acc at iteration 13: 0.7021276595744681
	Train acc at iteration 15: 0.7980769230769231
	Val acc at iteration 14: 0.6702127659574468
	Train acc at iteration 16: 0.8301282051282052
	Val acc at iteration 15: 0.7340425531914894
	Train acc at iteration 17: 0.7996794871794872
	Val acc at iteration 16: 0.6914893617021277
	Train acc at iteration 18: 0.7884615384615384
	Val acc at iteration 17: 0.7127659574468085
	Train acc at iteration 19: 0.7852564102564102
	Val acc at iteration 18: 0.6702127659574468
	Train acc at iteration 20: 0.8044871794871795
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.8092948717948718
	Val acc at iteration 20: 0.723404255319149
	Train acc at iteration 22: 0.8317307692307693
	Val acc at iteration 21: 0.7127659574468085
	Train acc at iteration 23: 0.8012820512820513
	Val acc at iteration 22: 0.6702127659574468
	Train acc at iteration 24: 0.8157051282051282
	Val acc at iteration 23: 0.7446808510638298
	Train acc at iteration 25: 0.7964743589743589
	Val acc at iteration 24: 0.6914893617021277
	Train acc at iteration 26: 0.8141025641025641
	Val acc at iteration 25: 0.6914893617021277
	Train acc at iteration 27: 0.7852564102564102
	Val acc at iteration 26: 0.7021276595744681
	Train acc at iteration 28: 0.8221153846153846
	Val acc at iteration 27: 0.6914893617021277
	Train acc at iteration 29: 0.8060897435897436
	Val acc at iteration 28: 0.7659574468085106
	Train acc at iteration 30: 0.8012820512820513
	Val acc at iteration 29: 0.6914893617021277
	Train acc at iteration 31: 0.7996794871794872
	Val acc at iteration 30: 0.776595744680851
	Train acc at iteration 32: 0.8125
	Val acc at iteration 31: 0.7127659574468085
	Train acc at iteration 33: 0.8108974358974359
	Val acc at iteration 32: 0.7446808510638298
	Train acc at iteration 34: 0.8157051282051282
	Val acc at iteration 33: 0.6170212765957447
	Train acc at iteration 35: 0.7852564102564102
	Val acc at iteration 34: 0.723404255319149
	Train acc at iteration 36: 0.8012820512820513
	Val acc at iteration 35: 0.6914893617021277
	Train acc at iteration 37: 0.780448717948718
	Val acc at iteration 36: 0.6914893617021277
	Train acc at iteration 38: 0.7948717948717948
	Val acc at iteration 37: 0.7340425531914894
	Train acc at iteration 39: 0.8189102564102564
	Val acc at iteration 38: 0.7340425531914894
	Train acc at iteration 40: 0.8028846153846154
	Val acc at iteration 39: 0.723404255319149
	Train acc at iteration 41: 0.8028846153846154
	Val acc at iteration 40: 0.723404255319149
	Train acc at iteration 42: 0.8173076923076923
	Val acc at iteration 41: 0.7021276595744681
	Train acc at iteration 43: 0.8413461538461539
	Val acc at iteration 42: 0.7340425531914894
	Train acc at iteration 44: 0.7964743589743589
	Val acc at iteration 43: 0.7127659574468085
	Train acc at iteration 45: 0.7980769230769231
	Val acc at iteration 44: 0.6595744680851063
	Train acc at iteration 46: 0.7932692307692307
	Val acc at iteration 45: 0.6276595744680851
	Train acc at iteration 47: 0.782051282051282
	Val acc at iteration 46: 0.7127659574468085
	Train acc at iteration 48: 0.8028846153846154
	Val acc at iteration 47: 0.6276595744680851
	Train acc at iteration 49: 0.8044871794871795
	Val acc at iteration 48: 0.723404255319149
	Train acc at iteration 50: 0.7644230769230769
	Val acc at iteration 49: 0.7340425531914894
	Train acc at iteration 51: 0.8189102564102564
	Val acc at iteration 50: 0.648936170212766
	Train acc at iteration 52: 0.7964743589743589
	Val acc at iteration 51: 0.7446808510638298
	Train acc at iteration 53: 0.7980769230769231
	Val acc at iteration 52: 0.7340425531914894
	Train acc at iteration 54: 0.7852564102564102
	Val acc at iteration 53: 0.6382978723404256
	Train acc at iteration 55: 0.8205128205128205
	Val acc at iteration 54: 0.6595744680851063
	Train acc at iteration 56: 0.8237179487179487
	Val acc at iteration 55: 0.6914893617021277
	Train acc at iteration 57: 0.7996794871794872
	Val acc at iteration 56: 0.6382978723404256
	Train acc at iteration 58: 0.7852564102564102
	Val acc at iteration 57: 0.7021276595744681
	Train acc at iteration 59: 0.780448717948718
	Val acc at iteration 58: 0.7021276595744681
	Train acc at iteration 60: 0.7932692307692307
	Val acc at iteration 59: 0.8085106382978723
	Train acc at iteration 61: 0.7836538461538461
	Val acc at iteration 60: 0.6914893617021277
	Train acc at iteration 62: 0.7836538461538461
	Val acc at iteration 61: 0.648936170212766
	Train acc at iteration 63: 0.8012820512820513
	Val acc at iteration 62: 0.648936170212766
	Train acc at iteration 64: 0.7868589743589743
	Val acc at iteration 63: 0.6382978723404256
	Train acc at iteration 65: 0.8141025641025641
	Val acc at iteration 64: 0.7021276595744681
	Train acc at iteration 66: 0.7948717948717948
	Val acc at iteration 65: 0.6914893617021277
	Train acc at iteration 67: 0.780448717948718
	Val acc at iteration 66: 0.6382978723404256
	Train acc at iteration 68: 0.7724358974358975
	Val acc at iteration 67: 0.6702127659574468
	Train acc at iteration 69: 0.8028846153846154
	Val acc at iteration 68: 0.6276595744680851
	Train acc at iteration 70: 0.7708333333333334
	Val acc at iteration 69: 0.648936170212766
	Train acc at iteration 71: 0.7868589743589743
	Val acc at iteration 70: 0.574468085106383
	Train acc at iteration 72: 0.7772435897435898
	Val acc at iteration 71: 0.6808510638297872
	Train acc at iteration 73: 0.7836538461538461
	Val acc at iteration 72: 0.7021276595744681
	Train acc at iteration 74: 0.7788461538461539
	Val acc at iteration 73: 0.648936170212766
	Train acc at iteration 75: 0.7708333333333334
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.7564102564102564
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.7868589743589743
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.7756410256410257
	Val acc at iteration 77: 0.6382978723404256
	Train acc at iteration 79: 0.75
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.7644230769230769
	Val acc at iteration 79: 0.6276595744680851
	Train acc at iteration 81: 0.7756410256410257
	Val acc at iteration 80: 0.6702127659574468
	Train acc at iteration 82: 0.782051282051282
	Val acc at iteration 81: 0.6914893617021277
	Train acc at iteration 83: 0.7644230769230769
	Val acc at iteration 82: 0.7127659574468085
	Train acc at iteration 84: 0.7836538461538461
	Val acc at iteration 83: 0.5957446808510638
	Train acc at iteration 85: 0.7516025641025641
	Val acc at iteration 84: 0.6382978723404256
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.545
Final val micro accuracy: 0.648936170212766
Final test macro f1-score: 0.45161290322580644
Final test micro accuracy: 0.5531914893617021
Final validation:
	Cluster: 0.626791924238205
	Separation: 0.5481773614883423
Final test:
	Cluster: 0.5897631347179413
	Separation: 0.5378028750419617
Saved Results

Attempting combination 26/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7872340425531915
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Train Cluster: 0.6456231355667115
	Train Separation: 0.5217986464500427
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6170212765957447
	Val acc at iteration 4: 0.6170212765957447
	Val acc at iteration 5: 0.648936170212766
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.7659574468085106
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.5638297872340425
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.8085106382978723
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.6914893617021277
	Val acc at iteration 24: 0.6595744680851063
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.7659574468085106
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.7021276595744681
	Val acc at iteration 42: 0.7659574468085106
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.6702127659574468
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.6702127659574468
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.6382978723404256
	Val acc at iteration 78: 0.6063829787234043
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.7446808510638298
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.7553191489361702
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Train Cluster: 0.6556054353713989
	Train Separation: 0.5247478485107422
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.7340425531914894
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.723404255319149
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.7553191489361702
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7553191489361702
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.7446808510638298
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.6170212765957447
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7553191489361702
	Val acc at iteration 39: 0.7340425531914894
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.7872340425531915
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.7872340425531915
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.8085106382978723
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7872340425531915
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.776595744680851
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7978723404255319
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.7659574468085106
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 25: 0.7446808510638298
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9680851063829787
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Train Cluster: 0.6503396987915039
	TrainSeparation: 0.526386559009552
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: 0.0001
	Train acc at iteration 1: 0.8189102564102564
	Val acc at iteration 0: 0.7127659574468085
	Train acc at iteration 2: 0.8076923076923077
	Val acc at iteration 1: 0.7978723404255319
	Train acc at iteration 3: 0.8269230769230769
	Val acc at iteration 2: 0.8085106382978723
	Train acc at iteration 4: 0.8221153846153846
	Val acc at iteration 3: 0.7659574468085106
	Train acc at iteration 5: 0.8108974358974359
	Val acc at iteration 4: 0.8191489361702128
	Train acc at iteration 6: 0.8044871794871795
	Val acc at iteration 5: 0.7021276595744681
	Train acc at iteration 7: 0.8285256410256411
	Val acc at iteration 6: 0.723404255319149
	Train acc at iteration 8: 0.8413461538461539
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.8269230769230769
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.7996794871794872
	Val acc at iteration 9: 0.7021276595744681
	Train acc at iteration 11: 0.8157051282051282
	Val acc at iteration 10: 0.7659574468085106
	Train acc at iteration 12: 0.8285256410256411
	Val acc at iteration 11: 0.7553191489361702
	Train acc at iteration 13: 0.8301282051282052
	Val acc at iteration 12: 0.7553191489361702
	Train acc at iteration 14: 0.8205128205128205
	Val acc at iteration 13: 0.7659574468085106
	Train acc at iteration 15: 0.8317307692307693
	Val acc at iteration 14: 0.7021276595744681
	Train acc at iteration 16: 0.8285256410256411
	Val acc at iteration 15: 0.7340425531914894
	Train acc at iteration 17: 0.8349358974358975
	Val acc at iteration 16: 0.8085106382978723
	Train acc at iteration 18: 0.8028846153846154
	Val acc at iteration 17: 0.7340425531914894
	Train acc at iteration 19: 0.8413461538461539
	Val acc at iteration 18: 0.6702127659574468
	Train acc at iteration 20: 0.8397435897435898
	Val acc at iteration 19: 0.7553191489361702
	Train acc at iteration 21: 0.7868589743589743
	Val acc at iteration 20: 0.7978723404255319
	Train acc at iteration 22: 0.8076923076923077
	Val acc at iteration 21: 0.7340425531914894
	Train acc at iteration 23: 0.8317307692307693
	Val acc at iteration 22: 0.7446808510638298
	Train acc at iteration 24: 0.8349358974358975
	Val acc at iteration 23: 0.7659574468085106
	Train acc at iteration 25: 0.8173076923076923
	Val acc at iteration 24: 0.7340425531914894
	Train acc at iteration 26: 0.8108974358974359
	Val acc at iteration 25: 0.7446808510638298
	Train acc at iteration 27: 0.8253205128205128
	Val acc at iteration 26: 0.776595744680851
	Train acc at iteration 28: 0.8221153846153846
	Val acc at iteration 27: 0.7446808510638298
	Train acc at iteration 29: 0.8076923076923077
	Val acc at iteration 28: 0.723404255319149
	Train acc at iteration 30: 0.8221153846153846
	Val acc at iteration 29: 0.7340425531914894
	Train acc at iteration 31: 0.8221153846153846
	Val acc at iteration 30: 0.8191489361702128
	Train acc at iteration 32: 0.8221153846153846
	Val acc at iteration 31: 0.776595744680851
	Train acc at iteration 33: 0.8173076923076923
	Val acc at iteration 32: 0.7553191489361702
	Train acc at iteration 34: 0.8349358974358975
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.8092948717948718
	Val acc at iteration 34: 0.776595744680851
	Train acc at iteration 36: 0.8044871794871795
	Val acc at iteration 35: 0.7021276595744681
	Train acc at iteration 37: 0.8189102564102564
	Val acc at iteration 36: 0.7978723404255319
	Train acc at iteration 38: 0.8237179487179487
	Val acc at iteration 37: 0.6595744680851063
	Train acc at iteration 39: 0.8028846153846154
	Val acc at iteration 38: 0.7978723404255319
	Train acc at iteration 40: 0.8285256410256411
	Val acc at iteration 39: 0.7446808510638298
	Train acc at iteration 41: 0.8349358974358975
	Val acc at iteration 40: 0.7446808510638298
	Train acc at iteration 42: 0.8301282051282052
	Val acc at iteration 41: 0.776595744680851
	Train acc at iteration 43: 0.8301282051282052
	Val acc at iteration 42: 0.6808510638297872
	Train acc at iteration 44: 0.8253205128205128
	Val acc at iteration 43: 0.776595744680851
	Train acc at iteration 45: 0.8125
	Val acc at iteration 44: 0.723404255319149
	Train acc at iteration 46: 0.8253205128205128
	Val acc at iteration 45: 0.776595744680851
	Train acc at iteration 47: 0.8365384615384616
	Val acc at iteration 46: 0.7021276595744681
	Train acc at iteration 48: 0.8253205128205128
	Val acc at iteration 47: 0.7021276595744681
	Train acc at iteration 49: 0.8349358974358975
	Val acc at iteration 48: 0.7021276595744681
	Train acc at iteration 50: 0.8237179487179487
	Val acc at iteration 49: 0.7446808510638298
	Train acc at iteration 51: 0.8285256410256411
	Val acc at iteration 50: 0.7340425531914894
	Train acc at iteration 52: 0.8509615384615384
	Val acc at iteration 51: 0.7446808510638298
	Train acc at iteration 53: 0.8060897435897436
	Val acc at iteration 52: 0.8085106382978723
	Train acc at iteration 54: 0.8301282051282052
	Val acc at iteration 53: 0.7553191489361702
	Train acc at iteration 55: 0.8237179487179487
	Val acc at iteration 54: 0.7127659574468085
	Train acc at iteration 56: 0.8125
	Val acc at iteration 55: 0.7446808510638298
	Train acc at iteration 57: 0.8285256410256411
	Val acc at iteration 56: 0.776595744680851
	Train acc at iteration 58: 0.8108974358974359
	Val acc at iteration 57: 0.7340425531914894
	Train acc at iteration 59: 0.8028846153846154
	Val acc at iteration 58: 0.6914893617021277
	Train acc at iteration 60: 0.8301282051282052
	Val acc at iteration 59: 0.6808510638297872
	Train acc at iteration 61: 0.8157051282051282
	Val acc at iteration 60: 0.7872340425531915
	Train acc at iteration 62: 0.7916666666666666
	Val acc at iteration 61: 0.7340425531914894
	Train acc at iteration 63: 0.7932692307692307
	Val acc at iteration 62: 0.7021276595744681
	Train acc at iteration 64: 0.8365384615384616
	Val acc at iteration 63: 0.7659574468085106
	Train acc at iteration 65: 0.8044871794871795
	Val acc at iteration 64: 0.776595744680851
	Train acc at iteration 66: 0.8125
	Val acc at iteration 65: 0.7978723404255319
	Train acc at iteration 67: 0.8285256410256411
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.8157051282051282
	Val acc at iteration 67: 0.7127659574468085
	Train acc at iteration 69: 0.8205128205128205
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.8301282051282052
	Val acc at iteration 69: 0.7340425531914894
	Train acc at iteration 71: 0.7996794871794872
	Val acc at iteration 70: 0.776595744680851
	Train acc at iteration 72: 0.7948717948717948
	Val acc at iteration 71: 0.7553191489361702
	Train acc at iteration 73: 0.8028846153846154
	Val acc at iteration 72: 0.8191489361702128
	Train acc at iteration 74: 0.8141025641025641
	Val acc at iteration 73: 0.7127659574468085
	Train acc at iteration 75: 0.8141025641025641
	Val acc at iteration 74: 0.7978723404255319
	Train acc at iteration 76: 0.8205128205128205
	Val acc at iteration 75: 0.7127659574468085
	Train acc at iteration 77: 0.8125
	Val acc at iteration 76: 0.7978723404255319
	Train acc at iteration 78: 0.7964743589743589
	Val acc at iteration 77: 0.8085106382978723
	Train acc at iteration 79: 0.8333333333333334
	Val acc at iteration 78: 0.7659574468085106
	Train acc at iteration 80: 0.8157051282051282
	Val acc at iteration 79: 0.7340425531914894
	Train acc at iteration 81: 0.8413461538461539
	Val acc at iteration 80: 0.7340425531914894
	Train acc at iteration 82: 0.8125
	Val acc at iteration 81: 0.7659574468085106
	Train acc at iteration 83: 0.8125
	Val acc at iteration 82: 0.7446808510638298
	Train acc at iteration 84: 0.8108974358974359
	Val acc at iteration 83: 0.776595744680851
	Train acc at iteration 85: 0.8141025641025641
	Val acc at iteration 84: 0.7340425531914894
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.683848797250859
Final val micro accuracy: 0.7978723404255319
Final test macro f1-score: 0.5445692883895131
Final test micro accuracy: 0.6595744680851063
Final validation:
	Cluster: 0.6503758728504181
	Separation: 0.541331946849823
Final test:
	Cluster: 0.6028852462768555
	Separation: 0.543388694524765
Saved Results

Attempting combination 27/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 5e-05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7580128205128205
	Train Cluster: 0.6385037422180175
	Train Separation: 0.5173943996429443
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.5425531914893617
	Val acc at iteration 3: 0.6063829787234043
	Val acc at iteration 4: 0.6170212765957447
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.6170212765957447
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.5531914893617021
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6914893617021277
	Val acc at iteration 19: 0.5957446808510638
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.6063829787234043
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.7021276595744681
	Val acc at iteration 33: 0.723404255319149
	Val acc at iteration 34: 0.7021276595744681
	Val acc at iteration 35: 0.5425531914893617
	Val acc at iteration 36: 0.5957446808510638
	Val acc at iteration 37: 0.6063829787234043
	Val acc at iteration 38: 0.7127659574468085
	Val acc at iteration 39: 0.7446808510638298
	Val acc at iteration 40: 0.6063829787234043
	Val acc at iteration 41: 0.7340425531914894
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.6702127659574468
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.6702127659574468
	Val acc at iteration 48: 0.6382978723404256
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.6170212765957447
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.7021276595744681
	Val acc at iteration 55: 0.6170212765957447
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.7340425531914894
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.5851063829787234
	Val acc at iteration 63: 0.6276595744680851
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.648936170212766
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.6914893617021277
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.6595744680851063
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.6595744680851063
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.6595744680851063
Val acc before epoch 13: 0.7021276595744681
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7872340425531915
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9468085106382979
Push epoch
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Train Cluster: 0.6427049040794373
	Train Separation: 0.5218491315841675
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.723404255319149
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7021276595744681
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.7553191489361702
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.7659574468085106
	Val acc at iteration 22: 0.7127659574468085
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6595744680851063
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.6595744680851063
	Val acc at iteration 31: 0.7446808510638298
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.7659574468085106
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.7446808510638298
	Val acc at iteration 38: 0.776595744680851
	Val acc at iteration 39: 0.776595744680851
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.6595744680851063
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.6914893617021277
	Val acc at iteration 45: 0.7553191489361702
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.6808510638297872
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7872340425531915
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.723404255319149
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.6808510638297872
	Val acc at iteration 60: 0.7659574468085106
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.6914893617021277
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.6595744680851063
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6170212765957447
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.723404255319149
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7553191489361702
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 25: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.8205128205128205
	Train Cluster: 0.6483983278274537
	TrainSeparation: 0.5247952938079834
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 5e-05
	Train acc at iteration 1: 0.7932692307692307
	Val acc at iteration 0: 0.6808510638297872
	Train acc at iteration 2: 0.8060897435897436
	Val acc at iteration 1: 0.7340425531914894
	Train acc at iteration 3: 0.8461538461538461
	Val acc at iteration 2: 0.6808510638297872
	Train acc at iteration 4: 0.7916666666666666
	Val acc at iteration 3: 0.776595744680851
	Train acc at iteration 5: 0.7772435897435898
	Val acc at iteration 4: 0.7340425531914894
	Train acc at iteration 6: 0.8028846153846154
	Val acc at iteration 5: 0.723404255319149
	Train acc at iteration 7: 0.8060897435897436
	Val acc at iteration 6: 0.7021276595744681
	Train acc at iteration 8: 0.7980769230769231
	Val acc at iteration 7: 0.6382978723404256
	Train acc at iteration 9: 0.7916666666666666
	Val acc at iteration 8: 0.7340425531914894
	Train acc at iteration 10: 0.8221153846153846
	Val acc at iteration 9: 0.7446808510638298
	Train acc at iteration 11: 0.8189102564102564
	Val acc at iteration 10: 0.648936170212766
	Train acc at iteration 12: 0.8301282051282052
	Val acc at iteration 11: 0.7340425531914894
	Train acc at iteration 13: 0.8237179487179487
	Val acc at iteration 12: 0.6808510638297872
	Train acc at iteration 14: 0.7996794871794872
	Val acc at iteration 13: 0.7446808510638298
	Train acc at iteration 15: 0.8269230769230769
	Val acc at iteration 14: 0.6702127659574468
	Train acc at iteration 16: 0.8028846153846154
	Val acc at iteration 15: 0.723404255319149
	Train acc at iteration 17: 0.8301282051282052
	Val acc at iteration 16: 0.6914893617021277
	Train acc at iteration 18: 0.8349358974358975
	Val acc at iteration 17: 0.776595744680851
	Train acc at iteration 19: 0.8028846153846154
	Val acc at iteration 18: 0.7446808510638298
	Train acc at iteration 20: 0.8269230769230769
	Val acc at iteration 19: 0.7340425531914894
	Train acc at iteration 21: 0.7996794871794872
	Val acc at iteration 20: 0.7127659574468085
	Train acc at iteration 22: 0.8044871794871795
	Val acc at iteration 21: 0.6702127659574468
	Train acc at iteration 23: 0.8044871794871795
	Val acc at iteration 22: 0.6808510638297872
	Train acc at iteration 24: 0.8076923076923077
	Val acc at iteration 23: 0.7978723404255319
	Train acc at iteration 25: 0.8173076923076923
	Val acc at iteration 24: 0.7127659574468085
	Train acc at iteration 26: 0.8253205128205128
	Val acc at iteration 25: 0.723404255319149
	Train acc at iteration 27: 0.7996794871794872
	Val acc at iteration 26: 0.7021276595744681
	Train acc at iteration 28: 0.8173076923076923
	Val acc at iteration 27: 0.7021276595744681
	Train acc at iteration 29: 0.8108974358974359
	Val acc at iteration 28: 0.723404255319149
	Train acc at iteration 30: 0.8189102564102564
	Val acc at iteration 29: 0.7446808510638298
	Train acc at iteration 31: 0.8157051282051282
	Val acc at iteration 30: 0.7659574468085106
	Train acc at iteration 32: 0.8028846153846154
	Val acc at iteration 31: 0.6914893617021277
	Train acc at iteration 33: 0.8333333333333334
	Val acc at iteration 32: 0.7127659574468085
	Train acc at iteration 34: 0.8108974358974359
	Val acc at iteration 33: 0.6808510638297872
	Train acc at iteration 35: 0.7932692307692307
	Val acc at iteration 34: 0.723404255319149
	Train acc at iteration 36: 0.7964743589743589
	Val acc at iteration 35: 0.723404255319149
	Train acc at iteration 37: 0.8381410256410257
	Val acc at iteration 36: 0.776595744680851
	Train acc at iteration 38: 0.8141025641025641
	Val acc at iteration 37: 0.7021276595744681
	Train acc at iteration 39: 0.8157051282051282
	Val acc at iteration 38: 0.7872340425531915
	Train acc at iteration 40: 0.8301282051282052
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.7852564102564102
	Val acc at iteration 40: 0.7127659574468085
	Train acc at iteration 42: 0.8060897435897436
	Val acc at iteration 41: 0.7553191489361702
	Train acc at iteration 43: 0.8076923076923077
	Val acc at iteration 42: 0.7127659574468085
	Train acc at iteration 44: 0.8012820512820513
	Val acc at iteration 43: 0.7553191489361702
	Train acc at iteration 45: 0.8237179487179487
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.8301282051282052
	Val acc at iteration 45: 0.6914893617021277
	Train acc at iteration 47: 0.8397435897435898
	Val acc at iteration 46: 0.7446808510638298
	Train acc at iteration 48: 0.8108974358974359
	Val acc at iteration 47: 0.776595744680851
	Train acc at iteration 49: 0.7980769230769231
	Val acc at iteration 48: 0.7021276595744681
	Train acc at iteration 50: 0.8253205128205128
	Val acc at iteration 49: 0.7021276595744681
	Train acc at iteration 51: 0.8173076923076923
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.8108974358974359
	Val acc at iteration 51: 0.6808510638297872
	Train acc at iteration 53: 0.8141025641025641
	Val acc at iteration 52: 0.7446808510638298
	Train acc at iteration 54: 0.8253205128205128
	Val acc at iteration 53: 0.7446808510638298
	Train acc at iteration 55: 0.8157051282051282
	Val acc at iteration 54: 0.723404255319149
	Train acc at iteration 56: 0.8221153846153846
	Val acc at iteration 55: 0.7021276595744681
	Train acc at iteration 57: 0.8253205128205128
	Val acc at iteration 56: 0.723404255319149
	Train acc at iteration 58: 0.8141025641025641
	Val acc at iteration 57: 0.7553191489361702
	Train acc at iteration 59: 0.8189102564102564
	Val acc at iteration 58: 0.7553191489361702
	Train acc at iteration 60: 0.8253205128205128
	Val acc at iteration 59: 0.723404255319149
	Train acc at iteration 61: 0.8076923076923077
	Val acc at iteration 60: 0.7978723404255319
	Train acc at iteration 62: 0.8108974358974359
	Val acc at iteration 61: 0.7978723404255319
	Train acc at iteration 63: 0.8173076923076923
	Val acc at iteration 62: 0.7872340425531915
	Train acc at iteration 64: 0.7868589743589743
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.7852564102564102
	Val acc at iteration 64: 0.7340425531914894
	Train acc at iteration 66: 0.8253205128205128
	Val acc at iteration 65: 0.7127659574468085
	Train acc at iteration 67: 0.7868589743589743
	Val acc at iteration 66: 0.6914893617021277
	Train acc at iteration 68: 0.8221153846153846
	Val acc at iteration 67: 0.776595744680851
	Train acc at iteration 69: 0.8253205128205128
	Val acc at iteration 68: 0.6702127659574468
	Train acc at iteration 70: 0.8028846153846154
	Val acc at iteration 69: 0.7340425531914894
	Train acc at iteration 71: 0.8125
	Val acc at iteration 70: 0.7127659574468085
	Train acc at iteration 72: 0.8301282051282052
	Val acc at iteration 71: 0.7446808510638298
	Train acc at iteration 73: 0.7996794871794872
	Val acc at iteration 72: 0.7340425531914894
	Train acc at iteration 74: 0.8141025641025641
	Val acc at iteration 73: 0.7446808510638298
	Train acc at iteration 75: 0.8205128205128205
	Val acc at iteration 74: 0.7553191489361702
	Train acc at iteration 76: 0.8221153846153846
	Val acc at iteration 75: 0.7021276595744681
	Train acc at iteration 77: 0.8317307692307693
	Val acc at iteration 76: 0.7446808510638298
	Train acc at iteration 78: 0.7980769230769231
	Val acc at iteration 77: 0.6702127659574468
	Train acc at iteration 79: 0.8301282051282052
	Val acc at iteration 78: 0.7340425531914894
	Train acc at iteration 80: 0.8285256410256411
	Val acc at iteration 79: 0.7127659574468085
	Train acc at iteration 81: 0.8141025641025641
	Val acc at iteration 80: 0.6808510638297872
	Train acc at iteration 82: 0.8044871794871795
	Val acc at iteration 81: 0.6595744680851063
	Train acc at iteration 83: 0.8108974358974359
	Val acc at iteration 82: 0.7127659574468085
	Train acc at iteration 84: 0.8237179487179487
	Val acc at iteration 83: 0.6170212765957447
	Train acc at iteration 85: 0.8221153846153846
	Val acc at iteration 84: 0.7127659574468085
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6666666666666667
Final val micro accuracy: 0.7553191489361702
Final test macro f1-score: 0.4879120879120879
Final test micro accuracy: 0.6170212765957447
Final validation:
	Cluster: 0.6412554681301117
	Separation: 0.5498892962932587
Final test:
	Cluster: 0.6038213074207306
	Separation: 0.5341651141643524
Saved Results

Attempting combination 28/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9468085106382979
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9468085106382979
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.782051282051282
	Train Cluster: 0.6557180643081665
	Train Separation: 0.5247368454933167
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5531914893617021
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.6063829787234043
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6170212765957447
	Val acc at iteration 25: 0.5851063829787234
	Val acc at iteration 26: 0.6063829787234043
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6595744680851063
	Val acc at iteration 36: 0.6170212765957447
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6063829787234043
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.574468085106383
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6170212765957447
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.6276595744680851
	Val acc at iteration 57: 0.6808510638297872
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.5957446808510638
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.7340425531914894
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.648936170212766
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.7021276595744681
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.7127659574468085
	Val acc at iteration 80: 0.6063829787234043
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.7340425531914894
	Val acc at iteration 83: 0.723404255319149
	Val acc at iteration 84: 0.6382978723404256
Val acc before epoch 13: 0.7021276595744681
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9574468085106383
Push epoch
After push, before retraining last layer:
	Train acc: 0.8333333333333334
	Train Cluster: 0.6534508228302002
	Train Separation: 0.5197730541229248
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.648936170212766
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.6914893617021277
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.5638297872340425
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6702127659574468
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.6382978723404256
	Val acc at iteration 34: 0.5638297872340425
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.723404255319149
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6276595744680851
	Val acc at iteration 44: 0.7021276595744681
	Val acc at iteration 45: 0.6382978723404256
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.6702127659574468
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.6702127659574468
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.7340425531914894
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7127659574468085
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.648936170212766
	Val acc at iteration 67: 0.648936170212766
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.648936170212766
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6276595744680851
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.6808510638297872
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.7021276595744681
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 25: 0.7021276595744681
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8085106382978723
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.8936170212765957
Stopping after epoch 37.
Final validation accuracy before push: 89.36170212765957%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7868589743589743
	Train Cluster: 0.6432212948799133
	TrainSeparation: 0.5204080104827881
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.1875
	Val acc at iteration 0: 0.05319148936170213
	Train acc at iteration 2: 0.04807692307692308
	Val acc at iteration 1: 0.02127659574468085
	Train acc at iteration 3: 0.009615384615384616
	Val acc at iteration 2: 0.010638297872340425
	Train acc at iteration 4: 0.009615384615384616
	Val acc at iteration 3: 0.05319148936170213
	Train acc at iteration 5: 0.07051282051282051
	Val acc at iteration 4: 0.3617021276595745
	Train acc at iteration 6: 0.29967948717948717
	Val acc at iteration 5: 0.010638297872340425
	Train acc at iteration 7: 0.030448717948717948
	Val acc at iteration 6: 0.010638297872340425
	Train acc at iteration 8: 0.009615384615384616
	Val acc at iteration 7: 0.010638297872340425
	Train acc at iteration 9: 0.04006410256410257
	Val acc at iteration 8: 0.4574468085106383
	Train acc at iteration 10: 0.38301282051282054
	Val acc at iteration 9: 0.0425531914893617
	Train acc at iteration 11: 0.10416666666666667
	Val acc at iteration 10: 0.02127659574468085
	Train acc at iteration 12: 0.038461538461538464
	Val acc at iteration 11: 0.39361702127659576
	Train acc at iteration 13: 0.15865384615384615
	Val acc at iteration 12: 0.06382978723404255
	Train acc at iteration 14: 0.09935897435897435
	Val acc at iteration 13: 0.1702127659574468
	Train acc at iteration 15: 0.15384615384615385
	Val acc at iteration 14: 0.02127659574468085
	Train acc at iteration 16: 0.049679487179487176
	Val acc at iteration 15: 0.0851063829787234
	Train acc at iteration 17: 0.04006410256410257
	Val acc at iteration 16: 0.46808510638297873
	Train acc at iteration 18: 0.20192307692307693
	Val acc at iteration 17: 0.20212765957446807
	Train acc at iteration 19: 0.4342948717948718
	Val acc at iteration 18: 0.1702127659574468
	Train acc at iteration 20: 0.34615384615384615
	Val acc at iteration 19: 0.48936170212765956
	Train acc at iteration 21: 0.36698717948717946
	Val acc at iteration 20: 0.13829787234042554
	Train acc at iteration 22: 0.2467948717948718
	Val acc at iteration 21: 0.5
	Train acc at iteration 23: 0.3814102564102564
	Val acc at iteration 22: 0.5212765957446809
	Train acc at iteration 24: 0.42467948717948717
	Val acc at iteration 23: 0.24468085106382978
	Train acc at iteration 25: 0.1875
	Val acc at iteration 24: 0.13829787234042554
	Train acc at iteration 26: 0.3108974358974359
	Val acc at iteration 25: 0.48936170212765956
	Train acc at iteration 27: 0.4823717948717949
	Val acc at iteration 26: 0.5531914893617021
	Train acc at iteration 28: 0.5592948717948718
	Val acc at iteration 27: 0.5
	Train acc at iteration 29: 0.5673076923076923
	Val acc at iteration 28: 0.4787234042553192
	Train acc at iteration 30: 0.5336538461538461
	Val acc at iteration 29: 0.3829787234042553
	Train acc at iteration 31: 0.5288461538461539
	Val acc at iteration 30: 0.4787234042553192
	Train acc at iteration 32: 0.5400641025641025
	Val acc at iteration 31: 0.48936170212765956
	Train acc at iteration 33: 0.5112179487179487
	Val acc at iteration 32: 0.3829787234042553
	Train acc at iteration 34: 0.5689102564102564
	Val acc at iteration 33: 0.5106382978723404
	Train acc at iteration 35: 0.5977564102564102
	Val acc at iteration 34: 0.5851063829787234
	Train acc at iteration 36: 0.5817307692307693
	Val acc at iteration 35: 0.5
	Train acc at iteration 37: 0.5913461538461539
	Val acc at iteration 36: 0.5212765957446809
	Train acc at iteration 38: 0.5977564102564102
	Val acc at iteration 37: 0.5319148936170213
	Train acc at iteration 39: 0.5977564102564102
	Val acc at iteration 38: 0.46808510638297873
	Train acc at iteration 40: 0.592948717948718
	Val acc at iteration 39: 0.5212765957446809
	Train acc at iteration 41: 0.6073717948717948
	Val acc at iteration 40: 0.5106382978723404
	Train acc at iteration 42: 0.5897435897435898
	Val acc at iteration 41: 0.5319148936170213
	Train acc at iteration 43: 0.5849358974358975
	Val acc at iteration 42: 0.5212765957446809
	Train acc at iteration 44: 0.6121794871794872
	Val acc at iteration 43: 0.5638297872340425
	Train acc at iteration 45: 0.5993589743589743
	Val acc at iteration 44: 0.5
	Train acc at iteration 46: 0.5705128205128205
	Val acc at iteration 45: 0.5
	Train acc at iteration 47: 0.6009615384615384
	Val acc at iteration 46: 0.5851063829787234
	Train acc at iteration 48: 0.6137820512820513
	Val acc at iteration 47: 0.5319148936170213
	Train acc at iteration 49: 0.6073717948717948
	Val acc at iteration 48: 0.5319148936170213
	Train acc at iteration 50: 0.6169871794871795
	Val acc at iteration 49: 0.5
	Train acc at iteration 51: 0.6009615384615384
	Val acc at iteration 50: 0.5
	Train acc at iteration 52: 0.6073717948717948
	Val acc at iteration 51: 0.5425531914893617
	Train acc at iteration 53: 0.5977564102564102
	Val acc at iteration 52: 0.5
	Train acc at iteration 54: 0.6282051282051282
	Val acc at iteration 53: 0.5425531914893617
	Train acc at iteration 55: 0.6025641025641025
	Val acc at iteration 54: 0.5531914893617021
	Train acc at iteration 56: 0.6314102564102564
	Val acc at iteration 55: 0.5319148936170213
	Train acc at iteration 57: 0.5753205128205128
	Val acc at iteration 56: 0.6382978723404256
	Train acc at iteration 58: 0.5865384615384616
	Val acc at iteration 57: 0.6063829787234043
	Train acc at iteration 59: 0.6201923076923077
	Val acc at iteration 58: 0.5531914893617021
	Train acc at iteration 60: 0.6105769230769231
	Val acc at iteration 59: 0.5
	Train acc at iteration 61: 0.6137820512820513
	Val acc at iteration 60: 0.5
	Train acc at iteration 62: 0.5721153846153846
	Val acc at iteration 61: 0.5425531914893617
	Train acc at iteration 63: 0.5913461538461539
	Val acc at iteration 62: 0.5106382978723404
	Train acc at iteration 64: 0.6201923076923077
	Val acc at iteration 63: 0.4787234042553192
	Train acc at iteration 65: 0.6201923076923077
	Val acc at iteration 64: 0.3723404255319149
	Train acc at iteration 66: 0.5737179487179487
	Val acc at iteration 65: 0.574468085106383
	Train acc at iteration 67: 0.6458333333333334
	Val acc at iteration 66: 0.6276595744680851
	Train acc at iteration 68: 0.6073717948717948
	Val acc at iteration 67: 0.46808510638297873
	Train acc at iteration 69: 0.6201923076923077
	Val acc at iteration 68: 0.5319148936170213
	Train acc at iteration 70: 0.5288461538461539
	Val acc at iteration 69: 0.425531914893617
	Train acc at iteration 71: 0.46794871794871795
	Val acc at iteration 70: 0.5531914893617021
	Train acc at iteration 72: 0.6810897435897436
	Val acc at iteration 71: 0.2553191489361702
	Train acc at iteration 73: 0.4423076923076923
	Val acc at iteration 72: 0.5212765957446809
	Train acc at iteration 74: 0.5416666666666666
	Val acc at iteration 73: 0.6063829787234043
	Train acc at iteration 75: 0.5673076923076923
	Val acc at iteration 74: 0.574468085106383
	Train acc at iteration 76: 0.6586538461538461
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.5705128205128205
	Val acc at iteration 76: 0.6595744680851063
	Train acc at iteration 78: 0.6057692307692307
	Val acc at iteration 77: 0.13829787234042554
	Train acc at iteration 79: 0.36217948717948717
	Val acc at iteration 78: 0.5957446808510638
	Train acc at iteration 80: 0.6346153846153846
	Val acc at iteration 79: 0.09574468085106383
	Train acc at iteration 81: 0.3108974358974359
	Val acc at iteration 80: 0.6170212765957447
	Train acc at iteration 82: 0.5737179487179487
	Val acc at iteration 81: 0.5638297872340425
	Train acc at iteration 83: 0.6458333333333334
	Val acc at iteration 82: 0.5957446808510638
	Train acc at iteration 84: 0.625
	Val acc at iteration 83: 0.24468085106382978
	Train acc at iteration 85: 0.44711538461538464
	Val acc at iteration 84: 0.5851063829787234
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5670212765957446
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.4527731092436974
Final test micro accuracy: 0.574468085106383
Final validation:
	Cluster: 0.6143662929534912
	Separation: 0.5438965559005737
Final test:
	Cluster: 0.5970999002456665
	Separation: 0.5431076288223267
Saved Results

Attempting combination 29/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7021276595744681
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7564102564102564
	Train Cluster: 0.6486869573593139
	Train Separation: 0.521163547039032
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.5957446808510638
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.6382978723404256
	Val acc at iteration 12: 0.6170212765957447
	Val acc at iteration 13: 0.6063829787234043
	Val acc at iteration 14: 0.648936170212766
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.5851063829787234
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.6702127659574468
	Val acc at iteration 25: 0.6702127659574468
	Val acc at iteration 26: 0.6170212765957447
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.6063829787234043
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.6382978723404256
	Val acc at iteration 37: 0.6170212765957447
	Val acc at iteration 38: 0.5851063829787234
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.7553191489361702
	Val acc at iteration 43: 0.5638297872340425
	Val acc at iteration 44: 0.6808510638297872
	Val acc at iteration 45: 0.5531914893617021
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.6595744680851063
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.7021276595744681
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.6063829787234043
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.6382978723404256
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.6808510638297872
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.5638297872340425
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.6063829787234043
	Val acc at iteration 71: 0.5638297872340425
	Val acc at iteration 72: 0.6382978723404256
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6170212765957447
	Val acc at iteration 75: 0.6170212765957447
	Val acc at iteration 76: 0.6595744680851063
	Val acc at iteration 77: 0.6702127659574468
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.648936170212766
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.5638297872340425
	Val acc at iteration 84: 0.6170212765957447
Val acc before epoch 13: 0.7340425531914894
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7580128205128205
	Train Cluster: 0.6462462067604064
	Train Separation: 0.521701455116272
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.6276595744680851
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.6595744680851063
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.6063829787234043
	Val acc at iteration 10: 0.6595744680851063
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.5851063829787234
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.6063829787234043
	Val acc at iteration 20: 0.5851063829787234
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.5638297872340425
	Val acc at iteration 25: 0.6914893617021277
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.648936170212766
	Val acc at iteration 28: 0.6170212765957447
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.6595744680851063
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.6702127659574468
	Val acc at iteration 39: 0.5957446808510638
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.6170212765957447
	Val acc at iteration 42: 0.6808510638297872
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.6276595744680851
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6808510638297872
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6170212765957447
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.5638297872340425
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.5638297872340425
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.6382978723404256
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.6382978723404256
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.6276595744680851
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.6808510638297872
	Val acc at iteration 79: 0.7021276595744681
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.6063829787234043
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.6808510638297872
Val acc before epoch 25: 0.6595744680851063
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7884615384615384
	Train Cluster: 0.6524998784065247
	TrainSeparation: 0.518929922580719
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.46474358974358976
	Val acc at iteration 0: 0.22340425531914893
	Train acc at iteration 2: 0.3092948717948718
	Val acc at iteration 1: 0.39361702127659576
	Train acc at iteration 3: 0.36378205128205127
	Val acc at iteration 2: 0.48936170212765956
	Train acc at iteration 4: 0.3894230769230769
	Val acc at iteration 3: 0.44680851063829785
	Train acc at iteration 5: 0.4198717948717949
	Val acc at iteration 4: 0.3404255319148936
	Train acc at iteration 6: 0.46474358974358976
	Val acc at iteration 5: 0.4787234042553192
	Train acc at iteration 7: 0.4951923076923077
	Val acc at iteration 6: 0.4787234042553192
	Train acc at iteration 8: 0.4967948717948718
	Val acc at iteration 7: 0.39361702127659576
	Train acc at iteration 9: 0.5080128205128205
	Val acc at iteration 8: 0.5851063829787234
	Train acc at iteration 10: 0.5496794871794872
	Val acc at iteration 9: 0.574468085106383
	Train acc at iteration 11: 0.6041666666666666
	Val acc at iteration 10: 0.5319148936170213
	Train acc at iteration 12: 0.5897435897435898
	Val acc at iteration 11: 0.5106382978723404
	Train acc at iteration 13: 0.6298076923076923
	Val acc at iteration 12: 0.5319148936170213
	Train acc at iteration 14: 0.6474358974358975
	Val acc at iteration 13: 0.5212765957446809
	Train acc at iteration 15: 0.6923076923076923
	Val acc at iteration 14: 0.5957446808510638
	Train acc at iteration 16: 0.6858974358974359
	Val acc at iteration 15: 0.5531914893617021
	Train acc at iteration 17: 0.6939102564102564
	Val acc at iteration 16: 0.6063829787234043
	Train acc at iteration 18: 0.7099358974358975
	Val acc at iteration 17: 0.6382978723404256
	Train acc at iteration 19: 0.7243589743589743
	Val acc at iteration 18: 0.648936170212766
	Train acc at iteration 20: 0.7163461538461539
	Val acc at iteration 19: 0.6382978723404256
	Train acc at iteration 21: 0.7067307692307693
	Val acc at iteration 20: 0.6170212765957447
	Train acc at iteration 22: 0.7339743589743589
	Val acc at iteration 21: 0.6595744680851063
	Train acc at iteration 23: 0.6875
	Val acc at iteration 22: 0.6382978723404256
	Train acc at iteration 24: 0.7451923076923077
	Val acc at iteration 23: 0.648936170212766
	Train acc at iteration 25: 0.7740384615384616
	Val acc at iteration 24: 0.6276595744680851
	Train acc at iteration 26: 0.7419871794871795
	Val acc at iteration 25: 0.7021276595744681
	Train acc at iteration 27: 0.7099358974358975
	Val acc at iteration 26: 0.7021276595744681
	Train acc at iteration 28: 0.7243589743589743
	Val acc at iteration 27: 0.6276595744680851
	Train acc at iteration 29: 0.7035256410256411
	Val acc at iteration 28: 0.7446808510638298
	Train acc at iteration 30: 0.7483974358974359
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.7227564102564102
	Val acc at iteration 30: 0.5851063829787234
	Train acc at iteration 32: 0.7435897435897436
	Val acc at iteration 31: 0.7127659574468085
	Train acc at iteration 33: 0.75
	Val acc at iteration 32: 0.6702127659574468
	Train acc at iteration 34: 0.7387820512820513
	Val acc at iteration 33: 0.6914893617021277
	Train acc at iteration 35: 0.7532051282051282
	Val acc at iteration 34: 0.6382978723404256
	Train acc at iteration 36: 0.7692307692307693
	Val acc at iteration 35: 0.7446808510638298
	Train acc at iteration 37: 0.7467948717948718
	Val acc at iteration 36: 0.6914893617021277
	Train acc at iteration 38: 0.7756410256410257
	Val acc at iteration 37: 0.6382978723404256
	Train acc at iteration 39: 0.7532051282051282
	Val acc at iteration 38: 0.6702127659574468
	Train acc at iteration 40: 0.7708333333333334
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.7516025641025641
	Val acc at iteration 40: 0.7659574468085106
	Train acc at iteration 42: 0.7532051282051282
	Val acc at iteration 41: 0.6808510638297872
	Train acc at iteration 43: 0.7692307692307693
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.7740384615384616
	Val acc at iteration 43: 0.5851063829787234
	Train acc at iteration 45: 0.7916666666666666
	Val acc at iteration 44: 0.7127659574468085
	Train acc at iteration 46: 0.7516025641025641
	Val acc at iteration 45: 0.6914893617021277
	Train acc at iteration 47: 0.7676282051282052
	Val acc at iteration 46: 0.6595744680851063
	Train acc at iteration 48: 0.75
	Val acc at iteration 47: 0.6276595744680851
	Train acc at iteration 49: 0.7548076923076923
	Val acc at iteration 48: 0.6595744680851063
	Train acc at iteration 50: 0.7644230769230769
	Val acc at iteration 49: 0.7127659574468085
	Train acc at iteration 51: 0.7532051282051282
	Val acc at iteration 50: 0.7021276595744681
	Train acc at iteration 52: 0.8044871794871795
	Val acc at iteration 51: 0.7021276595744681
	Train acc at iteration 53: 0.7932692307692307
	Val acc at iteration 52: 0.7446808510638298
	Train acc at iteration 54: 0.7628205128205128
	Val acc at iteration 53: 0.648936170212766
	Train acc at iteration 55: 0.7740384615384616
	Val acc at iteration 54: 0.6808510638297872
	Train acc at iteration 56: 0.7740384615384616
	Val acc at iteration 55: 0.6808510638297872
	Train acc at iteration 57: 0.7724358974358975
	Val acc at iteration 56: 0.723404255319149
	Train acc at iteration 58: 0.7772435897435898
	Val acc at iteration 57: 0.7340425531914894
	Train acc at iteration 59: 0.7996794871794872
	Val acc at iteration 58: 0.6595744680851063
	Train acc at iteration 60: 0.7756410256410257
	Val acc at iteration 59: 0.6808510638297872
	Train acc at iteration 61: 0.7932692307692307
	Val acc at iteration 60: 0.7340425531914894
	Train acc at iteration 62: 0.7516025641025641
	Val acc at iteration 61: 0.776595744680851
	Train acc at iteration 63: 0.7692307692307693
	Val acc at iteration 62: 0.648936170212766
	Train acc at iteration 64: 0.7852564102564102
	Val acc at iteration 63: 0.6808510638297872
	Train acc at iteration 65: 0.7916666666666666
	Val acc at iteration 64: 0.6808510638297872
	Train acc at iteration 66: 0.7660256410256411
	Val acc at iteration 65: 0.7340425531914894
	Train acc at iteration 67: 0.7948717948717948
	Val acc at iteration 66: 0.6170212765957447
	Train acc at iteration 68: 0.7836538461538461
	Val acc at iteration 67: 0.7340425531914894
	Train acc at iteration 69: 0.8044871794871795
	Val acc at iteration 68: 0.7340425531914894
	Train acc at iteration 70: 0.8060897435897436
	Val acc at iteration 69: 0.6808510638297872
	Train acc at iteration 71: 0.782051282051282
	Val acc at iteration 70: 0.6170212765957447
	Train acc at iteration 72: 0.8028846153846154
	Val acc at iteration 71: 0.6914893617021277
	Train acc at iteration 73: 0.7756410256410257
	Val acc at iteration 72: 0.6595744680851063
	Train acc at iteration 74: 0.7932692307692307
	Val acc at iteration 73: 0.6595744680851063
	Train acc at iteration 75: 0.7724358974358975
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.7916666666666666
	Val acc at iteration 75: 0.723404255319149
	Train acc at iteration 77: 0.7980769230769231
	Val acc at iteration 76: 0.723404255319149
	Train acc at iteration 78: 0.7868589743589743
	Val acc at iteration 77: 0.6808510638297872
	Train acc at iteration 79: 0.782051282051282
	Val acc at iteration 78: 0.7340425531914894
	Train acc at iteration 80: 0.8044871794871795
	Val acc at iteration 79: 0.6702127659574468
	Train acc at iteration 81: 0.7932692307692307
	Val acc at iteration 80: 0.7446808510638298
	Train acc at iteration 82: 0.7900641025641025
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7916666666666666
	Val acc at iteration 82: 0.6702127659574468
	Train acc at iteration 84: 0.7852564102564102
	Val acc at iteration 83: 0.723404255319149
	Train acc at iteration 85: 0.7996794871794872
	Val acc at iteration 84: 0.7659574468085106
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6750841750841751
Final val micro accuracy: 0.776595744680851
Final test macro f1-score: 0.4522727272727272
Final test micro accuracy: 0.574468085106383
Final validation:
	Cluster: 0.6436367928981781
	Separation: 0.540952056646347
Final test:
	Cluster: 0.5887270867824554
	Separation: 0.5332099497318268
Saved Results

Attempting combination 30/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Train Cluster: 0.642281448841095
	Train Separation: 0.5194888591766358
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.5957446808510638
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.5638297872340425
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.5319148936170213
	Val acc at iteration 9: 0.5425531914893617
	Val acc at iteration 10: 0.6808510638297872
	Val acc at iteration 11: 0.6063829787234043
	Val acc at iteration 12: 0.5957446808510638
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6063829787234043
	Val acc at iteration 16: 0.6595744680851063
	Val acc at iteration 17: 0.6063829787234043
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.5531914893617021
	Val acc at iteration 20: 0.6276595744680851
	Val acc at iteration 21: 0.5957446808510638
	Val acc at iteration 22: 0.5957446808510638
	Val acc at iteration 23: 0.6276595744680851
	Val acc at iteration 24: 0.5531914893617021
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.574468085106383
	Val acc at iteration 28: 0.6808510638297872
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.6063829787234043
	Val acc at iteration 31: 0.6063829787234043
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.6170212765957447
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.574468085106383
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.648936170212766
	Val acc at iteration 38: 0.5851063829787234
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.5851063829787234
	Val acc at iteration 41: 0.6063829787234043
	Val acc at iteration 42: 0.6170212765957447
	Val acc at iteration 43: 0.5957446808510638
	Val acc at iteration 44: 0.5638297872340425
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.5531914893617021
	Val acc at iteration 47: 0.5957446808510638
	Val acc at iteration 48: 0.574468085106383
	Val acc at iteration 49: 0.5851063829787234
	Val acc at iteration 50: 0.6382978723404256
	Val acc at iteration 51: 0.6382978723404256
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.6276595744680851
	Val acc at iteration 56: 0.6170212765957447
	Val acc at iteration 57: 0.5957446808510638
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.5957446808510638
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.6063829787234043
	Val acc at iteration 65: 0.6702127659574468
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.6063829787234043
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.5425531914893617
	Val acc at iteration 70: 0.5531914893617021
	Val acc at iteration 71: 0.6276595744680851
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.5957446808510638
	Val acc at iteration 74: 0.6063829787234043
	Val acc at iteration 75: 0.5319148936170213
	Val acc at iteration 76: 0.6382978723404256
	Val acc at iteration 77: 0.5851063829787234
	Val acc at iteration 78: 0.723404255319149
	Val acc at iteration 79: 0.648936170212766
	Val acc at iteration 80: 0.6276595744680851
	Val acc at iteration 81: 0.574468085106383
	Val acc at iteration 82: 0.6382978723404256
	Val acc at iteration 83: 0.5851063829787234
	Val acc at iteration 84: 0.6595744680851063
Val acc before epoch 13: 0.574468085106383
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7872340425531915
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.7978723404255319
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7419871794871795
	Train Cluster: 0.6451226949691773
	Train Separation: 0.5167620301246643
(Directly after push) Val acc at iteration 0: 0.5851063829787234
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.5851063829787234
	Val acc at iteration 3: 0.6595744680851063
	Val acc at iteration 4: 0.574468085106383
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6382978723404256
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6063829787234043
	Val acc at iteration 9: 0.6276595744680851
	Val acc at iteration 10: 0.574468085106383
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.7021276595744681
	Val acc at iteration 14: 0.6063829787234043
	Val acc at iteration 15: 0.6276595744680851
	Val acc at iteration 16: 0.6276595744680851
	Val acc at iteration 17: 0.574468085106383
	Val acc at iteration 18: 0.6063829787234043
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.5957446808510638
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.5851063829787234
	Val acc at iteration 24: 0.5531914893617021
	Val acc at iteration 25: 0.723404255319149
	Val acc at iteration 26: 0.6170212765957447
	Val acc at iteration 27: 0.5851063829787234
	Val acc at iteration 28: 0.6063829787234043
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.5531914893617021
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.5851063829787234
	Val acc at iteration 34: 0.5851063829787234
	Val acc at iteration 35: 0.7021276595744681
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.5957446808510638
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.6382978723404256
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.7021276595744681
	Val acc at iteration 43: 0.6382978723404256
	Val acc at iteration 44: 0.648936170212766
	Val acc at iteration 45: 0.6170212765957447
	Val acc at iteration 46: 0.6170212765957447
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.6063829787234043
	Val acc at iteration 50: 0.6276595744680851
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.6382978723404256
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.5957446808510638
	Val acc at iteration 55: 0.5957446808510638
	Val acc at iteration 56: 0.5851063829787234
	Val acc at iteration 57: 0.7021276595744681
	Val acc at iteration 58: 0.574468085106383
	Val acc at iteration 59: 0.6170212765957447
	Val acc at iteration 60: 0.5957446808510638
	Val acc at iteration 61: 0.6170212765957447
	Val acc at iteration 62: 0.6170212765957447
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.5957446808510638
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.6276595744680851
	Val acc at iteration 67: 0.6063829787234043
	Val acc at iteration 68: 0.6063829787234043
	Val acc at iteration 69: 0.6276595744680851
	Val acc at iteration 70: 0.6170212765957447
	Val acc at iteration 71: 0.5638297872340425
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.5531914893617021
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.5957446808510638
	Val acc at iteration 78: 0.574468085106383
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.6170212765957447
	Val acc at iteration 81: 0.5957446808510638
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.6170212765957447
	Val acc at iteration 84: 0.6063829787234043
Val acc before epoch 25: 0.6382978723404256
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9680851063829787
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9787234042553191
Stopping after epoch 37.
Final validation accuracy before push: 97.87234042553192%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.6442902565002442
	TrainSeparation: 0.5205689787864685
(Directly after push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer
Last layer lr: 0.05
	Train acc at iteration 1: 0.5769230769230769
	Val acc at iteration 0: 0.4148936170212766
	Train acc at iteration 2: 0.5448717948717948
	Val acc at iteration 1: 0.5
	Train acc at iteration 3: 0.5160256410256411
	Val acc at iteration 2: 0.6063829787234043
	Train acc at iteration 4: 0.5993589743589743
	Val acc at iteration 3: 0.46808510638297873
	Train acc at iteration 5: 0.592948717948718
	Val acc at iteration 4: 0.5957446808510638
	Train acc at iteration 6: 0.5608974358974359
	Val acc at iteration 5: 0.5212765957446809
	Train acc at iteration 7: 0.6217948717948718
	Val acc at iteration 6: 0.5851063829787234
	Train acc at iteration 8: 0.5753205128205128
	Val acc at iteration 7: 0.5957446808510638
	Train acc at iteration 9: 0.6185897435897436
	Val acc at iteration 8: 0.5531914893617021
	Train acc at iteration 10: 0.6618589743589743
	Val acc at iteration 9: 0.5212765957446809
	Train acc at iteration 11: 0.655448717948718
	Val acc at iteration 10: 0.5531914893617021
	Train acc at iteration 12: 0.6810897435897436
	Val acc at iteration 11: 0.6063829787234043
	Train acc at iteration 13: 0.7019230769230769
	Val acc at iteration 12: 0.6063829787234043
	Train acc at iteration 14: 0.6955128205128205
	Val acc at iteration 13: 0.6382978723404256
	Train acc at iteration 15: 0.6955128205128205
	Val acc at iteration 14: 0.5957446808510638
	Train acc at iteration 16: 0.6826923076923077
	Val acc at iteration 15: 0.5957446808510638
	Train acc at iteration 17: 0.6826923076923077
	Val acc at iteration 16: 0.5957446808510638
	Train acc at iteration 18: 0.7211538461538461
	Val acc at iteration 17: 0.5851063829787234
	Train acc at iteration 19: 0.7259615384615384
	Val acc at iteration 18: 0.648936170212766
	Train acc at iteration 20: 0.7227564102564102
	Val acc at iteration 19: 0.5851063829787234
	Train acc at iteration 21: 0.719551282051282
	Val acc at iteration 20: 0.648936170212766
	Train acc at iteration 22: 0.7435897435897436
	Val acc at iteration 21: 0.6595744680851063
	Train acc at iteration 23: 0.7051282051282052
	Val acc at iteration 22: 0.7021276595744681
	Train acc at iteration 24: 0.7131410256410257
	Val acc at iteration 23: 0.6063829787234043
	Train acc at iteration 25: 0.7387820512820513
	Val acc at iteration 24: 0.6914893617021277
	Train acc at iteration 26: 0.7099358974358975
	Val acc at iteration 25: 0.6063829787234043
	Train acc at iteration 27: 0.7564102564102564
	Val acc at iteration 26: 0.6170212765957447
	Train acc at iteration 28: 0.7307692307692307
	Val acc at iteration 27: 0.5957446808510638
	Train acc at iteration 29: 0.7419871794871795
	Val acc at iteration 28: 0.6595744680851063
	Train acc at iteration 30: 0.7676282051282052
	Val acc at iteration 29: 0.6276595744680851
	Train acc at iteration 31: 0.7419871794871795
	Val acc at iteration 30: 0.6808510638297872
	Train acc at iteration 32: 0.7483974358974359
	Val acc at iteration 31: 0.723404255319149
	Train acc at iteration 33: 0.7660256410256411
	Val acc at iteration 32: 0.5851063829787234
	Train acc at iteration 34: 0.7596153846153846
	Val acc at iteration 33: 0.7021276595744681
	Train acc at iteration 35: 0.7772435897435898
	Val acc at iteration 34: 0.6170212765957447
	Train acc at iteration 36: 0.7692307692307693
	Val acc at iteration 35: 0.7127659574468085
	Train acc at iteration 37: 0.7900641025641025
	Val acc at iteration 36: 0.6914893617021277
	Train acc at iteration 38: 0.7996794871794872
	Val acc at iteration 37: 0.7127659574468085
	Train acc at iteration 39: 0.7339743589743589
	Val acc at iteration 38: 0.6914893617021277
	Train acc at iteration 40: 0.8012820512820513
	Val acc at iteration 39: 0.6808510638297872
	Train acc at iteration 41: 0.780448717948718
	Val acc at iteration 40: 0.648936170212766
	Train acc at iteration 42: 0.7884615384615384
	Val acc at iteration 41: 0.7446808510638298
	Train acc at iteration 43: 0.7980769230769231
	Val acc at iteration 42: 0.6702127659574468
	Train acc at iteration 44: 0.8076923076923077
	Val acc at iteration 43: 0.6595744680851063
	Train acc at iteration 45: 0.782051282051282
	Val acc at iteration 44: 0.6382978723404256
	Train acc at iteration 46: 0.7660256410256411
	Val acc at iteration 45: 0.7127659574468085
	Train acc at iteration 47: 0.7708333333333334
	Val acc at iteration 46: 0.6170212765957447
	Train acc at iteration 48: 0.8108974358974359
	Val acc at iteration 47: 0.723404255319149
	Train acc at iteration 49: 0.8012820512820513
	Val acc at iteration 48: 0.6063829787234043
	Train acc at iteration 50: 0.7756410256410257
	Val acc at iteration 49: 0.723404255319149
	Train acc at iteration 51: 0.7708333333333334
	Val acc at iteration 50: 0.7021276595744681
	Train acc at iteration 52: 0.7964743589743589
	Val acc at iteration 51: 0.723404255319149
	Train acc at iteration 53: 0.782051282051282
	Val acc at iteration 52: 0.6382978723404256
	Train acc at iteration 54: 0.8157051282051282
	Val acc at iteration 53: 0.7127659574468085
	Train acc at iteration 55: 0.7916666666666666
	Val acc at iteration 54: 0.7340425531914894
	Train acc at iteration 56: 0.7836538461538461
	Val acc at iteration 55: 0.776595744680851
	Train acc at iteration 57: 0.8092948717948718
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.7564102564102564
	Val acc at iteration 57: 0.723404255319149
	Train acc at iteration 59: 0.7612179487179487
	Val acc at iteration 58: 0.6914893617021277
	Train acc at iteration 60: 0.7932692307692307
	Val acc at iteration 59: 0.6808510638297872
	Train acc at iteration 61: 0.7740384615384616
	Val acc at iteration 60: 0.7021276595744681
	Train acc at iteration 62: 0.7868589743589743
	Val acc at iteration 61: 0.6808510638297872
	Train acc at iteration 63: 0.7612179487179487
	Val acc at iteration 62: 0.6702127659574468
	Train acc at iteration 64: 0.7660256410256411
	Val acc at iteration 63: 0.7446808510638298
	Train acc at iteration 65: 0.7740384615384616
	Val acc at iteration 64: 0.7659574468085106
	Train acc at iteration 66: 0.8173076923076923
	Val acc at iteration 65: 0.6702127659574468
	Train acc at iteration 67: 0.7868589743589743
	Val acc at iteration 66: 0.723404255319149
	Train acc at iteration 68: 0.7916666666666666
	Val acc at iteration 67: 0.7127659574468085
	Train acc at iteration 69: 0.7916666666666666
	Val acc at iteration 68: 0.7127659574468085
	Train acc at iteration 70: 0.7788461538461539
	Val acc at iteration 69: 0.6914893617021277
	Train acc at iteration 71: 0.7756410256410257
	Val acc at iteration 70: 0.8297872340425532
	Train acc at iteration 72: 0.7772435897435898
	Val acc at iteration 71: 0.7553191489361702
	Train acc at iteration 73: 0.8141025641025641
	Val acc at iteration 72: 0.7553191489361702
	Train acc at iteration 74: 0.7964743589743589
	Val acc at iteration 73: 0.723404255319149
	Train acc at iteration 75: 0.7868589743589743
	Val acc at iteration 74: 0.7446808510638298
	Train acc at iteration 76: 0.8173076923076923
	Val acc at iteration 75: 0.776595744680851
	Train acc at iteration 77: 0.7772435897435898
	Val acc at iteration 76: 0.7446808510638298
	Train acc at iteration 78: 0.7868589743589743
	Val acc at iteration 77: 0.7021276595744681
	Train acc at iteration 79: 0.7932692307692307
	Val acc at iteration 78: 0.7978723404255319
	Train acc at iteration 80: 0.8060897435897436
	Val acc at iteration 79: 0.7340425531914894
	Train acc at iteration 81: 0.8125
	Val acc at iteration 80: 0.776595744680851
	Train acc at iteration 82: 0.8108974358974359
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7884615384615384
	Val acc at iteration 82: 0.6170212765957447
	Train acc at iteration 84: 0.7884615384615384
	Val acc at iteration 83: 0.7021276595744681
	Train acc at iteration 85: 0.7932692307692307
	Val acc at iteration 84: 0.6914893617021277
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5721088435374149
Final val micro accuracy: 0.6914893617021277
Final test macro f1-score: 0.6200803212851406
Final test micro accuracy: 0.7553191489361702
Final validation:
	Cluster: 0.6388844549655914
	Separation: 0.5370003581047058
Final test:
	Cluster: 0.6024270355701447
	Separation: 0.5450306534767151
Saved Results

Attempting combination 31/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.01
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7339743589743589
	Train Cluster: 0.6391357779502869
	Train Separation: 0.5195810198783875
(Directly after push) Val acc at iteration 0: 0.6063829787234043
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.6063829787234043
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.5638297872340425
	Val acc at iteration 5: 0.574468085106383
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.5638297872340425
	Val acc at iteration 8: 0.5531914893617021
	Val acc at iteration 9: 0.6808510638297872
	Val acc at iteration 10: 0.6170212765957447
	Val acc at iteration 11: 0.5851063829787234
	Val acc at iteration 12: 0.5425531914893617
	Val acc at iteration 13: 0.5425531914893617
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.6170212765957447
	Val acc at iteration 16: 0.5531914893617021
	Val acc at iteration 17: 0.5212765957446809
	Val acc at iteration 18: 0.574468085106383
	Val acc at iteration 19: 0.5212765957446809
	Val acc at iteration 20: 0.5
	Val acc at iteration 21: 0.6063829787234043
	Val acc at iteration 22: 0.5531914893617021
	Val acc at iteration 23: 0.5957446808510638
	Val acc at iteration 24: 0.5957446808510638
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.5851063829787234
	Val acc at iteration 28: 0.6702127659574468
	Val acc at iteration 29: 0.5957446808510638
	Val acc at iteration 30: 0.6063829787234043
	Val acc at iteration 31: 0.5851063829787234
	Val acc at iteration 32: 0.5531914893617021
	Val acc at iteration 33: 0.5425531914893617
	Val acc at iteration 34: 0.5106382978723404
	Val acc at iteration 35: 0.5638297872340425
	Val acc at iteration 36: 0.648936170212766
	Val acc at iteration 37: 0.6170212765957447
	Val acc at iteration 38: 0.6170212765957447
	Val acc at iteration 39: 0.5425531914893617
	Val acc at iteration 40: 0.5957446808510638
	Val acc at iteration 41: 0.6170212765957447
	Val acc at iteration 42: 0.5638297872340425
	Val acc at iteration 43: 0.5957446808510638
	Val acc at iteration 44: 0.5851063829787234
	Val acc at iteration 45: 0.5638297872340425
	Val acc at iteration 46: 0.6170212765957447
	Val acc at iteration 47: 0.5425531914893617
	Val acc at iteration 48: 0.5638297872340425
	Val acc at iteration 49: 0.6170212765957447
	Val acc at iteration 50: 0.6170212765957447
	Val acc at iteration 51: 0.5957446808510638
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.5425531914893617
	Val acc at iteration 54: 0.5851063829787234
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.6063829787234043
	Val acc at iteration 57: 0.5531914893617021
	Val acc at iteration 58: 0.5638297872340425
	Val acc at iteration 59: 0.5851063829787234
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.6063829787234043
	Val acc at iteration 62: 0.6170212765957447
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.44680851063829785
	Val acc at iteration 65: 0.574468085106383
	Val acc at iteration 66: 0.6276595744680851
	Val acc at iteration 67: 0.574468085106383
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.5957446808510638
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.6382978723404256
	Val acc at iteration 72: 0.5531914893617021
	Val acc at iteration 73: 0.6170212765957447
	Val acc at iteration 74: 0.5851063829787234
	Val acc at iteration 75: 0.6170212765957447
	Val acc at iteration 76: 0.5425531914893617
	Val acc at iteration 77: 0.5851063829787234
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.6276595744680851
	Val acc at iteration 80: 0.5851063829787234
	Val acc at iteration 81: 0.6063829787234043
	Val acc at iteration 82: 0.5212765957446809
	Val acc at iteration 83: 0.6170212765957447
	Val acc at iteration 84: 0.5957446808510638
Val acc before epoch 13: 0.6063829787234043
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8085106382978723
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.646612286567688
	Train Separation: 0.5197503685951232
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.574468085106383
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.5851063829787234
	Val acc at iteration 7: 0.5638297872340425
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.5531914893617021
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.5957446808510638
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.6063829787234043
	Val acc at iteration 15: 0.5957446808510638
	Val acc at iteration 16: 0.6276595744680851
	Val acc at iteration 17: 0.5957446808510638
	Val acc at iteration 18: 0.5957446808510638
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.5851063829787234
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.6063829787234043
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6276595744680851
	Val acc at iteration 25: 0.6170212765957447
	Val acc at iteration 26: 0.6063829787234043
	Val acc at iteration 27: 0.5425531914893617
	Val acc at iteration 28: 0.5851063829787234
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.6170212765957447
	Val acc at iteration 31: 0.6382978723404256
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.5851063829787234
	Val acc at iteration 35: 0.6063829787234043
	Val acc at iteration 36: 0.6063829787234043
	Val acc at iteration 37: 0.6063829787234043
	Val acc at iteration 38: 0.6276595744680851
	Val acc at iteration 39: 0.5638297872340425
	Val acc at iteration 40: 0.5851063829787234
	Val acc at iteration 41: 0.5851063829787234
	Val acc at iteration 42: 0.6170212765957447
	Val acc at iteration 43: 0.6063829787234043
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.5957446808510638
	Val acc at iteration 46: 0.6382978723404256
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.6276595744680851
	Val acc at iteration 50: 0.6276595744680851
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.6170212765957447
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.574468085106383
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.6276595744680851
	Val acc at iteration 60: 0.6276595744680851
	Val acc at iteration 61: 0.5425531914893617
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.574468085106383
	Val acc at iteration 64: 0.5957446808510638
	Val acc at iteration 65: 0.5638297872340425
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6170212765957447
	Val acc at iteration 68: 0.6170212765957447
	Val acc at iteration 69: 0.5957446808510638
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.6170212765957447
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6382978723404256
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.6382978723404256
	Val acc at iteration 77: 0.5319148936170213
	Val acc at iteration 78: 0.6702127659574468
	Val acc at iteration 79: 0.6170212765957447
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.648936170212766
	Val acc at iteration 82: 0.6276595744680851
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.6276595744680851
Val acc before epoch 25: 0.574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7644230769230769
	Train Cluster: 0.6446202993392944
	TrainSeparation: 0.5214216947555542
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.01
	Train acc at iteration 1: 0.7339743589743589
	Val acc at iteration 0: 0.7446808510638298
	Train acc at iteration 2: 0.75
	Val acc at iteration 1: 0.5851063829787234
	Train acc at iteration 3: 0.7323717948717948
	Val acc at iteration 2: 0.6382978723404256
	Train acc at iteration 4: 0.7259615384615384
	Val acc at iteration 3: 0.6170212765957447
	Train acc at iteration 5: 0.75
	Val acc at iteration 4: 0.648936170212766
	Train acc at iteration 6: 0.7580128205128205
	Val acc at iteration 5: 0.6595744680851063
	Train acc at iteration 7: 0.7451923076923077
	Val acc at iteration 6: 0.6170212765957447
	Train acc at iteration 8: 0.7419871794871795
	Val acc at iteration 7: 0.6595744680851063
	Train acc at iteration 9: 0.7211538461538461
	Val acc at iteration 8: 0.6914893617021277
	Train acc at iteration 10: 0.7147435897435898
	Val acc at iteration 9: 0.6808510638297872
	Train acc at iteration 11: 0.7419871794871795
	Val acc at iteration 10: 0.6808510638297872
	Train acc at iteration 12: 0.7612179487179487
	Val acc at iteration 11: 0.6595744680851063
	Train acc at iteration 13: 0.7243589743589743
	Val acc at iteration 12: 0.6914893617021277
	Train acc at iteration 14: 0.7724358974358975
	Val acc at iteration 13: 0.6382978723404256
	Train acc at iteration 15: 0.7243589743589743
	Val acc at iteration 14: 0.6170212765957447
	Train acc at iteration 16: 0.7483974358974359
	Val acc at iteration 15: 0.6276595744680851
	Train acc at iteration 17: 0.7211538461538461
	Val acc at iteration 16: 0.6276595744680851
	Train acc at iteration 18: 0.719551282051282
	Val acc at iteration 17: 0.6914893617021277
	Train acc at iteration 19: 0.7644230769230769
	Val acc at iteration 18: 0.6276595744680851
	Train acc at iteration 20: 0.75
	Val acc at iteration 19: 0.6063829787234043
	Train acc at iteration 21: 0.75
	Val acc at iteration 20: 0.6170212765957447
	Train acc at iteration 22: 0.7451923076923077
	Val acc at iteration 21: 0.6170212765957447
	Train acc at iteration 23: 0.7355769230769231
	Val acc at iteration 22: 0.6170212765957447
	Train acc at iteration 24: 0.7259615384615384
	Val acc at iteration 23: 0.6170212765957447
	Train acc at iteration 25: 0.75
	Val acc at iteration 24: 0.5425531914893617
	Train acc at iteration 26: 0.7211538461538461
	Val acc at iteration 25: 0.6276595744680851
	Train acc at iteration 27: 0.7516025641025641
	Val acc at iteration 26: 0.5957446808510638
	Train acc at iteration 28: 0.7596153846153846
	Val acc at iteration 27: 0.5851063829787234
	Train acc at iteration 29: 0.7243589743589743
	Val acc at iteration 28: 0.648936170212766
	Train acc at iteration 30: 0.7451923076923077
	Val acc at iteration 29: 0.648936170212766
	Train acc at iteration 31: 0.7435897435897436
	Val acc at iteration 30: 0.6702127659574468
	Train acc at iteration 32: 0.7355769230769231
	Val acc at iteration 31: 0.7127659574468085
	Train acc at iteration 33: 0.7467948717948718
	Val acc at iteration 32: 0.5957446808510638
	Train acc at iteration 34: 0.7227564102564102
	Val acc at iteration 33: 0.648936170212766
	Train acc at iteration 35: 0.7532051282051282
	Val acc at iteration 34: 0.6382978723404256
	Train acc at iteration 36: 0.7387820512820513
	Val acc at iteration 35: 0.6382978723404256
	Train acc at iteration 37: 0.7419871794871795
	Val acc at iteration 36: 0.6170212765957447
	Train acc at iteration 38: 0.7387820512820513
	Val acc at iteration 37: 0.6702127659574468
	Train acc at iteration 39: 0.7692307692307693
	Val acc at iteration 38: 0.6808510638297872
	Train acc at iteration 40: 0.7596153846153846
	Val acc at iteration 39: 0.5851063829787234
	Train acc at iteration 41: 0.7724358974358975
	Val acc at iteration 40: 0.6382978723404256
	Train acc at iteration 42: 0.75
	Val acc at iteration 41: 0.6063829787234043
	Train acc at iteration 43: 0.7099358974358975
	Val acc at iteration 42: 0.648936170212766
	Train acc at iteration 44: 0.7467948717948718
	Val acc at iteration 43: 0.6382978723404256
	Train acc at iteration 45: 0.7788461538461539
	Val acc at iteration 44: 0.6914893617021277
	Train acc at iteration 46: 0.7147435897435898
	Val acc at iteration 45: 0.648936170212766
	Train acc at iteration 47: 0.7788461538461539
	Val acc at iteration 46: 0.574468085106383
	Train acc at iteration 48: 0.7612179487179487
	Val acc at iteration 47: 0.7127659574468085
	Train acc at iteration 49: 0.7403846153846154
	Val acc at iteration 48: 0.6170212765957447
	Train acc at iteration 50: 0.7756410256410257
	Val acc at iteration 49: 0.6382978723404256
	Train acc at iteration 51: 0.7403846153846154
	Val acc at iteration 50: 0.6808510638297872
	Train acc at iteration 52: 0.7644230769230769
	Val acc at iteration 51: 0.6170212765957447
	Train acc at iteration 53: 0.7532051282051282
	Val acc at iteration 52: 0.6914893617021277
	Train acc at iteration 54: 0.7852564102564102
	Val acc at iteration 53: 0.7127659574468085
	Train acc at iteration 55: 0.7708333333333334
	Val acc at iteration 54: 0.6063829787234043
	Train acc at iteration 56: 0.7291666666666666
	Val acc at iteration 55: 0.723404255319149
	Train acc at iteration 57: 0.780448717948718
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.7419871794871795
	Val acc at iteration 57: 0.7446808510638298
	Train acc at iteration 59: 0.7259615384615384
	Val acc at iteration 58: 0.648936170212766
	Train acc at iteration 60: 0.7756410256410257
	Val acc at iteration 59: 0.7021276595744681
	Train acc at iteration 61: 0.7371794871794872
	Val acc at iteration 60: 0.6595744680851063
	Train acc at iteration 62: 0.7564102564102564
	Val acc at iteration 61: 0.7553191489361702
	Train acc at iteration 63: 0.7740384615384616
	Val acc at iteration 62: 0.7127659574468085
	Train acc at iteration 64: 0.7451923076923077
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.7756410256410257
	Val acc at iteration 64: 0.5531914893617021
	Train acc at iteration 66: 0.7964743589743589
	Val acc at iteration 65: 0.7021276595744681
	Train acc at iteration 67: 0.7516025641025641
	Val acc at iteration 66: 0.6914893617021277
	Train acc at iteration 68: 0.7644230769230769
	Val acc at iteration 67: 0.6808510638297872
	Train acc at iteration 69: 0.7131410256410257
	Val acc at iteration 68: 0.6808510638297872
	Train acc at iteration 70: 0.7884615384615384
	Val acc at iteration 69: 0.6702127659574468
	Train acc at iteration 71: 0.7724358974358975
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.7964743589743589
	Val acc at iteration 71: 0.6914893617021277
	Train acc at iteration 73: 0.7371794871794872
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.7868589743589743
	Val acc at iteration 73: 0.6702127659574468
	Train acc at iteration 75: 0.7676282051282052
	Val acc at iteration 74: 0.6382978723404256
	Train acc at iteration 76: 0.7532051282051282
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.7756410256410257
	Val acc at iteration 76: 0.723404255319149
	Train acc at iteration 78: 0.7884615384615384
	Val acc at iteration 77: 0.5638297872340425
	Train acc at iteration 79: 0.7980769230769231
	Val acc at iteration 78: 0.6382978723404256
	Train acc at iteration 80: 0.7628205128205128
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.7371794871794872
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.7580128205128205
	Val acc at iteration 81: 0.7021276595744681
	Train acc at iteration 83: 0.7740384615384616
	Val acc at iteration 82: 0.6170212765957447
	Train acc at iteration 84: 0.7612179487179487
	Val acc at iteration 83: 0.7553191489361702
	Train acc at iteration 85: 0.7644230769230769
	Val acc at iteration 84: 0.6276595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5918367346938775
Final val micro accuracy: 0.6914893617021277
Final test macro f1-score: 0.4189473684210526
Final test micro accuracy: 0.5851063829787234
Final validation:
	Cluster: 0.6273766160011292
	Separation: 0.5418913662433624
Final test:
	Cluster: 0.5817210078239441
	Separation: 0.5369089245796204
Saved Results

Attempting combination 32/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.46808510638297873
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.574468085106383
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.6702127659574468
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7403846153846154
	Train Cluster: 0.6347439885139465
	Train Separation: 0.5191205263137817
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6382978723404256
	Val acc at iteration 1: 0.6170212765957447
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.5851063829787234
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6063829787234043
	Val acc at iteration 6: 0.7446808510638298
	Val acc at iteration 7: 0.6382978723404256
	Val acc at iteration 8: 0.6914893617021277
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.574468085106383
	Val acc at iteration 16: 0.6702127659574468
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6063829787234043
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.6170212765957447
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.5212765957446809
	Val acc at iteration 25: 0.6595744680851063
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.5212765957446809
	Val acc at iteration 29: 0.6170212765957447
	Val acc at iteration 30: 0.5638297872340425
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.6276595744680851
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.6276595744680851
	Val acc at iteration 38: 0.6170212765957447
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.6063829787234043
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.5957446808510638
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.5851063829787234
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.6914893617021277
	Val acc at iteration 47: 0.5531914893617021
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.5851063829787234
	Val acc at iteration 53: 0.6170212765957447
	Val acc at iteration 54: 0.6595744680851063
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.574468085106383
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.6170212765957447
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.5851063829787234
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.6170212765957447
	Val acc at iteration 66: 0.6382978723404256
	Val acc at iteration 67: 0.5531914893617021
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.6276595744680851
	Val acc at iteration 71: 0.6382978723404256
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.6382978723404256
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.6170212765957447
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.5851063829787234
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.648936170212766
	Val acc at iteration 82: 0.6382978723404256
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.6276595744680851
Val acc before epoch 13: 0.6063829787234043
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7553191489361702
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Train Cluster: 0.6491999745368957
	Train Separation: 0.5218649864196777
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6276595744680851
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6382978723404256
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7659574468085106
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.6276595744680851
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.5638297872340425
	Val acc at iteration 19: 0.6063829787234043
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.7553191489361702
	Val acc at iteration 23: 0.6595744680851063
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.6702127659574468
	Val acc at iteration 27: 0.723404255319149
	Val acc at iteration 28: 0.6063829787234043
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.648936170212766
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.7340425531914894
	Val acc at iteration 34: 0.6595744680851063
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.6595744680851063
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.6170212765957447
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.5957446808510638
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.6382978723404256
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.6702127659574468
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.648936170212766
	Val acc at iteration 57: 0.6276595744680851
	Val acc at iteration 58: 0.6276595744680851
	Val acc at iteration 59: 0.7659574468085106
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.723404255319149
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.6063829787234043
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.723404255319149
	Val acc at iteration 71: 0.6914893617021277
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.6382978723404256
	Val acc at iteration 74: 0.6170212765957447
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.5957446808510638
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.6808510638297872
	Val acc at iteration 83: 0.7021276595744681
	Val acc at iteration 84: 0.5851063829787234
Val acc before epoch 25: 0.6276595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8404255319148937
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9468085106382979
Stopping after epoch 37.
Final validation accuracy before push: 94.68085106382979%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Train Cluster: 0.6540935158729553
	TrainSeparation: 0.523865032196045
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer
Last layer lr: 0.005
	Train acc at iteration 1: 0.7884615384615384
	Val acc at iteration 0: 0.6808510638297872
	Train acc at iteration 2: 0.7628205128205128
	Val acc at iteration 1: 0.6063829787234043
	Train acc at iteration 3: 0.7772435897435898
	Val acc at iteration 2: 0.6702127659574468
	Train acc at iteration 4: 0.780448717948718
	Val acc at iteration 3: 0.6702127659574468
	Train acc at iteration 5: 0.7307692307692307
	Val acc at iteration 4: 0.5957446808510638
	Train acc at iteration 6: 0.7692307692307693
	Val acc at iteration 5: 0.6914893617021277
	Train acc at iteration 7: 0.7788461538461539
	Val acc at iteration 6: 0.7127659574468085
	Train acc at iteration 8: 0.7644230769230769
	Val acc at iteration 7: 0.6914893617021277
	Train acc at iteration 9: 0.7548076923076923
	Val acc at iteration 8: 0.7021276595744681
	Train acc at iteration 10: 0.7548076923076923
	Val acc at iteration 9: 0.6595744680851063
	Train acc at iteration 11: 0.7483974358974359
	Val acc at iteration 10: 0.6702127659574468
	Train acc at iteration 12: 0.7836538461538461
	Val acc at iteration 11: 0.723404255319149
	Train acc at iteration 13: 0.7355769230769231
	Val acc at iteration 12: 0.7127659574468085
	Train acc at iteration 14: 0.8012820512820513
	Val acc at iteration 13: 0.648936170212766
	Train acc at iteration 15: 0.7964743589743589
	Val acc at iteration 14: 0.5851063829787234
	Train acc at iteration 16: 0.7708333333333334
	Val acc at iteration 15: 0.6276595744680851
	Train acc at iteration 17: 0.7724358974358975
	Val acc at iteration 16: 0.648936170212766
	Train acc at iteration 18: 0.7644230769230769
	Val acc at iteration 17: 0.6808510638297872
	Train acc at iteration 19: 0.7628205128205128
	Val acc at iteration 18: 0.6382978723404256
	Train acc at iteration 20: 0.780448717948718
	Val acc at iteration 19: 0.648936170212766
	Train acc at iteration 21: 0.7756410256410257
	Val acc at iteration 20: 0.6808510638297872
	Train acc at iteration 22: 0.7435897435897436
	Val acc at iteration 21: 0.648936170212766
	Train acc at iteration 23: 0.8044871794871795
	Val acc at iteration 22: 0.6595744680851063
	Train acc at iteration 24: 0.7708333333333334
	Val acc at iteration 23: 0.7127659574468085
	Train acc at iteration 25: 0.7708333333333334
	Val acc at iteration 24: 0.6276595744680851
	Train acc at iteration 26: 0.782051282051282
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.7724358974358975
	Val acc at iteration 26: 0.6595744680851063
	Train acc at iteration 28: 0.8076923076923077
	Val acc at iteration 27: 0.7553191489361702
	Train acc at iteration 29: 0.7708333333333334
	Val acc at iteration 28: 0.6595744680851063
	Train acc at iteration 30: 0.7596153846153846
	Val acc at iteration 29: 0.7446808510638298
	Train acc at iteration 31: 0.7788461538461539
	Val acc at iteration 30: 0.6702127659574468
	Train acc at iteration 32: 0.782051282051282
	Val acc at iteration 31: 0.7021276595744681
	Train acc at iteration 33: 0.8044871794871795
	Val acc at iteration 32: 0.5957446808510638
	Train acc at iteration 34: 0.75
	Val acc at iteration 33: 0.723404255319149
	Train acc at iteration 35: 0.7724358974358975
	Val acc at iteration 34: 0.6808510638297872
	Train acc at iteration 36: 0.780448717948718
	Val acc at iteration 35: 0.6170212765957447
	Train acc at iteration 37: 0.7772435897435898
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.7916666666666666
	Val acc at iteration 37: 0.7127659574468085
	Train acc at iteration 39: 0.7612179487179487
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.7916666666666666
	Val acc at iteration 39: 0.6702127659574468
	Train acc at iteration 41: 0.7676282051282052
	Val acc at iteration 40: 0.6914893617021277
	Train acc at iteration 42: 0.7580128205128205
	Val acc at iteration 41: 0.7021276595744681
	Train acc at iteration 43: 0.7852564102564102
	Val acc at iteration 42: 0.7021276595744681
	Train acc at iteration 44: 0.7884615384615384
	Val acc at iteration 43: 0.6382978723404256
	Train acc at iteration 45: 0.7564102564102564
	Val acc at iteration 44: 0.6276595744680851
	Train acc at iteration 46: 0.780448717948718
	Val acc at iteration 45: 0.648936170212766
	Train acc at iteration 47: 0.7612179487179487
	Val acc at iteration 46: 0.6063829787234043
	Train acc at iteration 48: 0.782051282051282
	Val acc at iteration 47: 0.6276595744680851
	Train acc at iteration 49: 0.7740384615384616
	Val acc at iteration 48: 0.6276595744680851
	Train acc at iteration 50: 0.7483974358974359
	Val acc at iteration 49: 0.723404255319149
	Train acc at iteration 51: 0.7676282051282052
	Val acc at iteration 50: 0.6276595744680851
	Train acc at iteration 52: 0.7355769230769231
	Val acc at iteration 51: 0.5531914893617021
	Train acc at iteration 53: 0.7692307692307693
	Val acc at iteration 52: 0.7127659574468085
	Train acc at iteration 54: 0.7724358974358975
	Val acc at iteration 53: 0.5638297872340425
	Train acc at iteration 55: 0.7836538461538461
	Val acc at iteration 54: 0.7127659574468085
	Train acc at iteration 56: 0.7580128205128205
	Val acc at iteration 55: 0.648936170212766
	Train acc at iteration 57: 0.7692307692307693
	Val acc at iteration 56: 0.6914893617021277
	Train acc at iteration 58: 0.7548076923076923
	Val acc at iteration 57: 0.6276595744680851
	Train acc at iteration 59: 0.7660256410256411
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.7676282051282052
	Val acc at iteration 59: 0.723404255319149
	Train acc at iteration 61: 0.782051282051282
	Val acc at iteration 60: 0.648936170212766
	Train acc at iteration 62: 0.7708333333333334
	Val acc at iteration 61: 0.6595744680851063
	Train acc at iteration 63: 0.7451923076923077
	Val acc at iteration 62: 0.723404255319149
	Train acc at iteration 64: 0.7884615384615384
	Val acc at iteration 63: 0.6170212765957447
	Train acc at iteration 65: 0.7516025641025641
	Val acc at iteration 64: 0.6276595744680851
	Train acc at iteration 66: 0.7884615384615384
	Val acc at iteration 65: 0.7021276595744681
	Train acc at iteration 67: 0.7724358974358975
	Val acc at iteration 66: 0.6914893617021277
	Train acc at iteration 68: 0.7948717948717948
	Val acc at iteration 67: 0.7021276595744681
	Train acc at iteration 69: 0.7516025641025641
	Val acc at iteration 68: 0.6595744680851063
	Train acc at iteration 70: 0.7612179487179487
	Val acc at iteration 69: 0.6595744680851063
	Train acc at iteration 71: 0.7900641025641025
	Val acc at iteration 70: 0.6702127659574468
	Train acc at iteration 72: 0.7548076923076923
	Val acc at iteration 71: 0.5957446808510638
	Train acc at iteration 73: 0.7516025641025641
	Val acc at iteration 72: 0.6382978723404256
	Train acc at iteration 74: 0.7916666666666666
	Val acc at iteration 73: 0.6914893617021277
	Train acc at iteration 75: 0.7548076923076923
	Val acc at iteration 74: 0.6595744680851063
	Train acc at iteration 76: 0.7628205128205128
	Val acc at iteration 75: 0.6276595744680851
	Train acc at iteration 77: 0.7852564102564102
	Val acc at iteration 76: 0.7021276595744681
	Train acc at iteration 78: 0.7756410256410257
	Val acc at iteration 77: 0.6595744680851063
	Train acc at iteration 79: 0.7644230769230769
	Val acc at iteration 78: 0.6595744680851063
	Train acc at iteration 80: 0.7868589743589743
	Val acc at iteration 79: 0.648936170212766
	Train acc at iteration 81: 0.7676282051282052
	Val acc at iteration 80: 0.7553191489361702
	Train acc at iteration 82: 0.7964743589743589
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7644230769230769
	Val acc at iteration 82: 0.6382978723404256
	Train acc at iteration 84: 0.7788461538461539
	Val acc at iteration 83: 0.6063829787234043
	Train acc at iteration 85: 0.7692307692307693
	Val acc at iteration 84: 0.7127659574468085
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.6280701754385964
Final val micro accuracy: 0.7340425531914894
Final test macro f1-score: 0.4722807017543859
Final test micro accuracy: 0.6170212765957447
Final validation:
	Cluster: 0.6240150630474091
	Separation: 0.5343426167964935
Final test:
	Cluster: 0.599994421005249
	Separation: 0.5411253273487091
Saved Results

Attempting combination 33/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.425531914893617
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8191489361702128
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9148936170212766
Push epoch
After push, before retraining last layer:
	Train acc: 0.7612179487179487
	Train Cluster: 0.64528489112854
	Train Separation: 0.5192069172859192
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.574468085106383
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6276595744680851
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6170212765957447
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.6276595744680851
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.6063829787234043
	Val acc at iteration 15: 0.6063829787234043
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.7021276595744681
	Val acc at iteration 19: 0.6170212765957447
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.7659574468085106
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6276595744680851
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.5957446808510638
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6382978723404256
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.5531914893617021
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.6063829787234043
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.5531914893617021
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6914893617021277
	Val acc at iteration 39: 0.6063829787234043
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.5851063829787234
	Val acc at iteration 44: 0.6170212765957447
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.6595744680851063
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.574468085106383
	Val acc at iteration 49: 0.6276595744680851
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.5957446808510638
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.48936170212765956
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.648936170212766
	Val acc at iteration 58: 0.6702127659574468
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.648936170212766
	Val acc at iteration 61: 0.6914893617021277
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.7021276595744681
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.6382978723404256
	Val acc at iteration 66: 0.6382978723404256
	Val acc at iteration 67: 0.6063829787234043
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.648936170212766
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.6595744680851063
	Val acc at iteration 72: 0.6382978723404256
	Val acc at iteration 73: 0.6808510638297872
	Val acc at iteration 74: 0.5851063829787234
	Val acc at iteration 75: 0.6170212765957447
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.7127659574468085
	Val acc at iteration 78: 0.6063829787234043
	Val acc at iteration 79: 0.5957446808510638
	Val acc at iteration 80: 0.6170212765957447
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.5957446808510638
	Val acc at iteration 83: 0.574468085106383
	Val acc at iteration 84: 0.6063829787234043
Val acc before epoch 13: 0.6914893617021277
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9042553191489362
Push epoch
After push, before retraining last layer:
	Train acc: 0.7836538461538461
	Train Cluster: 0.6475038528442383
	Train Separation: 0.518472146987915
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6595744680851063
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6170212765957447
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6702127659574468
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6595744680851063
	Val acc at iteration 19: 0.6276595744680851
	Val acc at iteration 20: 0.723404255319149
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.6702127659574468
	Val acc at iteration 30: 0.6808510638297872
	Val acc at iteration 31: 0.5851063829787234
	Val acc at iteration 32: 0.6914893617021277
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6276595744680851
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.5851063829787234
	Val acc at iteration 43: 0.7446808510638298
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.7127659574468085
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.6276595744680851
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.6702127659574468
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.6914893617021277
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.6382978723404256
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.6914893617021277
	Val acc at iteration 59: 0.6595744680851063
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.6808510638297872
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.6276595744680851
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.6914893617021277
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.6382978723404256
	Val acc at iteration 77: 0.6595744680851063
	Val acc at iteration 78: 0.648936170212766
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.7553191489361702
	Val acc at iteration 83: 0.6914893617021277
	Val acc at iteration 84: 0.6702127659574468
Val acc before epoch 25: 0.648936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.925531914893617
Stopping after epoch 37.
Final validation accuracy before push: 92.5531914893617%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7580128205128205
	Train Cluster: 0.6445303797721863
	TrainSeparation: 0.5233194828033447
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.001
	Train acc at iteration 1: 0.7788461538461539
	Val acc at iteration 0: 0.6808510638297872
	Train acc at iteration 2: 0.782051282051282
	Val acc at iteration 1: 0.7127659574468085
	Train acc at iteration 3: 0.7932692307692307
	Val acc at iteration 2: 0.6276595744680851
	Train acc at iteration 4: 0.7756410256410257
	Val acc at iteration 3: 0.6382978723404256
	Train acc at iteration 5: 0.7756410256410257
	Val acc at iteration 4: 0.6808510638297872
	Train acc at iteration 6: 0.7884615384615384
	Val acc at iteration 5: 0.6914893617021277
	Train acc at iteration 7: 0.7740384615384616
	Val acc at iteration 6: 0.7872340425531915
	Train acc at iteration 8: 0.780448717948718
	Val acc at iteration 7: 0.7127659574468085
	Train acc at iteration 9: 0.7740384615384616
	Val acc at iteration 8: 0.6914893617021277
	Train acc at iteration 10: 0.7836538461538461
	Val acc at iteration 9: 0.6808510638297872
	Train acc at iteration 11: 0.7596153846153846
	Val acc at iteration 10: 0.6808510638297872
	Train acc at iteration 12: 0.7964743589743589
	Val acc at iteration 11: 0.6914893617021277
	Train acc at iteration 13: 0.7868589743589743
	Val acc at iteration 12: 0.6914893617021277
	Train acc at iteration 14: 0.7596153846153846
	Val acc at iteration 13: 0.6914893617021277
	Train acc at iteration 15: 0.8044871794871795
	Val acc at iteration 14: 0.6914893617021277
	Train acc at iteration 16: 0.7884615384615384
	Val acc at iteration 15: 0.7021276595744681
	Train acc at iteration 17: 0.7852564102564102
	Val acc at iteration 16: 0.648936170212766
	Train acc at iteration 18: 0.780448717948718
	Val acc at iteration 17: 0.6808510638297872
	Train acc at iteration 19: 0.7419871794871795
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.7996794871794872
	Val acc at iteration 19: 0.7021276595744681
	Train acc at iteration 21: 0.7676282051282052
	Val acc at iteration 20: 0.648936170212766
	Train acc at iteration 22: 0.7788461538461539
	Val acc at iteration 21: 0.7340425531914894
	Train acc at iteration 23: 0.7788461538461539
	Val acc at iteration 22: 0.723404255319149
	Train acc at iteration 24: 0.7884615384615384
	Val acc at iteration 23: 0.6170212765957447
	Train acc at iteration 25: 0.7644230769230769
	Val acc at iteration 24: 0.6276595744680851
	Train acc at iteration 26: 0.7772435897435898
	Val acc at iteration 25: 0.6276595744680851
	Train acc at iteration 27: 0.7772435897435898
	Val acc at iteration 26: 0.7340425531914894
	Train acc at iteration 28: 0.7740384615384616
	Val acc at iteration 27: 0.6808510638297872
	Train acc at iteration 29: 0.7628205128205128
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.7772435897435898
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.7628205128205128
	Val acc at iteration 30: 0.7127659574468085
	Train acc at iteration 32: 0.780448717948718
	Val acc at iteration 31: 0.6702127659574468
	Train acc at iteration 33: 0.7580128205128205
	Val acc at iteration 32: 0.723404255319149
	Train acc at iteration 34: 0.7532051282051282
	Val acc at iteration 33: 0.648936170212766
	Train acc at iteration 35: 0.7708333333333334
	Val acc at iteration 34: 0.6276595744680851
	Train acc at iteration 36: 0.7644230769230769
	Val acc at iteration 35: 0.7127659574468085
	Train acc at iteration 37: 0.7596153846153846
	Val acc at iteration 36: 0.6914893617021277
	Train acc at iteration 38: 0.7916666666666666
	Val acc at iteration 37: 0.6595744680851063
	Train acc at iteration 39: 0.7868589743589743
	Val acc at iteration 38: 0.7446808510638298
	Train acc at iteration 40: 0.7884615384615384
	Val acc at iteration 39: 0.6808510638297872
	Train acc at iteration 41: 0.7932692307692307
	Val acc at iteration 40: 0.574468085106383
	Train acc at iteration 42: 0.7884615384615384
	Val acc at iteration 41: 0.7872340425531915
	Train acc at iteration 43: 0.8012820512820513
	Val acc at iteration 42: 0.6595744680851063
	Train acc at iteration 44: 0.7660256410256411
	Val acc at iteration 43: 0.723404255319149
	Train acc at iteration 45: 0.7708333333333334
	Val acc at iteration 44: 0.7553191489361702
	Train acc at iteration 46: 0.7788461538461539
	Val acc at iteration 45: 0.7340425531914894
	Train acc at iteration 47: 0.7596153846153846
	Val acc at iteration 46: 0.6595744680851063
	Train acc at iteration 48: 0.7948717948717948
	Val acc at iteration 47: 0.6914893617021277
	Train acc at iteration 49: 0.7692307692307693
	Val acc at iteration 48: 0.5957446808510638
	Train acc at iteration 50: 0.7836538461538461
	Val acc at iteration 49: 0.6595744680851063
	Train acc at iteration 51: 0.7724358974358975
	Val acc at iteration 50: 0.6595744680851063
	Train acc at iteration 52: 0.7868589743589743
	Val acc at iteration 51: 0.6702127659574468
	Train acc at iteration 53: 0.7676282051282052
	Val acc at iteration 52: 0.648936170212766
	Train acc at iteration 54: 0.7836538461538461
	Val acc at iteration 53: 0.723404255319149
	Train acc at iteration 55: 0.7756410256410257
	Val acc at iteration 54: 0.6702127659574468
	Train acc at iteration 56: 0.7980769230769231
	Val acc at iteration 55: 0.6702127659574468
	Train acc at iteration 57: 0.7788461538461539
	Val acc at iteration 56: 0.7446808510638298
	Train acc at iteration 58: 0.7900641025641025
	Val acc at iteration 57: 0.6702127659574468
	Train acc at iteration 59: 0.7772435897435898
	Val acc at iteration 58: 0.6063829787234043
	Train acc at iteration 60: 0.7628205128205128
	Val acc at iteration 59: 0.6595744680851063
	Train acc at iteration 61: 0.782051282051282
	Val acc at iteration 60: 0.6595744680851063
	Train acc at iteration 62: 0.780448717948718
	Val acc at iteration 61: 0.6808510638297872
	Train acc at iteration 63: 0.7676282051282052
	Val acc at iteration 62: 0.6276595744680851
	Train acc at iteration 64: 0.780448717948718
	Val acc at iteration 63: 0.6595744680851063
	Train acc at iteration 65: 0.7676282051282052
	Val acc at iteration 64: 0.6595744680851063
	Train acc at iteration 66: 0.7708333333333334
	Val acc at iteration 65: 0.6170212765957447
	Train acc at iteration 67: 0.7788461538461539
	Val acc at iteration 66: 0.6382978723404256
	Train acc at iteration 68: 0.7580128205128205
	Val acc at iteration 67: 0.6063829787234043
	Train acc at iteration 69: 0.8044871794871795
	Val acc at iteration 68: 0.5957446808510638
	Train acc at iteration 70: 0.7692307692307693
	Val acc at iteration 69: 0.5851063829787234
	Train acc at iteration 71: 0.780448717948718
	Val acc at iteration 70: 0.6914893617021277
	Train acc at iteration 72: 0.7884615384615384
	Val acc at iteration 71: 0.7021276595744681
	Train acc at iteration 73: 0.7676282051282052
	Val acc at iteration 72: 0.6914893617021277
	Train acc at iteration 74: 0.7788461538461539
	Val acc at iteration 73: 0.6170212765957447
	Train acc at iteration 75: 0.7724358974358975
	Val acc at iteration 74: 0.6382978723404256
	Train acc at iteration 76: 0.7387820512820513
	Val acc at iteration 75: 0.7127659574468085
	Train acc at iteration 77: 0.7419871794871795
	Val acc at iteration 76: 0.6702127659574468
	Train acc at iteration 78: 0.7772435897435898
	Val acc at iteration 77: 0.7021276595744681
	Train acc at iteration 79: 0.7580128205128205
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.782051282051282
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.7435897435897436
	Val acc at iteration 80: 0.6595744680851063
	Train acc at iteration 82: 0.7772435897435898
	Val acc at iteration 81: 0.5638297872340425
	Train acc at iteration 83: 0.780448717948718
	Val acc at iteration 82: 0.6808510638297872
	Train acc at iteration 84: 0.7628205128205128
	Val acc at iteration 83: 0.6914893617021277
	Train acc at iteration 85: 0.7948717948717948
	Val acc at iteration 84: 0.6595744680851063
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5907590759075907
Final val micro accuracy: 0.7021276595744681
Final test macro f1-score: 0.44891304347826083
Final test micro accuracy: 0.5638297872340425
Final validation:
	Cluster: 0.6356980502605438
	Separation: 0.536077231168747
Final test:
	Cluster: 0.5927161872386932
	Separation: 0.53840371966362
Saved Results

Attempting combination 34/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0005
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.5
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8617021276595744
Push epoch
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.6367487072944641
	Train Separation: 0.5184540390968323
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5957446808510638
	Val acc at iteration 1: 0.5531914893617021
	Val acc at iteration 2: 0.5851063829787234
	Val acc at iteration 3: 0.5851063829787234
	Val acc at iteration 4: 0.6063829787234043
	Val acc at iteration 5: 0.5957446808510638
	Val acc at iteration 6: 0.5106382978723404
	Val acc at iteration 7: 0.6063829787234043
	Val acc at iteration 8: 0.5957446808510638
	Val acc at iteration 9: 0.6063829787234043
	Val acc at iteration 10: 0.5851063829787234
	Val acc at iteration 11: 0.5851063829787234
	Val acc at iteration 12: 0.6702127659574468
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.5638297872340425
	Val acc at iteration 15: 0.5957446808510638
	Val acc at iteration 16: 0.574468085106383
	Val acc at iteration 17: 0.5851063829787234
	Val acc at iteration 18: 0.5957446808510638
	Val acc at iteration 19: 0.5425531914893617
	Val acc at iteration 20: 0.5531914893617021
	Val acc at iteration 21: 0.574468085106383
	Val acc at iteration 22: 0.574468085106383
	Val acc at iteration 23: 0.5425531914893617
	Val acc at iteration 24: 0.5957446808510638
	Val acc at iteration 25: 0.574468085106383
	Val acc at iteration 26: 0.6595744680851063
	Val acc at iteration 27: 0.6595744680851063
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.5638297872340425
	Val acc at iteration 30: 0.5212765957446809
	Val acc at iteration 31: 0.5957446808510638
	Val acc at iteration 32: 0.5957446808510638
	Val acc at iteration 33: 0.5425531914893617
	Val acc at iteration 34: 0.5638297872340425
	Val acc at iteration 35: 0.6063829787234043
	Val acc at iteration 36: 0.6914893617021277
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.6170212765957447
	Val acc at iteration 41: 0.6276595744680851
	Val acc at iteration 42: 0.5957446808510638
	Val acc at iteration 43: 0.5957446808510638
	Val acc at iteration 44: 0.5957446808510638
	Val acc at iteration 45: 0.5319148936170213
	Val acc at iteration 46: 0.6170212765957447
	Val acc at iteration 47: 0.6063829787234043
	Val acc at iteration 48: 0.6276595744680851
	Val acc at iteration 49: 0.6276595744680851
	Val acc at iteration 50: 0.5851063829787234
	Val acc at iteration 51: 0.6170212765957447
	Val acc at iteration 52: 0.5957446808510638
	Val acc at iteration 53: 0.6170212765957447
	Val acc at iteration 54: 0.6063829787234043
	Val acc at iteration 55: 0.6808510638297872
	Val acc at iteration 56: 0.5531914893617021
	Val acc at iteration 57: 0.5106382978723404
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.5957446808510638
	Val acc at iteration 60: 0.6382978723404256
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.648936170212766
	Val acc at iteration 63: 0.6382978723404256
	Val acc at iteration 64: 0.6063829787234043
	Val acc at iteration 65: 0.6382978723404256
	Val acc at iteration 66: 0.6382978723404256
	Val acc at iteration 67: 0.5212765957446809
	Val acc at iteration 68: 0.6170212765957447
	Val acc at iteration 69: 0.5851063829787234
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.5957446808510638
	Val acc at iteration 72: 0.6170212765957447
	Val acc at iteration 73: 0.574468085106383
	Val acc at iteration 74: 0.574468085106383
	Val acc at iteration 75: 0.5531914893617021
	Val acc at iteration 76: 0.574468085106383
	Val acc at iteration 77: 0.5531914893617021
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6382978723404256
	Val acc at iteration 80: 0.5851063829787234
	Val acc at iteration 81: 0.5425531914893617
	Val acc at iteration 82: 0.5212765957446809
	Val acc at iteration 83: 0.6276595744680851
	Val acc at iteration 84: 0.5957446808510638
Val acc before epoch 13: 0.5851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7872340425531915
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.7659574468085106
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.7553191489361702
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7740384615384616
	Train Cluster: 0.648847472667694
	Train Separation: 0.5194435954093933
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6063829787234043
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6063829787234043
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.5425531914893617
	Val acc at iteration 9: 0.6063829787234043
	Val acc at iteration 10: 0.5638297872340425
	Val acc at iteration 11: 0.5851063829787234
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6276595744680851
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.648936170212766
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.574468085106383
	Val acc at iteration 19: 0.5957446808510638
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6170212765957447
	Val acc at iteration 23: 0.648936170212766
	Val acc at iteration 24: 0.5957446808510638
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.6063829787234043
	Val acc at iteration 27: 0.6808510638297872
	Val acc at iteration 28: 0.5531914893617021
	Val acc at iteration 29: 0.648936170212766
	Val acc at iteration 30: 0.648936170212766
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.648936170212766
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6170212765957447
	Val acc at iteration 37: 0.6382978723404256
	Val acc at iteration 38: 0.5957446808510638
	Val acc at iteration 39: 0.5851063829787234
	Val acc at iteration 40: 0.5425531914893617
	Val acc at iteration 41: 0.6595744680851063
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.5638297872340425
	Val acc at iteration 44: 0.6595744680851063
	Val acc at iteration 45: 0.5531914893617021
	Val acc at iteration 46: 0.6276595744680851
	Val acc at iteration 47: 0.6063829787234043
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.6170212765957447
	Val acc at iteration 50: 0.6382978723404256
	Val acc at iteration 51: 0.5957446808510638
	Val acc at iteration 52: 0.5957446808510638
	Val acc at iteration 53: 0.5531914893617021
	Val acc at iteration 54: 0.5851063829787234
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.6595744680851063
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.5531914893617021
	Val acc at iteration 59: 0.5319148936170213
	Val acc at iteration 60: 0.6170212765957447
	Val acc at iteration 61: 0.6276595744680851
	Val acc at iteration 62: 0.6595744680851063
	Val acc at iteration 63: 0.5957446808510638
	Val acc at iteration 64: 0.5425531914893617
	Val acc at iteration 65: 0.5531914893617021
	Val acc at iteration 66: 0.5212765957446809
	Val acc at iteration 67: 0.6170212765957447
	Val acc at iteration 68: 0.5531914893617021
	Val acc at iteration 69: 0.5957446808510638
	Val acc at iteration 70: 0.5425531914893617
	Val acc at iteration 71: 0.6382978723404256
	Val acc at iteration 72: 0.6808510638297872
	Val acc at iteration 73: 0.6382978723404256
	Val acc at iteration 74: 0.5957446808510638
	Val acc at iteration 75: 0.6276595744680851
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.6382978723404256
	Val acc at iteration 78: 0.6276595744680851
	Val acc at iteration 79: 0.6170212765957447
	Val acc at iteration 80: 0.5851063829787234
	Val acc at iteration 81: 0.5531914893617021
	Val acc at iteration 82: 0.6702127659574468
	Val acc at iteration 83: 0.6170212765957447
	Val acc at iteration 84: 0.6170212765957447
Val acc before epoch 25: 0.6702127659574468
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8297872340425532
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8191489361702128
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9148936170212766
Stopping after epoch 37.
Final validation accuracy before push: 91.48936170212765%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7724358974358975
	Train Cluster: 0.646483314037323
	TrainSeparation: 0.5171479225158692
(Directly after push) Val acc at iteration 0: 0.5531914893617021
Retraining last layer
Last layer lr: 0.0005
	Train acc at iteration 1: 0.7644230769230769
	Val acc at iteration 0: 0.5638297872340425
	Train acc at iteration 2: 0.7532051282051282
	Val acc at iteration 1: 0.6702127659574468
	Train acc at iteration 3: 0.7740384615384616
	Val acc at iteration 2: 0.648936170212766
	Train acc at iteration 4: 0.7756410256410257
	Val acc at iteration 3: 0.648936170212766
	Train acc at iteration 5: 0.7532051282051282
	Val acc at iteration 4: 0.648936170212766
	Train acc at iteration 6: 0.782051282051282
	Val acc at iteration 5: 0.6382978723404256
	Train acc at iteration 7: 0.7788461538461539
	Val acc at iteration 6: 0.6382978723404256
	Train acc at iteration 8: 0.7580128205128205
	Val acc at iteration 7: 0.6702127659574468
	Train acc at iteration 9: 0.7580128205128205
	Val acc at iteration 8: 0.5851063829787234
	Train acc at iteration 10: 0.7724358974358975
	Val acc at iteration 9: 0.6382978723404256
	Train acc at iteration 11: 0.7740384615384616
	Val acc at iteration 10: 0.5957446808510638
	Train acc at iteration 12: 0.7676282051282052
	Val acc at iteration 11: 0.5851063829787234
	Train acc at iteration 13: 0.7756410256410257
	Val acc at iteration 12: 0.5957446808510638
	Train acc at iteration 14: 0.7596153846153846
	Val acc at iteration 13: 0.6382978723404256
	Train acc at iteration 15: 0.7612179487179487
	Val acc at iteration 14: 0.5851063829787234
	Train acc at iteration 16: 0.7516025641025641
	Val acc at iteration 15: 0.6063829787234043
	Train acc at iteration 17: 0.7852564102564102
	Val acc at iteration 16: 0.6702127659574468
	Train acc at iteration 18: 0.7628205128205128
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.7740384615384616
	Val acc at iteration 18: 0.5851063829787234
	Train acc at iteration 20: 0.7692307692307693
	Val acc at iteration 19: 0.6382978723404256
	Train acc at iteration 21: 0.7628205128205128
	Val acc at iteration 20: 0.5957446808510638
	Train acc at iteration 22: 0.7772435897435898
	Val acc at iteration 21: 0.5957446808510638
	Train acc at iteration 23: 0.7660256410256411
	Val acc at iteration 22: 0.7340425531914894
	Train acc at iteration 24: 0.780448717948718
	Val acc at iteration 23: 0.7127659574468085
	Train acc at iteration 25: 0.7964743589743589
	Val acc at iteration 24: 0.5957446808510638
	Train acc at iteration 26: 0.7724358974358975
	Val acc at iteration 25: 0.6170212765957447
	Train acc at iteration 27: 0.7724358974358975
	Val acc at iteration 26: 0.6702127659574468
	Train acc at iteration 28: 0.7724358974358975
	Val acc at iteration 27: 0.6382978723404256
	Train acc at iteration 29: 0.7996794871794872
	Val acc at iteration 28: 0.6382978723404256
	Train acc at iteration 30: 0.7532051282051282
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.7724358974358975
	Val acc at iteration 30: 0.6276595744680851
	Train acc at iteration 32: 0.7724358974358975
	Val acc at iteration 31: 0.7553191489361702
	Train acc at iteration 33: 0.7772435897435898
	Val acc at iteration 32: 0.648936170212766
	Train acc at iteration 34: 0.7964743589743589
	Val acc at iteration 33: 0.6063829787234043
	Train acc at iteration 35: 0.7772435897435898
	Val acc at iteration 34: 0.5957446808510638
	Train acc at iteration 36: 0.7724358974358975
	Val acc at iteration 35: 0.6170212765957447
	Train acc at iteration 37: 0.7644230769230769
	Val acc at iteration 36: 0.6382978723404256
	Train acc at iteration 38: 0.7676282051282052
	Val acc at iteration 37: 0.6170212765957447
	Train acc at iteration 39: 0.7355769230769231
	Val acc at iteration 38: 0.7127659574468085
	Train acc at iteration 40: 0.7532051282051282
	Val acc at iteration 39: 0.5957446808510638
	Train acc at iteration 41: 0.7788461538461539
	Val acc at iteration 40: 0.6595744680851063
	Train acc at iteration 42: 0.7628205128205128
	Val acc at iteration 41: 0.5957446808510638
	Train acc at iteration 43: 0.7387820512820513
	Val acc at iteration 42: 0.6276595744680851
	Train acc at iteration 44: 0.7644230769230769
	Val acc at iteration 43: 0.6808510638297872
	Train acc at iteration 45: 0.7724358974358975
	Val acc at iteration 44: 0.5531914893617021
	Train acc at iteration 46: 0.7868589743589743
	Val acc at iteration 45: 0.7021276595744681
	Train acc at iteration 47: 0.7708333333333334
	Val acc at iteration 46: 0.6808510638297872
	Train acc at iteration 48: 0.7756410256410257
	Val acc at iteration 47: 0.6276595744680851
	Train acc at iteration 49: 0.7435897435897436
	Val acc at iteration 48: 0.6170212765957447
	Train acc at iteration 50: 0.7948717948717948
	Val acc at iteration 49: 0.574468085106383
	Train acc at iteration 51: 0.7644230769230769
	Val acc at iteration 50: 0.6702127659574468
	Train acc at iteration 52: 0.7740384615384616
	Val acc at iteration 51: 0.7021276595744681
	Train acc at iteration 53: 0.7724358974358975
	Val acc at iteration 52: 0.6808510638297872
	Train acc at iteration 54: 0.7836538461538461
	Val acc at iteration 53: 0.6382978723404256
	Train acc at iteration 55: 0.7932692307692307
	Val acc at iteration 54: 0.6382978723404256
	Train acc at iteration 56: 0.7868589743589743
	Val acc at iteration 55: 0.5319148936170213
	Train acc at iteration 57: 0.7756410256410257
	Val acc at iteration 56: 0.5957446808510638
	Train acc at iteration 58: 0.7740384615384616
	Val acc at iteration 57: 0.6063829787234043
	Train acc at iteration 59: 0.7596153846153846
	Val acc at iteration 58: 0.648936170212766
	Train acc at iteration 60: 0.7884615384615384
	Val acc at iteration 59: 0.6063829787234043
	Train acc at iteration 61: 0.7932692307692307
	Val acc at iteration 60: 0.5957446808510638
	Train acc at iteration 62: 0.780448717948718
	Val acc at iteration 61: 0.574468085106383
	Train acc at iteration 63: 0.7628205128205128
	Val acc at iteration 62: 0.5638297872340425
	Train acc at iteration 64: 0.7435897435897436
	Val acc at iteration 63: 0.6170212765957447
	Train acc at iteration 65: 0.7836538461538461
	Val acc at iteration 64: 0.6382978723404256
	Train acc at iteration 66: 0.7612179487179487
	Val acc at iteration 65: 0.6808510638297872
	Train acc at iteration 67: 0.7548076923076923
	Val acc at iteration 66: 0.5957446808510638
	Train acc at iteration 68: 0.7756410256410257
	Val acc at iteration 67: 0.6595744680851063
	Train acc at iteration 69: 0.7708333333333334
	Val acc at iteration 68: 0.6382978723404256
	Train acc at iteration 70: 0.7596153846153846
	Val acc at iteration 69: 0.6595744680851063
	Train acc at iteration 71: 0.7676282051282052
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.7644230769230769
	Val acc at iteration 71: 0.6276595744680851
	Train acc at iteration 73: 0.7740384615384616
	Val acc at iteration 72: 0.6595744680851063
	Train acc at iteration 74: 0.7628205128205128
	Val acc at iteration 73: 0.5957446808510638
	Train acc at iteration 75: 0.7788461538461539
	Val acc at iteration 74: 0.5212765957446809
	Train acc at iteration 76: 0.7596153846153846
	Val acc at iteration 75: 0.6063829787234043
	Train acc at iteration 77: 0.7772435897435898
	Val acc at iteration 76: 0.6170212765957447
	Train acc at iteration 78: 0.7724358974358975
	Val acc at iteration 77: 0.6702127659574468
	Train acc at iteration 79: 0.7483974358974359
	Val acc at iteration 78: 0.6382978723404256
	Train acc at iteration 80: 0.7724358974358975
	Val acc at iteration 79: 0.5957446808510638
	Train acc at iteration 81: 0.7532051282051282
	Val acc at iteration 80: 0.6702127659574468
	Train acc at iteration 82: 0.7740384615384616
	Val acc at iteration 81: 0.6382978723404256
	Train acc at iteration 83: 0.7516025641025641
	Val acc at iteration 82: 0.6276595744680851
	Train acc at iteration 84: 0.7788461538461539
	Val acc at iteration 83: 0.6595744680851063
	Train acc at iteration 85: 0.7708333333333334
	Val acc at iteration 84: 0.574468085106383
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.45032051282051283
Final val micro accuracy: 0.5638297872340425
Final test macro f1-score: 0.3696666666666666
Final test micro accuracy: 0.4787234042553192
Final validation:
	Cluster: 0.6056026518344879
	Separation: 0.5450907647609711
Final test:
	Cluster: 0.593437671661377
	Separation: 0.5317686796188354
Saved Results

Attempting combination 35/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.0001
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7323717948717948
	Train Cluster: 0.6365264654159546
	Train Separation: 0.5210398316383362
(Directly after push) Val acc at iteration 0: 0.6170212765957447
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.5851063829787234
	Val acc at iteration 2: 0.5425531914893617
	Val acc at iteration 3: 0.6170212765957447
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.6382978723404256
	Val acc at iteration 6: 0.6170212765957447
	Val acc at iteration 7: 0.6170212765957447
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.574468085106383
	Val acc at iteration 10: 0.6063829787234043
	Val acc at iteration 11: 0.5531914893617021
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.5638297872340425
	Val acc at iteration 14: 0.6276595744680851
	Val acc at iteration 15: 0.6170212765957447
	Val acc at iteration 16: 0.5957446808510638
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.574468085106383
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.5425531914893617
	Val acc at iteration 21: 0.5851063829787234
	Val acc at iteration 22: 0.6382978723404256
	Val acc at iteration 23: 0.5851063829787234
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.5425531914893617
	Val acc at iteration 26: 0.6063829787234043
	Val acc at iteration 27: 0.6170212765957447
	Val acc at iteration 28: 0.6595744680851063
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.574468085106383
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.6702127659574468
	Val acc at iteration 33: 0.6595744680851063
	Val acc at iteration 34: 0.6382978723404256
	Val acc at iteration 35: 0.6063829787234043
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.574468085106383
	Val acc at iteration 38: 0.6170212765957447
	Val acc at iteration 39: 0.6276595744680851
	Val acc at iteration 40: 0.5851063829787234
	Val acc at iteration 41: 0.5957446808510638
	Val acc at iteration 42: 0.6276595744680851
	Val acc at iteration 43: 0.5957446808510638
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.5957446808510638
	Val acc at iteration 46: 0.5531914893617021
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.5638297872340425
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.5319148936170213
	Val acc at iteration 51: 0.6382978723404256
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.574468085106383
	Val acc at iteration 54: 0.6382978723404256
	Val acc at iteration 55: 0.5957446808510638
	Val acc at iteration 56: 0.6063829787234043
	Val acc at iteration 57: 0.574468085106383
	Val acc at iteration 58: 0.5957446808510638
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.5957446808510638
	Val acc at iteration 62: 0.6170212765957447
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.6808510638297872
	Val acc at iteration 66: 0.5851063829787234
	Val acc at iteration 67: 0.5851063829787234
	Val acc at iteration 68: 0.574468085106383
	Val acc at iteration 69: 0.6914893617021277
	Val acc at iteration 70: 0.6595744680851063
	Val acc at iteration 71: 0.5106382978723404
	Val acc at iteration 72: 0.6382978723404256
	Val acc at iteration 73: 0.5957446808510638
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.6063829787234043
	Val acc at iteration 78: 0.5319148936170213
	Val acc at iteration 79: 0.6276595744680851
	Val acc at iteration 80: 0.5851063829787234
	Val acc at iteration 81: 0.648936170212766
	Val acc at iteration 82: 0.5425531914893617
	Val acc at iteration 83: 0.5425531914893617
	Val acc at iteration 84: 0.5957446808510638
Val acc before epoch 13: 0.6063829787234043
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7978723404255319
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8617021276595744
Push epoch
After push, before retraining last layer:
	Train acc: 0.7451923076923077
	Train Cluster: 0.6431676626205445
	Train Separation: 0.5231029868125916
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.5957446808510638
	Val acc at iteration 2: 0.6170212765957447
	Val acc at iteration 3: 0.6276595744680851
	Val acc at iteration 4: 0.6063829787234043
	Val acc at iteration 5: 0.6702127659574468
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.6276595744680851
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.5531914893617021
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.6170212765957447
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.6063829787234043
	Val acc at iteration 17: 0.6170212765957447
	Val acc at iteration 18: 0.5851063829787234
	Val acc at iteration 19: 0.5851063829787234
	Val acc at iteration 20: 0.5638297872340425
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6063829787234043
	Val acc at iteration 23: 0.6170212765957447
	Val acc at iteration 24: 0.5531914893617021
	Val acc at iteration 25: 0.5851063829787234
	Val acc at iteration 26: 0.6595744680851063
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.5851063829787234
	Val acc at iteration 31: 0.6276595744680851
	Val acc at iteration 32: 0.6170212765957447
	Val acc at iteration 33: 0.648936170212766
	Val acc at iteration 34: 0.5319148936170213
	Val acc at iteration 35: 0.5851063829787234
	Val acc at iteration 36: 0.5425531914893617
	Val acc at iteration 37: 0.6276595744680851
	Val acc at iteration 38: 0.6595744680851063
	Val acc at iteration 39: 0.6063829787234043
	Val acc at iteration 40: 0.6170212765957447
	Val acc at iteration 41: 0.6063829787234043
	Val acc at iteration 42: 0.5319148936170213
	Val acc at iteration 43: 0.6063829787234043
	Val acc at iteration 44: 0.6063829787234043
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.5851063829787234
	Val acc at iteration 48: 0.6063829787234043
	Val acc at iteration 49: 0.5957446808510638
	Val acc at iteration 50: 0.5957446808510638
	Val acc at iteration 51: 0.6170212765957447
	Val acc at iteration 52: 0.6702127659574468
	Val acc at iteration 53: 0.6702127659574468
	Val acc at iteration 54: 0.5425531914893617
	Val acc at iteration 55: 0.5531914893617021
	Val acc at iteration 56: 0.6063829787234043
	Val acc at iteration 57: 0.6914893617021277
	Val acc at iteration 58: 0.6382978723404256
	Val acc at iteration 59: 0.648936170212766
	Val acc at iteration 60: 0.574468085106383
	Val acc at iteration 61: 0.5957446808510638
	Val acc at iteration 62: 0.5957446808510638
	Val acc at iteration 63: 0.5851063829787234
	Val acc at iteration 64: 0.6595744680851063
	Val acc at iteration 65: 0.6276595744680851
	Val acc at iteration 66: 0.6276595744680851
	Val acc at iteration 67: 0.6170212765957447
	Val acc at iteration 68: 0.5106382978723404
	Val acc at iteration 69: 0.5425531914893617
	Val acc at iteration 70: 0.5957446808510638
	Val acc at iteration 71: 0.5851063829787234
	Val acc at iteration 72: 0.6063829787234043
	Val acc at iteration 73: 0.6170212765957447
	Val acc at iteration 74: 0.5957446808510638
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.6170212765957447
	Val acc at iteration 77: 0.6063829787234043
	Val acc at iteration 78: 0.5851063829787234
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.5957446808510638
	Val acc at iteration 81: 0.648936170212766
	Val acc at iteration 82: 0.6170212765957447
	Val acc at iteration 83: 0.6808510638297872
	Val acc at iteration 84: 0.5957446808510638
Val acc before epoch 25: 0.6063829787234043
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.776595744680851
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8297872340425532
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.851063829787234
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9042553191489362
Stopping after epoch 37.
Final validation accuracy before push: 90.42553191489363%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7756410256410257
	Train Cluster: 0.6455498099327087
	TrainSeparation: 0.5197422862052917
(Directly after push) Val acc at iteration 0: 0.5851063829787234
Retraining last layer
Last layer lr: 0.0001
	Train acc at iteration 1: 0.7676282051282052
	Val acc at iteration 0: 0.5638297872340425
	Train acc at iteration 2: 0.7628205128205128
	Val acc at iteration 1: 0.5851063829787234
	Train acc at iteration 3: 0.7756410256410257
	Val acc at iteration 2: 0.6063829787234043
	Train acc at iteration 4: 0.780448717948718
	Val acc at iteration 3: 0.5638297872340425
	Train acc at iteration 5: 0.7532051282051282
	Val acc at iteration 4: 0.6914893617021277
	Train acc at iteration 6: 0.7724358974358975
	Val acc at iteration 5: 0.574468085106383
	Train acc at iteration 7: 0.7596153846153846
	Val acc at iteration 6: 0.6063829787234043
	Train acc at iteration 8: 0.7516025641025641
	Val acc at iteration 7: 0.6276595744680851
	Train acc at iteration 9: 0.7660256410256411
	Val acc at iteration 8: 0.6063829787234043
	Train acc at iteration 10: 0.7756410256410257
	Val acc at iteration 9: 0.5851063829787234
	Train acc at iteration 11: 0.7660256410256411
	Val acc at iteration 10: 0.6063829787234043
	Train acc at iteration 12: 0.7708333333333334
	Val acc at iteration 11: 0.6276595744680851
	Train acc at iteration 13: 0.7708333333333334
	Val acc at iteration 12: 0.6063829787234043
	Train acc at iteration 14: 0.7660256410256411
	Val acc at iteration 13: 0.5212765957446809
	Train acc at iteration 15: 0.7644230769230769
	Val acc at iteration 14: 0.6170212765957447
	Train acc at iteration 16: 0.7467948717948718
	Val acc at iteration 15: 0.6063829787234043
	Train acc at iteration 17: 0.7580128205128205
	Val acc at iteration 16: 0.5851063829787234
	Train acc at iteration 18: 0.782051282051282
	Val acc at iteration 17: 0.5319148936170213
	Train acc at iteration 19: 0.7628205128205128
	Val acc at iteration 18: 0.7021276595744681
	Train acc at iteration 20: 0.7580128205128205
	Val acc at iteration 19: 0.5851063829787234
	Train acc at iteration 21: 0.7596153846153846
	Val acc at iteration 20: 0.6382978723404256
	Train acc at iteration 22: 0.7676282051282052
	Val acc at iteration 21: 0.6276595744680851
	Train acc at iteration 23: 0.7548076923076923
	Val acc at iteration 22: 0.6702127659574468
	Train acc at iteration 24: 0.780448717948718
	Val acc at iteration 23: 0.6063829787234043
	Train acc at iteration 25: 0.7660256410256411
	Val acc at iteration 24: 0.6276595744680851
	Train acc at iteration 26: 0.7580128205128205
	Val acc at iteration 25: 0.6276595744680851
	Train acc at iteration 27: 0.7788461538461539
	Val acc at iteration 26: 0.6595744680851063
	Train acc at iteration 28: 0.7403846153846154
	Val acc at iteration 27: 0.6702127659574468
	Train acc at iteration 29: 0.7628205128205128
	Val acc at iteration 28: 0.5851063829787234
	Train acc at iteration 30: 0.7788461538461539
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.75
	Val acc at iteration 30: 0.5957446808510638
	Train acc at iteration 32: 0.7836538461538461
	Val acc at iteration 31: 0.5638297872340425
	Train acc at iteration 33: 0.7596153846153846
	Val acc at iteration 32: 0.6063829787234043
	Train acc at iteration 34: 0.7756410256410257
	Val acc at iteration 33: 0.5851063829787234
	Train acc at iteration 35: 0.7419871794871795
	Val acc at iteration 34: 0.6063829787234043
	Train acc at iteration 36: 0.7516025641025641
	Val acc at iteration 35: 0.5531914893617021
	Train acc at iteration 37: 0.7419871794871795
	Val acc at iteration 36: 0.6170212765957447
	Train acc at iteration 38: 0.7596153846153846
	Val acc at iteration 37: 0.6595744680851063
	Train acc at iteration 39: 0.7516025641025641
	Val acc at iteration 38: 0.6702127659574468
	Train acc at iteration 40: 0.7435897435897436
	Val acc at iteration 39: 0.6170212765957447
	Train acc at iteration 41: 0.7451923076923077
	Val acc at iteration 40: 0.6063829787234043
	Train acc at iteration 42: 0.7628205128205128
	Val acc at iteration 41: 0.6170212765957447
	Train acc at iteration 43: 0.7580128205128205
	Val acc at iteration 42: 0.6276595744680851
	Train acc at iteration 44: 0.7772435897435898
	Val acc at iteration 43: 0.6276595744680851
	Train acc at iteration 45: 0.75
	Val acc at iteration 44: 0.6170212765957447
	Train acc at iteration 46: 0.7355769230769231
	Val acc at iteration 45: 0.5638297872340425
	Train acc at iteration 47: 0.7435897435897436
	Val acc at iteration 46: 0.6382978723404256
	Train acc at iteration 48: 0.7532051282051282
	Val acc at iteration 47: 0.6170212765957447
	Train acc at iteration 49: 0.7564102564102564
	Val acc at iteration 48: 0.5851063829787234
	Train acc at iteration 50: 0.7868589743589743
	Val acc at iteration 49: 0.5851063829787234
	Train acc at iteration 51: 0.7836538461538461
	Val acc at iteration 50: 0.574468085106383
	Train acc at iteration 52: 0.7836538461538461
	Val acc at iteration 51: 0.5319148936170213
	Train acc at iteration 53: 0.7467948717948718
	Val acc at iteration 52: 0.6063829787234043
	Train acc at iteration 54: 0.7788461538461539
	Val acc at iteration 53: 0.5212765957446809
	Train acc at iteration 55: 0.7916666666666666
	Val acc at iteration 54: 0.5851063829787234
	Train acc at iteration 56: 0.7580128205128205
	Val acc at iteration 55: 0.6276595744680851
	Train acc at iteration 57: 0.7435897435897436
	Val acc at iteration 56: 0.6276595744680851
	Train acc at iteration 58: 0.7724358974358975
	Val acc at iteration 57: 0.6276595744680851
	Train acc at iteration 59: 0.7516025641025641
	Val acc at iteration 58: 0.6382978723404256
	Train acc at iteration 60: 0.7740384615384616
	Val acc at iteration 59: 0.574468085106383
	Train acc at iteration 61: 0.7756410256410257
	Val acc at iteration 60: 0.6595744680851063
	Train acc at iteration 62: 0.7419871794871795
	Val acc at iteration 61: 0.6382978723404256
	Train acc at iteration 63: 0.7692307692307693
	Val acc at iteration 62: 0.6914893617021277
	Train acc at iteration 64: 0.780448717948718
	Val acc at iteration 63: 0.6276595744680851
	Train acc at iteration 65: 0.7708333333333334
	Val acc at iteration 64: 0.574468085106383
	Train acc at iteration 66: 0.7756410256410257
	Val acc at iteration 65: 0.6170212765957447
	Train acc at iteration 67: 0.7868589743589743
	Val acc at iteration 66: 0.6808510638297872
	Train acc at iteration 68: 0.7451923076923077
	Val acc at iteration 67: 0.6595744680851063
	Train acc at iteration 69: 0.7884615384615384
	Val acc at iteration 68: 0.5638297872340425
	Train acc at iteration 70: 0.7596153846153846
	Val acc at iteration 69: 0.5957446808510638
	Train acc at iteration 71: 0.7772435897435898
	Val acc at iteration 70: 0.6595744680851063
	Train acc at iteration 72: 0.8028846153846154
	Val acc at iteration 71: 0.6702127659574468
	Train acc at iteration 73: 0.7724358974358975
	Val acc at iteration 72: 0.6914893617021277
	Train acc at iteration 74: 0.75
	Val acc at iteration 73: 0.5851063829787234
	Train acc at iteration 75: 0.7708333333333334
	Val acc at iteration 74: 0.6808510638297872
	Train acc at iteration 76: 0.7596153846153846
	Val acc at iteration 75: 0.5851063829787234
	Train acc at iteration 77: 0.7243589743589743
	Val acc at iteration 76: 0.6170212765957447
	Train acc at iteration 78: 0.7772435897435898
	Val acc at iteration 77: 0.6382978723404256
	Train acc at iteration 79: 0.7532051282051282
	Val acc at iteration 78: 0.6276595744680851
	Train acc at iteration 80: 0.7724358974358975
	Val acc at iteration 79: 0.6702127659574468
	Train acc at iteration 81: 0.7756410256410257
	Val acc at iteration 80: 0.6382978723404256
	Train acc at iteration 82: 0.7564102564102564
	Val acc at iteration 81: 0.6382978723404256
	Train acc at iteration 83: 0.782051282051282
	Val acc at iteration 82: 0.6170212765957447
	Train acc at iteration 84: 0.7227564102564102
	Val acc at iteration 83: 0.5319148936170213
	Train acc at iteration 85: 0.7788461538461539
	Val acc at iteration 84: 0.6276595744680851
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5252525252525252
Final val micro accuracy: 0.6276595744680851
Final test macro f1-score: 0.4695035460992908
Final test micro accuracy: 0.6063829787234043
Final validation:
	Cluster: 0.6154902279376984
	Separation: 0.5403568744659424
Final test:
	Cluster: 0.6088622808456421
	Separation: 0.5417341887950897
Saved Results

Attempting combination 36/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.005
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 5e-05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.776595744680851
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.75
	Train Cluster: 0.6385960578918457
	Train Separation: 0.5163608670234681
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.648936170212766
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6595744680851063
	Val acc at iteration 10: 0.5851063829787234
	Val acc at iteration 11: 0.648936170212766
	Val acc at iteration 12: 0.648936170212766
	Val acc at iteration 13: 0.648936170212766
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6914893617021277
	Val acc at iteration 16: 0.6063829787234043
	Val acc at iteration 17: 0.6063829787234043
	Val acc at iteration 18: 0.7340425531914894
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.6063829787234043
	Val acc at iteration 21: 0.5319148936170213
	Val acc at iteration 22: 0.6063829787234043
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.648936170212766
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.574468085106383
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6595744680851063
	Val acc at iteration 30: 0.6914893617021277
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.5531914893617021
	Val acc at iteration 34: 0.6808510638297872
	Val acc at iteration 35: 0.723404255319149
	Val acc at iteration 36: 0.6276595744680851
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6063829787234043
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.6170212765957447
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.648936170212766
	Val acc at iteration 43: 0.6276595744680851
	Val acc at iteration 44: 0.6382978723404256
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.6276595744680851
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.648936170212766
	Val acc at iteration 51: 0.648936170212766
	Val acc at iteration 52: 0.648936170212766
	Val acc at iteration 53: 0.6595744680851063
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.6276595744680851
	Val acc at iteration 56: 0.574468085106383
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.6063829787234043
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.7340425531914894
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.5957446808510638
	Val acc at iteration 64: 0.5638297872340425
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6063829787234043
	Val acc at iteration 68: 0.6063829787234043
	Val acc at iteration 69: 0.6595744680851063
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.7127659574468085
	Val acc at iteration 72: 0.6382978723404256
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.5957446808510638
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.574468085106383
	Val acc at iteration 78: 0.5851063829787234
	Val acc at iteration 79: 0.6808510638297872
	Val acc at iteration 80: 0.6382978723404256
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.6595744680851063
	Val acc at iteration 83: 0.6063829787234043
	Val acc at iteration 84: 0.5851063829787234
Val acc before epoch 13: 0.6702127659574468
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.776595744680851
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.7872340425531915
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.8404255319148937
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.8829787234042553
Push epoch
After push, before retraining last layer:
	Train acc: 0.7580128205128205
	Train Cluster: 0.6442886114120483
	Train Separation: 0.5176366448402405
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.574468085106383
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6382978723404256
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.6276595744680851
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.6702127659574468
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.574468085106383
	Val acc at iteration 14: 0.5851063829787234
	Val acc at iteration 15: 0.6170212765957447
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.7021276595744681
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.6382978723404256
	Val acc at iteration 24: 0.6170212765957447
	Val acc at iteration 25: 0.5851063829787234
	Val acc at iteration 26: 0.6063829787234043
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.6170212765957447
	Val acc at iteration 32: 0.7127659574468085
	Val acc at iteration 33: 0.6063829787234043
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6276595744680851
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.648936170212766
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.6702127659574468
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.5851063829787234
	Val acc at iteration 47: 0.6170212765957447
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.7127659574468085
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.5957446808510638
	Val acc at iteration 53: 0.7021276595744681
	Val acc at iteration 54: 0.648936170212766
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.6063829787234043
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.6595744680851063
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.6702127659574468
	Val acc at iteration 61: 0.5957446808510638
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.5851063829787234
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.6702127659574468
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.6595744680851063
	Val acc at iteration 69: 0.6063829787234043
	Val acc at iteration 70: 0.648936170212766
	Val acc at iteration 71: 0.6170212765957447
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.648936170212766
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.648936170212766
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.6382978723404256
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.6702127659574468
	Val acc at iteration 80: 0.648936170212766
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.6702127659574468
Val acc before epoch 25: 0.648936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8617021276595744
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7932692307692307
	Train Cluster: 0.6502948522567749
	TrainSeparation: 0.5208155035972595
(Directly after push) Val acc at iteration 0: 0.5957446808510638
Retraining last layer
Last layer lr: 5e-05
	Train acc at iteration 1: 0.8060897435897436
	Val acc at iteration 0: 0.7659574468085106
	Train acc at iteration 2: 0.7932692307692307
	Val acc at iteration 1: 0.648936170212766
	Train acc at iteration 3: 0.7916666666666666
	Val acc at iteration 2: 0.7127659574468085
	Train acc at iteration 4: 0.7980769230769231
	Val acc at iteration 3: 0.6276595744680851
	Train acc at iteration 5: 0.8237179487179487
	Val acc at iteration 4: 0.7021276595744681
	Train acc at iteration 6: 0.7708333333333334
	Val acc at iteration 5: 0.7446808510638298
	Train acc at iteration 7: 0.780448717948718
	Val acc at iteration 6: 0.6914893617021277
	Train acc at iteration 8: 0.7932692307692307
	Val acc at iteration 7: 0.6702127659574468
	Train acc at iteration 9: 0.8189102564102564
	Val acc at iteration 8: 0.648936170212766
	Train acc at iteration 10: 0.7692307692307693
	Val acc at iteration 9: 0.723404255319149
	Train acc at iteration 11: 0.7964743589743589
	Val acc at iteration 10: 0.723404255319149
	Train acc at iteration 12: 0.7676282051282052
	Val acc at iteration 11: 0.7127659574468085
	Train acc at iteration 13: 0.7724358974358975
	Val acc at iteration 12: 0.6595744680851063
	Train acc at iteration 14: 0.7868589743589743
	Val acc at iteration 13: 0.6595744680851063
	Train acc at iteration 15: 0.7467948717948718
	Val acc at iteration 14: 0.648936170212766
	Train acc at iteration 16: 0.7836538461538461
	Val acc at iteration 15: 0.6914893617021277
	Train acc at iteration 17: 0.7916666666666666
	Val acc at iteration 16: 0.723404255319149
	Train acc at iteration 18: 0.7980769230769231
	Val acc at iteration 17: 0.723404255319149
	Train acc at iteration 19: 0.7708333333333334
	Val acc at iteration 18: 0.7340425531914894
	Train acc at iteration 20: 0.8028846153846154
	Val acc at iteration 19: 0.648936170212766
	Train acc at iteration 21: 0.7884615384615384
	Val acc at iteration 20: 0.7021276595744681
	Train acc at iteration 22: 0.7884615384615384
	Val acc at iteration 21: 0.7021276595744681
	Train acc at iteration 23: 0.780448717948718
	Val acc at iteration 22: 0.6808510638297872
	Train acc at iteration 24: 0.7788461538461539
	Val acc at iteration 23: 0.7340425531914894
	Train acc at iteration 25: 0.7708333333333334
	Val acc at iteration 24: 0.7659574468085106
	Train acc at iteration 26: 0.7884615384615384
	Val acc at iteration 25: 0.7127659574468085
	Train acc at iteration 27: 0.7900641025641025
	Val acc at iteration 26: 0.6808510638297872
	Train acc at iteration 28: 0.7884615384615384
	Val acc at iteration 27: 0.7446808510638298
	Train acc at iteration 29: 0.7612179487179487
	Val acc at iteration 28: 0.7021276595744681
	Train acc at iteration 30: 0.7772435897435898
	Val acc at iteration 29: 0.7127659574468085
	Train acc at iteration 31: 0.7884615384615384
	Val acc at iteration 30: 0.6914893617021277
	Train acc at iteration 32: 0.7884615384615384
	Val acc at iteration 31: 0.6382978723404256
	Train acc at iteration 33: 0.7916666666666666
	Val acc at iteration 32: 0.6276595744680851
	Train acc at iteration 34: 0.8108974358974359
	Val acc at iteration 33: 0.6702127659574468
	Train acc at iteration 35: 0.7628205128205128
	Val acc at iteration 34: 0.6914893617021277
	Train acc at iteration 36: 0.7868589743589743
	Val acc at iteration 35: 0.723404255319149
	Train acc at iteration 37: 0.7916666666666666
	Val acc at iteration 36: 0.723404255319149
	Train acc at iteration 38: 0.7564102564102564
	Val acc at iteration 37: 0.7446808510638298
	Train acc at iteration 39: 0.7932692307692307
	Val acc at iteration 38: 0.6702127659574468
	Train acc at iteration 40: 0.7900641025641025
	Val acc at iteration 39: 0.6914893617021277
	Train acc at iteration 41: 0.7996794871794872
	Val acc at iteration 40: 0.6914893617021277
	Train acc at iteration 42: 0.7900641025641025
	Val acc at iteration 41: 0.6382978723404256
	Train acc at iteration 43: 0.7836538461538461
	Val acc at iteration 42: 0.6914893617021277
	Train acc at iteration 44: 0.7788461538461539
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.7932692307692307
	Val acc at iteration 44: 0.6170212765957447
	Train acc at iteration 46: 0.7836538461538461
	Val acc at iteration 45: 0.7127659574468085
	Train acc at iteration 47: 0.7852564102564102
	Val acc at iteration 46: 0.7021276595744681
	Train acc at iteration 48: 0.8012820512820513
	Val acc at iteration 47: 0.7553191489361702
	Train acc at iteration 49: 0.7676282051282052
	Val acc at iteration 48: 0.648936170212766
	Train acc at iteration 50: 0.7900641025641025
	Val acc at iteration 49: 0.6382978723404256
	Train acc at iteration 51: 0.7964743589743589
	Val acc at iteration 50: 0.648936170212766
	Train acc at iteration 52: 0.7900641025641025
	Val acc at iteration 51: 0.6808510638297872
	Train acc at iteration 53: 0.8044871794871795
	Val acc at iteration 52: 0.7127659574468085
	Train acc at iteration 54: 0.7836538461538461
	Val acc at iteration 53: 0.6808510638297872
	Train acc at iteration 55: 0.7948717948717948
	Val acc at iteration 54: 0.723404255319149
	Train acc at iteration 56: 0.8060897435897436
	Val acc at iteration 55: 0.7446808510638298
	Train acc at iteration 57: 0.8028846153846154
	Val acc at iteration 56: 0.6382978723404256
	Train acc at iteration 58: 0.7852564102564102
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.8173076923076923
	Val acc at iteration 58: 0.6914893617021277
	Train acc at iteration 60: 0.7980769230769231
	Val acc at iteration 59: 0.7127659574468085
	Train acc at iteration 61: 0.7884615384615384
	Val acc at iteration 60: 0.6702127659574468
	Train acc at iteration 62: 0.7884615384615384
	Val acc at iteration 61: 0.6276595744680851
	Train acc at iteration 63: 0.7740384615384616
	Val acc at iteration 62: 0.7021276595744681
	Train acc at iteration 64: 0.7964743589743589
	Val acc at iteration 63: 0.6914893617021277
	Train acc at iteration 65: 0.7788461538461539
	Val acc at iteration 64: 0.7340425531914894
	Train acc at iteration 66: 0.7692307692307693
	Val acc at iteration 65: 0.7127659574468085
	Train acc at iteration 67: 0.7788461538461539
	Val acc at iteration 66: 0.6063829787234043
	Train acc at iteration 68: 0.7980769230769231
	Val acc at iteration 67: 0.6170212765957447
	Train acc at iteration 69: 0.7788461538461539
	Val acc at iteration 68: 0.7340425531914894
	Train acc at iteration 70: 0.7772435897435898
	Val acc at iteration 69: 0.6914893617021277
	Train acc at iteration 71: 0.7980769230769231
	Val acc at iteration 70: 0.7127659574468085
	Train acc at iteration 72: 0.7788461538461539
	Val acc at iteration 71: 0.6808510638297872
	Train acc at iteration 73: 0.8237179487179487
	Val acc at iteration 72: 0.6914893617021277
	Train acc at iteration 74: 0.780448717948718
	Val acc at iteration 73: 0.6808510638297872
	Train acc at iteration 75: 0.7772435897435898
	Val acc at iteration 74: 0.7021276595744681
	Train acc at iteration 76: 0.7772435897435898
	Val acc at iteration 75: 0.6170212765957447
	Train acc at iteration 77: 0.7756410256410257
	Val acc at iteration 76: 0.6702127659574468
	Train acc at iteration 78: 0.7900641025641025
	Val acc at iteration 77: 0.6595744680851063
	Train acc at iteration 79: 0.780448717948718
	Val acc at iteration 78: 0.7127659574468085
	Train acc at iteration 80: 0.8141025641025641
	Val acc at iteration 79: 0.7446808510638298
	Train acc at iteration 81: 0.7836538461538461
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.7788461538461539
	Val acc at iteration 81: 0.6702127659574468
	Train acc at iteration 83: 0.7932692307692307
	Val acc at iteration 82: 0.6808510638297872
	Train acc at iteration 84: 0.7852564102564102
	Val acc at iteration 83: 0.6702127659574468
	Train acc at iteration 85: 0.7996794871794872
	Val acc at iteration 84: 0.6702127659574468
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.522875816993464
Final val micro accuracy: 0.6276595744680851
Final test macro f1-score: 0.5197802197802197
Final test micro accuracy: 0.648936170212766
Final validation:
	Cluster: 0.6287980079650879
	Separation: 0.543755441904068
Final test:
	Cluster: 0.6206038594245911
	Separation: 0.5367383360862732
Saved Results

Attempting combination 37/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.01
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.5
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7564102564102564
	Train Cluster: 0.6429376482963562
	Train Separation: 0.5184851050376892
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5957446808510638
	Val acc at iteration 1: 0.6595744680851063
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.6170212765957447
	Val acc at iteration 4: 0.6702127659574468
	Val acc at iteration 5: 0.5957446808510638
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.6914893617021277
	Val acc at iteration 8: 0.6382978723404256
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.6170212765957447
	Val acc at iteration 12: 0.6595744680851063
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.6063829787234043
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.6914893617021277
	Val acc at iteration 18: 0.5957446808510638
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.648936170212766
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6170212765957447
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.6382978723404256
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.6914893617021277
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.6276595744680851
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.6595744680851063
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.5851063829787234
	Val acc at iteration 41: 0.6170212765957447
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.5957446808510638
	Val acc at iteration 45: 0.6382978723404256
	Val acc at iteration 46: 0.6170212765957447
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.5957446808510638
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.6276595744680851
	Val acc at iteration 53: 0.6170212765957447
	Val acc at iteration 54: 0.6808510638297872
	Val acc at iteration 55: 0.574468085106383
	Val acc at iteration 56: 0.6914893617021277
	Val acc at iteration 57: 0.6595744680851063
	Val acc at iteration 58: 0.6063829787234043
	Val acc at iteration 59: 0.6702127659574468
	Val acc at iteration 60: 0.648936170212766
	Val acc at iteration 61: 0.7127659574468085
	Val acc at iteration 62: 0.6170212765957447
	Val acc at iteration 63: 0.648936170212766
	Val acc at iteration 64: 0.6702127659574468
	Val acc at iteration 65: 0.6170212765957447
	Val acc at iteration 66: 0.6595744680851063
	Val acc at iteration 67: 0.6914893617021277
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.6382978723404256
	Val acc at iteration 70: 0.6382978723404256
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.648936170212766
	Val acc at iteration 73: 0.6702127659574468
	Val acc at iteration 74: 0.6276595744680851
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.574468085106383
	Val acc at iteration 78: 0.6382978723404256
	Val acc at iteration 79: 0.6595744680851063
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.6063829787234043
	Val acc at iteration 82: 0.6914893617021277
	Val acc at iteration 83: 0.7127659574468085
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 13: 0.6808510638297872
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7978723404255319
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.9361702127659575
Push epoch
After push, before retraining last layer:
	Train acc: 0.7612179487179487
	Train Cluster: 0.6444889068603515
	Train Separation: 0.5217777490615845
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.6914893617021277
	Val acc at iteration 1: 0.7021276595744681
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.6382978723404256
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6914893617021277
	Val acc at iteration 6: 0.7021276595744681
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.6702127659574468
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6595744680851063
	Val acc at iteration 12: 0.6382978723404256
	Val acc at iteration 13: 0.6702127659574468
	Val acc at iteration 14: 0.7021276595744681
	Val acc at iteration 15: 0.6595744680851063
	Val acc at iteration 16: 0.6914893617021277
	Val acc at iteration 17: 0.648936170212766
	Val acc at iteration 18: 0.6276595744680851
	Val acc at iteration 19: 0.6382978723404256
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.6702127659574468
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.6170212765957447
	Val acc at iteration 26: 0.648936170212766
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.5957446808510638
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.6382978723404256
	Val acc at iteration 31: 0.6914893617021277
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.6382978723404256
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.7340425531914894
	Val acc at iteration 39: 0.648936170212766
	Val acc at iteration 40: 0.648936170212766
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.5851063829787234
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.6276595744680851
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.7127659574468085
	Val acc at iteration 48: 0.6170212765957447
	Val acc at iteration 49: 0.648936170212766
	Val acc at iteration 50: 0.6595744680851063
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.6702127659574468
	Val acc at iteration 54: 0.7446808510638298
	Val acc at iteration 55: 0.6595744680851063
	Val acc at iteration 56: 0.6276595744680851
	Val acc at iteration 57: 0.7340425531914894
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.6382978723404256
	Val acc at iteration 60: 0.648936170212766
	Val acc at iteration 61: 0.6702127659574468
	Val acc at iteration 62: 0.6382978723404256
	Val acc at iteration 63: 0.6808510638297872
	Val acc at iteration 64: 0.648936170212766
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.6808510638297872
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.6063829787234043
	Val acc at iteration 71: 0.6276595744680851
	Val acc at iteration 72: 0.6382978723404256
	Val acc at iteration 73: 0.6276595744680851
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.7127659574468085
	Val acc at iteration 76: 0.6702127659574468
	Val acc at iteration 77: 0.648936170212766
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.6276595744680851
	Val acc at iteration 80: 0.6170212765957447
	Val acc at iteration 81: 0.6914893617021277
	Val acc at iteration 82: 0.5957446808510638
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 25: 0.6808510638297872
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8191489361702128
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9574468085106383
Stopping after epoch 37.
Final validation accuracy before push: 95.74468085106383%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7836538461538461
	Train Cluster: 0.6430818557739257
	TrainSeparation: 0.5196224808692932
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer
Last layer lr: 0.5
	Train acc at iteration 1: 0.2916666666666667
	Val acc at iteration 0: 0.1276595744680851
	Train acc at iteration 2: 0.14102564102564102
	Val acc at iteration 1: 0.20212765957446807
	Train acc at iteration 3: 0.14423076923076922
	Val acc at iteration 2: 0.26595744680851063
	Train acc at iteration 4: 0.25801282051282054
	Val acc at iteration 3: 0.39361702127659576
	Train acc at iteration 5: 0.4182692307692308
	Val acc at iteration 4: 0.43617021276595747
	Train acc at iteration 6: 0.3541666666666667
	Val acc at iteration 5: 0.44680851063829785
	Train acc at iteration 7: 0.34134615384615385
	Val acc at iteration 6: 0.44680851063829785
	Train acc at iteration 8: 0.5544871794871795
	Val acc at iteration 7: 0.0425531914893617
	Train acc at iteration 9: 0.3926282051282051
	Val acc at iteration 8: 0.6063829787234043
	Train acc at iteration 10: 0.36698717948717946
	Val acc at iteration 9: 0.5851063829787234
	Train acc at iteration 11: 0.6778846153846154
	Val acc at iteration 10: 0.02127659574468085
	Train acc at iteration 12: 0.48878205128205127
	Val acc at iteration 11: 0.11702127659574468
	Train acc at iteration 13: 0.38461538461538464
	Val acc at iteration 12: 0.30851063829787234
	Train acc at iteration 14: 0.5689102564102564
	Val acc at iteration 13: 0.26595744680851063
	Train acc at iteration 15: 0.5625
	Val acc at iteration 14: 0.648936170212766
	Train acc at iteration 16: 0.7147435897435898
	Val acc at iteration 15: 0.7127659574468085
	Train acc at iteration 17: 0.3798076923076923
	Val acc at iteration 16: 0.30851063829787234
	Train acc at iteration 18: 0.4375
	Val acc at iteration 17: 0.648936170212766
	Train acc at iteration 19: 0.6762820512820513
	Val acc at iteration 18: 0.6595744680851063
	Train acc at iteration 20: 0.5913461538461539
	Val acc at iteration 19: 0.7127659574468085
	Train acc at iteration 21: 0.7019230769230769
	Val acc at iteration 20: 0.5425531914893617
	Train acc at iteration 22: 0.6682692307692307
	Val acc at iteration 21: 0.43617021276595747
	Train acc at iteration 23: 0.6794871794871795
	Val acc at iteration 22: 0.6808510638297872
	Train acc at iteration 24: 0.719551282051282
	Val acc at iteration 23: 0.5851063829787234
	Train acc at iteration 25: 0.7131410256410257
	Val acc at iteration 24: 0.5638297872340425
	Train acc at iteration 26: 0.7788461538461539
	Val acc at iteration 25: 0.648936170212766
	Train acc at iteration 27: 0.7259615384615384
	Val acc at iteration 26: 0.574468085106383
	Train acc at iteration 28: 0.7564102564102564
	Val acc at iteration 27: 0.6702127659574468
	Train acc at iteration 29: 0.7339743589743589
	Val acc at iteration 28: 0.6914893617021277
	Train acc at iteration 30: 0.7676282051282052
	Val acc at iteration 29: 0.5957446808510638
	Train acc at iteration 31: 0.7419871794871795
	Val acc at iteration 30: 0.6702127659574468
	Train acc at iteration 32: 0.7451923076923077
	Val acc at iteration 31: 0.648936170212766
	Train acc at iteration 33: 0.7371794871794872
	Val acc at iteration 32: 0.6170212765957447
	Train acc at iteration 34: 0.7435897435897436
	Val acc at iteration 33: 0.6276595744680851
	Train acc at iteration 35: 0.7419871794871795
	Val acc at iteration 34: 0.7446808510638298
	Train acc at iteration 36: 0.7419871794871795
	Val acc at iteration 35: 0.6170212765957447
	Train acc at iteration 37: 0.7371794871794872
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.7483974358974359
	Val acc at iteration 37: 0.6914893617021277
	Train acc at iteration 39: 0.7676282051282052
	Val acc at iteration 38: 0.6914893617021277
	Train acc at iteration 40: 0.7724358974358975
	Val acc at iteration 39: 0.6808510638297872
	Train acc at iteration 41: 0.7596153846153846
	Val acc at iteration 40: 0.6382978723404256
	Train acc at iteration 42: 0.7403846153846154
	Val acc at iteration 41: 0.648936170212766
	Train acc at iteration 43: 0.7435897435897436
	Val acc at iteration 42: 0.648936170212766
	Train acc at iteration 44: 0.7355769230769231
	Val acc at iteration 43: 0.6170212765957447
	Train acc at iteration 45: 0.7371794871794872
	Val acc at iteration 44: 0.6063829787234043
	Train acc at iteration 46: 0.7371794871794872
	Val acc at iteration 45: 0.6595744680851063
	Train acc at iteration 47: 0.7435897435897436
	Val acc at iteration 46: 0.6276595744680851
	Train acc at iteration 48: 0.7307692307692307
	Val acc at iteration 47: 0.6702127659574468
	Train acc at iteration 49: 0.7692307692307693
	Val acc at iteration 48: 0.7127659574468085
	Train acc at iteration 50: 0.7676282051282052
	Val acc at iteration 49: 0.6595744680851063
	Train acc at iteration 51: 0.7532051282051282
	Val acc at iteration 50: 0.7127659574468085
	Train acc at iteration 52: 0.7291666666666666
	Val acc at iteration 51: 0.6170212765957447
	Train acc at iteration 53: 0.7387820512820513
	Val acc at iteration 52: 0.6702127659574468
	Train acc at iteration 54: 0.7532051282051282
	Val acc at iteration 53: 0.6382978723404256
	Train acc at iteration 55: 0.7483974358974359
	Val acc at iteration 54: 0.7021276595744681
	Train acc at iteration 56: 0.7676282051282052
	Val acc at iteration 55: 0.6702127659574468
	Train acc at iteration 57: 0.7724358974358975
	Val acc at iteration 56: 0.6595744680851063
	Train acc at iteration 58: 0.7419871794871795
	Val acc at iteration 57: 0.6914893617021277
	Train acc at iteration 59: 0.7564102564102564
	Val acc at iteration 58: 0.6914893617021277
	Train acc at iteration 60: 0.7371794871794872
	Val acc at iteration 59: 0.6595744680851063
	Train acc at iteration 61: 0.7307692307692307
	Val acc at iteration 60: 0.6382978723404256
	Train acc at iteration 62: 0.7564102564102564
	Val acc at iteration 61: 0.723404255319149
	Train acc at iteration 63: 0.7660256410256411
	Val acc at iteration 62: 0.6914893617021277
	Train acc at iteration 64: 0.7419871794871795
	Val acc at iteration 63: 0.7127659574468085
	Train acc at iteration 65: 0.7516025641025641
	Val acc at iteration 64: 0.6170212765957447
	Train acc at iteration 66: 0.7580128205128205
	Val acc at iteration 65: 0.723404255319149
	Train acc at iteration 67: 0.75
	Val acc at iteration 66: 0.6702127659574468
	Train acc at iteration 68: 0.7596153846153846
	Val acc at iteration 67: 0.6382978723404256
	Train acc at iteration 69: 0.7564102564102564
	Val acc at iteration 68: 0.6595744680851063
	Train acc at iteration 70: 0.7628205128205128
	Val acc at iteration 69: 0.6914893617021277
	Train acc at iteration 71: 0.7676282051282052
	Val acc at iteration 70: 0.6702127659574468
	Train acc at iteration 72: 0.7564102564102564
	Val acc at iteration 71: 0.7021276595744681
	Train acc at iteration 73: 0.7275641025641025
	Val acc at iteration 72: 0.7659574468085106
	Train acc at iteration 74: 0.7628205128205128
	Val acc at iteration 73: 0.6808510638297872
	Train acc at iteration 75: 0.8028846153846154
	Val acc at iteration 74: 0.7021276595744681
	Train acc at iteration 76: 0.780448717948718
	Val acc at iteration 75: 0.6595744680851063
	Train acc at iteration 77: 0.7532051282051282
	Val acc at iteration 76: 0.6276595744680851
	Train acc at iteration 78: 0.7451923076923077
	Val acc at iteration 77: 0.7340425531914894
	Train acc at iteration 79: 0.7516025641025641
	Val acc at iteration 78: 0.7446808510638298
	Train acc at iteration 80: 0.7403846153846154
	Val acc at iteration 79: 0.6595744680851063
	Train acc at iteration 81: 0.7516025641025641
	Val acc at iteration 80: 0.7659574468085106
	Train acc at iteration 82: 0.7387820512820513
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.7612179487179487
	Val acc at iteration 82: 0.7127659574468085
	Train acc at iteration 84: 0.7724358974358975
	Val acc at iteration 83: 0.7978723404255319
	Train acc at iteration 85: 0.7660256410256411
	Val acc at iteration 84: 0.7659574468085106
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5663299663299664
Final val micro accuracy: 0.6808510638297872
Final test macro f1-score: 0.4336956521739129
Final test micro accuracy: 0.5425531914893617
Final validation:
	Cluster: 0.6334055960178375
	Separation: 0.547427773475647
Final test:
	Cluster: 0.6112390160560608
	Separation: 0.5417707860469818
Saved Results

Attempting combination 38/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.01
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.1
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8936170212765957
Push epoch
After push, before retraining last layer:
	Train acc: 0.7451923076923077
	Train Cluster: 0.6368403673171997
	Train Separation: 0.5178454756736756
(Directly after push) Val acc at iteration 0: 0.5957446808510638
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.5638297872340425
	Val acc at iteration 2: 0.6276595744680851
	Val acc at iteration 3: 0.6063829787234043
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6808510638297872
	Val acc at iteration 6: 0.6914893617021277
	Val acc at iteration 7: 0.5638297872340425
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.6170212765957447
	Val acc at iteration 10: 0.5957446808510638
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.5425531914893617
	Val acc at iteration 13: 0.6276595744680851
	Val acc at iteration 14: 0.6063829787234043
	Val acc at iteration 15: 0.6170212765957447
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.6382978723404256
	Val acc at iteration 18: 0.6170212765957447
	Val acc at iteration 19: 0.5957446808510638
	Val acc at iteration 20: 0.6702127659574468
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.5851063829787234
	Val acc at iteration 25: 0.5957446808510638
	Val acc at iteration 26: 0.5957446808510638
	Val acc at iteration 27: 0.6276595744680851
	Val acc at iteration 28: 0.648936170212766
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.5957446808510638
	Val acc at iteration 31: 0.6702127659574468
	Val acc at iteration 32: 0.6063829787234043
	Val acc at iteration 33: 0.6063829787234043
	Val acc at iteration 34: 0.723404255319149
	Val acc at iteration 35: 0.6063829787234043
	Val acc at iteration 36: 0.6382978723404256
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.6808510638297872
	Val acc at iteration 39: 0.574468085106383
	Val acc at iteration 40: 0.6595744680851063
	Val acc at iteration 41: 0.6170212765957447
	Val acc at iteration 42: 0.6063829787234043
	Val acc at iteration 43: 0.6276595744680851
	Val acc at iteration 44: 0.574468085106383
	Val acc at iteration 45: 0.6914893617021277
	Val acc at iteration 46: 0.574468085106383
	Val acc at iteration 47: 0.5638297872340425
	Val acc at iteration 48: 0.648936170212766
	Val acc at iteration 49: 0.6382978723404256
	Val acc at iteration 50: 0.6702127659574468
	Val acc at iteration 51: 0.6382978723404256
	Val acc at iteration 52: 0.6170212765957447
	Val acc at iteration 53: 0.6382978723404256
	Val acc at iteration 54: 0.5957446808510638
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.5212765957446809
	Val acc at iteration 57: 0.6382978723404256
	Val acc at iteration 58: 0.5957446808510638
	Val acc at iteration 59: 0.5531914893617021
	Val acc at iteration 60: 0.6276595744680851
	Val acc at iteration 61: 0.6595744680851063
	Val acc at iteration 62: 0.5531914893617021
	Val acc at iteration 63: 0.6063829787234043
	Val acc at iteration 64: 0.6063829787234043
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.6170212765957447
	Val acc at iteration 67: 0.6382978723404256
	Val acc at iteration 68: 0.648936170212766
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.5957446808510638
	Val acc at iteration 71: 0.5851063829787234
	Val acc at iteration 72: 0.6063829787234043
	Val acc at iteration 73: 0.5957446808510638
	Val acc at iteration 74: 0.648936170212766
	Val acc at iteration 75: 0.6702127659574468
	Val acc at iteration 76: 0.6170212765957447
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.6382978723404256
	Val acc at iteration 79: 0.6063829787234043
	Val acc at iteration 80: 0.6595744680851063
	Val acc at iteration 81: 0.6382978723404256
	Val acc at iteration 82: 0.6170212765957447
	Val acc at iteration 83: 0.5319148936170213
	Val acc at iteration 84: 0.6382978723404256
Val acc before epoch 13: 0.6808510638297872
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 14: 0.7978723404255319
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 15: 0.8191489361702128
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 16: 0.776595744680851
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 17: 0.8723404255319149
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 19: 0.9042553191489362
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.27999999999999997
Val acc before epoch 24: 0.925531914893617
Push epoch
After push, before retraining last layer:
	Train acc: 0.7516025641025641
	Train Cluster: 0.6484114646911621
	Train Separation: 0.5204354524612427
(Directly after push) Val acc at iteration 0: 0.6170212765957447
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.6914893617021277
	Val acc at iteration 3: 0.6063829787234043
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.574468085106383
	Val acc at iteration 6: 0.6702127659574468
	Val acc at iteration 7: 0.6808510638297872
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.5957446808510638
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.574468085106383
	Val acc at iteration 13: 0.6382978723404256
	Val acc at iteration 14: 0.6914893617021277
	Val acc at iteration 15: 0.6702127659574468
	Val acc at iteration 16: 0.574468085106383
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.6914893617021277
	Val acc at iteration 20: 0.6595744680851063
	Val acc at iteration 21: 0.6595744680851063
	Val acc at iteration 22: 0.6595744680851063
	Val acc at iteration 23: 0.5851063829787234
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.6276595744680851
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.6914893617021277
	Val acc at iteration 29: 0.6276595744680851
	Val acc at iteration 30: 0.5957446808510638
	Val acc at iteration 31: 0.6063829787234043
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.6382978723404256
	Val acc at iteration 36: 0.6808510638297872
	Val acc at iteration 37: 0.6808510638297872
	Val acc at iteration 38: 0.6276595744680851
	Val acc at iteration 39: 0.6382978723404256
	Val acc at iteration 40: 0.6063829787234043
	Val acc at iteration 41: 0.6808510638297872
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.6702127659574468
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.648936170212766
	Val acc at iteration 46: 0.6808510638297872
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.6595744680851063
	Val acc at iteration 49: 0.6063829787234043
	Val acc at iteration 50: 0.7021276595744681
	Val acc at iteration 51: 0.6595744680851063
	Val acc at iteration 52: 0.7021276595744681
	Val acc at iteration 53: 0.6170212765957447
	Val acc at iteration 54: 0.6063829787234043
	Val acc at iteration 55: 0.648936170212766
	Val acc at iteration 56: 0.6170212765957447
	Val acc at iteration 57: 0.5851063829787234
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.5638297872340425
	Val acc at iteration 60: 0.6170212765957447
	Val acc at iteration 61: 0.6382978723404256
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.6702127659574468
	Val acc at iteration 64: 0.6170212765957447
	Val acc at iteration 65: 0.6595744680851063
	Val acc at iteration 66: 0.574468085106383
	Val acc at iteration 67: 0.6702127659574468
	Val acc at iteration 68: 0.6382978723404256
	Val acc at iteration 69: 0.6170212765957447
	Val acc at iteration 70: 0.6276595744680851
	Val acc at iteration 71: 0.6702127659574468
	Val acc at iteration 72: 0.6276595744680851
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.6595744680851063
	Val acc at iteration 75: 0.6382978723404256
	Val acc at iteration 76: 0.6808510638297872
	Val acc at iteration 77: 0.6276595744680851
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.5851063829787234
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.6702127659574468
	Val acc at iteration 82: 0.574468085106383
	Val acc at iteration 83: 0.574468085106383
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 25: 0.6170212765957447
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 26: 0.8723404255319149
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 27: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.19599999999999998
Val acc before epoch 36: 0.9361702127659575
Stopping after epoch 37.
Final validation accuracy before push: 93.61702127659575%
Pushing prototypes since finished training
After push, before retraining last layer:
	Train acc: 0.7884615384615384
	Train Cluster: 0.6417917847633362
	TrainSeparation: 0.5159286499023438
(Directly after push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer
Last layer lr: 0.1
	Train acc at iteration 1: 0.5817307692307693
	Val acc at iteration 0: 0.40425531914893614
	Train acc at iteration 2: 0.5961538461538461
	Val acc at iteration 1: 0.4787234042553192
	Train acc at iteration 3: 0.530448717948718
	Val acc at iteration 2: 0.5
	Train acc at iteration 4: 0.5849358974358975
	Val acc at iteration 3: 0.5106382978723404
	Train acc at iteration 5: 0.625
	Val acc at iteration 4: 0.5638297872340425
	Train acc at iteration 6: 0.655448717948718
	Val acc at iteration 5: 0.5531914893617021
	Train acc at iteration 7: 0.6346153846153846
	Val acc at iteration 6: 0.6808510638297872
	Train acc at iteration 8: 0.6730769230769231
	Val acc at iteration 7: 0.6276595744680851
	Train acc at iteration 9: 0.6923076923076923
	Val acc at iteration 8: 0.6595744680851063
	Train acc at iteration 10: 0.7291666666666666
	Val acc at iteration 9: 0.5638297872340425
	Train acc at iteration 11: 0.7307692307692307
	Val acc at iteration 10: 0.6702127659574468
	Train acc at iteration 12: 0.7451923076923077
	Val acc at iteration 11: 0.6808510638297872
	Train acc at iteration 13: 0.7355769230769231
	Val acc at iteration 12: 0.6595744680851063
	Train acc at iteration 14: 0.7387820512820513
	Val acc at iteration 13: 0.6276595744680851
	Train acc at iteration 15: 0.7387820512820513
	Val acc at iteration 14: 0.6382978723404256
	Train acc at iteration 16: 0.7371794871794872
	Val acc at iteration 15: 0.648936170212766
	Train acc at iteration 17: 0.7419871794871795
	Val acc at iteration 16: 0.723404255319149
	Train acc at iteration 18: 0.7516025641025641
	Val acc at iteration 17: 0.7127659574468085
	Train acc at iteration 19: 0.7724358974358975
	Val acc at iteration 18: 0.6276595744680851
	Train acc at iteration 20: 0.7451923076923077
	Val acc at iteration 19: 0.6808510638297872
	Train acc at iteration 21: 0.7708333333333334
	Val acc at iteration 20: 0.6595744680851063
	Train acc at iteration 22: 0.7355769230769231
	Val acc at iteration 21: 0.6170212765957447
	Train acc at iteration 23: 0.7836538461538461
	Val acc at iteration 22: 0.6808510638297872
	Train acc at iteration 24: 0.7676282051282052
	Val acc at iteration 23: 0.6382978723404256
	Train acc at iteration 25: 0.7564102564102564
	Val acc at iteration 24: 0.648936170212766
	Train acc at iteration 26: 0.7964743589743589
	Val acc at iteration 25: 0.7340425531914894
	Train acc at iteration 27: 0.7564102564102564
	Val acc at iteration 26: 0.7340425531914894
	Train acc at iteration 28: 0.7836538461538461
	Val acc at iteration 27: 0.7127659574468085
	Train acc at iteration 29: 0.7724358974358975
	Val acc at iteration 28: 0.723404255319149
	Train acc at iteration 30: 0.8012820512820513
	Val acc at iteration 29: 0.6595744680851063
	Train acc at iteration 31: 0.782051282051282
	Val acc at iteration 30: 0.5957446808510638
	Train acc at iteration 32: 0.7884615384615384
	Val acc at iteration 31: 0.6702127659574468
	Train acc at iteration 33: 0.7852564102564102
	Val acc at iteration 32: 0.6702127659574468
	Train acc at iteration 34: 0.7788461538461539
	Val acc at iteration 33: 0.6276595744680851
	Train acc at iteration 35: 0.8012820512820513
	Val acc at iteration 34: 0.648936170212766
	Train acc at iteration 36: 0.8141025641025641
	Val acc at iteration 35: 0.6063829787234043
	Train acc at iteration 37: 0.7884615384615384
	Val acc at iteration 36: 0.7021276595744681
	Train acc at iteration 38: 0.7852564102564102
	Val acc at iteration 37: 0.7127659574468085
	Train acc at iteration 39: 0.7708333333333334
	Val acc at iteration 38: 0.6382978723404256
	Train acc at iteration 40: 0.8076923076923077
	Val acc at iteration 39: 0.7021276595744681
	Train acc at iteration 41: 0.8028846153846154
	Val acc at iteration 40: 0.7446808510638298
	Train acc at iteration 42: 0.7740384615384616
	Val acc at iteration 41: 0.6702127659574468
	Train acc at iteration 43: 0.8060897435897436
	Val acc at iteration 42: 0.6595744680851063
	Train acc at iteration 44: 0.8125
	Val acc at iteration 43: 0.648936170212766
	Train acc at iteration 45: 0.7964743589743589
	Val acc at iteration 44: 0.6808510638297872
	Train acc at iteration 46: 0.8044871794871795
	Val acc at iteration 45: 0.6702127659574468
	Train acc at iteration 47: 0.7948717948717948
	Val acc at iteration 46: 0.6595744680851063
	Train acc at iteration 48: 0.7900641025641025
	Val acc at iteration 47: 0.6702127659574468
	Train acc at iteration 49: 0.7932692307692307
	Val acc at iteration 48: 0.7872340425531915
	Train acc at iteration 50: 0.7660256410256411
	Val acc at iteration 49: 0.6595744680851063
	Train acc at iteration 51: 0.7852564102564102
	Val acc at iteration 50: 0.7446808510638298
	Train acc at iteration 52: 0.8108974358974359
	Val acc at iteration 51: 0.7021276595744681
	Train acc at iteration 53: 0.7836538461538461
	Val acc at iteration 52: 0.7021276595744681
	Train acc at iteration 54: 0.7788461538461539
	Val acc at iteration 53: 0.7340425531914894
	Train acc at iteration 55: 0.7852564102564102
	Val acc at iteration 54: 0.648936170212766
	Train acc at iteration 56: 0.8125
	Val acc at iteration 55: 0.7127659574468085
	Train acc at iteration 57: 0.7884615384615384
	Val acc at iteration 56: 0.6382978723404256
	Train acc at iteration 58: 0.7996794871794872
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.7900641025641025
	Val acc at iteration 58: 0.6702127659574468
	Train acc at iteration 60: 0.8108974358974359
	Val acc at iteration 59: 0.723404255319149
	Train acc at iteration 61: 0.8028846153846154
	Val acc at iteration 60: 0.6914893617021277
	Train acc at iteration 62: 0.7836538461538461
	Val acc at iteration 61: 0.7340425531914894
	Train acc at iteration 63: 0.7980769230769231
	Val acc at iteration 62: 0.7021276595744681
	Train acc at iteration 64: 0.7980769230769231
	Val acc at iteration 63: 0.6808510638297872
	Train acc at iteration 65: 0.8333333333333334
	Val acc at iteration 64: 0.7021276595744681
	Train acc at iteration 66: 0.8301282051282052
	Val acc at iteration 65: 0.7659574468085106
	Train acc at iteration 67: 0.8221153846153846
	Val acc at iteration 66: 0.6808510638297872
	Train acc at iteration 68: 0.8092948717948718
	Val acc at iteration 67: 0.6914893617021277
	Train acc at iteration 69: 0.780448717948718
	Val acc at iteration 68: 0.6702127659574468
	Train acc at iteration 70: 0.7772435897435898
	Val acc at iteration 69: 0.7553191489361702
	Train acc at iteration 71: 0.8076923076923077
	Val acc at iteration 70: 0.648936170212766
	Train acc at iteration 72: 0.7740384615384616
	Val acc at iteration 71: 0.7553191489361702
	Train acc at iteration 73: 0.8012820512820513
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.8221153846153846
	Val acc at iteration 73: 0.6595744680851063
	Train acc at iteration 75: 0.7996794871794872
	Val acc at iteration 74: 0.648936170212766
	Train acc at iteration 76: 0.8141025641025641
	Val acc at iteration 75: 0.7553191489361702
	Train acc at iteration 77: 0.8157051282051282
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.7740384615384616
	Val acc at iteration 77: 0.7021276595744681
	Train acc at iteration 79: 0.8012820512820513
	Val acc at iteration 78: 0.6808510638297872
	Train acc at iteration 80: 0.7740384615384616
	Val acc at iteration 79: 0.7446808510638298
	Train acc at iteration 81: 0.8012820512820513
	Val acc at iteration 80: 0.723404255319149
	Train acc at iteration 82: 0.8333333333333334
	Val acc at iteration 81: 0.7553191489361702
	Train acc at iteration 83: 0.8044871794871795
	Val acc at iteration 82: 0.7553191489361702
	Train acc at iteration 84: 0.8221153846153846
	Val acc at iteration 83: 0.7127659574468085
	Train acc at iteration 85: 0.7932692307692307
	Val acc at iteration 84: 0.6914893617021277
Getting final validation and test accuracy after training.
Computing and storing results metrics
Final val macro f1-score: 0.5428571428571428
Final val micro accuracy: 0.6702127659574468
Final test macro f1-score: 0.5701149425287356
Final test micro accuracy: 0.7021276595744681
Final validation:
	Cluster: 0.6185523867607117
	Separation: 0.5453691780567169
Final test:
	Cluster: 0.593958705663681
	Separation: 0.539861798286438
Saved Results

Attempting combination 39/72:
prototype_shape: (468, 520, 29)
latent_weight: 0.8
joint_weight_decay: -1
gamma: -1
warm_lr_step_size: 5000000
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.01
warm_ptype_lr: 0.4
last_layer_lr: 0.001
last_layer_lr_after_second_push: 0.05
num_warm_epochs: 1000000
push_gap: 12
push_start: 12
num_pushes: 2
last_layer_epochs: 85
joint_lr_step_size: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 36
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.4
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.4
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.4
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.4
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.4
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 7: 0.8085106382978723
Warm optimizer lr: 0.4
Val acc before epoch 8: 0.8297872340425532
Warm optimizer lr: 0.4
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8723404255319149
Push epoch
After push, before retraining last layer:
	Train acc: 0.7660256410256411
	Train Cluster: 0.653130578994751
	Train Separation: 0.5237009763717652
(Directly after push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.5957446808510638
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.648936170212766
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.6170212765957447
	Val acc at iteration 6: 0.6063829787234043
	Val acc at iteration 7: 0.5851063829787234
	Val acc at iteration 8: 0.6063829787234043
	Val acc at iteration 9: 0.6382978723404256
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.5957446808510638
	Val acc at iteration 12: 0.5957446808510638
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.5638297872340425
	Val acc at iteration 15: 0.5638297872340425
	Val acc at iteration 16: 0.6170212765957447
	Val acc at iteration 17: 0.6276595744680851
	Val acc at iteration 18: 0.6170212765957447
	Val acc at iteration 19: 0.6170212765957447
	Val acc at iteration 20: 0.6063829787234043
	Val acc at iteration 21: 0.6276595744680851
	Val acc at iteration 22: 0.648936170212766
	Val acc at iteration 23: 0.5319148936170213
	Val acc at iteration 24: 0.5106382978723404
	Val acc at iteration 25: 0.5851063829787234
	Val acc at iteration 26: 0.6914893617021277
	Val acc at iteration 27: 0.5957446808510638
	Val acc at iteration 28: 0.6382978723404256
	Val acc at iteration 29: 0.6063829787234043
	Val acc at iteration 30: 0.7021276595744681
	Val acc at iteration 31: 0.6170212765957447
	Val acc at iteration 32: 0.6382978723404256
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.648936170212766
	Val acc at iteration 35: 0.6702127659574468
	Val acc at iteration 36: 0.5957446808510638
	Val acc at iteration 37: 0.6702127659574468
	Val acc at iteration 38: 0.5957446808510638
	Val acc at iteration 39: 0.5425531914893617
	Val acc at iteration 40: 0.6702127659574468
	Val acc at iteration 41: 0.6063829787234043
	Val acc at iteration 42: 0.6382978723404256
	Val acc at iteration 43: 0.6382978723404256
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.648936170212766
	Val acc at iteration 48: 0.5851063829787234
	Val acc at iteration 49: 0.6276595744680851
	Val acc at iteration 50: 0.5851063829787234
	Val acc at iteration 51: 0.6276595744680851
	Val acc at iteration 52: 0.6595744680851063
	Val acc at iteration 53: 0.648936170212766
	Val acc at iteration 54: 0.5638297872340425
slurmstepd: error: *** JOB 1845771 ON grtx-1 CANCELLED AT 2024-03-30T15:00:54 ***
