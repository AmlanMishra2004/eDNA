===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Tue Apr  2 00:02:04 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-04-02 00:02:18.640257: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-04-02 00:02:20.248551: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-04-02 00:02:20.421235: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-04-02 00:02:20.577287: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-04-02 00:02:21.297950: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94
Hyperparameters: {'prototype_shape': [(468, 520, 29)], 'latent_weight': [0.9], 'num_warm_epochs': [1000000], 'push_gap': [45], 'num_pushes': [2], 'last_layer_epochs': [85], 'crs_ent_weight': [1], 'clst_weight': [-1], 'sep_weight': [0.001, 0.005, 0.01, 0.05, 0.1, 0.3, 0.5, 0.7, 0.9], 'l1_weight': [0.001], 'push_start': [37], 'p0_warm_ptype_lr': [0.05], 'p0_warm_ptype_gamma': [1], 'p0_warm_ptype_step_size': [5000000], 'p1_last_layer_lr': [0.001], 'p1_warm_ptype_lr': [0.28], 'p1_warm_ptype_gamma': [1], 'p1_warm_ptype_step_size': [5000000], 'p2_last_layer_lr': [0.0007], 'p2_warm_ptype_lr': [0.1], 'p2_warm_ptype_gamma': [-1], 'p2_warm_ptype_step_size': [100], 'p3_last_layer_lr': [7.5e-05], 'p3_warm_ptype_lr': [0.05], 'p3_warm_ptype_gamma': [-1], 'p3_warm_ptype_step_size': [100], 'p4_last_layer_lr': [7.5e-06], 'p4_warm_ptype_lr': [0.05], 'p4_warm_ptype_gamma': [-1], 'p4_warm_ptype_step_size': [100], 'joint_weight_decay': [-1], 'joint_lr_step_size': [-1], 'joint_gamma': [-1], 'joint_optimizer_lrs': [{'features': -1, 'prototype_vectors': -1}]}


Checking hyperparameters: {'sep_weight': [0.001, 0.005, 0.01, 0.05, 0.1, 0.3, 0.5, 0.7, 0.9]}




Exploring 9 hyperparameter combinations for grid search.


Attempting combination 1/9:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 45
num_pushes: 2
last_layer_epochs: 85
crs_ent_weight: 1
clst_weight: -1
sep_weight: 0.001
l1_weight: 0.001
push_start: 37
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 1
p0_warm_ptype_step_size: 5000000
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 1
p1_warm_ptype_step_size: 5000000
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 126
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.24468085106382978
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.5425531914893617
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.6808510638297872
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.9148936170212766
Push epoch at epoch 38.
Final validation accuracy before push: 0.9148936170212766
Push number 1
After push, before retraining last layer:
	Train acc: 0.8269230769230769
	Train Cluster: 0.6485544204711914
	Train Separation: 0.5100470185279846
(Directly after push 2) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.6808510638297872
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.6808510638297872
	Val acc at iteration 7: 0.8085106382978723
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.7021276595744681
	Val acc at iteration 11: 0.7446808510638298
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.6595744680851063
	Val acc at iteration 14: 0.7978723404255319
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.7659574468085106
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.776595744680851
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.723404255319149
	Val acc at iteration 24: 0.7340425531914894
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.7127659574468085
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.7553191489361702
	Val acc at iteration 39: 0.7021276595744681
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.7872340425531915
	Val acc at iteration 45: 0.7021276595744681
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.7446808510638298
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.6914893617021277
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.8085106382978723
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.6808510638297872
	Val acc at iteration 59: 0.7872340425531915
	Val acc at iteration 60: 0.7978723404255319
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.7659574468085106
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.851063829787234
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.7127659574468085
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.8191489361702128
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7553191489361702
	Val acc at iteration 76: 0.7127659574468085
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7553191489361702
	Val acc at iteration 81: 0.7872340425531915
	Val acc at iteration 82: 0.8191489361702128
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.7446808510638298
Val acc before epoch 38: 0.776595744680851
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 40: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 41: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 42: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 43: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 45: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 46: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 47: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 48: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 49: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 53: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 54: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 56: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 57: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 58: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 59: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 63: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 64: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 65: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 70: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 71: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 72: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 73: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 75: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 76: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 77: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 79: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 80: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 81: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 82: 0.9361702127659575
Push epoch at epoch 83.
Final validation accuracy before push: 0.9361702127659575
Push number 2
After push, before retraining last layer:
	Train acc: 0.8349358974358975
	Train Cluster: 0.647502338886261
	Train Separation: 0.5089529514312744
(Directly after push 3) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.776595744680851
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.776595744680851
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.776595744680851
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.7872340425531915
	Val acc at iteration 7: 0.8085106382978723
	Val acc at iteration 8: 0.851063829787234
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.776595744680851
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.8191489361702128
	Val acc at iteration 17: 0.7659574468085106
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.7553191489361702
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.7978723404255319
	Val acc at iteration 23: 0.8085106382978723
	Val acc at iteration 24: 0.7127659574468085
	Val acc at iteration 25: 0.7659574468085106
	Val acc at iteration 26: 0.8085106382978723
	Val acc at iteration 27: 0.7127659574468085
	Val acc at iteration 28: 0.8191489361702128
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.7872340425531915
	Val acc at iteration 31: 0.7872340425531915
	Val acc at iteration 32: 0.7978723404255319
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.8085106382978723
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.7872340425531915
	Val acc at iteration 38: 0.7553191489361702
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.7659574468085106
	Val acc at iteration 42: 0.7446808510638298
	Val acc at iteration 43: 0.7340425531914894
	Val acc at iteration 44: 0.8085106382978723
	Val acc at iteration 45: 0.7127659574468085
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.7021276595744681
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.723404255319149
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.7553191489361702
	Val acc at iteration 57: 0.7978723404255319
	Val acc at iteration 58: 0.7872340425531915
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.7978723404255319
	Val acc at iteration 63: 0.7659574468085106
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.7872340425531915
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.7659574468085106
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7659574468085106
	Val acc at iteration 72: 0.7446808510638298
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.8085106382978723
	Val acc at iteration 75: 0.776595744680851
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.8191489361702128
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7340425531914894
	Val acc at iteration 80: 0.7127659574468085
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.8297872340425532
	Val acc at iteration 83: 0.776595744680851
	Val acc at iteration 84: 0.7872340425531915
Val acc before epoch 83: 0.7553191489361702
Warm optimizer lr: 0.05
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 85: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 86: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 88: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 90: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 92: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 93: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 94: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 95: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 96: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 99: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 100: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 101: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 102: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 104: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 105: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 106: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 107: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 108: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 109: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 110: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 111: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 112: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 113: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 114: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 115: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 116: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 117: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 118: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 119: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 120: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 121: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 122: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 123: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 124: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 125: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 126: 0.9042553191489362
Stopping after epoch 127.
Final validation accuracy before push: 0.9042553191489362
Push number 3
After push, before retraining last layer:
	Train acc: 0.8637820512820513
	Train Cluster: 0.6492107152938843
	TrainSeparation: 0.5058978796005249
(Directly after push 4) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.0007
	Train acc at iteration 1: 0.8605769230769231
	Val acc at iteration 0: 0.7340425531914894
	Train acc at iteration 2: 0.8413461538461539
	Val acc at iteration 1: 0.7978723404255319
	Train acc at iteration 3: 0.8397435897435898
	Val acc at iteration 2: 0.7446808510638298
	Train acc at iteration 4: 0.8766025641025641
	Val acc at iteration 3: 0.7659574468085106
	Train acc at iteration 5: 0.8573717948717948
	Val acc at iteration 4: 0.8085106382978723
	Train acc at iteration 6: 0.842948717948718
	Val acc at iteration 5: 0.7340425531914894
	Train acc at iteration 7: 0.8333333333333334
	Val acc at iteration 6: 0.7446808510638298
	Train acc at iteration 8: 0.8349358974358975
	Val acc at iteration 7: 0.7978723404255319
	Train acc at iteration 9: 0.8381410256410257
	Val acc at iteration 8: 0.7978723404255319
	Train acc at iteration 10: 0.8413461538461539
	Val acc at iteration 9: 0.7340425531914894
	Train acc at iteration 11: 0.8333333333333334
	Val acc at iteration 10: 0.7553191489361702
	Train acc at iteration 12: 0.8397435897435898
	Val acc at iteration 11: 0.8085106382978723
	Train acc at iteration 13: 0.8333333333333334
	Val acc at iteration 12: 0.8085106382978723
	Train acc at iteration 14: 0.8397435897435898
	Val acc at iteration 13: 0.776595744680851
	Train acc at iteration 15: 0.8605769230769231
	Val acc at iteration 14: 0.7553191489361702
	Train acc at iteration 16: 0.8397435897435898
	Val acc at iteration 15: 0.7659574468085106
	Train acc at iteration 17: 0.8253205128205128
	Val acc at iteration 16: 0.7978723404255319
	Train acc at iteration 18: 0.8173076923076923
	Val acc at iteration 17: 0.7127659574468085
	Train acc at iteration 19: 0.8541666666666666
	Val acc at iteration 18: 0.7127659574468085
	Train acc at iteration 20: 0.8413461538461539
	Val acc at iteration 19: 0.7872340425531915
	Train acc at iteration 21: 0.8333333333333334
	Val acc at iteration 20: 0.7659574468085106
	Train acc at iteration 22: 0.8493589743589743
	Val acc at iteration 21: 0.776595744680851
	Train acc at iteration 23: 0.8477564102564102
	Val acc at iteration 22: 0.7553191489361702
	Train acc at iteration 24: 0.8461538461538461
	Val acc at iteration 23: 0.6914893617021277
	Train acc at iteration 25: 0.8108974358974359
	Val acc at iteration 24: 0.6914893617021277
	Train acc at iteration 26: 0.8413461538461539
	Val acc at iteration 25: 0.6702127659574468
	Train acc at iteration 27: 0.8237179487179487
	Val acc at iteration 26: 0.7659574468085106
	Train acc at iteration 28: 0.8317307692307693
	Val acc at iteration 27: 0.7446808510638298
	Train acc at iteration 29: 0.8189102564102564
	Val acc at iteration 28: 0.7021276595744681
	Train acc at iteration 30: 0.8205128205128205
	Val acc at iteration 29: 0.7340425531914894
	Train acc at iteration 31: 0.8221153846153846
	Val acc at iteration 30: 0.7659574468085106
	Train acc at iteration 32: 0.8301282051282052
	Val acc at iteration 31: 0.7659574468085106
	Train acc at iteration 33: 0.8237179487179487
	Val acc at iteration 32: 0.7021276595744681
	Train acc at iteration 34: 0.8108974358974359
	Val acc at iteration 33: 0.776595744680851
	Train acc at iteration 35: 0.8317307692307693
	Val acc at iteration 34: 0.776595744680851
	Train acc at iteration 36: 0.8269230769230769
	Val acc at iteration 35: 0.6382978723404256
	Train acc at iteration 37: 0.8397435897435898
	Val acc at iteration 36: 0.7340425531914894
	Train acc at iteration 38: 0.8349358974358975
	Val acc at iteration 37: 0.7446808510638298
	Train acc at iteration 39: 0.8125
	Val acc at iteration 38: 0.723404255319149
	Train acc at iteration 40: 0.8092948717948718
	Val acc at iteration 39: 0.7127659574468085
	Train acc at iteration 41: 0.8189102564102564
	Val acc at iteration 40: 0.7127659574468085
	Train acc at iteration 42: 0.8173076923076923
	Val acc at iteration 41: 0.7446808510638298
	Train acc at iteration 43: 0.8205128205128205
	Val acc at iteration 42: 0.6808510638297872
	Train acc at iteration 44: 0.8285256410256411
	Val acc at iteration 43: 0.7340425531914894
	Train acc at iteration 45: 0.8253205128205128
	Val acc at iteration 44: 0.723404255319149
	Train acc at iteration 46: 0.8413461538461539
	Val acc at iteration 45: 0.7340425531914894
	Train acc at iteration 47: 0.8237179487179487
	Val acc at iteration 46: 0.7553191489361702
	Train acc at iteration 48: 0.8349358974358975
	Val acc at iteration 47: 0.6595744680851063
	Train acc at iteration 49: 0.8509615384615384
	Val acc at iteration 48: 0.6914893617021277
	Train acc at iteration 50: 0.8141025641025641
	Val acc at iteration 49: 0.6914893617021277
	Train acc at iteration 51: 0.8301282051282052
	Val acc at iteration 50: 0.776595744680851
	Train acc at iteration 52: 0.8076923076923077
	Val acc at iteration 51: 0.6914893617021277
	Train acc at iteration 53: 0.7852564102564102
	Val acc at iteration 52: 0.7446808510638298
	Train acc at iteration 54: 0.8285256410256411
	Val acc at iteration 53: 0.6702127659574468
	Train acc at iteration 55: 0.8060897435897436
	Val acc at iteration 54: 0.6914893617021277
	Train acc at iteration 56: 0.8012820512820513
	Val acc at iteration 55: 0.7340425531914894
	Train acc at iteration 57: 0.8189102564102564
	Val acc at iteration 56: 0.6914893617021277
	Train acc at iteration 58: 0.8205128205128205
	Val acc at iteration 57: 0.723404255319149
	Train acc at iteration 59: 0.8108974358974359
	Val acc at iteration 58: 0.7340425531914894
	Train acc at iteration 60: 0.8125
	Val acc at iteration 59: 0.6702127659574468
	Train acc at iteration 61: 0.8173076923076923
	Val acc at iteration 60: 0.7127659574468085
	Train acc at iteration 62: 0.7900641025641025
	Val acc at iteration 61: 0.6808510638297872
	Train acc at iteration 63: 0.8269230769230769
	Val acc at iteration 62: 0.7553191489361702
	Train acc at iteration 64: 0.8157051282051282
	Val acc at iteration 63: 0.7021276595744681
	Train acc at iteration 65: 0.8365384615384616
	Val acc at iteration 64: 0.7659574468085106
	Train acc at iteration 66: 0.8108974358974359
	Val acc at iteration 65: 0.6914893617021277
	Train acc at iteration 67: 0.8205128205128205
	Val acc at iteration 66: 0.6914893617021277
	Train acc at iteration 68: 0.8253205128205128
	Val acc at iteration 67: 0.7127659574468085
	Train acc at iteration 69: 0.8125
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.842948717948718
	Val acc at iteration 69: 0.7127659574468085
	Train acc at iteration 71: 0.8173076923076923
	Val acc at iteration 70: 0.7659574468085106
	Train acc at iteration 72: 0.8125
	Val acc at iteration 71: 0.6808510638297872
	Train acc at iteration 73: 0.8108974358974359
	Val acc at iteration 72: 0.7446808510638298
	Train acc at iteration 74: 0.8157051282051282
	Val acc at iteration 73: 0.723404255319149
	Train acc at iteration 75: 0.8349358974358975
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.7932692307692307
	Val acc at iteration 75: 0.7446808510638298
	Train acc at iteration 77: 0.7996794871794872
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.8141025641025641
	Val acc at iteration 77: 0.6595744680851063
	Train acc at iteration 79: 0.8092948717948718
	Val acc at iteration 78: 0.7021276595744681
	Train acc at iteration 80: 0.8076923076923077
	Val acc at iteration 79: 0.7127659574468085
	Train acc at iteration 81: 0.8269230769230769
	Val acc at iteration 80: 0.7127659574468085
	Train acc at iteration 82: 0.8157051282051282
	Val acc at iteration 81: 0.6063829787234043
	Train acc at iteration 83: 0.8076923076923077
	Val acc at iteration 82: 0.723404255319149
	Train acc at iteration 84: 0.8141025641025641
	Val acc at iteration 83: 0.7127659574468085
	Train acc at iteration 85: 0.8253205128205128
	Val acc at iteration 84: 0.7659574468085106

Attempting combination 2/9:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 45
num_pushes: 2
last_layer_epochs: 85
crs_ent_weight: 1
clst_weight: -1
sep_weight: 0.005
l1_weight: 0.001
push_start: 37
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 1
p0_warm_ptype_step_size: 5000000
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 1
p1_warm_ptype_step_size: 5000000
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 126
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.3404255319148936
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.9574468085106383
Push epoch at epoch 38.
Final validation accuracy before push: 0.9574468085106383
Push number 1
After push, before retraining last layer:
	Train acc: 0.8269230769230769
	Train Cluster: 0.655514121055603
	Train Separation: 0.510517680644989
(Directly after push 2) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6702127659574468
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.7021276595744681
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.776595744680851
	Val acc at iteration 5: 0.7446808510638298
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.7446808510638298
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.7340425531914894
	Val acc at iteration 11: 0.7872340425531915
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.776595744680851
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.648936170212766
	Val acc at iteration 16: 0.7340425531914894
	Val acc at iteration 17: 0.6808510638297872
	Val acc at iteration 18: 0.7978723404255319
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.776595744680851
	Val acc at iteration 26: 0.776595744680851
	Val acc at iteration 27: 0.7978723404255319
	Val acc at iteration 28: 0.7978723404255319
	Val acc at iteration 29: 0.7872340425531915
	Val acc at iteration 30: 0.6702127659574468
	Val acc at iteration 31: 0.7021276595744681
	Val acc at iteration 32: 0.7872340425531915
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.776595744680851
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.7021276595744681
	Val acc at iteration 38: 0.7659574468085106
	Val acc at iteration 39: 0.7553191489361702
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.6914893617021277
	Val acc at iteration 43: 0.7978723404255319
	Val acc at iteration 44: 0.6702127659574468
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.7978723404255319
	Val acc at iteration 50: 0.7872340425531915
	Val acc at iteration 51: 0.8085106382978723
	Val acc at iteration 52: 0.8191489361702128
	Val acc at iteration 53: 0.7872340425531915
	Val acc at iteration 54: 0.7872340425531915
	Val acc at iteration 55: 0.7446808510638298
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.7553191489361702
	Val acc at iteration 59: 0.7978723404255319
	Val acc at iteration 60: 0.8085106382978723
	Val acc at iteration 61: 0.8297872340425532
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.7553191489361702
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.8404255319148937
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.776595744680851
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.8191489361702128
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.8191489361702128
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.8191489361702128
	Val acc at iteration 74: 0.8297872340425532
	Val acc at iteration 75: 0.723404255319149
	Val acc at iteration 76: 0.8085106382978723
	Val acc at iteration 77: 0.8297872340425532
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.7659574468085106
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.8085106382978723
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 38: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 40: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 45: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 48: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 49: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 57: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 58: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 65: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 67: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 70: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 71: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 72: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 73: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 74: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 75: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 77: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 78: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 81: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 82: 0.9361702127659575
Push epoch at epoch 83.
Final validation accuracy before push: 0.9361702127659575
Push number 2
After push, before retraining last layer:
	Train acc: 0.8397435897435898
	Train Cluster: 0.6518869638442993
	Train Separation: 0.5096472978591919
(Directly after push 3) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.8085106382978723
	Val acc at iteration 1: 0.7553191489361702
	Val acc at iteration 2: 0.8191489361702128
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.8191489361702128
	Val acc at iteration 5: 0.8085106382978723
	Val acc at iteration 6: 0.776595744680851
	Val acc at iteration 7: 0.7446808510638298
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.776595744680851
	Val acc at iteration 11: 0.7659574468085106
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.7872340425531915
	Val acc at iteration 14: 0.8404255319148937
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.776595744680851
	Val acc at iteration 18: 0.7872340425531915
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.7659574468085106
	Val acc at iteration 21: 0.8085106382978723
	Val acc at iteration 22: 0.8297872340425532
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.7978723404255319
	Val acc at iteration 25: 0.7872340425531915
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.8085106382978723
	Val acc at iteration 28: 0.776595744680851
	Val acc at iteration 29: 0.8085106382978723
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.7872340425531915
	Val acc at iteration 32: 0.7872340425531915
	Val acc at iteration 33: 0.7659574468085106
	Val acc at iteration 34: 0.7978723404255319
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.8191489361702128
	Val acc at iteration 37: 0.776595744680851
	Val acc at iteration 38: 0.8085106382978723
	Val acc at iteration 39: 0.776595744680851
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.8191489361702128
	Val acc at iteration 42: 0.723404255319149
	Val acc at iteration 43: 0.8404255319148937
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.7872340425531915
	Val acc at iteration 48: 0.8085106382978723
	Val acc at iteration 49: 0.8191489361702128
	Val acc at iteration 50: 0.7872340425531915
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.776595744680851
	Val acc at iteration 54: 0.8085106382978723
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.8297872340425532
	Val acc at iteration 58: 0.7872340425531915
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.776595744680851
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.7978723404255319
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7872340425531915
	Val acc at iteration 65: 0.8085106382978723
	Val acc at iteration 66: 0.776595744680851
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.8191489361702128
	Val acc at iteration 70: 0.8085106382978723
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.7340425531914894
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.8085106382978723
	Val acc at iteration 75: 0.8404255319148937
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.8085106382978723
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.7446808510638298
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.7978723404255319
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.8297872340425532
	Val acc at iteration 84: 0.8191489361702128
Val acc before epoch 83: 0.7340425531914894
Warm optimizer lr: 0.05
Val acc before epoch 84: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 85: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 89: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 90: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 91: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 94: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 96: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 97: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 98: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 99: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 100: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 101: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 102: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 104: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 105: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 106: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 107: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 108: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 109: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 110: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 111: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 112: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 113: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 114: 0.9893617021276596
Warm optimizer lr: 0.05
Val acc before epoch 115: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 116: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 117: 0.9893617021276596
Warm optimizer lr: 0.05
Val acc before epoch 118: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 119: 0.9893617021276596
Warm optimizer lr: 0.05
Val acc before epoch 120: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 121: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 122: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 123: 0.9893617021276596
Warm optimizer lr: 0.05
Val acc before epoch 124: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 125: 0.9893617021276596
Warm optimizer lr: 0.05
Val acc before epoch 126: 0.9574468085106383
Stopping after epoch 127.
Final validation accuracy before push: 0.9574468085106383
Push number 3
After push, before retraining last layer:
	Train acc: 0.8605769230769231
	Train Cluster: 0.6565888285636902
	TrainSeparation: 0.5135023117065429
(Directly after push 4) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.0007
	Train acc at iteration 1: 0.8092948717948718
	Val acc at iteration 0: 0.7872340425531915
	Train acc at iteration 2: 0.8493589743589743
	Val acc at iteration 1: 0.776595744680851
	Train acc at iteration 3: 0.8509615384615384
	Val acc at iteration 2: 0.7978723404255319
	Train acc at iteration 4: 0.8525641025641025
	Val acc at iteration 3: 0.776595744680851
	Train acc at iteration 5: 0.8589743589743589
	Val acc at iteration 4: 0.776595744680851
	Train acc at iteration 6: 0.844551282051282
	Val acc at iteration 5: 0.7340425531914894
	Train acc at iteration 7: 0.8285256410256411
	Val acc at iteration 6: 0.7872340425531915
	Train acc at iteration 8: 0.8605769230769231
	Val acc at iteration 7: 0.7659574468085106
	Train acc at iteration 9: 0.8301282051282052
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8477564102564102
	Val acc at iteration 9: 0.8191489361702128
	Train acc at iteration 11: 0.8733974358974359
	Val acc at iteration 10: 0.776595744680851
	Train acc at iteration 12: 0.8589743589743589
	Val acc at iteration 11: 0.7659574468085106
	Train acc at iteration 13: 0.8349358974358975
	Val acc at iteration 12: 0.7978723404255319
	Train acc at iteration 14: 0.8573717948717948
	Val acc at iteration 13: 0.7659574468085106
	Train acc at iteration 15: 0.8637820512820513
	Val acc at iteration 14: 0.8085106382978723
	Train acc at iteration 16: 0.8589743589743589
	Val acc at iteration 15: 0.7872340425531915
	Train acc at iteration 17: 0.8573717948717948
	Val acc at iteration 16: 0.7659574468085106
	Train acc at iteration 18: 0.8461538461538461
	Val acc at iteration 17: 0.8085106382978723
	Train acc at iteration 19: 0.8493589743589743
	Val acc at iteration 18: 0.7978723404255319
	Train acc at iteration 20: 0.8541666666666666
	Val acc at iteration 19: 0.776595744680851
	Train acc at iteration 21: 0.8269230769230769
	Val acc at iteration 20: 0.776595744680851
	Train acc at iteration 22: 0.844551282051282
	Val acc at iteration 21: 0.7978723404255319
	Train acc at iteration 23: 0.8541666666666666
	Val acc at iteration 22: 0.7553191489361702
	Train acc at iteration 24: 0.8557692307692307
	Val acc at iteration 23: 0.7978723404255319
	Train acc at iteration 25: 0.8509615384615384
	Val acc at iteration 24: 0.7978723404255319
	Train acc at iteration 26: 0.8317307692307693
	Val acc at iteration 25: 0.7340425531914894
	Train acc at iteration 27: 0.842948717948718
	Val acc at iteration 26: 0.7021276595744681
	Train acc at iteration 28: 0.8365384615384616
	Val acc at iteration 27: 0.7340425531914894
	Train acc at iteration 29: 0.8253205128205128
	Val acc at iteration 28: 0.7872340425531915
	Train acc at iteration 30: 0.844551282051282
	Val acc at iteration 29: 0.723404255319149
	Train acc at iteration 31: 0.8125
	Val acc at iteration 30: 0.7659574468085106
	Train acc at iteration 32: 0.8573717948717948
	Val acc at iteration 31: 0.7340425531914894
	Train acc at iteration 33: 0.8189102564102564
	Val acc at iteration 32: 0.7446808510638298
	Train acc at iteration 34: 0.842948717948718
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.8269230769230769
	Val acc at iteration 34: 0.7446808510638298
	Train acc at iteration 36: 0.8285256410256411
	Val acc at iteration 35: 0.7340425531914894
	Train acc at iteration 37: 0.8285256410256411
	Val acc at iteration 36: 0.7446808510638298
	Train acc at iteration 38: 0.8285256410256411
	Val acc at iteration 37: 0.7340425531914894
	Train acc at iteration 39: 0.842948717948718
	Val acc at iteration 38: 0.6808510638297872
	Train acc at iteration 40: 0.844551282051282
	Val acc at iteration 39: 0.7553191489361702
	Train acc at iteration 41: 0.8173076923076923
	Val acc at iteration 40: 0.776595744680851
	Train acc at iteration 42: 0.7980769230769231
	Val acc at iteration 41: 0.6914893617021277
	Train acc at iteration 43: 0.7996794871794872
	Val acc at iteration 42: 0.7340425531914894
	Train acc at iteration 44: 0.8413461538461539
	Val acc at iteration 43: 0.723404255319149
	Train acc at iteration 45: 0.8365384615384616
	Val acc at iteration 44: 0.7446808510638298
	Train acc at iteration 46: 0.8301282051282052
	Val acc at iteration 45: 0.776595744680851
	Train acc at iteration 47: 0.8589743589743589
	Val acc at iteration 46: 0.8191489361702128
	Train acc at iteration 48: 0.8477564102564102
	Val acc at iteration 47: 0.6914893617021277
	Train acc at iteration 49: 0.8285256410256411
	Val acc at iteration 48: 0.7872340425531915
	Train acc at iteration 50: 0.8317307692307693
	Val acc at iteration 49: 0.7978723404255319
	Train acc at iteration 51: 0.8525641025641025
	Val acc at iteration 50: 0.7021276595744681
	Train acc at iteration 52: 0.8285256410256411
	Val acc at iteration 51: 0.7978723404255319
	Train acc at iteration 53: 0.7916666666666666
	Val acc at iteration 52: 0.723404255319149
	Train acc at iteration 54: 0.8237179487179487
	Val acc at iteration 53: 0.723404255319149
	Train acc at iteration 55: 0.8237179487179487
	Val acc at iteration 54: 0.7553191489361702
	Train acc at iteration 56: 0.8493589743589743
	Val acc at iteration 55: 0.7659574468085106
	Train acc at iteration 57: 0.842948717948718
	Val acc at iteration 56: 0.7446808510638298
	Train acc at iteration 58: 0.7964743589743589
	Val acc at iteration 57: 0.7446808510638298
	Train acc at iteration 59: 0.8221153846153846
	Val acc at iteration 58: 0.7978723404255319
	Train acc at iteration 60: 0.8205128205128205
	Val acc at iteration 59: 0.776595744680851
	Train acc at iteration 61: 0.844551282051282
	Val acc at iteration 60: 0.7340425531914894
	Train acc at iteration 62: 0.842948717948718
	Val acc at iteration 61: 0.7553191489361702
	Train acc at iteration 63: 0.8349358974358975
	Val acc at iteration 62: 0.7446808510638298
	Train acc at iteration 64: 0.8221153846153846
	Val acc at iteration 63: 0.7553191489361702
	Train acc at iteration 65: 0.8237179487179487
	Val acc at iteration 64: 0.7553191489361702
	Train acc at iteration 66: 0.8301282051282052
	Val acc at iteration 65: 0.7127659574468085
	Train acc at iteration 67: 0.8141025641025641
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.8301282051282052
	Val acc at iteration 67: 0.7553191489361702
	Train acc at iteration 69: 0.8141025641025641
	Val acc at iteration 68: 0.7021276595744681
	Train acc at iteration 70: 0.8237179487179487
	Val acc at iteration 69: 0.776595744680851
	Train acc at iteration 71: 0.8205128205128205
	Val acc at iteration 70: 0.7021276595744681
	Train acc at iteration 72: 0.8333333333333334
	Val acc at iteration 71: 0.7872340425531915
	Train acc at iteration 73: 0.8173076923076923
	Val acc at iteration 72: 0.6702127659574468
	Train acc at iteration 74: 0.8157051282051282
	Val acc at iteration 73: 0.6808510638297872
	Train acc at iteration 75: 0.8349358974358975
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.8205128205128205
	Val acc at iteration 75: 0.7340425531914894
	Train acc at iteration 77: 0.8060897435897436
	Val acc at iteration 76: 0.8404255319148937
	Train acc at iteration 78: 0.8557692307692307
	Val acc at iteration 77: 0.7978723404255319
	Train acc at iteration 79: 0.8221153846153846
	Val acc at iteration 78: 0.7446808510638298
	Train acc at iteration 80: 0.8237179487179487
	Val acc at iteration 79: 0.7021276595744681
	Train acc at iteration 81: 0.8125
	Val acc at iteration 80: 0.7021276595744681
	Train acc at iteration 82: 0.8060897435897436
	Val acc at iteration 81: 0.7340425531914894
	Train acc at iteration 83: 0.8189102564102564
	Val acc at iteration 82: 0.7659574468085106
	Train acc at iteration 84: 0.842948717948718
	Val acc at iteration 83: 0.851063829787234
	Train acc at iteration 85: 0.8269230769230769
	Val acc at iteration 84: 0.7127659574468085

Attempting combination 3/9:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 45
num_pushes: 2
last_layer_epochs: 85
crs_ent_weight: 1
clst_weight: -1
sep_weight: 0.01
l1_weight: 0.001
push_start: 37
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 1
p0_warm_ptype_step_size: 5000000
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 1
p1_warm_ptype_step_size: 5000000
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 126
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.30851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.9468085106382979
Push epoch at epoch 38.
Final validation accuracy before push: 0.9468085106382979
Push number 1
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Train Cluster: 0.642306137084961
	Train Separation: 0.508759605884552
(Directly after push 2) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.7553191489361702
	Val acc at iteration 2: 0.7127659574468085
	Val acc at iteration 3: 0.7021276595744681
	Val acc at iteration 4: 0.648936170212766
	Val acc at iteration 5: 0.6595744680851063
	Val acc at iteration 6: 0.8085106382978723
	Val acc at iteration 7: 0.776595744680851
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7446808510638298
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.7872340425531915
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7978723404255319
	Val acc at iteration 21: 0.8297872340425532
	Val acc at iteration 22: 0.723404255319149
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.776595744680851
	Val acc at iteration 27: 0.6702127659574468
	Val acc at iteration 28: 0.7021276595744681
	Val acc at iteration 29: 0.723404255319149
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.7127659574468085
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.6808510638297872
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.6595744680851063
	Val acc at iteration 40: 0.7659574468085106
	Val acc at iteration 41: 0.7659574468085106
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.7127659574468085
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.7340425531914894
	Val acc at iteration 46: 0.7872340425531915
	Val acc at iteration 47: 0.7659574468085106
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.7021276595744681
	Val acc at iteration 50: 0.7978723404255319
	Val acc at iteration 51: 0.7340425531914894
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.776595744680851
	Val acc at iteration 54: 0.7340425531914894
	Val acc at iteration 55: 0.7340425531914894
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7872340425531915
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7872340425531915
	Val acc at iteration 60: 0.7978723404255319
	Val acc at iteration 61: 0.7446808510638298
	Val acc at iteration 62: 0.7127659574468085
	Val acc at iteration 63: 0.776595744680851
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.7446808510638298
	Val acc at iteration 67: 0.776595744680851
	Val acc at iteration 68: 0.776595744680851
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.723404255319149
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.7553191489361702
	Val acc at iteration 74: 0.7553191489361702
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.8191489361702128
	Val acc at iteration 77: 0.8085106382978723
	Val acc at iteration 78: 0.7978723404255319
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.776595744680851
	Val acc at iteration 81: 0.7021276595744681
	Val acc at iteration 82: 0.7021276595744681
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 38: 0.6914893617021277
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 40: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 41: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 43: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 44: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 45: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 48: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 51: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 54: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 57: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 59: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 68: 0.9893617021276596
Warm optimizer lr: 0.05
Val acc before epoch 69: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 70: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 71: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 72: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 73: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 74: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 75: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 76: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 77: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 80: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 81: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 82: 0.9042553191489362
Push epoch at epoch 83.
Final validation accuracy before push: 0.9042553191489362
Push number 2
After push, before retraining last layer:
	Train acc: 0.8381410256410257
	Train Cluster: 0.6432465553283692
	Train Separation: 0.5098850309848786
(Directly after push 3) Val acc at iteration 0: 0.7978723404255319
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7872340425531915
	Val acc at iteration 1: 0.7340425531914894
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7978723404255319
	Val acc at iteration 5: 0.776595744680851
	Val acc at iteration 6: 0.8085106382978723
	Val acc at iteration 7: 0.776595744680851
	Val acc at iteration 8: 0.7340425531914894
	Val acc at iteration 9: 0.7659574468085106
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7446808510638298
	Val acc at iteration 13: 0.776595744680851
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.8085106382978723
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.6808510638297872
	Val acc at iteration 22: 0.7872340425531915
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.851063829787234
	Val acc at iteration 25: 0.6808510638297872
	Val acc at iteration 26: 0.776595744680851
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.776595744680851
	Val acc at iteration 29: 0.7553191489361702
	Val acc at iteration 30: 0.7553191489361702
	Val acc at iteration 31: 0.8191489361702128
	Val acc at iteration 32: 0.7659574468085106
	Val acc at iteration 33: 0.8191489361702128
	Val acc at iteration 34: 0.7553191489361702
	Val acc at iteration 35: 0.7872340425531915
	Val acc at iteration 36: 0.7978723404255319
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.7553191489361702
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.776595744680851
	Val acc at iteration 41: 0.8617021276595744
	Val acc at iteration 42: 0.7978723404255319
	Val acc at iteration 43: 0.8085106382978723
	Val acc at iteration 44: 0.7553191489361702
	Val acc at iteration 45: 0.7978723404255319
	Val acc at iteration 46: 0.7978723404255319
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.8191489361702128
	Val acc at iteration 49: 0.6808510638297872
	Val acc at iteration 50: 0.851063829787234
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.8191489361702128
	Val acc at iteration 54: 0.8085106382978723
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.8085106382978723
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.7872340425531915
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.7127659574468085
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.7553191489361702
	Val acc at iteration 66: 0.7978723404255319
	Val acc at iteration 67: 0.7978723404255319
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.7553191489361702
	Val acc at iteration 73: 0.8297872340425532
	Val acc at iteration 74: 0.7978723404255319
	Val acc at iteration 75: 0.8085106382978723
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7127659574468085
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.7553191489361702
	Val acc at iteration 82: 0.8085106382978723
	Val acc at iteration 83: 0.7978723404255319
	Val acc at iteration 84: 0.7978723404255319
Val acc before epoch 83: 0.7446808510638298
Warm optimizer lr: 0.05
Val acc before epoch 84: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 85: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 86: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 89: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 91: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 92: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 94: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 95: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 96: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 97: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 98: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 99: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 100: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 101: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 102: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 103: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 104: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 105: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 106: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 107: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 108: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 109: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 110: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 111: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 112: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 113: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 114: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 115: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 116: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 117: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 118: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 119: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 120: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 121: 1.0
Warm optimizer lr: 0.05
Val acc before epoch 122: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 123: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 124: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 125: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 126: 0.9361702127659575
Stopping after epoch 127.
Final validation accuracy before push: 0.9361702127659575
Push number 3
After push, before retraining last layer:
	Train acc: 0.8237179487179487
	Train Cluster: 0.6423741936683655
	TrainSeparation: 0.510336410999298
(Directly after push 4) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.0007
	Train acc at iteration 1: 0.8253205128205128
	Val acc at iteration 0: 0.7659574468085106
	Train acc at iteration 2: 0.8173076923076923
	Val acc at iteration 1: 0.6808510638297872
	Train acc at iteration 3: 0.8173076923076923
	Val acc at iteration 2: 0.7978723404255319
	Train acc at iteration 4: 0.8365384615384616
	Val acc at iteration 3: 0.8297872340425532
	Train acc at iteration 5: 0.8525641025641025
	Val acc at iteration 4: 0.776595744680851
	Train acc at iteration 6: 0.8493589743589743
	Val acc at iteration 5: 0.776595744680851
	Train acc at iteration 7: 0.8317307692307693
	Val acc at iteration 6: 0.8191489361702128
	Train acc at iteration 8: 0.8557692307692307
	Val acc at iteration 7: 0.7340425531914894
	Train acc at iteration 9: 0.8365384615384616
	Val acc at iteration 8: 0.8829787234042553
	Train acc at iteration 10: 0.8461538461538461
	Val acc at iteration 9: 0.776595744680851
	Train acc at iteration 11: 0.8477564102564102
	Val acc at iteration 10: 0.7978723404255319
	Train acc at iteration 12: 0.8237179487179487
	Val acc at iteration 11: 0.776595744680851
	Train acc at iteration 13: 0.8349358974358975
	Val acc at iteration 12: 0.7553191489361702
	Train acc at iteration 14: 0.8333333333333334
	Val acc at iteration 13: 0.851063829787234
	Train acc at iteration 15: 0.8349358974358975
	Val acc at iteration 14: 0.7553191489361702
	Train acc at iteration 16: 0.8365384615384616
	Val acc at iteration 15: 0.7127659574468085
	Train acc at iteration 17: 0.8381410256410257
	Val acc at iteration 16: 0.7127659574468085
	Train acc at iteration 18: 0.844551282051282
	Val acc at iteration 17: 0.7872340425531915
	Train acc at iteration 19: 0.842948717948718
	Val acc at iteration 18: 0.7446808510638298
	Train acc at iteration 20: 0.8285256410256411
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.8477564102564102
	Val acc at iteration 20: 0.7127659574468085
	Train acc at iteration 22: 0.844551282051282
	Val acc at iteration 21: 0.723404255319149
	Train acc at iteration 23: 0.8044871794871795
	Val acc at iteration 22: 0.6914893617021277
	Train acc at iteration 24: 0.8461538461538461
	Val acc at iteration 23: 0.7446808510638298
	Train acc at iteration 25: 0.8349358974358975
	Val acc at iteration 24: 0.7872340425531915
	Train acc at iteration 26: 0.8253205128205128
	Val acc at iteration 25: 0.723404255319149
	Train acc at iteration 27: 0.8413461538461539
	Val acc at iteration 26: 0.7446808510638298
	Train acc at iteration 28: 0.8173076923076923
	Val acc at iteration 27: 0.7553191489361702
	Train acc at iteration 29: 0.8205128205128205
	Val acc at iteration 28: 0.776595744680851
	Train acc at iteration 30: 0.8221153846153846
	Val acc at iteration 29: 0.7446808510638298
	Train acc at iteration 31: 0.8076923076923077
	Val acc at iteration 30: 0.7021276595744681
	Train acc at iteration 32: 0.8221153846153846
	Val acc at iteration 31: 0.7340425531914894
	Train acc at iteration 33: 0.8301282051282052
	Val acc at iteration 32: 0.723404255319149
	Train acc at iteration 34: 0.8092948717948718
	Val acc at iteration 33: 0.6808510638297872
	Train acc at iteration 35: 0.8108974358974359
	Val acc at iteration 34: 0.7446808510638298
	Train acc at iteration 36: 0.8189102564102564
	Val acc at iteration 35: 0.7127659574468085
	Train acc at iteration 37: 0.8076923076923077
	Val acc at iteration 36: 0.7446808510638298
	Train acc at iteration 38: 0.8333333333333334
	Val acc at iteration 37: 0.7553191489361702
	Train acc at iteration 39: 0.8189102564102564
	Val acc at iteration 38: 0.776595744680851
	Train acc at iteration 40: 0.8092948717948718
	Val acc at iteration 39: 0.723404255319149
	Train acc at iteration 41: 0.8237179487179487
	Val acc at iteration 40: 0.7127659574468085
	Train acc at iteration 42: 0.8365384615384616
	Val acc at iteration 41: 0.648936170212766
	Train acc at iteration 43: 0.8189102564102564
	Val acc at iteration 42: 0.7446808510638298
	Train acc at iteration 44: 0.8301282051282052
	Val acc at iteration 43: 0.7446808510638298
	Train acc at iteration 45: 0.7964743589743589
	Val acc at iteration 44: 0.723404255319149
	Train acc at iteration 46: 0.8301282051282052
	Val acc at iteration 45: 0.7659574468085106
	Train acc at iteration 47: 0.8125
	Val acc at iteration 46: 0.7659574468085106
	Train acc at iteration 48: 0.8253205128205128
	Val acc at iteration 47: 0.7446808510638298
	Train acc at iteration 49: 0.8189102564102564
	Val acc at iteration 48: 0.7127659574468085
	Train acc at iteration 50: 0.8012820512820513
	Val acc at iteration 49: 0.7553191489361702
	Train acc at iteration 51: 0.8173076923076923
	Val acc at iteration 50: 0.7127659574468085
	Train acc at iteration 52: 0.8301282051282052
	Val acc at iteration 51: 0.7659574468085106
	Train acc at iteration 53: 0.7676282051282052
	Val acc at iteration 52: 0.7127659574468085
	Train acc at iteration 54: 0.7964743589743589
	Val acc at iteration 53: 0.6595744680851063
	Train acc at iteration 55: 0.8108974358974359
	Val acc at iteration 54: 0.723404255319149
	Train acc at iteration 56: 0.7964743589743589
	Val acc at iteration 55: 0.7021276595744681
	Train acc at iteration 57: 0.7932692307692307
	Val acc at iteration 56: 0.776595744680851
	Train acc at iteration 58: 0.8125
	Val acc at iteration 57: 0.648936170212766
	Train acc at iteration 59: 0.8237179487179487
	Val acc at iteration 58: 0.776595744680851
	Train acc at iteration 60: 0.7916666666666666
	Val acc at iteration 59: 0.6808510638297872
	Train acc at iteration 61: 0.8237179487179487
	Val acc at iteration 60: 0.7978723404255319
	Train acc at iteration 62: 0.8108974358974359
	Val acc at iteration 61: 0.723404255319149
	Train acc at iteration 63: 0.8317307692307693
	Val acc at iteration 62: 0.723404255319149
	Train acc at iteration 64: 0.8125
	Val acc at iteration 63: 0.7553191489361702
	Train acc at iteration 65: 0.7996794871794872
	Val acc at iteration 64: 0.776595744680851
	Train acc at iteration 66: 0.8092948717948718
	Val acc at iteration 65: 0.7127659574468085
	Train acc at iteration 67: 0.8076923076923077
	Val acc at iteration 66: 0.7127659574468085
	Train acc at iteration 68: 0.7980769230769231
	Val acc at iteration 67: 0.7446808510638298
	Train acc at iteration 69: 0.8269230769230769
	Val acc at iteration 68: 0.7659574468085106
	Train acc at iteration 70: 0.8092948717948718
	Val acc at iteration 69: 0.7127659574468085
	Train acc at iteration 71: 0.8189102564102564
	Val acc at iteration 70: 0.7127659574468085
	Train acc at iteration 72: 0.8028846153846154
	Val acc at iteration 71: 0.723404255319149
	Train acc at iteration 73: 0.8317307692307693
	Val acc at iteration 72: 0.7340425531914894
	Train acc at iteration 74: 0.7964743589743589
	Val acc at iteration 73: 0.7553191489361702
	Train acc at iteration 75: 0.8076923076923077
	Val acc at iteration 74: 0.7127659574468085
	Train acc at iteration 76: 0.8125
	Val acc at iteration 75: 0.7127659574468085
	Train acc at iteration 77: 0.7996794871794872
	Val acc at iteration 76: 0.776595744680851
	Train acc at iteration 78: 0.8141025641025641
	Val acc at iteration 77: 0.8085106382978723
	Train acc at iteration 79: 0.8092948717948718
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.8092948717948718
	Val acc at iteration 79: 0.6914893617021277
	Train acc at iteration 81: 0.8397435897435898
	Val acc at iteration 80: 0.7021276595744681
	Train acc at iteration 82: 0.8269230769230769
	Val acc at iteration 81: 0.6914893617021277
	Train acc at iteration 83: 0.8060897435897436
	Val acc at iteration 82: 0.7659574468085106
	Train acc at iteration 84: 0.8301282051282052
	Val acc at iteration 83: 0.7872340425531915
	Train acc at iteration 85: 0.8044871794871795
	Val acc at iteration 84: 0.7021276595744681

Attempting combination 4/9:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 45
num_pushes: 2
last_layer_epochs: 85
crs_ent_weight: 1
clst_weight: -1
sep_weight: 0.05
l1_weight: 0.001
push_start: 37
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 1
p0_warm_ptype_step_size: 5000000
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 1
p1_warm_ptype_step_size: 5000000
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 126
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.32978723404255317
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.5957446808510638
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.925531914893617
Push epoch at epoch 38.
Final validation accuracy before push: 0.925531914893617
Push number 1
After push, before retraining last layer:
	Train acc: 0.8349358974358975
	Train Cluster: 0.6479422211647033
	Train Separation: 0.5112309217453003
(Directly after push 2) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6808510638297872
	Val acc at iteration 1: 0.6276595744680851
	Val acc at iteration 2: 0.6595744680851063
	Val acc at iteration 3: 0.6808510638297872
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7340425531914894
	Val acc at iteration 8: 0.7021276595744681
	Val acc at iteration 9: 0.7127659574468085
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7127659574468085
	Val acc at iteration 13: 0.7340425531914894
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.6808510638297872
	Val acc at iteration 16: 0.7659574468085106
	Val acc at iteration 17: 0.7978723404255319
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.7127659574468085
	Val acc at iteration 20: 0.7659574468085106
	Val acc at iteration 21: 0.6702127659574468
	Val acc at iteration 22: 0.6914893617021277
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.7021276595744681
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.723404255319149
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6595744680851063
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.6382978723404256
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.7659574468085106
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.7021276595744681
	Val acc at iteration 41: 0.7446808510638298
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.7021276595744681
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.6808510638297872
	Val acc at iteration 49: 0.7127659574468085
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.7872340425531915
	Val acc at iteration 53: 0.723404255319149
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.8191489361702128
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.7872340425531915
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7659574468085106
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.7659574468085106
	Val acc at iteration 62: 0.6914893617021277
	Val acc at iteration 63: 0.6595744680851063
	Val acc at iteration 64: 0.6808510638297872
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.723404255319149
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.7021276595744681
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.8085106382978723
	Val acc at iteration 72: 0.6702127659574468
	Val acc at iteration 73: 0.7978723404255319
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.7872340425531915
	Val acc at iteration 76: 0.776595744680851
	Val acc at iteration 77: 0.723404255319149
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.6914893617021277
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 38: 0.7340425531914894
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 40: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 41: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 48: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 49: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 54: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 57: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 58: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 60: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 61: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 64: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 65: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 66: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 68: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 70: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 71: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 72: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 73: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 74: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 75: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 76: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 77: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 78: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 79: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 80: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 81: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 82: 0.9574468085106383
Push epoch at epoch 83.
Final validation accuracy before push: 0.9574468085106383
Push number 2
After push, before retraining last layer:
	Train acc: 0.8317307692307693
	Train Cluster: 0.6450999736785888
	Train Separation: 0.5089713096618652
(Directly after push 3) Val acc at iteration 0: 0.7978723404255319
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7872340425531915
	Val acc at iteration 1: 0.7553191489361702
	Val acc at iteration 2: 0.7872340425531915
	Val acc at iteration 3: 0.7978723404255319
	Val acc at iteration 4: 0.7872340425531915
	Val acc at iteration 5: 0.723404255319149
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.7553191489361702
	Val acc at iteration 8: 0.7127659574468085
	Val acc at iteration 9: 0.7978723404255319
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.851063829787234
	Val acc at iteration 14: 0.7446808510638298
	Val acc at iteration 15: 0.8085106382978723
	Val acc at iteration 16: 0.776595744680851
	Val acc at iteration 17: 0.7446808510638298
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.8191489361702128
	Val acc at iteration 20: 0.7978723404255319
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.7978723404255319
	Val acc at iteration 23: 0.7978723404255319
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.8297872340425532
	Val acc at iteration 26: 0.7659574468085106
	Val acc at iteration 27: 0.776595744680851
	Val acc at iteration 28: 0.776595744680851
	Val acc at iteration 29: 0.776595744680851
	Val acc at iteration 30: 0.7978723404255319
	Val acc at iteration 31: 0.7872340425531915
	Val acc at iteration 32: 0.7872340425531915
	Val acc at iteration 33: 0.7659574468085106
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.7872340425531915
	Val acc at iteration 37: 0.7872340425531915
	Val acc at iteration 38: 0.8297872340425532
	Val acc at iteration 39: 0.6914893617021277
	Val acc at iteration 40: 0.7872340425531915
	Val acc at iteration 41: 0.8085106382978723
	Val acc at iteration 42: 0.8085106382978723
	Val acc at iteration 43: 0.7978723404255319
	Val acc at iteration 44: 0.7340425531914894
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.648936170212766
	Val acc at iteration 47: 0.6808510638297872
	Val acc at iteration 48: 0.8191489361702128
	Val acc at iteration 49: 0.6914893617021277
	Val acc at iteration 50: 0.8085106382978723
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.7127659574468085
	Val acc at iteration 53: 0.776595744680851
	Val acc at iteration 54: 0.8085106382978723
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.776595744680851
	Val acc at iteration 57: 0.776595744680851
	Val acc at iteration 58: 0.8297872340425532
	Val acc at iteration 59: 0.8297872340425532
	Val acc at iteration 60: 0.776595744680851
	Val acc at iteration 61: 0.7978723404255319
	Val acc at iteration 62: 0.8191489361702128
	Val acc at iteration 63: 0.7872340425531915
	Val acc at iteration 64: 0.7659574468085106
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.8191489361702128
	Val acc at iteration 68: 0.8297872340425532
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7872340425531915
	Val acc at iteration 72: 0.8085106382978723
	Val acc at iteration 73: 0.7978723404255319
	Val acc at iteration 74: 0.7872340425531915
	Val acc at iteration 75: 0.7872340425531915
	Val acc at iteration 76: 0.7872340425531915
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.6914893617021277
	Val acc at iteration 79: 0.7659574468085106
	Val acc at iteration 80: 0.8297872340425532
	Val acc at iteration 81: 0.7872340425531915
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.8085106382978723
	Val acc at iteration 84: 0.7340425531914894
Val acc before epoch 83: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 84: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 85: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 86: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 88: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 90: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 96: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 97: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 98: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 99: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 100: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 101: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 102: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 103: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 104: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 105: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 106: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 107: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 108: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 109: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 110: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 111: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 112: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 113: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 114: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 115: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 116: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 117: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 118: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 119: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 120: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 121: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 122: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 123: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 124: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 125: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 126: 0.9361702127659575
Stopping after epoch 127.
Final validation accuracy before push: 0.9361702127659575
Push number 3
After push, before retraining last layer:
	Train acc: 0.842948717948718
	Train Cluster: 0.6526792883872986
	TrainSeparation: 0.5130449891090393
(Directly after push 4) Val acc at iteration 0: 0.8191489361702128
Retraining last layer
Last layer lr: 0.0007
	Train acc at iteration 1: 0.8301282051282052
	Val acc at iteration 0: 0.7340425531914894
	Train acc at iteration 2: 0.8317307692307693
	Val acc at iteration 1: 0.776595744680851
	Train acc at iteration 3: 0.8525641025641025
	Val acc at iteration 2: 0.8191489361702128
	Train acc at iteration 4: 0.8269230769230769
	Val acc at iteration 3: 0.7978723404255319
	Train acc at iteration 5: 0.8461538461538461
	Val acc at iteration 4: 0.7553191489361702
	Train acc at iteration 6: 0.8301282051282052
	Val acc at iteration 5: 0.8085106382978723
	Train acc at iteration 7: 0.8717948717948718
	Val acc at iteration 6: 0.8191489361702128
	Train acc at iteration 8: 0.8381410256410257
	Val acc at iteration 7: 0.8085106382978723
	Train acc at iteration 9: 0.875
	Val acc at iteration 8: 0.7872340425531915
	Train acc at iteration 10: 0.8557692307692307
	Val acc at iteration 9: 0.8404255319148937
	Train acc at iteration 11: 0.8253205128205128
	Val acc at iteration 10: 0.776595744680851
	Train acc at iteration 12: 0.844551282051282
	Val acc at iteration 11: 0.7659574468085106
	Train acc at iteration 13: 0.8237179487179487
	Val acc at iteration 12: 0.7021276595744681
	Train acc at iteration 14: 0.8317307692307693
	Val acc at iteration 13: 0.8404255319148937
	Train acc at iteration 15: 0.8349358974358975
	Val acc at iteration 14: 0.723404255319149
	Train acc at iteration 16: 0.8557692307692307
	Val acc at iteration 15: 0.8404255319148937
	Train acc at iteration 17: 0.844551282051282
	Val acc at iteration 16: 0.7446808510638298
	Train acc at iteration 18: 0.8413461538461539
	Val acc at iteration 17: 0.7872340425531915
	Train acc at iteration 19: 0.8381410256410257
	Val acc at iteration 18: 0.7978723404255319
	Train acc at iteration 20: 0.8493589743589743
	Val acc at iteration 19: 0.7659574468085106
	Train acc at iteration 21: 0.8541666666666666
	Val acc at iteration 20: 0.776595744680851
	Train acc at iteration 22: 0.844551282051282
	Val acc at iteration 21: 0.8191489361702128
	Train acc at iteration 23: 0.8092948717948718
	Val acc at iteration 22: 0.7446808510638298
	Train acc at iteration 24: 0.8189102564102564
	Val acc at iteration 23: 0.7553191489361702
	Train acc at iteration 25: 0.8557692307692307
	Val acc at iteration 24: 0.7872340425531915
	Train acc at iteration 26: 0.8108974358974359
	Val acc at iteration 25: 0.7978723404255319
	Train acc at iteration 27: 0.8237179487179487
	Val acc at iteration 26: 0.776595744680851
	Train acc at iteration 28: 0.8509615384615384
	Val acc at iteration 27: 0.7021276595744681
	Train acc at iteration 29: 0.8365384615384616
	Val acc at iteration 28: 0.7446808510638298
	Train acc at iteration 30: 0.8541666666666666
	Val acc at iteration 29: 0.7446808510638298
	Train acc at iteration 31: 0.8413461538461539
	Val acc at iteration 30: 0.8085106382978723
	Train acc at iteration 32: 0.8269230769230769
	Val acc at iteration 31: 0.776595744680851
	Train acc at iteration 33: 0.8237179487179487
	Val acc at iteration 32: 0.7127659574468085
	Train acc at iteration 34: 0.8381410256410257
	Val acc at iteration 33: 0.776595744680851
	Train acc at iteration 35: 0.8285256410256411
	Val acc at iteration 34: 0.7553191489361702
	Train acc at iteration 36: 0.8189102564102564
	Val acc at iteration 35: 0.7021276595744681
	Train acc at iteration 37: 0.7964743589743589
	Val acc at iteration 36: 0.7340425531914894
	Train acc at iteration 38: 0.7964743589743589
	Val acc at iteration 37: 0.7021276595744681
	Train acc at iteration 39: 0.8237179487179487
	Val acc at iteration 38: 0.7659574468085106
	Train acc at iteration 40: 0.8076923076923077
	Val acc at iteration 39: 0.7872340425531915
	Train acc at iteration 41: 0.8253205128205128
	Val acc at iteration 40: 0.7553191489361702
	Train acc at iteration 42: 0.8205128205128205
	Val acc at iteration 41: 0.8191489361702128
	Train acc at iteration 43: 0.8301282051282052
	Val acc at iteration 42: 0.7446808510638298
	Train acc at iteration 44: 0.8076923076923077
	Val acc at iteration 43: 0.7021276595744681
	Train acc at iteration 45: 0.8092948717948718
	Val acc at iteration 44: 0.7340425531914894
	Train acc at iteration 46: 0.8317307692307693
	Val acc at iteration 45: 0.6808510638297872
	Train acc at iteration 47: 0.8349358974358975
	Val acc at iteration 46: 0.6702127659574468
	Train acc at iteration 48: 0.8253205128205128
	Val acc at iteration 47: 0.7127659574468085
	Train acc at iteration 49: 0.8221153846153846
	Val acc at iteration 48: 0.7021276595744681
	Train acc at iteration 50: 0.8221153846153846
	Val acc at iteration 49: 0.776595744680851
	Train acc at iteration 51: 0.8189102564102564
	Val acc at iteration 50: 0.7340425531914894
	Train acc at iteration 52: 0.8205128205128205
	Val acc at iteration 51: 0.723404255319149
	Train acc at iteration 53: 0.8189102564102564
	Val acc at iteration 52: 0.776595744680851
	Train acc at iteration 54: 0.8285256410256411
	Val acc at iteration 53: 0.776595744680851
	Train acc at iteration 55: 0.8221153846153846
	Val acc at iteration 54: 0.6914893617021277
	Train acc at iteration 56: 0.8253205128205128
	Val acc at iteration 55: 0.6382978723404256
	Train acc at iteration 57: 0.8157051282051282
	Val acc at iteration 56: 0.7021276595744681
	Train acc at iteration 58: 0.8028846153846154
	Val acc at iteration 57: 0.7446808510638298
	Train acc at iteration 59: 0.8205128205128205
	Val acc at iteration 58: 0.7021276595744681
	Train acc at iteration 60: 0.8285256410256411
	Val acc at iteration 59: 0.7872340425531915
	Train acc at iteration 61: 0.8333333333333334
	Val acc at iteration 60: 0.7553191489361702
	Train acc at iteration 62: 0.8157051282051282
	Val acc at iteration 61: 0.7127659574468085
	Train acc at iteration 63: 0.8173076923076923
	Val acc at iteration 62: 0.6914893617021277
	Train acc at iteration 64: 0.8189102564102564
	Val acc at iteration 63: 0.6914893617021277
	Train acc at iteration 65: 0.8237179487179487
	Val acc at iteration 64: 0.7127659574468085
	Train acc at iteration 66: 0.8349358974358975
	Val acc at iteration 65: 0.7127659574468085
	Train acc at iteration 67: 0.8301282051282052
	Val acc at iteration 66: 0.7659574468085106
	Train acc at iteration 68: 0.8028846153846154
	Val acc at iteration 67: 0.776595744680851
	Train acc at iteration 69: 0.7996794871794872
	Val acc at iteration 68: 0.7446808510638298
	Train acc at iteration 70: 0.8060897435897436
	Val acc at iteration 69: 0.6914893617021277
	Train acc at iteration 71: 0.8349358974358975
	Val acc at iteration 70: 0.7446808510638298
	Train acc at iteration 72: 0.8173076923076923
	Val acc at iteration 71: 0.7659574468085106
	Train acc at iteration 73: 0.8012820512820513
	Val acc at iteration 72: 0.7872340425531915
	Train acc at iteration 74: 0.8349358974358975
	Val acc at iteration 73: 0.7021276595744681
	Train acc at iteration 75: 0.8269230769230769
	Val acc at iteration 74: 0.7659574468085106
	Train acc at iteration 76: 0.8173076923076923
	Val acc at iteration 75: 0.7446808510638298
	Train acc at iteration 77: 0.8189102564102564
	Val acc at iteration 76: 0.7127659574468085
	Train acc at iteration 78: 0.8092948717948718
	Val acc at iteration 77: 0.7446808510638298
	Train acc at iteration 79: 0.8189102564102564
	Val acc at iteration 78: 0.7553191489361702
	Train acc at iteration 80: 0.8076923076923077
	Val acc at iteration 79: 0.7446808510638298
	Train acc at iteration 81: 0.8317307692307693
	Val acc at iteration 80: 0.6914893617021277
	Train acc at iteration 82: 0.7900641025641025
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.8092948717948718
	Val acc at iteration 82: 0.6702127659574468
	Train acc at iteration 84: 0.8125
	Val acc at iteration 83: 0.723404255319149
	Train acc at iteration 85: 0.8060897435897436
	Val acc at iteration 84: 0.7021276595744681

Attempting combination 5/9:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 45
num_pushes: 2
last_layer_epochs: 85
crs_ent_weight: 1
clst_weight: -1
sep_weight: 0.1
l1_weight: 0.001
push_start: 37
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 1
p0_warm_ptype_step_size: 5000000
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 1
p1_warm_ptype_step_size: 5000000
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 126
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.24468085106382978
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.9361702127659575
Push epoch at epoch 38.
Final validation accuracy before push: 0.9361702127659575
Push number 1
After push, before retraining last layer:
	Train acc: 0.8076923076923077
	Train Cluster: 0.6441273093223572
	Train Separation: 0.5114893317222595
(Directly after push 2) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.7872340425531915
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.5638297872340425
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.7021276595744681
	Val acc at iteration 5: 0.776595744680851
	Val acc at iteration 6: 0.7553191489361702
	Val acc at iteration 7: 0.7127659574468085
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.6914893617021277
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.6808510638297872
	Val acc at iteration 12: 0.776595744680851
	Val acc at iteration 13: 0.723404255319149
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.776595744680851
	Val acc at iteration 16: 0.7446808510638298
	Val acc at iteration 17: 0.8297872340425532
	Val acc at iteration 18: 0.6382978723404256
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.7021276595744681
	Val acc at iteration 22: 0.776595744680851
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.776595744680851
	Val acc at iteration 25: 0.776595744680851
	Val acc at iteration 26: 0.723404255319149
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.7446808510638298
	Val acc at iteration 30: 0.6276595744680851
	Val acc at iteration 31: 0.776595744680851
	Val acc at iteration 32: 0.7659574468085106
	Val acc at iteration 33: 0.6702127659574468
	Val acc at iteration 34: 0.7340425531914894
	Val acc at iteration 35: 0.6914893617021277
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.8297872340425532
	Val acc at iteration 38: 0.723404255319149
	Val acc at iteration 39: 0.7553191489361702
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.776595744680851
	Val acc at iteration 42: 0.6702127659574468
	Val acc at iteration 43: 0.7659574468085106
	Val acc at iteration 44: 0.776595744680851
	Val acc at iteration 45: 0.7872340425531915
	Val acc at iteration 46: 0.7340425531914894
	Val acc at iteration 47: 0.7659574468085106
	Val acc at iteration 48: 0.7340425531914894
	Val acc at iteration 49: 0.7340425531914894
	Val acc at iteration 50: 0.7340425531914894
	Val acc at iteration 51: 0.851063829787234
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.7659574468085106
	Val acc at iteration 54: 0.776595744680851
	Val acc at iteration 55: 0.776595744680851
	Val acc at iteration 56: 0.8085106382978723
	Val acc at iteration 57: 0.7659574468085106
	Val acc at iteration 58: 0.7872340425531915
	Val acc at iteration 59: 0.723404255319149
	Val acc at iteration 60: 0.8191489361702128
	Val acc at iteration 61: 0.7872340425531915
	Val acc at iteration 62: 0.723404255319149
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.7978723404255319
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.7978723404255319
	Val acc at iteration 67: 0.7446808510638298
	Val acc at iteration 68: 0.7340425531914894
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.8191489361702128
	Val acc at iteration 72: 0.7978723404255319
	Val acc at iteration 73: 0.776595744680851
	Val acc at iteration 74: 0.8297872340425532
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.8085106382978723
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.7872340425531915
	Val acc at iteration 80: 0.8297872340425532
	Val acc at iteration 81: 0.7659574468085106
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7659574468085106
Val acc before epoch 38: 0.7021276595744681
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.8404255319148937
Warm optimizer lr: 0.05
Val acc before epoch 40: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 48: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 54: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 61: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 63: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 69: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 70: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 71: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 72: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 73: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 75: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 76: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 77: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 78: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 80: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 81: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 82: 0.9574468085106383
Push epoch at epoch 83.
Final validation accuracy before push: 0.9574468085106383
Push number 2
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Train Cluster: 0.6533244252204895
	Train Separation: 0.5135346114635467
(Directly after push 3) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.8297872340425532
	Val acc at iteration 1: 0.7127659574468085
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.723404255319149
	Val acc at iteration 5: 0.8085106382978723
	Val acc at iteration 6: 0.7978723404255319
	Val acc at iteration 7: 0.776595744680851
	Val acc at iteration 8: 0.776595744680851
	Val acc at iteration 9: 0.8085106382978723
	Val acc at iteration 10: 0.851063829787234
	Val acc at iteration 11: 0.7978723404255319
	Val acc at iteration 12: 0.7553191489361702
	Val acc at iteration 13: 0.776595744680851
	Val acc at iteration 14: 0.6595744680851063
	Val acc at iteration 15: 0.7659574468085106
	Val acc at iteration 16: 0.6808510638297872
	Val acc at iteration 17: 0.7340425531914894
	Val acc at iteration 18: 0.723404255319149
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.7872340425531915
	Val acc at iteration 21: 0.7340425531914894
	Val acc at iteration 22: 0.7340425531914894
	Val acc at iteration 23: 0.7553191489361702
	Val acc at iteration 24: 0.7872340425531915
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.8829787234042553
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.776595744680851
	Val acc at iteration 32: 0.7446808510638298
	Val acc at iteration 33: 0.7021276595744681
	Val acc at iteration 34: 0.7659574468085106
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7340425531914894
	Val acc at iteration 37: 0.7553191489361702
	Val acc at iteration 38: 0.7978723404255319
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.8191489361702128
	Val acc at iteration 41: 0.8085106382978723
	Val acc at iteration 42: 0.7978723404255319
	Val acc at iteration 43: 0.7978723404255319
	Val acc at iteration 44: 0.8085106382978723
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.723404255319149
	Val acc at iteration 47: 0.7978723404255319
	Val acc at iteration 48: 0.8297872340425532
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.7978723404255319
	Val acc at iteration 52: 0.8085106382978723
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7659574468085106
	Val acc at iteration 56: 0.6808510638297872
	Val acc at iteration 57: 0.776595744680851
	Val acc at iteration 58: 0.776595744680851
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.7978723404255319
	Val acc at iteration 63: 0.7978723404255319
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.723404255319149
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7978723404255319
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.7872340425531915
	Val acc at iteration 72: 0.7978723404255319
	Val acc at iteration 73: 0.7127659574468085
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7446808510638298
	Val acc at iteration 76: 0.7659574468085106
	Val acc at iteration 77: 0.8085106382978723
	Val acc at iteration 78: 0.7553191489361702
	Val acc at iteration 79: 0.851063829787234
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.6808510638297872
	Val acc at iteration 82: 0.7659574468085106
	Val acc at iteration 83: 0.8297872340425532
	Val acc at iteration 84: 0.7127659574468085
Val acc before epoch 83: 0.7659574468085106
Warm optimizer lr: 0.05
Val acc before epoch 84: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 85: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 86: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 88: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 93: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 94: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 95: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 96: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 97: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 98: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 99: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 100: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 101: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 102: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 103: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 104: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 105: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 106: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 107: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 108: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 109: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 110: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 111: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 112: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 113: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 114: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 115: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 116: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 117: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 118: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 119: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 120: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 121: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 122: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 123: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 124: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 125: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 126: 0.9574468085106383
Stopping after epoch 127.
Final validation accuracy before push: 0.9574468085106383
Push number 3
After push, before retraining last layer:
	Train acc: 0.842948717948718
	Train Cluster: 0.6462713241577148
	TrainSeparation: 0.5096916139125824
(Directly after push 4) Val acc at iteration 0: 0.7872340425531915
Retraining last layer
Last layer lr: 0.0007
	Train acc at iteration 1: 0.8493589743589743
	Val acc at iteration 0: 0.8191489361702128
	Train acc at iteration 2: 0.8557692307692307
	Val acc at iteration 1: 0.7340425531914894
	Train acc at iteration 3: 0.8605769230769231
	Val acc at iteration 2: 0.7978723404255319
	Train acc at iteration 4: 0.8573717948717948
	Val acc at iteration 3: 0.8085106382978723
	Train acc at iteration 5: 0.8782051282051282
	Val acc at iteration 4: 0.8085106382978723
	Train acc at iteration 6: 0.8477564102564102
	Val acc at iteration 5: 0.7340425531914894
	Train acc at iteration 7: 0.8541666666666666
	Val acc at iteration 6: 0.7978723404255319
	Train acc at iteration 8: 0.8637820512820513
	Val acc at iteration 7: 0.7446808510638298
	Train acc at iteration 9: 0.8541666666666666
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8461538461538461
	Val acc at iteration 9: 0.7872340425531915
	Train acc at iteration 11: 0.8413461538461539
	Val acc at iteration 10: 0.7127659574468085
	Train acc at iteration 12: 0.8942307692307693
	Val acc at iteration 11: 0.8191489361702128
	Train acc at iteration 13: 0.8253205128205128
	Val acc at iteration 12: 0.7872340425531915
	Train acc at iteration 14: 0.842948717948718
	Val acc at iteration 13: 0.776595744680851
	Train acc at iteration 15: 0.8589743589743589
	Val acc at iteration 14: 0.8297872340425532
	Train acc at iteration 16: 0.8461538461538461
	Val acc at iteration 15: 0.7978723404255319
	Train acc at iteration 17: 0.8525641025641025
	Val acc at iteration 16: 0.723404255319149
	Train acc at iteration 18: 0.8477564102564102
	Val acc at iteration 17: 0.776595744680851
	Train acc at iteration 19: 0.8589743589743589
	Val acc at iteration 18: 0.776595744680851
	Train acc at iteration 20: 0.8541666666666666
	Val acc at iteration 19: 0.7340425531914894
	Train acc at iteration 21: 0.8541666666666666
	Val acc at iteration 20: 0.7872340425531915
	Train acc at iteration 22: 0.8605769230769231
	Val acc at iteration 21: 0.6914893617021277
	Train acc at iteration 23: 0.8493589743589743
	Val acc at iteration 22: 0.7446808510638298
	Train acc at iteration 24: 0.8509615384615384
	Val acc at iteration 23: 0.8404255319148937
	Train acc at iteration 25: 0.8365384615384616
	Val acc at iteration 24: 0.7021276595744681
	Train acc at iteration 26: 0.8413461538461539
	Val acc at iteration 25: 0.8191489361702128
	Train acc at iteration 27: 0.8237179487179487
	Val acc at iteration 26: 0.7021276595744681
	Train acc at iteration 28: 0.8333333333333334
	Val acc at iteration 27: 0.7553191489361702
	Train acc at iteration 29: 0.8397435897435898
	Val acc at iteration 28: 0.7446808510638298
	Train acc at iteration 30: 0.8365384615384616
	Val acc at iteration 29: 0.7127659574468085
	Train acc at iteration 31: 0.8653846153846154
	Val acc at iteration 30: 0.7978723404255319
	Train acc at iteration 32: 0.8573717948717948
	Val acc at iteration 31: 0.776595744680851
	Train acc at iteration 33: 0.8301282051282052
	Val acc at iteration 32: 0.8085106382978723
	Train acc at iteration 34: 0.8365384615384616
	Val acc at iteration 33: 0.7553191489361702
	Train acc at iteration 35: 0.8269230769230769
	Val acc at iteration 34: 0.776595744680851
	Train acc at iteration 36: 0.8301282051282052
	Val acc at iteration 35: 0.776595744680851
	Train acc at iteration 37: 0.8493589743589743
	Val acc at iteration 36: 0.8085106382978723
	Train acc at iteration 38: 0.8397435897435898
	Val acc at iteration 37: 0.6595744680851063
	Train acc at iteration 39: 0.8221153846153846
	Val acc at iteration 38: 0.7446808510638298
	Train acc at iteration 40: 0.8413461538461539
	Val acc at iteration 39: 0.7659574468085106
	Train acc at iteration 41: 0.8237179487179487
	Val acc at iteration 40: 0.7978723404255319
	Train acc at iteration 42: 0.7996794871794872
	Val acc at iteration 41: 0.7978723404255319
	Train acc at iteration 43: 0.8461538461538461
	Val acc at iteration 42: 0.6808510638297872
	Train acc at iteration 44: 0.8349358974358975
	Val acc at iteration 43: 0.6914893617021277
	Train acc at iteration 45: 0.8157051282051282
	Val acc at iteration 44: 0.7021276595744681
	Train acc at iteration 46: 0.8333333333333334
	Val acc at iteration 45: 0.7340425531914894
	Train acc at iteration 47: 0.8205128205128205
	Val acc at iteration 46: 0.723404255319149
	Train acc at iteration 48: 0.8285256410256411
	Val acc at iteration 47: 0.723404255319149
	Train acc at iteration 49: 0.8205128205128205
	Val acc at iteration 48: 0.7659574468085106
	Train acc at iteration 50: 0.8525641025641025
	Val acc at iteration 49: 0.7446808510638298
	Train acc at iteration 51: 0.8141025641025641
	Val acc at iteration 50: 0.6914893617021277
	Train acc at iteration 52: 0.844551282051282
	Val acc at iteration 51: 0.7872340425531915
	Train acc at iteration 53: 0.8461538461538461
	Val acc at iteration 52: 0.7127659574468085
	Train acc at iteration 54: 0.8253205128205128
	Val acc at iteration 53: 0.776595744680851
	Train acc at iteration 55: 0.8413461538461539
	Val acc at iteration 54: 0.7553191489361702
	Train acc at iteration 56: 0.7916666666666666
	Val acc at iteration 55: 0.7340425531914894
	Train acc at iteration 57: 0.8285256410256411
	Val acc at iteration 56: 0.723404255319149
	Train acc at iteration 58: 0.8317307692307693
	Val acc at iteration 57: 0.7553191489361702
	Train acc at iteration 59: 0.8301282051282052
	Val acc at iteration 58: 0.723404255319149
	Train acc at iteration 60: 0.8253205128205128
	Val acc at iteration 59: 0.7659574468085106
	Train acc at iteration 61: 0.8333333333333334
	Val acc at iteration 60: 0.7446808510638298
	Train acc at iteration 62: 0.8125
	Val acc at iteration 61: 0.6914893617021277
	Train acc at iteration 63: 0.8365384615384616
	Val acc at iteration 62: 0.723404255319149
	Train acc at iteration 64: 0.8349358974358975
	Val acc at iteration 63: 0.723404255319149
	Train acc at iteration 65: 0.8557692307692307
	Val acc at iteration 64: 0.7553191489361702
	Train acc at iteration 66: 0.8269230769230769
	Val acc at iteration 65: 0.7127659574468085
	Train acc at iteration 67: 0.8125
	Val acc at iteration 66: 0.7340425531914894
	Train acc at iteration 68: 0.8413461538461539
	Val acc at iteration 67: 0.723404255319149
	Train acc at iteration 69: 0.8141025641025641
	Val acc at iteration 68: 0.723404255319149
	Train acc at iteration 70: 0.8237179487179487
	Val acc at iteration 69: 0.7446808510638298
	Train acc at iteration 71: 0.8477564102564102
	Val acc at iteration 70: 0.7659574468085106
	Train acc at iteration 72: 0.8461538461538461
	Val acc at iteration 71: 0.7127659574468085
	Train acc at iteration 73: 0.8301282051282052
	Val acc at iteration 72: 0.723404255319149
	Train acc at iteration 74: 0.8365384615384616
	Val acc at iteration 73: 0.723404255319149
	Train acc at iteration 75: 0.8317307692307693
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.8381410256410257
	Val acc at iteration 75: 0.7021276595744681
	Train acc at iteration 77: 0.8092948717948718
	Val acc at iteration 76: 0.7340425531914894
	Train acc at iteration 78: 0.8349358974358975
	Val acc at iteration 77: 0.7872340425531915
	Train acc at iteration 79: 0.8269230769230769
	Val acc at iteration 78: 0.7872340425531915
	Train acc at iteration 80: 0.8173076923076923
	Val acc at iteration 79: 0.7127659574468085
	Train acc at iteration 81: 0.8060897435897436
	Val acc at iteration 80: 0.6914893617021277
	Train acc at iteration 82: 0.8285256410256411
	Val acc at iteration 81: 0.776595744680851
	Train acc at iteration 83: 0.8333333333333334
	Val acc at iteration 82: 0.7553191489361702
	Train acc at iteration 84: 0.8141025641025641
	Val acc at iteration 83: 0.7978723404255319
	Train acc at iteration 85: 0.8397435897435898
	Val acc at iteration 84: 0.6808510638297872

Attempting combination 6/9:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 45
num_pushes: 2
last_layer_epochs: 85
crs_ent_weight: 1
clst_weight: -1
sep_weight: 0.3
l1_weight: 0.001
push_start: 37
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 1
p0_warm_ptype_step_size: 5000000
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 1
p1_warm_ptype_step_size: 5000000
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 126
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.3404255319148936
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.6170212765957447
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.9574468085106383
Push epoch at epoch 38.
Final validation accuracy before push: 0.9574468085106383
Push number 1
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.6420265555381774
	Train Separation: 0.5057551860809326
(Directly after push 2) Val acc at iteration 0: 0.723404255319149
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.648936170212766
	Val acc at iteration 1: 0.776595744680851
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.723404255319149
	Val acc at iteration 4: 0.6595744680851063
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.6702127659574468
	Val acc at iteration 8: 0.7553191489361702
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.648936170212766
	Val acc at iteration 11: 0.6914893617021277
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.7127659574468085
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.7340425531914894
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.7659574468085106
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.6808510638297872
	Val acc at iteration 20: 0.7021276595744681
	Val acc at iteration 21: 0.7127659574468085
	Val acc at iteration 22: 0.7021276595744681
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.8085106382978723
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.7340425531914894
	Val acc at iteration 32: 0.7553191489361702
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.7127659574468085
	Val acc at iteration 35: 0.6808510638297872
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.723404255319149
	Val acc at iteration 38: 0.776595744680851
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.7127659574468085
	Val acc at iteration 41: 0.648936170212766
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.8085106382978723
	Val acc at iteration 44: 0.7127659574468085
	Val acc at iteration 45: 0.776595744680851
	Val acc at iteration 46: 0.6702127659574468
	Val acc at iteration 47: 0.6914893617021277
	Val acc at iteration 48: 0.7872340425531915
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.723404255319149
	Val acc at iteration 51: 0.7553191489361702
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.723404255319149
	Val acc at iteration 55: 0.6276595744680851
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.7978723404255319
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.7553191489361702
	Val acc at iteration 62: 0.7340425531914894
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.7021276595744681
	Val acc at iteration 65: 0.7021276595744681
	Val acc at iteration 66: 0.6914893617021277
	Val acc at iteration 67: 0.7021276595744681
	Val acc at iteration 68: 0.723404255319149
	Val acc at iteration 69: 0.7340425531914894
	Val acc at iteration 70: 0.6808510638297872
	Val acc at iteration 71: 0.7553191489361702
	Val acc at iteration 72: 0.6914893617021277
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.6914893617021277
	Val acc at iteration 75: 0.7021276595744681
	Val acc at iteration 76: 0.6914893617021277
	Val acc at iteration 77: 0.6914893617021277
	Val acc at iteration 78: 0.7340425531914894
	Val acc at iteration 79: 0.8297872340425532
	Val acc at iteration 80: 0.6808510638297872
	Val acc at iteration 81: 0.8297872340425532
	Val acc at iteration 82: 0.7127659574468085
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.6914893617021277
Val acc before epoch 38: 0.7446808510638298
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 40: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 41: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 47: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 48: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 50: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 52: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 54: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 58: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 59: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 60: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 61: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 63: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 67: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 68: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 70: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 71: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 72: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 73: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 74: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 75: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 77: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 79: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 80: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 81: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 82: 0.9574468085106383
Push epoch at epoch 83.
Final validation accuracy before push: 0.9574468085106383
Push number 2
After push, before retraining last layer:
	Train acc: 0.8269230769230769
	Train Cluster: 0.6533893346786499
	Train Separation: 0.5162633895874024
(Directly after push 3) Val acc at iteration 0: 0.7446808510638298
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.6808510638297872
	Val acc at iteration 2: 0.723404255319149
	Val acc at iteration 3: 0.6914893617021277
	Val acc at iteration 4: 0.7872340425531915
	Val acc at iteration 5: 0.7553191489361702
	Val acc at iteration 6: 0.8085106382978723
	Val acc at iteration 7: 0.7553191489361702
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.776595744680851
	Val acc at iteration 10: 0.7872340425531915
	Val acc at iteration 11: 0.7021276595744681
	Val acc at iteration 12: 0.8191489361702128
	Val acc at iteration 13: 0.7872340425531915
	Val acc at iteration 14: 0.7127659574468085
	Val acc at iteration 15: 0.7446808510638298
	Val acc at iteration 16: 0.7978723404255319
	Val acc at iteration 17: 0.7127659574468085
	Val acc at iteration 18: 0.7446808510638298
	Val acc at iteration 19: 0.7553191489361702
	Val acc at iteration 20: 0.7446808510638298
	Val acc at iteration 21: 0.7553191489361702
	Val acc at iteration 22: 0.776595744680851
	Val acc at iteration 23: 0.7446808510638298
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.7872340425531915
	Val acc at iteration 26: 0.7659574468085106
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.7446808510638298
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.7659574468085106
	Val acc at iteration 32: 0.8085106382978723
	Val acc at iteration 33: 0.7659574468085106
	Val acc at iteration 34: 0.776595744680851
	Val acc at iteration 35: 0.7127659574468085
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.6914893617021277
	Val acc at iteration 38: 0.776595744680851
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.7872340425531915
	Val acc at iteration 41: 0.776595744680851
	Val acc at iteration 42: 0.7659574468085106
	Val acc at iteration 43: 0.723404255319149
	Val acc at iteration 44: 0.776595744680851
	Val acc at iteration 45: 0.8085106382978723
	Val acc at iteration 46: 0.7021276595744681
	Val acc at iteration 47: 0.7446808510638298
	Val acc at iteration 48: 0.7553191489361702
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7872340425531915
	Val acc at iteration 53: 0.7446808510638298
	Val acc at iteration 54: 0.7659574468085106
	Val acc at iteration 55: 0.7553191489361702
	Val acc at iteration 56: 0.6702127659574468
	Val acc at iteration 57: 0.8085106382978723
	Val acc at iteration 58: 0.8085106382978723
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7340425531914894
	Val acc at iteration 61: 0.7659574468085106
	Val acc at iteration 62: 0.6702127659574468
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.7553191489361702
	Val acc at iteration 65: 0.7446808510638298
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.7978723404255319
	Val acc at iteration 68: 0.7978723404255319
	Val acc at iteration 69: 0.8297872340425532
	Val acc at iteration 70: 0.7553191489361702
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.723404255319149
	Val acc at iteration 73: 0.7978723404255319
	Val acc at iteration 74: 0.8085106382978723
	Val acc at iteration 75: 0.7872340425531915
	Val acc at iteration 76: 0.7872340425531915
	Val acc at iteration 77: 0.7978723404255319
	Val acc at iteration 78: 0.8404255319148937
	Val acc at iteration 79: 0.7872340425531915
	Val acc at iteration 80: 0.7872340425531915
	Val acc at iteration 81: 0.7446808510638298
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7340425531914894
	Val acc at iteration 84: 0.776595744680851
Val acc before epoch 83: 0.8085106382978723
Warm optimizer lr: 0.05
Val acc before epoch 84: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 85: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 86: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 87: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 90: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 91: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 92: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 93: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 94: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 95: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 96: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 99: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 100: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 101: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 102: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 103: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 104: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 105: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 106: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 107: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 108: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 109: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 110: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 111: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 112: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 113: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 114: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 115: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 116: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 117: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 118: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 119: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 120: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 121: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 122: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 123: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 124: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 125: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 126: 0.9787234042553191
Stopping after epoch 127.
Final validation accuracy before push: 0.9787234042553191
Push number 3
After push, before retraining last layer:
	Train acc: 0.8493589743589743
	Train Cluster: 0.6410693168640137
	TrainSeparation: 0.5081363677978515
(Directly after push 4) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: 0.0007
	Train acc at iteration 1: 0.842948717948718
	Val acc at iteration 0: 0.7553191489361702
	Train acc at iteration 2: 0.8333333333333334
	Val acc at iteration 1: 0.7553191489361702
	Train acc at iteration 3: 0.8333333333333334
	Val acc at iteration 2: 0.6914893617021277
	Train acc at iteration 4: 0.8637820512820513
	Val acc at iteration 3: 0.7872340425531915
	Train acc at iteration 5: 0.844551282051282
	Val acc at iteration 4: 0.7127659574468085
	Train acc at iteration 6: 0.8461538461538461
	Val acc at iteration 5: 0.7872340425531915
	Train acc at iteration 7: 0.8349358974358975
	Val acc at iteration 6: 0.7340425531914894
	Train acc at iteration 8: 0.8461538461538461
	Val acc at iteration 7: 0.8191489361702128
	Train acc at iteration 9: 0.8509615384615384
	Val acc at iteration 8: 0.7446808510638298
	Train acc at iteration 10: 0.8573717948717948
	Val acc at iteration 9: 0.7872340425531915
	Train acc at iteration 11: 0.8493589743589743
	Val acc at iteration 10: 0.7978723404255319
	Train acc at iteration 12: 0.8653846153846154
	Val acc at iteration 11: 0.723404255319149
	Train acc at iteration 13: 0.842948717948718
	Val acc at iteration 12: 0.7659574468085106
	Train acc at iteration 14: 0.8397435897435898
	Val acc at iteration 13: 0.723404255319149
	Train acc at iteration 15: 0.8541666666666666
	Val acc at iteration 14: 0.7872340425531915
	Train acc at iteration 16: 0.8573717948717948
	Val acc at iteration 15: 0.8191489361702128
	Train acc at iteration 17: 0.8269230769230769
	Val acc at iteration 16: 0.776595744680851
	Train acc at iteration 18: 0.8237179487179487
	Val acc at iteration 17: 0.6595744680851063
	Train acc at iteration 19: 0.8477564102564102
	Val acc at iteration 18: 0.776595744680851
	Train acc at iteration 20: 0.8205128205128205
	Val acc at iteration 19: 0.7659574468085106
	Train acc at iteration 21: 0.8365384615384616
	Val acc at iteration 20: 0.723404255319149
	Train acc at iteration 22: 0.8349358974358975
	Val acc at iteration 21: 0.7127659574468085
	Train acc at iteration 23: 0.8557692307692307
	Val acc at iteration 22: 0.7553191489361702
	Train acc at iteration 24: 0.8317307692307693
	Val acc at iteration 23: 0.723404255319149
	Train acc at iteration 25: 0.8493589743589743
	Val acc at iteration 24: 0.723404255319149
	Train acc at iteration 26: 0.8349358974358975
	Val acc at iteration 25: 0.7553191489361702
	Train acc at iteration 27: 0.842948717948718
	Val acc at iteration 26: 0.7021276595744681
	Train acc at iteration 28: 0.8621794871794872
	Val acc at iteration 27: 0.7446808510638298
	Train acc at iteration 29: 0.8365384615384616
	Val acc at iteration 28: 0.7659574468085106
	Train acc at iteration 30: 0.7964743589743589
	Val acc at iteration 29: 0.723404255319149
	Train acc at iteration 31: 0.8269230769230769
	Val acc at iteration 30: 0.7340425531914894
	Train acc at iteration 32: 0.8381410256410257
	Val acc at iteration 31: 0.7021276595744681
	Train acc at iteration 33: 0.8189102564102564
	Val acc at iteration 32: 0.6914893617021277
	Train acc at iteration 34: 0.8333333333333334
	Val acc at iteration 33: 0.723404255319149
	Train acc at iteration 35: 0.8237179487179487
	Val acc at iteration 34: 0.7340425531914894
	Train acc at iteration 36: 0.8125
	Val acc at iteration 35: 0.776595744680851
	Train acc at iteration 37: 0.8221153846153846
	Val acc at iteration 36: 0.7872340425531915
	Train acc at iteration 38: 0.8189102564102564
	Val acc at iteration 37: 0.723404255319149
	Train acc at iteration 39: 0.8173076923076923
	Val acc at iteration 38: 0.6808510638297872
	Train acc at iteration 40: 0.8157051282051282
	Val acc at iteration 39: 0.648936170212766
	Train acc at iteration 41: 0.7852564102564102
	Val acc at iteration 40: 0.7127659574468085
	Train acc at iteration 42: 0.8044871794871795
	Val acc at iteration 41: 0.7340425531914894
	Train acc at iteration 43: 0.8205128205128205
	Val acc at iteration 42: 0.7659574468085106
	Train acc at iteration 44: 0.8253205128205128
	Val acc at iteration 43: 0.776595744680851
	Train acc at iteration 45: 0.8349358974358975
	Val acc at iteration 44: 0.7340425531914894
	Train acc at iteration 46: 0.8092948717948718
	Val acc at iteration 45: 0.7553191489361702
	Train acc at iteration 47: 0.8221153846153846
	Val acc at iteration 46: 0.7127659574468085
	Train acc at iteration 48: 0.7708333333333334
	Val acc at iteration 47: 0.7340425531914894
	Train acc at iteration 49: 0.8237179487179487
	Val acc at iteration 48: 0.7446808510638298
	Train acc at iteration 50: 0.8221153846153846
	Val acc at iteration 49: 0.7340425531914894
	Train acc at iteration 51: 0.8108974358974359
	Val acc at iteration 50: 0.6808510638297872
	Train acc at iteration 52: 0.8076923076923077
	Val acc at iteration 51: 0.7659574468085106
	Train acc at iteration 53: 0.8173076923076923
	Val acc at iteration 52: 0.6914893617021277
	Train acc at iteration 54: 0.8012820512820513
	Val acc at iteration 53: 0.7978723404255319
	Train acc at iteration 55: 0.8301282051282052
	Val acc at iteration 54: 0.7446808510638298
	Train acc at iteration 56: 0.8301282051282052
	Val acc at iteration 55: 0.7127659574468085
	Train acc at iteration 57: 0.8557692307692307
	Val acc at iteration 56: 0.7127659574468085
	Train acc at iteration 58: 0.8221153846153846
	Val acc at iteration 57: 0.7446808510638298
	Train acc at iteration 59: 0.8253205128205128
	Val acc at iteration 58: 0.8085106382978723
	Train acc at iteration 60: 0.8269230769230769
	Val acc at iteration 59: 0.7127659574468085
	Train acc at iteration 61: 0.7948717948717948
	Val acc at iteration 60: 0.723404255319149
	Train acc at iteration 62: 0.8157051282051282
	Val acc at iteration 61: 0.7872340425531915
	Train acc at iteration 63: 0.8237179487179487
	Val acc at iteration 62: 0.776595744680851
	Train acc at iteration 64: 0.8125
	Val acc at iteration 63: 0.7021276595744681
	Train acc at iteration 65: 0.8189102564102564
	Val acc at iteration 64: 0.7659574468085106
	Train acc at iteration 66: 0.8060897435897436
	Val acc at iteration 65: 0.7021276595744681
	Train acc at iteration 67: 0.8285256410256411
	Val acc at iteration 66: 0.6914893617021277
	Train acc at iteration 68: 0.7932692307692307
	Val acc at iteration 67: 0.7127659574468085
	Train acc at iteration 69: 0.8221153846153846
	Val acc at iteration 68: 0.8404255319148937
	Train acc at iteration 70: 0.8060897435897436
	Val acc at iteration 69: 0.7659574468085106
	Train acc at iteration 71: 0.8060897435897436
	Val acc at iteration 70: 0.7127659574468085
	Train acc at iteration 72: 0.7996794871794872
	Val acc at iteration 71: 0.8191489361702128
	Train acc at iteration 73: 0.8044871794871795
	Val acc at iteration 72: 0.7872340425531915
	Train acc at iteration 74: 0.8253205128205128
	Val acc at iteration 73: 0.7340425531914894
	Train acc at iteration 75: 0.8157051282051282
	Val acc at iteration 74: 0.7340425531914894
	Train acc at iteration 76: 0.8301282051282052
	Val acc at iteration 75: 0.6702127659574468
	Train acc at iteration 77: 0.8237179487179487
	Val acc at iteration 76: 0.723404255319149
	Train acc at iteration 78: 0.8173076923076923
	Val acc at iteration 77: 0.6808510638297872
	Train acc at iteration 79: 0.8028846153846154
	Val acc at iteration 78: 0.7553191489361702
	Train acc at iteration 80: 0.8173076923076923
	Val acc at iteration 79: 0.7553191489361702
	Train acc at iteration 81: 0.8221153846153846
	Val acc at iteration 80: 0.6702127659574468
	Train acc at iteration 82: 0.8381410256410257
	Val acc at iteration 81: 0.7127659574468085
	Train acc at iteration 83: 0.8285256410256411
	Val acc at iteration 82: 0.6808510638297872
	Train acc at iteration 84: 0.8108974358974359
	Val acc at iteration 83: 0.7978723404255319
	Train acc at iteration 85: 0.8493589743589743
	Val acc at iteration 84: 0.7340425531914894

Attempting combination 7/9:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 45
num_pushes: 2
last_layer_epochs: 85
crs_ent_weight: 1
clst_weight: -1
sep_weight: 0.5
l1_weight: 0.001
push_start: 37
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 1
p0_warm_ptype_step_size: 5000000
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 1
p1_warm_ptype_step_size: 5000000
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 126
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.3191489361702128
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.8191489361702128
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.9680851063829787
Push epoch at epoch 38.
Final validation accuracy before push: 0.9680851063829787
Push number 1
After push, before retraining last layer:
	Train acc: 0.8413461538461539
	Train Cluster: 0.6427994251251221
	Train Separation: 0.5105855464935303
(Directly after push 2) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6595744680851063
	Val acc at iteration 1: 0.6382978723404256
	Val acc at iteration 2: 0.7553191489361702
	Val acc at iteration 3: 0.6702127659574468
	Val acc at iteration 4: 0.6914893617021277
	Val acc at iteration 5: 0.6063829787234043
	Val acc at iteration 6: 0.7127659574468085
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.6595744680851063
	Val acc at iteration 9: 0.6702127659574468
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.6702127659574468
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.6808510638297872
	Val acc at iteration 14: 0.6808510638297872
	Val acc at iteration 15: 0.7021276595744681
	Val acc at iteration 16: 0.7021276595744681
	Val acc at iteration 17: 0.6595744680851063
	Val acc at iteration 18: 0.6702127659574468
	Val acc at iteration 19: 0.648936170212766
	Val acc at iteration 20: 0.7127659574468085
	Val acc at iteration 21: 0.6382978723404256
	Val acc at iteration 22: 0.7553191489361702
	Val acc at iteration 23: 0.7127659574468085
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.7553191489361702
	Val acc at iteration 26: 0.7021276595744681
	Val acc at iteration 27: 0.7659574468085106
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.6808510638297872
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.6808510638297872
	Val acc at iteration 32: 0.6808510638297872
	Val acc at iteration 33: 0.7127659574468085
	Val acc at iteration 34: 0.6702127659574468
	Val acc at iteration 35: 0.8085106382978723
	Val acc at iteration 36: 0.723404255319149
	Val acc at iteration 37: 0.7340425531914894
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7127659574468085
	Val acc at iteration 40: 0.6808510638297872
	Val acc at iteration 41: 0.723404255319149
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.8297872340425532
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7446808510638298
	Val acc at iteration 47: 0.6595744680851063
	Val acc at iteration 48: 0.7127659574468085
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.7127659574468085
	Val acc at iteration 52: 0.7340425531914894
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.7127659574468085
	Val acc at iteration 55: 0.6702127659574468
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7127659574468085
	Val acc at iteration 58: 0.7446808510638298
	Val acc at iteration 59: 0.6914893617021277
	Val acc at iteration 60: 0.7553191489361702
	Val acc at iteration 61: 0.6808510638297872
	Val acc at iteration 62: 0.7446808510638298
	Val acc at iteration 63: 0.6914893617021277
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.648936170212766
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.7553191489361702
	Val acc at iteration 68: 0.7021276595744681
	Val acc at iteration 69: 0.723404255319149
	Val acc at iteration 70: 0.7340425531914894
	Val acc at iteration 71: 0.7021276595744681
	Val acc at iteration 72: 0.6382978723404256
	Val acc at iteration 73: 0.7340425531914894
	Val acc at iteration 74: 0.7659574468085106
	Val acc at iteration 75: 0.7340425531914894
	Val acc at iteration 76: 0.648936170212766
	Val acc at iteration 77: 0.7659574468085106
	Val acc at iteration 78: 0.7021276595744681
	Val acc at iteration 79: 0.723404255319149
	Val acc at iteration 80: 0.776595744680851
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.7872340425531915
	Val acc at iteration 83: 0.6702127659574468
	Val acc at iteration 84: 0.723404255319149
Val acc before epoch 38: 0.7127659574468085
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 40: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 41: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 42: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 45: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 46: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 48: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 49: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 51: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 54: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 57: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 58: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 63: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 65: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 66: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 70: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 71: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 72: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 73: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 74: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 75: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 77: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 79: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 81: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 82: 0.925531914893617
Push epoch at epoch 83.
Final validation accuracy before push: 0.925531914893617
Push number 2
After push, before retraining last layer:
	Train acc: 0.8493589743589743
	Train Cluster: 0.646307623386383
	Train Separation: 0.5098292231559753
(Directly after push 3) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7659574468085106
	Val acc at iteration 1: 0.7446808510638298
	Val acc at iteration 2: 0.7872340425531915
	Val acc at iteration 3: 0.7872340425531915
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.7659574468085106
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.7978723404255319
	Val acc at iteration 8: 0.723404255319149
	Val acc at iteration 9: 0.7872340425531915
	Val acc at iteration 10: 0.6914893617021277
	Val acc at iteration 11: 0.7978723404255319
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.7872340425531915
	Val acc at iteration 14: 0.851063829787234
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.6382978723404256
	Val acc at iteration 17: 0.723404255319149
	Val acc at iteration 18: 0.7553191489361702
	Val acc at iteration 19: 0.776595744680851
	Val acc at iteration 20: 0.776595744680851
	Val acc at iteration 21: 0.7659574468085106
	Val acc at iteration 22: 0.776595744680851
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.7978723404255319
	Val acc at iteration 25: 0.7021276595744681
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7446808510638298
	Val acc at iteration 28: 0.7872340425531915
	Val acc at iteration 29: 0.7659574468085106
	Val acc at iteration 30: 0.7340425531914894
	Val acc at iteration 31: 0.7659574468085106
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.776595744680851
	Val acc at iteration 34: 0.776595744680851
	Val acc at iteration 35: 0.7446808510638298
	Val acc at iteration 36: 0.776595744680851
	Val acc at iteration 37: 0.7127659574468085
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.7872340425531915
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.7659574468085106
	Val acc at iteration 44: 0.7978723404255319
	Val acc at iteration 45: 0.723404255319149
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.7872340425531915
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.7978723404255319
	Val acc at iteration 51: 0.6808510638297872
	Val acc at iteration 52: 0.7446808510638298
	Val acc at iteration 53: 0.7127659574468085
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.8085106382978723
	Val acc at iteration 56: 0.7127659574468085
	Val acc at iteration 57: 0.7872340425531915
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7340425531914894
	Val acc at iteration 60: 0.7872340425531915
	Val acc at iteration 61: 0.723404255319149
	Val acc at iteration 62: 0.7872340425531915
	Val acc at iteration 63: 0.7446808510638298
	Val acc at iteration 64: 0.8085106382978723
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.7340425531914894
	Val acc at iteration 67: 0.7978723404255319
	Val acc at iteration 68: 0.7446808510638298
	Val acc at iteration 69: 0.7553191489361702
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7446808510638298
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.7978723404255319
	Val acc at iteration 74: 0.776595744680851
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.7340425531914894
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.776595744680851
	Val acc at iteration 79: 0.7553191489361702
	Val acc at iteration 80: 0.7978723404255319
	Val acc at iteration 81: 0.723404255319149
	Val acc at iteration 82: 0.8085106382978723
	Val acc at iteration 83: 0.7659574468085106
	Val acc at iteration 84: 0.7553191489361702
Val acc before epoch 83: 0.7553191489361702
Warm optimizer lr: 0.05
Val acc before epoch 84: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 85: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 86: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 87: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 90: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 93: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 96: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 97: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 98: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 99: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 100: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 101: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 102: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 103: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 104: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 105: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 106: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 107: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 108: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 109: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 110: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 111: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 112: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 113: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 114: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 115: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 116: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 117: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 118: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 119: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 120: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 121: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 122: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 123: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 124: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 125: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 126: 0.9361702127659575
Stopping after epoch 127.
Final validation accuracy before push: 0.9361702127659575
Push number 3
After push, before retraining last layer:
	Train acc: 0.8397435897435898
	Train Cluster: 0.6591492533683777
	TrainSeparation: 0.5095334053039551
(Directly after push 4) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.0007
	Train acc at iteration 1: 0.8381410256410257
	Val acc at iteration 0: 0.7659574468085106
	Train acc at iteration 2: 0.8381410256410257
	Val acc at iteration 1: 0.7446808510638298
	Train acc at iteration 3: 0.8317307692307693
	Val acc at iteration 2: 0.7872340425531915
	Train acc at iteration 4: 0.8525641025641025
	Val acc at iteration 3: 0.8085106382978723
	Train acc at iteration 5: 0.8461538461538461
	Val acc at iteration 4: 0.7659574468085106
	Train acc at iteration 6: 0.8477564102564102
	Val acc at iteration 5: 0.8404255319148937
	Train acc at iteration 7: 0.8365384615384616
	Val acc at iteration 6: 0.7872340425531915
	Train acc at iteration 8: 0.8349358974358975
	Val acc at iteration 7: 0.7872340425531915
	Train acc at iteration 9: 0.842948717948718
	Val acc at iteration 8: 0.776595744680851
	Train acc at iteration 10: 0.8509615384615384
	Val acc at iteration 9: 0.776595744680851
	Train acc at iteration 11: 0.8509615384615384
	Val acc at iteration 10: 0.776595744680851
	Train acc at iteration 12: 0.8477564102564102
	Val acc at iteration 11: 0.7340425531914894
	Train acc at iteration 13: 0.8237179487179487
	Val acc at iteration 12: 0.7446808510638298
	Train acc at iteration 14: 0.8541666666666666
	Val acc at iteration 13: 0.7872340425531915
	Train acc at iteration 15: 0.8397435897435898
	Val acc at iteration 14: 0.7553191489361702
	Train acc at iteration 16: 0.8493589743589743
	Val acc at iteration 15: 0.7872340425531915
	Train acc at iteration 17: 0.8733974358974359
	Val acc at iteration 16: 0.7340425531914894
	Train acc at iteration 18: 0.842948717948718
	Val acc at iteration 17: 0.7553191489361702
	Train acc at iteration 19: 0.8525641025641025
	Val acc at iteration 18: 0.6914893617021277
	Train acc at iteration 20: 0.8573717948717948
	Val acc at iteration 19: 0.7553191489361702
	Train acc at iteration 21: 0.8092948717948718
	Val acc at iteration 20: 0.7659574468085106
	Train acc at iteration 22: 0.844551282051282
	Val acc at iteration 21: 0.7553191489361702
	Train acc at iteration 23: 0.8125
	Val acc at iteration 22: 0.7446808510638298
	Train acc at iteration 24: 0.8381410256410257
	Val acc at iteration 23: 0.723404255319149
	Train acc at iteration 25: 0.8397435897435898
	Val acc at iteration 24: 0.723404255319149
	Train acc at iteration 26: 0.8269230769230769
	Val acc at iteration 25: 0.7659574468085106
	Train acc at iteration 27: 0.8349358974358975
	Val acc at iteration 26: 0.648936170212766
	Train acc at iteration 28: 0.8189102564102564
	Val acc at iteration 27: 0.7553191489361702
	Train acc at iteration 29: 0.7948717948717948
	Val acc at iteration 28: 0.7127659574468085
	Train acc at iteration 30: 0.842948717948718
	Val acc at iteration 29: 0.7659574468085106
	Train acc at iteration 31: 0.8141025641025641
	Val acc at iteration 30: 0.7127659574468085
	Train acc at iteration 32: 0.8108974358974359
	Val acc at iteration 31: 0.723404255319149
	Train acc at iteration 33: 0.8381410256410257
	Val acc at iteration 32: 0.6595744680851063
	Train acc at iteration 34: 0.8621794871794872
	Val acc at iteration 33: 0.7340425531914894
	Train acc at iteration 35: 0.7980769230769231
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.8108974358974359
	Val acc at iteration 35: 0.6595744680851063
	Train acc at iteration 37: 0.8285256410256411
	Val acc at iteration 36: 0.7978723404255319
	Train acc at iteration 38: 0.8317307692307693
	Val acc at iteration 37: 0.7553191489361702
	Train acc at iteration 39: 0.8141025641025641
	Val acc at iteration 38: 0.6276595744680851
	Train acc at iteration 40: 0.8125
	Val acc at iteration 39: 0.7553191489361702
	Train acc at iteration 41: 0.8221153846153846
	Val acc at iteration 40: 0.7127659574468085
	Train acc at iteration 42: 0.8092948717948718
	Val acc at iteration 41: 0.6808510638297872
	Train acc at iteration 43: 0.8221153846153846
	Val acc at iteration 42: 0.7021276595744681
	Train acc at iteration 44: 0.7788461538461539
	Val acc at iteration 43: 0.7127659574468085
	Train acc at iteration 45: 0.8509615384615384
	Val acc at iteration 44: 0.5851063829787234
	Train acc at iteration 46: 0.8237179487179487
	Val acc at iteration 45: 0.6808510638297872
	Train acc at iteration 47: 0.8125
	Val acc at iteration 46: 0.6170212765957447
	Train acc at iteration 48: 0.8189102564102564
	Val acc at iteration 47: 0.6914893617021277
	Train acc at iteration 49: 0.8205128205128205
	Val acc at iteration 48: 0.7340425531914894
	Train acc at iteration 50: 0.8141025641025641
	Val acc at iteration 49: 0.6914893617021277
	Train acc at iteration 51: 0.8012820512820513
	Val acc at iteration 50: 0.7340425531914894
	Train acc at iteration 52: 0.8044871794871795
	Val acc at iteration 51: 0.7553191489361702
	Train acc at iteration 53: 0.8108974358974359
	Val acc at iteration 52: 0.723404255319149
	Train acc at iteration 54: 0.8413461538461539
	Val acc at iteration 53: 0.7021276595744681
	Train acc at iteration 55: 0.8381410256410257
	Val acc at iteration 54: 0.723404255319149
	Train acc at iteration 56: 0.8060897435897436
	Val acc at iteration 55: 0.7659574468085106
	Train acc at iteration 57: 0.8092948717948718
	Val acc at iteration 56: 0.6914893617021277
	Train acc at iteration 58: 0.8205128205128205
	Val acc at iteration 57: 0.6702127659574468
	Train acc at iteration 59: 0.8381410256410257
	Val acc at iteration 58: 0.7446808510638298
	Train acc at iteration 60: 0.8253205128205128
	Val acc at iteration 59: 0.6595744680851063
	Train acc at iteration 61: 0.7996794871794872
	Val acc at iteration 60: 0.723404255319149
	Train acc at iteration 62: 0.8237179487179487
	Val acc at iteration 61: 0.6382978723404256
	Train acc at iteration 63: 0.8076923076923077
	Val acc at iteration 62: 0.6702127659574468
	Train acc at iteration 64: 0.8301282051282052
	Val acc at iteration 63: 0.7872340425531915
	Train acc at iteration 65: 0.8461538461538461
	Val acc at iteration 64: 0.6595744680851063
	Train acc at iteration 66: 0.8253205128205128
	Val acc at iteration 65: 0.723404255319149
	Train acc at iteration 67: 0.8221153846153846
	Val acc at iteration 66: 0.7127659574468085
	Train acc at iteration 68: 0.8493589743589743
	Val acc at iteration 67: 0.7127659574468085
	Train acc at iteration 69: 0.8157051282051282
	Val acc at iteration 68: 0.7553191489361702
	Train acc at iteration 70: 0.8157051282051282
	Val acc at iteration 69: 0.7127659574468085
	Train acc at iteration 71: 0.8205128205128205
	Val acc at iteration 70: 0.6914893617021277
	Train acc at iteration 72: 0.8092948717948718
	Val acc at iteration 71: 0.6063829787234043
	Train acc at iteration 73: 0.8173076923076923
	Val acc at iteration 72: 0.6382978723404256
	Train acc at iteration 74: 0.8189102564102564
	Val acc at iteration 73: 0.6808510638297872
	Train acc at iteration 75: 0.842948717948718
	Val acc at iteration 74: 0.6914893617021277
	Train acc at iteration 76: 0.8301282051282052
	Val acc at iteration 75: 0.7446808510638298
	Train acc at iteration 77: 0.8028846153846154
	Val acc at iteration 76: 0.7021276595744681
	Train acc at iteration 78: 0.8349358974358975
	Val acc at iteration 77: 0.7978723404255319
	Train acc at iteration 79: 0.8141025641025641
	Val acc at iteration 78: 0.723404255319149
	Train acc at iteration 80: 0.8173076923076923
	Val acc at iteration 79: 0.6702127659574468
	Train acc at iteration 81: 0.8253205128205128
	Val acc at iteration 80: 0.648936170212766
	Train acc at iteration 82: 0.844551282051282
	Val acc at iteration 81: 0.7553191489361702
	Train acc at iteration 83: 0.842948717948718
	Val acc at iteration 82: 0.6170212765957447
	Train acc at iteration 84: 0.8413461538461539
	Val acc at iteration 83: 0.7446808510638298
	Train acc at iteration 85: 0.8076923076923077
	Val acc at iteration 84: 0.7978723404255319

Attempting combination 8/9:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 45
num_pushes: 2
last_layer_epochs: 85
crs_ent_weight: 1
clst_weight: -1
sep_weight: 0.7
l1_weight: 0.001
push_start: 37
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 1
p0_warm_ptype_step_size: 5000000
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 1
p1_warm_ptype_step_size: 5000000
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 126
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.3829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.9468085106382979
Push epoch at epoch 38.
Final validation accuracy before push: 0.9468085106382979
Push number 1
After push, before retraining last layer:
	Train acc: 0.8557692307692307
	Train Cluster: 0.6548100113868713
	Train Separation: 0.5088590681552887
(Directly after push 2) Val acc at iteration 0: 0.7553191489361702
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.7553191489361702
	Val acc at iteration 1: 0.776595744680851
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.7340425531914894
	Val acc at iteration 4: 0.7978723404255319
	Val acc at iteration 5: 0.7340425531914894
	Val acc at iteration 6: 0.7872340425531915
	Val acc at iteration 7: 0.723404255319149
	Val acc at iteration 8: 0.776595744680851
	Val acc at iteration 9: 0.7446808510638298
	Val acc at iteration 10: 0.723404255319149
	Val acc at iteration 11: 0.7340425531914894
	Val acc at iteration 12: 0.7021276595744681
	Val acc at iteration 13: 0.7659574468085106
	Val acc at iteration 14: 0.7553191489361702
	Val acc at iteration 15: 0.7872340425531915
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.7659574468085106
	Val acc at iteration 18: 0.648936170212766
	Val acc at iteration 19: 0.8191489361702128
	Val acc at iteration 20: 0.7340425531914894
	Val acc at iteration 21: 0.723404255319149
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.7659574468085106
	Val acc at iteration 24: 0.7659574468085106
	Val acc at iteration 25: 0.7127659574468085
	Val acc at iteration 26: 0.776595744680851
	Val acc at iteration 27: 0.7340425531914894
	Val acc at iteration 28: 0.7872340425531915
	Val acc at iteration 29: 0.7340425531914894
	Val acc at iteration 30: 0.7127659574468085
	Val acc at iteration 31: 0.7872340425531915
	Val acc at iteration 32: 0.7978723404255319
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.776595744680851
	Val acc at iteration 35: 0.8085106382978723
	Val acc at iteration 36: 0.7553191489361702
	Val acc at iteration 37: 0.7978723404255319
	Val acc at iteration 38: 0.7446808510638298
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.8085106382978723
	Val acc at iteration 41: 0.8085106382978723
	Val acc at iteration 42: 0.776595744680851
	Val acc at iteration 43: 0.7872340425531915
	Val acc at iteration 44: 0.7872340425531915
	Val acc at iteration 45: 0.7446808510638298
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.7978723404255319
	Val acc at iteration 48: 0.776595744680851
	Val acc at iteration 49: 0.776595744680851
	Val acc at iteration 50: 0.7553191489361702
	Val acc at iteration 51: 0.7446808510638298
	Val acc at iteration 52: 0.7978723404255319
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.8191489361702128
	Val acc at iteration 55: 0.723404255319149
	Val acc at iteration 56: 0.7446808510638298
	Val acc at iteration 57: 0.7446808510638298
	Val acc at iteration 58: 0.8085106382978723
	Val acc at iteration 59: 0.7553191489361702
	Val acc at iteration 60: 0.6914893617021277
	Val acc at iteration 61: 0.8085106382978723
	Val acc at iteration 62: 0.8085106382978723
	Val acc at iteration 63: 0.723404255319149
	Val acc at iteration 64: 0.7340425531914894
	Val acc at iteration 65: 0.7659574468085106
	Val acc at iteration 66: 0.723404255319149
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.776595744680851
	Val acc at iteration 71: 0.8297872340425532
	Val acc at iteration 72: 0.8085106382978723
	Val acc at iteration 73: 0.7446808510638298
	Val acc at iteration 74: 0.723404255319149
	Val acc at iteration 75: 0.8085106382978723
	Val acc at iteration 76: 0.7446808510638298
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.8085106382978723
	Val acc at iteration 79: 0.776595744680851
	Val acc at iteration 80: 0.7659574468085106
	Val acc at iteration 81: 0.7340425531914894
	Val acc at iteration 82: 0.776595744680851
	Val acc at iteration 83: 0.8191489361702128
	Val acc at iteration 84: 0.8085106382978723
Val acc before epoch 38: 0.7446808510638298
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 40: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 41: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 47: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 48: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 49: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 51: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 55: 0.9893617021276596
Warm optimizer lr: 0.05
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 58: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 59: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 60: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 62: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 63: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 68: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 69: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 70: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 71: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 72: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 73: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 74: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 75: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 76: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 77: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 78: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 79: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 80: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 81: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 82: 0.9680851063829787
Push epoch at epoch 83.
Final validation accuracy before push: 0.9680851063829787
Push number 2
After push, before retraining last layer:
	Train acc: 0.8477564102564102
	Train Cluster: 0.6521725296974182
	Train Separation: 0.507052618265152
(Directly after push 3) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7340425531914894
	Val acc at iteration 1: 0.776595744680851
	Val acc at iteration 2: 0.7446808510638298
	Val acc at iteration 3: 0.7553191489361702
	Val acc at iteration 4: 0.8723404255319149
	Val acc at iteration 5: 0.7872340425531915
	Val acc at iteration 6: 0.7340425531914894
	Val acc at iteration 7: 0.7659574468085106
	Val acc at iteration 8: 0.776595744680851
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.7553191489361702
	Val acc at iteration 11: 0.8085106382978723
	Val acc at iteration 12: 0.7659574468085106
	Val acc at iteration 13: 0.7978723404255319
	Val acc at iteration 14: 0.7978723404255319
	Val acc at iteration 15: 0.7978723404255319
	Val acc at iteration 16: 0.8191489361702128
	Val acc at iteration 17: 0.8085106382978723
	Val acc at iteration 18: 0.7127659574468085
	Val acc at iteration 19: 0.7021276595744681
	Val acc at iteration 20: 0.776595744680851
	Val acc at iteration 21: 0.776595744680851
	Val acc at iteration 22: 0.8297872340425532
	Val acc at iteration 23: 0.7340425531914894
	Val acc at iteration 24: 0.723404255319149
	Val acc at iteration 25: 0.7872340425531915
	Val acc at iteration 26: 0.7978723404255319
	Val acc at iteration 27: 0.776595744680851
	Val acc at iteration 28: 0.7553191489361702
	Val acc at iteration 29: 0.8297872340425532
	Val acc at iteration 30: 0.7872340425531915
	Val acc at iteration 31: 0.8085106382978723
	Val acc at iteration 32: 0.7872340425531915
	Val acc at iteration 33: 0.8297872340425532
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.8191489361702128
	Val acc at iteration 36: 0.7021276595744681
	Val acc at iteration 37: 0.7872340425531915
	Val acc at iteration 38: 0.7978723404255319
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.7446808510638298
	Val acc at iteration 41: 0.7659574468085106
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.776595744680851
	Val acc at iteration 44: 0.7446808510638298
	Val acc at iteration 45: 0.7978723404255319
	Val acc at iteration 46: 0.7978723404255319
	Val acc at iteration 47: 0.7340425531914894
	Val acc at iteration 48: 0.723404255319149
	Val acc at iteration 49: 0.7872340425531915
	Val acc at iteration 50: 0.7446808510638298
	Val acc at iteration 51: 0.8297872340425532
	Val acc at iteration 52: 0.7872340425531915
	Val acc at iteration 53: 0.8085106382978723
	Val acc at iteration 54: 0.776595744680851
	Val acc at iteration 55: 0.8085106382978723
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.8297872340425532
	Val acc at iteration 58: 0.723404255319149
	Val acc at iteration 59: 0.7978723404255319
	Val acc at iteration 60: 0.8191489361702128
	Val acc at iteration 61: 0.776595744680851
	Val acc at iteration 62: 0.8191489361702128
	Val acc at iteration 63: 0.8404255319148937
	Val acc at iteration 64: 0.776595744680851
	Val acc at iteration 65: 0.7872340425531915
	Val acc at iteration 66: 0.7659574468085106
	Val acc at iteration 67: 0.8191489361702128
	Val acc at iteration 68: 0.7659574468085106
	Val acc at iteration 69: 0.776595744680851
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7978723404255319
	Val acc at iteration 72: 0.7872340425531915
	Val acc at iteration 73: 0.8085106382978723
	Val acc at iteration 74: 0.7978723404255319
	Val acc at iteration 75: 0.8404255319148937
	Val acc at iteration 76: 0.7978723404255319
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7978723404255319
	Val acc at iteration 79: 0.8617021276595744
	Val acc at iteration 80: 0.8085106382978723
	Val acc at iteration 81: 0.8404255319148937
	Val acc at iteration 82: 0.7978723404255319
	Val acc at iteration 83: 0.8297872340425532
	Val acc at iteration 84: 0.7872340425531915
Val acc before epoch 83: 0.7978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 85: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 86: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 87: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 88: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 91: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 92: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 93: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 94: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 95: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 97: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 98: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 99: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 100: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 101: 0.9893617021276596
Warm optimizer lr: 0.05
Val acc before epoch 102: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 103: 0.9893617021276596
Warm optimizer lr: 0.05
Val acc before epoch 104: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 105: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 106: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 107: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 108: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 109: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 110: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 111: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 112: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 113: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 114: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 115: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 116: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 117: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 118: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 119: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 120: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 121: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 122: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 123: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 124: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 125: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 126: 0.9361702127659575
Stopping after epoch 127.
Final validation accuracy before push: 0.9361702127659575
Push number 3
After push, before retraining last layer:
	Train acc: 0.8685897435897436
	Train Cluster: 0.6495900392532349
	TrainSeparation: 0.5123648285865784
(Directly after push 4) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.0007
	Train acc at iteration 1: 0.8669871794871795
	Val acc at iteration 0: 0.7872340425531915
	Train acc at iteration 2: 0.8541666666666666
	Val acc at iteration 1: 0.776595744680851
	Train acc at iteration 3: 0.842948717948718
	Val acc at iteration 2: 0.8297872340425532
	Train acc at iteration 4: 0.8493589743589743
	Val acc at iteration 3: 0.7978723404255319
	Train acc at iteration 5: 0.8541666666666666
	Val acc at iteration 4: 0.723404255319149
	Train acc at iteration 6: 0.8589743589743589
	Val acc at iteration 5: 0.7553191489361702
	Train acc at iteration 7: 0.8589743589743589
	Val acc at iteration 6: 0.8404255319148937
	Train acc at iteration 8: 0.844551282051282
	Val acc at iteration 7: 0.7978723404255319
	Train acc at iteration 9: 0.844551282051282
	Val acc at iteration 8: 0.8297872340425532
	Train acc at iteration 10: 0.8365384615384616
	Val acc at iteration 9: 0.7978723404255319
	Train acc at iteration 11: 0.8717948717948718
	Val acc at iteration 10: 0.7872340425531915
	Train acc at iteration 12: 0.8589743589743589
	Val acc at iteration 11: 0.8085106382978723
	Train acc at iteration 13: 0.8605769230769231
	Val acc at iteration 12: 0.776595744680851
	Train acc at iteration 14: 0.8701923076923077
	Val acc at iteration 13: 0.7872340425531915
	Train acc at iteration 15: 0.8413461538461539
	Val acc at iteration 14: 0.8085106382978723
	Train acc at iteration 16: 0.8669871794871795
	Val acc at iteration 15: 0.8297872340425532
	Train acc at iteration 17: 0.8397435897435898
	Val acc at iteration 16: 0.7659574468085106
	Train acc at iteration 18: 0.8477564102564102
	Val acc at iteration 17: 0.7978723404255319
	Train acc at iteration 19: 0.8525641025641025
	Val acc at iteration 18: 0.8191489361702128
	Train acc at iteration 20: 0.8461538461538461
	Val acc at iteration 19: 0.7446808510638298
	Train acc at iteration 21: 0.8541666666666666
	Val acc at iteration 20: 0.8404255319148937
	Train acc at iteration 22: 0.8317307692307693
	Val acc at iteration 21: 0.7978723404255319
	Train acc at iteration 23: 0.8717948717948718
	Val acc at iteration 22: 0.7659574468085106
	Train acc at iteration 24: 0.8637820512820513
	Val acc at iteration 23: 0.8191489361702128
	Train acc at iteration 25: 0.8237179487179487
	Val acc at iteration 24: 0.7553191489361702
	Train acc at iteration 26: 0.8413461538461539
	Val acc at iteration 25: 0.8191489361702128
	Train acc at iteration 27: 0.8557692307692307
	Val acc at iteration 26: 0.7446808510638298
	Train acc at iteration 28: 0.8237179487179487
	Val acc at iteration 27: 0.7340425531914894
	Train acc at iteration 29: 0.8076923076923077
	Val acc at iteration 28: 0.6808510638297872
	Train acc at iteration 30: 0.8317307692307693
	Val acc at iteration 29: 0.7872340425531915
	Train acc at iteration 31: 0.844551282051282
	Val acc at iteration 30: 0.8085106382978723
	Train acc at iteration 32: 0.8381410256410257
	Val acc at iteration 31: 0.7127659574468085
	Train acc at iteration 33: 0.8205128205128205
	Val acc at iteration 32: 0.8191489361702128
	Train acc at iteration 34: 0.8541666666666666
	Val acc at iteration 33: 0.7127659574468085
	Train acc at iteration 35: 0.8189102564102564
	Val acc at iteration 34: 0.7127659574468085
	Train acc at iteration 36: 0.8333333333333334
	Val acc at iteration 35: 0.776595744680851
	Train acc at iteration 37: 0.8269230769230769
	Val acc at iteration 36: 0.7659574468085106
	Train acc at iteration 38: 0.8253205128205128
	Val acc at iteration 37: 0.776595744680851
	Train acc at iteration 39: 0.8333333333333334
	Val acc at iteration 38: 0.7021276595744681
	Train acc at iteration 40: 0.8237179487179487
	Val acc at iteration 39: 0.7446808510638298
	Train acc at iteration 41: 0.8413461538461539
	Val acc at iteration 40: 0.7340425531914894
	Train acc at iteration 42: 0.8509615384615384
	Val acc at iteration 41: 0.7553191489361702
	Train acc at iteration 43: 0.8269230769230769
	Val acc at iteration 42: 0.7872340425531915
	Train acc at iteration 44: 0.8205128205128205
	Val acc at iteration 43: 0.7446808510638298
	Train acc at iteration 45: 0.8285256410256411
	Val acc at iteration 44: 0.776595744680851
	Train acc at iteration 46: 0.8301282051282052
	Val acc at iteration 45: 0.8191489361702128
	Train acc at iteration 47: 0.8573717948717948
	Val acc at iteration 46: 0.7553191489361702
	Train acc at iteration 48: 0.8092948717948718
	Val acc at iteration 47: 0.776595744680851
	Train acc at iteration 49: 0.8173076923076923
	Val acc at iteration 48: 0.7127659574468085
	Train acc at iteration 50: 0.8477564102564102
	Val acc at iteration 49: 0.7659574468085106
	Train acc at iteration 51: 0.8653846153846154
	Val acc at iteration 50: 0.723404255319149
	Train acc at iteration 52: 0.8125
	Val acc at iteration 51: 0.6914893617021277
	Train acc at iteration 53: 0.844551282051282
	Val acc at iteration 52: 0.7659574468085106
	Train acc at iteration 54: 0.8333333333333334
	Val acc at iteration 53: 0.7872340425531915
	Train acc at iteration 55: 0.8333333333333334
	Val acc at iteration 54: 0.776595744680851
	Train acc at iteration 56: 0.8349358974358975
	Val acc at iteration 55: 0.7446808510638298
	Train acc at iteration 57: 0.8301282051282052
	Val acc at iteration 56: 0.7978723404255319
	Train acc at iteration 58: 0.8012820512820513
	Val acc at iteration 57: 0.7553191489361702
	Train acc at iteration 59: 0.8044871794871795
	Val acc at iteration 58: 0.7446808510638298
	Train acc at iteration 60: 0.8317307692307693
	Val acc at iteration 59: 0.7659574468085106
	Train acc at iteration 61: 0.8381410256410257
	Val acc at iteration 60: 0.6808510638297872
	Train acc at iteration 62: 0.8397435897435898
	Val acc at iteration 61: 0.7872340425531915
	Train acc at iteration 63: 0.8157051282051282
	Val acc at iteration 62: 0.7978723404255319
	Train acc at iteration 64: 0.8028846153846154
	Val acc at iteration 63: 0.7446808510638298
	Train acc at iteration 65: 0.8333333333333334
	Val acc at iteration 64: 0.7978723404255319
	Train acc at iteration 66: 0.8076923076923077
	Val acc at iteration 65: 0.723404255319149
	Train acc at iteration 67: 0.8349358974358975
	Val acc at iteration 66: 0.7872340425531915
	Train acc at iteration 68: 0.7884615384615384
	Val acc at iteration 67: 0.776595744680851
	Train acc at iteration 69: 0.8157051282051282
	Val acc at iteration 68: 0.7553191489361702
	Train acc at iteration 70: 0.8349358974358975
	Val acc at iteration 69: 0.7446808510638298
	Train acc at iteration 71: 0.842948717948718
	Val acc at iteration 70: 0.723404255319149
	Train acc at iteration 72: 0.8285256410256411
	Val acc at iteration 71: 0.7127659574468085
	Train acc at iteration 73: 0.8253205128205128
	Val acc at iteration 72: 0.7553191489361702
	Train acc at iteration 74: 0.8269230769230769
	Val acc at iteration 73: 0.6808510638297872
	Train acc at iteration 75: 0.8237179487179487
	Val acc at iteration 74: 0.8085106382978723
	Train acc at iteration 76: 0.8221153846153846
	Val acc at iteration 75: 0.7553191489361702
	Train acc at iteration 77: 0.8253205128205128
	Val acc at iteration 76: 0.8191489361702128
	Train acc at iteration 78: 0.8397435897435898
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.8605769230769231
	Val acc at iteration 78: 0.723404255319149
	Train acc at iteration 80: 0.8141025641025641
	Val acc at iteration 79: 0.6702127659574468
	Train acc at iteration 81: 0.8125
	Val acc at iteration 80: 0.7446808510638298
	Train acc at iteration 82: 0.8157051282051282
	Val acc at iteration 81: 0.7553191489361702
	Train acc at iteration 83: 0.8381410256410257
	Val acc at iteration 82: 0.7659574468085106
	Train acc at iteration 84: 0.8557692307692307
	Val acc at iteration 83: 0.7446808510638298
	Train acc at iteration 85: 0.8205128205128205
	Val acc at iteration 84: 0.7127659574468085

Attempting combination 9/9:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 45
num_pushes: 2
last_layer_epochs: 85
crs_ent_weight: 1
clst_weight: -1
sep_weight: 0.9
l1_weight: 0.001
push_start: 37
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 1
p0_warm_ptype_step_size: 5000000
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 1
p1_warm_ptype_step_size: 5000000
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 126
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 23: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 24: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 25: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 28: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 31: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 34: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 37: 0.9361702127659575
Push epoch at epoch 38.
Final validation accuracy before push: 0.9361702127659575
Push number 1
After push, before retraining last layer:
	Train acc: 0.8301282051282052
	Train Cluster: 0.6486310482025146
	Train Separation: 0.5109081387519836
(Directly after push 2) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.001
	Val acc at iteration 0: 0.6170212765957447
	Val acc at iteration 1: 0.6702127659574468
	Val acc at iteration 2: 0.6702127659574468
	Val acc at iteration 3: 0.7127659574468085
	Val acc at iteration 4: 0.7340425531914894
	Val acc at iteration 5: 0.6276595744680851
	Val acc at iteration 6: 0.723404255319149
	Val acc at iteration 7: 0.648936170212766
	Val acc at iteration 8: 0.648936170212766
	Val acc at iteration 9: 0.7340425531914894
	Val acc at iteration 10: 0.6382978723404256
	Val acc at iteration 11: 0.723404255319149
	Val acc at iteration 12: 0.6808510638297872
	Val acc at iteration 13: 0.7553191489361702
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7127659574468085
	Val acc at iteration 16: 0.7127659574468085
	Val acc at iteration 17: 0.6170212765957447
	Val acc at iteration 18: 0.6808510638297872
	Val acc at iteration 19: 0.7340425531914894
	Val acc at iteration 20: 0.6914893617021277
	Val acc at iteration 21: 0.7659574468085106
	Val acc at iteration 22: 0.7659574468085106
	Val acc at iteration 23: 0.6808510638297872
	Val acc at iteration 24: 0.6808510638297872
	Val acc at iteration 25: 0.7446808510638298
	Val acc at iteration 26: 0.7127659574468085
	Val acc at iteration 27: 0.7021276595744681
	Val acc at iteration 28: 0.7340425531914894
	Val acc at iteration 29: 0.7021276595744681
	Val acc at iteration 30: 0.723404255319149
	Val acc at iteration 31: 0.776595744680851
	Val acc at iteration 32: 0.7340425531914894
	Val acc at iteration 33: 0.7872340425531915
	Val acc at iteration 34: 0.6914893617021277
	Val acc at iteration 35: 0.7553191489361702
	Val acc at iteration 36: 0.6702127659574468
	Val acc at iteration 37: 0.7978723404255319
	Val acc at iteration 38: 0.7021276595744681
	Val acc at iteration 39: 0.7659574468085106
	Val acc at iteration 40: 0.6914893617021277
	Val acc at iteration 41: 0.6914893617021277
	Val acc at iteration 42: 0.7340425531914894
	Val acc at iteration 43: 0.7553191489361702
	Val acc at iteration 44: 0.723404255319149
	Val acc at iteration 45: 0.6595744680851063
	Val acc at iteration 46: 0.7659574468085106
	Val acc at iteration 47: 0.7553191489361702
	Val acc at iteration 48: 0.7021276595744681
	Val acc at iteration 49: 0.7446808510638298
	Val acc at iteration 50: 0.6914893617021277
	Val acc at iteration 51: 0.6914893617021277
	Val acc at iteration 52: 0.8191489361702128
	Val acc at iteration 53: 0.7553191489361702
	Val acc at iteration 54: 0.7553191489361702
	Val acc at iteration 55: 0.7127659574468085
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.7553191489361702
	Val acc at iteration 58: 0.7127659574468085
	Val acc at iteration 59: 0.7021276595744681
	Val acc at iteration 60: 0.7127659574468085
	Val acc at iteration 61: 0.7872340425531915
	Val acc at iteration 62: 0.7021276595744681
	Val acc at iteration 63: 0.8404255319148937
	Val acc at iteration 64: 0.7659574468085106
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.7127659574468085
	Val acc at iteration 67: 0.7340425531914894
	Val acc at iteration 68: 0.7553191489361702
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.7446808510638298
	Val acc at iteration 71: 0.7553191489361702
	Val acc at iteration 72: 0.7127659574468085
	Val acc at iteration 73: 0.7659574468085106
	Val acc at iteration 74: 0.7446808510638298
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.7553191489361702
	Val acc at iteration 77: 0.776595744680851
	Val acc at iteration 78: 0.7659574468085106
	Val acc at iteration 79: 0.7978723404255319
	Val acc at iteration 80: 0.7978723404255319
	Val acc at iteration 81: 0.7127659574468085
	Val acc at iteration 82: 0.7446808510638298
	Val acc at iteration 83: 0.7553191489361702
	Val acc at iteration 84: 0.7446808510638298
Val acc before epoch 38: 0.776595744680851
Warm optimizer lr: 0.05
Val acc before epoch 39: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 40: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 41: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 43: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 45: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 47: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 48: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 51: 0.9787234042553191
Warm optimizer lr: 0.05
Val acc before epoch 52: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 55: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 65: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 69: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 70: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 71: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 72: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 73: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 74: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 75: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 76: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 77: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 78: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 79: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 80: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 82: 0.9468085106382979
Push epoch at epoch 83.
Final validation accuracy before push: 0.9468085106382979
Push number 2
After push, before retraining last layer:
	Train acc: 0.8493589743589743
	Train Cluster: 0.6500459551811218
	Train Separation: 0.5129301011562347
(Directly after push 3) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.0007
	Val acc at iteration 0: 0.7446808510638298
	Val acc at iteration 1: 0.8404255319148937
	Val acc at iteration 2: 0.7340425531914894
	Val acc at iteration 3: 0.7446808510638298
	Val acc at iteration 4: 0.6808510638297872
	Val acc at iteration 5: 0.7872340425531915
	Val acc at iteration 6: 0.851063829787234
	Val acc at iteration 7: 0.7021276595744681
	Val acc at iteration 8: 0.7659574468085106
	Val acc at iteration 9: 0.7978723404255319
	Val acc at iteration 10: 0.7446808510638298
	Val acc at iteration 11: 0.7553191489361702
	Val acc at iteration 12: 0.7340425531914894
	Val acc at iteration 13: 0.6914893617021277
	Val acc at iteration 14: 0.7340425531914894
	Val acc at iteration 15: 0.7553191489361702
	Val acc at iteration 16: 0.723404255319149
	Val acc at iteration 17: 0.6702127659574468
	Val acc at iteration 18: 0.8191489361702128
	Val acc at iteration 19: 0.723404255319149
	Val acc at iteration 20: 0.6808510638297872
	Val acc at iteration 21: 0.7446808510638298
	Val acc at iteration 22: 0.7872340425531915
	Val acc at iteration 23: 0.7978723404255319
	Val acc at iteration 24: 0.6914893617021277
	Val acc at iteration 25: 0.776595744680851
	Val acc at iteration 26: 0.7340425531914894
	Val acc at iteration 27: 0.7978723404255319
	Val acc at iteration 28: 0.8085106382978723
	Val acc at iteration 29: 0.776595744680851
	Val acc at iteration 30: 0.7978723404255319
	Val acc at iteration 31: 0.7553191489361702
	Val acc at iteration 32: 0.776595744680851
	Val acc at iteration 33: 0.7553191489361702
	Val acc at iteration 34: 0.7446808510638298
	Val acc at iteration 35: 0.7340425531914894
	Val acc at iteration 36: 0.7872340425531915
	Val acc at iteration 37: 0.7446808510638298
	Val acc at iteration 38: 0.776595744680851
	Val acc at iteration 39: 0.723404255319149
	Val acc at iteration 40: 0.8297872340425532
	Val acc at iteration 41: 0.7978723404255319
	Val acc at iteration 42: 0.7127659574468085
	Val acc at iteration 43: 0.648936170212766
	Val acc at iteration 44: 0.7978723404255319
	Val acc at iteration 45: 0.7978723404255319
	Val acc at iteration 46: 0.7553191489361702
	Val acc at iteration 47: 0.723404255319149
	Val acc at iteration 48: 0.6914893617021277
	Val acc at iteration 49: 0.7553191489361702
	Val acc at iteration 50: 0.7659574468085106
	Val acc at iteration 51: 0.7659574468085106
	Val acc at iteration 52: 0.7659574468085106
	Val acc at iteration 53: 0.7340425531914894
	Val acc at iteration 54: 0.7446808510638298
	Val acc at iteration 55: 0.7021276595744681
	Val acc at iteration 56: 0.7659574468085106
	Val acc at iteration 57: 0.723404255319149
	Val acc at iteration 58: 0.7659574468085106
	Val acc at iteration 59: 0.7446808510638298
	Val acc at iteration 60: 0.723404255319149
	Val acc at iteration 61: 0.7021276595744681
	Val acc at iteration 62: 0.7659574468085106
	Val acc at iteration 63: 0.7872340425531915
	Val acc at iteration 64: 0.7127659574468085
	Val acc at iteration 65: 0.776595744680851
	Val acc at iteration 66: 0.7872340425531915
	Val acc at iteration 67: 0.7978723404255319
	Val acc at iteration 68: 0.7127659574468085
	Val acc at iteration 69: 0.7446808510638298
	Val acc at iteration 70: 0.7659574468085106
	Val acc at iteration 71: 0.7340425531914894
	Val acc at iteration 72: 0.7978723404255319
	Val acc at iteration 73: 0.8297872340425532
	Val acc at iteration 74: 0.7978723404255319
	Val acc at iteration 75: 0.7659574468085106
	Val acc at iteration 76: 0.723404255319149
	Val acc at iteration 77: 0.7553191489361702
	Val acc at iteration 78: 0.7446808510638298
	Val acc at iteration 79: 0.8191489361702128
	Val acc at iteration 80: 0.7340425531914894
	Val acc at iteration 81: 0.776595744680851
	Val acc at iteration 82: 0.7978723404255319
	Val acc at iteration 83: 0.7446808510638298
	Val acc at iteration 84: 0.7978723404255319
Val acc before epoch 83: 0.8191489361702128
Warm optimizer lr: 0.05
Val acc before epoch 84: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 86: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 87: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 89: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 90: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 91: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 96: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 97: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 98: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 99: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 100: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 101: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 102: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 104: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 105: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 106: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 107: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 108: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 109: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 110: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 111: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 112: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 113: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 114: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 115: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 116: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 117: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 118: 0.9574468085106383
Warm optimizer lr: 0.05
Val acc before epoch 119: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 120: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 121: 0.9893617021276596
Warm optimizer lr: 0.05
Val acc before epoch 122: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 123: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 124: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 125: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 126: 0.9574468085106383
Stopping after epoch 127.
Final validation accuracy before push: 0.9574468085106383
Push number 3
After push, before retraining last layer:
	Train acc: 0.8685897435897436
	Train Cluster: 0.6495203971862793
	TrainSeparation: 0.5093735456466675
(Directly after push 4) Val acc at iteration 0: 0.7872340425531915
Retraining last layer
Last layer lr: 0.0007
	Train acc at iteration 1: 0.8397435897435898
	Val acc at iteration 0: 0.8297872340425532
	Train acc at iteration 2: 0.8381410256410257
	Val acc at iteration 1: 0.7553191489361702
	Train acc at iteration 3: 0.8717948717948718
	Val acc at iteration 2: 0.7872340425531915
	Train acc at iteration 4: 0.8573717948717948
	Val acc at iteration 3: 0.8297872340425532
	Train acc at iteration 5: 0.8701923076923077
	Val acc at iteration 4: 0.8191489361702128
	Train acc at iteration 6: 0.8397435897435898
	Val acc at iteration 5: 0.8085106382978723
	Train acc at iteration 7: 0.844551282051282
	Val acc at iteration 6: 0.8617021276595744
	Train acc at iteration 8: 0.8397435897435898
	Val acc at iteration 7: 0.8404255319148937
	Train acc at iteration 9: 0.8541666666666666
	Val acc at iteration 8: 0.7553191489361702
	Train acc at iteration 10: 0.8413461538461539
	Val acc at iteration 9: 0.7553191489361702
	Train acc at iteration 11: 0.8269230769230769
	Val acc at iteration 10: 0.8191489361702128
	Train acc at iteration 12: 0.8525641025641025
	Val acc at iteration 11: 0.7872340425531915
	Train acc at iteration 13: 0.8509615384615384
	Val acc at iteration 12: 0.7872340425531915
	Train acc at iteration 14: 0.8589743589743589
	Val acc at iteration 13: 0.8297872340425532
	Train acc at iteration 15: 0.8605769230769231
	Val acc at iteration 14: 0.7021276595744681
	Train acc at iteration 16: 0.8413461538461539
	Val acc at iteration 15: 0.7127659574468085
	Train acc at iteration 17: 0.8621794871794872
	Val acc at iteration 16: 0.8191489361702128
	Train acc at iteration 18: 0.8397435897435898
	Val acc at iteration 17: 0.7978723404255319
	Train acc at iteration 19: 0.8397435897435898
	Val acc at iteration 18: 0.8085106382978723
	Train acc at iteration 20: 0.8541666666666666
	Val acc at iteration 19: 0.8297872340425532
	Train acc at iteration 21: 0.8317307692307693
	Val acc at iteration 20: 0.8191489361702128
	Train acc at iteration 22: 0.8269230769230769
	Val acc at iteration 21: 0.776595744680851
	Train acc at iteration 23: 0.8573717948717948
	Val acc at iteration 22: 0.7659574468085106
	Train acc at iteration 24: 0.8173076923076923
	Val acc at iteration 23: 0.7659574468085106
	Train acc at iteration 25: 0.8333333333333334
	Val acc at iteration 24: 0.7446808510638298
	Train acc at iteration 26: 0.844551282051282
	Val acc at iteration 25: 0.7872340425531915
	Train acc at iteration 27: 0.8189102564102564
	Val acc at iteration 26: 0.7553191489361702
	Train acc at iteration 28: 0.8477564102564102
	Val acc at iteration 27: 0.7978723404255319
	Train acc at iteration 29: 0.8253205128205128
	Val acc at iteration 28: 0.8085106382978723
	Train acc at iteration 30: 0.8301282051282052
	Val acc at iteration 29: 0.723404255319149
	Train acc at iteration 31: 0.8413461538461539
	Val acc at iteration 30: 0.7446808510638298
	Train acc at iteration 32: 0.8413461538461539
	Val acc at iteration 31: 0.8085106382978723
	Train acc at iteration 33: 0.8285256410256411
	Val acc at iteration 32: 0.7340425531914894
	Train acc at iteration 34: 0.8189102564102564
	Val acc at iteration 33: 0.723404255319149
	Train acc at iteration 35: 0.8028846153846154
	Val acc at iteration 34: 0.7659574468085106
	Train acc at iteration 36: 0.8253205128205128
	Val acc at iteration 35: 0.6702127659574468
	Train acc at iteration 37: 0.8333333333333334
	Val acc at iteration 36: 0.7340425531914894
	Train acc at iteration 38: 0.8317307692307693
	Val acc at iteration 37: 0.723404255319149
	Train acc at iteration 39: 0.8301282051282052
	Val acc at iteration 38: 0.7872340425531915
	Train acc at iteration 40: 0.8365384615384616
	Val acc at iteration 39: 0.7872340425531915
	Train acc at iteration 41: 0.8189102564102564
	Val acc at iteration 40: 0.7446808510638298
	Train acc at iteration 42: 0.8397435897435898
	Val acc at iteration 41: 0.7021276595744681
	Train acc at iteration 43: 0.8301282051282052
	Val acc at iteration 42: 0.776595744680851
	Train acc at iteration 44: 0.7980769230769231
	Val acc at iteration 43: 0.7127659574468085
	Train acc at iteration 45: 0.8221153846153846
	Val acc at iteration 44: 0.7659574468085106
	Train acc at iteration 46: 0.8413461538461539
	Val acc at iteration 45: 0.7340425531914894
	Train acc at iteration 47: 0.8557692307692307
	Val acc at iteration 46: 0.776595744680851
	Train acc at iteration 48: 0.8269230769230769
	Val acc at iteration 47: 0.7127659574468085
	Train acc at iteration 49: 0.8493589743589743
	Val acc at iteration 48: 0.6914893617021277
	Train acc at iteration 50: 0.8189102564102564
	Val acc at iteration 49: 0.7127659574468085
	Train acc at iteration 51: 0.8173076923076923
	Val acc at iteration 50: 0.7659574468085106
	Train acc at iteration 52: 0.8141025641025641
	Val acc at iteration 51: 0.6914893617021277
	Train acc at iteration 53: 0.8253205128205128
	Val acc at iteration 52: 0.7659574468085106
	Train acc at iteration 54: 0.8365384615384616
	Val acc at iteration 53: 0.7021276595744681
	Train acc at iteration 55: 0.8092948717948718
	Val acc at iteration 54: 0.723404255319149
	Train acc at iteration 56: 0.8237179487179487
	Val acc at iteration 55: 0.7127659574468085
	Train acc at iteration 57: 0.8076923076923077
	Val acc at iteration 56: 0.776595744680851
	Train acc at iteration 58: 0.842948717948718
	Val acc at iteration 57: 0.7127659574468085
	Train acc at iteration 59: 0.8173076923076923
	Val acc at iteration 58: 0.7659574468085106
	Train acc at iteration 60: 0.8012820512820513
	Val acc at iteration 59: 0.6808510638297872
	Train acc at iteration 61: 0.8573717948717948
	Val acc at iteration 60: 0.7021276595744681
	Train acc at iteration 62: 0.8397435897435898
	Val acc at iteration 61: 0.7340425531914894
	Train acc at iteration 63: 0.8237179487179487
	Val acc at iteration 62: 0.6914893617021277
	Train acc at iteration 64: 0.8269230769230769
	Val acc at iteration 63: 0.723404255319149
	Train acc at iteration 65: 0.8285256410256411
	Val acc at iteration 64: 0.723404255319149
	Train acc at iteration 66: 0.844551282051282
	Val acc at iteration 65: 0.7553191489361702
	Train acc at iteration 67: 0.8461538461538461
	Val acc at iteration 66: 0.723404255319149
	Train acc at iteration 68: 0.8317307692307693
	Val acc at iteration 67: 0.6914893617021277
	Train acc at iteration 69: 0.8205128205128205
	Val acc at iteration 68: 0.7127659574468085
	Train acc at iteration 70: 0.8189102564102564
	Val acc at iteration 69: 0.776595744680851
	Train acc at iteration 71: 0.8012820512820513
	Val acc at iteration 70: 0.7021276595744681
	Train acc at iteration 72: 0.8221153846153846
	Val acc at iteration 71: 0.7659574468085106
	Train acc at iteration 73: 0.8333333333333334
	Val acc at iteration 72: 0.7659574468085106
	Train acc at iteration 74: 0.7980769230769231
	Val acc at iteration 73: 0.7553191489361702
	Train acc at iteration 75: 0.8157051282051282
	Val acc at iteration 74: 0.723404255319149
	Train acc at iteration 76: 0.8125
	Val acc at iteration 75: 0.7340425531914894
	Train acc at iteration 77: 0.8301282051282052
	Val acc at iteration 76: 0.7978723404255319
	Train acc at iteration 78: 0.8221153846153846
	Val acc at iteration 77: 0.7553191489361702
	Train acc at iteration 79: 0.8173076923076923
	Val acc at iteration 78: 0.6914893617021277
	Train acc at iteration 80: 0.8301282051282052
	Val acc at iteration 79: 0.723404255319149
	Train acc at iteration 81: 0.8173076923076923
	Val acc at iteration 80: 0.8404255319148937
	Train acc at iteration 82: 0.8253205128205128
	Val acc at iteration 81: 0.7340425531914894
	Train acc at iteration 83: 0.8301282051282052
	Val acc at iteration 82: 0.7127659574468085
	Train acc at iteration 84: 0.8269230769230769
	Val acc at iteration 83: 0.7127659574468085
	Train acc at iteration 85: 0.7980769230769231
	Val acc at iteration 84: 0.6914893617021277
Finished search.
