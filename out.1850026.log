===========================================
/home/swaggoner/eDNA
grtx-1.cluster
Sun Mar 31 03:32:51 EDT 2024
===========================================
13:4: not a valid test operator: (
13:4: not a valid test operator: 525.85.12

=============
== PyTorch ==
=============

NVIDIA Release 23.09 (build 69180607)
PyTorch Version 2.1.0a0+32f93b1

Container image Copyright (c) 2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

Copyright (c) 2014-2023 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

WARNING: CUDA Minor Version Compatibility mode ENABLED.
  Using driver version 525.85.12 which has support for CUDA 12.0.  This container
  was built with CUDA 12.2 and will be run in Minor Version Compatibility mode.
  CUDA Forward Compatibility is preferred over Minor Version Compatibility for use
  with this container but was unavailable:
  [[]]
  See https://docs.nvidia.com/deploy/cuda-compatibility/ for details.

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

2024-03-31 03:33:03.711427: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-03-31 03:33:04.279175: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-31 03:33:04.279234: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-31 03:33:04.282261: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-31 03:33:04.637975: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
0
Oversampled shape: (748, 2)


Trial 1

training set size: 780
push set size: 748
test set size: 175
train batch size: 156
test batch size: 94
Hyperparameters: {'prototype_shape': [(468, 520, 29)], 'latent_weight': [0.9], 'num_warm_epochs': [1000000], 'push_gap': [35], 'num_pushes': [1], 'last_layer_epochs': [0], 'crs_ent_weight': [1], 'clst_weight': [-9.600000000000001], 'sep_weight': [2.4], 'l1_weight': [0.001], 'push_start': [70], 'p0_warm_ptype_lr': [0.005, 0.0075, 0.01, 0.025, 0.05, 0.075, 0.1, 0.25, 0.5], 'p0_warm_ptype_gamma': [0.5, 0.6, 0.7, 0.8, 0.9], 'p0_warm_ptype_step_size': [50], 'p1_last_layer_lr': [0.001], 'p1_warm_ptype_lr': [0.28], 'p1_warm_ptype_gamma': [0.8], 'p1_warm_ptype_step_size': [100], 'p2_last_layer_lr': [0.0007], 'p2_warm_ptype_lr': [0.1], 'p2_warm_ptype_gamma': [-1], 'p2_warm_ptype_step_size': [100], 'p3_last_layer_lr': [7.5e-05], 'p3_warm_ptype_lr': [0.05], 'p3_warm_ptype_gamma': [-1], 'p3_warm_ptype_step_size': [100], 'p4_last_layer_lr': [7.5e-06], 'p4_warm_ptype_lr': [0.05], 'p4_warm_ptype_gamma': [-1], 'p4_warm_ptype_step_size': [100], 'joint_weight_decay': [-1], 'joint_lr_step_size': [-1], 'joint_gamma': [-1], 'joint_optimizer_lrs': [{'features': -1, 'prototype_vectors': -1}]}


Checking hyperparameters: {'p0_warm_ptype_lr': [0.005, 0.0075, 0.01, 0.025, 0.05, 0.075, 0.1, 0.25, 0.5], 'p0_warm_ptype_gamma': [0.5, 0.6, 0.7, 0.8, 0.9]}




Exploring 45 hyperparameter combinations for grid search.


Attempting combination 1/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.005
p0_warm_ptype_gamma: 0.5
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.005
Val acc before epoch 1: 0.0
Warm optimizer lr: 0.005
Val acc before epoch 2: 0.02127659574468085
Warm optimizer lr: 0.005
Val acc before epoch 3: 0.0851063829787234
Warm optimizer lr: 0.005
Val acc before epoch 4: 0.11702127659574468
Warm optimizer lr: 0.005
Val acc before epoch 5: 0.14893617021276595
Warm optimizer lr: 0.005
Val acc before epoch 6: 0.2765957446808511
Warm optimizer lr: 0.005
Val acc before epoch 7: 0.2978723404255319
Warm optimizer lr: 0.005
Val acc before epoch 8: 0.39361702127659576
Warm optimizer lr: 0.005
Val acc before epoch 9: 0.2872340425531915
Warm optimizer lr: 0.0025
Val acc before epoch 10: 0.4787234042553192
Warm optimizer lr: 0.0025
Val acc before epoch 11: 0.5106382978723404
Warm optimizer lr: 0.0025
Val acc before epoch 12: 0.4787234042553192
Warm optimizer lr: 0.0025
Val acc before epoch 13: 0.5638297872340425
Warm optimizer lr: 0.0025
Val acc before epoch 14: 0.574468085106383
Warm optimizer lr: 0.0025
Val acc before epoch 15: 0.5851063829787234
Warm optimizer lr: 0.0025
Val acc before epoch 16: 0.6276595744680851
Warm optimizer lr: 0.0025
Val acc before epoch 17: 0.5851063829787234
Warm optimizer lr: 0.0025
Val acc before epoch 18: 0.6914893617021277
Warm optimizer lr: 0.0025
Val acc before epoch 19: 0.5851063829787234
Warm optimizer lr: 0.00125
Val acc before epoch 20: 0.6808510638297872
Warm optimizer lr: 0.00125
Val acc before epoch 21: 0.648936170212766
Warm optimizer lr: 0.00125
Val acc before epoch 22: 0.6595744680851063
Warm optimizer lr: 0.00125
Val acc before epoch 23: 0.6914893617021277
Warm optimizer lr: 0.00125
Val acc before epoch 24: 0.6382978723404256
Warm optimizer lr: 0.00125
Val acc before epoch 25: 0.7446808510638298
Warm optimizer lr: 0.00125
Val acc before epoch 26: 0.6276595744680851
Warm optimizer lr: 0.00125
Val acc before epoch 27: 0.6914893617021277
Warm optimizer lr: 0.00125
Val acc before epoch 28: 0.7021276595744681
Warm optimizer lr: 0.00125
Val acc before epoch 29: 0.6914893617021277
Warm optimizer lr: 0.000625
Val acc before epoch 30: 0.7127659574468085
Warm optimizer lr: 0.000625
Val acc before epoch 31: 0.7553191489361702
Warm optimizer lr: 0.000625
Val acc before epoch 32: 0.723404255319149
Warm optimizer lr: 0.000625
Val acc before epoch 33: 0.723404255319149
Warm optimizer lr: 0.000625
Val acc before epoch 34: 0.7340425531914894
Warm optimizer lr: 0.000625
Val acc before epoch 35: 0.7446808510638298
Warm optimizer lr: 0.000625
Val acc before epoch 36: 0.7446808510638298
Warm optimizer lr: 0.000625
Val acc before epoch 37: 0.6382978723404256
Warm optimizer lr: 0.000625
Val acc before epoch 38: 0.7127659574468085
Warm optimizer lr: 0.000625
Val acc before epoch 39: 0.723404255319149
Warm optimizer lr: 0.0003125
Val acc before epoch 40: 0.776595744680851
Warm optimizer lr: 0.0003125
Val acc before epoch 41: 0.723404255319149
Warm optimizer lr: 0.0003125
Val acc before epoch 42: 0.723404255319149
Warm optimizer lr: 0.0003125
Val acc before epoch 43: 0.7340425531914894
Warm optimizer lr: 0.0003125
Val acc before epoch 44: 0.7553191489361702
Warm optimizer lr: 0.0003125
Val acc before epoch 45: 0.7340425531914894
Warm optimizer lr: 0.0003125
Val acc before epoch 46: 0.7340425531914894
Warm optimizer lr: 0.0003125
Val acc before epoch 47: 0.723404255319149
Warm optimizer lr: 0.0003125
Val acc before epoch 48: 0.7021276595744681
Warm optimizer lr: 0.0003125
Val acc before epoch 49: 0.7659574468085106
Warm optimizer lr: 0.00015625
Val acc before epoch 50: 0.723404255319149
Warm optimizer lr: 0.00015625
Val acc before epoch 51: 0.7446808510638298
Warm optimizer lr: 0.00015625
Val acc before epoch 52: 0.7553191489361702
Warm optimizer lr: 0.00015625
Val acc before epoch 53: 0.6808510638297872
Warm optimizer lr: 0.00015625
Val acc before epoch 54: 0.7978723404255319
Warm optimizer lr: 0.00015625
Val acc before epoch 55: 0.7872340425531915
Warm optimizer lr: 0.00015625
Val acc before epoch 56: 0.6914893617021277
Warm optimizer lr: 0.00015625
Val acc before epoch 57: 0.7340425531914894
Warm optimizer lr: 0.00015625
Val acc before epoch 58: 0.776595744680851
Warm optimizer lr: 0.00015625
Val acc before epoch 59: 0.7659574468085106
Warm optimizer lr: 7.8125e-05
Val acc before epoch 60: 0.7446808510638298
Warm optimizer lr: 7.8125e-05
Val acc before epoch 61: 0.7659574468085106
Warm optimizer lr: 7.8125e-05
Val acc before epoch 62: 0.776595744680851
Warm optimizer lr: 7.8125e-05
Val acc before epoch 63: 0.7446808510638298
Warm optimizer lr: 7.8125e-05
Val acc before epoch 64: 0.7446808510638298
Warm optimizer lr: 7.8125e-05
Val acc before epoch 65: 0.723404255319149
Warm optimizer lr: 7.8125e-05
Val acc before epoch 66: 0.723404255319149
Warm optimizer lr: 7.8125e-05
Val acc before epoch 67: 0.7553191489361702
Warm optimizer lr: 7.8125e-05
Val acc before epoch 68: 0.776595744680851
Warm optimizer lr: 7.8125e-05
Val acc before epoch 69: 0.7553191489361702
Warm optimizer lr: 3.90625e-05
Val acc before epoch 70: 0.7021276595744681
Push epoch at epoch 71.
Final validation accuracy before push: 70.2127659574468%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8269230769230769
	Train Cluster: 0.6587053656578064
	Train Separation: 0.5179755210876464
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7446808510638298
Warm optimizer lr: 3.90625e-05
Val acc before epoch 72: 0.7446808510638298
Warm optimizer lr: 3.90625e-05
Val acc before epoch 73: 0.8617021276595744
Warm optimizer lr: 3.90625e-05
Val acc before epoch 74: 0.8297872340425532
Warm optimizer lr: 3.90625e-05
Val acc before epoch 75: 0.7127659574468085
Warm optimizer lr: 3.90625e-05
Val acc before epoch 76: 0.8191489361702128
Warm optimizer lr: 3.90625e-05
Val acc before epoch 77: 0.8191489361702128
Warm optimizer lr: 3.90625e-05
Val acc before epoch 78: 0.776595744680851
Warm optimizer lr: 3.90625e-05
Val acc before epoch 79: 0.7446808510638298
Warm optimizer lr: 3.90625e-05
Val acc before epoch 80: 0.7553191489361702
Warm optimizer lr: 1.953125e-05
Val acc before epoch 81: 0.7659574468085106
Warm optimizer lr: 1.953125e-05
Val acc before epoch 82: 0.776595744680851
Warm optimizer lr: 1.953125e-05
Val acc before epoch 83: 0.776595744680851
Warm optimizer lr: 1.953125e-05
Val acc before epoch 84: 0.776595744680851
Warm optimizer lr: 1.953125e-05
Val acc before epoch 85: 0.7553191489361702
Warm optimizer lr: 1.953125e-05
Val acc before epoch 86: 0.7553191489361702
Warm optimizer lr: 1.953125e-05
Val acc before epoch 87: 0.776595744680851
Warm optimizer lr: 1.953125e-05
Val acc before epoch 88: 0.7872340425531915
Warm optimizer lr: 1.953125e-05
Val acc before epoch 89: 0.7446808510638298
Warm optimizer lr: 1.953125e-05
Val acc before epoch 90: 0.776595744680851
Warm optimizer lr: 9.765625e-06
Val acc before epoch 91: 0.7340425531914894
Warm optimizer lr: 9.765625e-06
Val acc before epoch 92: 0.7127659574468085
Warm optimizer lr: 9.765625e-06
Val acc before epoch 93: 0.6914893617021277
Warm optimizer lr: 9.765625e-06
Val acc before epoch 94: 0.7340425531914894
Warm optimizer lr: 9.765625e-06
Val acc before epoch 95: 0.7553191489361702
Warm optimizer lr: 9.765625e-06
Val acc before epoch 96: 0.7446808510638298
Warm optimizer lr: 9.765625e-06
Val acc before epoch 97: 0.8191489361702128
Warm optimizer lr: 9.765625e-06
Val acc before epoch 98: 0.7127659574468085
Warm optimizer lr: 9.765625e-06
Val acc before epoch 99: 0.8085106382978723
Warm optimizer lr: 9.765625e-06
Val acc before epoch 100: 0.7872340425531915
Warm optimizer lr: 4.8828125e-06
Val acc before epoch 101: 0.7340425531914894
Warm optimizer lr: 4.8828125e-06
Val acc before epoch 102: 0.8191489361702128
Warm optimizer lr: 4.8828125e-06
Val acc before epoch 103: 0.7659574468085106
Warm optimizer lr: 4.8828125e-06
Val acc before epoch 104: 0.7553191489361702
Stopping after epoch 105.
Final validation accuracy before push: 75.53191489361703%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8221153846153846
	Train Cluster: 0.6521314144134521
	TrainSeparation: 0.5092247128486633
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.001

Attempting combination 2/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.005
p0_warm_ptype_gamma: 0.6
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.005
Val acc before epoch 1: 0.010638297872340425
Warm optimizer lr: 0.005
Val acc before epoch 2: 0.031914893617021274
Warm optimizer lr: 0.005
Val acc before epoch 3: 0.031914893617021274
Warm optimizer lr: 0.005
Val acc before epoch 4: 0.11702127659574468
Warm optimizer lr: 0.005
Val acc before epoch 5: 0.13829787234042554
Warm optimizer lr: 0.005
Val acc before epoch 6: 0.1702127659574468
Warm optimizer lr: 0.005
Val acc before epoch 7: 0.2127659574468085
Warm optimizer lr: 0.005
Val acc before epoch 8: 0.26595744680851063
Warm optimizer lr: 0.005
Val acc before epoch 9: 0.3829787234042553
Warm optimizer lr: 0.003
Val acc before epoch 10: 0.4148936170212766
Warm optimizer lr: 0.003
Val acc before epoch 11: 0.46808510638297873
Warm optimizer lr: 0.003
Val acc before epoch 12: 0.5425531914893617
Warm optimizer lr: 0.003
Val acc before epoch 13: 0.5
Warm optimizer lr: 0.003
Val acc before epoch 14: 0.574468085106383
Warm optimizer lr: 0.003
Val acc before epoch 15: 0.5531914893617021
Warm optimizer lr: 0.003
Val acc before epoch 16: 0.6276595744680851
Warm optimizer lr: 0.003
Val acc before epoch 17: 0.723404255319149
Warm optimizer lr: 0.003
Val acc before epoch 18: 0.6914893617021277
Warm optimizer lr: 0.003
Val acc before epoch 19: 0.6914893617021277
Warm optimizer lr: 0.0018
Val acc before epoch 20: 0.6808510638297872
Warm optimizer lr: 0.0018
Val acc before epoch 21: 0.7872340425531915
Warm optimizer lr: 0.0018
Val acc before epoch 22: 0.7446808510638298
Warm optimizer lr: 0.0018
Val acc before epoch 23: 0.7021276595744681
Warm optimizer lr: 0.0018
Val acc before epoch 24: 0.7659574468085106
Warm optimizer lr: 0.0018
Val acc before epoch 25: 0.7340425531914894
Warm optimizer lr: 0.0018
Val acc before epoch 26: 0.7127659574468085
Warm optimizer lr: 0.0018
Val acc before epoch 27: 0.776595744680851
Warm optimizer lr: 0.0018
Val acc before epoch 28: 0.7340425531914894
Warm optimizer lr: 0.0018
Val acc before epoch 29: 0.8404255319148937
Warm optimizer lr: 0.00108
Val acc before epoch 30: 0.7659574468085106
Warm optimizer lr: 0.00108
Val acc before epoch 31: 0.6914893617021277
Warm optimizer lr: 0.00108
Val acc before epoch 32: 0.7978723404255319
Warm optimizer lr: 0.00108
Val acc before epoch 33: 0.7872340425531915
Warm optimizer lr: 0.00108
Val acc before epoch 34: 0.7446808510638298
Warm optimizer lr: 0.00108
Val acc before epoch 35: 0.7978723404255319
Warm optimizer lr: 0.00108
Val acc before epoch 36: 0.7978723404255319
Warm optimizer lr: 0.00108
Val acc before epoch 37: 0.7978723404255319
Warm optimizer lr: 0.00108
Val acc before epoch 38: 0.7872340425531915
Warm optimizer lr: 0.00108
Val acc before epoch 39: 0.7659574468085106
Warm optimizer lr: 0.000648
Val acc before epoch 40: 0.8297872340425532
Warm optimizer lr: 0.000648
Val acc before epoch 41: 0.7872340425531915
Warm optimizer lr: 0.000648
Val acc before epoch 42: 0.8404255319148937
Warm optimizer lr: 0.000648
Val acc before epoch 43: 0.8297872340425532
Warm optimizer lr: 0.000648
Val acc before epoch 44: 0.7978723404255319
Warm optimizer lr: 0.000648
Val acc before epoch 45: 0.7659574468085106
Warm optimizer lr: 0.000648
Val acc before epoch 46: 0.8297872340425532
Warm optimizer lr: 0.000648
Val acc before epoch 47: 0.8085106382978723
Warm optimizer lr: 0.000648
Val acc before epoch 48: 0.8191489361702128
Warm optimizer lr: 0.000648
Val acc before epoch 49: 0.8085106382978723
Warm optimizer lr: 0.0003888
Val acc before epoch 50: 0.7872340425531915
Warm optimizer lr: 0.0003888
Val acc before epoch 51: 0.851063829787234
Warm optimizer lr: 0.0003888
Val acc before epoch 52: 0.7872340425531915
Warm optimizer lr: 0.0003888
Val acc before epoch 53: 0.8404255319148937
Warm optimizer lr: 0.0003888
Val acc before epoch 54: 0.8404255319148937
Warm optimizer lr: 0.0003888
Val acc before epoch 55: 0.8085106382978723
Warm optimizer lr: 0.0003888
Val acc before epoch 56: 0.8297872340425532
Warm optimizer lr: 0.0003888
Val acc before epoch 57: 0.8404255319148937
Warm optimizer lr: 0.0003888
Val acc before epoch 58: 0.8191489361702128
Warm optimizer lr: 0.0003888
Val acc before epoch 59: 0.851063829787234
Warm optimizer lr: 0.00023328
Val acc before epoch 60: 0.8404255319148937
Warm optimizer lr: 0.00023328
Val acc before epoch 61: 0.776595744680851
Warm optimizer lr: 0.00023328
Val acc before epoch 62: 0.8404255319148937
Warm optimizer lr: 0.00023328
Val acc before epoch 63: 0.8085106382978723
Warm optimizer lr: 0.00023328
Val acc before epoch 64: 0.8297872340425532
Warm optimizer lr: 0.00023328
Val acc before epoch 65: 0.8085106382978723
Warm optimizer lr: 0.00023328
Val acc before epoch 66: 0.8617021276595744
Warm optimizer lr: 0.00023328
Val acc before epoch 67: 0.8617021276595744
Warm optimizer lr: 0.00023328
Val acc before epoch 68: 0.8829787234042553
Warm optimizer lr: 0.00023328
Val acc before epoch 69: 0.8085106382978723
Warm optimizer lr: 0.000139968
Val acc before epoch 70: 0.8191489361702128
Push epoch at epoch 71.
Final validation accuracy before push: 81.91489361702128%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8125
	Train Cluster: 0.6536945223808288
	Train Separation: 0.5155822157859802
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.8191489361702128
Warm optimizer lr: 0.000139968
Val acc before epoch 72: 0.7340425531914894
Warm optimizer lr: 0.000139968
Val acc before epoch 73: 0.7340425531914894
Warm optimizer lr: 0.000139968
Val acc before epoch 74: 0.7446808510638298
Warm optimizer lr: 0.000139968
Val acc before epoch 75: 0.776595744680851
Warm optimizer lr: 0.000139968
Val acc before epoch 76: 0.7553191489361702
Warm optimizer lr: 0.000139968
Val acc before epoch 77: 0.7872340425531915
Warm optimizer lr: 0.000139968
Val acc before epoch 78: 0.7127659574468085
Warm optimizer lr: 0.000139968
Val acc before epoch 79: 0.7340425531914894
Warm optimizer lr: 0.000139968
Val acc before epoch 80: 0.8085106382978723
Warm optimizer lr: 8.39808e-05
Val acc before epoch 81: 0.7446808510638298
Warm optimizer lr: 8.39808e-05
Val acc before epoch 82: 0.7872340425531915
Warm optimizer lr: 8.39808e-05
Val acc before epoch 83: 0.8191489361702128
Warm optimizer lr: 8.39808e-05
Val acc before epoch 84: 0.8297872340425532
Warm optimizer lr: 8.39808e-05
Val acc before epoch 85: 0.776595744680851
Warm optimizer lr: 8.39808e-05
Val acc before epoch 86: 0.7127659574468085
Warm optimizer lr: 8.39808e-05
Val acc before epoch 87: 0.7127659574468085
Warm optimizer lr: 8.39808e-05
Val acc before epoch 88: 0.7978723404255319
Warm optimizer lr: 8.39808e-05
Val acc before epoch 89: 0.723404255319149
Warm optimizer lr: 8.39808e-05
Val acc before epoch 90: 0.776595744680851
Warm optimizer lr: 5.038847999999999e-05
Val acc before epoch 91: 0.7872340425531915
Warm optimizer lr: 5.038847999999999e-05
Val acc before epoch 92: 0.7446808510638298
Warm optimizer lr: 5.038847999999999e-05
Val acc before epoch 93: 0.776595744680851
Warm optimizer lr: 5.038847999999999e-05
Val acc before epoch 94: 0.7978723404255319
Warm optimizer lr: 5.038847999999999e-05
Val acc before epoch 95: 0.7872340425531915
Warm optimizer lr: 5.038847999999999e-05
Val acc before epoch 96: 0.7446808510638298
Warm optimizer lr: 5.038847999999999e-05
Val acc before epoch 97: 0.7872340425531915
Warm optimizer lr: 5.038847999999999e-05
Val acc before epoch 98: 0.7340425531914894
Warm optimizer lr: 5.038847999999999e-05
Val acc before epoch 99: 0.7553191489361702
Warm optimizer lr: 5.038847999999999e-05
Val acc before epoch 100: 0.7872340425531915
Warm optimizer lr: 3.0233087999999994e-05
Val acc before epoch 101: 0.776595744680851
Warm optimizer lr: 3.0233087999999994e-05
Val acc before epoch 102: 0.776595744680851
Warm optimizer lr: 3.0233087999999994e-05
Val acc before epoch 103: 0.7659574468085106
Warm optimizer lr: 3.0233087999999994e-05
Val acc before epoch 104: 0.7446808510638298
Stopping after epoch 105.
Final validation accuracy before push: 74.46808510638297%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8493589743589743
	Train Cluster: 0.6622884392738342
	TrainSeparation: 0.5138616800308228
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.001

Attempting combination 3/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.005
p0_warm_ptype_gamma: 0.7
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.005
Val acc before epoch 1: 0.02127659574468085
Warm optimizer lr: 0.005
Val acc before epoch 2: 0.031914893617021274
Warm optimizer lr: 0.005
Val acc before epoch 3: 0.05319148936170213
Warm optimizer lr: 0.005
Val acc before epoch 4: 0.11702127659574468
Warm optimizer lr: 0.005
Val acc before epoch 5: 0.1276595744680851
Warm optimizer lr: 0.005
Val acc before epoch 6: 0.18085106382978725
Warm optimizer lr: 0.005
Val acc before epoch 7: 0.2872340425531915
Warm optimizer lr: 0.005
Val acc before epoch 8: 0.3617021276595745
Warm optimizer lr: 0.005
Val acc before epoch 9: 0.40425531914893614
Warm optimizer lr: 0.0034999999999999996
Val acc before epoch 10: 0.4148936170212766
Warm optimizer lr: 0.0034999999999999996
Val acc before epoch 11: 0.5212765957446809
Warm optimizer lr: 0.0034999999999999996
Val acc before epoch 12: 0.6170212765957447
Warm optimizer lr: 0.0034999999999999996
Val acc before epoch 13: 0.574468085106383
Warm optimizer lr: 0.0034999999999999996
Val acc before epoch 14: 0.6595744680851063
Warm optimizer lr: 0.0034999999999999996
Val acc before epoch 15: 0.648936170212766
Warm optimizer lr: 0.0034999999999999996
Val acc before epoch 16: 0.723404255319149
Warm optimizer lr: 0.0034999999999999996
Val acc before epoch 17: 0.6702127659574468
Warm optimizer lr: 0.0034999999999999996
Val acc before epoch 18: 0.7340425531914894
Warm optimizer lr: 0.0034999999999999996
Val acc before epoch 19: 0.7127659574468085
Warm optimizer lr: 0.0024499999999999995
Val acc before epoch 20: 0.7553191489361702
Warm optimizer lr: 0.0024499999999999995
Val acc before epoch 21: 0.7659574468085106
Warm optimizer lr: 0.0024499999999999995
Val acc before epoch 22: 0.7446808510638298
Warm optimizer lr: 0.0024499999999999995
Val acc before epoch 23: 0.8191489361702128
Warm optimizer lr: 0.0024499999999999995
Val acc before epoch 24: 0.7659574468085106
Warm optimizer lr: 0.0024499999999999995
Val acc before epoch 25: 0.7978723404255319
Warm optimizer lr: 0.0024499999999999995
Val acc before epoch 26: 0.7553191489361702
Warm optimizer lr: 0.0024499999999999995
Val acc before epoch 27: 0.7978723404255319
Warm optimizer lr: 0.0024499999999999995
Val acc before epoch 28: 0.8404255319148937
Warm optimizer lr: 0.0024499999999999995
Val acc before epoch 29: 0.7978723404255319
Warm optimizer lr: 0.0017149999999999995
Val acc before epoch 30: 0.776595744680851
Warm optimizer lr: 0.0017149999999999995
Val acc before epoch 31: 0.8829787234042553
Warm optimizer lr: 0.0017149999999999995
Val acc before epoch 32: 0.8723404255319149
Warm optimizer lr: 0.0017149999999999995
Val acc before epoch 33: 0.8297872340425532
Warm optimizer lr: 0.0017149999999999995
Val acc before epoch 34: 0.8191489361702128
Warm optimizer lr: 0.0017149999999999995
Val acc before epoch 35: 0.8617021276595744
Warm optimizer lr: 0.0017149999999999995
Val acc before epoch 36: 0.8404255319148937
Warm optimizer lr: 0.0017149999999999995
Val acc before epoch 37: 0.8617021276595744
Warm optimizer lr: 0.0017149999999999995
Val acc before epoch 38: 0.8191489361702128
Warm optimizer lr: 0.0017149999999999995
Val acc before epoch 39: 0.8297872340425532
Warm optimizer lr: 0.0012004999999999995
Val acc before epoch 40: 0.8617021276595744
Warm optimizer lr: 0.0012004999999999995
Val acc before epoch 41: 0.8191489361702128
Warm optimizer lr: 0.0012004999999999995
Val acc before epoch 42: 0.8297872340425532
Warm optimizer lr: 0.0012004999999999995
Val acc before epoch 43: 0.8085106382978723
Warm optimizer lr: 0.0012004999999999995
Val acc before epoch 44: 0.8617021276595744
Warm optimizer lr: 0.0012004999999999995
Val acc before epoch 45: 0.8404255319148937
Warm optimizer lr: 0.0012004999999999995
Val acc before epoch 46: 0.8617021276595744
Warm optimizer lr: 0.0012004999999999995
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.0012004999999999995
Val acc before epoch 48: 0.8404255319148937
Warm optimizer lr: 0.0012004999999999995
Val acc before epoch 49: 0.851063829787234
Warm optimizer lr: 0.0008403499999999996
Val acc before epoch 50: 0.8404255319148937
Warm optimizer lr: 0.0008403499999999996
Val acc before epoch 51: 0.8617021276595744
Warm optimizer lr: 0.0008403499999999996
Val acc before epoch 52: 0.8936170212765957
Warm optimizer lr: 0.0008403499999999996
Val acc before epoch 53: 0.8297872340425532
Warm optimizer lr: 0.0008403499999999996
Val acc before epoch 54: 0.8617021276595744
Warm optimizer lr: 0.0008403499999999996
Val acc before epoch 55: 0.8829787234042553
Warm optimizer lr: 0.0008403499999999996
Val acc before epoch 56: 0.9148936170212766
Warm optimizer lr: 0.0008403499999999996
Val acc before epoch 57: 0.8829787234042553
Warm optimizer lr: 0.0008403499999999996
Val acc before epoch 58: 0.851063829787234
Warm optimizer lr: 0.0008403499999999996
Val acc before epoch 59: 0.8723404255319149
Warm optimizer lr: 0.0005882449999999997
Val acc before epoch 60: 0.8617021276595744
Warm optimizer lr: 0.0005882449999999997
Val acc before epoch 61: 0.8829787234042553
Warm optimizer lr: 0.0005882449999999997
Val acc before epoch 62: 0.9042553191489362
Warm optimizer lr: 0.0005882449999999997
Val acc before epoch 63: 0.8404255319148937
Warm optimizer lr: 0.0005882449999999997
Val acc before epoch 64: 0.8723404255319149
Warm optimizer lr: 0.0005882449999999997
Val acc before epoch 65: 0.9042553191489362
Warm optimizer lr: 0.0005882449999999997
Val acc before epoch 66: 0.8936170212765957
Warm optimizer lr: 0.0005882449999999997
Val acc before epoch 67: 0.8936170212765957
Warm optimizer lr: 0.0005882449999999997
Val acc before epoch 68: 0.8829787234042553
Warm optimizer lr: 0.0005882449999999997
Val acc before epoch 69: 0.8723404255319149
Warm optimizer lr: 0.0004117714999999998
Val acc before epoch 70: 0.9042553191489362
Push epoch at epoch 71.
Final validation accuracy before push: 90.42553191489363%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8381410256410257
	Train Cluster: 0.6509278774261474
	Train Separation: 0.5102768898010254
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7872340425531915
Warm optimizer lr: 0.0004117714999999998
Val acc before epoch 72: 0.7127659574468085
Warm optimizer lr: 0.0004117714999999998
Val acc before epoch 73: 0.7021276595744681
Warm optimizer lr: 0.0004117714999999998
Val acc before epoch 74: 0.7872340425531915
Warm optimizer lr: 0.0004117714999999998
Val acc before epoch 75: 0.7553191489361702
Warm optimizer lr: 0.0004117714999999998
Val acc before epoch 76: 0.7553191489361702
Warm optimizer lr: 0.0004117714999999998
Val acc before epoch 77: 0.7553191489361702
Warm optimizer lr: 0.0004117714999999998
Val acc before epoch 78: 0.776595744680851
Warm optimizer lr: 0.0004117714999999998
Val acc before epoch 79: 0.7021276595744681
Warm optimizer lr: 0.0004117714999999998
Val acc before epoch 80: 0.7340425531914894
Warm optimizer lr: 0.00028824004999999985
Val acc before epoch 81: 0.8404255319148937
Warm optimizer lr: 0.00028824004999999985
Val acc before epoch 82: 0.7872340425531915
Warm optimizer lr: 0.00028824004999999985
Val acc before epoch 83: 0.7978723404255319
Warm optimizer lr: 0.00028824004999999985
Val acc before epoch 84: 0.8297872340425532
Warm optimizer lr: 0.00028824004999999985
Val acc before epoch 85: 0.7446808510638298
Warm optimizer lr: 0.00028824004999999985
Val acc before epoch 86: 0.7340425531914894
Warm optimizer lr: 0.00028824004999999985
Val acc before epoch 87: 0.776595744680851
Warm optimizer lr: 0.00028824004999999985
Val acc before epoch 88: 0.8297872340425532
Warm optimizer lr: 0.00028824004999999985
Val acc before epoch 89: 0.8085106382978723
Warm optimizer lr: 0.00028824004999999985
Val acc before epoch 90: 0.7553191489361702
Warm optimizer lr: 0.00020176803499999987
Val acc before epoch 91: 0.7872340425531915
Warm optimizer lr: 0.00020176803499999987
Val acc before epoch 92: 0.776595744680851
Warm optimizer lr: 0.00020176803499999987
Val acc before epoch 93: 0.7978723404255319
Warm optimizer lr: 0.00020176803499999987
Val acc before epoch 94: 0.7340425531914894
Warm optimizer lr: 0.00020176803499999987
Val acc before epoch 95: 0.7659574468085106
Warm optimizer lr: 0.00020176803499999987
Val acc before epoch 96: 0.7553191489361702
Warm optimizer lr: 0.00020176803499999987
Val acc before epoch 97: 0.8404255319148937
Warm optimizer lr: 0.00020176803499999987
Val acc before epoch 98: 0.8297872340425532
Warm optimizer lr: 0.00020176803499999987
Val acc before epoch 99: 0.8191489361702128
Warm optimizer lr: 0.00020176803499999987
Val acc before epoch 100: 0.8297872340425532
Warm optimizer lr: 0.0001412376244999999
Val acc before epoch 101: 0.776595744680851
Warm optimizer lr: 0.0001412376244999999
Val acc before epoch 102: 0.851063829787234
Warm optimizer lr: 0.0001412376244999999
Val acc before epoch 103: 0.851063829787234
Warm optimizer lr: 0.0001412376244999999
Val acc before epoch 104: 0.7872340425531915
Stopping after epoch 105.
Final validation accuracy before push: 78.72340425531915%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8365384615384616
	Train Cluster: 0.6482659697532653
	TrainSeparation: 0.5118195533752441
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.001

Attempting combination 4/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.005
p0_warm_ptype_gamma: 0.8
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.005
Val acc before epoch 1: 0.0
Warm optimizer lr: 0.005
Val acc before epoch 2: 0.0
Warm optimizer lr: 0.005
Val acc before epoch 3: 0.02127659574468085
Warm optimizer lr: 0.005
Val acc before epoch 4: 0.06382978723404255
Warm optimizer lr: 0.005
Val acc before epoch 5: 0.0851063829787234
Warm optimizer lr: 0.005
Val acc before epoch 6: 0.3191489361702128
Warm optimizer lr: 0.005
Val acc before epoch 7: 0.26595744680851063
Warm optimizer lr: 0.005
Val acc before epoch 8: 0.3191489361702128
Warm optimizer lr: 0.005
Val acc before epoch 9: 0.4148936170212766
Warm optimizer lr: 0.004
Val acc before epoch 10: 0.4148936170212766
Warm optimizer lr: 0.004
Val acc before epoch 11: 0.5638297872340425
Warm optimizer lr: 0.004
Val acc before epoch 12: 0.5638297872340425
Warm optimizer lr: 0.004
Val acc before epoch 13: 0.5957446808510638
Warm optimizer lr: 0.004
Val acc before epoch 14: 0.648936170212766
Warm optimizer lr: 0.004
Val acc before epoch 15: 0.6702127659574468
Warm optimizer lr: 0.004
Val acc before epoch 16: 0.648936170212766
Warm optimizer lr: 0.004
Val acc before epoch 17: 0.7340425531914894
Warm optimizer lr: 0.004
Val acc before epoch 18: 0.7340425531914894
Warm optimizer lr: 0.004
Val acc before epoch 19: 0.7340425531914894
Warm optimizer lr: 0.0032
Val acc before epoch 20: 0.8085106382978723
Warm optimizer lr: 0.0032
Val acc before epoch 21: 0.7659574468085106
Warm optimizer lr: 0.0032
Val acc before epoch 22: 0.7872340425531915
Warm optimizer lr: 0.0032
Val acc before epoch 23: 0.8191489361702128
Warm optimizer lr: 0.0032
Val acc before epoch 24: 0.8723404255319149
Warm optimizer lr: 0.0032
Val acc before epoch 25: 0.8191489361702128
Warm optimizer lr: 0.0032
Val acc before epoch 26: 0.776595744680851
Warm optimizer lr: 0.0032
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.0032
Val acc before epoch 28: 0.776595744680851
Warm optimizer lr: 0.0032
Val acc before epoch 29: 0.7340425531914894
Warm optimizer lr: 0.00256
Val acc before epoch 30: 0.851063829787234
Warm optimizer lr: 0.00256
Val acc before epoch 31: 0.7978723404255319
Warm optimizer lr: 0.00256
Val acc before epoch 32: 0.8617021276595744
Warm optimizer lr: 0.00256
Val acc before epoch 33: 0.851063829787234
Warm optimizer lr: 0.00256
Val acc before epoch 34: 0.8404255319148937
Warm optimizer lr: 0.00256
Val acc before epoch 35: 0.8191489361702128
Warm optimizer lr: 0.00256
Val acc before epoch 36: 0.851063829787234
Warm optimizer lr: 0.00256
Val acc before epoch 37: 0.9148936170212766
Warm optimizer lr: 0.00256
Val acc before epoch 38: 0.8723404255319149
Warm optimizer lr: 0.00256
Val acc before epoch 39: 0.9148936170212766
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 40: 0.8617021276595744
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 41: 0.8617021276595744
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 42: 0.9042553191489362
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 43: 0.8723404255319149
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 44: 0.8723404255319149
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 45: 0.9148936170212766
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 47: 0.9042553191489362
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 48: 0.8829787234042553
Warm optimizer lr: 0.0020480000000000003
Val acc before epoch 49: 0.8829787234042553
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 50: 0.9042553191489362
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 51: 0.8829787234042553
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 52: 0.8936170212765957
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 53: 0.8723404255319149
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 54: 0.8723404255319149
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 55: 0.8723404255319149
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 56: 0.8936170212765957
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 57: 0.8936170212765957
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 58: 0.9042553191489362
Warm optimizer lr: 0.0016384000000000004
Val acc before epoch 59: 0.8936170212765957
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 61: 0.9148936170212766
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 62: 0.8723404255319149
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 63: 0.8829787234042553
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 65: 0.8936170212765957
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 66: 0.8829787234042553
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 67: 0.9042553191489362
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 68: 0.9042553191489362
Warm optimizer lr: 0.0013107200000000005
Val acc before epoch 69: 0.8829787234042553
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 70: 0.9148936170212766
Push epoch at epoch 71.
Final validation accuracy before push: 91.48936170212765%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Train Cluster: 0.6466138124465942
	Train Separation: 0.5106639623641968
(Directly after push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.6808510638297872
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 72: 0.7127659574468085
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 73: 0.723404255319149
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 74: 0.7978723404255319
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 75: 0.723404255319149
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 76: 0.776595744680851
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 77: 0.7446808510638298
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 78: 0.7659574468085106
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 79: 0.7872340425531915
Warm optimizer lr: 0.0010485760000000005
Val acc before epoch 80: 0.7872340425531915
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 81: 0.7872340425531915
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 82: 0.8404255319148937
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 83: 0.7659574468085106
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 84: 0.7659574468085106
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 85: 0.8297872340425532
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 86: 0.8404255319148937
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 87: 0.851063829787234
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 88: 0.8297872340425532
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 89: 0.8191489361702128
Warm optimizer lr: 0.0008388608000000005
Val acc before epoch 90: 0.851063829787234
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 91: 0.8404255319148937
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 92: 0.8297872340425532
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 93: 0.8191489361702128
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 94: 0.851063829787234
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 95: 0.851063829787234
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 96: 0.8617021276595744
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 97: 0.8297872340425532
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 98: 0.8404255319148937
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 99: 0.8297872340425532
Warm optimizer lr: 0.0006710886400000004
Val acc before epoch 100: 0.851063829787234
Warm optimizer lr: 0.0005368709120000003
Val acc before epoch 101: 0.851063829787234
Warm optimizer lr: 0.0005368709120000003
Val acc before epoch 102: 0.7872340425531915
Warm optimizer lr: 0.0005368709120000003
Val acc before epoch 103: 0.8617021276595744
Warm optimizer lr: 0.0005368709120000003
Val acc before epoch 104: 0.8617021276595744
Stopping after epoch 105.
Final validation accuracy before push: 86.17021276595744%
Push number 2
After push, before retraining last layer:
	Train acc: 0.842948717948718
	Train Cluster: 0.6574524164199829
	TrainSeparation: 0.510385537147522
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.001

Attempting combination 5/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.005
p0_warm_ptype_gamma: 0.9
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.005
Val acc before epoch 1: 0.0
Warm optimizer lr: 0.005
Val acc before epoch 2: 0.05319148936170213
Warm optimizer lr: 0.005
Val acc before epoch 3: 0.05319148936170213
Warm optimizer lr: 0.005
Val acc before epoch 4: 0.09574468085106383
Warm optimizer lr: 0.005
Val acc before epoch 5: 0.11702127659574468
Warm optimizer lr: 0.005
Val acc before epoch 6: 0.18085106382978725
Warm optimizer lr: 0.005
Val acc before epoch 7: 0.20212765957446807
Warm optimizer lr: 0.005
Val acc before epoch 8: 0.2978723404255319
Warm optimizer lr: 0.005
Val acc before epoch 9: 0.3404255319148936
Warm optimizer lr: 0.0045000000000000005
Val acc before epoch 10: 0.46808510638297873
Warm optimizer lr: 0.0045000000000000005
Val acc before epoch 11: 0.46808510638297873
Warm optimizer lr: 0.0045000000000000005
Val acc before epoch 12: 0.5212765957446809
Warm optimizer lr: 0.0045000000000000005
Val acc before epoch 13: 0.5851063829787234
Warm optimizer lr: 0.0045000000000000005
Val acc before epoch 14: 0.6170212765957447
Warm optimizer lr: 0.0045000000000000005
Val acc before epoch 15: 0.6170212765957447
Warm optimizer lr: 0.0045000000000000005
Val acc before epoch 16: 0.6382978723404256
Warm optimizer lr: 0.0045000000000000005
Val acc before epoch 17: 0.7127659574468085
Warm optimizer lr: 0.0045000000000000005
Val acc before epoch 18: 0.7659574468085106
Warm optimizer lr: 0.0045000000000000005
Val acc before epoch 19: 0.6914893617021277
Warm optimizer lr: 0.004050000000000001
Val acc before epoch 20: 0.6702127659574468
Warm optimizer lr: 0.004050000000000001
Val acc before epoch 21: 0.7553191489361702
Warm optimizer lr: 0.004050000000000001
Val acc before epoch 22: 0.7340425531914894
Warm optimizer lr: 0.004050000000000001
Val acc before epoch 23: 0.7659574468085106
Warm optimizer lr: 0.004050000000000001
Val acc before epoch 24: 0.7872340425531915
Warm optimizer lr: 0.004050000000000001
Val acc before epoch 25: 0.8191489361702128
Warm optimizer lr: 0.004050000000000001
Val acc before epoch 26: 0.7872340425531915
Warm optimizer lr: 0.004050000000000001
Val acc before epoch 27: 0.776595744680851
Warm optimizer lr: 0.004050000000000001
Val acc before epoch 28: 0.7659574468085106
Warm optimizer lr: 0.004050000000000001
Val acc before epoch 29: 0.8404255319148937
Warm optimizer lr: 0.0036450000000000007
Val acc before epoch 30: 0.8085106382978723
Warm optimizer lr: 0.0036450000000000007
Val acc before epoch 31: 0.8085106382978723
Warm optimizer lr: 0.0036450000000000007
Val acc before epoch 32: 0.8404255319148937
Warm optimizer lr: 0.0036450000000000007
Val acc before epoch 33: 0.8297872340425532
Warm optimizer lr: 0.0036450000000000007
Val acc before epoch 34: 0.8617021276595744
Warm optimizer lr: 0.0036450000000000007
Val acc before epoch 35: 0.8191489361702128
Warm optimizer lr: 0.0036450000000000007
Val acc before epoch 36: 0.8297872340425532
Warm optimizer lr: 0.0036450000000000007
Val acc before epoch 37: 0.851063829787234
Warm optimizer lr: 0.0036450000000000007
Val acc before epoch 38: 0.8829787234042553
Warm optimizer lr: 0.0036450000000000007
Val acc before epoch 39: 0.851063829787234
Warm optimizer lr: 0.003280500000000001
Val acc before epoch 40: 0.8191489361702128
Warm optimizer lr: 0.003280500000000001
Val acc before epoch 41: 0.8936170212765957
Warm optimizer lr: 0.003280500000000001
Val acc before epoch 42: 0.8404255319148937
Warm optimizer lr: 0.003280500000000001
Val acc before epoch 43: 0.8723404255319149
Warm optimizer lr: 0.003280500000000001
Val acc before epoch 44: 0.851063829787234
Warm optimizer lr: 0.003280500000000001
Val acc before epoch 45: 0.8297872340425532
Warm optimizer lr: 0.003280500000000001
Val acc before epoch 46: 0.8936170212765957
Warm optimizer lr: 0.003280500000000001
Val acc before epoch 47: 0.8723404255319149
Warm optimizer lr: 0.003280500000000001
Val acc before epoch 48: 0.8723404255319149
Warm optimizer lr: 0.003280500000000001
Val acc before epoch 49: 0.8829787234042553
Warm optimizer lr: 0.002952450000000001
Val acc before epoch 50: 0.8723404255319149
Warm optimizer lr: 0.002952450000000001
Val acc before epoch 51: 0.8723404255319149
Warm optimizer lr: 0.002952450000000001
Val acc before epoch 52: 0.8936170212765957
Warm optimizer lr: 0.002952450000000001
Val acc before epoch 53: 0.8617021276595744
Warm optimizer lr: 0.002952450000000001
Val acc before epoch 54: 0.9042553191489362
Warm optimizer lr: 0.002952450000000001
Val acc before epoch 55: 0.8617021276595744
Warm optimizer lr: 0.002952450000000001
Val acc before epoch 56: 0.8829787234042553
Warm optimizer lr: 0.002952450000000001
Val acc before epoch 57: 0.851063829787234
Warm optimizer lr: 0.002952450000000001
Val acc before epoch 58: 0.8723404255319149
Warm optimizer lr: 0.002952450000000001
Val acc before epoch 59: 0.8829787234042553
Warm optimizer lr: 0.002657205000000001
Val acc before epoch 60: 0.9042553191489362
Warm optimizer lr: 0.002657205000000001
Val acc before epoch 61: 0.8936170212765957
Warm optimizer lr: 0.002657205000000001
Val acc before epoch 62: 0.8936170212765957
Warm optimizer lr: 0.002657205000000001
Val acc before epoch 63: 0.8829787234042553
Warm optimizer lr: 0.002657205000000001
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.002657205000000001
Val acc before epoch 65: 0.851063829787234
Warm optimizer lr: 0.002657205000000001
Val acc before epoch 66: 0.8936170212765957
Warm optimizer lr: 0.002657205000000001
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 0.002657205000000001
Val acc before epoch 68: 0.8936170212765957
Warm optimizer lr: 0.002657205000000001
Val acc before epoch 69: 0.9148936170212766
Warm optimizer lr: 0.002391484500000001
Val acc before epoch 70: 0.8723404255319149
Push epoch at epoch 71.
Final validation accuracy before push: 87.2340425531915%
Push number 1
After push, before retraining last layer:
	Train acc: 0.844551282051282
	Train Cluster: 0.6503400325775146
	Train Separation: 0.5102267026901245
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.723404255319149
Warm optimizer lr: 0.002391484500000001
Val acc before epoch 72: 0.7340425531914894
Warm optimizer lr: 0.002391484500000001
Val acc before epoch 73: 0.7659574468085106
Warm optimizer lr: 0.002391484500000001
Val acc before epoch 74: 0.7553191489361702
Warm optimizer lr: 0.002391484500000001
Val acc before epoch 75: 0.7021276595744681
Warm optimizer lr: 0.002391484500000001
Val acc before epoch 76: 0.851063829787234
Warm optimizer lr: 0.002391484500000001
Val acc before epoch 77: 0.8723404255319149
Warm optimizer lr: 0.002391484500000001
Val acc before epoch 78: 0.8829787234042553
Warm optimizer lr: 0.002391484500000001
Val acc before epoch 79: 0.8829787234042553
Warm optimizer lr: 0.002391484500000001
Val acc before epoch 80: 0.8936170212765957
Warm optimizer lr: 0.002152336050000001
Val acc before epoch 81: 0.8936170212765957
Warm optimizer lr: 0.002152336050000001
Val acc before epoch 82: 0.8617021276595744
Warm optimizer lr: 0.002152336050000001
Val acc before epoch 83: 0.9148936170212766
Warm optimizer lr: 0.002152336050000001
Val acc before epoch 84: 0.851063829787234
Warm optimizer lr: 0.002152336050000001
Val acc before epoch 85: 0.851063829787234
Warm optimizer lr: 0.002152336050000001
Val acc before epoch 86: 0.8829787234042553
Warm optimizer lr: 0.002152336050000001
Val acc before epoch 87: 0.8829787234042553
Warm optimizer lr: 0.002152336050000001
Val acc before epoch 88: 0.8191489361702128
Warm optimizer lr: 0.002152336050000001
Val acc before epoch 89: 0.8829787234042553
Warm optimizer lr: 0.002152336050000001
Val acc before epoch 90: 0.8829787234042553
Warm optimizer lr: 0.001937102445000001
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.001937102445000001
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.001937102445000001
Val acc before epoch 93: 0.851063829787234
Warm optimizer lr: 0.001937102445000001
Val acc before epoch 94: 0.8936170212765957
Warm optimizer lr: 0.001937102445000001
Val acc before epoch 95: 0.8404255319148937
Warm optimizer lr: 0.001937102445000001
Val acc before epoch 96: 0.8829787234042553
Warm optimizer lr: 0.001937102445000001
Val acc before epoch 97: 0.8936170212765957
Warm optimizer lr: 0.001937102445000001
Val acc before epoch 98: 0.8191489361702128
Warm optimizer lr: 0.001937102445000001
Val acc before epoch 99: 0.8617021276595744
Warm optimizer lr: 0.001937102445000001
Val acc before epoch 100: 0.9680851063829787
Warm optimizer lr: 0.001743392200500001
Val acc before epoch 101: 0.925531914893617
Warm optimizer lr: 0.001743392200500001
Val acc before epoch 102: 0.9042553191489362
Warm optimizer lr: 0.001743392200500001
Val acc before epoch 103: 0.9148936170212766
Warm optimizer lr: 0.001743392200500001
Val acc before epoch 104: 0.8829787234042553
Stopping after epoch 105.
Final validation accuracy before push: 88.29787234042553%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.6479657411575317
	TrainSeparation: 0.5085977792739869
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.001

Attempting combination 6/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.0075
p0_warm_ptype_gamma: 0.5
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.0075
Val acc before epoch 1: 0.05319148936170213
Warm optimizer lr: 0.0075
Val acc before epoch 2: 0.06382978723404255
Warm optimizer lr: 0.0075
Val acc before epoch 3: 0.14893617021276595
Warm optimizer lr: 0.0075
Val acc before epoch 4: 0.19148936170212766
Warm optimizer lr: 0.0075
Val acc before epoch 5: 0.32978723404255317
Warm optimizer lr: 0.0075
Val acc before epoch 6: 0.46808510638297873
Warm optimizer lr: 0.0075
Val acc before epoch 7: 0.5212765957446809
Warm optimizer lr: 0.0075
Val acc before epoch 8: 0.6914893617021277
Warm optimizer lr: 0.0075
Val acc before epoch 9: 0.6702127659574468
Warm optimizer lr: 0.00375
Val acc before epoch 10: 0.6808510638297872
Warm optimizer lr: 0.00375
Val acc before epoch 11: 0.7659574468085106
Warm optimizer lr: 0.00375
Val acc before epoch 12: 0.8085106382978723
Warm optimizer lr: 0.00375
Val acc before epoch 13: 0.7978723404255319
Warm optimizer lr: 0.00375
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.00375
Val acc before epoch 15: 0.776595744680851
Warm optimizer lr: 0.00375
Val acc before epoch 16: 0.851063829787234
Warm optimizer lr: 0.00375
Val acc before epoch 17: 0.8617021276595744
Warm optimizer lr: 0.00375
Val acc before epoch 18: 0.8191489361702128
Warm optimizer lr: 0.00375
Val acc before epoch 19: 0.7872340425531915
Warm optimizer lr: 0.001875
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.001875
Val acc before epoch 21: 0.851063829787234
Warm optimizer lr: 0.001875
Val acc before epoch 22: 0.8617021276595744
Warm optimizer lr: 0.001875
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.001875
Val acc before epoch 24: 0.8617021276595744
Warm optimizer lr: 0.001875
Val acc before epoch 25: 0.8936170212765957
Warm optimizer lr: 0.001875
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.001875
Val acc before epoch 27: 0.8191489361702128
Warm optimizer lr: 0.001875
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.001875
Val acc before epoch 29: 0.851063829787234
Warm optimizer lr: 0.0009375
Val acc before epoch 30: 0.8297872340425532
Warm optimizer lr: 0.0009375
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.0009375
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.0009375
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.0009375
Val acc before epoch 34: 0.8829787234042553
Warm optimizer lr: 0.0009375
Val acc before epoch 35: 0.8617021276595744
Warm optimizer lr: 0.0009375
Val acc before epoch 36: 0.9042553191489362
Warm optimizer lr: 0.0009375
Val acc before epoch 37: 0.9042553191489362
Warm optimizer lr: 0.0009375
Val acc before epoch 38: 0.8936170212765957
Warm optimizer lr: 0.0009375
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.00046875
Val acc before epoch 40: 0.8936170212765957
Warm optimizer lr: 0.00046875
Val acc before epoch 41: 0.8936170212765957
Warm optimizer lr: 0.00046875
Val acc before epoch 42: 0.8829787234042553
Warm optimizer lr: 0.00046875
Val acc before epoch 43: 0.851063829787234
Warm optimizer lr: 0.00046875
Val acc before epoch 44: 0.8936170212765957
Warm optimizer lr: 0.00046875
Val acc before epoch 45: 0.9148936170212766
Warm optimizer lr: 0.00046875
Val acc before epoch 46: 0.8723404255319149
Warm optimizer lr: 0.00046875
Val acc before epoch 47: 0.8936170212765957
Warm optimizer lr: 0.00046875
Val acc before epoch 48: 0.9148936170212766
Warm optimizer lr: 0.00046875
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.000234375
Val acc before epoch 50: 0.9148936170212766
Warm optimizer lr: 0.000234375
Val acc before epoch 51: 0.9042553191489362
Warm optimizer lr: 0.000234375
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.000234375
Val acc before epoch 53: 0.851063829787234
Warm optimizer lr: 0.000234375
Val acc before epoch 54: 0.925531914893617
Warm optimizer lr: 0.000234375
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.000234375
Val acc before epoch 56: 0.8404255319148937
Warm optimizer lr: 0.000234375
Val acc before epoch 57: 0.9042553191489362
Warm optimizer lr: 0.000234375
Val acc before epoch 58: 0.9148936170212766
Warm optimizer lr: 0.000234375
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.0001171875
Val acc before epoch 60: 0.9042553191489362
Warm optimizer lr: 0.0001171875
Val acc before epoch 61: 0.9042553191489362
Warm optimizer lr: 0.0001171875
Val acc before epoch 62: 0.8829787234042553
Warm optimizer lr: 0.0001171875
Val acc before epoch 63: 0.9042553191489362
Warm optimizer lr: 0.0001171875
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.0001171875
Val acc before epoch 65: 0.9148936170212766
Warm optimizer lr: 0.0001171875
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.0001171875
Val acc before epoch 67: 0.8617021276595744
Warm optimizer lr: 0.0001171875
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.0001171875
Val acc before epoch 69: 0.9042553191489362
Warm optimizer lr: 5.859375e-05
Val acc before epoch 70: 0.9361702127659575
Push epoch at epoch 71.
Final validation accuracy before push: 93.61702127659575%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.658231770992279
	Train Separation: 0.5177306413650513
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7446808510638298
Warm optimizer lr: 5.859375e-05
Val acc before epoch 72: 0.723404255319149
Warm optimizer lr: 5.859375e-05
Val acc before epoch 73: 0.7127659574468085
Warm optimizer lr: 5.859375e-05
Val acc before epoch 74: 0.7872340425531915
Warm optimizer lr: 5.859375e-05
Val acc before epoch 75: 0.7978723404255319
Warm optimizer lr: 5.859375e-05
Val acc before epoch 76: 0.6914893617021277
Warm optimizer lr: 5.859375e-05
Val acc before epoch 77: 0.7340425531914894
Warm optimizer lr: 5.859375e-05
Val acc before epoch 78: 0.7553191489361702
Warm optimizer lr: 5.859375e-05
Val acc before epoch 79: 0.6702127659574468
Warm optimizer lr: 5.859375e-05
Val acc before epoch 80: 0.7553191489361702
Warm optimizer lr: 2.9296875e-05
Val acc before epoch 81: 0.7553191489361702
Warm optimizer lr: 2.9296875e-05
Val acc before epoch 82: 0.6595744680851063
Warm optimizer lr: 2.9296875e-05
Val acc before epoch 83: 0.7127659574468085
Warm optimizer lr: 2.9296875e-05
Val acc before epoch 84: 0.7446808510638298
Warm optimizer lr: 2.9296875e-05
Val acc before epoch 85: 0.8085106382978723
Warm optimizer lr: 2.9296875e-05
Val acc before epoch 86: 0.7446808510638298
Warm optimizer lr: 2.9296875e-05
Val acc before epoch 87: 0.7659574468085106
Warm optimizer lr: 2.9296875e-05
Val acc before epoch 88: 0.6595744680851063
Warm optimizer lr: 2.9296875e-05
Val acc before epoch 89: 0.723404255319149
Warm optimizer lr: 2.9296875e-05
Val acc before epoch 90: 0.7127659574468085
Warm optimizer lr: 1.46484375e-05
Val acc before epoch 91: 0.723404255319149
Warm optimizer lr: 1.46484375e-05
Val acc before epoch 92: 0.7340425531914894
Warm optimizer lr: 1.46484375e-05
Val acc before epoch 93: 0.7659574468085106
Warm optimizer lr: 1.46484375e-05
Val acc before epoch 94: 0.776595744680851
Warm optimizer lr: 1.46484375e-05
Val acc before epoch 95: 0.8191489361702128
Warm optimizer lr: 1.46484375e-05
Val acc before epoch 96: 0.7553191489361702
Warm optimizer lr: 1.46484375e-05
Val acc before epoch 97: 0.7446808510638298
Warm optimizer lr: 1.46484375e-05
Val acc before epoch 98: 0.6914893617021277
Warm optimizer lr: 1.46484375e-05
Val acc before epoch 99: 0.7553191489361702
Warm optimizer lr: 1.46484375e-05
Val acc before epoch 100: 0.7127659574468085
Warm optimizer lr: 7.32421875e-06
Val acc before epoch 101: 0.7446808510638298
Warm optimizer lr: 7.32421875e-06
Val acc before epoch 102: 0.776595744680851
Warm optimizer lr: 7.32421875e-06
Val acc before epoch 103: 0.7340425531914894
Warm optimizer lr: 7.32421875e-06
Val acc before epoch 104: 0.7446808510638298
Stopping after epoch 105.
Final validation accuracy before push: 74.46808510638297%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Train Cluster: 0.6514028549194336
	TrainSeparation: 0.5132837414741516
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.001

Attempting combination 7/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.0075
p0_warm_ptype_gamma: 0.6
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.0075
Val acc before epoch 1: 0.06382978723404255
Warm optimizer lr: 0.0075
Val acc before epoch 2: 0.06382978723404255
Warm optimizer lr: 0.0075
Val acc before epoch 3: 0.11702127659574468
Warm optimizer lr: 0.0075
Val acc before epoch 4: 0.19148936170212766
Warm optimizer lr: 0.0075
Val acc before epoch 5: 0.3404255319148936
Warm optimizer lr: 0.0075
Val acc before epoch 6: 0.425531914893617
Warm optimizer lr: 0.0075
Val acc before epoch 7: 0.5
Warm optimizer lr: 0.0075
Val acc before epoch 8: 0.5851063829787234
Warm optimizer lr: 0.0075
Val acc before epoch 9: 0.6914893617021277
Warm optimizer lr: 0.0045
Val acc before epoch 10: 0.723404255319149
Warm optimizer lr: 0.0045
Val acc before epoch 11: 0.7872340425531915
Warm optimizer lr: 0.0045
Val acc before epoch 12: 0.776595744680851
Warm optimizer lr: 0.0045
Val acc before epoch 13: 0.723404255319149
Warm optimizer lr: 0.0045
Val acc before epoch 14: 0.8404255319148937
Warm optimizer lr: 0.0045
Val acc before epoch 15: 0.7978723404255319
Warm optimizer lr: 0.0045
Val acc before epoch 16: 0.7978723404255319
Warm optimizer lr: 0.0045
Val acc before epoch 17: 0.8085106382978723
Warm optimizer lr: 0.0045
Val acc before epoch 18: 0.8191489361702128
Warm optimizer lr: 0.0045
Val acc before epoch 19: 0.8085106382978723
Warm optimizer lr: 0.0026999999999999997
Val acc before epoch 20: 0.851063829787234
Warm optimizer lr: 0.0026999999999999997
Val acc before epoch 21: 0.8404255319148937
Warm optimizer lr: 0.0026999999999999997
Val acc before epoch 22: 0.8617021276595744
Warm optimizer lr: 0.0026999999999999997
Val acc before epoch 23: 0.8297872340425532
Warm optimizer lr: 0.0026999999999999997
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.0026999999999999997
Val acc before epoch 25: 0.8723404255319149
Warm optimizer lr: 0.0026999999999999997
Val acc before epoch 26: 0.851063829787234
Warm optimizer lr: 0.0026999999999999997
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.0026999999999999997
Val acc before epoch 28: 0.8297872340425532
Warm optimizer lr: 0.0026999999999999997
Val acc before epoch 29: 0.8617021276595744
Warm optimizer lr: 0.0016199999999999997
Val acc before epoch 30: 0.8829787234042553
Warm optimizer lr: 0.0016199999999999997
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.0016199999999999997
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.0016199999999999997
Val acc before epoch 33: 0.8829787234042553
Warm optimizer lr: 0.0016199999999999997
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.0016199999999999997
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.0016199999999999997
Val acc before epoch 36: 0.8829787234042553
Warm optimizer lr: 0.0016199999999999997
Val acc before epoch 37: 0.8936170212765957
Warm optimizer lr: 0.0016199999999999997
Val acc before epoch 38: 0.8723404255319149
Warm optimizer lr: 0.0016199999999999997
Val acc before epoch 39: 0.851063829787234
Warm optimizer lr: 0.0009719999999999998
Val acc before epoch 40: 0.8936170212765957
Warm optimizer lr: 0.0009719999999999998
Val acc before epoch 41: 0.9042553191489362
Warm optimizer lr: 0.0009719999999999998
Val acc before epoch 42: 0.9042553191489362
Warm optimizer lr: 0.0009719999999999998
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.0009719999999999998
Val acc before epoch 44: 0.8723404255319149
Warm optimizer lr: 0.0009719999999999998
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.0009719999999999998
Val acc before epoch 46: 0.8936170212765957
Warm optimizer lr: 0.0009719999999999998
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.0009719999999999998
Val acc before epoch 48: 0.8936170212765957
Warm optimizer lr: 0.0009719999999999998
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.0005831999999999999
Val acc before epoch 50: 0.9042553191489362
Warm optimizer lr: 0.0005831999999999999
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.0005831999999999999
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.0005831999999999999
Val acc before epoch 53: 0.8829787234042553
Warm optimizer lr: 0.0005831999999999999
Val acc before epoch 54: 0.8829787234042553
Warm optimizer lr: 0.0005831999999999999
Val acc before epoch 55: 0.8723404255319149
Warm optimizer lr: 0.0005831999999999999
Val acc before epoch 56: 0.8829787234042553
Warm optimizer lr: 0.0005831999999999999
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.0005831999999999999
Val acc before epoch 58: 0.9042553191489362
Warm optimizer lr: 0.0005831999999999999
Val acc before epoch 59: 0.8936170212765957
Warm optimizer lr: 0.00034991999999999993
Val acc before epoch 60: 0.9042553191489362
Warm optimizer lr: 0.00034991999999999993
Val acc before epoch 61: 0.8936170212765957
Warm optimizer lr: 0.00034991999999999993
Val acc before epoch 62: 0.8936170212765957
Warm optimizer lr: 0.00034991999999999993
Val acc before epoch 63: 0.9042553191489362
Warm optimizer lr: 0.00034991999999999993
Val acc before epoch 64: 0.8936170212765957
Warm optimizer lr: 0.00034991999999999993
Val acc before epoch 65: 0.8829787234042553
Warm optimizer lr: 0.00034991999999999993
Val acc before epoch 66: 0.8936170212765957
Warm optimizer lr: 0.00034991999999999993
Val acc before epoch 67: 0.9148936170212766
Warm optimizer lr: 0.00034991999999999993
Val acc before epoch 68: 0.9042553191489362
Warm optimizer lr: 0.00034991999999999993
Val acc before epoch 69: 0.9148936170212766
Warm optimizer lr: 0.00020995199999999996
Val acc before epoch 70: 0.8829787234042553
Push epoch at epoch 71.
Final validation accuracy before push: 88.29787234042553%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8221153846153846
	Train Cluster: 0.6595898509025574
	Train Separation: 0.5136488795280456
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7127659574468085
Warm optimizer lr: 0.00020995199999999996
Val acc before epoch 72: 0.648936170212766
Warm optimizer lr: 0.00020995199999999996
Val acc before epoch 73: 0.7553191489361702
Warm optimizer lr: 0.00020995199999999996
Val acc before epoch 74: 0.7127659574468085
Warm optimizer lr: 0.00020995199999999996
Val acc before epoch 75: 0.7340425531914894
Warm optimizer lr: 0.00020995199999999996
Val acc before epoch 76: 0.7021276595744681
Warm optimizer lr: 0.00020995199999999996
Val acc before epoch 77: 0.7446808510638298
Warm optimizer lr: 0.00020995199999999996
Val acc before epoch 78: 0.7127659574468085
Warm optimizer lr: 0.00020995199999999996
Val acc before epoch 79: 0.7340425531914894
Warm optimizer lr: 0.00020995199999999996
Val acc before epoch 80: 0.7127659574468085
Warm optimizer lr: 0.00012597119999999996
Val acc before epoch 81: 0.7446808510638298
Warm optimizer lr: 0.00012597119999999996
Val acc before epoch 82: 0.7021276595744681
Warm optimizer lr: 0.00012597119999999996
Val acc before epoch 83: 0.7659574468085106
Warm optimizer lr: 0.00012597119999999996
Val acc before epoch 84: 0.7872340425531915
Warm optimizer lr: 0.00012597119999999996
Val acc before epoch 85: 0.7659574468085106
Warm optimizer lr: 0.00012597119999999996
Val acc before epoch 86: 0.7659574468085106
Warm optimizer lr: 0.00012597119999999996
Val acc before epoch 87: 0.7021276595744681
Warm optimizer lr: 0.00012597119999999996
Val acc before epoch 88: 0.8085106382978723
Warm optimizer lr: 0.00012597119999999996
Val acc before epoch 89: 0.7446808510638298
Warm optimizer lr: 0.00012597119999999996
Val acc before epoch 90: 0.6808510638297872
Warm optimizer lr: 7.558271999999998e-05
Val acc before epoch 91: 0.7978723404255319
Warm optimizer lr: 7.558271999999998e-05
Val acc before epoch 92: 0.6914893617021277
Warm optimizer lr: 7.558271999999998e-05
Val acc before epoch 93: 0.7446808510638298
Warm optimizer lr: 7.558271999999998e-05
Val acc before epoch 94: 0.723404255319149
Warm optimizer lr: 7.558271999999998e-05
Val acc before epoch 95: 0.7021276595744681
Warm optimizer lr: 7.558271999999998e-05
Val acc before epoch 96: 0.7340425531914894
Warm optimizer lr: 7.558271999999998e-05
Val acc before epoch 97: 0.8404255319148937
Warm optimizer lr: 7.558271999999998e-05
Val acc before epoch 98: 0.7446808510638298
Warm optimizer lr: 7.558271999999998e-05
Val acc before epoch 99: 0.723404255319149
Warm optimizer lr: 7.558271999999998e-05
Val acc before epoch 100: 0.7553191489361702
Warm optimizer lr: 4.5349631999999984e-05
Val acc before epoch 101: 0.7127659574468085
Warm optimizer lr: 4.5349631999999984e-05
Val acc before epoch 102: 0.8404255319148937
Warm optimizer lr: 4.5349631999999984e-05
Val acc before epoch 103: 0.7446808510638298
Warm optimizer lr: 4.5349631999999984e-05
Val acc before epoch 104: 0.7340425531914894
Stopping after epoch 105.
Final validation accuracy before push: 73.40425531914893%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8285256410256411
	Train Cluster: 0.660362696647644
	TrainSeparation: 0.5194583296775818
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer
Last layer lr: 0.001

Attempting combination 8/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.0075
p0_warm_ptype_gamma: 0.7
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.0075
Val acc before epoch 1: 0.010638297872340425
Warm optimizer lr: 0.0075
Val acc before epoch 2: 0.0425531914893617
Warm optimizer lr: 0.0075
Val acc before epoch 3: 0.1276595744680851
Warm optimizer lr: 0.0075
Val acc before epoch 4: 0.26595744680851063
Warm optimizer lr: 0.0075
Val acc before epoch 5: 0.35106382978723405
Warm optimizer lr: 0.0075
Val acc before epoch 6: 0.425531914893617
Warm optimizer lr: 0.0075
Val acc before epoch 7: 0.5106382978723404
Warm optimizer lr: 0.0075
Val acc before epoch 8: 0.6276595744680851
Warm optimizer lr: 0.0075
Val acc before epoch 9: 0.6808510638297872
Warm optimizer lr: 0.0052499999999999995
Val acc before epoch 10: 0.6808510638297872
Warm optimizer lr: 0.0052499999999999995
Val acc before epoch 11: 0.7340425531914894
Warm optimizer lr: 0.0052499999999999995
Val acc before epoch 12: 0.7446808510638298
Warm optimizer lr: 0.0052499999999999995
Val acc before epoch 13: 0.7659574468085106
Warm optimizer lr: 0.0052499999999999995
Val acc before epoch 14: 0.7659574468085106
Warm optimizer lr: 0.0052499999999999995
Val acc before epoch 15: 0.7872340425531915
Warm optimizer lr: 0.0052499999999999995
Val acc before epoch 16: 0.8191489361702128
Warm optimizer lr: 0.0052499999999999995
Val acc before epoch 17: 0.8297872340425532
Warm optimizer lr: 0.0052499999999999995
Val acc before epoch 18: 0.8085106382978723
Warm optimizer lr: 0.0052499999999999995
Val acc before epoch 19: 0.8191489361702128
Warm optimizer lr: 0.0036749999999999994
Val acc before epoch 20: 0.8297872340425532
Warm optimizer lr: 0.0036749999999999994
Val acc before epoch 21: 0.8404255319148937
Warm optimizer lr: 0.0036749999999999994
Val acc before epoch 22: 0.8404255319148937
Warm optimizer lr: 0.0036749999999999994
Val acc before epoch 23: 0.8829787234042553
Warm optimizer lr: 0.0036749999999999994
Val acc before epoch 24: 0.851063829787234
Warm optimizer lr: 0.0036749999999999994
Val acc before epoch 25: 0.8297872340425532
Warm optimizer lr: 0.0036749999999999994
Val acc before epoch 26: 0.8191489361702128
Warm optimizer lr: 0.0036749999999999994
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.0036749999999999994
Val acc before epoch 28: 0.8723404255319149
Warm optimizer lr: 0.0036749999999999994
Val acc before epoch 29: 0.8723404255319149
Warm optimizer lr: 0.0025724999999999993
Val acc before epoch 30: 0.8723404255319149
Warm optimizer lr: 0.0025724999999999993
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.0025724999999999993
Val acc before epoch 32: 0.8617021276595744
Warm optimizer lr: 0.0025724999999999993
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.0025724999999999993
Val acc before epoch 34: 0.8617021276595744
Warm optimizer lr: 0.0025724999999999993
Val acc before epoch 35: 0.8723404255319149
Warm optimizer lr: 0.0025724999999999993
Val acc before epoch 36: 0.8936170212765957
Warm optimizer lr: 0.0025724999999999993
Val acc before epoch 37: 0.8723404255319149
Warm optimizer lr: 0.0025724999999999993
Val acc before epoch 38: 0.9042553191489362
Warm optimizer lr: 0.0025724999999999993
Val acc before epoch 39: 0.8829787234042553
Warm optimizer lr: 0.0018007499999999994
Val acc before epoch 40: 0.9042553191489362
Warm optimizer lr: 0.0018007499999999994
Val acc before epoch 41: 0.8191489361702128
Warm optimizer lr: 0.0018007499999999994
Val acc before epoch 42: 0.8936170212765957
Warm optimizer lr: 0.0018007499999999994
Val acc before epoch 43: 0.8936170212765957
Warm optimizer lr: 0.0018007499999999994
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.0018007499999999994
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.0018007499999999994
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.0018007499999999994
Val acc before epoch 47: 0.8617021276595744
Warm optimizer lr: 0.0018007499999999994
Val acc before epoch 48: 0.9042553191489362
Warm optimizer lr: 0.0018007499999999994
Val acc before epoch 49: 0.8936170212765957
Warm optimizer lr: 0.0012605249999999995
Val acc before epoch 50: 0.8723404255319149
Warm optimizer lr: 0.0012605249999999995
Val acc before epoch 51: 0.8829787234042553
Warm optimizer lr: 0.0012605249999999995
Val acc before epoch 52: 0.8936170212765957
Warm optimizer lr: 0.0012605249999999995
Val acc before epoch 53: 0.9148936170212766
Warm optimizer lr: 0.0012605249999999995
Val acc before epoch 54: 0.9042553191489362
Warm optimizer lr: 0.0012605249999999995
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.0012605249999999995
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.0012605249999999995
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.0012605249999999995
Val acc before epoch 58: 0.8829787234042553
Warm optimizer lr: 0.0012605249999999995
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.0008823674999999996
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.0008823674999999996
Val acc before epoch 61: 0.8829787234042553
Warm optimizer lr: 0.0008823674999999996
Val acc before epoch 62: 0.9042553191489362
Warm optimizer lr: 0.0008823674999999996
Val acc before epoch 63: 0.8936170212765957
Warm optimizer lr: 0.0008823674999999996
Val acc before epoch 64: 0.9148936170212766
Warm optimizer lr: 0.0008823674999999996
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.0008823674999999996
Val acc before epoch 66: 0.8936170212765957
Warm optimizer lr: 0.0008823674999999996
Val acc before epoch 67: 0.9148936170212766
Warm optimizer lr: 0.0008823674999999996
Val acc before epoch 68: 0.9148936170212766
Warm optimizer lr: 0.0008823674999999996
Val acc before epoch 69: 0.8829787234042553
Warm optimizer lr: 0.0006176572499999997
Val acc before epoch 70: 0.9468085106382979
Push epoch at epoch 71.
Final validation accuracy before push: 94.68085106382979%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8285256410256411
	Train Cluster: 0.6542743802070617
	Train Separation: 0.5123213529586792
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.723404255319149
Warm optimizer lr: 0.0006176572499999997
Val acc before epoch 72: 0.7127659574468085
Warm optimizer lr: 0.0006176572499999997
Val acc before epoch 73: 0.7021276595744681
Warm optimizer lr: 0.0006176572499999997
Val acc before epoch 74: 0.6702127659574468
Warm optimizer lr: 0.0006176572499999997
Val acc before epoch 75: 0.7553191489361702
Warm optimizer lr: 0.0006176572499999997
Val acc before epoch 76: 0.7659574468085106
Warm optimizer lr: 0.0006176572499999997
Val acc before epoch 77: 0.7872340425531915
Warm optimizer lr: 0.0006176572499999997
Val acc before epoch 78: 0.7127659574468085
Warm optimizer lr: 0.0006176572499999997
Val acc before epoch 79: 0.7553191489361702
Warm optimizer lr: 0.0006176572499999997
Val acc before epoch 80: 0.8085106382978723
Warm optimizer lr: 0.00043236007499999977
Val acc before epoch 81: 0.8297872340425532
Warm optimizer lr: 0.00043236007499999977
Val acc before epoch 82: 0.8085106382978723
Warm optimizer lr: 0.00043236007499999977
Val acc before epoch 83: 0.7872340425531915
Warm optimizer lr: 0.00043236007499999977
Val acc before epoch 84: 0.8085106382978723
Warm optimizer lr: 0.00043236007499999977
Val acc before epoch 85: 0.7872340425531915
Warm optimizer lr: 0.00043236007499999977
Val acc before epoch 86: 0.7553191489361702
Warm optimizer lr: 0.00043236007499999977
Val acc before epoch 87: 0.8085106382978723
Warm optimizer lr: 0.00043236007499999977
Val acc before epoch 88: 0.8297872340425532
Warm optimizer lr: 0.00043236007499999977
Val acc before epoch 89: 0.7978723404255319
Warm optimizer lr: 0.00043236007499999977
Val acc before epoch 90: 0.7978723404255319
Warm optimizer lr: 0.00030265205249999983
Val acc before epoch 91: 0.7446808510638298
Warm optimizer lr: 0.00030265205249999983
Val acc before epoch 92: 0.8191489361702128
Warm optimizer lr: 0.00030265205249999983
Val acc before epoch 93: 0.7978723404255319
Warm optimizer lr: 0.00030265205249999983
Val acc before epoch 94: 0.8723404255319149
Warm optimizer lr: 0.00030265205249999983
Val acc before epoch 95: 0.8617021276595744
Warm optimizer lr: 0.00030265205249999983
Val acc before epoch 96: 0.7553191489361702
Warm optimizer lr: 0.00030265205249999983
Val acc before epoch 97: 0.8297872340425532
Warm optimizer lr: 0.00030265205249999983
Val acc before epoch 98: 0.8723404255319149
Warm optimizer lr: 0.00030265205249999983
Val acc before epoch 99: 0.8297872340425532
Warm optimizer lr: 0.00030265205249999983
Val acc before epoch 100: 0.8085106382978723
Warm optimizer lr: 0.00021185643674999987
Val acc before epoch 101: 0.7446808510638298
Warm optimizer lr: 0.00021185643674999987
Val acc before epoch 102: 0.8085106382978723
Warm optimizer lr: 0.00021185643674999987
Val acc before epoch 103: 0.8297872340425532
Warm optimizer lr: 0.00021185643674999987
Val acc before epoch 104: 0.8085106382978723
Stopping after epoch 105.
Final validation accuracy before push: 80.85106382978722%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8301282051282052
	Train Cluster: 0.654861843585968
	TrainSeparation: 0.5145509362220764
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.001

Attempting combination 9/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.0075
p0_warm_ptype_gamma: 0.8
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.0075
Val acc before epoch 1: 0.010638297872340425
Warm optimizer lr: 0.0075
Val acc before epoch 2: 0.06382978723404255
Warm optimizer lr: 0.0075
Val acc before epoch 3: 0.0851063829787234
Warm optimizer lr: 0.0075
Val acc before epoch 4: 0.22340425531914893
Warm optimizer lr: 0.0075
Val acc before epoch 5: 0.26595744680851063
Warm optimizer lr: 0.0075
Val acc before epoch 6: 0.5106382978723404
Warm optimizer lr: 0.0075
Val acc before epoch 7: 0.5212765957446809
Warm optimizer lr: 0.0075
Val acc before epoch 8: 0.6382978723404256
Warm optimizer lr: 0.0075
Val acc before epoch 9: 0.7127659574468085
Warm optimizer lr: 0.006
Val acc before epoch 10: 0.7659574468085106
Warm optimizer lr: 0.006
Val acc before epoch 11: 0.7978723404255319
Warm optimizer lr: 0.006
Val acc before epoch 12: 0.776595744680851
Warm optimizer lr: 0.006
Val acc before epoch 13: 0.8404255319148937
Warm optimizer lr: 0.006
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.006
Val acc before epoch 15: 0.8297872340425532
Warm optimizer lr: 0.006
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.006
Val acc before epoch 17: 0.8404255319148937
Warm optimizer lr: 0.006
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.006
Val acc before epoch 19: 0.8404255319148937
Warm optimizer lr: 0.0048000000000000004
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.0048000000000000004
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.0048000000000000004
Val acc before epoch 22: 0.8617021276595744
Warm optimizer lr: 0.0048000000000000004
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.0048000000000000004
Val acc before epoch 24: 0.8829787234042553
Warm optimizer lr: 0.0048000000000000004
Val acc before epoch 25: 0.8936170212765957
Warm optimizer lr: 0.0048000000000000004
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.0048000000000000004
Val acc before epoch 27: 0.9042553191489362
Warm optimizer lr: 0.0048000000000000004
Val acc before epoch 28: 0.8829787234042553
Warm optimizer lr: 0.0048000000000000004
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.0038400000000000005
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.0038400000000000005
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.0038400000000000005
Val acc before epoch 32: 0.8829787234042553
Warm optimizer lr: 0.0038400000000000005
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.0038400000000000005
Val acc before epoch 34: 0.8829787234042553
Warm optimizer lr: 0.0038400000000000005
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.0038400000000000005
Val acc before epoch 36: 0.9148936170212766
Warm optimizer lr: 0.0038400000000000005
Val acc before epoch 37: 0.9148936170212766
Warm optimizer lr: 0.0038400000000000005
Val acc before epoch 38: 0.9148936170212766
Warm optimizer lr: 0.0038400000000000005
Val acc before epoch 39: 0.8936170212765957
Warm optimizer lr: 0.0030720000000000005
Val acc before epoch 40: 0.9148936170212766
Warm optimizer lr: 0.0030720000000000005
Val acc before epoch 41: 0.9148936170212766
Warm optimizer lr: 0.0030720000000000005
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.0030720000000000005
Val acc before epoch 43: 0.9148936170212766
Warm optimizer lr: 0.0030720000000000005
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.0030720000000000005
Val acc before epoch 45: 0.9148936170212766
Warm optimizer lr: 0.0030720000000000005
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.0030720000000000005
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.0030720000000000005
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 0.0030720000000000005
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.0024576000000000008
Val acc before epoch 50: 0.8936170212765957
Warm optimizer lr: 0.0024576000000000008
Val acc before epoch 51: 0.9148936170212766
Warm optimizer lr: 0.0024576000000000008
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.0024576000000000008
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.0024576000000000008
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.0024576000000000008
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.0024576000000000008
Val acc before epoch 56: 0.925531914893617
Warm optimizer lr: 0.0024576000000000008
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.0024576000000000008
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.0024576000000000008
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.0019660800000000007
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.0019660800000000007
Val acc before epoch 61: 0.9042553191489362
Warm optimizer lr: 0.0019660800000000007
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 0.0019660800000000007
Val acc before epoch 63: 0.9148936170212766
Warm optimizer lr: 0.0019660800000000007
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.0019660800000000007
Val acc before epoch 65: 0.925531914893617
Warm optimizer lr: 0.0019660800000000007
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.0019660800000000007
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.0019660800000000007
Val acc before epoch 68: 0.9361702127659575
Warm optimizer lr: 0.0019660800000000007
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.0015728640000000006
Val acc before epoch 70: 0.9680851063829787
Push epoch at epoch 71.
Final validation accuracy before push: 96.80851063829788%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8173076923076923
	Train Cluster: 0.6513672471046448
	Train Separation: 0.5157078027725219
(Directly after push) Val acc at iteration 0: 0.8297872340425532
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7978723404255319
Warm optimizer lr: 0.0015728640000000006
Val acc before epoch 72: 0.723404255319149
Warm optimizer lr: 0.0015728640000000006
Val acc before epoch 73: 0.8297872340425532
Warm optimizer lr: 0.0015728640000000006
Val acc before epoch 74: 0.8297872340425532
Warm optimizer lr: 0.0015728640000000006
Val acc before epoch 75: 0.7978723404255319
Warm optimizer lr: 0.0015728640000000006
Val acc before epoch 76: 0.7872340425531915
Warm optimizer lr: 0.0015728640000000006
Val acc before epoch 77: 0.8617021276595744
Warm optimizer lr: 0.0015728640000000006
Val acc before epoch 78: 0.7978723404255319
Warm optimizer lr: 0.0015728640000000006
Val acc before epoch 79: 0.8191489361702128
Warm optimizer lr: 0.0015728640000000006
Val acc before epoch 80: 0.8723404255319149
Warm optimizer lr: 0.0012582912000000006
Val acc before epoch 81: 0.8404255319148937
Warm optimizer lr: 0.0012582912000000006
Val acc before epoch 82: 0.8297872340425532
Warm optimizer lr: 0.0012582912000000006
Val acc before epoch 83: 0.851063829787234
Warm optimizer lr: 0.0012582912000000006
Val acc before epoch 84: 0.8829787234042553
Warm optimizer lr: 0.0012582912000000006
Val acc before epoch 85: 0.8404255319148937
Warm optimizer lr: 0.0012582912000000006
Val acc before epoch 86: 0.851063829787234
Warm optimizer lr: 0.0012582912000000006
Val acc before epoch 87: 0.8297872340425532
Warm optimizer lr: 0.0012582912000000006
Val acc before epoch 88: 0.8723404255319149
Warm optimizer lr: 0.0012582912000000006
Val acc before epoch 89: 0.8723404255319149
Warm optimizer lr: 0.0012582912000000006
Val acc before epoch 90: 0.9148936170212766
Warm optimizer lr: 0.0010066329600000006
Val acc before epoch 91: 0.8404255319148937
Warm optimizer lr: 0.0010066329600000006
Val acc before epoch 92: 0.8723404255319149
Warm optimizer lr: 0.0010066329600000006
Val acc before epoch 93: 0.8297872340425532
Warm optimizer lr: 0.0010066329600000006
Val acc before epoch 94: 0.9042553191489362
Warm optimizer lr: 0.0010066329600000006
Val acc before epoch 95: 0.8723404255319149
Warm optimizer lr: 0.0010066329600000006
Val acc before epoch 96: 0.851063829787234
Warm optimizer lr: 0.0010066329600000006
Val acc before epoch 97: 0.9148936170212766
Warm optimizer lr: 0.0010066329600000006
Val acc before epoch 98: 0.8723404255319149
Warm optimizer lr: 0.0010066329600000006
Val acc before epoch 99: 0.8829787234042553
Warm optimizer lr: 0.0010066329600000006
Val acc before epoch 100: 0.8829787234042553
Warm optimizer lr: 0.0008053063680000006
Val acc before epoch 101: 0.9042553191489362
Warm optimizer lr: 0.0008053063680000006
Val acc before epoch 102: 0.8617021276595744
Warm optimizer lr: 0.0008053063680000006
Val acc before epoch 103: 0.9148936170212766
Warm optimizer lr: 0.0008053063680000006
Val acc before epoch 104: 0.9042553191489362
Stopping after epoch 105.
Final validation accuracy before push: 90.42553191489363%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.6505667328834533
	TrainSeparation: 0.5074110269546509
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.001

Attempting combination 10/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.0075
p0_warm_ptype_gamma: 0.9
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.0075
Val acc before epoch 1: 0.031914893617021274
Warm optimizer lr: 0.0075
Val acc before epoch 2: 0.0425531914893617
Warm optimizer lr: 0.0075
Val acc before epoch 3: 0.22340425531914893
Warm optimizer lr: 0.0075
Val acc before epoch 4: 0.2872340425531915
Warm optimizer lr: 0.0075
Val acc before epoch 5: 0.3829787234042553
Warm optimizer lr: 0.0075
Val acc before epoch 6: 0.44680851063829785
Warm optimizer lr: 0.0075
Val acc before epoch 7: 0.574468085106383
Warm optimizer lr: 0.0075
Val acc before epoch 8: 0.6702127659574468
Warm optimizer lr: 0.0075
Val acc before epoch 9: 0.7021276595744681
Warm optimizer lr: 0.00675
Val acc before epoch 10: 0.7127659574468085
Warm optimizer lr: 0.00675
Val acc before epoch 11: 0.6808510638297872
Warm optimizer lr: 0.00675
Val acc before epoch 12: 0.8191489361702128
Warm optimizer lr: 0.00675
Val acc before epoch 13: 0.851063829787234
Warm optimizer lr: 0.00675
Val acc before epoch 14: 0.851063829787234
Warm optimizer lr: 0.00675
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.00675
Val acc before epoch 16: 0.8297872340425532
Warm optimizer lr: 0.00675
Val acc before epoch 17: 0.8936170212765957
Warm optimizer lr: 0.00675
Val acc before epoch 18: 0.851063829787234
Warm optimizer lr: 0.00675
Val acc before epoch 19: 0.8936170212765957
Warm optimizer lr: 0.006075
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.006075
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.006075
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.006075
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.006075
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.006075
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.006075
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.006075
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.006075
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.006075
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.0054675
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.0054675
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.0054675
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.0054675
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.0054675
Val acc before epoch 34: 0.9680851063829787
Warm optimizer lr: 0.0054675
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.0054675
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.0054675
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.0054675
Val acc before epoch 38: 0.9680851063829787
Warm optimizer lr: 0.0054675
Val acc before epoch 39: 0.9574468085106383
Warm optimizer lr: 0.004920750000000001
Val acc before epoch 40: 0.9574468085106383
Warm optimizer lr: 0.004920750000000001
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.004920750000000001
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.004920750000000001
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.004920750000000001
Val acc before epoch 44: 0.9574468085106383
Warm optimizer lr: 0.004920750000000001
Val acc before epoch 45: 0.9680851063829787
Warm optimizer lr: 0.004920750000000001
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.004920750000000001
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.004920750000000001
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 0.004920750000000001
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.004428675000000001
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.004428675000000001
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.004428675000000001
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.004428675000000001
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.004428675000000001
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.004428675000000001
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.004428675000000001
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.004428675000000001
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.004428675000000001
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.004428675000000001
Val acc before epoch 59: 0.9787234042553191
Warm optimizer lr: 0.003985807500000001
Val acc before epoch 60: 0.9680851063829787
Warm optimizer lr: 0.003985807500000001
Val acc before epoch 61: 0.925531914893617
Warm optimizer lr: 0.003985807500000001
Val acc before epoch 62: 0.9680851063829787
Warm optimizer lr: 0.003985807500000001
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.003985807500000001
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.003985807500000001
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.003985807500000001
Val acc before epoch 66: 0.9680851063829787
Warm optimizer lr: 0.003985807500000001
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.003985807500000001
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.003985807500000001
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.0035872267500000007
Val acc before epoch 70: 0.925531914893617
Push epoch at epoch 71.
Final validation accuracy before push: 92.5531914893617%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.6442209124565125
	Train Separation: 0.513643765449524
(Directly after push) Val acc at iteration 0: 0.8297872340425532
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7446808510638298
Warm optimizer lr: 0.0035872267500000007
Val acc before epoch 72: 0.776595744680851
Warm optimizer lr: 0.0035872267500000007
Val acc before epoch 73: 0.8936170212765957
Warm optimizer lr: 0.0035872267500000007
Val acc before epoch 74: 0.7978723404255319
Warm optimizer lr: 0.0035872267500000007
Val acc before epoch 75: 0.7872340425531915
Warm optimizer lr: 0.0035872267500000007
Val acc before epoch 76: 0.9148936170212766
Warm optimizer lr: 0.0035872267500000007
Val acc before epoch 77: 0.9148936170212766
Warm optimizer lr: 0.0035872267500000007
Val acc before epoch 78: 0.8617021276595744
Warm optimizer lr: 0.0035872267500000007
Val acc before epoch 79: 0.8829787234042553
Warm optimizer lr: 0.0035872267500000007
Val acc before epoch 80: 0.8723404255319149
Warm optimizer lr: 0.0032285040750000007
Val acc before epoch 81: 0.9361702127659575
Warm optimizer lr: 0.0032285040750000007
Val acc before epoch 82: 0.9148936170212766
Warm optimizer lr: 0.0032285040750000007
Val acc before epoch 83: 0.8936170212765957
Warm optimizer lr: 0.0032285040750000007
Val acc before epoch 84: 0.9361702127659575
Warm optimizer lr: 0.0032285040750000007
Val acc before epoch 85: 0.8829787234042553
Warm optimizer lr: 0.0032285040750000007
Val acc before epoch 86: 0.8829787234042553
Warm optimizer lr: 0.0032285040750000007
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 0.0032285040750000007
Val acc before epoch 88: 0.8936170212765957
Warm optimizer lr: 0.0032285040750000007
Val acc before epoch 89: 0.9042553191489362
Warm optimizer lr: 0.0032285040750000007
Val acc before epoch 90: 0.9042553191489362
Warm optimizer lr: 0.002905653667500001
Val acc before epoch 91: 0.8829787234042553
Warm optimizer lr: 0.002905653667500001
Val acc before epoch 92: 0.9148936170212766
Warm optimizer lr: 0.002905653667500001
Val acc before epoch 93: 0.9574468085106383
Warm optimizer lr: 0.002905653667500001
Val acc before epoch 94: 0.925531914893617
Warm optimizer lr: 0.002905653667500001
Val acc before epoch 95: 0.9468085106382979
Warm optimizer lr: 0.002905653667500001
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.002905653667500001
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.002905653667500001
Val acc before epoch 98: 0.8829787234042553
Warm optimizer lr: 0.002905653667500001
Val acc before epoch 99: 0.925531914893617
Warm optimizer lr: 0.002905653667500001
Val acc before epoch 100: 0.9468085106382979
Warm optimizer lr: 0.0026150883007500006
Val acc before epoch 101: 0.9361702127659575
Warm optimizer lr: 0.0026150883007500006
Val acc before epoch 102: 0.8404255319148937
Warm optimizer lr: 0.0026150883007500006
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.0026150883007500006
Val acc before epoch 104: 0.925531914893617
Stopping after epoch 105.
Final validation accuracy before push: 92.5531914893617%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8333333333333334
	Train Cluster: 0.6528695702552796
	TrainSeparation: 0.5137393712997437
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: 0.001

Attempting combination 11/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.01
p0_warm_ptype_gamma: 0.5
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.01
Val acc before epoch 1: 0.02127659574468085
Warm optimizer lr: 0.01
Val acc before epoch 2: 0.07446808510638298
Warm optimizer lr: 0.01
Val acc before epoch 3: 0.2872340425531915
Warm optimizer lr: 0.01
Val acc before epoch 4: 0.40425531914893614
Warm optimizer lr: 0.01
Val acc before epoch 5: 0.46808510638297873
Warm optimizer lr: 0.01
Val acc before epoch 6: 0.6170212765957447
Warm optimizer lr: 0.01
Val acc before epoch 7: 0.7872340425531915
Warm optimizer lr: 0.01
Val acc before epoch 8: 0.776595744680851
Warm optimizer lr: 0.01
Val acc before epoch 9: 0.8085106382978723
Warm optimizer lr: 0.005
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.005
Val acc before epoch 11: 0.8085106382978723
Warm optimizer lr: 0.005
Val acc before epoch 12: 0.851063829787234
Warm optimizer lr: 0.005
Val acc before epoch 13: 0.8404255319148937
Warm optimizer lr: 0.005
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.005
Val acc before epoch 15: 0.851063829787234
Warm optimizer lr: 0.005
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.005
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.005
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.005
Val acc before epoch 19: 0.8723404255319149
Warm optimizer lr: 0.0025
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.0025
Val acc before epoch 21: 0.8723404255319149
Warm optimizer lr: 0.0025
Val acc before epoch 22: 0.851063829787234
Warm optimizer lr: 0.0025
Val acc before epoch 23: 0.8723404255319149
Warm optimizer lr: 0.0025
Val acc before epoch 24: 0.8404255319148937
Warm optimizer lr: 0.0025
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.0025
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.0025
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.0025
Val acc before epoch 28: 0.8936170212765957
Warm optimizer lr: 0.0025
Val acc before epoch 29: 0.851063829787234
Warm optimizer lr: 0.00125
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.00125
Val acc before epoch 31: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.00125
Val acc before epoch 35: 0.8936170212765957
Warm optimizer lr: 0.00125
Val acc before epoch 36: 0.8723404255319149
Warm optimizer lr: 0.00125
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.00125
Val acc before epoch 38: 0.925531914893617
Warm optimizer lr: 0.00125
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.000625
Val acc before epoch 40: 0.9042553191489362
Warm optimizer lr: 0.000625
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.000625
Val acc before epoch 42: 0.8936170212765957
Warm optimizer lr: 0.000625
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 0.000625
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.000625
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.000625
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.000625
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.000625
Val acc before epoch 48: 0.8936170212765957
Warm optimizer lr: 0.000625
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.0003125
Val acc before epoch 50: 0.8829787234042553
Warm optimizer lr: 0.0003125
Val acc before epoch 51: 0.8936170212765957
Warm optimizer lr: 0.0003125
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.0003125
Val acc before epoch 53: 0.9042553191489362
Warm optimizer lr: 0.0003125
Val acc before epoch 54: 0.8617021276595744
Warm optimizer lr: 0.0003125
Val acc before epoch 55: 0.9042553191489362
Warm optimizer lr: 0.0003125
Val acc before epoch 56: 0.9148936170212766
Warm optimizer lr: 0.0003125
Val acc before epoch 57: 0.9042553191489362
Warm optimizer lr: 0.0003125
Val acc before epoch 58: 0.8936170212765957
Warm optimizer lr: 0.0003125
Val acc before epoch 59: 0.9680851063829787
Warm optimizer lr: 0.00015625
Val acc before epoch 60: 0.9148936170212766
Warm optimizer lr: 0.00015625
Val acc before epoch 61: 0.9042553191489362
Warm optimizer lr: 0.00015625
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.00015625
Val acc before epoch 63: 0.8936170212765957
Warm optimizer lr: 0.00015625
Val acc before epoch 64: 0.9042553191489362
Warm optimizer lr: 0.00015625
Val acc before epoch 65: 0.925531914893617
Warm optimizer lr: 0.00015625
Val acc before epoch 66: 0.9042553191489362
Warm optimizer lr: 0.00015625
Val acc before epoch 67: 0.8829787234042553
Warm optimizer lr: 0.00015625
Val acc before epoch 68: 0.9148936170212766
Warm optimizer lr: 0.00015625
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 7.8125e-05
Val acc before epoch 70: 0.9042553191489362
Push epoch at epoch 71.
Final validation accuracy before push: 90.42553191489363%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8349358974358975
	Train Cluster: 0.6512510657310486
	Train Separation: 0.513456666469574
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.776595744680851
Warm optimizer lr: 7.8125e-05
Val acc before epoch 72: 0.7340425531914894
Warm optimizer lr: 7.8125e-05
Val acc before epoch 73: 0.8191489361702128
Warm optimizer lr: 7.8125e-05
Val acc before epoch 74: 0.7553191489361702
Warm optimizer lr: 7.8125e-05
Val acc before epoch 75: 0.7659574468085106
Warm optimizer lr: 7.8125e-05
Val acc before epoch 76: 0.8617021276595744
Warm optimizer lr: 7.8125e-05
Val acc before epoch 77: 0.7872340425531915
Warm optimizer lr: 7.8125e-05
Val acc before epoch 78: 0.7340425531914894
Warm optimizer lr: 7.8125e-05
Val acc before epoch 79: 0.7553191489361702
Warm optimizer lr: 7.8125e-05
Val acc before epoch 80: 0.7978723404255319
Warm optimizer lr: 3.90625e-05
Val acc before epoch 81: 0.7872340425531915
Warm optimizer lr: 3.90625e-05
Val acc before epoch 82: 0.8404255319148937
Warm optimizer lr: 3.90625e-05
Val acc before epoch 83: 0.7553191489361702
Warm optimizer lr: 3.90625e-05
Val acc before epoch 84: 0.7659574468085106
Warm optimizer lr: 3.90625e-05
Val acc before epoch 85: 0.8297872340425532
Warm optimizer lr: 3.90625e-05
Val acc before epoch 86: 0.7978723404255319
Warm optimizer lr: 3.90625e-05
Val acc before epoch 87: 0.8191489361702128
Warm optimizer lr: 3.90625e-05
Val acc before epoch 88: 0.8085106382978723
Warm optimizer lr: 3.90625e-05
Val acc before epoch 89: 0.7127659574468085
Warm optimizer lr: 3.90625e-05
Val acc before epoch 90: 0.7872340425531915
Warm optimizer lr: 1.953125e-05
Val acc before epoch 91: 0.851063829787234
Warm optimizer lr: 1.953125e-05
Val acc before epoch 92: 0.8085106382978723
Warm optimizer lr: 1.953125e-05
Val acc before epoch 93: 0.6276595744680851
Warm optimizer lr: 1.953125e-05
Val acc before epoch 94: 0.7659574468085106
Warm optimizer lr: 1.953125e-05
Val acc before epoch 95: 0.776595744680851
Warm optimizer lr: 1.953125e-05
Val acc before epoch 96: 0.7553191489361702
Warm optimizer lr: 1.953125e-05
Val acc before epoch 97: 0.7553191489361702
Warm optimizer lr: 1.953125e-05
Val acc before epoch 98: 0.7659574468085106
Warm optimizer lr: 1.953125e-05
Val acc before epoch 99: 0.776595744680851
Warm optimizer lr: 1.953125e-05
Val acc before epoch 100: 0.7553191489361702
Warm optimizer lr: 9.765625e-06
Val acc before epoch 101: 0.8297872340425532
Warm optimizer lr: 9.765625e-06
Val acc before epoch 102: 0.7872340425531915
Warm optimizer lr: 9.765625e-06
Val acc before epoch 103: 0.7978723404255319
Warm optimizer lr: 9.765625e-06
Val acc before epoch 104: 0.776595744680851
Stopping after epoch 105.
Final validation accuracy before push: 77.6595744680851%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.6612597227096557
	TrainSeparation: 0.5148789644241333
(Directly after push) Val acc at iteration 0: 0.8191489361702128
Retraining last layer
Last layer lr: 0.001

Attempting combination 12/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.01
p0_warm_ptype_gamma: 0.6
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.01
Val acc before epoch 1: 0.010638297872340425
Warm optimizer lr: 0.01
Val acc before epoch 2: 0.11702127659574468
Warm optimizer lr: 0.01
Val acc before epoch 3: 0.13829787234042554
Warm optimizer lr: 0.01
Val acc before epoch 4: 0.3617021276595745
Warm optimizer lr: 0.01
Val acc before epoch 5: 0.3617021276595745
Warm optimizer lr: 0.01
Val acc before epoch 6: 0.6276595744680851
Warm optimizer lr: 0.01
Val acc before epoch 7: 0.6702127659574468
Warm optimizer lr: 0.01
Val acc before epoch 8: 0.7340425531914894
Warm optimizer lr: 0.01
Val acc before epoch 9: 0.7659574468085106
Warm optimizer lr: 0.006
Val acc before epoch 10: 0.8085106382978723
Warm optimizer lr: 0.006
Val acc before epoch 11: 0.8191489361702128
Warm optimizer lr: 0.006
Val acc before epoch 12: 0.851063829787234
Warm optimizer lr: 0.006
Val acc before epoch 13: 0.8085106382978723
Warm optimizer lr: 0.006
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.006
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.006
Val acc before epoch 16: 0.8617021276595744
Warm optimizer lr: 0.006
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.006
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.006
Val acc before epoch 19: 0.8617021276595744
Warm optimizer lr: 0.0036
Val acc before epoch 20: 0.8617021276595744
Warm optimizer lr: 0.0036
Val acc before epoch 21: 0.8829787234042553
Warm optimizer lr: 0.0036
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.0036
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.0036
Val acc before epoch 24: 0.8829787234042553
Warm optimizer lr: 0.0036
Val acc before epoch 25: 0.9042553191489362
Warm optimizer lr: 0.0036
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.0036
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.0036
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.0036
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.00216
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.00216
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.00216
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.00216
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.00216
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.00216
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.00216
Val acc before epoch 36: 0.9042553191489362
Warm optimizer lr: 0.00216
Val acc before epoch 37: 0.8936170212765957
Warm optimizer lr: 0.00216
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.00216
Val acc before epoch 39: 0.9042553191489362
Warm optimizer lr: 0.001296
Val acc before epoch 40: 0.9148936170212766
Warm optimizer lr: 0.001296
Val acc before epoch 41: 0.9042553191489362
Warm optimizer lr: 0.001296
Val acc before epoch 42: 0.8829787234042553
Warm optimizer lr: 0.001296
Val acc before epoch 43: 0.9042553191489362
Warm optimizer lr: 0.001296
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.001296
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.001296
Val acc before epoch 46: 0.8829787234042553
Warm optimizer lr: 0.001296
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.001296
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.001296
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.0007776
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.0007776
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.0007776
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.0007776
Val acc before epoch 53: 0.9148936170212766
Warm optimizer lr: 0.0007776
Val acc before epoch 54: 0.9148936170212766
Warm optimizer lr: 0.0007776
Val acc before epoch 55: 0.9148936170212766
Warm optimizer lr: 0.0007776
Val acc before epoch 56: 0.9148936170212766
Warm optimizer lr: 0.0007776
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.0007776
Val acc before epoch 58: 0.8936170212765957
Warm optimizer lr: 0.0007776
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.00046656
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.00046656
Val acc before epoch 61: 0.9042553191489362
Warm optimizer lr: 0.00046656
Val acc before epoch 62: 0.8936170212765957
Warm optimizer lr: 0.00046656
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.00046656
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.00046656
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.00046656
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 0.00046656
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.00046656
Val acc before epoch 68: 0.9361702127659575
Warm optimizer lr: 0.00046656
Val acc before epoch 69: 0.9148936170212766
Warm optimizer lr: 0.000279936
Val acc before epoch 70: 0.9361702127659575
Push epoch at epoch 71.
Final validation accuracy before push: 93.61702127659575%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Train Cluster: 0.6544139623641968
	Train Separation: 0.5159820795059205
(Directly after push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.8085106382978723
Warm optimizer lr: 0.000279936
Val acc before epoch 72: 0.7978723404255319
Warm optimizer lr: 0.000279936
Val acc before epoch 73: 0.7553191489361702
Warm optimizer lr: 0.000279936
Val acc before epoch 74: 0.7340425531914894
Warm optimizer lr: 0.000279936
Val acc before epoch 75: 0.7340425531914894
Warm optimizer lr: 0.000279936
Val acc before epoch 76: 0.7553191489361702
Warm optimizer lr: 0.000279936
Val acc before epoch 77: 0.6808510638297872
Warm optimizer lr: 0.000279936
Val acc before epoch 78: 0.8297872340425532
Warm optimizer lr: 0.000279936
Val acc before epoch 79: 0.7978723404255319
Warm optimizer lr: 0.000279936
Val acc before epoch 80: 0.7872340425531915
Warm optimizer lr: 0.0001679616
Val acc before epoch 81: 0.7021276595744681
Warm optimizer lr: 0.0001679616
Val acc before epoch 82: 0.8404255319148937
Warm optimizer lr: 0.0001679616
Val acc before epoch 83: 0.8085106382978723
Warm optimizer lr: 0.0001679616
Val acc before epoch 84: 0.7446808510638298
Warm optimizer lr: 0.0001679616
Val acc before epoch 85: 0.7659574468085106
Warm optimizer lr: 0.0001679616
Val acc before epoch 86: 0.7127659574468085
Warm optimizer lr: 0.0001679616
Val acc before epoch 87: 0.723404255319149
Warm optimizer lr: 0.0001679616
Val acc before epoch 88: 0.7659574468085106
Warm optimizer lr: 0.0001679616
Val acc before epoch 89: 0.7446808510638298
Warm optimizer lr: 0.0001679616
Val acc before epoch 90: 0.7978723404255319
Warm optimizer lr: 0.00010077695999999998
Val acc before epoch 91: 0.8085106382978723
Warm optimizer lr: 0.00010077695999999998
Val acc before epoch 92: 0.7659574468085106
Warm optimizer lr: 0.00010077695999999998
Val acc before epoch 93: 0.7553191489361702
Warm optimizer lr: 0.00010077695999999998
Val acc before epoch 94: 0.7553191489361702
Warm optimizer lr: 0.00010077695999999998
Val acc before epoch 95: 0.8297872340425532
Warm optimizer lr: 0.00010077695999999998
Val acc before epoch 96: 0.7872340425531915
Warm optimizer lr: 0.00010077695999999998
Val acc before epoch 97: 0.7978723404255319
Warm optimizer lr: 0.00010077695999999998
Val acc before epoch 98: 0.7659574468085106
Warm optimizer lr: 0.00010077695999999998
Val acc before epoch 99: 0.7553191489361702
Warm optimizer lr: 0.00010077695999999998
Val acc before epoch 100: 0.7340425531914894
Warm optimizer lr: 6.046617599999999e-05
Val acc before epoch 101: 0.7659574468085106
Warm optimizer lr: 6.046617599999999e-05
Val acc before epoch 102: 0.7978723404255319
Warm optimizer lr: 6.046617599999999e-05
Val acc before epoch 103: 0.8404255319148937
Warm optimizer lr: 6.046617599999999e-05
Val acc before epoch 104: 0.7872340425531915
Stopping after epoch 105.
Final validation accuracy before push: 78.72340425531915%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8493589743589743
	Train Cluster: 0.6546307325363159
	TrainSeparation: 0.5089453101158142
(Directly after push) Val acc at iteration 0: 0.7978723404255319
Retraining last layer
Last layer lr: 0.001

Attempting combination 13/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.01
p0_warm_ptype_gamma: 0.7
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.01
Val acc before epoch 1: 0.0851063829787234
Warm optimizer lr: 0.01
Val acc before epoch 2: 0.11702127659574468
Warm optimizer lr: 0.01
Val acc before epoch 3: 0.20212765957446807
Warm optimizer lr: 0.01
Val acc before epoch 4: 0.3723404255319149
Warm optimizer lr: 0.01
Val acc before epoch 5: 0.48936170212765956
Warm optimizer lr: 0.01
Val acc before epoch 6: 0.5638297872340425
Warm optimizer lr: 0.01
Val acc before epoch 7: 0.6595744680851063
Warm optimizer lr: 0.01
Val acc before epoch 8: 0.648936170212766
Warm optimizer lr: 0.01
Val acc before epoch 9: 0.776595744680851
Warm optimizer lr: 0.006999999999999999
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.006999999999999999
Val acc before epoch 11: 0.8617021276595744
Warm optimizer lr: 0.006999999999999999
Val acc before epoch 12: 0.8297872340425532
Warm optimizer lr: 0.006999999999999999
Val acc before epoch 13: 0.8617021276595744
Warm optimizer lr: 0.006999999999999999
Val acc before epoch 14: 0.8297872340425532
Warm optimizer lr: 0.006999999999999999
Val acc before epoch 15: 0.8723404255319149
Warm optimizer lr: 0.006999999999999999
Val acc before epoch 16: 0.8404255319148937
Warm optimizer lr: 0.006999999999999999
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.006999999999999999
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.006999999999999999
Val acc before epoch 19: 0.8829787234042553
Warm optimizer lr: 0.004899999999999999
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.004899999999999999
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.004899999999999999
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.004899999999999999
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.004899999999999999
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.004899999999999999
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.004899999999999999
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.004899999999999999
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.004899999999999999
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.004899999999999999
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.003429999999999999
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.003429999999999999
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.003429999999999999
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.003429999999999999
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.003429999999999999
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.003429999999999999
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.003429999999999999
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.003429999999999999
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.003429999999999999
Val acc before epoch 38: 0.9042553191489362
Warm optimizer lr: 0.003429999999999999
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.002400999999999999
Val acc before epoch 40: 0.9042553191489362
Warm optimizer lr: 0.002400999999999999
Val acc before epoch 41: 0.925531914893617
Warm optimizer lr: 0.002400999999999999
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.002400999999999999
Val acc before epoch 43: 0.9148936170212766
Warm optimizer lr: 0.002400999999999999
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.002400999999999999
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.002400999999999999
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.002400999999999999
Val acc before epoch 47: 0.8936170212765957
Warm optimizer lr: 0.002400999999999999
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 0.002400999999999999
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.0016806999999999992
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.0016806999999999992
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 0.0016806999999999992
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.0016806999999999992
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.0016806999999999992
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.0016806999999999992
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.0016806999999999992
Val acc before epoch 56: 0.9148936170212766
Warm optimizer lr: 0.0016806999999999992
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.0016806999999999992
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.0016806999999999992
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.0011764899999999994
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.0011764899999999994
Val acc before epoch 61: 0.925531914893617
Warm optimizer lr: 0.0011764899999999994
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.0011764899999999994
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.0011764899999999994
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.0011764899999999994
Val acc before epoch 65: 0.9148936170212766
Warm optimizer lr: 0.0011764899999999994
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 0.0011764899999999994
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.0011764899999999994
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.0011764899999999994
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.0008235429999999996
Val acc before epoch 70: 0.9468085106382979
Push epoch at epoch 71.
Final validation accuracy before push: 94.68085106382979%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8317307692307693
	Train Cluster: 0.652960729598999
	Train Separation: 0.5111576199531556
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7340425531914894
Warm optimizer lr: 0.0008235429999999996
Val acc before epoch 72: 0.6808510638297872
Warm optimizer lr: 0.0008235429999999996
Val acc before epoch 73: 0.8085106382978723
Warm optimizer lr: 0.0008235429999999996
Val acc before epoch 74: 0.7021276595744681
Warm optimizer lr: 0.0008235429999999996
Val acc before epoch 75: 0.7340425531914894
Warm optimizer lr: 0.0008235429999999996
Val acc before epoch 76: 0.8297872340425532
Warm optimizer lr: 0.0008235429999999996
Val acc before epoch 77: 0.7872340425531915
Warm optimizer lr: 0.0008235429999999996
Val acc before epoch 78: 0.7872340425531915
Warm optimizer lr: 0.0008235429999999996
Val acc before epoch 79: 0.7872340425531915
Warm optimizer lr: 0.0008235429999999996
Val acc before epoch 80: 0.7872340425531915
Warm optimizer lr: 0.0005764800999999997
Val acc before epoch 81: 0.7978723404255319
Warm optimizer lr: 0.0005764800999999997
Val acc before epoch 82: 0.8085106382978723
Warm optimizer lr: 0.0005764800999999997
Val acc before epoch 83: 0.8191489361702128
Warm optimizer lr: 0.0005764800999999997
Val acc before epoch 84: 0.9042553191489362
Warm optimizer lr: 0.0005764800999999997
Val acc before epoch 85: 0.7553191489361702
Warm optimizer lr: 0.0005764800999999997
Val acc before epoch 86: 0.7978723404255319
Warm optimizer lr: 0.0005764800999999997
Val acc before epoch 87: 0.7446808510638298
Warm optimizer lr: 0.0005764800999999997
Val acc before epoch 88: 0.8723404255319149
Warm optimizer lr: 0.0005764800999999997
Val acc before epoch 89: 0.8191489361702128
Warm optimizer lr: 0.0005764800999999997
Val acc before epoch 90: 0.8404255319148937
Warm optimizer lr: 0.00040353606999999974
Val acc before epoch 91: 0.8191489361702128
Warm optimizer lr: 0.00040353606999999974
Val acc before epoch 92: 0.851063829787234
Warm optimizer lr: 0.00040353606999999974
Val acc before epoch 93: 0.8191489361702128
Warm optimizer lr: 0.00040353606999999974
Val acc before epoch 94: 0.8297872340425532
Warm optimizer lr: 0.00040353606999999974
Val acc before epoch 95: 0.7978723404255319
Warm optimizer lr: 0.00040353606999999974
Val acc before epoch 96: 0.9042553191489362
Warm optimizer lr: 0.00040353606999999974
Val acc before epoch 97: 0.8191489361702128
Warm optimizer lr: 0.00040353606999999974
Val acc before epoch 98: 0.8085106382978723
Warm optimizer lr: 0.00040353606999999974
Val acc before epoch 99: 0.8617021276595744
Warm optimizer lr: 0.00040353606999999974
Val acc before epoch 100: 0.8617021276595744
Warm optimizer lr: 0.0002824752489999998
Val acc before epoch 101: 0.8936170212765957
Warm optimizer lr: 0.0002824752489999998
Val acc before epoch 102: 0.8297872340425532
Warm optimizer lr: 0.0002824752489999998
Val acc before epoch 103: 0.8191489361702128
Warm optimizer lr: 0.0002824752489999998
Val acc before epoch 104: 0.8297872340425532
Stopping after epoch 105.
Final validation accuracy before push: 82.97872340425532%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8397435897435898
	Train Cluster: 0.6481986522674561
	TrainSeparation: 0.5080309510231018
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer
Last layer lr: 0.001

Attempting combination 14/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.01
p0_warm_ptype_gamma: 0.8
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.01
Val acc before epoch 1: 0.010638297872340425
Warm optimizer lr: 0.01
Val acc before epoch 2: 0.0851063829787234
Warm optimizer lr: 0.01
Val acc before epoch 3: 0.26595744680851063
Warm optimizer lr: 0.01
Val acc before epoch 4: 0.39361702127659576
Warm optimizer lr: 0.01
Val acc before epoch 5: 0.4787234042553192
Warm optimizer lr: 0.01
Val acc before epoch 6: 0.6702127659574468
Warm optimizer lr: 0.01
Val acc before epoch 7: 0.7127659574468085
Warm optimizer lr: 0.01
Val acc before epoch 8: 0.776595744680851
Warm optimizer lr: 0.01
Val acc before epoch 9: 0.8297872340425532
Warm optimizer lr: 0.008
Val acc before epoch 10: 0.8191489361702128
Warm optimizer lr: 0.008
Val acc before epoch 11: 0.7978723404255319
Warm optimizer lr: 0.008
Val acc before epoch 12: 0.851063829787234
Warm optimizer lr: 0.008
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.008
Val acc before epoch 14: 0.8617021276595744
Warm optimizer lr: 0.008
Val acc before epoch 15: 0.8617021276595744
Warm optimizer lr: 0.008
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.008
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.008
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.008
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.0064
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.0064
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.0064
Val acc before epoch 22: 0.8829787234042553
Warm optimizer lr: 0.0064
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.0064
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.0064
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.0064
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.0064
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.0064
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.0064
Val acc before epoch 29: 0.8936170212765957
Warm optimizer lr: 0.00512
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.00512
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.00512
Val acc before epoch 32: 0.9787234042553191
Warm optimizer lr: 0.00512
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.00512
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.00512
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.00512
Val acc before epoch 36: 0.9148936170212766
Warm optimizer lr: 0.00512
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.00512
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.00512
Val acc before epoch 39: 0.9574468085106383
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 47: 0.9787234042553191
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 48: 0.9148936170212766
Warm optimizer lr: 0.004096000000000001
Val acc before epoch 49: 0.9787234042553191
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 51: 0.9680851063829787
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 54: 0.9787234042553191
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 56: 0.925531914893617
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 58: 0.9680851063829787
Warm optimizer lr: 0.0032768000000000007
Val acc before epoch 59: 0.9680851063829787
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 62: 0.9574468085106383
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 64: 0.9680851063829787
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 65: 0.9787234042553191
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 67: 0.9680851063829787
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 68: 0.9680851063829787
Warm optimizer lr: 0.002621440000000001
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 70: 0.925531914893617
Push epoch at epoch 71.
Final validation accuracy before push: 92.5531914893617%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8637820512820513
	Train Cluster: 0.6555394411087037
	Train Separation: 0.5060175955295563
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.776595744680851
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 72: 0.7446808510638298
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 73: 0.7978723404255319
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 74: 0.7978723404255319
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 75: 0.8829787234042553
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 76: 0.7553191489361702
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 77: 0.8085106382978723
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 78: 0.8191489361702128
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 79: 0.8723404255319149
Warm optimizer lr: 0.002097152000000001
Val acc before epoch 80: 0.8297872340425532
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 81: 0.9042553191489362
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 82: 0.8617021276595744
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 83: 0.851063829787234
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 84: 0.8829787234042553
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 85: 0.9042553191489362
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 86: 0.8617021276595744
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 87: 0.8936170212765957
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 88: 0.8829787234042553
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 0.001677721600000001
Val acc before epoch 90: 0.8723404255319149
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 91: 0.8723404255319149
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 92: 0.9148936170212766
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 93: 0.8829787234042553
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 94: 0.8723404255319149
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 95: 0.8723404255319149
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 96: 0.8936170212765957
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 97: 0.9148936170212766
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 98: 0.8723404255319149
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 99: 0.8617021276595744
Warm optimizer lr: 0.0013421772800000008
Val acc before epoch 100: 0.9148936170212766
Warm optimizer lr: 0.0010737418240000006
Val acc before epoch 101: 0.9148936170212766
Warm optimizer lr: 0.0010737418240000006
Val acc before epoch 102: 0.8191489361702128
Warm optimizer lr: 0.0010737418240000006
Val acc before epoch 103: 0.9042553191489362
Warm optimizer lr: 0.0010737418240000006
Val acc before epoch 104: 0.8617021276595744
Stopping after epoch 105.
Final validation accuracy before push: 86.17021276595744%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8461538461538461
	Train Cluster: 0.6507725596427918
	TrainSeparation: 0.5081471562385559
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.001

Attempting combination 15/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.01
p0_warm_ptype_gamma: 0.9
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.01
Val acc before epoch 1: 0.0425531914893617
Warm optimizer lr: 0.01
Val acc before epoch 2: 0.1276595744680851
Warm optimizer lr: 0.01
Val acc before epoch 3: 0.23404255319148937
Warm optimizer lr: 0.01
Val acc before epoch 4: 0.3723404255319149
Warm optimizer lr: 0.01
Val acc before epoch 5: 0.5106382978723404
Warm optimizer lr: 0.01
Val acc before epoch 6: 0.6595744680851063
Warm optimizer lr: 0.01
Val acc before epoch 7: 0.7659574468085106
Warm optimizer lr: 0.01
Val acc before epoch 8: 0.7872340425531915
Warm optimizer lr: 0.01
Val acc before epoch 9: 0.776595744680851
Warm optimizer lr: 0.009000000000000001
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.009000000000000001
Val acc before epoch 11: 0.8617021276595744
Warm optimizer lr: 0.009000000000000001
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.009000000000000001
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.009000000000000001
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.009000000000000001
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.009000000000000001
Val acc before epoch 16: 0.8936170212765957
Warm optimizer lr: 0.009000000000000001
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.009000000000000001
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.009000000000000001
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.008100000000000001
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.008100000000000001
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.008100000000000001
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.008100000000000001
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.008100000000000001
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.008100000000000001
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.008100000000000001
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.008100000000000001
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.008100000000000001
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.008100000000000001
Val acc before epoch 29: 0.9680851063829787
Warm optimizer lr: 0.007290000000000001
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.007290000000000001
Val acc before epoch 31: 0.9680851063829787
Warm optimizer lr: 0.007290000000000001
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.007290000000000001
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.007290000000000001
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.007290000000000001
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.007290000000000001
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.007290000000000001
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.007290000000000001
Val acc before epoch 38: 0.9787234042553191
Warm optimizer lr: 0.007290000000000001
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.006561000000000002
Val acc before epoch 40: 0.9148936170212766
Warm optimizer lr: 0.006561000000000002
Val acc before epoch 41: 0.9680851063829787
Warm optimizer lr: 0.006561000000000002
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.006561000000000002
Val acc before epoch 43: 0.9680851063829787
Warm optimizer lr: 0.006561000000000002
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.006561000000000002
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.006561000000000002
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.006561000000000002
Val acc before epoch 47: 0.9680851063829787
Warm optimizer lr: 0.006561000000000002
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.006561000000000002
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.005904900000000002
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.005904900000000002
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 0.005904900000000002
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.005904900000000002
Val acc before epoch 53: 0.9148936170212766
Warm optimizer lr: 0.005904900000000002
Val acc before epoch 54: 0.9680851063829787
Warm optimizer lr: 0.005904900000000002
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.005904900000000002
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.005904900000000002
Val acc before epoch 57: 0.9680851063829787
Warm optimizer lr: 0.005904900000000002
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.005904900000000002
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.005314410000000002
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.005314410000000002
Val acc before epoch 61: 0.925531914893617
Warm optimizer lr: 0.005314410000000002
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.005314410000000002
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.005314410000000002
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.005314410000000002
Val acc before epoch 65: 0.9787234042553191
Warm optimizer lr: 0.005314410000000002
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.005314410000000002
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.005314410000000002
Val acc before epoch 68: 0.9148936170212766
Warm optimizer lr: 0.005314410000000002
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.004782969000000002
Val acc before epoch 70: 0.9574468085106383
Push epoch at epoch 71.
Final validation accuracy before push: 95.74468085106383%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.64076908826828
	Train Separation: 0.5041412711143494
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.6914893617021277
Warm optimizer lr: 0.004782969000000002
Val acc before epoch 72: 0.723404255319149
Warm optimizer lr: 0.004782969000000002
Val acc before epoch 73: 0.7872340425531915
Warm optimizer lr: 0.004782969000000002
Val acc before epoch 74: 0.8617021276595744
Warm optimizer lr: 0.004782969000000002
Val acc before epoch 75: 0.8617021276595744
Warm optimizer lr: 0.004782969000000002
Val acc before epoch 76: 0.8617021276595744
Warm optimizer lr: 0.004782969000000002
Val acc before epoch 77: 0.8829787234042553
Warm optimizer lr: 0.004782969000000002
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 0.004782969000000002
Val acc before epoch 79: 0.9468085106382979
Warm optimizer lr: 0.004782969000000002
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.004304672100000002
Val acc before epoch 81: 0.8936170212765957
Warm optimizer lr: 0.004304672100000002
Val acc before epoch 82: 0.8936170212765957
Warm optimizer lr: 0.004304672100000002
Val acc before epoch 83: 0.9148936170212766
Warm optimizer lr: 0.004304672100000002
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 0.004304672100000002
Val acc before epoch 85: 0.9361702127659575
Warm optimizer lr: 0.004304672100000002
Val acc before epoch 86: 0.9361702127659575
Warm optimizer lr: 0.004304672100000002
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.004304672100000002
Val acc before epoch 88: 0.9148936170212766
Warm optimizer lr: 0.004304672100000002
Val acc before epoch 89: 0.9468085106382979
Warm optimizer lr: 0.004304672100000002
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.003874204890000002
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.003874204890000002
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 0.003874204890000002
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 0.003874204890000002
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 0.003874204890000002
Val acc before epoch 95: 0.9361702127659575
Warm optimizer lr: 0.003874204890000002
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.003874204890000002
Val acc before epoch 97: 0.9468085106382979
Warm optimizer lr: 0.003874204890000002
Val acc before epoch 98: 1.0
Warm optimizer lr: 0.003874204890000002
Val acc before epoch 99: 0.9361702127659575
Warm optimizer lr: 0.003874204890000002
Val acc before epoch 100: 0.9574468085106383
Warm optimizer lr: 0.003486784401000002
Val acc before epoch 101: 0.925531914893617
Warm optimizer lr: 0.003486784401000002
Val acc before epoch 102: 0.9574468085106383
Warm optimizer lr: 0.003486784401000002
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.003486784401000002
Val acc before epoch 104: 0.9361702127659575
Stopping after epoch 105.
Final validation accuracy before push: 93.61702127659575%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8541666666666666
	Train Cluster: 0.6582033634185791
	TrainSeparation: 0.5170138835906982
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.001

Attempting combination 16/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.025
p0_warm_ptype_gamma: 0.5
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.025
Val acc before epoch 1: 0.18085106382978725
Warm optimizer lr: 0.025
Val acc before epoch 2: 0.46808510638297873
Warm optimizer lr: 0.025
Val acc before epoch 3: 0.6382978723404256
Warm optimizer lr: 0.025
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 7: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.0125
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.0125
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.0125
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.0125
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.0125
Val acc before epoch 14: 0.9680851063829787
Warm optimizer lr: 0.0125
Val acc before epoch 15: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 18: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.00625
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 25: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.00625
Val acc before epoch 28: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 32: 0.9787234042553191
Warm optimizer lr: 0.003125
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.003125
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.0015625
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.0015625
Val acc before epoch 41: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.0015625
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 44: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.0015625
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.0015625
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 0.00078125
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 53: 0.9787234042553191
Warm optimizer lr: 0.00078125
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.000390625
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.000390625
Val acc before epoch 61: 0.9680851063829787
Warm optimizer lr: 0.000390625
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.000390625
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.000390625
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.000390625
Val acc before epoch 66: 0.9148936170212766
Warm optimizer lr: 0.000390625
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.000390625
Val acc before epoch 68: 0.9361702127659575
Warm optimizer lr: 0.000390625
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.0001953125
Val acc before epoch 70: 0.9574468085106383
Push epoch at epoch 71.
Final validation accuracy before push: 95.74468085106383%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8076923076923077
	Train Cluster: 0.6449660778045654
	Train Separation: 0.5113095879554749
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.723404255319149
Warm optimizer lr: 0.0001953125
Val acc before epoch 72: 0.7553191489361702
Warm optimizer lr: 0.0001953125
Val acc before epoch 73: 0.6914893617021277
Warm optimizer lr: 0.0001953125
Val acc before epoch 74: 0.7553191489361702
Warm optimizer lr: 0.0001953125
Val acc before epoch 75: 0.6595744680851063
Warm optimizer lr: 0.0001953125
Val acc before epoch 76: 0.7872340425531915
Warm optimizer lr: 0.0001953125
Val acc before epoch 77: 0.7553191489361702
Warm optimizer lr: 0.0001953125
Val acc before epoch 78: 0.7872340425531915
Warm optimizer lr: 0.0001953125
Val acc before epoch 79: 0.7872340425531915
Warm optimizer lr: 0.0001953125
Val acc before epoch 80: 0.8723404255319149
Warm optimizer lr: 9.765625e-05
Val acc before epoch 81: 0.8297872340425532
Warm optimizer lr: 9.765625e-05
Val acc before epoch 82: 0.7659574468085106
Warm optimizer lr: 9.765625e-05
Val acc before epoch 83: 0.776595744680851
Warm optimizer lr: 9.765625e-05
Val acc before epoch 84: 0.7872340425531915
Warm optimizer lr: 9.765625e-05
Val acc before epoch 85: 0.7872340425531915
Warm optimizer lr: 9.765625e-05
Val acc before epoch 86: 0.776595744680851
Warm optimizer lr: 9.765625e-05
Val acc before epoch 87: 0.7659574468085106
Warm optimizer lr: 9.765625e-05
Val acc before epoch 88: 0.8085106382978723
Warm optimizer lr: 9.765625e-05
Val acc before epoch 89: 0.7872340425531915
Warm optimizer lr: 9.765625e-05
Val acc before epoch 90: 0.7872340425531915
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 91: 0.7659574468085106
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 92: 0.723404255319149
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 93: 0.7978723404255319
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 94: 0.8191489361702128
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 95: 0.7340425531914894
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 96: 0.7553191489361702
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 97: 0.7340425531914894
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 98: 0.7446808510638298
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 99: 0.7446808510638298
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 100: 0.7446808510638298
Warm optimizer lr: 2.44140625e-05
Val acc before epoch 101: 0.7553191489361702
Warm optimizer lr: 2.44140625e-05
Val acc before epoch 102: 0.7340425531914894
Warm optimizer lr: 2.44140625e-05
Val acc before epoch 103: 0.776595744680851
Warm optimizer lr: 2.44140625e-05
Val acc before epoch 104: 0.7553191489361702
Stopping after epoch 105.
Final validation accuracy before push: 75.53191489361703%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8349358974358975
	Train Cluster: 0.6572126388549805
	TrainSeparation: 0.5125883936882019
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.001

Attempting combination 17/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.025
p0_warm_ptype_gamma: 0.6
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 1: 0.1276595744680851
Warm optimizer lr: 0.025
Val acc before epoch 2: 0.44680851063829785
Warm optimizer lr: 0.025
Val acc before epoch 3: 0.6276595744680851
Warm optimizer lr: 0.025
Val acc before epoch 4: 0.7553191489361702
Warm optimizer lr: 0.025
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.015
Val acc before epoch 10: 0.9574468085106383
Warm optimizer lr: 0.015
Val acc before epoch 11: 0.9468085106382979
Warm optimizer lr: 0.015
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.015
Val acc before epoch 13: 0.9787234042553191
Warm optimizer lr: 0.015
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.015
Val acc before epoch 15: 0.9468085106382979
Warm optimizer lr: 0.015
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.015
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.015
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.015
Val acc before epoch 19: 0.9574468085106383
Warm optimizer lr: 0.009
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.009
Val acc before epoch 21: 0.9680851063829787
Warm optimizer lr: 0.009
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.009
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.009
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.009
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.009
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.009
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.009
Val acc before epoch 28: 0.9680851063829787
Warm optimizer lr: 0.009
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.005399999999999999
Val acc before epoch 30: 0.9893617021276596
Warm optimizer lr: 0.005399999999999999
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.005399999999999999
Val acc before epoch 32: 0.9574468085106383
Warm optimizer lr: 0.005399999999999999
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.005399999999999999
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.005399999999999999
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.005399999999999999
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.005399999999999999
Val acc before epoch 37: 0.9680851063829787
Warm optimizer lr: 0.005399999999999999
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.005399999999999999
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.0032399999999999994
Val acc before epoch 40: 0.9680851063829787
Warm optimizer lr: 0.0032399999999999994
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.0032399999999999994
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.0032399999999999994
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.0032399999999999994
Val acc before epoch 44: 0.9574468085106383
Warm optimizer lr: 0.0032399999999999994
Val acc before epoch 45: 0.9680851063829787
Warm optimizer lr: 0.0032399999999999994
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.0032399999999999994
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.0032399999999999994
Val acc before epoch 48: 0.9574468085106383
Warm optimizer lr: 0.0032399999999999994
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.0019439999999999995
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.0019439999999999995
Val acc before epoch 51: 0.9787234042553191
Warm optimizer lr: 0.0019439999999999995
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.0019439999999999995
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.0019439999999999995
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.0019439999999999995
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.0019439999999999995
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.0019439999999999995
Val acc before epoch 57: 0.9787234042553191
Warm optimizer lr: 0.0019439999999999995
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.0019439999999999995
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.0011663999999999997
Val acc before epoch 60: 0.9787234042553191
Warm optimizer lr: 0.0011663999999999997
Val acc before epoch 61: 0.9680851063829787
Warm optimizer lr: 0.0011663999999999997
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.0011663999999999997
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.0011663999999999997
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.0011663999999999997
Val acc before epoch 65: 0.9680851063829787
Warm optimizer lr: 0.0011663999999999997
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.0011663999999999997
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.0011663999999999997
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.0011663999999999997
Val acc before epoch 69: 0.9468085106382979
Warm optimizer lr: 0.0006998399999999999
Val acc before epoch 70: 0.9468085106382979
Push epoch at epoch 71.
Final validation accuracy before push: 94.68085106382979%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8381410256410257
	Train Cluster: 0.6512206315994262
	Train Separation: 0.5111093163490296
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7978723404255319
Warm optimizer lr: 0.0006998399999999999
Val acc before epoch 72: 0.7127659574468085
Warm optimizer lr: 0.0006998399999999999
Val acc before epoch 73: 0.723404255319149
Warm optimizer lr: 0.0006998399999999999
Val acc before epoch 74: 0.7659574468085106
Warm optimizer lr: 0.0006998399999999999
Val acc before epoch 75: 0.7978723404255319
Warm optimizer lr: 0.0006998399999999999
Val acc before epoch 76: 0.7659574468085106
Warm optimizer lr: 0.0006998399999999999
Val acc before epoch 77: 0.7872340425531915
Warm optimizer lr: 0.0006998399999999999
Val acc before epoch 78: 0.8085106382978723
Warm optimizer lr: 0.0006998399999999999
Val acc before epoch 79: 0.8297872340425532
Warm optimizer lr: 0.0006998399999999999
Val acc before epoch 80: 0.7872340425531915
Warm optimizer lr: 0.0004199039999999999
Val acc before epoch 81: 0.776595744680851
Warm optimizer lr: 0.0004199039999999999
Val acc before epoch 82: 0.7978723404255319
Warm optimizer lr: 0.0004199039999999999
Val acc before epoch 83: 0.7446808510638298
Warm optimizer lr: 0.0004199039999999999
Val acc before epoch 84: 0.8085106382978723
Warm optimizer lr: 0.0004199039999999999
Val acc before epoch 85: 0.8297872340425532
Warm optimizer lr: 0.0004199039999999999
Val acc before epoch 86: 0.776595744680851
Warm optimizer lr: 0.0004199039999999999
Val acc before epoch 87: 0.8297872340425532
Warm optimizer lr: 0.0004199039999999999
Val acc before epoch 88: 0.7659574468085106
Warm optimizer lr: 0.0004199039999999999
Val acc before epoch 89: 0.8404255319148937
Warm optimizer lr: 0.0004199039999999999
Val acc before epoch 90: 0.8617021276595744
Warm optimizer lr: 0.00025194239999999993
Val acc before epoch 91: 0.8085106382978723
Warm optimizer lr: 0.00025194239999999993
Val acc before epoch 92: 0.8191489361702128
Warm optimizer lr: 0.00025194239999999993
Val acc before epoch 93: 0.851063829787234
Warm optimizer lr: 0.00025194239999999993
Val acc before epoch 94: 0.851063829787234
Warm optimizer lr: 0.00025194239999999993
Val acc before epoch 95: 0.8297872340425532
Warm optimizer lr: 0.00025194239999999993
Val acc before epoch 96: 0.8829787234042553
Warm optimizer lr: 0.00025194239999999993
Val acc before epoch 97: 0.8723404255319149
Warm optimizer lr: 0.00025194239999999993
Val acc before epoch 98: 0.8191489361702128
Warm optimizer lr: 0.00025194239999999993
Val acc before epoch 99: 0.851063829787234
Warm optimizer lr: 0.00025194239999999993
Val acc before epoch 100: 0.8404255319148937
Warm optimizer lr: 0.00015116543999999996
Val acc before epoch 101: 0.8617021276595744
Warm optimizer lr: 0.00015116543999999996
Val acc before epoch 102: 0.8191489361702128
Warm optimizer lr: 0.00015116543999999996
Val acc before epoch 103: 0.8297872340425532
Warm optimizer lr: 0.00015116543999999996
Val acc before epoch 104: 0.8404255319148937
Stopping after epoch 105.
Final validation accuracy before push: 84.04255319148936%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8365384615384616
	Train Cluster: 0.6552896142005921
	TrainSeparation: 0.5118830442428589
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.001

Attempting combination 18/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.025
p0_warm_ptype_gamma: 0.7
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.025
Val acc before epoch 1: 0.1595744680851064
Warm optimizer lr: 0.025
Val acc before epoch 2: 0.40425531914893614
Warm optimizer lr: 0.025
Val acc before epoch 3: 0.6063829787234043
Warm optimizer lr: 0.025
Val acc before epoch 4: 0.6914893617021277
Warm optimizer lr: 0.025
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.025
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 7: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.017499999999999998
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.017499999999999998
Val acc before epoch 11: 0.851063829787234
Warm optimizer lr: 0.017499999999999998
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.017499999999999998
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.017499999999999998
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.017499999999999998
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.017499999999999998
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.017499999999999998
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.017499999999999998
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.017499999999999998
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.012249999999999999
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.012249999999999999
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.012249999999999999
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.012249999999999999
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.012249999999999999
Val acc before epoch 24: 0.9574468085106383
Warm optimizer lr: 0.012249999999999999
Val acc before epoch 25: 0.9574468085106383
Warm optimizer lr: 0.012249999999999999
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.012249999999999999
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.012249999999999999
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.012249999999999999
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.008575
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.008575
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.008575
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.008575
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.008575
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.008575
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.008575
Val acc before epoch 36: 0.9787234042553191
Warm optimizer lr: 0.008575
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.008575
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.008575
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.006002499999999999
Val acc before epoch 40: 0.9574468085106383
Warm optimizer lr: 0.006002499999999999
Val acc before epoch 41: 0.9574468085106383
Warm optimizer lr: 0.006002499999999999
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.006002499999999999
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.006002499999999999
Val acc before epoch 44: 0.9042553191489362
Warm optimizer lr: 0.006002499999999999
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.006002499999999999
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.006002499999999999
Val acc before epoch 47: 0.9574468085106383
Warm optimizer lr: 0.006002499999999999
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.006002499999999999
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.004201749999999999
Val acc before epoch 50: 0.9680851063829787
Warm optimizer lr: 0.004201749999999999
Val acc before epoch 51: 0.9680851063829787
Warm optimizer lr: 0.004201749999999999
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.004201749999999999
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.004201749999999999
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.004201749999999999
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.004201749999999999
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.004201749999999999
Val acc before epoch 57: 0.9787234042553191
Warm optimizer lr: 0.004201749999999999
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.004201749999999999
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.002941224999999999
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.002941224999999999
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.002941224999999999
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.002941224999999999
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.002941224999999999
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.002941224999999999
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.002941224999999999
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.002941224999999999
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.002941224999999999
Val acc before epoch 68: 0.9361702127659575
Warm optimizer lr: 0.002941224999999999
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.002058857499999999
Val acc before epoch 70: 0.9787234042553191
Push epoch at epoch 71.
Final validation accuracy before push: 97.87234042553192%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8381410256410257
	Train Cluster: 0.6542988538742065
	Train Separation: 0.5124225854873657
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.6595744680851063
Warm optimizer lr: 0.002058857499999999
Val acc before epoch 72: 0.7340425531914894
Warm optimizer lr: 0.002058857499999999
Val acc before epoch 73: 0.6914893617021277
Warm optimizer lr: 0.002058857499999999
Val acc before epoch 74: 0.7659574468085106
Warm optimizer lr: 0.002058857499999999
Val acc before epoch 75: 0.8404255319148937
Warm optimizer lr: 0.002058857499999999
Val acc before epoch 76: 0.7340425531914894
Warm optimizer lr: 0.002058857499999999
Val acc before epoch 77: 0.8085106382978723
Warm optimizer lr: 0.002058857499999999
Val acc before epoch 78: 0.8297872340425532
Warm optimizer lr: 0.002058857499999999
Val acc before epoch 79: 0.8617021276595744
Warm optimizer lr: 0.002058857499999999
Val acc before epoch 80: 0.8617021276595744
Warm optimizer lr: 0.0014412002499999993
Val acc before epoch 81: 0.851063829787234
Warm optimizer lr: 0.0014412002499999993
Val acc before epoch 82: 0.8085106382978723
Warm optimizer lr: 0.0014412002499999993
Val acc before epoch 83: 0.8191489361702128
Warm optimizer lr: 0.0014412002499999993
Val acc before epoch 84: 0.8191489361702128
Warm optimizer lr: 0.0014412002499999993
Val acc before epoch 85: 0.8191489361702128
Warm optimizer lr: 0.0014412002499999993
Val acc before epoch 86: 0.851063829787234
Warm optimizer lr: 0.0014412002499999993
Val acc before epoch 87: 0.8404255319148937
Warm optimizer lr: 0.0014412002499999993
Val acc before epoch 88: 0.8297872340425532
Warm optimizer lr: 0.0014412002499999993
Val acc before epoch 89: 0.851063829787234
Warm optimizer lr: 0.0014412002499999993
Val acc before epoch 90: 0.8404255319148937
Warm optimizer lr: 0.0010088401749999995
Val acc before epoch 91: 0.8297872340425532
Warm optimizer lr: 0.0010088401749999995
Val acc before epoch 92: 0.8829787234042553
Warm optimizer lr: 0.0010088401749999995
Val acc before epoch 93: 0.7978723404255319
Warm optimizer lr: 0.0010088401749999995
Val acc before epoch 94: 0.8404255319148937
Warm optimizer lr: 0.0010088401749999995
Val acc before epoch 95: 0.8404255319148937
Warm optimizer lr: 0.0010088401749999995
Val acc before epoch 96: 0.851063829787234
Warm optimizer lr: 0.0010088401749999995
Val acc before epoch 97: 0.8297872340425532
Warm optimizer lr: 0.0010088401749999995
Val acc before epoch 98: 0.851063829787234
Warm optimizer lr: 0.0010088401749999995
Val acc before epoch 99: 0.8297872340425532
Warm optimizer lr: 0.0010088401749999995
Val acc before epoch 100: 0.8723404255319149
Warm optimizer lr: 0.0007061881224999996
Val acc before epoch 101: 0.8829787234042553
Warm optimizer lr: 0.0007061881224999996
Val acc before epoch 102: 0.9148936170212766
Warm optimizer lr: 0.0007061881224999996
Val acc before epoch 103: 0.8617021276595744
Warm optimizer lr: 0.0007061881224999996
Val acc before epoch 104: 0.8617021276595744
Stopping after epoch 105.
Final validation accuracy before push: 86.17021276595744%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.646273386478424
	TrainSeparation: 0.5088409066200257
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.001

Attempting combination 19/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.025
p0_warm_ptype_gamma: 0.8
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.025
Val acc before epoch 1: 0.18085106382978725
Warm optimizer lr: 0.025
Val acc before epoch 2: 0.43617021276595747
Warm optimizer lr: 0.025
Val acc before epoch 3: 0.7021276595744681
Warm optimizer lr: 0.025
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.025
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.025
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 10: 0.8936170212765957
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 16: 0.9361702127659575
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.020000000000000004
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.016000000000000004
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.016000000000000004
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.016000000000000004
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.016000000000000004
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.016000000000000004
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.016000000000000004
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.016000000000000004
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.016000000000000004
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.016000000000000004
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.016000000000000004
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 33: 0.9680851063829787
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 34: 0.9787234042553191
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 36: 0.9042553191489362
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.012800000000000004
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.010240000000000004
Val acc before epoch 40: 0.9680851063829787
Warm optimizer lr: 0.010240000000000004
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.010240000000000004
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.010240000000000004
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.010240000000000004
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.010240000000000004
Val acc before epoch 45: 0.9787234042553191
Warm optimizer lr: 0.010240000000000004
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.010240000000000004
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.010240000000000004
Val acc before epoch 48: 0.9680851063829787
Warm optimizer lr: 0.010240000000000004
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.008192000000000003
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.008192000000000003
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.008192000000000003
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.008192000000000003
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.008192000000000003
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.008192000000000003
Val acc before epoch 55: 0.9680851063829787
Warm optimizer lr: 0.008192000000000003
Val acc before epoch 56: 0.9042553191489362
Warm optimizer lr: 0.008192000000000003
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.008192000000000003
Val acc before epoch 58: 0.9680851063829787
Warm optimizer lr: 0.008192000000000003
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.006553600000000003
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.006553600000000003
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.006553600000000003
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.006553600000000003
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.006553600000000003
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.006553600000000003
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.006553600000000003
Val acc before epoch 66: 0.9680851063829787
Warm optimizer lr: 0.006553600000000003
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.006553600000000003
Val acc before epoch 68: 0.9361702127659575
Warm optimizer lr: 0.006553600000000003
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.005242880000000003
Val acc before epoch 70: 0.9361702127659575
Push epoch at epoch 71.
Final validation accuracy before push: 93.61702127659575%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8509615384615384
	Train Cluster: 0.647865092754364
	Train Separation: 0.5074366927146912
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7021276595744681
Warm optimizer lr: 0.005242880000000003
Val acc before epoch 72: 0.7872340425531915
Warm optimizer lr: 0.005242880000000003
Val acc before epoch 73: 0.776595744680851
Warm optimizer lr: 0.005242880000000003
Val acc before epoch 74: 0.851063829787234
Warm optimizer lr: 0.005242880000000003
Val acc before epoch 75: 0.8936170212765957
Warm optimizer lr: 0.005242880000000003
Val acc before epoch 76: 0.8829787234042553
Warm optimizer lr: 0.005242880000000003
Val acc before epoch 77: 0.8936170212765957
Warm optimizer lr: 0.005242880000000003
Val acc before epoch 78: 0.8936170212765957
Warm optimizer lr: 0.005242880000000003
Val acc before epoch 79: 0.8723404255319149
Warm optimizer lr: 0.005242880000000003
Val acc before epoch 80: 0.925531914893617
Warm optimizer lr: 0.004194304000000002
Val acc before epoch 81: 0.9574468085106383
Warm optimizer lr: 0.004194304000000002
Val acc before epoch 82: 0.9042553191489362
Warm optimizer lr: 0.004194304000000002
Val acc before epoch 83: 0.9042553191489362
Warm optimizer lr: 0.004194304000000002
Val acc before epoch 84: 0.9042553191489362
Warm optimizer lr: 0.004194304000000002
Val acc before epoch 85: 0.9148936170212766
Warm optimizer lr: 0.004194304000000002
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.004194304000000002
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.004194304000000002
Val acc before epoch 88: 0.925531914893617
Warm optimizer lr: 0.004194304000000002
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 0.004194304000000002
Val acc before epoch 90: 0.9574468085106383
Warm optimizer lr: 0.003355443200000002
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.003355443200000002
Val acc before epoch 92: 0.9680851063829787
Warm optimizer lr: 0.003355443200000002
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 0.003355443200000002
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 0.003355443200000002
Val acc before epoch 95: 0.9574468085106383
Warm optimizer lr: 0.003355443200000002
Val acc before epoch 96: 0.9680851063829787
Warm optimizer lr: 0.003355443200000002
Val acc before epoch 97: 0.925531914893617
Warm optimizer lr: 0.003355443200000002
Val acc before epoch 98: 0.9680851063829787
Warm optimizer lr: 0.003355443200000002
Val acc before epoch 99: 0.925531914893617
Warm optimizer lr: 0.003355443200000002
Val acc before epoch 100: 0.9574468085106383
Warm optimizer lr: 0.0026843545600000016
Val acc before epoch 101: 0.9680851063829787
Warm optimizer lr: 0.0026843545600000016
Val acc before epoch 102: 0.925531914893617
Warm optimizer lr: 0.0026843545600000016
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.0026843545600000016
Val acc before epoch 104: 0.9574468085106383
Stopping after epoch 105.
Final validation accuracy before push: 95.74468085106383%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8413461538461539
	Train Cluster: 0.6472947835922241
	TrainSeparation: 0.5089183032512665
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.001

Attempting combination 20/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.025
p0_warm_ptype_gamma: 0.9
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.025
Val acc before epoch 1: 0.09574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 2: 0.43617021276595747
Warm optimizer lr: 0.025
Val acc before epoch 3: 0.6808510638297872
Warm optimizer lr: 0.025
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.025
Val acc before epoch 5: 0.8297872340425532
Warm optimizer lr: 0.025
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.025
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.025
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.025
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.022500000000000003
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.022500000000000003
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.022500000000000003
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.022500000000000003
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.022500000000000003
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.022500000000000003
Val acc before epoch 15: 0.9468085106382979
Warm optimizer lr: 0.022500000000000003
Val acc before epoch 16: 0.9574468085106383
Warm optimizer lr: 0.022500000000000003
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.022500000000000003
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.022500000000000003
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.020250000000000004
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.020250000000000004
Val acc before epoch 21: 0.9680851063829787
Warm optimizer lr: 0.020250000000000004
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.020250000000000004
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.020250000000000004
Val acc before epoch 24: 0.9680851063829787
Warm optimizer lr: 0.020250000000000004
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.020250000000000004
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.020250000000000004
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.020250000000000004
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.020250000000000004
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.018225000000000005
Val acc before epoch 30: 0.9680851063829787
Warm optimizer lr: 0.018225000000000005
Val acc before epoch 31: 0.9787234042553191
Warm optimizer lr: 0.018225000000000005
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.018225000000000005
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.018225000000000005
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.018225000000000005
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.018225000000000005
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.018225000000000005
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.018225000000000005
Val acc before epoch 38: 0.9361702127659575
Warm optimizer lr: 0.018225000000000005
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.016402500000000004
Val acc before epoch 40: 0.9574468085106383
Warm optimizer lr: 0.016402500000000004
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.016402500000000004
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.016402500000000004
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.016402500000000004
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.016402500000000004
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.016402500000000004
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.016402500000000004
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.016402500000000004
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 0.016402500000000004
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.014762250000000005
Val acc before epoch 50: 0.9148936170212766
Warm optimizer lr: 0.014762250000000005
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.014762250000000005
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.014762250000000005
Val acc before epoch 53: 0.9148936170212766
Warm optimizer lr: 0.014762250000000005
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.014762250000000005
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.014762250000000005
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.014762250000000005
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.014762250000000005
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.014762250000000005
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.013286025000000005
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.013286025000000005
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.013286025000000005
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 0.013286025000000005
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.013286025000000005
Val acc before epoch 64: 0.9148936170212766
Warm optimizer lr: 0.013286025000000005
Val acc before epoch 65: 0.9680851063829787
Warm optimizer lr: 0.013286025000000005
Val acc before epoch 66: 0.9148936170212766
Warm optimizer lr: 0.013286025000000005
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.013286025000000005
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.013286025000000005
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.011957422500000005
Val acc before epoch 70: 0.9574468085106383
Push epoch at epoch 71.
Final validation accuracy before push: 95.74468085106383%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8541666666666666
	Train Cluster: 0.6601481080055237
	Train Separation: 0.5154549479484558
(Directly after push) Val acc at iteration 0: 0.6595744680851063
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7340425531914894
Warm optimizer lr: 0.011957422500000005
Val acc before epoch 72: 0.8617021276595744
Warm optimizer lr: 0.011957422500000005
Val acc before epoch 73: 0.9042553191489362
Warm optimizer lr: 0.011957422500000005
Val acc before epoch 74: 0.8936170212765957
Warm optimizer lr: 0.011957422500000005
Val acc before epoch 75: 0.9042553191489362
Warm optimizer lr: 0.011957422500000005
Val acc before epoch 76: 0.9148936170212766
Warm optimizer lr: 0.011957422500000005
Val acc before epoch 77: 0.8936170212765957
Warm optimizer lr: 0.011957422500000005
Val acc before epoch 78: 0.9042553191489362
Warm optimizer lr: 0.011957422500000005
Val acc before epoch 79: 0.9042553191489362
Warm optimizer lr: 0.011957422500000005
Val acc before epoch 80: 0.8723404255319149
Warm optimizer lr: 0.010761680250000006
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.010761680250000006
Val acc before epoch 82: 0.9148936170212766
Warm optimizer lr: 0.010761680250000006
Val acc before epoch 83: 0.925531914893617
Warm optimizer lr: 0.010761680250000006
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 0.010761680250000006
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.010761680250000006
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.010761680250000006
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.010761680250000006
Val acc before epoch 88: 0.925531914893617
Warm optimizer lr: 0.010761680250000006
Val acc before epoch 89: 0.9574468085106383
Warm optimizer lr: 0.010761680250000006
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.009685512225000005
Val acc before epoch 91: 0.9148936170212766
Warm optimizer lr: 0.009685512225000005
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.009685512225000005
Val acc before epoch 93: 0.9042553191489362
Warm optimizer lr: 0.009685512225000005
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 0.009685512225000005
Val acc before epoch 95: 0.9468085106382979
Warm optimizer lr: 0.009685512225000005
Val acc before epoch 96: 0.925531914893617
Warm optimizer lr: 0.009685512225000005
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.009685512225000005
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 0.009685512225000005
Val acc before epoch 99: 0.9574468085106383
Warm optimizer lr: 0.009685512225000005
Val acc before epoch 100: 0.9680851063829787
Warm optimizer lr: 0.008716961002500004
Val acc before epoch 101: 0.9148936170212766
Warm optimizer lr: 0.008716961002500004
Val acc before epoch 102: 0.9148936170212766
Warm optimizer lr: 0.008716961002500004
Val acc before epoch 103: 0.9680851063829787
Warm optimizer lr: 0.008716961002500004
Val acc before epoch 104: 0.9574468085106383
Stopping after epoch 105.
Final validation accuracy before push: 95.74468085106383%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8605769230769231
	Train Cluster: 0.6511310458183288
	TrainSeparation: 0.5074517071247101
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.001

Attempting combination 21/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 0.5
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.35106382978723405
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 10: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 13: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 23: 0.9680851063829787
Warm optimizer lr: 0.0125
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.0125
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.0125
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.0125
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.00625
Val acc before epoch 31: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.00625
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.00625
Val acc before epoch 35: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.00625
Val acc before epoch 38: 0.9361702127659575
Warm optimizer lr: 0.00625
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 41: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 42: 0.9148936170212766
Warm optimizer lr: 0.003125
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 44: 0.9042553191489362
Warm optimizer lr: 0.003125
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 46: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 48: 0.925531914893617
Warm optimizer lr: 0.003125
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.0015625
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.0015625
Val acc before epoch 52: 0.925531914893617
Warm optimizer lr: 0.0015625
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.0015625
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 58: 0.925531914893617
Warm optimizer lr: 0.0015625
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.00078125
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 62: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 65: 0.925531914893617
Warm optimizer lr: 0.00078125
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.00078125
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.00078125
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.000390625
Val acc before epoch 70: 0.9361702127659575
Push epoch at epoch 71.
Final validation accuracy before push: 93.61702127659575%
Push number 1
After push, before retraining last layer:
	Train acc: 0.7948717948717948
	Train Cluster: 0.6434619188308716
	Train Separation: 0.5119170665740966
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.6702127659574468
Warm optimizer lr: 0.000390625
Val acc before epoch 72: 0.7872340425531915
Warm optimizer lr: 0.000390625
Val acc before epoch 73: 0.7659574468085106
Warm optimizer lr: 0.000390625
Val acc before epoch 74: 0.7659574468085106
Warm optimizer lr: 0.000390625
Val acc before epoch 75: 0.7127659574468085
Warm optimizer lr: 0.000390625
Val acc before epoch 76: 0.7340425531914894
Warm optimizer lr: 0.000390625
Val acc before epoch 77: 0.7872340425531915
Warm optimizer lr: 0.000390625
Val acc before epoch 78: 0.7978723404255319
Warm optimizer lr: 0.000390625
Val acc before epoch 79: 0.6702127659574468
Warm optimizer lr: 0.000390625
Val acc before epoch 80: 0.7659574468085106
Warm optimizer lr: 0.0001953125
Val acc before epoch 81: 0.6808510638297872
Warm optimizer lr: 0.0001953125
Val acc before epoch 82: 0.723404255319149
Warm optimizer lr: 0.0001953125
Val acc before epoch 83: 0.7446808510638298
Warm optimizer lr: 0.0001953125
Val acc before epoch 84: 0.7659574468085106
Warm optimizer lr: 0.0001953125
Val acc before epoch 85: 0.7340425531914894
Warm optimizer lr: 0.0001953125
Val acc before epoch 86: 0.7127659574468085
Warm optimizer lr: 0.0001953125
Val acc before epoch 87: 0.776595744680851
Warm optimizer lr: 0.0001953125
Val acc before epoch 88: 0.7446808510638298
Warm optimizer lr: 0.0001953125
Val acc before epoch 89: 0.7446808510638298
Warm optimizer lr: 0.0001953125
Val acc before epoch 90: 0.7553191489361702
Warm optimizer lr: 9.765625e-05
Val acc before epoch 91: 0.7872340425531915
Warm optimizer lr: 9.765625e-05
Val acc before epoch 92: 0.7872340425531915
Warm optimizer lr: 9.765625e-05
Val acc before epoch 93: 0.7978723404255319
Warm optimizer lr: 9.765625e-05
Val acc before epoch 94: 0.776595744680851
Warm optimizer lr: 9.765625e-05
Val acc before epoch 95: 0.7446808510638298
Warm optimizer lr: 9.765625e-05
Val acc before epoch 96: 0.723404255319149
Warm optimizer lr: 9.765625e-05
Val acc before epoch 97: 0.7872340425531915
Warm optimizer lr: 9.765625e-05
Val acc before epoch 98: 0.7340425531914894
Warm optimizer lr: 9.765625e-05
Val acc before epoch 99: 0.7340425531914894
Warm optimizer lr: 9.765625e-05
Val acc before epoch 100: 0.6914893617021277
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 101: 0.776595744680851
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 102: 0.7978723404255319
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 103: 0.6914893617021277
Warm optimizer lr: 4.8828125e-05
Val acc before epoch 104: 0.7340425531914894
Stopping after epoch 105.
Final validation accuracy before push: 73.40425531914893%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8269230769230769
	Train Cluster: 0.6594600081443787
	TrainSeparation: 0.5125696659088135
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.001

Attempting combination 22/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 0.6
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.30851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.03
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.03
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.03
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.03
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.03
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.03
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.03
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.03
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.03
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.03
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.018
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.018
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.018
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.018
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.018
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.018
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.018
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.018
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.018
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.018
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.010799999999999999
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.010799999999999999
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.010799999999999999
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.010799999999999999
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.010799999999999999
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.010799999999999999
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.010799999999999999
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.010799999999999999
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.010799999999999999
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.010799999999999999
Val acc before epoch 39: 0.9574468085106383
Warm optimizer lr: 0.006479999999999999
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.006479999999999999
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.006479999999999999
Val acc before epoch 42: 0.9787234042553191
Warm optimizer lr: 0.006479999999999999
Val acc before epoch 43: 0.9574468085106383
Warm optimizer lr: 0.006479999999999999
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.006479999999999999
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.006479999999999999
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.006479999999999999
Val acc before epoch 47: 0.9680851063829787
Warm optimizer lr: 0.006479999999999999
Val acc before epoch 48: 0.9680851063829787
Warm optimizer lr: 0.006479999999999999
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.003887999999999999
Val acc before epoch 50: 0.9680851063829787
Warm optimizer lr: 0.003887999999999999
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.003887999999999999
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.003887999999999999
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.003887999999999999
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.003887999999999999
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.003887999999999999
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.003887999999999999
Val acc before epoch 57: 0.9574468085106383
Warm optimizer lr: 0.003887999999999999
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.003887999999999999
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.0023327999999999995
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.0023327999999999995
Val acc before epoch 61: 0.9680851063829787
Warm optimizer lr: 0.0023327999999999995
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.0023327999999999995
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.0023327999999999995
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.0023327999999999995
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.0023327999999999995
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.0023327999999999995
Val acc before epoch 67: 0.9148936170212766
Warm optimizer lr: 0.0023327999999999995
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.0023327999999999995
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.0013996799999999997
Val acc before epoch 70: 0.9574468085106383
Push epoch at epoch 71.
Final validation accuracy before push: 95.74468085106383%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.6516143441200256
	Train Separation: 0.5101541399955749
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7553191489361702
Warm optimizer lr: 0.0013996799999999997
Val acc before epoch 72: 0.7446808510638298
Warm optimizer lr: 0.0013996799999999997
Val acc before epoch 73: 0.7021276595744681
Warm optimizer lr: 0.0013996799999999997
Val acc before epoch 74: 0.7553191489361702
Warm optimizer lr: 0.0013996799999999997
Val acc before epoch 75: 0.7553191489361702
Warm optimizer lr: 0.0013996799999999997
Val acc before epoch 76: 0.8085106382978723
Warm optimizer lr: 0.0013996799999999997
Val acc before epoch 77: 0.8085106382978723
Warm optimizer lr: 0.0013996799999999997
Val acc before epoch 78: 0.8297872340425532
Warm optimizer lr: 0.0013996799999999997
Val acc before epoch 79: 0.8085106382978723
Warm optimizer lr: 0.0013996799999999997
Val acc before epoch 80: 0.8829787234042553
Warm optimizer lr: 0.0008398079999999998
Val acc before epoch 81: 0.8404255319148937
Warm optimizer lr: 0.0008398079999999998
Val acc before epoch 82: 0.851063829787234
Warm optimizer lr: 0.0008398079999999998
Val acc before epoch 83: 0.8085106382978723
Warm optimizer lr: 0.0008398079999999998
Val acc before epoch 84: 0.8085106382978723
Warm optimizer lr: 0.0008398079999999998
Val acc before epoch 85: 0.8723404255319149
Warm optimizer lr: 0.0008398079999999998
Val acc before epoch 86: 0.7978723404255319
Warm optimizer lr: 0.0008398079999999998
Val acc before epoch 87: 0.8723404255319149
Warm optimizer lr: 0.0008398079999999998
Val acc before epoch 88: 0.8617021276595744
Warm optimizer lr: 0.0008398079999999998
Val acc before epoch 89: 0.8297872340425532
Warm optimizer lr: 0.0008398079999999998
Val acc before epoch 90: 0.9042553191489362
Warm optimizer lr: 0.0005038847999999999
Val acc before epoch 91: 0.8936170212765957
Warm optimizer lr: 0.0005038847999999999
Val acc before epoch 92: 0.8297872340425532
Warm optimizer lr: 0.0005038847999999999
Val acc before epoch 93: 0.8723404255319149
Warm optimizer lr: 0.0005038847999999999
Val acc before epoch 94: 0.8297872340425532
Warm optimizer lr: 0.0005038847999999999
Val acc before epoch 95: 0.851063829787234
Warm optimizer lr: 0.0005038847999999999
Val acc before epoch 96: 0.8829787234042553
Warm optimizer lr: 0.0005038847999999999
Val acc before epoch 97: 0.8297872340425532
Warm optimizer lr: 0.0005038847999999999
Val acc before epoch 98: 0.8191489361702128
Warm optimizer lr: 0.0005038847999999999
Val acc before epoch 99: 0.851063829787234
Warm optimizer lr: 0.0005038847999999999
Val acc before epoch 100: 0.8829787234042553
Warm optimizer lr: 0.0003023308799999999
Val acc before epoch 101: 0.8723404255319149
Warm optimizer lr: 0.0003023308799999999
Val acc before epoch 102: 0.8723404255319149
Warm optimizer lr: 0.0003023308799999999
Val acc before epoch 103: 0.9042553191489362
Warm optimizer lr: 0.0003023308799999999
Val acc before epoch 104: 0.8936170212765957
Stopping after epoch 105.
Final validation accuracy before push: 89.36170212765957%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Train Cluster: 0.6487943291664123
	TrainSeparation: 0.5117540299892426
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.001

Attempting combination 23/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 0.7
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.2872340425531915
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.6063829787234043
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.9042553191489362
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.034999999999999996
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.034999999999999996
Val acc before epoch 11: 0.9680851063829787
Warm optimizer lr: 0.034999999999999996
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.034999999999999996
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.034999999999999996
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.034999999999999996
Val acc before epoch 15: 0.9468085106382979
Warm optimizer lr: 0.034999999999999996
Val acc before epoch 16: 0.9361702127659575
Warm optimizer lr: 0.034999999999999996
Val acc before epoch 17: 0.9680851063829787
Warm optimizer lr: 0.034999999999999996
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.034999999999999996
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.024499999999999997
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.024499999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.024499999999999997
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.024499999999999997
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.024499999999999997
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.024499999999999997
Val acc before epoch 25: 0.9680851063829787
Warm optimizer lr: 0.024499999999999997
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.024499999999999997
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.024499999999999997
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.024499999999999997
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.01715
Val acc before epoch 30: 0.9680851063829787
Warm optimizer lr: 0.01715
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.01715
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.01715
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.01715
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.01715
Val acc before epoch 35: 0.9787234042553191
Warm optimizer lr: 0.01715
Val acc before epoch 36: 0.9680851063829787
Warm optimizer lr: 0.01715
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.01715
Val acc before epoch 38: 0.9787234042553191
Warm optimizer lr: 0.01715
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.012004999999999998
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.012004999999999998
Val acc before epoch 41: 0.9680851063829787
Warm optimizer lr: 0.012004999999999998
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.012004999999999998
Val acc before epoch 43: 0.9680851063829787
Warm optimizer lr: 0.012004999999999998
Val acc before epoch 44: 0.9787234042553191
Warm optimizer lr: 0.012004999999999998
Val acc before epoch 45: 0.9787234042553191
Warm optimizer lr: 0.012004999999999998
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.012004999999999998
Val acc before epoch 47: 0.9787234042553191
Warm optimizer lr: 0.012004999999999998
Val acc before epoch 48: 0.9787234042553191
Warm optimizer lr: 0.012004999999999998
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.008403499999999998
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.008403499999999998
Val acc before epoch 51: 0.9680851063829787
Warm optimizer lr: 0.008403499999999998
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.008403499999999998
Val acc before epoch 53: 0.9787234042553191
Warm optimizer lr: 0.008403499999999998
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.008403499999999998
Val acc before epoch 55: 0.9680851063829787
Warm optimizer lr: 0.008403499999999998
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.008403499999999998
Val acc before epoch 57: 0.9787234042553191
Warm optimizer lr: 0.008403499999999998
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.008403499999999998
Val acc before epoch 59: 0.9680851063829787
Warm optimizer lr: 0.005882449999999998
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.005882449999999998
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.005882449999999998
Val acc before epoch 62: 0.9787234042553191
Warm optimizer lr: 0.005882449999999998
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.005882449999999998
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.005882449999999998
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.005882449999999998
Val acc before epoch 66: 0.9680851063829787
Warm optimizer lr: 0.005882449999999998
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.005882449999999998
Val acc before epoch 68: 0.9680851063829787
Warm optimizer lr: 0.005882449999999998
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.004117714999999998
Val acc before epoch 70: 0.9787234042553191
Push epoch at epoch 71.
Final validation accuracy before push: 97.87234042553192%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8108974358974359
	Train Cluster: 0.6416203618049622
	Train Separation: 0.5089115142822266
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7340425531914894
Warm optimizer lr: 0.004117714999999998
Val acc before epoch 72: 0.7340425531914894
Warm optimizer lr: 0.004117714999999998
Val acc before epoch 73: 0.7978723404255319
Warm optimizer lr: 0.004117714999999998
Val acc before epoch 74: 0.7872340425531915
Warm optimizer lr: 0.004117714999999998
Val acc before epoch 75: 0.7659574468085106
Warm optimizer lr: 0.004117714999999998
Val acc before epoch 76: 0.8191489361702128
Warm optimizer lr: 0.004117714999999998
Val acc before epoch 77: 0.8191489361702128
Warm optimizer lr: 0.004117714999999998
Val acc before epoch 78: 0.8936170212765957
Warm optimizer lr: 0.004117714999999998
Val acc before epoch 79: 0.8617021276595744
Warm optimizer lr: 0.004117714999999998
Val acc before epoch 80: 0.8723404255319149
Warm optimizer lr: 0.0028824004999999987
Val acc before epoch 81: 0.8936170212765957
Warm optimizer lr: 0.0028824004999999987
Val acc before epoch 82: 0.9361702127659575
Warm optimizer lr: 0.0028824004999999987
Val acc before epoch 83: 0.925531914893617
Warm optimizer lr: 0.0028824004999999987
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 0.0028824004999999987
Val acc before epoch 85: 0.9042553191489362
Warm optimizer lr: 0.0028824004999999987
Val acc before epoch 86: 0.8936170212765957
Warm optimizer lr: 0.0028824004999999987
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 0.0028824004999999987
Val acc before epoch 88: 0.925531914893617
Warm optimizer lr: 0.0028824004999999987
Val acc before epoch 89: 0.8829787234042553
Warm optimizer lr: 0.0028824004999999987
Val acc before epoch 90: 0.9042553191489362
Warm optimizer lr: 0.002017680349999999
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.002017680349999999
Val acc before epoch 92: 0.9042553191489362
Warm optimizer lr: 0.002017680349999999
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 0.002017680349999999
Val acc before epoch 94: 0.8936170212765957
Warm optimizer lr: 0.002017680349999999
Val acc before epoch 95: 0.8936170212765957
Warm optimizer lr: 0.002017680349999999
Val acc before epoch 96: 0.9468085106382979
Warm optimizer lr: 0.002017680349999999
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.002017680349999999
Val acc before epoch 98: 0.8936170212765957
Warm optimizer lr: 0.002017680349999999
Val acc before epoch 99: 0.9361702127659575
Warm optimizer lr: 0.002017680349999999
Val acc before epoch 100: 0.9148936170212766
Warm optimizer lr: 0.0014123762449999991
Val acc before epoch 101: 0.9361702127659575
Warm optimizer lr: 0.0014123762449999991
Val acc before epoch 102: 0.9361702127659575
Warm optimizer lr: 0.0014123762449999991
Val acc before epoch 103: 0.925531914893617
Warm optimizer lr: 0.0014123762449999991
Val acc before epoch 104: 0.9361702127659575
Stopping after epoch 105.
Final validation accuracy before push: 93.61702127659575%
Push number 2
After push, before retraining last layer:
	Train acc: 0.7788461538461539
	Train Cluster: 0.638446307182312
	TrainSeparation: 0.5103583872318268
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.001

Attempting combination 24/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 0.8
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.39361702127659576
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.9680851063829787
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 13: 0.8829787234042553
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.04000000000000001
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.03200000000000001
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 36: 0.9042553191489362
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 38: 0.9361702127659575
Warm optimizer lr: 0.025600000000000008
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 40: 0.9148936170212766
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 41: 0.9574468085106383
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 43: 0.9574468085106383
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 44: 0.8829787234042553
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 48: 0.9148936170212766
Warm optimizer lr: 0.02048000000000001
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 50: 0.925531914893617
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 54: 0.9148936170212766
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 55: 0.8936170212765957
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 57: 0.9574468085106383
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 58: 0.9148936170212766
Warm optimizer lr: 0.016384000000000006
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 61: 0.9148936170212766
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 63: 0.9148936170212766
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.013107200000000006
Val acc before epoch 69: 0.9148936170212766
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 70: 0.925531914893617
Push epoch at epoch 71.
Final validation accuracy before push: 92.5531914893617%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8557692307692307
	Train Cluster: 0.6515817046165466
	Train Separation: 0.5031027615070343
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7021276595744681
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 72: 0.8617021276595744
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 73: 0.8829787234042553
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 74: 0.851063829787234
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 75: 0.8617021276595744
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 76: 0.8617021276595744
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 77: 0.8936170212765957
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 79: 0.9468085106382979
Warm optimizer lr: 0.010485760000000005
Val acc before epoch 80: 0.8936170212765957
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 82: 0.9042553191489362
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 83: 0.925531914893617
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 84: 0.9042553191489362
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 85: 0.8936170212765957
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 86: 0.9574468085106383
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 87: 0.9148936170212766
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 88: 0.925531914893617
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 0.008388608000000004
Val acc before epoch 90: 0.925531914893617
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 95: 0.9042553191489362
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 96: 0.9468085106382979
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 97: 0.9148936170212766
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 98: 0.925531914893617
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 99: 0.9361702127659575
Warm optimizer lr: 0.006710886400000004
Val acc before epoch 100: 0.9468085106382979
Warm optimizer lr: 0.005368709120000003
Val acc before epoch 101: 0.9361702127659575
Warm optimizer lr: 0.005368709120000003
Val acc before epoch 102: 0.9468085106382979
Warm optimizer lr: 0.005368709120000003
Val acc before epoch 103: 0.9361702127659575
Warm optimizer lr: 0.005368709120000003
Val acc before epoch 104: 0.9468085106382979
Stopping after epoch 105.
Final validation accuracy before push: 94.68085106382979%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8301282051282052
	Train Cluster: 0.6587068200111389
	TrainSeparation: 0.5127122044563294
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.001

Attempting combination 25/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.05
p0_warm_ptype_gamma: 0.9
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.05
Val acc before epoch 1: 0.2978723404255319
Warm optimizer lr: 0.05
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.05
Val acc before epoch 3: 0.851063829787234
Warm optimizer lr: 0.05
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.05
Val acc before epoch 5: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 7: 0.925531914893617
Warm optimizer lr: 0.05
Val acc before epoch 8: 0.9680851063829787
Warm optimizer lr: 0.05
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.045000000000000005
Val acc before epoch 10: 0.9361702127659575
Warm optimizer lr: 0.045000000000000005
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.045000000000000005
Val acc before epoch 12: 0.9468085106382979
Warm optimizer lr: 0.045000000000000005
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.045000000000000005
Val acc before epoch 14: 0.9680851063829787
Warm optimizer lr: 0.045000000000000005
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.045000000000000005
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.045000000000000005
Val acc before epoch 17: 0.9361702127659575
Warm optimizer lr: 0.045000000000000005
Val acc before epoch 18: 0.9574468085106383
Warm optimizer lr: 0.045000000000000005
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.04050000000000001
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.04050000000000001
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.04050000000000001
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.04050000000000001
Val acc before epoch 23: 0.9680851063829787
Warm optimizer lr: 0.04050000000000001
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.04050000000000001
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.04050000000000001
Val acc before epoch 26: 0.9148936170212766
Warm optimizer lr: 0.04050000000000001
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.04050000000000001
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.04050000000000001
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.03645000000000001
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.03645000000000001
Val acc before epoch 31: 0.9680851063829787
Warm optimizer lr: 0.03645000000000001
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.03645000000000001
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.03645000000000001
Val acc before epoch 34: 0.8936170212765957
Warm optimizer lr: 0.03645000000000001
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.03645000000000001
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.03645000000000001
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.03645000000000001
Val acc before epoch 38: 0.9361702127659575
Warm optimizer lr: 0.03645000000000001
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.03280500000000001
Val acc before epoch 40: 0.9468085106382979
Warm optimizer lr: 0.03280500000000001
Val acc before epoch 41: 0.9680851063829787
Warm optimizer lr: 0.03280500000000001
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.03280500000000001
Val acc before epoch 43: 0.9680851063829787
Warm optimizer lr: 0.03280500000000001
Val acc before epoch 44: 0.9574468085106383
Warm optimizer lr: 0.03280500000000001
Val acc before epoch 45: 0.9680851063829787
Warm optimizer lr: 0.03280500000000001
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.03280500000000001
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.03280500000000001
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.03280500000000001
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.02952450000000001
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.02952450000000001
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 0.02952450000000001
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.02952450000000001
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.02952450000000001
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.02952450000000001
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.02952450000000001
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.02952450000000001
Val acc before epoch 57: 0.9680851063829787
Warm optimizer lr: 0.02952450000000001
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.02952450000000001
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.02657205000000001
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.02657205000000001
Val acc before epoch 61: 0.925531914893617
Warm optimizer lr: 0.02657205000000001
Val acc before epoch 62: 0.9680851063829787
Warm optimizer lr: 0.02657205000000001
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.02657205000000001
Val acc before epoch 64: 0.9680851063829787
Warm optimizer lr: 0.02657205000000001
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.02657205000000001
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.02657205000000001
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.02657205000000001
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.02657205000000001
Val acc before epoch 69: 0.9468085106382979
Warm optimizer lr: 0.02391484500000001
Val acc before epoch 70: 0.9361702127659575
Push epoch at epoch 71.
Final validation accuracy before push: 93.61702127659575%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8060897435897436
	Train Cluster: 0.6391479253768921
	Train Separation: 0.5106749594211578
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7127659574468085
Warm optimizer lr: 0.02391484500000001
Val acc before epoch 72: 0.851063829787234
Warm optimizer lr: 0.02391484500000001
Val acc before epoch 73: 0.851063829787234
Warm optimizer lr: 0.02391484500000001
Val acc before epoch 74: 0.8936170212765957
Warm optimizer lr: 0.02391484500000001
Val acc before epoch 75: 0.9148936170212766
Warm optimizer lr: 0.02391484500000001
Val acc before epoch 76: 0.9042553191489362
Warm optimizer lr: 0.02391484500000001
Val acc before epoch 77: 0.8829787234042553
Warm optimizer lr: 0.02391484500000001
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 0.02391484500000001
Val acc before epoch 79: 0.9148936170212766
Warm optimizer lr: 0.02391484500000001
Val acc before epoch 80: 0.8936170212765957
Warm optimizer lr: 0.021523360500000012
Val acc before epoch 81: 0.9148936170212766
Warm optimizer lr: 0.021523360500000012
Val acc before epoch 82: 0.9042553191489362
Warm optimizer lr: 0.021523360500000012
Val acc before epoch 83: 0.9468085106382979
Warm optimizer lr: 0.021523360500000012
Val acc before epoch 84: 0.925531914893617
Warm optimizer lr: 0.021523360500000012
Val acc before epoch 85: 0.9361702127659575
Warm optimizer lr: 0.021523360500000012
Val acc before epoch 86: 0.9361702127659575
Warm optimizer lr: 0.021523360500000012
Val acc before epoch 87: 0.9574468085106383
Warm optimizer lr: 0.021523360500000012
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 0.021523360500000012
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 0.021523360500000012
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.01937102445000001
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.01937102445000001
Val acc before epoch 92: 0.9148936170212766
Warm optimizer lr: 0.01937102445000001
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 0.01937102445000001
Val acc before epoch 94: 0.925531914893617
Warm optimizer lr: 0.01937102445000001
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 0.01937102445000001
Val acc before epoch 96: 0.925531914893617
Warm optimizer lr: 0.01937102445000001
Val acc before epoch 97: 0.925531914893617
Warm optimizer lr: 0.01937102445000001
Val acc before epoch 98: 0.9574468085106383
Warm optimizer lr: 0.01937102445000001
Val acc before epoch 99: 0.9148936170212766
Warm optimizer lr: 0.01937102445000001
Val acc before epoch 100: 0.9148936170212766
Warm optimizer lr: 0.01743392200500001
Val acc before epoch 101: 0.9468085106382979
Warm optimizer lr: 0.01743392200500001
Val acc before epoch 102: 0.9574468085106383
Warm optimizer lr: 0.01743392200500001
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.01743392200500001
Val acc before epoch 104: 0.9468085106382979
Stopping after epoch 105.
Final validation accuracy before push: 94.68085106382979%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8141025641025641
	Train Cluster: 0.6426064014434815
	TrainSeparation: 0.5063006281852722
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer
Last layer lr: 0.001

Attempting combination 26/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.075
p0_warm_ptype_gamma: 0.5
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.075
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.075
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.075
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.075
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.075
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.075
Val acc before epoch 6: 0.851063829787234
Warm optimizer lr: 0.075
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.075
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.075
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.0375
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.0375
Val acc before epoch 11: 0.9468085106382979
Warm optimizer lr: 0.0375
Val acc before epoch 12: 0.925531914893617
Warm optimizer lr: 0.0375
Val acc before epoch 13: 0.9468085106382979
Warm optimizer lr: 0.0375
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.0375
Val acc before epoch 15: 0.9468085106382979
Warm optimizer lr: 0.0375
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.0375
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.0375
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.0375
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.01875
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.01875
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.01875
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.01875
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.01875
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.01875
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.01875
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.01875
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.01875
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.01875
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.009375
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.009375
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.009375
Val acc before epoch 32: 0.925531914893617
Warm optimizer lr: 0.009375
Val acc before epoch 33: 0.9042553191489362
Warm optimizer lr: 0.009375
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.009375
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.009375
Val acc before epoch 36: 0.9148936170212766
Warm optimizer lr: 0.009375
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.009375
Val acc before epoch 38: 0.9361702127659575
Warm optimizer lr: 0.009375
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.0046875
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.0046875
Val acc before epoch 41: 0.9148936170212766
Warm optimizer lr: 0.0046875
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.0046875
Val acc before epoch 43: 0.9148936170212766
Warm optimizer lr: 0.0046875
Val acc before epoch 44: 0.9148936170212766
Warm optimizer lr: 0.0046875
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.0046875
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.0046875
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.0046875
Val acc before epoch 48: 0.9680851063829787
Warm optimizer lr: 0.0046875
Val acc before epoch 49: 0.9148936170212766
Warm optimizer lr: 0.00234375
Val acc before epoch 50: 0.925531914893617
Warm optimizer lr: 0.00234375
Val acc before epoch 51: 0.9148936170212766
Warm optimizer lr: 0.00234375
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.00234375
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.00234375
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.00234375
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.00234375
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.00234375
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.00234375
Val acc before epoch 58: 0.9148936170212766
Warm optimizer lr: 0.00234375
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.001171875
Val acc before epoch 60: 0.9148936170212766
Warm optimizer lr: 0.001171875
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.001171875
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.001171875
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.001171875
Val acc before epoch 64: 0.9148936170212766
Warm optimizer lr: 0.001171875
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.001171875
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.001171875
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 0.001171875
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.001171875
Val acc before epoch 69: 0.9042553191489362
Warm optimizer lr: 0.0005859375
Val acc before epoch 70: 0.9361702127659575
Push epoch at epoch 71.
Final validation accuracy before push: 93.61702127659575%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8237179487179487
	Train Cluster: 0.6633691430091858
	Train Separation: 0.5165539860725403
(Directly after push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.648936170212766
Warm optimizer lr: 0.0005859375
Val acc before epoch 72: 0.6595744680851063
Warm optimizer lr: 0.0005859375
Val acc before epoch 73: 0.6808510638297872
Warm optimizer lr: 0.0005859375
Val acc before epoch 74: 0.6914893617021277
Warm optimizer lr: 0.0005859375
Val acc before epoch 75: 0.6595744680851063
Warm optimizer lr: 0.0005859375
Val acc before epoch 76: 0.7127659574468085
Warm optimizer lr: 0.0005859375
Val acc before epoch 77: 0.7021276595744681
Warm optimizer lr: 0.0005859375
Val acc before epoch 78: 0.7446808510638298
Warm optimizer lr: 0.0005859375
Val acc before epoch 79: 0.723404255319149
Warm optimizer lr: 0.0005859375
Val acc before epoch 80: 0.8191489361702128
Warm optimizer lr: 0.00029296875
Val acc before epoch 81: 0.7553191489361702
Warm optimizer lr: 0.00029296875
Val acc before epoch 82: 0.7340425531914894
Warm optimizer lr: 0.00029296875
Val acc before epoch 83: 0.776595744680851
Warm optimizer lr: 0.00029296875
Val acc before epoch 84: 0.7659574468085106
Warm optimizer lr: 0.00029296875
Val acc before epoch 85: 0.723404255319149
Warm optimizer lr: 0.00029296875
Val acc before epoch 86: 0.7659574468085106
Warm optimizer lr: 0.00029296875
Val acc before epoch 87: 0.776595744680851
Warm optimizer lr: 0.00029296875
Val acc before epoch 88: 0.776595744680851
Warm optimizer lr: 0.00029296875
Val acc before epoch 89: 0.7340425531914894
Warm optimizer lr: 0.00029296875
Val acc before epoch 90: 0.6808510638297872
Warm optimizer lr: 0.000146484375
Val acc before epoch 91: 0.7553191489361702
Warm optimizer lr: 0.000146484375
Val acc before epoch 92: 0.776595744680851
Warm optimizer lr: 0.000146484375
Val acc before epoch 93: 0.7659574468085106
Warm optimizer lr: 0.000146484375
Val acc before epoch 94: 0.6914893617021277
Warm optimizer lr: 0.000146484375
Val acc before epoch 95: 0.7127659574468085
Warm optimizer lr: 0.000146484375
Val acc before epoch 96: 0.7446808510638298
Warm optimizer lr: 0.000146484375
Val acc before epoch 97: 0.7446808510638298
Warm optimizer lr: 0.000146484375
Val acc before epoch 98: 0.7978723404255319
Warm optimizer lr: 0.000146484375
Val acc before epoch 99: 0.7872340425531915
Warm optimizer lr: 0.000146484375
Val acc before epoch 100: 0.776595744680851
Warm optimizer lr: 7.32421875e-05
Val acc before epoch 101: 0.7872340425531915
Warm optimizer lr: 7.32421875e-05
Val acc before epoch 102: 0.776595744680851
Warm optimizer lr: 7.32421875e-05
Val acc before epoch 103: 0.723404255319149
Warm optimizer lr: 7.32421875e-05
Val acc before epoch 104: 0.7553191489361702
Stopping after epoch 105.
Final validation accuracy before push: 75.53191489361703%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.6436835885047912
	TrainSeparation: 0.510344284772873
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.001

Attempting combination 27/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.075
p0_warm_ptype_gamma: 0.6
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.075
Val acc before epoch 1: 0.39361702127659576
Warm optimizer lr: 0.075
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.075
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.075
Val acc before epoch 4: 0.7978723404255319
Warm optimizer lr: 0.075
Val acc before epoch 5: 0.851063829787234
Warm optimizer lr: 0.075
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.075
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.075
Val acc before epoch 8: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.045
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.045
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.045
Val acc before epoch 12: 0.8936170212765957
Warm optimizer lr: 0.045
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.045
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.045
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.045
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.045
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.045
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.045
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.027
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.027
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.027
Val acc before epoch 22: 0.9574468085106383
Warm optimizer lr: 0.027
Val acc before epoch 23: 0.9042553191489362
Warm optimizer lr: 0.027
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.027
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.027
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.027
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.027
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.027
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.0162
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.0162
Val acc before epoch 31: 0.8936170212765957
Warm optimizer lr: 0.0162
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.0162
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.0162
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.0162
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.0162
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.0162
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.0162
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.0162
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.00972
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.00972
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.00972
Val acc before epoch 42: 0.925531914893617
Warm optimizer lr: 0.00972
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.00972
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.00972
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.00972
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.00972
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.00972
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.00972
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.0058319999999999995
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.0058319999999999995
Val acc before epoch 51: 0.9148936170212766
Warm optimizer lr: 0.0058319999999999995
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.0058319999999999995
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.0058319999999999995
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.0058319999999999995
Val acc before epoch 55: 0.9042553191489362
Warm optimizer lr: 0.0058319999999999995
Val acc before epoch 56: 0.9148936170212766
Warm optimizer lr: 0.0058319999999999995
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.0058319999999999995
Val acc before epoch 58: 0.9680851063829787
Warm optimizer lr: 0.0058319999999999995
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.0034991999999999996
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.0034991999999999996
Val acc before epoch 61: 0.9680851063829787
Warm optimizer lr: 0.0034991999999999996
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.0034991999999999996
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.0034991999999999996
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.0034991999999999996
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.0034991999999999996
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.0034991999999999996
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.0034991999999999996
Val acc before epoch 68: 0.9680851063829787
Warm optimizer lr: 0.0034991999999999996
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.0020995199999999997
Val acc before epoch 70: 0.9361702127659575
Push epoch at epoch 71.
Final validation accuracy before push: 93.61702127659575%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.6462091445922852
	Train Separation: 0.5130656838417054
(Directly after push) Val acc at iteration 0: 0.6276595744680851
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7659574468085106
Warm optimizer lr: 0.0020995199999999997
Val acc before epoch 72: 0.723404255319149
Warm optimizer lr: 0.0020995199999999997
Val acc before epoch 73: 0.7872340425531915
Warm optimizer lr: 0.0020995199999999997
Val acc before epoch 74: 0.7872340425531915
Warm optimizer lr: 0.0020995199999999997
Val acc before epoch 75: 0.7659574468085106
Warm optimizer lr: 0.0020995199999999997
Val acc before epoch 76: 0.7872340425531915
Warm optimizer lr: 0.0020995199999999997
Val acc before epoch 77: 0.8191489361702128
Warm optimizer lr: 0.0020995199999999997
Val acc before epoch 78: 0.8404255319148937
Warm optimizer lr: 0.0020995199999999997
Val acc before epoch 79: 0.851063829787234
Warm optimizer lr: 0.0020995199999999997
Val acc before epoch 80: 0.8404255319148937
Warm optimizer lr: 0.0012597119999999999
Val acc before epoch 81: 0.851063829787234
Warm optimizer lr: 0.0012597119999999999
Val acc before epoch 82: 0.8297872340425532
Warm optimizer lr: 0.0012597119999999999
Val acc before epoch 83: 0.8617021276595744
Warm optimizer lr: 0.0012597119999999999
Val acc before epoch 84: 0.851063829787234
Warm optimizer lr: 0.0012597119999999999
Val acc before epoch 85: 0.8297872340425532
Warm optimizer lr: 0.0012597119999999999
Val acc before epoch 86: 0.8297872340425532
Warm optimizer lr: 0.0012597119999999999
Val acc before epoch 87: 0.851063829787234
Warm optimizer lr: 0.0012597119999999999
Val acc before epoch 88: 0.8404255319148937
Warm optimizer lr: 0.0012597119999999999
Val acc before epoch 89: 0.8723404255319149
Warm optimizer lr: 0.0012597119999999999
Val acc before epoch 90: 0.851063829787234
Warm optimizer lr: 0.0007558271999999999
Val acc before epoch 91: 0.8617021276595744
Warm optimizer lr: 0.0007558271999999999
Val acc before epoch 92: 0.8936170212765957
Warm optimizer lr: 0.0007558271999999999
Val acc before epoch 93: 0.9042553191489362
Warm optimizer lr: 0.0007558271999999999
Val acc before epoch 94: 0.8297872340425532
Warm optimizer lr: 0.0007558271999999999
Val acc before epoch 95: 0.8829787234042553
Warm optimizer lr: 0.0007558271999999999
Val acc before epoch 96: 0.9042553191489362
Warm optimizer lr: 0.0007558271999999999
Val acc before epoch 97: 0.9148936170212766
Warm optimizer lr: 0.0007558271999999999
Val acc before epoch 98: 0.8617021276595744
Warm optimizer lr: 0.0007558271999999999
Val acc before epoch 99: 0.8936170212765957
Warm optimizer lr: 0.0007558271999999999
Val acc before epoch 100: 0.8829787234042553
Warm optimizer lr: 0.0004534963199999999
Val acc before epoch 101: 0.8829787234042553
Warm optimizer lr: 0.0004534963199999999
Val acc before epoch 102: 0.851063829787234
Warm optimizer lr: 0.0004534963199999999
Val acc before epoch 103: 0.8404255319148937
Warm optimizer lr: 0.0004534963199999999
Val acc before epoch 104: 0.8404255319148937
Stopping after epoch 105.
Final validation accuracy before push: 84.04255319148936%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8221153846153846
	Train Cluster: 0.6450239896774292
	TrainSeparation: 0.5100104510784149
(Directly after push) Val acc at iteration 0: 0.7553191489361702
Retraining last layer
Last layer lr: 0.001

Attempting combination 28/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.075
p0_warm_ptype_gamma: 0.7
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.075
Val acc before epoch 1: 0.3404255319148936
Warm optimizer lr: 0.075
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.075
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.075
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.075
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.075
Val acc before epoch 6: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.075
Val acc before epoch 8: 0.9468085106382979
Warm optimizer lr: 0.075
Val acc before epoch 9: 0.8936170212765957
Warm optimizer lr: 0.0525
Val acc before epoch 10: 0.9361702127659575
Warm optimizer lr: 0.0525
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.0525
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.0525
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.0525
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.0525
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.0525
Val acc before epoch 16: 0.9148936170212766
Warm optimizer lr: 0.0525
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.0525
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.0525
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.03675
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.03675
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.03675
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.03675
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.03675
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.03675
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.03675
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.03675
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.03675
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.03675
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.025724999999999998
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.025724999999999998
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.025724999999999998
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.025724999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.025724999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.025724999999999998
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.025724999999999998
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.025724999999999998
Val acc before epoch 37: 0.9042553191489362
Warm optimizer lr: 0.025724999999999998
Val acc before epoch 38: 0.925531914893617
Warm optimizer lr: 0.025724999999999998
Val acc before epoch 39: 0.8936170212765957
Warm optimizer lr: 0.018007499999999996
Val acc before epoch 40: 0.9148936170212766
Warm optimizer lr: 0.018007499999999996
Val acc before epoch 41: 0.9042553191489362
Warm optimizer lr: 0.018007499999999996
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.018007499999999996
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.018007499999999996
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.018007499999999996
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.018007499999999996
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.018007499999999996
Val acc before epoch 47: 0.9574468085106383
Warm optimizer lr: 0.018007499999999996
Val acc before epoch 48: 0.9042553191489362
Warm optimizer lr: 0.018007499999999996
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.012605249999999997
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.012605249999999997
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.012605249999999997
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.012605249999999997
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.012605249999999997
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.012605249999999997
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.012605249999999997
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.012605249999999997
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.012605249999999997
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.012605249999999997
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.008823674999999998
Val acc before epoch 60: 0.925531914893617
Warm optimizer lr: 0.008823674999999998
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.008823674999999998
Val acc before epoch 62: 0.9574468085106383
Warm optimizer lr: 0.008823674999999998
Val acc before epoch 63: 0.9042553191489362
Warm optimizer lr: 0.008823674999999998
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.008823674999999998
Val acc before epoch 65: 0.925531914893617
Warm optimizer lr: 0.008823674999999998
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.008823674999999998
Val acc before epoch 67: 0.9148936170212766
Warm optimizer lr: 0.008823674999999998
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.008823674999999998
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.006176572499999998
Val acc before epoch 70: 0.925531914893617
Push epoch at epoch 71.
Final validation accuracy before push: 92.5531914893617%
Push number 1
After push, before retraining last layer:
	Train acc: 0.844551282051282
	Train Cluster: 0.6473822474479676
	Train Separation: 0.5136694550514221
(Directly after push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7659574468085106
Warm optimizer lr: 0.006176572499999998
Val acc before epoch 72: 0.7978723404255319
Warm optimizer lr: 0.006176572499999998
Val acc before epoch 73: 0.7553191489361702
Warm optimizer lr: 0.006176572499999998
Val acc before epoch 74: 0.8723404255319149
Warm optimizer lr: 0.006176572499999998
Val acc before epoch 75: 0.8829787234042553
Warm optimizer lr: 0.006176572499999998
Val acc before epoch 76: 0.8723404255319149
Warm optimizer lr: 0.006176572499999998
Val acc before epoch 77: 0.8617021276595744
Warm optimizer lr: 0.006176572499999998
Val acc before epoch 78: 0.9042553191489362
Warm optimizer lr: 0.006176572499999998
Val acc before epoch 79: 0.8829787234042553
Warm optimizer lr: 0.006176572499999998
Val acc before epoch 80: 0.851063829787234
Warm optimizer lr: 0.004323600749999998
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.004323600749999998
Val acc before epoch 82: 0.8829787234042553
Warm optimizer lr: 0.004323600749999998
Val acc before epoch 83: 0.9148936170212766
Warm optimizer lr: 0.004323600749999998
Val acc before epoch 84: 0.9361702127659575
Warm optimizer lr: 0.004323600749999998
Val acc before epoch 85: 0.8936170212765957
Warm optimizer lr: 0.004323600749999998
Val acc before epoch 86: 0.8723404255319149
Warm optimizer lr: 0.004323600749999998
Val acc before epoch 87: 0.9042553191489362
Warm optimizer lr: 0.004323600749999998
Val acc before epoch 88: 0.925531914893617
Warm optimizer lr: 0.004323600749999998
Val acc before epoch 89: 0.8617021276595744
Warm optimizer lr: 0.004323600749999998
Val acc before epoch 90: 0.8829787234042553
Warm optimizer lr: 0.0030265205249999988
Val acc before epoch 91: 0.8936170212765957
Warm optimizer lr: 0.0030265205249999988
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.0030265205249999988
Val acc before epoch 93: 0.8936170212765957
Warm optimizer lr: 0.0030265205249999988
Val acc before epoch 94: 0.925531914893617
Warm optimizer lr: 0.0030265205249999988
Val acc before epoch 95: 0.8936170212765957
Warm optimizer lr: 0.0030265205249999988
Val acc before epoch 96: 0.9148936170212766
Warm optimizer lr: 0.0030265205249999988
Val acc before epoch 97: 0.9468085106382979
Warm optimizer lr: 0.0030265205249999988
Val acc before epoch 98: 0.925531914893617
Warm optimizer lr: 0.0030265205249999988
Val acc before epoch 99: 0.925531914893617
Warm optimizer lr: 0.0030265205249999988
Val acc before epoch 100: 0.9042553191489362
Warm optimizer lr: 0.002118564367499999
Val acc before epoch 101: 0.8936170212765957
Warm optimizer lr: 0.002118564367499999
Val acc before epoch 102: 0.9042553191489362
Warm optimizer lr: 0.002118564367499999
Val acc before epoch 103: 0.9148936170212766
Warm optimizer lr: 0.002118564367499999
Val acc before epoch 104: 0.9148936170212766
Stopping after epoch 105.
Final validation accuracy before push: 91.48936170212765%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8221153846153846
	Train Cluster: 0.6423264861106872
	TrainSeparation: 0.5109007716178894
(Directly after push) Val acc at iteration 0: 0.7446808510638298
Retraining last layer
Last layer lr: 0.001

Attempting combination 29/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.075
p0_warm_ptype_gamma: 0.8
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.075
Val acc before epoch 1: 0.40425531914893614
Warm optimizer lr: 0.075
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.075
Val acc before epoch 3: 0.7978723404255319
Warm optimizer lr: 0.075
Val acc before epoch 4: 0.8404255319148937
Warm optimizer lr: 0.075
Val acc before epoch 5: 0.8829787234042553
Warm optimizer lr: 0.075
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.075
Val acc before epoch 7: 0.925531914893617
Warm optimizer lr: 0.075
Val acc before epoch 8: 0.9361702127659575
Warm optimizer lr: 0.075
Val acc before epoch 9: 0.9680851063829787
Warm optimizer lr: 0.06
Val acc before epoch 10: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.06
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 14: 0.9787234042553191
Warm optimizer lr: 0.06
Val acc before epoch 15: 0.9787234042553191
Warm optimizer lr: 0.06
Val acc before epoch 16: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 17: 0.9680851063829787
Warm optimizer lr: 0.06
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.06
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.048
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.048
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.048
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.048
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.048
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.048
Val acc before epoch 25: 0.9042553191489362
Warm optimizer lr: 0.048
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.048
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.048
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.048
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.038400000000000004
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.038400000000000004
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.038400000000000004
Val acc before epoch 32: 0.9574468085106383
Warm optimizer lr: 0.038400000000000004
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.038400000000000004
Val acc before epoch 34: 0.9680851063829787
Warm optimizer lr: 0.038400000000000004
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.038400000000000004
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.038400000000000004
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.038400000000000004
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.038400000000000004
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.030720000000000004
Val acc before epoch 40: 0.9468085106382979
Warm optimizer lr: 0.030720000000000004
Val acc before epoch 41: 0.9680851063829787
Warm optimizer lr: 0.030720000000000004
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.030720000000000004
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.030720000000000004
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.030720000000000004
Val acc before epoch 45: 0.9680851063829787
Warm optimizer lr: 0.030720000000000004
Val acc before epoch 46: 0.9042553191489362
Warm optimizer lr: 0.030720000000000004
Val acc before epoch 47: 0.9574468085106383
Warm optimizer lr: 0.030720000000000004
Val acc before epoch 48: 0.9148936170212766
Warm optimizer lr: 0.030720000000000004
Val acc before epoch 49: 0.9680851063829787
Warm optimizer lr: 0.024576000000000004
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.024576000000000004
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.024576000000000004
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.024576000000000004
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.024576000000000004
Val acc before epoch 54: 0.925531914893617
Warm optimizer lr: 0.024576000000000004
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.024576000000000004
Val acc before epoch 56: 0.9680851063829787
Warm optimizer lr: 0.024576000000000004
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.024576000000000004
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.024576000000000004
Val acc before epoch 59: 0.9680851063829787
Warm optimizer lr: 0.019660800000000006
Val acc before epoch 60: 0.9148936170212766
Warm optimizer lr: 0.019660800000000006
Val acc before epoch 61: 0.925531914893617
Warm optimizer lr: 0.019660800000000006
Val acc before epoch 62: 0.9148936170212766
Warm optimizer lr: 0.019660800000000006
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.019660800000000006
Val acc before epoch 64: 0.9680851063829787
Warm optimizer lr: 0.019660800000000006
Val acc before epoch 65: 0.925531914893617
Warm optimizer lr: 0.019660800000000006
Val acc before epoch 66: 0.9680851063829787
Warm optimizer lr: 0.019660800000000006
Val acc before epoch 67: 0.9680851063829787
Warm optimizer lr: 0.019660800000000006
Val acc before epoch 68: 0.9680851063829787
Warm optimizer lr: 0.019660800000000006
Val acc before epoch 69: 0.9468085106382979
Warm optimizer lr: 0.015728640000000006
Val acc before epoch 70: 0.9680851063829787
Push epoch at epoch 71.
Final validation accuracy before push: 96.80851063829788%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8333333333333334
	Train Cluster: 0.6415322542190551
	Train Separation: 0.5039439022541046
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7340425531914894
Warm optimizer lr: 0.015728640000000006
Val acc before epoch 72: 0.8191489361702128
Warm optimizer lr: 0.015728640000000006
Val acc before epoch 73: 0.851063829787234
Warm optimizer lr: 0.015728640000000006
Val acc before epoch 74: 0.8829787234042553
Warm optimizer lr: 0.015728640000000006
Val acc before epoch 75: 0.8617021276595744
Warm optimizer lr: 0.015728640000000006
Val acc before epoch 76: 0.9148936170212766
Warm optimizer lr: 0.015728640000000006
Val acc before epoch 77: 0.9042553191489362
Warm optimizer lr: 0.015728640000000006
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.015728640000000006
Val acc before epoch 79: 0.8723404255319149
Warm optimizer lr: 0.015728640000000006
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.012582912000000005
Val acc before epoch 81: 0.9361702127659575
Warm optimizer lr: 0.012582912000000005
Val acc before epoch 82: 0.9148936170212766
Warm optimizer lr: 0.012582912000000005
Val acc before epoch 83: 0.9148936170212766
Warm optimizer lr: 0.012582912000000005
Val acc before epoch 84: 0.9574468085106383
Warm optimizer lr: 0.012582912000000005
Val acc before epoch 85: 0.9148936170212766
Warm optimizer lr: 0.012582912000000005
Val acc before epoch 86: 0.9468085106382979
Warm optimizer lr: 0.012582912000000005
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.012582912000000005
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.012582912000000005
Val acc before epoch 89: 0.9042553191489362
Warm optimizer lr: 0.012582912000000005
Val acc before epoch 90: 0.9680851063829787
Warm optimizer lr: 0.010066329600000005
Val acc before epoch 91: 0.9361702127659575
Warm optimizer lr: 0.010066329600000005
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 0.010066329600000005
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 0.010066329600000005
Val acc before epoch 94: 0.925531914893617
Warm optimizer lr: 0.010066329600000005
Val acc before epoch 95: 0.9148936170212766
Warm optimizer lr: 0.010066329600000005
Val acc before epoch 96: 0.925531914893617
Warm optimizer lr: 0.010066329600000005
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.010066329600000005
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 0.010066329600000005
Val acc before epoch 99: 0.9787234042553191
Warm optimizer lr: 0.010066329600000005
Val acc before epoch 100: 0.9148936170212766
Warm optimizer lr: 0.008053063680000005
Val acc before epoch 101: 0.9148936170212766
Warm optimizer lr: 0.008053063680000005
Val acc before epoch 102: 0.9361702127659575
Warm optimizer lr: 0.008053063680000005
Val acc before epoch 103: 0.9361702127659575
Warm optimizer lr: 0.008053063680000005
Val acc before epoch 104: 0.9680851063829787
Stopping after epoch 105.
Final validation accuracy before push: 96.80851063829788%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8189102564102564
	Train Cluster: 0.6535742282867432
	TrainSeparation: 0.5146096229553223
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.001

Attempting combination 30/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.075
p0_warm_ptype_gamma: 0.9
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.075
Val acc before epoch 1: 0.40425531914893614
Warm optimizer lr: 0.075
Val acc before epoch 2: 0.6595744680851063
Warm optimizer lr: 0.075
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.075
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.075
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.075
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.075
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.075
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.075
Val acc before epoch 9: 0.9468085106382979
Warm optimizer lr: 0.0675
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.0675
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.0675
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.0675
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.0675
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.0675
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.0675
Val acc before epoch 16: 0.9361702127659575
Warm optimizer lr: 0.0675
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.0675
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.0675
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.060750000000000005
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.060750000000000005
Val acc before epoch 21: 0.9042553191489362
Warm optimizer lr: 0.060750000000000005
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.060750000000000005
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.060750000000000005
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.060750000000000005
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.060750000000000005
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.060750000000000005
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.060750000000000005
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.060750000000000005
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.05467500000000001
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.05467500000000001
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.05467500000000001
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.05467500000000001
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.05467500000000001
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.05467500000000001
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.05467500000000001
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.05467500000000001
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.05467500000000001
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.05467500000000001
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.04920750000000001
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.04920750000000001
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.04920750000000001
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.04920750000000001
Val acc before epoch 43: 0.9361702127659575
Warm optimizer lr: 0.04920750000000001
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.04920750000000001
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.04920750000000001
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.04920750000000001
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.04920750000000001
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.04920750000000001
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.04428675000000001
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.04428675000000001
Val acc before epoch 51: 0.9574468085106383
Warm optimizer lr: 0.04428675000000001
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.04428675000000001
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.04428675000000001
Val acc before epoch 54: 0.9574468085106383
Warm optimizer lr: 0.04428675000000001
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.04428675000000001
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.04428675000000001
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.04428675000000001
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.04428675000000001
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.03985807500000001
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.03985807500000001
Val acc before epoch 61: 0.9787234042553191
Warm optimizer lr: 0.03985807500000001
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.03985807500000001
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.03985807500000001
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.03985807500000001
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.03985807500000001
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 0.03985807500000001
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 0.03985807500000001
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.03985807500000001
Val acc before epoch 69: 0.9468085106382979
Warm optimizer lr: 0.035872267500000006
Val acc before epoch 70: 0.9574468085106383
Push epoch at epoch 71.
Final validation accuracy before push: 95.74468085106383%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8317307692307693
	Train Cluster: 0.645089054107666
	Train Separation: 0.5087055504322052
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7340425531914894
Warm optimizer lr: 0.035872267500000006
Val acc before epoch 72: 0.8723404255319149
Warm optimizer lr: 0.035872267500000006
Val acc before epoch 73: 0.8936170212765957
Warm optimizer lr: 0.035872267500000006
Val acc before epoch 74: 0.8617021276595744
Warm optimizer lr: 0.035872267500000006
Val acc before epoch 75: 0.9148936170212766
Warm optimizer lr: 0.035872267500000006
Val acc before epoch 76: 0.925531914893617
Warm optimizer lr: 0.035872267500000006
Val acc before epoch 77: 0.925531914893617
Warm optimizer lr: 0.035872267500000006
Val acc before epoch 78: 0.9361702127659575
Warm optimizer lr: 0.035872267500000006
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.035872267500000006
Val acc before epoch 80: 0.9148936170212766
Warm optimizer lr: 0.03228504075000001
Val acc before epoch 81: 0.9361702127659575
Warm optimizer lr: 0.03228504075000001
Val acc before epoch 82: 0.925531914893617
Warm optimizer lr: 0.03228504075000001
Val acc before epoch 83: 0.9468085106382979
Warm optimizer lr: 0.03228504075000001
Val acc before epoch 84: 0.9468085106382979
Warm optimizer lr: 0.03228504075000001
Val acc before epoch 85: 0.925531914893617
Warm optimizer lr: 0.03228504075000001
Val acc before epoch 86: 0.9680851063829787
Warm optimizer lr: 0.03228504075000001
Val acc before epoch 87: 0.9468085106382979
Warm optimizer lr: 0.03228504075000001
Val acc before epoch 88: 0.925531914893617
Warm optimizer lr: 0.03228504075000001
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 0.03228504075000001
Val acc before epoch 90: 0.9468085106382979
Warm optimizer lr: 0.029056536675000008
Val acc before epoch 91: 0.9468085106382979
Warm optimizer lr: 0.029056536675000008
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.029056536675000008
Val acc before epoch 93: 0.9361702127659575
Warm optimizer lr: 0.029056536675000008
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 0.029056536675000008
Val acc before epoch 95: 0.9361702127659575
Warm optimizer lr: 0.029056536675000008
Val acc before epoch 96: 0.925531914893617
Warm optimizer lr: 0.029056536675000008
Val acc before epoch 97: 0.9148936170212766
Warm optimizer lr: 0.029056536675000008
Val acc before epoch 98: 0.9361702127659575
Warm optimizer lr: 0.029056536675000008
Val acc before epoch 99: 0.9148936170212766
Warm optimizer lr: 0.029056536675000008
Val acc before epoch 100: 0.9148936170212766
Warm optimizer lr: 0.026150883007500007
Val acc before epoch 101: 0.9574468085106383
Warm optimizer lr: 0.026150883007500007
Val acc before epoch 102: 0.925531914893617
Warm optimizer lr: 0.026150883007500007
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.026150883007500007
Val acc before epoch 104: 0.9468085106382979
Stopping after epoch 105.
Final validation accuracy before push: 94.68085106382979%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8285256410256411
	Train Cluster: 0.6577926993370056
	TrainSeparation: 0.5137161016464233
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.001

Attempting combination 31/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.1
p0_warm_ptype_gamma: 0.5
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 10: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.05
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 14: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.05
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 18: 0.9468085106382979
Warm optimizer lr: 0.05
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.025
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.025
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 23: 0.9680851063829787
Warm optimizer lr: 0.025
Val acc before epoch 24: 0.9680851063829787
Warm optimizer lr: 0.025
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.025
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.025
Val acc before epoch 27: 0.9574468085106383
Warm optimizer lr: 0.025
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.025
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 30: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 35: 0.9680851063829787
Warm optimizer lr: 0.0125
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.0125
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.0125
Val acc before epoch 38: 0.9148936170212766
Warm optimizer lr: 0.0125
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.00625
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 43: 0.9574468085106383
Warm optimizer lr: 0.00625
Val acc before epoch 44: 0.9680851063829787
Warm optimizer lr: 0.00625
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.00625
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.00625
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 50: 0.9680851063829787
Warm optimizer lr: 0.003125
Val acc before epoch 51: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.003125
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.003125
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 57: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.003125
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.0015625
Val acc before epoch 62: 0.9574468085106383
Warm optimizer lr: 0.0015625
Val acc before epoch 63: 0.9680851063829787
Warm optimizer lr: 0.0015625
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.0015625
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.0015625
Val acc before epoch 66: 0.9042553191489362
Warm optimizer lr: 0.0015625
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.0015625
Val acc before epoch 69: 0.9468085106382979
Warm optimizer lr: 0.00078125
Val acc before epoch 70: 0.9361702127659575
Push epoch at epoch 71.
Final validation accuracy before push: 93.61702127659575%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.6446969151496887
	Train Separation: 0.508228850364685
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7021276595744681
Warm optimizer lr: 0.00078125
Val acc before epoch 72: 0.6914893617021277
Warm optimizer lr: 0.00078125
Val acc before epoch 73: 0.7021276595744681
Warm optimizer lr: 0.00078125
Val acc before epoch 74: 0.776595744680851
Warm optimizer lr: 0.00078125
Val acc before epoch 75: 0.7553191489361702
Warm optimizer lr: 0.00078125
Val acc before epoch 76: 0.7659574468085106
Warm optimizer lr: 0.00078125
Val acc before epoch 77: 0.7446808510638298
Warm optimizer lr: 0.00078125
Val acc before epoch 78: 0.723404255319149
Warm optimizer lr: 0.00078125
Val acc before epoch 79: 0.8297872340425532
Warm optimizer lr: 0.00078125
Val acc before epoch 80: 0.7872340425531915
Warm optimizer lr: 0.000390625
Val acc before epoch 81: 0.723404255319149
Warm optimizer lr: 0.000390625
Val acc before epoch 82: 0.7659574468085106
Warm optimizer lr: 0.000390625
Val acc before epoch 83: 0.8404255319148937
Warm optimizer lr: 0.000390625
Val acc before epoch 84: 0.8085106382978723
Warm optimizer lr: 0.000390625
Val acc before epoch 85: 0.7872340425531915
Warm optimizer lr: 0.000390625
Val acc before epoch 86: 0.776595744680851
Warm optimizer lr: 0.000390625
Val acc before epoch 87: 0.7978723404255319
Warm optimizer lr: 0.000390625
Val acc before epoch 88: 0.7978723404255319
Warm optimizer lr: 0.000390625
Val acc before epoch 89: 0.776595744680851
Warm optimizer lr: 0.000390625
Val acc before epoch 90: 0.7872340425531915
Warm optimizer lr: 0.0001953125
Val acc before epoch 91: 0.7978723404255319
Warm optimizer lr: 0.0001953125
Val acc before epoch 92: 0.8191489361702128
Warm optimizer lr: 0.0001953125
Val acc before epoch 93: 0.7872340425531915
Warm optimizer lr: 0.0001953125
Val acc before epoch 94: 0.7553191489361702
Warm optimizer lr: 0.0001953125
Val acc before epoch 95: 0.723404255319149
Warm optimizer lr: 0.0001953125
Val acc before epoch 96: 0.7978723404255319
Warm optimizer lr: 0.0001953125
Val acc before epoch 97: 0.8085106382978723
Warm optimizer lr: 0.0001953125
Val acc before epoch 98: 0.7978723404255319
Warm optimizer lr: 0.0001953125
Val acc before epoch 99: 0.7553191489361702
Warm optimizer lr: 0.0001953125
Val acc before epoch 100: 0.8191489361702128
Warm optimizer lr: 9.765625e-05
Val acc before epoch 101: 0.776595744680851
Warm optimizer lr: 9.765625e-05
Val acc before epoch 102: 0.7978723404255319
Warm optimizer lr: 9.765625e-05
Val acc before epoch 103: 0.8297872340425532
Warm optimizer lr: 9.765625e-05
Val acc before epoch 104: 0.8404255319148937
Stopping after epoch 105.
Final validation accuracy before push: 84.04255319148936%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8253205128205128
	Train Cluster: 0.6409303784370423
	TrainSeparation: 0.5075189530849457
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer
Last layer lr: 0.001

Attempting combination 32/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.1
p0_warm_ptype_gamma: 0.6
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.06
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.06
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.06
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 13: 0.8723404255319149
Warm optimizer lr: 0.06
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.06
Val acc before epoch 15: 0.9148936170212766
Warm optimizer lr: 0.06
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.06
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.06
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.06
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.036
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.036
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.036
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.036
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.036
Val acc before epoch 24: 0.8936170212765957
Warm optimizer lr: 0.036
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.036
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.036
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.036
Val acc before epoch 28: 0.9574468085106383
Warm optimizer lr: 0.036
Val acc before epoch 29: 0.9042553191489362
Warm optimizer lr: 0.021599999999999998
Val acc before epoch 30: 0.8936170212765957
Warm optimizer lr: 0.021599999999999998
Val acc before epoch 31: 0.9148936170212766
Warm optimizer lr: 0.021599999999999998
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.021599999999999998
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.021599999999999998
Val acc before epoch 34: 0.9042553191489362
Warm optimizer lr: 0.021599999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.021599999999999998
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.021599999999999998
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.021599999999999998
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.021599999999999998
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.012959999999999998
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.012959999999999998
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.012959999999999998
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.012959999999999998
Val acc before epoch 43: 0.9148936170212766
Warm optimizer lr: 0.012959999999999998
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.012959999999999998
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.012959999999999998
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.012959999999999998
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.012959999999999998
Val acc before epoch 48: 0.9042553191489362
Warm optimizer lr: 0.012959999999999998
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.007775999999999998
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.007775999999999998
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.007775999999999998
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.007775999999999998
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.007775999999999998
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.007775999999999998
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.007775999999999998
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.007775999999999998
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.007775999999999998
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.007775999999999998
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.004665599999999999
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.004665599999999999
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.004665599999999999
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.004665599999999999
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.004665599999999999
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.004665599999999999
Val acc before epoch 65: 0.8936170212765957
Warm optimizer lr: 0.004665599999999999
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 0.004665599999999999
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 0.004665599999999999
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.004665599999999999
Val acc before epoch 69: 0.9468085106382979
Warm optimizer lr: 0.0027993599999999994
Val acc before epoch 70: 0.9680851063829787
Push epoch at epoch 71.
Final validation accuracy before push: 96.80851063829788%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8125
	Train Cluster: 0.6508888959884643
	Train Separation: 0.5117150664329528
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7021276595744681
Warm optimizer lr: 0.0027993599999999994
Val acc before epoch 72: 0.648936170212766
Warm optimizer lr: 0.0027993599999999994
Val acc before epoch 73: 0.8297872340425532
Warm optimizer lr: 0.0027993599999999994
Val acc before epoch 74: 0.776595744680851
Warm optimizer lr: 0.0027993599999999994
Val acc before epoch 75: 0.8191489361702128
Warm optimizer lr: 0.0027993599999999994
Val acc before epoch 76: 0.8191489361702128
Warm optimizer lr: 0.0027993599999999994
Val acc before epoch 77: 0.8404255319148937
Warm optimizer lr: 0.0027993599999999994
Val acc before epoch 78: 0.8617021276595744
Warm optimizer lr: 0.0027993599999999994
Val acc before epoch 79: 0.8404255319148937
Warm optimizer lr: 0.0027993599999999994
Val acc before epoch 80: 0.8297872340425532
Warm optimizer lr: 0.0016796159999999997
Val acc before epoch 81: 0.8829787234042553
Warm optimizer lr: 0.0016796159999999997
Val acc before epoch 82: 0.8617021276595744
Warm optimizer lr: 0.0016796159999999997
Val acc before epoch 83: 0.8829787234042553
Warm optimizer lr: 0.0016796159999999997
Val acc before epoch 84: 0.9361702127659575
Warm optimizer lr: 0.0016796159999999997
Val acc before epoch 85: 0.8829787234042553
Warm optimizer lr: 0.0016796159999999997
Val acc before epoch 86: 0.8617021276595744
Warm optimizer lr: 0.0016796159999999997
Val acc before epoch 87: 0.8936170212765957
Warm optimizer lr: 0.0016796159999999997
Val acc before epoch 88: 0.9042553191489362
Warm optimizer lr: 0.0016796159999999997
Val acc before epoch 89: 0.8723404255319149
Warm optimizer lr: 0.0016796159999999997
Val acc before epoch 90: 0.8617021276595744
Warm optimizer lr: 0.0010077695999999997
Val acc before epoch 91: 0.8404255319148937
Warm optimizer lr: 0.0010077695999999997
Val acc before epoch 92: 0.8723404255319149
Warm optimizer lr: 0.0010077695999999997
Val acc before epoch 93: 0.8617021276595744
Warm optimizer lr: 0.0010077695999999997
Val acc before epoch 94: 0.8404255319148937
Warm optimizer lr: 0.0010077695999999997
Val acc before epoch 95: 0.9148936170212766
Warm optimizer lr: 0.0010077695999999997
Val acc before epoch 96: 0.9042553191489362
Warm optimizer lr: 0.0010077695999999997
Val acc before epoch 97: 0.8723404255319149
Warm optimizer lr: 0.0010077695999999997
Val acc before epoch 98: 0.9148936170212766
Warm optimizer lr: 0.0010077695999999997
Val acc before epoch 99: 0.851063829787234
Warm optimizer lr: 0.0010077695999999997
Val acc before epoch 100: 0.8829787234042553
Warm optimizer lr: 0.0006046617599999998
Val acc before epoch 101: 0.8829787234042553
Warm optimizer lr: 0.0006046617599999998
Val acc before epoch 102: 0.8936170212765957
Warm optimizer lr: 0.0006046617599999998
Val acc before epoch 103: 0.8829787234042553
Warm optimizer lr: 0.0006046617599999998
Val acc before epoch 104: 0.8617021276595744
Stopping after epoch 105.
Final validation accuracy before push: 86.17021276595744%
Push number 2
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Train Cluster: 0.6420706748962403
	TrainSeparation: 0.5096765577793121
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.001

Attempting combination 33/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.1
p0_warm_ptype_gamma: 0.7
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.5212765957446809
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9361702127659575
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.06999999999999999
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.06999999999999999
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.06999999999999999
Val acc before epoch 12: 0.8617021276595744
Warm optimizer lr: 0.06999999999999999
Val acc before epoch 13: 0.9148936170212766
Warm optimizer lr: 0.06999999999999999
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.06999999999999999
Val acc before epoch 15: 0.8829787234042553
Warm optimizer lr: 0.06999999999999999
Val acc before epoch 16: 0.9361702127659575
Warm optimizer lr: 0.06999999999999999
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.06999999999999999
Val acc before epoch 18: 0.8829787234042553
Warm optimizer lr: 0.06999999999999999
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.048999999999999995
Val acc before epoch 20: 0.8936170212765957
Warm optimizer lr: 0.048999999999999995
Val acc before epoch 21: 0.8936170212765957
Warm optimizer lr: 0.048999999999999995
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.048999999999999995
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.048999999999999995
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.048999999999999995
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.048999999999999995
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.048999999999999995
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.048999999999999995
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.048999999999999995
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.0343
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.0343
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.0343
Val acc before epoch 32: 0.9042553191489362
Warm optimizer lr: 0.0343
Val acc before epoch 33: 0.925531914893617
Warm optimizer lr: 0.0343
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.0343
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.0343
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.0343
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.0343
Val acc before epoch 38: 0.9361702127659575
Warm optimizer lr: 0.0343
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.024009999999999997
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.024009999999999997
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.024009999999999997
Val acc before epoch 42: 0.9680851063829787
Warm optimizer lr: 0.024009999999999997
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.024009999999999997
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.024009999999999997
Val acc before epoch 45: 0.9042553191489362
Warm optimizer lr: 0.024009999999999997
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.024009999999999997
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.024009999999999997
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.024009999999999997
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.016806999999999996
Val acc before epoch 50: 0.925531914893617
Warm optimizer lr: 0.016806999999999996
Val acc before epoch 51: 0.9361702127659575
Warm optimizer lr: 0.016806999999999996
Val acc before epoch 52: 0.925531914893617
Warm optimizer lr: 0.016806999999999996
Val acc before epoch 53: 0.9468085106382979
Warm optimizer lr: 0.016806999999999996
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.016806999999999996
Val acc before epoch 55: 0.925531914893617
Warm optimizer lr: 0.016806999999999996
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.016806999999999996
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.016806999999999996
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.016806999999999996
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.011764899999999997
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.011764899999999997
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.011764899999999997
Val acc before epoch 62: 0.9574468085106383
Warm optimizer lr: 0.011764899999999997
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.011764899999999997
Val acc before epoch 64: 0.9148936170212766
Warm optimizer lr: 0.011764899999999997
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.011764899999999997
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.011764899999999997
Val acc before epoch 67: 0.9148936170212766
Warm optimizer lr: 0.011764899999999997
Val acc before epoch 68: 0.9042553191489362
Warm optimizer lr: 0.011764899999999997
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.008235429999999997
Val acc before epoch 70: 0.9468085106382979
Push epoch at epoch 71.
Final validation accuracy before push: 94.68085106382979%
Push number 1
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Train Cluster: 0.6497102975845337
	Train Separation: 0.5086498200893402
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.6702127659574468
Warm optimizer lr: 0.008235429999999997
Val acc before epoch 72: 0.776595744680851
Warm optimizer lr: 0.008235429999999997
Val acc before epoch 73: 0.8936170212765957
Warm optimizer lr: 0.008235429999999997
Val acc before epoch 74: 0.8723404255319149
Warm optimizer lr: 0.008235429999999997
Val acc before epoch 75: 0.9042553191489362
Warm optimizer lr: 0.008235429999999997
Val acc before epoch 76: 0.8936170212765957
Warm optimizer lr: 0.008235429999999997
Val acc before epoch 77: 0.8936170212765957
Warm optimizer lr: 0.008235429999999997
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.008235429999999997
Val acc before epoch 79: 0.9042553191489362
Warm optimizer lr: 0.008235429999999997
Val acc before epoch 80: 0.8936170212765957
Warm optimizer lr: 0.005764800999999997
Val acc before epoch 81: 0.8936170212765957
Warm optimizer lr: 0.005764800999999997
Val acc before epoch 82: 0.9468085106382979
Warm optimizer lr: 0.005764800999999997
Val acc before epoch 83: 0.8829787234042553
Warm optimizer lr: 0.005764800999999997
Val acc before epoch 84: 0.8936170212765957
Warm optimizer lr: 0.005764800999999997
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.005764800999999997
Val acc before epoch 86: 0.9042553191489362
Warm optimizer lr: 0.005764800999999997
Val acc before epoch 87: 0.9148936170212766
Warm optimizer lr: 0.005764800999999997
Val acc before epoch 88: 0.8936170212765957
Warm optimizer lr: 0.005764800999999997
Val acc before epoch 89: 0.9042553191489362
Warm optimizer lr: 0.005764800999999997
Val acc before epoch 90: 0.9148936170212766
Warm optimizer lr: 0.004035360699999998
Val acc before epoch 91: 0.8936170212765957
Warm optimizer lr: 0.004035360699999998
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.004035360699999998
Val acc before epoch 93: 0.9148936170212766
Warm optimizer lr: 0.004035360699999998
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 0.004035360699999998
Val acc before epoch 95: 0.9148936170212766
Warm optimizer lr: 0.004035360699999998
Val acc before epoch 96: 0.9042553191489362
Warm optimizer lr: 0.004035360699999998
Val acc before epoch 97: 0.925531914893617
Warm optimizer lr: 0.004035360699999998
Val acc before epoch 98: 0.9042553191489362
Warm optimizer lr: 0.004035360699999998
Val acc before epoch 99: 0.9148936170212766
Warm optimizer lr: 0.004035360699999998
Val acc before epoch 100: 0.925531914893617
Warm optimizer lr: 0.0028247524899999983
Val acc before epoch 101: 0.9361702127659575
Warm optimizer lr: 0.0028247524899999983
Val acc before epoch 102: 0.8829787234042553
Warm optimizer lr: 0.0028247524899999983
Val acc before epoch 103: 0.9361702127659575
Warm optimizer lr: 0.0028247524899999983
Val acc before epoch 104: 0.925531914893617
Stopping after epoch 105.
Final validation accuracy before push: 92.5531914893617%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8221153846153846
	Train Cluster: 0.6500401973724366
	TrainSeparation: 0.5102793276309967
(Directly after push) Val acc at iteration 0: 0.776595744680851
Retraining last layer
Last layer lr: 0.001

Attempting combination 34/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.1
p0_warm_ptype_gamma: 0.8
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.05319148936170213
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.43617021276595747
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.9042553191489362
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.8617021276595744
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 15: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.08000000000000002
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 21: 0.9574468085106383
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 22: 0.9468085106382979
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.06400000000000002
Val acc before epoch 29: 0.9787234042553191
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 31: 0.9787234042553191
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 35: 0.9574468085106383
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.051200000000000016
Val acc before epoch 39: 0.9574468085106383
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 40: 0.9468085106382979
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 43: 0.9148936170212766
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 0.04096000000000002
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 51: 0.925531914893617
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 58: 0.9042553191489362
Warm optimizer lr: 0.03276800000000001
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 67: 0.9361702127659575
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 68: 0.9361702127659575
Warm optimizer lr: 0.026214400000000013
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 70: 0.9361702127659575
Push epoch at epoch 71.
Final validation accuracy before push: 93.61702127659575%
Push number 1
After push, before retraining last layer:
	Train acc: 0.7900641025641025
	Train Cluster: 0.6471266508102417
	Train Separation: 0.5117798566818237
(Directly after push) Val acc at iteration 0: 0.7659574468085106
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.6914893617021277
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 72: 0.776595744680851
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 73: 0.8829787234042553
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 74: 0.8723404255319149
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 75: 0.9148936170212766
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 76: 0.9042553191489362
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 77: 0.9361702127659575
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 78: 0.9468085106382979
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 79: 0.925531914893617
Warm optimizer lr: 0.02097152000000001
Val acc before epoch 80: 0.9148936170212766
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 81: 0.9148936170212766
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 82: 0.925531914893617
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 83: 0.925531914893617
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 84: 0.9361702127659575
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 85: 0.925531914893617
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 86: 0.9361702127659575
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 87: 0.9148936170212766
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 88: 0.9468085106382979
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 89: 0.9148936170212766
Warm optimizer lr: 0.016777216000000008
Val acc before epoch 90: 0.925531914893617
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 91: 0.9148936170212766
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 93: 0.9148936170212766
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 94: 0.9574468085106383
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 96: 0.9148936170212766
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 97: 0.9042553191489362
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 98: 0.9148936170212766
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 99: 0.9148936170212766
Warm optimizer lr: 0.013421772800000007
Val acc before epoch 100: 0.925531914893617
Warm optimizer lr: 0.010737418240000006
Val acc before epoch 101: 0.9574468085106383
Warm optimizer lr: 0.010737418240000006
Val acc before epoch 102: 0.9361702127659575
Warm optimizer lr: 0.010737418240000006
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.010737418240000006
Val acc before epoch 104: 0.9468085106382979
Stopping after epoch 105.
Final validation accuracy before push: 94.68085106382979%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8141025641025641
	Train Cluster: 0.6540621876716614
	TrainSeparation: 0.5147440314292908
(Directly after push) Val acc at iteration 0: 0.648936170212766
Retraining last layer
Last layer lr: 0.001

Attempting combination 35/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.1
p0_warm_ptype_gamma: 0.9
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.1
Val acc before epoch 1: 0.3617021276595745
Warm optimizer lr: 0.1
Val acc before epoch 2: 0.5851063829787234
Warm optimizer lr: 0.1
Val acc before epoch 3: 0.7872340425531915
Warm optimizer lr: 0.1
Val acc before epoch 4: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 6: 0.925531914893617
Warm optimizer lr: 0.1
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.1
Val acc before epoch 8: 0.9468085106382979
Warm optimizer lr: 0.1
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.09000000000000001
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.09000000000000001
Val acc before epoch 11: 0.8829787234042553
Warm optimizer lr: 0.09000000000000001
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.09000000000000001
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.09000000000000001
Val acc before epoch 14: 0.8936170212765957
Warm optimizer lr: 0.09000000000000001
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.09000000000000001
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.09000000000000001
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.09000000000000001
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.09000000000000001
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.08100000000000002
Val acc before epoch 20: 0.9042553191489362
Warm optimizer lr: 0.08100000000000002
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.08100000000000002
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.08100000000000002
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.08100000000000002
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.08100000000000002
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.08100000000000002
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.08100000000000002
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.08100000000000002
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.08100000000000002
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.07290000000000002
Val acc before epoch 30: 0.925531914893617
Warm optimizer lr: 0.07290000000000002
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.07290000000000002
Val acc before epoch 32: 0.9574468085106383
Warm optimizer lr: 0.07290000000000002
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.07290000000000002
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.07290000000000002
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.07290000000000002
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.07290000000000002
Val acc before epoch 37: 0.9148936170212766
Warm optimizer lr: 0.07290000000000002
Val acc before epoch 38: 0.925531914893617
Warm optimizer lr: 0.07290000000000002
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.06561000000000002
Val acc before epoch 40: 0.9680851063829787
Warm optimizer lr: 0.06561000000000002
Val acc before epoch 41: 0.9042553191489362
Warm optimizer lr: 0.06561000000000002
Val acc before epoch 42: 0.9148936170212766
Warm optimizer lr: 0.06561000000000002
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.06561000000000002
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.06561000000000002
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.06561000000000002
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.06561000000000002
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.06561000000000002
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.06561000000000002
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.05904900000000002
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.05904900000000002
Val acc before epoch 51: 0.9680851063829787
Warm optimizer lr: 0.05904900000000002
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.05904900000000002
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.05904900000000002
Val acc before epoch 54: 0.925531914893617
Warm optimizer lr: 0.05904900000000002
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.05904900000000002
Val acc before epoch 56: 0.925531914893617
Warm optimizer lr: 0.05904900000000002
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.05904900000000002
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.05904900000000002
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.05314410000000002
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.05314410000000002
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.05314410000000002
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.05314410000000002
Val acc before epoch 63: 0.9680851063829787
Warm optimizer lr: 0.05314410000000002
Val acc before epoch 64: 0.9148936170212766
Warm optimizer lr: 0.05314410000000002
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.05314410000000002
Val acc before epoch 66: 0.925531914893617
Warm optimizer lr: 0.05314410000000002
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 0.05314410000000002
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.05314410000000002
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.04782969000000002
Val acc before epoch 70: 0.9361702127659575
Push epoch at epoch 71.
Final validation accuracy before push: 93.61702127659575%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Train Cluster: 0.6507314920425415
	Train Separation: 0.5163545966148376
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.648936170212766
Warm optimizer lr: 0.04782969000000002
Val acc before epoch 72: 0.8297872340425532
Warm optimizer lr: 0.04782969000000002
Val acc before epoch 73: 0.8829787234042553
Warm optimizer lr: 0.04782969000000002
Val acc before epoch 74: 0.9042553191489362
Warm optimizer lr: 0.04782969000000002
Val acc before epoch 75: 0.9468085106382979
Warm optimizer lr: 0.04782969000000002
Val acc before epoch 76: 0.8936170212765957
Warm optimizer lr: 0.04782969000000002
Val acc before epoch 77: 0.9468085106382979
Warm optimizer lr: 0.04782969000000002
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 0.04782969000000002
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.04782969000000002
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.043046721000000024
Val acc before epoch 81: 0.9361702127659575
Warm optimizer lr: 0.043046721000000024
Val acc before epoch 82: 0.9468085106382979
Warm optimizer lr: 0.043046721000000024
Val acc before epoch 83: 0.9148936170212766
Warm optimizer lr: 0.043046721000000024
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 0.043046721000000024
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.043046721000000024
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.043046721000000024
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.043046721000000024
Val acc before epoch 88: 0.925531914893617
Warm optimizer lr: 0.043046721000000024
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 0.043046721000000024
Val acc before epoch 90: 0.9148936170212766
Warm optimizer lr: 0.03874204890000002
Val acc before epoch 91: 0.9574468085106383
Warm optimizer lr: 0.03874204890000002
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.03874204890000002
Val acc before epoch 93: 0.9361702127659575
Warm optimizer lr: 0.03874204890000002
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 0.03874204890000002
Val acc before epoch 95: 0.9361702127659575
Warm optimizer lr: 0.03874204890000002
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.03874204890000002
Val acc before epoch 97: 0.9042553191489362
Warm optimizer lr: 0.03874204890000002
Val acc before epoch 98: 0.8936170212765957
Warm optimizer lr: 0.03874204890000002
Val acc before epoch 99: 0.925531914893617
Warm optimizer lr: 0.03874204890000002
Val acc before epoch 100: 0.9361702127659575
Warm optimizer lr: 0.03486784401000002
Val acc before epoch 101: 0.925531914893617
Warm optimizer lr: 0.03486784401000002
Val acc before epoch 102: 0.9361702127659575
Warm optimizer lr: 0.03486784401000002
Val acc before epoch 103: 0.9148936170212766
Warm optimizer lr: 0.03486784401000002
Val acc before epoch 104: 0.925531914893617
Stopping after epoch 105.
Final validation accuracy before push: 92.5531914893617%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8076923076923077
	Train Cluster: 0.6418344140052795
	TrainSeparation: 0.5038644075393677
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: 0.001

Attempting combination 36/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.25
p0_warm_ptype_gamma: 0.5
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.25
Val acc before epoch 1: 0.5106382978723404
Warm optimizer lr: 0.25
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.25
Val acc before epoch 3: 0.7659574468085106
Warm optimizer lr: 0.25
Val acc before epoch 4: 0.8297872340425532
Warm optimizer lr: 0.25
Val acc before epoch 5: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 6: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.25
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 9: 0.8829787234042553
Warm optimizer lr: 0.125
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.125
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.125
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.125
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.125
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.125
Val acc before epoch 15: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 17: 0.8829787234042553
Warm optimizer lr: 0.125
Val acc before epoch 18: 0.8723404255319149
Warm optimizer lr: 0.125
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.0625
Val acc before epoch 20: 0.8829787234042553
Warm optimizer lr: 0.0625
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.0625
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.0625
Val acc before epoch 23: 0.9468085106382979
Warm optimizer lr: 0.0625
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.0625
Val acc before epoch 25: 0.9148936170212766
Warm optimizer lr: 0.0625
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.0625
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.0625
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.03125
Val acc before epoch 32: 0.9148936170212766
Warm optimizer lr: 0.03125
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.03125
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.03125
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.03125
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 39: 0.9361702127659575
Warm optimizer lr: 0.015625
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.015625
Val acc before epoch 41: 0.925531914893617
Warm optimizer lr: 0.015625
Val acc before epoch 42: 0.9148936170212766
Warm optimizer lr: 0.015625
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.015625
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.015625
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.015625
Val acc before epoch 46: 0.9148936170212766
Warm optimizer lr: 0.015625
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.015625
Val acc before epoch 48: 0.9042553191489362
Warm optimizer lr: 0.015625
Val acc before epoch 49: 0.9787234042553191
Warm optimizer lr: 0.0078125
Val acc before epoch 50: 0.9680851063829787
Warm optimizer lr: 0.0078125
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 52: 0.9148936170212766
Warm optimizer lr: 0.0078125
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.0078125
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 55: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 59: 0.9042553191489362
Warm optimizer lr: 0.00390625
Val acc before epoch 60: 0.9042553191489362
Warm optimizer lr: 0.00390625
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.00390625
Val acc before epoch 62: 0.9042553191489362
Warm optimizer lr: 0.00390625
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.00390625
Val acc before epoch 64: 0.9574468085106383
Warm optimizer lr: 0.00390625
Val acc before epoch 65: 0.9148936170212766
Warm optimizer lr: 0.00390625
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.00390625
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.00390625
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.00390625
Val acc before epoch 69: 0.9468085106382979
Warm optimizer lr: 0.001953125
Val acc before epoch 70: 0.9468085106382979
Push epoch at epoch 71.
Final validation accuracy before push: 94.68085106382979%
Push number 1
After push, before retraining last layer:
	Train acc: 0.7772435897435898
	Train Cluster: 0.6313834547996521
	Train Separation: 0.5033054053783417
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.5851063829787234
Warm optimizer lr: 0.001953125
Val acc before epoch 72: 0.6914893617021277
Warm optimizer lr: 0.001953125
Val acc before epoch 73: 0.7127659574468085
Warm optimizer lr: 0.001953125
Val acc before epoch 74: 0.7872340425531915
Warm optimizer lr: 0.001953125
Val acc before epoch 75: 0.7659574468085106
Warm optimizer lr: 0.001953125
Val acc before epoch 76: 0.7340425531914894
Warm optimizer lr: 0.001953125
Val acc before epoch 77: 0.8297872340425532
Warm optimizer lr: 0.001953125
Val acc before epoch 78: 0.776595744680851
Warm optimizer lr: 0.001953125
Val acc before epoch 79: 0.8404255319148937
Warm optimizer lr: 0.001953125
Val acc before epoch 80: 0.8723404255319149
Warm optimizer lr: 0.0009765625
Val acc before epoch 81: 0.8617021276595744
Warm optimizer lr: 0.0009765625
Val acc before epoch 82: 0.8191489361702128
Warm optimizer lr: 0.0009765625
Val acc before epoch 83: 0.8297872340425532
Warm optimizer lr: 0.0009765625
Val acc before epoch 84: 0.8297872340425532
Warm optimizer lr: 0.0009765625
Val acc before epoch 85: 0.8617021276595744
Warm optimizer lr: 0.0009765625
Val acc before epoch 86: 0.851063829787234
Warm optimizer lr: 0.0009765625
Val acc before epoch 87: 0.8297872340425532
Warm optimizer lr: 0.0009765625
Val acc before epoch 88: 0.8404255319148937
Warm optimizer lr: 0.0009765625
Val acc before epoch 89: 0.8191489361702128
Warm optimizer lr: 0.0009765625
Val acc before epoch 90: 0.9042553191489362
Warm optimizer lr: 0.00048828125
Val acc before epoch 91: 0.8723404255319149
Warm optimizer lr: 0.00048828125
Val acc before epoch 92: 0.8723404255319149
Warm optimizer lr: 0.00048828125
Val acc before epoch 93: 0.8723404255319149
Warm optimizer lr: 0.00048828125
Val acc before epoch 94: 0.8191489361702128
Warm optimizer lr: 0.00048828125
Val acc before epoch 95: 0.8404255319148937
Warm optimizer lr: 0.00048828125
Val acc before epoch 96: 0.851063829787234
Warm optimizer lr: 0.00048828125
Val acc before epoch 97: 0.851063829787234
Warm optimizer lr: 0.00048828125
Val acc before epoch 98: 0.8617021276595744
Warm optimizer lr: 0.00048828125
Val acc before epoch 99: 0.8829787234042553
Warm optimizer lr: 0.00048828125
Val acc before epoch 100: 0.8723404255319149
Warm optimizer lr: 0.000244140625
Val acc before epoch 101: 0.8723404255319149
Warm optimizer lr: 0.000244140625
Val acc before epoch 102: 0.8297872340425532
Warm optimizer lr: 0.000244140625
Val acc before epoch 103: 0.8297872340425532
Warm optimizer lr: 0.000244140625
Val acc before epoch 104: 0.8829787234042553
Stopping after epoch 105.
Final validation accuracy before push: 88.29787234042553%
Push number 2
After push, before retraining last layer:
	Train acc: 0.7676282051282052
	Train Cluster: 0.6327808737754822
	TrainSeparation: 0.5081746339797973
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.001

Attempting combination 37/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.25
p0_warm_ptype_gamma: 0.6
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.25
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 2: 0.648936170212766
Warm optimizer lr: 0.25
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.25
Val acc before epoch 4: 0.8085106382978723
Warm optimizer lr: 0.25
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.25
Val acc before epoch 6: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.15
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 11: 0.9468085106382979
Warm optimizer lr: 0.15
Val acc before epoch 12: 0.9042553191489362
Warm optimizer lr: 0.15
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.15
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.15
Val acc before epoch 18: 0.9148936170212766
Warm optimizer lr: 0.15
Val acc before epoch 19: 0.9680851063829787
Warm optimizer lr: 0.09
Val acc before epoch 20: 0.9468085106382979
Warm optimizer lr: 0.09
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.09
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.09
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.09
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.09
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.09
Val acc before epoch 26: 0.9042553191489362
Warm optimizer lr: 0.09
Val acc before epoch 27: 0.925531914893617
Warm optimizer lr: 0.09
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.09
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.054
Val acc before epoch 30: 0.9468085106382979
Warm optimizer lr: 0.054
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.054
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.054
Val acc before epoch 33: 0.9680851063829787
Warm optimizer lr: 0.054
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.054
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.054
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.054
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.054
Val acc before epoch 38: 0.925531914893617
Warm optimizer lr: 0.054
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.0324
Val acc before epoch 40: 0.9574468085106383
Warm optimizer lr: 0.0324
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.0324
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.0324
Val acc before epoch 43: 0.9148936170212766
Warm optimizer lr: 0.0324
Val acc before epoch 44: 0.925531914893617
Warm optimizer lr: 0.0324
Val acc before epoch 45: 0.9787234042553191
Warm optimizer lr: 0.0324
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.0324
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.0324
Val acc before epoch 48: 0.9361702127659575
Warm optimizer lr: 0.0324
Val acc before epoch 49: 0.9680851063829787
Warm optimizer lr: 0.01944
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.01944
Val acc before epoch 51: 0.9574468085106383
Warm optimizer lr: 0.01944
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.01944
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.01944
Val acc before epoch 54: 0.9148936170212766
Warm optimizer lr: 0.01944
Val acc before epoch 55: 0.9148936170212766
Warm optimizer lr: 0.01944
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.01944
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.01944
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.01944
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.011663999999999999
Val acc before epoch 60: 0.9680851063829787
Warm optimizer lr: 0.011663999999999999
Val acc before epoch 61: 0.9468085106382979
Warm optimizer lr: 0.011663999999999999
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.011663999999999999
Val acc before epoch 63: 0.9680851063829787
Warm optimizer lr: 0.011663999999999999
Val acc before epoch 64: 0.9680851063829787
Warm optimizer lr: 0.011663999999999999
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.011663999999999999
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.011663999999999999
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.011663999999999999
Val acc before epoch 68: 0.9361702127659575
Warm optimizer lr: 0.011663999999999999
Val acc before epoch 69: 0.9680851063829787
Warm optimizer lr: 0.006998399999999999
Val acc before epoch 70: 0.9468085106382979
Push epoch at epoch 71.
Final validation accuracy before push: 94.68085106382979%
Push number 1
After push, before retraining last layer:
	Train acc: 0.7964743589743589
	Train Cluster: 0.6545952439308167
	Train Separation: 0.5156415104866028
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.648936170212766
Warm optimizer lr: 0.006998399999999999
Val acc before epoch 72: 0.6702127659574468
Warm optimizer lr: 0.006998399999999999
Val acc before epoch 73: 0.851063829787234
Warm optimizer lr: 0.006998399999999999
Val acc before epoch 74: 0.8404255319148937
Warm optimizer lr: 0.006998399999999999
Val acc before epoch 75: 0.8404255319148937
Warm optimizer lr: 0.006998399999999999
Val acc before epoch 76: 0.8936170212765957
Warm optimizer lr: 0.006998399999999999
Val acc before epoch 77: 0.8617021276595744
Warm optimizer lr: 0.006998399999999999
Val acc before epoch 78: 0.9042553191489362
Warm optimizer lr: 0.006998399999999999
Val acc before epoch 79: 0.9680851063829787
Warm optimizer lr: 0.006998399999999999
Val acc before epoch 80: 0.8829787234042553
Warm optimizer lr: 0.004199039999999999
Val acc before epoch 81: 0.8829787234042553
Warm optimizer lr: 0.004199039999999999
Val acc before epoch 82: 0.925531914893617
Warm optimizer lr: 0.004199039999999999
Val acc before epoch 83: 0.9042553191489362
Warm optimizer lr: 0.004199039999999999
Val acc before epoch 84: 0.9468085106382979
Warm optimizer lr: 0.004199039999999999
Val acc before epoch 85: 0.8936170212765957
Warm optimizer lr: 0.004199039999999999
Val acc before epoch 86: 0.9042553191489362
Warm optimizer lr: 0.004199039999999999
Val acc before epoch 87: 0.9468085106382979
Warm optimizer lr: 0.004199039999999999
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.004199039999999999
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 0.004199039999999999
Val acc before epoch 90: 0.925531914893617
Warm optimizer lr: 0.0025194239999999997
Val acc before epoch 91: 0.9468085106382979
Warm optimizer lr: 0.0025194239999999997
Val acc before epoch 92: 0.9042553191489362
Warm optimizer lr: 0.0025194239999999997
Val acc before epoch 93: 0.9361702127659575
Warm optimizer lr: 0.0025194239999999997
Val acc before epoch 94: 0.9468085106382979
Warm optimizer lr: 0.0025194239999999997
Val acc before epoch 95: 0.9148936170212766
Warm optimizer lr: 0.0025194239999999997
Val acc before epoch 96: 0.9468085106382979
Warm optimizer lr: 0.0025194239999999997
Val acc before epoch 97: 0.9361702127659575
Warm optimizer lr: 0.0025194239999999997
Val acc before epoch 98: 0.9468085106382979
Warm optimizer lr: 0.0025194239999999997
Val acc before epoch 99: 0.9361702127659575
Warm optimizer lr: 0.0025194239999999997
Val acc before epoch 100: 0.9680851063829787
Warm optimizer lr: 0.0015116543999999998
Val acc before epoch 101: 0.9468085106382979
Warm optimizer lr: 0.0015116543999999998
Val acc before epoch 102: 0.9468085106382979
Warm optimizer lr: 0.0015116543999999998
Val acc before epoch 103: 0.9148936170212766
Warm optimizer lr: 0.0015116543999999998
Val acc before epoch 104: 0.8936170212765957
Stopping after epoch 105.
Final validation accuracy before push: 89.36170212765957%
Push number 2
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Train Cluster: 0.6399114966392517
	TrainSeparation: 0.5084648787975311
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.001

Attempting combination 38/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.25
p0_warm_ptype_gamma: 0.7
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.25
Val acc before epoch 1: 0.4574468085106383
Warm optimizer lr: 0.25
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.25
Val acc before epoch 3: 0.7021276595744681
Warm optimizer lr: 0.25
Val acc before epoch 4: 0.7872340425531915
Warm optimizer lr: 0.25
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.25
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.25
Val acc before epoch 7: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 9: 0.925531914893617
Warm optimizer lr: 0.175
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.175
Val acc before epoch 11: 0.925531914893617
Warm optimizer lr: 0.175
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.175
Val acc before epoch 13: 0.8829787234042553
Warm optimizer lr: 0.175
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.175
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.175
Val acc before epoch 16: 0.9361702127659575
Warm optimizer lr: 0.175
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.175
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.175
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.12249999999999998
Val acc before epoch 20: 0.9148936170212766
Warm optimizer lr: 0.12249999999999998
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.12249999999999998
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.12249999999999998
Val acc before epoch 23: 0.925531914893617
Warm optimizer lr: 0.12249999999999998
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.12249999999999998
Val acc before epoch 25: 0.9680851063829787
Warm optimizer lr: 0.12249999999999998
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.12249999999999998
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.12249999999999998
Val acc before epoch 28: 0.9361702127659575
Warm optimizer lr: 0.12249999999999998
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.08574999999999998
Val acc before epoch 30: 0.9361702127659575
Warm optimizer lr: 0.08574999999999998
Val acc before epoch 31: 0.9787234042553191
Warm optimizer lr: 0.08574999999999998
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.08574999999999998
Val acc before epoch 33: 0.9468085106382979
Warm optimizer lr: 0.08574999999999998
Val acc before epoch 34: 0.9680851063829787
Warm optimizer lr: 0.08574999999999998
Val acc before epoch 35: 0.9148936170212766
Warm optimizer lr: 0.08574999999999998
Val acc before epoch 36: 0.9468085106382979
Warm optimizer lr: 0.08574999999999998
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.08574999999999998
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.08574999999999998
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.06002499999999998
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.06002499999999998
Val acc before epoch 41: 0.9574468085106383
Warm optimizer lr: 0.06002499999999998
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.06002499999999998
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.06002499999999998
Val acc before epoch 44: 0.9468085106382979
Warm optimizer lr: 0.06002499999999998
Val acc before epoch 45: 0.9574468085106383
Warm optimizer lr: 0.06002499999999998
Val acc before epoch 46: 0.925531914893617
Warm optimizer lr: 0.06002499999999998
Val acc before epoch 47: 0.9787234042553191
Warm optimizer lr: 0.06002499999999998
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.06002499999999998
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.042017499999999985
Val acc before epoch 50: 0.9680851063829787
Warm optimizer lr: 0.042017499999999985
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.042017499999999985
Val acc before epoch 52: 0.9787234042553191
Warm optimizer lr: 0.042017499999999985
Val acc before epoch 53: 0.9680851063829787
Warm optimizer lr: 0.042017499999999985
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.042017499999999985
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.042017499999999985
Val acc before epoch 56: 0.9574468085106383
Warm optimizer lr: 0.042017499999999985
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.042017499999999985
Val acc before epoch 58: 0.925531914893617
Warm optimizer lr: 0.042017499999999985
Val acc before epoch 59: 0.9787234042553191
Warm optimizer lr: 0.029412249999999987
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.029412249999999987
Val acc before epoch 61: 0.925531914893617
Warm optimizer lr: 0.029412249999999987
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.029412249999999987
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.029412249999999987
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.029412249999999987
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.029412249999999987
Val acc before epoch 66: 0.9680851063829787
Warm optimizer lr: 0.029412249999999987
Val acc before epoch 67: 0.9893617021276596
Warm optimizer lr: 0.029412249999999987
Val acc before epoch 68: 0.9680851063829787
Warm optimizer lr: 0.029412249999999987
Val acc before epoch 69: 0.9468085106382979
Warm optimizer lr: 0.02058857499999999
Val acc before epoch 70: 0.9574468085106383
Push epoch at epoch 71.
Final validation accuracy before push: 95.74468085106383%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8092948717948718
	Train Cluster: 0.6438868522644043
	Train Separation: 0.5133594751358033
(Directly after push) Val acc at iteration 0: 0.6808510638297872
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.6382978723404256
Warm optimizer lr: 0.02058857499999999
Val acc before epoch 72: 0.8085106382978723
Warm optimizer lr: 0.02058857499999999
Val acc before epoch 73: 0.8297872340425532
Warm optimizer lr: 0.02058857499999999
Val acc before epoch 74: 0.9042553191489362
Warm optimizer lr: 0.02058857499999999
Val acc before epoch 75: 0.9042553191489362
Warm optimizer lr: 0.02058857499999999
Val acc before epoch 76: 0.9574468085106383
Warm optimizer lr: 0.02058857499999999
Val acc before epoch 77: 0.9148936170212766
Warm optimizer lr: 0.02058857499999999
Val acc before epoch 78: 0.9574468085106383
Warm optimizer lr: 0.02058857499999999
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.02058857499999999
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.014412002499999993
Val acc before epoch 81: 0.9468085106382979
Warm optimizer lr: 0.014412002499999993
Val acc before epoch 82: 0.9361702127659575
Warm optimizer lr: 0.014412002499999993
Val acc before epoch 83: 0.9148936170212766
Warm optimizer lr: 0.014412002499999993
Val acc before epoch 84: 0.9361702127659575
Warm optimizer lr: 0.014412002499999993
Val acc before epoch 85: 0.925531914893617
Warm optimizer lr: 0.014412002499999993
Val acc before epoch 86: 0.9468085106382979
Warm optimizer lr: 0.014412002499999993
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.014412002499999993
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 0.014412002499999993
Val acc before epoch 89: 0.9361702127659575
Warm optimizer lr: 0.014412002499999993
Val acc before epoch 90: 0.9787234042553191
Warm optimizer lr: 0.010088401749999995
Val acc before epoch 91: 0.9787234042553191
Warm optimizer lr: 0.010088401749999995
Val acc before epoch 92: 0.9574468085106383
Warm optimizer lr: 0.010088401749999995
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 0.010088401749999995
Val acc before epoch 94: 0.9680851063829787
Warm optimizer lr: 0.010088401749999995
Val acc before epoch 95: 0.9468085106382979
Warm optimizer lr: 0.010088401749999995
Val acc before epoch 96: 0.9574468085106383
Warm optimizer lr: 0.010088401749999995
Val acc before epoch 97: 0.925531914893617
Warm optimizer lr: 0.010088401749999995
Val acc before epoch 98: 0.9787234042553191
Warm optimizer lr: 0.010088401749999995
Val acc before epoch 99: 0.9361702127659575
Warm optimizer lr: 0.010088401749999995
Val acc before epoch 100: 0.9574468085106383
Warm optimizer lr: 0.007061881224999996
Val acc before epoch 101: 0.9574468085106383
Warm optimizer lr: 0.007061881224999996
Val acc before epoch 102: 0.9787234042553191
Warm optimizer lr: 0.007061881224999996
Val acc before epoch 103: 0.9787234042553191
Warm optimizer lr: 0.007061881224999996
Val acc before epoch 104: 0.9787234042553191
Stopping after epoch 105.
Final validation accuracy before push: 97.87234042553192%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8157051282051282
	Train Cluster: 0.6292787432670593
	TrainSeparation: 0.5027163624763489
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.001

Attempting combination 39/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.25
p0_warm_ptype_gamma: 0.8
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.25
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.25
Val acc before epoch 2: 0.6702127659574468
Warm optimizer lr: 0.25
Val acc before epoch 3: 0.8085106382978723
Warm optimizer lr: 0.25
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.25
Val acc before epoch 5: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.25
Val acc before epoch 7: 0.925531914893617
Warm optimizer lr: 0.25
Val acc before epoch 8: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 9: 0.9361702127659575
Warm optimizer lr: 0.2
Val acc before epoch 10: 0.9148936170212766
Warm optimizer lr: 0.2
Val acc before epoch 11: 0.9361702127659575
Warm optimizer lr: 0.2
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.2
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.2
Val acc before epoch 14: 0.925531914893617
Warm optimizer lr: 0.2
Val acc before epoch 15: 0.9468085106382979
Warm optimizer lr: 0.2
Val acc before epoch 16: 0.9468085106382979
Warm optimizer lr: 0.2
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.2
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.2
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.16000000000000003
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.16000000000000003
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.16000000000000003
Val acc before epoch 22: 0.9680851063829787
Warm optimizer lr: 0.16000000000000003
Val acc before epoch 23: 0.9361702127659575
Warm optimizer lr: 0.16000000000000003
Val acc before epoch 24: 0.925531914893617
Warm optimizer lr: 0.16000000000000003
Val acc before epoch 25: 0.9574468085106383
Warm optimizer lr: 0.16000000000000003
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.16000000000000003
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.16000000000000003
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.16000000000000003
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.12800000000000003
Val acc before epoch 30: 0.9787234042553191
Warm optimizer lr: 0.12800000000000003
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.12800000000000003
Val acc before epoch 32: 0.9468085106382979
Warm optimizer lr: 0.12800000000000003
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.12800000000000003
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.12800000000000003
Val acc before epoch 35: 0.9468085106382979
Warm optimizer lr: 0.12800000000000003
Val acc before epoch 36: 0.9361702127659575
Warm optimizer lr: 0.12800000000000003
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.12800000000000003
Val acc before epoch 38: 0.9468085106382979
Warm optimizer lr: 0.12800000000000003
Val acc before epoch 39: 0.925531914893617
Warm optimizer lr: 0.10240000000000003
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.10240000000000003
Val acc before epoch 41: 0.9680851063829787
Warm optimizer lr: 0.10240000000000003
Val acc before epoch 42: 0.9680851063829787
Warm optimizer lr: 0.10240000000000003
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 0.10240000000000003
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.10240000000000003
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.10240000000000003
Val acc before epoch 46: 0.9468085106382979
Warm optimizer lr: 0.10240000000000003
Val acc before epoch 47: 0.9361702127659575
Warm optimizer lr: 0.10240000000000003
Val acc before epoch 48: 0.9574468085106383
Warm optimizer lr: 0.10240000000000003
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.08192000000000003
Val acc before epoch 50: 0.9787234042553191
Warm optimizer lr: 0.08192000000000003
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.08192000000000003
Val acc before epoch 52: 0.9042553191489362
Warm optimizer lr: 0.08192000000000003
Val acc before epoch 53: 0.9680851063829787
Warm optimizer lr: 0.08192000000000003
Val acc before epoch 54: 0.9680851063829787
Warm optimizer lr: 0.08192000000000003
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.08192000000000003
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.08192000000000003
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.08192000000000003
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.08192000000000003
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.06553600000000002
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.06553600000000002
Val acc before epoch 61: 0.9148936170212766
Warm optimizer lr: 0.06553600000000002
Val acc before epoch 62: 0.8936170212765957
Warm optimizer lr: 0.06553600000000002
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.06553600000000002
Val acc before epoch 64: 0.9680851063829787
Warm optimizer lr: 0.06553600000000002
Val acc before epoch 65: 0.9680851063829787
Warm optimizer lr: 0.06553600000000002
Val acc before epoch 66: 0.9680851063829787
Warm optimizer lr: 0.06553600000000002
Val acc before epoch 67: 0.9787234042553191
Warm optimizer lr: 0.06553600000000002
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.06553600000000002
Val acc before epoch 69: 0.9361702127659575
Warm optimizer lr: 0.052428800000000025
Val acc before epoch 70: 0.9574468085106383
Push epoch at epoch 71.
Final validation accuracy before push: 95.74468085106383%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Train Cluster: 0.6462089538574218
	Train Separation: 0.5105853319168091
(Directly after push) Val acc at iteration 0: 0.723404255319149
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.776595744680851
Warm optimizer lr: 0.052428800000000025
Val acc before epoch 72: 0.9148936170212766
Warm optimizer lr: 0.052428800000000025
Val acc before epoch 73: 0.8829787234042553
Warm optimizer lr: 0.052428800000000025
Val acc before epoch 74: 0.8829787234042553
Warm optimizer lr: 0.052428800000000025
Val acc before epoch 75: 0.9574468085106383
Warm optimizer lr: 0.052428800000000025
Val acc before epoch 76: 0.9042553191489362
Warm optimizer lr: 0.052428800000000025
Val acc before epoch 77: 0.9361702127659575
Warm optimizer lr: 0.052428800000000025
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 0.052428800000000025
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.052428800000000025
Val acc before epoch 80: 0.9361702127659575
Warm optimizer lr: 0.04194304000000002
Val acc before epoch 81: 0.9574468085106383
Warm optimizer lr: 0.04194304000000002
Val acc before epoch 82: 0.9468085106382979
Warm optimizer lr: 0.04194304000000002
Val acc before epoch 83: 0.9787234042553191
Warm optimizer lr: 0.04194304000000002
Val acc before epoch 84: 0.9468085106382979
Warm optimizer lr: 0.04194304000000002
Val acc before epoch 85: 0.9680851063829787
Warm optimizer lr: 0.04194304000000002
Val acc before epoch 86: 0.9787234042553191
Warm optimizer lr: 0.04194304000000002
Val acc before epoch 87: 0.9468085106382979
Warm optimizer lr: 0.04194304000000002
Val acc before epoch 88: 0.9574468085106383
Warm optimizer lr: 0.04194304000000002
Val acc before epoch 89: 0.9680851063829787
Warm optimizer lr: 0.04194304000000002
Val acc before epoch 90: 0.9574468085106383
Warm optimizer lr: 0.033554432000000016
Val acc before epoch 91: 0.9574468085106383
Warm optimizer lr: 0.033554432000000016
Val acc before epoch 92: 0.9787234042553191
Warm optimizer lr: 0.033554432000000016
Val acc before epoch 93: 0.9787234042553191
Warm optimizer lr: 0.033554432000000016
Val acc before epoch 94: 0.9468085106382979
Warm optimizer lr: 0.033554432000000016
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 0.033554432000000016
Val acc before epoch 96: 0.9680851063829787
Warm optimizer lr: 0.033554432000000016
Val acc before epoch 97: 0.9574468085106383
Warm optimizer lr: 0.033554432000000016
Val acc before epoch 98: 0.9787234042553191
Warm optimizer lr: 0.033554432000000016
Val acc before epoch 99: 0.925531914893617
Warm optimizer lr: 0.033554432000000016
Val acc before epoch 100: 0.9468085106382979
Warm optimizer lr: 0.026843545600000015
Val acc before epoch 101: 0.9574468085106383
Warm optimizer lr: 0.026843545600000015
Val acc before epoch 102: 0.9468085106382979
Warm optimizer lr: 0.026843545600000015
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.026843545600000015
Val acc before epoch 104: 0.9574468085106383
Stopping after epoch 105.
Final validation accuracy before push: 95.74468085106383%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8221153846153846
	Train Cluster: 0.6501689910888672
	TrainSeparation: 0.5103238582611084
(Directly after push) Val acc at iteration 0: 0.8297872340425532
Retraining last layer
Last layer lr: 0.001

Attempting combination 40/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.25
p0_warm_ptype_gamma: 0.9
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.25
Val acc before epoch 1: 0.425531914893617
Warm optimizer lr: 0.25
Val acc before epoch 2: 0.6914893617021277
Warm optimizer lr: 0.25
Val acc before epoch 3: 0.7553191489361702
Warm optimizer lr: 0.25
Val acc before epoch 4: 0.7446808510638298
Warm optimizer lr: 0.25
Val acc before epoch 5: 0.776595744680851
Warm optimizer lr: 0.25
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.25
Val acc before epoch 7: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.225
Val acc before epoch 10: 0.8723404255319149
Warm optimizer lr: 0.225
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.225
Val acc before epoch 12: 0.8723404255319149
Warm optimizer lr: 0.225
Val acc before epoch 13: 0.9361702127659575
Warm optimizer lr: 0.225
Val acc before epoch 14: 0.9042553191489362
Warm optimizer lr: 0.225
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.225
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.225
Val acc before epoch 17: 0.925531914893617
Warm optimizer lr: 0.225
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.225
Val acc before epoch 19: 0.9148936170212766
Warm optimizer lr: 0.2025
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.2025
Val acc before epoch 21: 0.9468085106382979
Warm optimizer lr: 0.2025
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.2025
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.2025
Val acc before epoch 24: 0.9042553191489362
Warm optimizer lr: 0.2025
Val acc before epoch 25: 0.8936170212765957
Warm optimizer lr: 0.2025
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.2025
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.2025
Val acc before epoch 28: 0.925531914893617
Warm optimizer lr: 0.2025
Val acc before epoch 29: 0.9787234042553191
Warm optimizer lr: 0.18225000000000002
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.18225000000000002
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.18225000000000002
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.18225000000000002
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.18225000000000002
Val acc before epoch 34: 0.9148936170212766
Warm optimizer lr: 0.18225000000000002
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.18225000000000002
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.18225000000000002
Val acc before epoch 37: 0.9574468085106383
Warm optimizer lr: 0.18225000000000002
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.18225000000000002
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.16402500000000003
Val acc before epoch 40: 0.9574468085106383
Warm optimizer lr: 0.16402500000000003
Val acc before epoch 41: 0.9468085106382979
Warm optimizer lr: 0.16402500000000003
Val acc before epoch 42: 0.9361702127659575
Warm optimizer lr: 0.16402500000000003
Val acc before epoch 43: 0.9148936170212766
Warm optimizer lr: 0.16402500000000003
Val acc before epoch 44: 0.9574468085106383
Warm optimizer lr: 0.16402500000000003
Val acc before epoch 45: 0.9574468085106383
Warm optimizer lr: 0.16402500000000003
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.16402500000000003
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.16402500000000003
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.16402500000000003
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.14762250000000005
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.14762250000000005
Val acc before epoch 51: 0.9574468085106383
Warm optimizer lr: 0.14762250000000005
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.14762250000000005
Val acc before epoch 53: 0.9361702127659575
Warm optimizer lr: 0.14762250000000005
Val acc before epoch 54: 0.9148936170212766
Warm optimizer lr: 0.14762250000000005
Val acc before epoch 55: 0.9787234042553191
Warm optimizer lr: 0.14762250000000005
Val acc before epoch 56: 0.9787234042553191
Warm optimizer lr: 0.14762250000000005
Val acc before epoch 57: 0.925531914893617
Warm optimizer lr: 0.14762250000000005
Val acc before epoch 58: 0.9468085106382979
Warm optimizer lr: 0.14762250000000005
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.13286025000000004
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.13286025000000004
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.13286025000000004
Val acc before epoch 62: 0.9361702127659575
Warm optimizer lr: 0.13286025000000004
Val acc before epoch 63: 0.9361702127659575
Warm optimizer lr: 0.13286025000000004
Val acc before epoch 64: 0.9468085106382979
Warm optimizer lr: 0.13286025000000004
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.13286025000000004
Val acc before epoch 66: 0.9680851063829787
Warm optimizer lr: 0.13286025000000004
Val acc before epoch 67: 0.9574468085106383
Warm optimizer lr: 0.13286025000000004
Val acc before epoch 68: 0.9680851063829787
Warm optimizer lr: 0.13286025000000004
Val acc before epoch 69: 0.9468085106382979
Warm optimizer lr: 0.11957422500000003
Val acc before epoch 70: 0.9574468085106383
Push epoch at epoch 71.
Final validation accuracy before push: 95.74468085106383%
Push number 1
After push, before retraining last layer:
	Train acc: 0.7996794871794872
	Train Cluster: 0.6550418734550476
	Train Separation: 0.5102660298347473
(Directly after push) Val acc at iteration 0: 0.6382978723404256
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.723404255319149
Warm optimizer lr: 0.11957422500000003
Val acc before epoch 72: 0.851063829787234
Warm optimizer lr: 0.11957422500000003
Val acc before epoch 73: 0.8617021276595744
Warm optimizer lr: 0.11957422500000003
Val acc before epoch 74: 0.9148936170212766
Warm optimizer lr: 0.11957422500000003
Val acc before epoch 75: 0.8829787234042553
Warm optimizer lr: 0.11957422500000003
Val acc before epoch 76: 0.9361702127659575
Warm optimizer lr: 0.11957422500000003
Val acc before epoch 77: 0.9148936170212766
Warm optimizer lr: 0.11957422500000003
Val acc before epoch 78: 0.925531914893617
Warm optimizer lr: 0.11957422500000003
Val acc before epoch 79: 0.9148936170212766
Warm optimizer lr: 0.11957422500000003
Val acc before epoch 80: 0.9148936170212766
Warm optimizer lr: 0.10761680250000004
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.10761680250000004
Val acc before epoch 82: 0.925531914893617
Warm optimizer lr: 0.10761680250000004
Val acc before epoch 83: 0.925531914893617
Warm optimizer lr: 0.10761680250000004
Val acc before epoch 84: 0.8829787234042553
Warm optimizer lr: 0.10761680250000004
Val acc before epoch 85: 0.8936170212765957
Warm optimizer lr: 0.10761680250000004
Val acc before epoch 86: 0.925531914893617
Warm optimizer lr: 0.10761680250000004
Val acc before epoch 87: 0.9468085106382979
Warm optimizer lr: 0.10761680250000004
Val acc before epoch 88: 0.925531914893617
Warm optimizer lr: 0.10761680250000004
Val acc before epoch 89: 0.9680851063829787
Warm optimizer lr: 0.10761680250000004
Val acc before epoch 90: 0.9148936170212766
Warm optimizer lr: 0.09685512225000004
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.09685512225000004
Val acc before epoch 92: 0.9361702127659575
Warm optimizer lr: 0.09685512225000004
Val acc before epoch 93: 0.925531914893617
Warm optimizer lr: 0.09685512225000004
Val acc before epoch 94: 0.9361702127659575
Warm optimizer lr: 0.09685512225000004
Val acc before epoch 95: 0.9468085106382979
Warm optimizer lr: 0.09685512225000004
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.09685512225000004
Val acc before epoch 97: 0.9148936170212766
Warm optimizer lr: 0.09685512225000004
Val acc before epoch 98: 0.9468085106382979
Warm optimizer lr: 0.09685512225000004
Val acc before epoch 99: 0.9574468085106383
Warm optimizer lr: 0.09685512225000004
Val acc before epoch 100: 0.8936170212765957
Warm optimizer lr: 0.08716961002500004
Val acc before epoch 101: 0.9574468085106383
Warm optimizer lr: 0.08716961002500004
Val acc before epoch 102: 0.9148936170212766
Warm optimizer lr: 0.08716961002500004
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.08716961002500004
Val acc before epoch 104: 0.9361702127659575
Stopping after epoch 105.
Final validation accuracy before push: 93.61702127659575%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8012820512820513
	Train Cluster: 0.6429295539855957
	TrainSeparation: 0.507072651386261
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer
Last layer lr: 0.001

Attempting combination 41/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.5
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.02127659574468085
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5531914893617021
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.7340425531914894
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.8191489361702128
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8191489361702128
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 8: 0.8723404255319149
Warm optimizer lr: 0.5
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 10: 0.8617021276595744
Warm optimizer lr: 0.25
Val acc before epoch 11: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 12: 0.8723404255319149
Warm optimizer lr: 0.25
Val acc before epoch 13: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.25
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.25
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.25
Val acc before epoch 19: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.125
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 22: 0.9042553191489362
Warm optimizer lr: 0.125
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.125
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.125
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 26: 0.8936170212765957
Warm optimizer lr: 0.125
Val acc before epoch 27: 0.9148936170212766
Warm optimizer lr: 0.125
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.125
Val acc before epoch 29: 0.925531914893617
Warm optimizer lr: 0.0625
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.0625
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.0625
Val acc before epoch 34: 0.9468085106382979
Warm optimizer lr: 0.0625
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.0625
Val acc before epoch 36: 0.9574468085106383
Warm optimizer lr: 0.0625
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.0625
Val acc before epoch 38: 0.9787234042553191
Warm optimizer lr: 0.0625
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.03125
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.03125
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 44: 0.9787234042553191
Warm optimizer lr: 0.03125
Val acc before epoch 45: 0.9361702127659575
Warm optimizer lr: 0.03125
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.03125
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.03125
Val acc before epoch 48: 0.9680851063829787
Warm optimizer lr: 0.03125
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.015625
Val acc before epoch 50: 0.925531914893617
Warm optimizer lr: 0.015625
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.015625
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.015625
Val acc before epoch 53: 0.9574468085106383
Warm optimizer lr: 0.015625
Val acc before epoch 54: 0.9361702127659575
Warm optimizer lr: 0.015625
Val acc before epoch 55: 0.9787234042553191
Warm optimizer lr: 0.015625
Val acc before epoch 56: 0.9787234042553191
Warm optimizer lr: 0.015625
Val acc before epoch 57: 0.9468085106382979
Warm optimizer lr: 0.015625
Val acc before epoch 58: 0.9574468085106383
Warm optimizer lr: 0.015625
Val acc before epoch 59: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.0078125
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.0078125
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 64: 0.9680851063829787
Warm optimizer lr: 0.0078125
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.0078125
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.0078125
Val acc before epoch 67: 0.925531914893617
Warm optimizer lr: 0.0078125
Val acc before epoch 68: 0.925531914893617
Warm optimizer lr: 0.0078125
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.00390625
Val acc before epoch 70: 0.9574468085106383
Push epoch at epoch 71.
Final validation accuracy before push: 95.74468085106383%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8092948717948718
	Train Cluster: 0.6376499652862548
	Train Separation: 0.5084536612033844
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7127659574468085
Warm optimizer lr: 0.00390625
Val acc before epoch 72: 0.7978723404255319
Warm optimizer lr: 0.00390625
Val acc before epoch 73: 0.776595744680851
Warm optimizer lr: 0.00390625
Val acc before epoch 74: 0.7978723404255319
Warm optimizer lr: 0.00390625
Val acc before epoch 75: 0.8723404255319149
Warm optimizer lr: 0.00390625
Val acc before epoch 76: 0.776595744680851
Warm optimizer lr: 0.00390625
Val acc before epoch 77: 0.8191489361702128
Warm optimizer lr: 0.00390625
Val acc before epoch 78: 0.851063829787234
Warm optimizer lr: 0.00390625
Val acc before epoch 79: 0.851063829787234
Warm optimizer lr: 0.00390625
Val acc before epoch 80: 0.8617021276595744
Warm optimizer lr: 0.001953125
Val acc before epoch 81: 0.8936170212765957
Warm optimizer lr: 0.001953125
Val acc before epoch 82: 0.851063829787234
Warm optimizer lr: 0.001953125
Val acc before epoch 83: 0.8404255319148937
Warm optimizer lr: 0.001953125
Val acc before epoch 84: 0.851063829787234
Warm optimizer lr: 0.001953125
Val acc before epoch 85: 0.8617021276595744
Warm optimizer lr: 0.001953125
Val acc before epoch 86: 0.851063829787234
Warm optimizer lr: 0.001953125
Val acc before epoch 87: 0.8617021276595744
Warm optimizer lr: 0.001953125
Val acc before epoch 88: 0.8723404255319149
Warm optimizer lr: 0.001953125
Val acc before epoch 89: 0.8936170212765957
Warm optimizer lr: 0.001953125
Val acc before epoch 90: 0.8936170212765957
Warm optimizer lr: 0.0009765625
Val acc before epoch 91: 0.851063829787234
Warm optimizer lr: 0.0009765625
Val acc before epoch 92: 0.8829787234042553
Warm optimizer lr: 0.0009765625
Val acc before epoch 93: 0.8617021276595744
Warm optimizer lr: 0.0009765625
Val acc before epoch 94: 0.8936170212765957
Warm optimizer lr: 0.0009765625
Val acc before epoch 95: 0.8617021276595744
Warm optimizer lr: 0.0009765625
Val acc before epoch 96: 0.8936170212765957
Warm optimizer lr: 0.0009765625
Val acc before epoch 97: 0.925531914893617
Warm optimizer lr: 0.0009765625
Val acc before epoch 98: 0.8936170212765957
Warm optimizer lr: 0.0009765625
Val acc before epoch 99: 0.8829787234042553
Warm optimizer lr: 0.0009765625
Val acc before epoch 100: 0.9042553191489362
Warm optimizer lr: 0.00048828125
Val acc before epoch 101: 0.851063829787234
Warm optimizer lr: 0.00048828125
Val acc before epoch 102: 0.8617021276595744
Warm optimizer lr: 0.00048828125
Val acc before epoch 103: 0.9042553191489362
Warm optimizer lr: 0.00048828125
Val acc before epoch 104: 0.8936170212765957
Stopping after epoch 105.
Final validation accuracy before push: 89.36170212765957%
Push number 2
After push, before retraining last layer:
	Train acc: 0.7692307692307693
	Train Cluster: 0.634878420829773
	TrainSeparation: 0.5068196415901184
(Directly after push) Val acc at iteration 0: 0.7127659574468085
Retraining last layer
Last layer lr: 0.001

Attempting combination 42/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.6
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.4787234042553192
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.7021276595744681
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.776595744680851
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8617021276595744
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 8: 0.9148936170212766
Warm optimizer lr: 0.5
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.3
Val acc before epoch 10: 0.925531914893617
Warm optimizer lr: 0.3
Val acc before epoch 11: 0.9468085106382979
Warm optimizer lr: 0.3
Val acc before epoch 12: 0.9361702127659575
Warm optimizer lr: 0.3
Val acc before epoch 13: 0.925531914893617
Warm optimizer lr: 0.3
Val acc before epoch 14: 0.9361702127659575
Warm optimizer lr: 0.3
Val acc before epoch 15: 0.9468085106382979
Warm optimizer lr: 0.3
Val acc before epoch 16: 0.9361702127659575
Warm optimizer lr: 0.3
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.3
Val acc before epoch 18: 0.9361702127659575
Warm optimizer lr: 0.3
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.18
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.18
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.18
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.18
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.18
Val acc before epoch 24: 0.9148936170212766
Warm optimizer lr: 0.18
Val acc before epoch 25: 0.9468085106382979
Warm optimizer lr: 0.18
Val acc before epoch 26: 0.9574468085106383
Warm optimizer lr: 0.18
Val acc before epoch 27: 0.9468085106382979
Warm optimizer lr: 0.18
Val acc before epoch 28: 0.9468085106382979
Warm optimizer lr: 0.18
Val acc before epoch 29: 0.9574468085106383
Warm optimizer lr: 0.108
Val acc before epoch 30: 0.9680851063829787
Warm optimizer lr: 0.108
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.108
Val acc before epoch 32: 0.9574468085106383
Warm optimizer lr: 0.108
Val acc before epoch 33: 0.9680851063829787
Warm optimizer lr: 0.108
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.108
Val acc before epoch 35: 0.9680851063829787
Warm optimizer lr: 0.108
Val acc before epoch 36: 0.9787234042553191
Warm optimizer lr: 0.108
Val acc before epoch 37: 0.9468085106382979
Warm optimizer lr: 0.108
Val acc before epoch 38: 0.9574468085106383
Warm optimizer lr: 0.108
Val acc before epoch 39: 0.9680851063829787
Warm optimizer lr: 0.0648
Val acc before epoch 40: 0.925531914893617
Warm optimizer lr: 0.0648
Val acc before epoch 41: 0.9148936170212766
Warm optimizer lr: 0.0648
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.0648
Val acc before epoch 43: 0.9787234042553191
Warm optimizer lr: 0.0648
Val acc before epoch 44: 0.9574468085106383
Warm optimizer lr: 0.0648
Val acc before epoch 45: 0.9574468085106383
Warm optimizer lr: 0.0648
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.0648
Val acc before epoch 47: 0.9468085106382979
Warm optimizer lr: 0.0648
Val acc before epoch 48: 0.9680851063829787
Warm optimizer lr: 0.0648
Val acc before epoch 49: 0.9574468085106383
Warm optimizer lr: 0.03888
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.03888
Val acc before epoch 51: 0.9574468085106383
Warm optimizer lr: 0.03888
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.03888
Val acc before epoch 53: 0.9680851063829787
Warm optimizer lr: 0.03888
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.03888
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.03888
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.03888
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.03888
Val acc before epoch 58: 0.9680851063829787
Warm optimizer lr: 0.03888
Val acc before epoch 59: 0.9574468085106383
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 60: 0.9574468085106383
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 61: 0.9893617021276596
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 62: 0.9468085106382979
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 63: 0.9574468085106383
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 65: 0.9574468085106383
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 66: 0.9361702127659575
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 67: 0.9148936170212766
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 68: 0.9468085106382979
Warm optimizer lr: 0.023327999999999998
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 70: 0.9468085106382979
Push epoch at epoch 71.
Final validation accuracy before push: 94.68085106382979%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8092948717948718
	Train Cluster: 0.6387420177459717
	Train Separation: 0.5099587202072143
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7978723404255319
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 72: 0.8617021276595744
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 73: 0.8404255319148937
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 74: 0.9468085106382979
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 75: 0.925531914893617
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 76: 0.9361702127659575
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 77: 0.9468085106382979
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 78: 0.9361702127659575
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 79: 0.9361702127659575
Warm optimizer lr: 0.013996799999999998
Val acc before epoch 80: 0.925531914893617
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 81: 0.9574468085106383
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 82: 0.9468085106382979
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 83: 0.925531914893617
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 84: 0.9574468085106383
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 86: 0.9468085106382979
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 88: 0.9680851063829787
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 89: 0.9574468085106383
Warm optimizer lr: 0.008398079999999999
Val acc before epoch 90: 0.9574468085106383
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 92: 0.9468085106382979
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 93: 0.9574468085106383
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 94: 0.9574468085106383
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 95: 0.9680851063829787
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 97: 0.9574468085106383
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 98: 0.9680851063829787
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 99: 0.9468085106382979
Warm optimizer lr: 0.005038847999999999
Val acc before epoch 100: 0.9468085106382979
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 101: 0.9574468085106383
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 102: 0.9468085106382979
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 103: 0.925531914893617
Warm optimizer lr: 0.0030233087999999996
Val acc before epoch 104: 0.9361702127659575
Stopping after epoch 105.
Final validation accuracy before push: 93.61702127659575%
Push number 2
After push, before retraining last layer:
	Train acc: 0.7756410256410257
	Train Cluster: 0.6377198219299316
	TrainSeparation: 0.5099260568618774
(Directly after push) Val acc at iteration 0: 0.7872340425531915
Retraining last layer
Last layer lr: 0.001

Attempting combination 43/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.7
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.0
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.5638297872340425
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6276595744680851
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7127659574468085
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7659574468085106
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.776595744680851
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 9: 0.9042553191489362
Warm optimizer lr: 0.35
Val acc before epoch 10: 0.8829787234042553
Warm optimizer lr: 0.35
Val acc before epoch 11: 0.9148936170212766
Warm optimizer lr: 0.35
Val acc before epoch 12: 0.9148936170212766
Warm optimizer lr: 0.35
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.35
Val acc before epoch 14: 0.9148936170212766
Warm optimizer lr: 0.35
Val acc before epoch 15: 0.9361702127659575
Warm optimizer lr: 0.35
Val acc before epoch 16: 0.8829787234042553
Warm optimizer lr: 0.35
Val acc before epoch 17: 0.9148936170212766
Warm optimizer lr: 0.35
Val acc before epoch 18: 0.925531914893617
Warm optimizer lr: 0.35
Val acc before epoch 19: 0.9468085106382979
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 20: 0.9574468085106383
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 21: 0.9148936170212766
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 22: 0.925531914893617
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 23: 0.9574468085106383
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 25: 0.925531914893617
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 26: 0.9468085106382979
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.24499999999999997
Val acc before epoch 29: 0.9148936170212766
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 31: 0.9361702127659575
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 32: 0.9574468085106383
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 33: 0.9574468085106383
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 34: 0.9574468085106383
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 35: 0.9042553191489362
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 37: 0.925531914893617
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 38: 0.925531914893617
Warm optimizer lr: 0.17149999999999996
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 41: 0.9148936170212766
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 42: 0.9148936170212766
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 43: 0.925531914893617
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 44: 0.9361702127659575
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 45: 0.925531914893617
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 46: 0.9574468085106383
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 47: 0.9148936170212766
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 48: 0.9468085106382979
Warm optimizer lr: 0.12004999999999996
Val acc before epoch 49: 0.925531914893617
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 50: 0.9361702127659575
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 51: 0.9468085106382979
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 52: 0.9361702127659575
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 53: 0.8936170212765957
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 54: 0.9468085106382979
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 55: 0.9148936170212766
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 57: 0.8723404255319149
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.08403499999999997
Val acc before epoch 59: 0.9042553191489362
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 61: 0.925531914893617
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 62: 0.925531914893617
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 64: 0.925531914893617
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 66: 0.9042553191489362
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 68: 0.9042553191489362
Warm optimizer lr: 0.058824499999999974
Val acc before epoch 69: 0.925531914893617
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 70: 0.9042553191489362
Push epoch at epoch 71.
Final validation accuracy before push: 90.42553191489363%
Push number 1
After push, before retraining last layer:
	Train acc: 0.780448717948718
	Train Cluster: 0.638769781589508
	Train Separation: 0.5121343493461609
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.5638297872340425
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 72: 0.8297872340425532
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 73: 0.8617021276595744
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 74: 0.851063829787234
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 75: 0.8723404255319149
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 76: 0.9148936170212766
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 77: 0.9148936170212766
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 78: 0.9148936170212766
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 79: 0.925531914893617
Warm optimizer lr: 0.04117714999999998
Val acc before epoch 80: 0.9574468085106383
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 81: 0.925531914893617
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 82: 0.9680851063829787
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 83: 0.8617021276595744
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 84: 0.8617021276595744
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 85: 0.9468085106382979
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 87: 0.9361702127659575
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 88: 0.9468085106382979
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 89: 0.925531914893617
Warm optimizer lr: 0.028824004999999986
Val acc before epoch 90: 0.925531914893617
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 91: 0.925531914893617
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 92: 0.9042553191489362
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 93: 0.8936170212765957
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 94: 0.9148936170212766
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 95: 0.9042553191489362
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 97: 0.9042553191489362
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 98: 0.8829787234042553
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 99: 0.9361702127659575
Warm optimizer lr: 0.02017680349999999
Val acc before epoch 100: 0.9148936170212766
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 101: 0.8936170212765957
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 102: 0.925531914893617
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 103: 0.9042553191489362
Warm optimizer lr: 0.014123762449999992
Val acc before epoch 104: 0.9468085106382979
Stopping after epoch 105.
Final validation accuracy before push: 94.68085106382979%
Push number 2
After push, before retraining last layer:
	Train acc: 0.7660256410256411
	Train Cluster: 0.6311014413833618
	TrainSeparation: 0.5041370749473572
(Directly after push) Val acc at iteration 0: 0.7021276595744681
Retraining last layer
Last layer lr: 0.001

Attempting combination 44/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.8
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.44680851063829785
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7446808510638298
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.7446808510638298
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.7978723404255319
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 8: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 9: 0.8723404255319149
Warm optimizer lr: 0.4
Val acc before epoch 10: 0.9361702127659575
Warm optimizer lr: 0.4
Val acc before epoch 11: 0.851063829787234
Warm optimizer lr: 0.4
Val acc before epoch 12: 0.8617021276595744
Warm optimizer lr: 0.4
Val acc before epoch 13: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.4
Val acc before epoch 15: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 16: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 17: 0.9042553191489362
Warm optimizer lr: 0.4
Val acc before epoch 18: 0.8936170212765957
Warm optimizer lr: 0.4
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 20: 0.9361702127659575
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 21: 0.925531914893617
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 22: 0.9361702127659575
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 23: 0.9148936170212766
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 24: 0.9468085106382979
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 25: 0.9574468085106383
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 26: 0.9361702127659575
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 27: 0.8936170212765957
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 28: 0.9042553191489362
Warm optimizer lr: 0.32000000000000006
Val acc before epoch 29: 0.9361702127659575
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 30: 0.9148936170212766
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 31: 0.9468085106382979
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 32: 0.8936170212765957
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 33: 0.9361702127659575
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 34: 0.925531914893617
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 35: 0.9361702127659575
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 36: 0.925531914893617
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 37: 0.9361702127659575
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 38: 0.9680851063829787
Warm optimizer lr: 0.25600000000000006
Val acc before epoch 39: 0.9468085106382979
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 40: 0.9361702127659575
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 42: 0.9574468085106383
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 43: 0.9574468085106383
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 44: 0.9680851063829787
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 45: 0.9148936170212766
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 47: 0.9680851063829787
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 48: 0.9574468085106383
Warm optimizer lr: 0.20480000000000007
Val acc before epoch 49: 0.9468085106382979
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 50: 0.9574468085106383
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 51: 0.9148936170212766
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 52: 0.9468085106382979
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 54: 0.925531914893617
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 55: 0.9574468085106383
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 56: 0.9468085106382979
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 57: 0.9680851063829787
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.16384000000000007
Val acc before epoch 59: 0.925531914893617
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 60: 0.9361702127659575
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 61: 0.9574468085106383
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 62: 0.9574468085106383
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 63: 0.925531914893617
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 65: 0.9361702127659575
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 66: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 67: 0.9468085106382979
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.13107200000000005
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 70: 0.9574468085106383
Push epoch at epoch 71.
Final validation accuracy before push: 95.74468085106383%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8173076923076923
	Train Cluster: 0.6423392772674561
	Train Separation: 0.5063334584236145
(Directly after push) Val acc at iteration 0: 0.6702127659574468
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.6063829787234043
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 72: 0.8085106382978723
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 73: 0.8404255319148937
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 74: 0.8297872340425532
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 75: 0.9148936170212766
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 76: 0.8936170212765957
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 77: 0.8829787234042553
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 78: 0.8936170212765957
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 79: 0.8723404255319149
Warm optimizer lr: 0.10485760000000005
Val acc before epoch 80: 0.8723404255319149
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 81: 0.9042553191489362
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 82: 0.8829787234042553
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 83: 0.8829787234042553
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 84: 0.9148936170212766
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 85: 0.9148936170212766
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 86: 0.9148936170212766
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 88: 0.8829787234042553
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 89: 0.9468085106382979
Warm optimizer lr: 0.08388608000000004
Val acc before epoch 90: 0.9042553191489362
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 91: 0.9042553191489362
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 92: 0.925531914893617
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 93: 0.9468085106382979
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 94: 0.925531914893617
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 95: 0.9361702127659575
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 96: 0.9042553191489362
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 97: 0.8936170212765957
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 98: 0.925531914893617
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 99: 0.9361702127659575
Warm optimizer lr: 0.06710886400000003
Val acc before epoch 100: 0.8936170212765957
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 101: 0.8936170212765957
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 102: 0.9042553191489362
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 103: 0.925531914893617
Warm optimizer lr: 0.05368709120000003
Val acc before epoch 104: 0.925531914893617
Stopping after epoch 105.
Final validation accuracy before push: 92.5531914893617%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8221153846153846
	Train Cluster: 0.6488566875457764
	TrainSeparation: 0.5083259463310241
(Directly after push) Val acc at iteration 0: 0.6914893617021277
Retraining last layer
Last layer lr: 0.001

Attempting combination 45/45:
prototype_shape: (468, 520, 29)
latent_weight: 0.9
num_warm_epochs: 1000000
push_gap: 35
num_pushes: 1
last_layer_epochs: 0
crs_ent_weight: 1
clst_weight: -9.600000000000001
sep_weight: 2.4
l1_weight: 0.001
push_start: 70
p0_warm_ptype_lr: 0.5
p0_warm_ptype_gamma: 0.9
p0_warm_ptype_step_size: 50
p1_last_layer_lr: 0.001
p1_warm_ptype_lr: 0.28
p1_warm_ptype_gamma: 0.8
p1_warm_ptype_step_size: 100
p2_last_layer_lr: 0.0007
p2_warm_ptype_lr: 0.1
p2_warm_ptype_gamma: -1
p2_warm_ptype_step_size: 100
p3_last_layer_lr: 7.5e-05
p3_warm_ptype_lr: 0.05
p3_warm_ptype_gamma: -1
p3_warm_ptype_step_size: 100
p4_last_layer_lr: 7.5e-06
p4_warm_ptype_lr: 0.05
p4_warm_ptype_gamma: -1
p4_warm_ptype_step_size: 100
joint_weight_decay: -1
joint_lr_step_size: -1
joint_gamma: -1
joint_optimizer_lrs: {'features': -1, 'prototype_vectors': -1}



End epoch: 104
Val acc before epoch 0: 0.010638297872340425
Warm optimizer lr: 0.5
Val acc before epoch 1: 0.48936170212765956
Warm optimizer lr: 0.5
Val acc before epoch 2: 0.6382978723404256
Warm optimizer lr: 0.5
Val acc before epoch 3: 0.7978723404255319
Warm optimizer lr: 0.5
Val acc before epoch 4: 0.8617021276595744
Warm optimizer lr: 0.5
Val acc before epoch 5: 0.8404255319148937
Warm optimizer lr: 0.5
Val acc before epoch 6: 0.8297872340425532
Warm optimizer lr: 0.5
Val acc before epoch 7: 0.8936170212765957
Warm optimizer lr: 0.5
Val acc before epoch 8: 0.8829787234042553
Warm optimizer lr: 0.5
Val acc before epoch 9: 0.8617021276595744
Warm optimizer lr: 0.45
Val acc before epoch 10: 0.9042553191489362
Warm optimizer lr: 0.45
Val acc before epoch 11: 0.8936170212765957
Warm optimizer lr: 0.45
Val acc before epoch 12: 0.8723404255319149
Warm optimizer lr: 0.45
Val acc before epoch 13: 0.8829787234042553
Warm optimizer lr: 0.45
Val acc before epoch 14: 0.8829787234042553
Warm optimizer lr: 0.45
Val acc before epoch 15: 0.9042553191489362
Warm optimizer lr: 0.45
Val acc before epoch 16: 0.925531914893617
Warm optimizer lr: 0.45
Val acc before epoch 17: 0.9468085106382979
Warm optimizer lr: 0.45
Val acc before epoch 18: 0.9042553191489362
Warm optimizer lr: 0.45
Val acc before epoch 19: 0.925531914893617
Warm optimizer lr: 0.405
Val acc before epoch 20: 0.925531914893617
Warm optimizer lr: 0.405
Val acc before epoch 21: 0.9361702127659575
Warm optimizer lr: 0.405
Val acc before epoch 22: 0.9148936170212766
Warm optimizer lr: 0.405
Val acc before epoch 23: 0.8723404255319149
Warm optimizer lr: 0.405
Val acc before epoch 24: 0.9361702127659575
Warm optimizer lr: 0.405
Val acc before epoch 25: 0.9361702127659575
Warm optimizer lr: 0.405
Val acc before epoch 26: 0.925531914893617
Warm optimizer lr: 0.405
Val acc before epoch 27: 0.9361702127659575
Warm optimizer lr: 0.405
Val acc before epoch 28: 0.9148936170212766
Warm optimizer lr: 0.405
Val acc before epoch 29: 0.9468085106382979
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 30: 0.9042553191489362
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 31: 0.925531914893617
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 32: 0.9361702127659575
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 33: 0.9148936170212766
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 34: 0.9361702127659575
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 35: 0.925531914893617
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 36: 0.9042553191489362
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 37: 0.9042553191489362
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 38: 0.9680851063829787
Warm optimizer lr: 0.36450000000000005
Val acc before epoch 39: 0.9148936170212766
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 40: 0.9042553191489362
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 41: 0.9361702127659575
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 42: 0.9468085106382979
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 43: 0.9468085106382979
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 44: 0.9680851063829787
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 45: 0.9468085106382979
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 46: 0.9361702127659575
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 47: 0.925531914893617
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 48: 0.9680851063829787
Warm optimizer lr: 0.32805000000000006
Val acc before epoch 49: 0.9361702127659575
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 50: 0.9468085106382979
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 51: 0.9574468085106383
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 52: 0.9574468085106383
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 53: 0.925531914893617
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 54: 0.9680851063829787
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 55: 0.9468085106382979
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 56: 0.9361702127659575
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 57: 0.9361702127659575
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 58: 0.9361702127659575
Warm optimizer lr: 0.2952450000000001
Val acc before epoch 59: 0.9468085106382979
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 60: 0.9468085106382979
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 61: 0.9361702127659575
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 62: 0.9574468085106383
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 63: 0.9468085106382979
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 64: 0.9361702127659575
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 65: 0.9468085106382979
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 66: 0.9574468085106383
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 67: 0.9680851063829787
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 68: 0.9574468085106383
Warm optimizer lr: 0.2657205000000001
Val acc before epoch 69: 0.9574468085106383
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 70: 0.9680851063829787
Push epoch at epoch 71.
Final validation accuracy before push: 96.80851063829788%
Push number 1
After push, before retraining last layer:
	Train acc: 0.8028846153846154
	Train Cluster: 0.6457040905952454
	Train Separation: 0.5082448840141296
(Directly after push) Val acc at iteration 0: 0.574468085106383
Retraining last layer: 
Last layer lr: 0.001
Val acc before epoch 71: 0.7872340425531915
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 72: 0.851063829787234
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 73: 0.8723404255319149
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 74: 0.851063829787234
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 75: 0.8936170212765957
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 76: 0.851063829787234
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 77: 0.8617021276595744
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 78: 0.8617021276595744
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 79: 0.9148936170212766
Warm optimizer lr: 0.23914845000000007
Val acc before epoch 80: 0.8829787234042553
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 81: 0.9574468085106383
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 82: 0.925531914893617
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 83: 0.9148936170212766
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 84: 0.925531914893617
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 85: 0.8936170212765957
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 86: 0.9361702127659575
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 87: 0.925531914893617
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 88: 0.9361702127659575
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 89: 0.9148936170212766
Warm optimizer lr: 0.21523360500000008
Val acc before epoch 90: 0.9361702127659575
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 91: 0.9468085106382979
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 92: 0.9680851063829787
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 93: 0.9148936170212766
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 94: 0.925531914893617
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 95: 0.925531914893617
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 96: 0.9361702127659575
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 97: 0.925531914893617
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 98: 0.925531914893617
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 99: 0.9574468085106383
Warm optimizer lr: 0.19371024450000007
Val acc before epoch 100: 0.9468085106382979
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 101: 0.9148936170212766
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 102: 0.9468085106382979
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 103: 0.9468085106382979
Warm optimizer lr: 0.17433922005000008
Val acc before epoch 104: 0.9468085106382979
Stopping after epoch 105.
Final validation accuracy before push: 94.68085106382979%
Push number 2
After push, before retraining last layer:
	Train acc: 0.8076923076923077
	Train Cluster: 0.6422550678253174
	TrainSeparation: 0.5118578433990478
(Directly after push) Val acc at iteration 0: 0.7340425531914894
Retraining last layer
Last layer lr: 0.001
Finished search.
